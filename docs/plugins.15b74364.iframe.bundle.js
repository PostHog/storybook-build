(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{5788:function(module,exports,__webpack_require__){(exports=__webpack_require__(54)(!1)).push([module.i,'.bg-mid{background-color:#f2f2f2!important}.mixin-base-bordered-card{border-radius:4px;box-shadow:0 4px 10px rgba(0,0,0,.04)}.mixin-gradient-overlay{width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent)}.mixin-gradient-overlay,.mixin-gradient-overlay-right{content:"";position:absolute;pointer-events:none;bottom:0}.mixin-gradient-overlay-right{width:3rem;height:100%;background:linear-gradient(270deg,#fff,transparent)}.text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.plugins-scene{padding-bottom:60px}.plugins-installed-tab-section-header:hover,.plugins-repository-tab-section-header:hover{cursor:pointer}.plugins-repository-tab-section-header{margin-left:5px}.plugin-capabilities-tag{cursor:default}.plugins-scene-plugin-card>.ant-card-body{padding:15px}.plugins-scene-plugin-card .plugin-card-row>.ant-col{margin-right:14px}.plugins-scene-plugin-card .plugin-card-row>.ant-col:last-child{margin-right:0}.plugins-scene-plugin-card a.plugin-title-link{color:var(--color-text)}.plugins-scene-plugin-card a.plugin-title-link:hover{text-decoration:underline}.plugins-scene-plugin-card .plugin-image{width:60px;height:60px;display:flex;justify-content:center;align-items:center;margin-left:auto;margin-right:auto;border:none;padding:4px}.plugins-scene-plugin-card .order-handle{cursor:move;text-align:center;height:100%;margin-top:-10px;margin-bottom:-10px}.plugins-scene-plugin-card .order-handle .ant-tag{margin-right:0;cursor:move}.plugins-scene-plugin-card .order-handle .arrow{color:#888;height:19px}.plugins-scene-plugin-card .order-handle .arrow.hide{visibility:hidden}.plugins-scene-plugin-card .hide-over-500{display:none}@media(max-width:500px){.plugins-scene-plugin-card .show-over-500{display:none}.plugins-scene-plugin-card .hide-over-500{display:inline-block}.plugins-scene-plugin-card button.ant-btn.padding-under-500{padding:4px 8px}.plugins-scene-plugin-card .hide-plugin-image-below-500{display:none}}.plugins-popconfirm{z-index:1001}.plugin-job-json-editor{border:1px solid #efefef;padding:10px}.plugin-run-job-button{color:#77b96c;cursor:pointer}.plugin-run-job-button-disabled{color:#9a9a9a;cursor:default}',""]),exports.locals={zDrawer:"950",zPopup:"1060",zGraphAnnotationPrompt:"99"},module.exports=exports},5864:function(module,exports,__webpack_require__){(exports=__webpack_require__(54)(!1)).push([module.i,'.bg-mid{background-color:#f2f2f2!important}.mixin-base-bordered-card{border-radius:4px;box-shadow:0 4px 10px rgba(0,0,0,.04)}.mixin-gradient-overlay{width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent)}.mixin-gradient-overlay,.mixin-gradient-overlay-right{content:"";position:absolute;pointer-events:none;bottom:0}.mixin-gradient-overlay-right{width:3rem;height:100%;background:linear-gradient(270deg,#fff,transparent)}.text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.metrics-drawer{z-index:950}.metrics-drawer .metrics-chart-wrapper canvas{max-width:90%;max-height:80%}.metrics-drawer .metrics-chart-wrapper canvas:hover{cursor:default!important}',""]),exports.locals={zDrawer:"950",zPopup:"1060",zGraphAnnotationPrompt:"99"},module.exports=exports},6073:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Plugins",(function(){return Plugins_Plugins}));var PluginInstallationType,PluginTab,injectStylesIntoStyleTag=__webpack_require__(23),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),Plugins=__webpack_require__(5788),Plugins_default=__webpack_require__.n(Plugins),Plugins_options={insert:"head",singleton:!1},react=(injectStylesIntoStyleTag_default()(Plugins_default.a,Plugins_options),Plugins_default.a.locals,__webpack_require__(0)),react_default=__webpack_require__.n(react),toConsumableArray=(__webpack_require__(218),__webpack_require__(232),__webpack_require__(38),__webpack_require__(1774),__webpack_require__(59),__webpack_require__(156),__webpack_require__(91),__webpack_require__(34),__webpack_require__(61),__webpack_require__(108),__webpack_require__(321),__webpack_require__(104),__webpack_require__(18)),toConsumableArray_default=__webpack_require__.n(toConsumableArray),defineProperty=__webpack_require__(5),defineProperty_default=__webpack_require__.n(defineProperty),slicedToArray=__webpack_require__(15),slicedToArray_default=__webpack_require__.n(slicedToArray),index_esm=__webpack_require__(3),helpers_typeof=__webpack_require__(87),typeof_default=__webpack_require__.n(helpers_typeof),objectWithoutProperties=(__webpack_require__(140),__webpack_require__(42),__webpack_require__(269),__webpack_require__(270),__webpack_require__(155),__webpack_require__(36),__webpack_require__(85),__webpack_require__(116),__webpack_require__(165),__webpack_require__(595),__webpack_require__(141),__webpack_require__(47),__webpack_require__(41)),objectWithoutProperties_default=__webpack_require__.n(objectWithoutProperties),regenerator=__webpack_require__(7),regenerator_default=__webpack_require__.n(regenerator),asyncToGenerator=(__webpack_require__(66),__webpack_require__(13)),asyncToGenerator_default=__webpack_require__.n(asyncToGenerator),api=__webpack_require__(20);!function(PluginInstallationType){PluginInstallationType.Local="local",PluginInstallationType.Custom="custom",PluginInstallationType.Repository="repository",PluginInstallationType.Source="source"}(PluginInstallationType||(PluginInstallationType={})),function(PluginTab){PluginTab.Installed="installed",PluginTab.Repository="repository",PluginTab.Advanced="advanced"}(PluginTab||(PluginTab={}));var userLogic=__webpack_require__(65);function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var SECRET_FIELD_VALUE="**************** POSTHOG SECRET FIELD ****************";function getConfigSchemaArray(configSchema){return Array.isArray(configSchema)?configSchema:Object.entries(configSchema).map((function(_ref){var _ref2=slicedToArray_default()(_ref,2);return _objectSpread({key:_ref2[0]},_ref2[1])})).sort((function(a,b){return(a.order||999999)-(b.order||999999)}))}function getConfigSchemaObject(configSchema){if(Array.isArray(configSchema)){var newSchema={};return configSchema.forEach((function(conf,order){conf.key&&(newSchema[conf.key]=_objectSpread(_objectSpread({},conf),{},{order:order}))})),newSchema}return configSchema}function getPluginConfigFormData(editingPlugin,pluginConfigChanges){var enabled=pluginConfigChanges.__enabled,config=objectWithoutProperties_default()(pluginConfigChanges,["__enabled"]),configSchema=getConfigSchemaObject(editingPlugin.config_schema),formData=new FormData,otherConfig={};formData.append("enabled",Boolean(enabled).toString());for(var _i=0,_Object$entries=Object.entries(config);_i<_Object$entries.length;_i++){var _configSchema$key,_configSchema$key2,_editingPlugin$plugin,_Object$entries$_i=slicedToArray_default()(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];if("attachment"===(null===(_configSchema$key=configSchema[key])||void 0===_configSchema$key?void 0:_configSchema$key.type))value&&!value.saved&&formData.append("add_attachment[".concat(key,"]"),value),!value&&(null===(_editingPlugin$plugin=editingPlugin.pluginConfig.config)||void 0===_editingPlugin$plugin?void 0:_editingPlugin$plugin[key])&&formData.append("remove_attachment[".concat(key,"]"),"true");else(null===(_configSchema$key2=configSchema[key])||void 0===_configSchema$key2?void 0:_configSchema$key2.secret)&&value===SECRET_FIELD_VALUE||(otherConfig[key]=value)}return formData.append("config",JSON.stringify(otherConfig)),formData}var PluginSection,doFieldRequirementsMatch=function doFieldRequirementsMatch(form,targetFieldName,targetFieldValue){var formActualValue=form.getFieldValue(targetFieldName||"")||"";return void 0===targetFieldValue&&!!formActualValue||targetFieldValue===formActualValue},es=__webpack_require__(43),access=__webpack_require__(1760),teamLogic=__webpack_require__(28);function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==typeof_default()(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==typeof_default()(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===typeof_default()(key)?key:String(key)}function pluginsLogic_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function pluginsLogic_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return pluginsLogic_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pluginsLogic_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function pluginsLogic_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function pluginsLogic_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function pluginsLogic_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?pluginsLogic_ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):pluginsLogic_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function capturePluginEvent(event,plugin,type){var _plugin$url;es.a.capture(event,pluginsLogic_objectSpread({plugin_name:plugin.name,plugin_url:(null===(_plugin$url=plugin.url)||void 0===_plugin$url?void 0:_plugin$url.startsWith("file:"))?"file://masked-local-path":plugin.url,plugin_tag:plugin.tag},type&&{plugin_installation_type:type}))}!function(PluginSection){PluginSection.Upgrade="upgrade",PluginSection.Installed="installed",PluginSection.Enabled="enabled",PluginSection.Disabled="disabled"}(PluginSection||(PluginSection={}));var pluginsLogic=Object(index_esm.kea)({actions:{editPlugin:function editPlugin(id){var pluginConfigChanges=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{id:id,pluginConfigChanges:pluginConfigChanges}},savePluginConfig:function savePluginConfig(pluginConfigChanges){return{pluginConfigChanges:pluginConfigChanges}},installPlugin:function installPlugin(pluginUrl,pluginType){return{pluginUrl:pluginUrl,pluginType:pluginType}},uninstallPlugin:function uninstallPlugin(name){return{name:name}},setCustomPluginUrl:function setCustomPluginUrl(customPluginUrl){return{customPluginUrl:customPluginUrl}},setLocalPluginUrl:function setLocalPluginUrl(localPluginUrl){return{localPluginUrl:localPluginUrl}},setSourcePluginName:function setSourcePluginName(sourcePluginName){return{sourcePluginName:sourcePluginName}},setPluginTab:function setPluginTab(tab){return{tab:tab}},setEditingSource:function setEditingSource(editingSource){return{editingSource:editingSource}},resetPluginConfigError:function resetPluginConfigError(id){return{id:id}},editPluginSource:function editPluginSource(values){return values},checkForUpdates:function checkForUpdates(checkAll){var initialUpdateStatus=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{checkAll:checkAll,initialUpdateStatus:initialUpdateStatus}},checkedForUpdates:!0,setUpdateStatus:function setUpdateStatus(id,tag,latestTag){return{id:id,tag:tag,latestTag:latestTag}},setUpdateError:function setUpdateError(id){return{id:id}},updatePlugin:function updatePlugin(id){return{id:id}},pluginUpdated:function pluginUpdated(id){return{id:id}},patchPlugin:function patchPlugin(id){var pluginChanges=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{id:id,pluginChanges:pluginChanges}},generateApiKeysIfNeeded:function generateApiKeysIfNeeded(form){return{form:form}},rearrange:!0,setTemporaryOrder:function setTemporaryOrder(temporaryOrder,movedPluginId){return{temporaryOrder:temporaryOrder,movedPluginId:movedPluginId}},makePluginOrderSaveable:!0,savePluginOrders:function savePluginOrders(newOrders){return{newOrders:newOrders}},cancelRearranging:!0,showPluginLogs:function showPluginLogs(id){return{id:id}},hidePluginLogs:!0,showPluginMetrics:function showPluginMetrics(id){return{id:id}},hidePluginMetrics:!0,processSearchInput:function processSearchInput(term){return{term:term}},setSearchTerm:function setSearchTerm(term){return{term:term}},setPluginConfigPollTimeout:function setPluginConfigPollTimeout(timeout){return{timeout:timeout}},toggleSectionOpen:function toggleSectionOpen(section){return{section:section}}},loaders:function loaders(_ref){var _loadRepository,_savePluginOrders,_resetPluginConfigError,_toggleEnabled,_savePluginConfig,_loadPluginConfigs,_patchPlugin,_updatePlugin,_editPluginSource,_uninstallPlugin,_installPlugin,_loadPlugins,actions=_ref.actions,values=_ref.values;return{plugins:[{},{loadPlugins:(_loadPlugins=asyncToGenerator_default()(regenerator_default.a.mark((function _callee(){var _yield$api$get,results,plugins,_iterator,_step,plugin;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,api.a.get("api/organizations/@current/plugins");case 2:_yield$api$get=_context.sent,results=_yield$api$get.results,plugins={},_iterator=pluginsLogic_createForOfIteratorHelper(results);try{for(_iterator.s();!(_step=_iterator.n()).done;)plugin=_step.value,plugins[plugin.id]=plugin}catch(err){_iterator.e(err)}finally{_iterator.f()}return _context.abrupt("return",plugins);case 8:case"end":return _context.stop()}}),_callee)}))),function loadPlugins(){return _loadPlugins.apply(this,arguments)}),installPlugin:(_installPlugin=asyncToGenerator_default()(regenerator_default.a.mark((function _callee2(_ref2){var pluginUrl,pluginType,url,response;return regenerator_default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return pluginUrl=_ref2.pluginUrl,pluginType=_ref2.pluginType,url="local"===pluginType?"file:".concat(pluginUrl):pluginUrl,_context2.next=4,api.a.create("api/organizations/@current/plugins","source"===pluginType?{plugin_type:pluginType,name:url,source:""}:{url:url});case 4:return capturePluginEvent("plugin installed",response=_context2.sent,pluginType),_context2.abrupt("return",pluginsLogic_objectSpread(pluginsLogic_objectSpread({},values.plugins),{},defineProperty_default()({},response.id,response)));case 7:case"end":return _context2.stop()}}),_callee2)}))),function installPlugin(_x){return _installPlugin.apply(this,arguments)}),uninstallPlugin:(_uninstallPlugin=asyncToGenerator_default()(regenerator_default.a.mark((function _callee3(){var plugins,editingPlugin,_editingPlugin$id,rest;return regenerator_default.a.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(plugins=values.plugins,editingPlugin=values.editingPlugin){_context3.next=3;break}return _context3.abrupt("return",plugins);case 3:return _context3.next=5,api.a.delete("api/organizations/@current/plugins/".concat(editingPlugin.id));case 5:return capturePluginEvent("plugin uninstalled",editingPlugin),_editingPlugin$id=editingPlugin.id,plugins[_editingPlugin$id],rest=objectWithoutProperties_default()(plugins,[_editingPlugin$id].map(_toPropertyKey)),_context3.abrupt("return",rest);case 8:case"end":return _context3.stop()}}),_callee3)}))),function uninstallPlugin(){return _uninstallPlugin.apply(this,arguments)}),editPluginSource:(_editPluginSource=asyncToGenerator_default()(regenerator_default.a.mark((function _callee4(_ref3){var id,name,source,configSchema,plugins,response;return regenerator_default.a.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return id=_ref3.id,name=_ref3.name,source=_ref3.source,configSchema=_ref3.configSchema,plugins=values.plugins,_context4.next=4,api.a.update("api/organizations/@current/plugins/".concat(id),{name:name,source:source,config_schema:configSchema});case 4:return capturePluginEvent("plugin source edited",response=_context4.sent),_context4.abrupt("return",pluginsLogic_objectSpread(pluginsLogic_objectSpread({},plugins),{},defineProperty_default()({},id,response)));case 7:case"end":return _context4.stop()}}),_callee4)}))),function editPluginSource(_x2){return _editPluginSource.apply(this,arguments)}),updatePlugin:(_updatePlugin=asyncToGenerator_default()(regenerator_default.a.mark((function _callee5(_ref4){var id,response,schema,pluginConfig;return regenerator_default.a.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return id=_ref4.id,_context5.next=3,api.a.create("api/organizations/@current/plugins/".concat(id,"/upgrade"));case 3:return capturePluginEvent("plugin updated",response=_context5.sent),actions.pluginUpdated(id),schema=getConfigSchemaObject(response.config_schema),(null==(pluginConfig=Object.values(values.pluginConfigs).filter((function(c){return c.plugin===id}))[0])?void 0:pluginConfig.enabled)&&Object.entries(schema).find((function(_ref5){var _ref6=slicedToArray_default()(_ref5,2),key=_ref6[0];return _ref6[1].required&&!pluginConfig.config[key]}))&&actions.editPlugin(id),_context5.abrupt("return",pluginsLogic_objectSpread(pluginsLogic_objectSpread({},values.plugins),{},defineProperty_default()({},id,response)));case 10:case"end":return _context5.stop()}}),_callee5)}))),function updatePlugin(_x3){return _updatePlugin.apply(this,arguments)}),patchPlugin:(_patchPlugin=asyncToGenerator_default()(regenerator_default.a.mark((function _callee6(_ref7){var id,pluginChanges,response;return regenerator_default.a.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return id=_ref7.id,pluginChanges=_ref7.pluginChanges,_context6.next=3,api.a.update("api/organizations/@current/plugins/".concat(id),pluginChanges);case 3:return response=_context6.sent,_context6.abrupt("return",pluginsLogic_objectSpread(pluginsLogic_objectSpread({},values.plugins),{},defineProperty_default()({},id,response)));case 5:case"end":return _context6.stop()}}),_callee6)}))),function patchPlugin(_x4){return _patchPlugin.apply(this,arguments)})}],pluginConfigs:[{},{loadPluginConfigs:(_loadPluginConfigs=asyncToGenerator_default()(regenerator_default.a.mark((function _callee7(){var pluginConfigs,_yield$api$get2,results,_iterator2,_step2,pluginConfig;return regenerator_default.a.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return pluginConfigs={},_context7.next=3,api.a.get("api/plugin_config");case 3:_yield$api$get2=_context7.sent,results=_yield$api$get2.results,_iterator2=pluginsLogic_createForOfIteratorHelper(results);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;)pluginConfig=_step2.value,pluginConfigs[pluginConfig.plugin]=pluginsLogic_objectSpread({},pluginConfig)}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return _context7.abrupt("return",pluginConfigs);case 8:case"end":return _context7.stop()}}),_callee7)}))),function loadPluginConfigs(){return _loadPluginConfigs.apply(this,arguments)}),savePluginConfig:(_savePluginConfig=asyncToGenerator_default()(regenerator_default.a.mark((function _callee8(_ref8){var _editingPlugin$plugin,pluginConfigChanges,pluginConfigs,editingPlugin,formData,response;return regenerator_default.a.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:if(pluginConfigChanges=_ref8.pluginConfigChanges,pluginConfigs=values.pluginConfigs,editingPlugin=values.editingPlugin){_context8.next=4;break}return _context8.abrupt("return",pluginConfigs);case 4:if(formData=getPluginConfigFormData(editingPlugin,pluginConfigChanges),(null===(_editingPlugin$plugin=editingPlugin.pluginConfig)||void 0===_editingPlugin$plugin?void 0:_editingPlugin$plugin.enabled)||formData.append("order",values.nextPluginOrder.toString()),!editingPlugin.pluginConfig.id){_context8.next=12;break}return _context8.next=9,api.a.update("api/plugin_config/".concat(editingPlugin.pluginConfig.id),formData);case 9:response=_context8.sent,_context8.next=16;break;case 12:return formData.append("plugin",editingPlugin.id.toString()),_context8.next=15,api.a.create("api/plugin_config/",formData);case 15:response=_context8.sent;case 16:return capturePluginEvent("plugin config updated",editingPlugin),editingPlugin.pluginConfig.enabled!==response.enabled&&capturePluginEvent("plugin ".concat(response.enabled?"enabled":"disabled"),editingPlugin),_context8.abrupt("return",pluginsLogic_objectSpread(pluginsLogic_objectSpread({},pluginConfigs),{},defineProperty_default()({},response.plugin,response)));case 19:case"end":return _context8.stop()}}),_callee8)}))),function savePluginConfig(_x5){return _savePluginConfig.apply(this,arguments)}),toggleEnabled:(_toggleEnabled=asyncToGenerator_default()(regenerator_default.a.mark((function _callee9(_ref9){var id,enabled,pluginConfigs,plugins,pluginConfig,plugin,response;return regenerator_default.a.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return id=_ref9.id,enabled=_ref9.enabled,pluginConfigs=values.pluginConfigs,plugins=values.plugins,(pluginConfig=Object.values(pluginConfigs).find((function(config){return config.id===id})))&&(plugin=plugins[pluginConfig.plugin])&&capturePluginEvent("plugin ".concat(enabled?"enabled":"disabled"),plugin),_context9.next=6,api.a.update("api/plugin_config/".concat(id),{enabled:enabled,order:values.nextPluginOrder});case 6:return response=_context9.sent,_context9.abrupt("return",pluginsLogic_objectSpread(pluginsLogic_objectSpread({},pluginConfigs),{},defineProperty_default()({},response.plugin,response)));case 8:case"end":return _context9.stop()}}),_callee9)}))),function toggleEnabled(_x6){return _toggleEnabled.apply(this,arguments)}),resetPluginConfigError:(_resetPluginConfigError=asyncToGenerator_default()(regenerator_default.a.mark((function _callee10(_ref10){var id,pluginConfigs,response;return regenerator_default.a.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return id=_ref10.id,pluginConfigs=values.pluginConfigs,_context10.next=4,api.a.update("api/plugin_config/".concat(id),{error:null});case 4:return response=_context10.sent,_context10.abrupt("return",pluginsLogic_objectSpread(pluginsLogic_objectSpread({},pluginConfigs),{},defineProperty_default()({},response.plugin,response)));case 6:case"end":return _context10.stop()}}),_callee10)}))),function resetPluginConfigError(_x7){return _resetPluginConfigError.apply(this,arguments)}),savePluginOrders:(_savePluginOrders=asyncToGenerator_default()(regenerator_default.a.mark((function _callee11(_ref11){var newOrders,pluginConfigs,response,newPluginConfigs,_iterator3,_step3,pluginConfig;return regenerator_default.a.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:return newOrders=_ref11.newOrders,pluginConfigs=values.pluginConfigs,_context11.next=4,api.a.update("api/plugin_config/rearrange",{orders:newOrders});case 4:response=_context11.sent,newPluginConfigs=pluginsLogic_objectSpread({},pluginConfigs),_iterator3=pluginsLogic_createForOfIteratorHelper(response);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;)pluginConfig=_step3.value,newPluginConfigs[pluginConfig.plugin]=pluginConfig}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return _context11.abrupt("return",newPluginConfigs);case 9:case"end":return _context11.stop()}}),_callee11)}))),function savePluginOrders(_x8){return _savePluginOrders.apply(this,arguments)})}],repository:[{},{loadRepository:(_loadRepository=asyncToGenerator_default()(regenerator_default.a.mark((function _callee12(){var results,repository,_iterator4,_step4,plugin;return regenerator_default.a.wrap((function _callee12$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:return _context12.next=2,api.a.get("api/organizations/@current/plugins/repository");case 2:results=_context12.sent,repository={},_iterator4=pluginsLogic_createForOfIteratorHelper(results);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;)(plugin=_step4.value).url&&(repository[plugin.url.replace(/\/+$/,"")]=plugin)}catch(err){_iterator4.e(err)}finally{_iterator4.f()}return _context12.abrupt("return",repository);case 7:case"end":return _context12.stop()}}),_callee12)}))),function loadRepository(){return _loadRepository.apply(this,arguments)})}]}},reducers:{plugins:{setUpdateStatus:function setUpdateStatus(state,_ref12){var id=_ref12.id,tag=_ref12.tag,latestTag=_ref12.latestTag;return pluginsLogic_objectSpread(pluginsLogic_objectSpread({},state),{},defineProperty_default()({},id,pluginsLogic_objectSpread(pluginsLogic_objectSpread({},state[id]),{},{tag:tag,latest_tag:latestTag})))}},installingPluginUrl:[null,{installPlugin:function installPlugin(_,_ref13){return _ref13.pluginUrl},installPluginSuccess:function installPluginSuccess(){return null},installPluginFailure:function installPluginFailure(){return null}}],editingPluginId:[null,{editPlugin:function editPlugin(_,_ref14){return _ref14.id},savePluginConfigSuccess:function savePluginConfigSuccess(){return null},uninstallPluginSuccess:function uninstallPluginSuccess(){return null},installPluginSuccess:function installPluginSuccess(_,_ref15){var _Object$values$pop,plugins=_ref15.plugins;return(null===(_Object$values$pop=Object.values(plugins).pop())||void 0===_Object$values$pop?void 0:_Object$values$pop.id)||null}}],editingPluginInitialChanges:[{},{editPlugin:function editPlugin(_,_ref16){return _ref16.pluginConfigChanges},installPluginSuccess:function installPluginSuccess(){return{__enabled:!0}}}],editingSource:[!1,{setEditingSource:function setEditingSource(_,_ref17){return _ref17.editingSource},editPluginSourceSuccess:function editPluginSourceSuccess(){return!1},editPlugin:function editPlugin(){return!1}}],customPluginUrl:["",{setCustomPluginUrl:function setCustomPluginUrl(_,_ref18){return _ref18.customPluginUrl},installPluginSuccess:function installPluginSuccess(){return""}}],localPluginUrl:["",{setLocalPluginUrl:function setLocalPluginUrl(_,_ref19){return _ref19.localPluginUrl},installPluginSuccess:function installPluginSuccess(){return""}}],sourcePluginName:["",{setSourcePluginName:function setSourcePluginName(_,_ref20){return _ref20.sourcePluginName},installPluginSuccess:function installPluginSuccess(){return""}}],pluginError:[null,{setCustomPluginUrl:function setCustomPluginUrl(){return null},installPlugin:function installPlugin(){return null},installPluginFailure:function installPluginFailure(_,_ref21){return _ref21.error||""}}],pluginConfigs:{uninstallPluginSuccess:function uninstallPluginSuccess(pluginConfigs,_ref22){var plugins=_ref22.plugins,newPluginConfigs={};return Object.values(pluginConfigs).forEach((function(pluginConfig){plugins[pluginConfig.plugin]&&(newPluginConfigs[pluginConfig.plugin]=pluginConfig)})),newPluginConfigs}},pluginTab:[PluginTab.Installed,{setPluginTab:function setPluginTab(_,_ref23){return _ref23.tab},installPluginSuccess:function installPluginSuccess(){return PluginTab.Installed}}],updateStatus:[{},{checkForUpdates:function checkForUpdates(_,_ref24){return _ref24.initialUpdateStatus},setUpdateStatus:function setUpdateStatus(state,_ref25){var id=_ref25.id,tag=_ref25.tag,latestTag=_ref25.latestTag;return pluginsLogic_objectSpread(pluginsLogic_objectSpread({},state),{},defineProperty_default()({},id,{upToDate:tag===latestTag}))},setUpdateError:function setUpdateError(state,_ref26){var id=_ref26.id;return pluginsLogic_objectSpread(pluginsLogic_objectSpread({},state),{},defineProperty_default()({},id,{error:!0}))},pluginUpdated:function pluginUpdated(state,_ref27){var id=_ref27.id;return pluginsLogic_objectSpread(pluginsLogic_objectSpread({},state),{},defineProperty_default()({},id,{updated:!0}))}}],pluginsUpdating:[[],{updatePlugin:function updatePlugin(plugins,_ref28){var id=_ref28.id;return[].concat(toConsumableArray_default()(plugins),[id])},pluginUpdated:function pluginUpdated(plugins,_ref29){var id=_ref29.id;return plugins.filter((function(pluginId){return pluginId!==id}))},setUpdateError:function setUpdateError(plugins,_ref30){var id=_ref30.id;return plugins.filter((function(pluginId){return pluginId!==id}))}}],checkingForUpdates:[!1,{checkForUpdates:function checkForUpdates(){return!0},checkedForUpdates:function checkedForUpdates(){return!1}}],pluginOrderSaveable:[!1,{makePluginOrderSaveable:function makePluginOrderSaveable(){return!0},cancelRearranging:function cancelRearranging(){return!1},savePluginOrdersSuccess:function savePluginOrdersSuccess(){return!1}}],rearranging:[!1,{rearrange:function rearrange(){return!0},cancelRearranging:function cancelRearranging(){return!1},savePluginOrdersSuccess:function savePluginOrdersSuccess(){return!1}}],temporaryOrder:[{},{rearrange:function rearrange(){return{}},setTemporaryOrder:function setTemporaryOrder(_,_ref31){return _ref31.temporaryOrder},cancelRearranging:function cancelRearranging(){return{}},savePluginOrdersSuccess:function savePluginOrdersSuccess(){return{}}}],movedPlugins:[{},{rearrange:function rearrange(){return{}},setTemporaryOrder:function setTemporaryOrder(state,_ref32){var movedPluginId=_ref32.movedPluginId;return pluginsLogic_objectSpread(pluginsLogic_objectSpread({},state),{},defineProperty_default()({},movedPluginId,!0))},cancelRearranging:function cancelRearranging(){return{}},savePluginOrdersSuccess:function savePluginOrdersSuccess(){return{}}}],showingLogsPluginId:[null,{showPluginLogs:function showPluginLogs(_,_ref33){return _ref33.id},hidePluginLogs:function hidePluginLogs(){return null}}],lastShownLogsPluginId:[null,{showPluginLogs:function showPluginLogs(_,_ref34){return _ref34.id}}],showingMetricsPluginId:[null,{showPluginMetrics:function showPluginMetrics(_,_ref35){return _ref35.id},hidePluginMetrics:function hidePluginMetrics(){return null}}],searchTerm:[null,{setSearchTerm:function setSearchTerm(_,_ref36){return _ref36.term}}],sectionsOpen:[[PluginSection.Enabled,PluginSection.Disabled],{toggleSectionOpen:function toggleSectionOpen(currentOpenSections,_ref37){var section=_ref37.section;return currentOpenSections.includes(section)?currentOpenSections.filter((function(s){return section!==s})):[].concat(toConsumableArray_default()(currentOpenSections),[section])}}]},selectors:{installedPlugins:[function(s){return[s.plugins,s.pluginConfigs,s.updateStatus]},function(plugins,pluginConfigs,updateStatus){var pluginValues=Object.values(plugins);return pluginValues.map((function(plugin,index){var pluginConfig=pluginsLogic_objectSpread({},pluginConfigs[plugin.id]);if(!pluginConfig){var config={};Object.entries(getConfigSchemaObject(plugin.config_schema)).forEach((function(_ref38){var _ref39=slicedToArray_default()(_ref38,2),key=_ref39[0],def=_ref39[1].default;config[key]=def}));var currentTeam=teamLogic.a.values.currentTeam;if(!currentTeam)throw new Error("Can't list installed plugins with no user or team!");pluginConfig={id:void 0,team_id:currentTeam.id,plugin:plugin.id,enabled:!1,config:config,order:pluginValues.length+index}}return pluginsLogic_objectSpread(pluginsLogic_objectSpread({},plugin),{},{pluginConfig:pluginConfig,updateStatus:updateStatus[plugin.id]})})).sort((function(p1,p2){return p1.name.toUpperCase().localeCompare(p2.name.toUpperCase())}))}],enabledPlugins:[function(s){return[s.installedPlugins,s.movedPlugins,s.temporaryOrder]},function(installedPlugins,movedPlugins,temporaryOrder){return toConsumableArray_default()(installedPlugins.filter((function(_ref40){var pluginConfig=_ref40.pluginConfig;return null==pluginConfig?void 0:pluginConfig.enabled}))).map((function(plugin){var _temporaryOrder$plugi;return pluginsLogic_objectSpread(pluginsLogic_objectSpread({},plugin),{},{pluginConfig:pluginsLogic_objectSpread(pluginsLogic_objectSpread({},plugin.pluginConfig),{},{order:null!==(_temporaryOrder$plugi=temporaryOrder[plugin.id])&&void 0!==_temporaryOrder$plugi?_temporaryOrder$plugi:plugin.pluginConfig.order})})})).sort((function(a,b){return a.pluginConfig.order-b.pluginConfig.order})).map((function(plugin,index){return pluginsLogic_objectSpread(pluginsLogic_objectSpread({},plugin),{},{pluginConfig:pluginsLogic_objectSpread(pluginsLogic_objectSpread({},plugin.pluginConfig),{},{order:index+1}),hasMoved:movedPlugins[plugin.id]})}))}],nextPluginOrder:[function(s){return[s.enabledPlugins]},function(enabledPlugins){return enabledPlugins.reduce((function(maxOrder,plugin){var _plugin$pluginConfig$,_plugin$pluginConfig;return Math.max(null!==(_plugin$pluginConfig$=null===(_plugin$pluginConfig=plugin.pluginConfig)||void 0===_plugin$pluginConfig?void 0:_plugin$pluginConfig.order)&&void 0!==_plugin$pluginConfig$?_plugin$pluginConfig$:0,maxOrder)}),0)+1}],disabledPlugins:[function(s){return[s.installedPlugins]},function(installedPlugins){return installedPlugins.filter((function(_ref41){var pluginConfig=_ref41.pluginConfig;return!(null==pluginConfig?void 0:pluginConfig.enabled)})).sort((function(a,b){return Number(a.is_global)-Number(b.is_global)}))}],pluginsNeedingUpdates:[function(s){return[s.installedPlugins,userLogic.a.selectors.user]},function(installedPlugins,user){return Object(access.c)(null==user?void 0:user.organization)?installedPlugins.filter((function(_ref42){var _user$organization,plugin_type=_ref42.plugin_type,tag=_ref42.tag,latest_tag=_ref42.latest_tag,updateStatus=_ref42.updateStatus;return _ref42.organization_id===(null==user||null===(_user$organization=user.organization)||void 0===_user$organization?void 0:_user$organization.id)&&plugin_type!==PluginInstallationType.Source&&(latest_tag&&tag!==latest_tag||updateStatus&&!updateStatus.error&&(updateStatus.updated||!updateStatus.upToDate))})):[]}],installedPluginUrls:[function(s){return[s.installedPlugins,userLogic.a.selectors.user]},function(installedPlugins,user){var names={};return installedPlugins.forEach((function(plugin){var _user$organization2;plugin.url&&plugin.organization_id===(null==user||null===(_user$organization2=user.organization)||void 0===_user$organization2?void 0:_user$organization2.id)&&(names[plugin.url.replace(/\/+$/,"")]=!0)})),names}],updatablePlugins:[function(s){return[s.installedPlugins,userLogic.a.selectors.user]},function(installedPlugins,user){return installedPlugins.filter((function(plugin){var _plugin$url2,_user$organization3;return plugin.plugin_type!==PluginInstallationType.Source&&!(null===(_plugin$url2=plugin.url)||void 0===_plugin$url2?void 0:_plugin$url2.startsWith("file:"))&&(null==user||null===(_user$organization3=user.organization)||void 0===_user$organization3?void 0:_user$organization3.id)===plugin.organization_id}))}],hasUpdatablePlugins:[function(s){return[s.updatablePlugins]},function(updatablePlugins){return updatablePlugins.length>0}],uninstalledPlugins:[function(s){return[s.installedPluginUrls,s.repository]},function(installedPluginUrls,repository){return Object.keys(repository).filter((function(url){return!installedPluginUrls[url.replace(/\/+$/,"")]})).map((function(url){return repository[url.replace(/\/+$/,"")]})).sort((function(p1,p2){return p1.name.toUpperCase().localeCompare(p2.name.toUpperCase())}))}],editingPlugin:[function(s){return[s.editingPluginId,s.installedPlugins]},function(editingPluginId,installedPlugins){return editingPluginId?installedPlugins.find((function(plugin){return plugin.id===editingPluginId})):null}],loading:[function(s){return[s.pluginsLoading,s.repositoryLoading,s.pluginConfigsLoading]},function(pluginsLoading,repositoryLoading,pluginConfigsLoading){return pluginsLoading||repositoryLoading||pluginConfigsLoading}],showingLogsPlugin:[function(s){return[s.showingLogsPluginId,s.installedPlugins]},function(showingLogsPluginId,installedPlugins){return showingLogsPluginId?installedPlugins.find((function(plugin){return plugin.id===showingLogsPluginId})):null}],lastShownLogsPlugin:[function(s){return[s.lastShownLogsPluginId,s.installedPlugins]},function(lastShownLogsPluginId,installedPlugins){return lastShownLogsPluginId?installedPlugins.find((function(plugin){return plugin.id===lastShownLogsPluginId})):null}],showingMetricsPlugin:[function(s){return[s.showingMetricsPluginId,s.installedPlugins]},function(showingMetricsPluginId,installedPlugins){return showingMetricsPluginId?installedPlugins.find((function(plugin){return plugin.id===showingMetricsPluginId})):null}],filteredUninstalledPlugins:[function(s){return[s.searchTerm,s.uninstalledPlugins]},function(searchTerm,uninstalledPlugins){return searchTerm?uninstalledPlugins.filter((function(plugin){return plugin.name.toLowerCase().includes(searchTerm.toLowerCase())})):uninstalledPlugins}],filteredDisabledPlugins:[function(s){return[s.searchTerm,s.disabledPlugins]},function(searchTerm,disabledPlugins){return searchTerm?disabledPlugins.filter((function(plugin){return plugin.name.toLowerCase().includes(searchTerm.toLowerCase())})):disabledPlugins}],filteredEnabledPlugins:[function(s){return[s.searchTerm,s.enabledPlugins]},function(searchTerm,enabledPlugins){return searchTerm?enabledPlugins.filter((function(plugin){return plugin.name.toLowerCase().includes(searchTerm.toLowerCase())})):enabledPlugins}],filteredPluginsNeedingUpdates:[function(s){return[s.searchTerm,s.pluginsNeedingUpdates]},function(searchTerm,pluginsNeedingUpdates){return searchTerm?pluginsNeedingUpdates.filter((function(plugin){return plugin.name.toLowerCase().includes(searchTerm.toLowerCase())})):pluginsNeedingUpdates}],sortableEnabledPlugins:[function(s){return[s.filteredEnabledPlugins]},function(filteredEnabledPlugins){return filteredEnabledPlugins.filter((function(plugin){return!plugin.capabilities||plugin.capabilities.methods&&(plugin.capabilities.methods.includes("processEvent")||plugin.capabilities.methods.includes("processEventBatch"))}))}],unsortableEnabledPlugins:[function(s){return[s.filteredEnabledPlugins,s.sortableEnabledPlugins]},function(filteredEnabledPlugins,sortableEnabledPlugins){return filteredEnabledPlugins.filter((function(enabledPlugin){return!sortableEnabledPlugins.map((function(plugin){return plugin.name})).includes(enabledPlugin.name)}))}],pluginUrlToMaintainer:[function(s){return[s.repository]},function(repository){for(var pluginNameToMaintainerMap={},_i=0,_Object$values=Object.values(repository);_i<_Object$values.length;_i++){var plugin=_Object$values[_i];pluginNameToMaintainerMap[plugin.url]=plugin.maintainer||""}return pluginNameToMaintainerMap}]},listeners:function listeners(_ref43){var _generateApiKeysIfNeeded,_checkForUpdates,actions=_ref43.actions,values=_ref43.values;return{checkForUpdates:(_checkForUpdates=asyncToGenerator_default()(regenerator_default.a.mark((function _callee13(_ref44,breakpoint){var checkAll,updatablePlugins,pluginsToCheck,_iterator5,_step5,plugin,updates;return regenerator_default.a.wrap((function _callee13$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:checkAll=_ref44.checkAll,breakpoint(),updatablePlugins=values.updatablePlugins,pluginsToCheck=checkAll?updatablePlugins:updatablePlugins.filter((function(plugin){return!plugin.latest_tag})),_iterator5=pluginsLogic_createForOfIteratorHelper(pluginsToCheck),_context13.prev=5,_iterator5.s();case 7:if((_step5=_iterator5.n()).done){_context13.next=22;break}return plugin=_step5.value,_context13.prev=9,_context13.next=12,api.a.get("api/organizations/@current/plugins/".concat(plugin.id,"/check_for_updates"));case 12:updates=_context13.sent,actions.setUpdateStatus(plugin.id,updates.plugin.tag,updates.plugin.latest_tag),_context13.next=19;break;case 16:_context13.prev=16,_context13.t0=_context13.catch(9),actions.setUpdateError(plugin.id);case 19:breakpoint();case 20:_context13.next=7;break;case 22:_context13.next=27;break;case 24:_context13.prev=24,_context13.t1=_context13.catch(5),_iterator5.e(_context13.t1);case 27:return _context13.prev=27,_iterator5.f(),_context13.finish(27);case 30:actions.checkedForUpdates();case 31:case"end":return _context13.stop()}}),_callee13,null,[[5,24,27,30],[9,16]])}))),function checkForUpdates(_x9,_x10){return _checkForUpdates.apply(this,arguments)}),loadPluginsSuccess:function loadPluginsSuccess(){for(var _userLogic$values$use,_userLogic$values$use2,initialUpdateStatus={},_i2=0,_Object$entries=Object.entries(values.plugins);_i2<_Object$entries.length;_i2++){var _Object$entries$_i=slicedToArray_default()(_Object$entries[_i2],2),id=_Object$entries$_i[0],plugin=_Object$entries$_i[1];plugin.latest_tag&&(initialUpdateStatus[id]={upToDate:plugin.tag===plugin.latest_tag})}Object(access.c)(null===(_userLogic$values$use=userLogic.a.values.user)||void 0===_userLogic$values$use?void 0:_userLogic$values$use.organization)&&(actions.checkForUpdates(!1,initialUpdateStatus),0===Object.keys(values.plugins).length&&Object(access.b)(null===(_userLogic$values$use2=userLogic.a.values.user)||void 0===_userLogic$values$use2?void 0:_userLogic$values$use2.organization)&&actions.setPluginTab(PluginTab.Repository))},generateApiKeysIfNeeded:(_generateApiKeysIfNeeded=asyncToGenerator_default()(regenerator_default.a.mark((function _callee14(_ref45,breakpoint){var form,editingPlugin,pluginConfig,configSchema,_yield$api$create,posthogApiKey;return regenerator_default.a.wrap((function _callee14$(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:if(form=_ref45.form,editingPlugin=values.editingPlugin){_context14.next=4;break}return _context14.abrupt("return");case 4:if(pluginConfig=editingPlugin.pluginConfig.config,!(configSchema=getConfigSchemaArray((null==editingPlugin?void 0:editingPlugin.config_schema)||[])).find((function(_ref46){return"posthogApiKey"===_ref46.key}))||(null==pluginConfig?void 0:pluginConfig.posthogApiKey)){_context14.next=20;break}return _context14.prev=8,_context14.next=11,api.a.create("api/personal_api_keys/",{label:"Plugin: ".concat(editingPlugin.name)});case 11:_yield$api$create=_context14.sent,posthogApiKey=_yield$api$create.value,breakpoint(),form.setFieldsValue({posthogApiKey:posthogApiKey}),_context14.next=20;break;case 17:_context14.prev=17,_context14.t0=_context14.catch(8),console.error(_context14.t0);case 20:!configSchema.find((function(_ref47){return"posthogHost"===_ref47.key}))||(null==pluginConfig?void 0:pluginConfig.posthogHost)&&"https://app.posthog.com"!==pluginConfig.posthogHost||form.setFieldsValue({posthogHost:window.location.origin});case 22:case"end":return _context14.stop()}}),_callee14,null,[[8,17]])}))),function generateApiKeysIfNeeded(_x11,_x12){return _generateApiKeysIfNeeded.apply(this,arguments)})}},events:function events(_ref48){var actions=_ref48.actions;return{afterMount:function afterMount(){var _userLogic$values$use3;actions.loadPlugins(),actions.loadPluginConfigs(),Object(access.b)(null===(_userLogic$values$use3=userLogic.a.values.user)||void 0===_userLogic$values$use3?void 0:_userLogic$values$use3.organization)&&actions.loadRepository()}}},path:function path(){return["scenes","plugins","pluginsLogic"]}}),es_switch=__webpack_require__(5476),es_form=__webpack_require__(427),space=__webpack_require__(5512),popconfirm=__webpack_require__(5471),es_button=__webpack_require__(114),es_tag=__webpack_require__(856),LockFilled=__webpack_require__(6104),DeleteOutlined=__webpack_require__(5488),RollbackOutlined=__webpack_require__(6105),GlobalOutlined=__webpack_require__(5564),CodeOutlined=__webpack_require__(5692),utils=__webpack_require__(12),plugin_default=__webpack_require__.p+"images/plugin-default.e3e047768d82d1c3fe24fce102eaef18.svg";function PluginImage_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function PluginImage_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?PluginImage_ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):PluginImage_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function PluginImage(_ref){var url=_ref.url,pluginType=_ref.pluginType,_ref$size=_ref.size,size=void 0===_ref$size?"medium":_ref$size,_useState=Object(react.useState)({image:plugin_default}),_useState2=slicedToArray_default()(_useState,2),state=_useState2[0],setState=_useState2[1],pixelSize="large"===size?100:60;return Object(react.useEffect)((function(){if(null==url?void 0:url.includes("github.com")){var _parseGithubRepoURL=Object(utils.bb)(url),user=_parseGithubRepoURL.user,repo=_parseGithubRepoURL.repo;setState(PluginImage_objectSpread(PluginImage_objectSpread({},state),{},{image:"https://raw.githubusercontent.com/".concat(user,"/").concat(repo,"/main/logo.png")}))}}),[url]),"source"===pluginType?react_default.a.createElement(CodeOutlined.a,{style:{fontSize:pixelSize},className:"plugin-image"}):react_default.a.createElement("div",{className:"plugin-image",style:{width:pixelSize,height:pixelSize,backgroundImage:"url(".concat(state.image,")"),backgroundSize:"contain",backgroundRepeat:"no-repeat"},onError:function onError(){return setState(PluginImage_objectSpread(PluginImage_objectSpread({},state),{},{image:plugin_default}))}})}try{PluginImage.displayName="PluginImage",PluginImage.__docgenInfo={description:"",displayName:"PluginImage",props:{url:{defaultValue:null,description:"",name:"url",required:!1,type:{name:"string"}},pluginType:{defaultValue:null,description:"",name:"pluginType",required:!1,type:{name:"enum",value:[{value:'"local"'},{value:'"custom"'},{value:'"repository"'},{value:'"source"'}]}},size:{defaultValue:{value:"medium"},description:"",name:"size",required:!1,type:{name:"enum",value:[{value:'"large"'},{value:'"medium"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/PluginImage.tsx#PluginImage"]={docgenInfo:PluginImage.__docgenInfo,name:"PluginImage",path:"frontend/src/scenes/plugins/plugin/PluginImage.tsx#PluginImage"})}catch(__react_docgen_typescript_loader_error){}var Drawer=__webpack_require__(862),Tooltip=__webpack_require__(51);function LocalPluginTag(_ref){var url=_ref.url,title=_ref.title,style=_ref.style;return react_default.a.createElement(Tooltip.a,{title:url.substring(5)},react_default.a.createElement(es_tag.a,{color:"purple",onClick:function onClick(){return Object(utils.n)(url.substring(5))},style:style},title||"Local Plugin"))}try{LocalPluginTag.displayName="LocalPluginTag",LocalPluginTag.__docgenInfo={description:"",displayName:"LocalPluginTag",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/LocalPluginTag.tsx#LocalPluginTag"]={docgenInfo:LocalPluginTag.__docgenInfo,name:"LocalPluginTag",path:"frontend/src/scenes/plugins/plugin/LocalPluginTag.tsx#LocalPluginTag"})}catch(__react_docgen_typescript_loader_error){}var react_markdown=__webpack_require__(5789),react_markdown_default=__webpack_require__.n(react_markdown);function SourcePluginTag(_ref){var _ref$title=_ref.title,title=void 0===_ref$title?"Source Code":_ref$title,style=_ref.style;return react_default.a.createElement(es_tag.a,{style:style},title)}try{SourcePluginTag.displayName="SourcePluginTag",SourcePluginTag.__docgenInfo={description:"",displayName:"SourcePluginTag",props:{title:{defaultValue:{value:"Source Code"},description:"",name:"title",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/SourcePluginTag.tsx#SourcePluginTag"]={docgenInfo:SourcePluginTag.__docgenInfo,name:"SourcePluginTag",path:"frontend/src/scenes/plugins/plugin/SourcePluginTag.tsx#SourcePluginTag"})}catch(__react_docgen_typescript_loader_error){}var es_input=__webpack_require__(694),lib_es=__webpack_require__(5688),index_d=__webpack_require__(5861),errors_d=__webpack_require__(5862),types_d=__webpack_require__(5863);function PluginSource_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function PluginSource_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?PluginSource_ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):PluginSource_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var defaultConfig=[{markdown:"Specify your config here"},{key:"name",name:"Person to greet",type:"string",hint:"Used to personalise the property `hello`",default:"world",required:!1}];function PluginSource(){var _useValues=Object(index_esm.useValues)(pluginsLogic),editingPlugin=_useValues.editingPlugin,editingSource=_useValues.editingSource,loading=_useValues.loading,_useActions=Object(index_esm.useActions)(pluginsLogic),setEditingSource=_useActions.setEditingSource,editPluginSource=_useActions.editPluginSource,_Form$useForm=es_form.a.useForm(),form=slicedToArray_default()(_Form$useForm,1)[0];Object(react.useEffect)((function(){if(editingPlugin){var newPlugin=!editingPlugin.source&&0===Object.keys(editingPlugin.config_schema).length;form.setFieldsValue({name:editingPlugin.name||"Untitled Plugin",source:newPlugin?"// Learn more about plugins at: https://posthog.com/docs/plugins/build/overview\n\n// Processes each event, optionally transforming it\nexport function processEvent(event, { config }) {\n    // Some events (such as $identify) don't have properties\n    if (event.properties) {\n        event.properties['hello'] = `Hello ${config.name}`\n    }\n    // Return the event to be ingested, or return null to discard\n    return event\n}\n\n// Runs when the plugin is loaded, allows for preparing it as needed\nexport function setupPlugin (meta) {\n    console.log(`The date is ${new Date().toDateString()}`)\n}\n\n// Runs every hour on the hour\nasync function runEveryHour(meta) {\n    const response = await fetch('https://palabras-aleatorias-public-api.herokuapp.com/random')\n    const data = await response.json()\n    const randomSpanishWord = data.body.Word\n    console.log(`¡${randomSpanishWord.toUpperCase()}!`)\n}":editingPlugin.source,configSchema:JSON.stringify(newPlugin?defaultConfig:editingPlugin.config_schema,null,2)})}else form.resetFields()}),[null==editingPlugin?void 0:editingPlugin.id,editingSource]);var requiredRule={required:!0,message:"Please enter a value!"};return react_default.a.createElement(Drawer.a,{forceRender:!0,visible:editingSource,onClose:function onClose(){form.getFieldValue("source")!==(null==editingPlugin?void 0:editingPlugin.source)?confirm("You have unsaved changes in your plugin. Are you sure you want to exit?")&&setEditingSource(!1):setEditingSource(!1)},width:"min(90vw, 64rem)",title:"Coding Plugin: ".concat(null==editingPlugin?void 0:editingPlugin.name),placement:"left",footer:react_default.a.createElement("div",{style:{textAlign:"right"}},react_default.a.createElement(es_button.a,{onClick:function onClick(){return setEditingSource(!1)},style:{marginRight:16}},"Cancel"),react_default.a.createElement(es_button.a,{type:"primary",loading:loading,onClick:form.submit},"Save"))},react_default.a.createElement(es_form.a,{form:form,layout:"vertical",onFinish:function savePluginSource(values){editingPlugin&&editPluginSource(PluginSource_objectSpread(PluginSource_objectSpread({},values),{},{id:editingPlugin.id,configSchema:JSON.parse(values.configSchema)}))}},editingSource?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("p",null,"Read our"," ",react_default.a.createElement("a",{href:"https://posthog.com/docs/plugins/build/overview",target:"_blank"},"plugin building overview in PostHog Docs")," ","for a good grasp of possibilities.",react_default.a.createElement("br",null),"Once satisfied with your plugin, feel free to"," ",react_default.a.createElement("a",{href:"https://posthog.com/docs/plugins/build/tutorial#submitting-your-plugin",target:"_blank"},"submit it to the official Plugin Library"),"."),react_default.a.createElement(es_form.a.Item,{label:"Name",name:"name",required:!0,rules:[requiredRule]},react_default.a.createElement(es_input.a,null)),react_default.a.createElement(es_form.a.Item,{label:"Source Code",name:"source",required:!0,rules:[requiredRule]},react_default.a.createElement(lib_es.a,{language:"typescript",theme:"vs-dark",height:400,options:{minimap:{enabled:!1}},beforeMount:function beforeMount(monaco){monaco.languages.typescript.typescriptDefaults.addExtraLib("declare module '@posthog/plugin-scaffold' { ".concat(index_d.a," }"),"file:///node_modules/@types/@posthog/plugin-scaffold/index.d.ts"),monaco.languages.typescript.typescriptDefaults.addExtraLib("declare module '@posthog/plugin-scaffold' { ".concat(types_d.a," }"),"file:///node_modules/@types/@posthog/plugin-scaffold/types.d.ts"),monaco.languages.typescript.typescriptDefaults.addExtraLib("declare module '@posthog/plugin-scaffold' { ".concat(errors_d.a," }"),"file:///node_modules/@types/@posthog/plugin-scaffold/errors.d.ts")}})),react_default.a.createElement(es_form.a.Item,{label:"Config Schema JSON",name:"configSchema",required:!0,rules:[requiredRule,{validator:utils.ub}]},react_default.a.createElement(lib_es.a,{language:"json",theme:"vs-dark",height:200}))):null))}var upload=__webpack_require__(6077),UploadOutlined=__webpack_require__(6103);function UploadField(_ref){var value=_ref.value,onChange=_ref.onChange;return react_default.a.createElement(upload.a,{multiple:!1,fileList:(null==value?void 0:value.size)?[value]:[],beforeUpload:function beforeUpload(file){return null==onChange||onChange(file),!1},onRemove:function onRemove(){return null==onChange||onChange(null),!1},className:"ph-ignore-input"},react_default.a.createElement(es_button.a,{icon:react_default.a.createElement(UploadOutlined.a,null)},"Click to upload"))}try{UploadField.displayName="UploadField",UploadField.__docgenInfo={description:"",displayName:"UploadField",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"UploadFile<any> | null"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((file?: UploadFile<any> | null) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/edit/UploadField.tsx#UploadField"]={docgenInfo:UploadField.__docgenInfo,name:"UploadField",path:"frontend/src/scenes/plugins/edit/UploadField.tsx#UploadField"})}catch(__react_docgen_typescript_loader_error){}var es_select=__webpack_require__(207),EditOutlined=__webpack_require__(2558);function PluginField(_ref){var value=_ref.value,onChange=_ref.onChange,fieldConfig=_ref.fieldConfig,_useState=Object(react.useState)(!1),_useState2=slicedToArray_default()(_useState,2),editingSecret=_useState2[0],setEditingSecret=_useState2[1];return!fieldConfig.secret||editingSecret||!value||value!==SECRET_FIELD_VALUE&&value.name!==SECRET_FIELD_VALUE?"attachment"===fieldConfig.type?react_default.a.createElement(UploadField,{value:value,onChange:onChange}):"string"===fieldConfig.type?react_default.a.createElement(es_input.a,{value:value,onChange:onChange,autoFocus:editingSecret,className:"ph-no-capture"}):"choice"===fieldConfig.type?react_default.a.createElement(es_select.a,{dropdownMatchSelectWidth:!1,value:value,className:"ph-no-capture",onChange:onChange,showSearch:!0},fieldConfig.choices.map((function(choice){return react_default.a.createElement(es_select.a.Option,{value:choice,key:choice},choice)}))):react_default.a.createElement("strong",{style:{color:"var(--danger)"}},'Unknown field type "',react_default.a.createElement("code",null,fieldConfig.type),'".',react_default.a.createElement("br",null),"You may need to upgrade PostHog!"):react_default.a.createElement(es_button.a,{icon:react_default.a.createElement(EditOutlined.a,null),onClick:function onClick(){null==onChange||onChange(fieldConfig.default||""),setEditingSecret(!0)}},"Reset secret ","attachment"===fieldConfig.type?"attachment":"field")}try{PluginField.displayName="PluginField",PluginField.__docgenInfo={description:"",displayName:"PluginField",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"any"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((value: any) => void)"}},fieldConfig:{defaultValue:null,description:"",name:"fieldConfig",required:!0,type:{name:"PluginConfigSchema"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/edit/PluginField.tsx#PluginField"]={docgenInfo:PluginField.__docgenInfo,name:"PluginField",path:"frontend/src/scenes/plugins/edit/PluginField.tsx#PluginField"})}catch(__react_docgen_typescript_loader_error){}var PreflightCheck_logic=__webpack_require__(58),capabilitiesInfo={processEvent:"Read + modify access to events before ingestion",processEventBatch:"Read + modify access to events before ingestion, in batches",onEvent:"Read-only access to events",onSnapshot:"Read-only access to session recording events",exportEvents:"Read-only access to events, optimized for export",runEveryMinute:"Runs a task every minute",runEveryHour:"Runs a task every hour",runEveryDay:"Runs a task every day"},PlayCircleOutlined=__webpack_require__(5594),SettingOutlined=__webpack_require__(5521),CheckOutlined=__webpack_require__(863),CloseOutlined=__webpack_require__(239),tooltip=__webpack_require__(264),input_number=__webpack_require__(5509),es_radio=__webpack_require__(1141),date_picker=__webpack_require__(6092),Modal=__webpack_require__(345),Modal_default=__webpack_require__.n(Modal),react_toastify=__webpack_require__(63),interfaceJobsLogic=Object(index_esm.kea)({props:{},key:function key(props){return"".concat(props.pluginId,"_").concat(props.jobName)},connect:{actions:[pluginsLogic,["showPluginLogs"]]},actions:{setIsJobModalOpen:function setIsJobModalOpen(isOpen){return{isOpen:isOpen}},setRunJobAvailable:function setRunJobAvailable(isAvailable){return{isAvailable:isAvailable}},runJob:function runJob(form){return{form:form}},playButtonOnClick:function playButtonOnClick(form,jobHasEmptyPayload){return{form:form,jobHasEmptyPayload:jobHasEmptyPayload}},setRunJobAvailableTimeout:function setRunJobAvailableTimeout(timeout){return{timeout:timeout}}},reducers:{isJobModalOpen:[!1,{setIsJobModalOpen:function setIsJobModalOpen(_,_ref){return _ref.isOpen}}],runJobAvailable:[!0,{setRunJobAvailable:function setRunJobAvailable(_,_ref2){return _ref2.isAvailable}}],runJobAvailableTimeout:[null,{setRunJobAvailableTimeout:function setRunJobAvailableTimeout(_,_ref3){return _ref3.timeout}}]},listeners:function listeners(_ref4){var _runJob,actions=_ref4.actions,props=_ref4.props,values=_ref4.values;return{runJob:(_runJob=asyncToGenerator_default()(regenerator_default.a.mark((function _callee(_ref5){var form,formValues,_i,_Object$entries,_props$jobSpecPayload,_Object$entries$_i,fieldKey,fieldValue;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return form=_ref5.form,_context.prev=1,_context.next=4,form.validateFields();case 4:_context.next=9;break;case 6:return _context.prev=6,_context.t0=_context.catch(1),_context.abrupt("return");case 9:for(actions.setIsJobModalOpen(!1),formValues=form.getFieldsValue(),_i=0,_Object$entries=Object.entries(formValues);_i<_Object$entries.length;_i++)_Object$entries$_i=slicedToArray_default()(_Object$entries[_i],2),fieldKey=_Object$entries$_i[0],fieldValue=_Object$entries$_i[1],"date"===(null===(_props$jobSpecPayload=props.jobSpecPayload)||void 0===_props$jobSpecPayload?void 0:_props$jobSpecPayload[fieldKey].type)&&(formValues[fieldKey]?formValues[fieldKey]=fieldValue.toISOString():formValues[fieldKey]=null);return _context.prev=12,_context.next=15,api.a.create("api/plugin_config/".concat(props.pluginConfigId,"/job"),{job:{type:props.jobName,payload:form.getFieldsValue()}});case 15:_context.next=21;break;case 17:return _context.prev=17,_context.t1=_context.catch(12),Object(utils.y)("Enqueuing job '".concat(props.jobName,"' failed")),_context.abrupt("return");case 21:actions.showPluginLogs(props.pluginId),actions.setRunJobAvailable(!1),values.runJobAvailableTimeout&&clearTimeout(values.runJobAvailableTimeout),setTimeout((function(){var timeout=actions.setRunJobAvailable(!0);actions.setRunJobAvailableTimeout(timeout)}),15e3),react_toastify.c.success("Job enqueued succesfully.");case 26:case"end":return _context.stop()}}),_callee,null,[[1,6],[12,17]])}))),function runJob(_x){return _runJob.apply(this,arguments)}),playButtonOnClick:function playButtonOnClick(_ref6){var form=_ref6.form,jobHasEmptyPayload=_ref6.jobHasEmptyPayload;values.runJobAvailable&&(jobHasEmptyPayload?actions.runJob(form):actions.setIsJobModalOpen(!0))}}},events:function events(_ref7){var values=_ref7.values;return{beforeUnmount:function beforeUnmount(){values.runJobAvailableTimeout&&clearTimeout(values.runJobAvailableTimeout)}}},path:function path(key){return["scenes","plugins","edit","interfaceJobs","interfaceJobsLogic",key]}}),PluginJobConfiguration_requiredRule={required:!0,message:"Please enter a value!"};function PluginJobConfiguration(_ref){var jobName=_ref.jobName,jobSpec=_ref.jobSpec,pluginConfigId=_ref.pluginConfigId,pluginId=_ref.pluginId;"Export historical events"===jobName&&(jobSpec.payload={dateFrom:{type:"date"},dateTo:{type:"date"}});var logicProps={jobName:jobName,pluginConfigId:pluginConfigId,pluginId:pluginId,jobSpecPayload:jobSpec.payload},_useActions=Object(index_esm.useActions)(interfaceJobsLogic(logicProps)),setIsJobModalOpen=_useActions.setIsJobModalOpen,runJob=_useActions.runJob,playButtonOnClick=_useActions.playButtonOnClick,_useValues=Object(index_esm.useValues)(interfaceJobsLogic(logicProps)),runJobAvailable=_useValues.runJobAvailable,isJobModalOpen=_useValues.isJobModalOpen,jobHasEmptyPayload=0===Object.keys(jobSpec.payload||{}).length,_Form$useForm=es_form.a.useForm(),form=slicedToArray_default()(_Form$useForm,1)[0],configureOrRunJobTooltip=runJobAvailable?jobHasEmptyPayload?"Run job":"Configure and run job":"You already ran this job recently.";return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("span",{style:{marginLeft:10,marginRight:5},onClick:function onClick(){return playButtonOnClick(form,jobHasEmptyPayload)}},react_default.a.createElement(tooltip.a,{title:configureOrRunJobTooltip},jobHasEmptyPayload?react_default.a.createElement(PlayCircleOutlined.a,{className:runJobAvailable?"plugin-run-job-button":"plugin-run-job-button-disabled"}):react_default.a.createElement(SettingOutlined.a,{className:runJobAvailable?"plugin-run-job-button":"plugin-run-job-button-disabled"}))),react_default.a.createElement(Modal_default.a,{visible:isJobModalOpen,onCancel:function onCancel(){return setIsJobModalOpen(!1)},onOk:function onOk(){return runJob(form)},okText:"Run job now",title:"Configuring job '".concat(jobName,"'")},jobSpec.payload?react_default.a.createElement(es_form.a,{form:form,layout:"vertical"},Object.entries(jobSpec.payload).map((function(_ref2){var _ref3=slicedToArray_default()(_ref2,2),key=_ref3[0],options=_ref3[1];return react_default.a.createElement("span",{key:key},react_default.a.createElement(es_form.a.Item,{style:{marginBottom:15},name:key,required:!!options.required,rules:options.required?[PluginJobConfiguration_requiredRule].concat(toConsumableArray_default()("json"===options.type?[{validator:utils.ub}]:[])):[],label:key},"string"===options.type?react_default.a.createElement(es_input.a,null):"number"===options.type?react_default.a.createElement(input_number.a,null):"json"===options.type?react_default.a.createElement(lib_es.a,{options:{codeLens:!1},className:"plugin-job-json-editor",language:"json",height:200}):"boolean"===options.type?react_default.a.createElement(es_radio.a.Group,{id:"propertyValue",buttonStyle:"solid"},react_default.a.createElement(es_radio.a.Button,{value:!0,defaultChecked:!0},react_default.a.createElement(CheckOutlined.a,null)," True"),react_default.a.createElement(es_radio.a.Button,{value:!1},react_default.a.createElement(CloseOutlined.a,null)," False")):"date"===options.type?react_default.a.createElement(date_picker.a,{popupStyle:{zIndex:1061},allowClear:!0,placeholder:"Today",className:"retention-date-picker",suffixIcon:null,use12Hours:!0,showTime:!0}):null))}))):null))}try{PluginJobConfiguration.displayName="PluginJobConfiguration",PluginJobConfiguration.__docgenInfo={description:"",displayName:"PluginJobConfiguration",props:{jobName:{defaultValue:null,description:"",name:"jobName",required:!0,type:{name:"string"}},jobSpec:{defaultValue:null,description:"",name:"jobSpec",required:!0,type:{name:"JobSpec"}},pluginConfigId:{defaultValue:null,description:"",name:"pluginConfigId",required:!0,type:{name:"number"}},pluginId:{defaultValue:null,description:"",name:"pluginId",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/edit/interface-jobs/PluginJobConfiguration.tsx#PluginJobConfiguration"]={docgenInfo:PluginJobConfiguration.__docgenInfo,name:"PluginJobConfiguration",path:"frontend/src/scenes/plugins/edit/interface-jobs/PluginJobConfiguration.tsx#PluginJobConfiguration"})}catch(__react_docgen_typescript_loader_error){}function PluginJobOptions(_ref){var plugin=_ref.plugin,pluginConfigId=_ref.pluginConfigId,capabilities=plugin.capabilities,public_jobs=plugin.public_jobs;return capabilities&&capabilities.jobs&&public_jobs&&0!==public_jobs.length?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("h3",{className:"l3",style:{marginTop:32}},"Jobs (Beta)"),capabilities.jobs.map((function(jobName){if(jobName in public_jobs)return react_default.a.createElement("div",{key:jobName},"Export historical events"===jobName?react_default.a.createElement(Tooltip.a,{title:"Run this plugin on all historical events ingested until now"},react_default.a.createElement("i",null,"Export historical events")):react_default.a.createElement("i",null,jobName),react_default.a.createElement(PluginJobConfiguration,{jobName:jobName,jobSpec:public_jobs[jobName],pluginConfigId:pluginConfigId,pluginId:plugin.id}))}))):react_default.a.createElement(react_default.a.Fragment,null)}try{PluginJobOptions.displayName="PluginJobOptions",PluginJobOptions.__docgenInfo={description:"",displayName:"PluginJobOptions",props:{plugin:{defaultValue:null,description:"",name:"plugin",required:!0,type:{name:"PluginTypeWithConfig"}},pluginConfigId:{defaultValue:null,description:"",name:"pluginConfigId",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/edit/interface-jobs/PluginJobOptions.tsx#PluginJobOptions"]={docgenInfo:PluginJobOptions.__docgenInfo,name:"PluginJobOptions",path:"frontend/src/scenes/plugins/edit/interface-jobs/PluginJobOptions.tsx#PluginJobOptions"})}catch(__react_docgen_typescript_loader_error){}function PluginDrawer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function PluginDrawer_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?PluginDrawer_ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):PluginDrawer_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function EnabledDisabledSwitch(_ref){var value=_ref.value,onChange=_ref.onChange;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(es_switch.a,{checked:value,onChange:onChange}),react_default.a.createElement("strong",{style:{paddingLeft:10}},value?"Enabled":"Disabled"))}var PluginDrawer_SecretFieldIcon=function SecretFieldIcon(){return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(Tooltip.a,{placement:"topLeft",title:"This is a secret write-only field. Its value is not available after saving."},react_default.a.createElement(LockFilled.a,{style:{marginRight:5}})))};function PluginDrawer(){var user=Object(index_esm.useValues)(userLogic.a).user,preflight=Object(index_esm.useValues)(PreflightCheck_logic.a).preflight,_useValues3=Object(index_esm.useValues)(pluginsLogic),editingPlugin=_useValues3.editingPlugin,loading=_useValues3.loading,editingSource=_useValues3.editingSource,editingPluginInitialChanges=_useValues3.editingPluginInitialChanges,_useActions=Object(index_esm.useActions)(pluginsLogic),editPlugin=_useActions.editPlugin,savePluginConfig=_useActions.savePluginConfig,uninstallPlugin=_useActions.uninstallPlugin,setEditingSource=_useActions.setEditingSource,generateApiKeysIfNeeded=_useActions.generateApiKeysIfNeeded,patchPlugin=_useActions.patchPlugin,_Form$useForm=es_form.a.useForm(),form=slicedToArray_default()(_Form$useForm,1)[0],_useState=Object(react.useState)([]),_useState2=slicedToArray_default()(_useState,2),invisibleFields=_useState2[0],setInvisibleFields=_useState2[1],_useState3=Object(react.useState)([]),_useState4=slicedToArray_default()(_useState3,2),requiredFields=_useState4[0],setRequiredFields=_useState4[1];Object(react.useEffect)((function(){editingPlugin?(form.setFieldsValue(PluginDrawer_objectSpread(PluginDrawer_objectSpread({},editingPlugin.pluginConfig.config||function defaultConfigForPlugin(plugin){var _step,config={},_iterator=_createForOfIteratorHelper(getConfigSchemaArray(plugin.config_schema));try{for(_iterator.s();!(_step=_iterator.n()).done;){var field=_step.value;field.key&&void 0!==field.default&&(config[field.key]=field.default)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return config}(editingPlugin)),{},{__enabled:editingPlugin.pluginConfig.enabled},editingPluginInitialChanges)),generateApiKeysIfNeeded(form)):form.resetFields(),updateInvisibleAndRequiredFields()}),[null==editingPlugin?void 0:editingPlugin.id,null==editingPlugin?void 0:editingPlugin.config_schema]);var updateInvisibleAndRequiredFields=function updateInvisibleAndRequiredFields(){determineAndSetInvisibleFields(),determineAndSetRequiredFields()},determineAndSetInvisibleFields=function determineAndSetInvisibleFields(){for(var fieldsToSetAsInvisible=[],_i=0,_Object$values=Object.values(getConfigSchemaArray((null==editingPlugin?void 0:editingPlugin.config_schema)||{}));_i<_Object$values.length;_i++){var field=_Object$values[_i];if(field.visible_if&&field.key)field.visible_if.every((function(_ref2){var _ref3=slicedToArray_default()(_ref2,2),targetFieldName=_ref3[0],targetFieldValue=_ref3[1];return doFieldRequirementsMatch(form,targetFieldName,targetFieldValue)}))||fieldsToSetAsInvisible.push(field.key)}setInvisibleFields(fieldsToSetAsInvisible)},determineAndSetRequiredFields=function determineAndSetRequiredFields(){for(var fieldsToSetAsRequired=[],_i2=0,_Object$values2=Object.values(getConfigSchemaArray((null==editingPlugin?void 0:editingPlugin.config_schema)||{}));_i2<_Object$values2.length;_i2++){var field=_Object$values2[_i2];if(field.required_if&&Array.isArray(field.required_if)&&field.key)field.required_if.every((function(_ref4){var _ref5=slicedToArray_default()(_ref4,2),targetFieldName=_ref5[0],targetFieldValue=_ref5[1];return doFieldRequirementsMatch(form,targetFieldName,targetFieldValue)}))&&fieldsToSetAsRequired.push(field.key)}setRequiredFields(fieldsToSetAsRequired)},isValidField=function isValidField(fieldConfig){return"choice"!==fieldConfig.type||function isValidChoiceConfig(fieldConfig){return Array.isArray(fieldConfig.choices)&&!!fieldConfig.choices.length&&!fieldConfig.choices.find((function(c){return"string"!=typeof c}))&&!fieldConfig.secret}(fieldConfig)};return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(Drawer.a,{forceRender:!0,visible:!!editingPlugin,onClose:function onClose(){return editPlugin(null)},width:"min(90vw, 500px)",title:null==editingPlugin?void 0:editingPlugin.name,"data-attr":"plugin-drawer",footer:react_default.a.createElement("div",{style:{display:"flex"}},react_default.a.createElement(space.b,{style:{flexGrow:1}},editingPlugin&&!editingPlugin.is_global&&Object(access.c)(null==user?void 0:user.organization,editingPlugin.organization_id)&&react_default.a.createElement(popconfirm.a,{placement:"topLeft",title:"Are you sure you wish to uninstall this plugin completely?",onConfirm:function onConfirm(){return uninstallPlugin(editingPlugin.name)},okText:"Uninstall",cancelText:"Cancel",className:"plugins-popconfirm"},react_default.a.createElement(es_button.a,{style:{color:"var(--danger)",padding:4},type:"text",icon:react_default.a.createElement(DeleteOutlined.a,null),"data-attr":"plugin-uninstall"},"Uninstall")),(null==preflight?void 0:preflight.cloud)&&editingPlugin&&Object(access.b)(null==user?void 0:user.organization)&&(editingPlugin.is_global?react_default.a.createElement(Tooltip.a,{title:react_default.a.createElement(react_default.a.Fragment,null,"This plugin can currently be used by other organizations in this instance of PostHog. This action will ",react_default.a.createElement("b",null,"disable and hide it")," for all organizations other than yours.")},react_default.a.createElement(es_button.a,{type:"text",icon:react_default.a.createElement(RollbackOutlined.a,null),onClick:function onClick(){return patchPlugin(editingPlugin.id,{is_global:!1})},style:{padding:4}},"Make local")):react_default.a.createElement(Tooltip.a,{title:react_default.a.createElement(react_default.a.Fragment,null,"This action will mark this plugin as installed for"," ",react_default.a.createElement("b",null,"all organizations")," in this instance of PostHog.")},react_default.a.createElement(es_button.a,{type:"text",icon:react_default.a.createElement(GlobalOutlined.a,null),onClick:function onClick(){return patchPlugin(editingPlugin.id,{is_global:!0})},style:{padding:4}},"Make global")))),react_default.a.createElement(space.b,null,react_default.a.createElement(es_button.a,{onClick:function onClick(){return editPlugin(null)},"data-attr":"plugin-drawer-cancel"},"Cancel"),react_default.a.createElement(es_button.a,{type:"primary",loading:loading,onClick:form.submit,"data-attr":"plugin-drawer-save"},"Save")))},react_default.a.createElement(es_form.a,{form:form,layout:"vertical",name:"basic",onFinish:savePluginConfig},editingPlugin?react_default.a.createElement("div",null,react_default.a.createElement("div",{style:{display:"flex",marginBottom:16}},react_default.a.createElement(PluginImage,{pluginType:editingPlugin.plugin_type,url:editingPlugin.url,size:"large"}),react_default.a.createElement("div",{style:{flexGrow:1,paddingLeft:16}},Object(utils.w)(editingPlugin.description),react_default.a.createElement("div",{style:{marginTop:5}},"local"===(null==editingPlugin?void 0:editingPlugin.plugin_type)&&editingPlugin.url?react_default.a.createElement(LocalPluginTag,{url:editingPlugin.url,title:"Installed Locally"}):"source"===editingPlugin.plugin_type?react_default.a.createElement(SourcePluginTag,null):null,editingPlugin.url&&react_default.a.createElement("a",{href:editingPlugin.url},react_default.a.createElement("i",null,"⤷ Learn more"))),react_default.a.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:5}},react_default.a.createElement(es_form.a.Item,{fieldKey:"__enabled",name:"__enabled",style:{display:"inline-block",marginBottom:0},"data-attr":"plugin-enabled-switch"},react_default.a.createElement(EnabledDisabledSwitch,null))))),"source"===editingPlugin.plugin_type?react_default.a.createElement("div",null,react_default.a.createElement(es_button.a,{type:editingSource?"default":"primary",icon:react_default.a.createElement(CodeOutlined.a,null),onClick:function onClick(){return setEditingSource(!editingSource)},"data-attr":"plugin-edit-source"},"Edit Source")):null,editingPlugin.capabilities&&Object.keys(editingPlugin.capabilities).length>0?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("h3",{className:"l3",style:{marginTop:32}},"Capabilities"),react_default.a.createElement("div",{style:{marginTop:5}},[].concat(toConsumableArray_default()(editingPlugin.capabilities.methods),toConsumableArray_default()(editingPlugin.capabilities.scheduled_tasks)).filter((function(capability){return!["setupPlugin","teardownPlugin"].includes(capability)})).map((function(capability){return react_default.a.createElement(Tooltip.a,{title:capabilitiesInfo[capability]||"",key:capability},react_default.a.createElement(es_tag.a,{className:"plugin-capabilities-tag"},capability))})),editingPlugin.capabilities.jobs.map((function(jobName){return react_default.a.createElement(Tooltip.a,{title:"Custom job",key:jobName},react_default.a.createElement(es_tag.a,{className:"plugin-capabilities-tag"},jobName))})))):null,editingPlugin.pluginConfig.id&&react_default.a.createElement(PluginJobOptions,{plugin:editingPlugin,pluginConfigId:editingPlugin.pluginConfig.id}),react_default.a.createElement("h3",{className:"l3",style:{marginTop:32}},"Configuration"),0===getConfigSchemaArray(editingPlugin.config_schema).length?react_default.a.createElement("div",null,"This plugin is not configurable."):null,getConfigSchemaArray(editingPlugin.config_schema).map((function(fieldConfig,index){return react_default.a.createElement(react_default.a.Fragment,{key:fieldConfig.key||"__key__".concat(index)},fieldConfig.markdown&&react_default.a.createElement(react_markdown_default.a,{source:fieldConfig.markdown,linkTarget:"_blank"}),fieldConfig.type&&isValidField(fieldConfig)?react_default.a.createElement(es_form.a.Item,{hidden:!!fieldConfig.key&&invisibleFields.includes(fieldConfig.key),label:react_default.a.createElement(react_default.a.Fragment,null,fieldConfig.secret&&react_default.a.createElement(PluginDrawer_SecretFieldIcon,null),fieldConfig.name||fieldConfig.key),extra:fieldConfig.hint&&react_default.a.createElement("small",null,react_default.a.createElement("div",{style:{height:2}}),react_default.a.createElement(react_markdown_default.a,{source:fieldConfig.hint,linkTarget:"_blank"})),name:fieldConfig.key,required:fieldConfig.required||!!fieldConfig.key&&requiredFields.includes(fieldConfig.key),rules:[{required:fieldConfig.required||!!fieldConfig.key&&requiredFields.includes(fieldConfig.key),message:"Please enter a value!"}]},react_default.a.createElement(PluginField,{fieldConfig:fieldConfig,onChange:updateInvisibleAndRequiredFields})):react_default.a.createElement(react_default.a.Fragment,null,fieldConfig.type?react_default.a.createElement("p",{style:{color:"var(--danger)"}},"Invalid config field ",react_default.a.createElement("i",null,fieldConfig.name||fieldConfig.key),"."):null))}))):null)),"source"===(null==editingPlugin?void 0:editingPlugin.plugin_type)?react_default.a.createElement(PluginSource,null):null)}var row=__webpack_require__(354),col=__webpack_require__(231),card=__webpack_require__(5508),InfoCircleOutlined=__webpack_require__(681),DownOutlined=__webpack_require__(581),WarningOutlined=__webpack_require__(5527),LoadingOutlined=__webpack_require__(370),LineChartOutlined=__webpack_require__(5529),UnorderedListOutlined=__webpack_require__(5588),CloudDownloadOutlined=__webpack_require__(6107),popover=__webpack_require__(2491),dayjs_min=__webpack_require__(31),dayjs_min_default=__webpack_require__.n(dayjs_min),ClearOutlined=__webpack_require__(6106),CodeSnippet=__webpack_require__(45);function PluginError(_ref){var error=_ref.error,reset=_ref.reset;return error?react_default.a.createElement(popover.a,{title:react_default.a.createElement("div",{style:{textAlign:"center"}},dayjs_min_default()(error.time).format("YYYY-MM-DD - HH:mm:ss")),content:react_default.a.createElement(react_default.a.Fragment,null,reset?react_default.a.createElement(es_button.a,{size:"small",onClick:reset,style:{float:"right",marginLeft:10}},react_default.a.createElement(ClearOutlined.a,null)," Delete"):null,react_default.a.createElement("div",null,error.name?react_default.a.createElement("strong",null,error.name,": "):"",error.message),error.stack?react_default.a.createElement(CodeSnippet.a,{wrap:!0,style:{fontSize:10},language:CodeSnippet.b.JavaScript},error.stack):null,error.event?react_default.a.createElement(CodeSnippet.a,{wrap:!0,style:{fontSize:10},language:CodeSnippet.b.JSON},JSON.stringify(error.event,null,2)):null),trigger:"click",placement:"top"},react_default.a.createElement(es_tag.a,{color:"red",style:{cursor:"pointer"}},"ERROR")):null}try{PluginError.displayName="PluginError",PluginError.__docgenInfo={description:"",displayName:"PluginError",props:{error:{defaultValue:null,description:"",name:"error",required:!0,type:{name:"PluginErrorType"}},reset:{defaultValue:null,description:"",name:"reset",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/PluginError.tsx#PluginError"]={docgenInfo:PluginError.__docgenInfo,name:"PluginError",path:"frontend/src/scenes/plugins/plugin/PluginError.tsx#PluginError"})}catch(__react_docgen_typescript_loader_error){}function CommunityPluginTag(_ref){var isCommunity=_ref.isCommunity;return react_default.a.createElement(Tooltip.a,{title:isCommunity?"This plugin was built by a community memeber, not the PostHog team.":"This plugin was built by the PostHog team."},react_default.a.createElement(es_tag.a,{color:isCommunity?"cyan":"geekblue"},isCommunity?"Community":"Official"))}try{CommunityPluginTag.displayName="CommunityPluginTag",CommunityPluginTag.__docgenInfo={description:"",displayName:"CommunityPluginTag",props:{isCommunity:{defaultValue:null,description:"",name:"isCommunity",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/CommunityPluginTag.tsx#CommunityPluginTag"]={docgenInfo:CommunityPluginTag.__docgenInfo,name:"CommunityPluginTag",path:"frontend/src/scenes/plugins/plugin/CommunityPluginTag.tsx#CommunityPluginTag"})}catch(__react_docgen_typescript_loader_error){}__webpack_require__(864);function SHATag(_ref){var tag=_ref.tag;return tag.match(/^[a-f0-9]{40}$/)?react_default.a.createElement("code",null,tag.substring(0,7)):react_default.a.createElement("code",null,tag)}function UpdateAvailable(_ref2){var url=_ref2.url,tag=_ref2.tag,latestTag=_ref2.latestTag,compareUrl="";return url.match(/^https:\/\/(www.|)github.com\//)&&(compareUrl="".concat(url,"/compare/").concat(tag,"...").concat(latestTag)),url.match(/^https:\/\/(www.|)gitlab.com\//)&&(compareUrl="".concat(url,"/-/compare/").concat(tag,"...").concat(latestTag)),react_default.a.createElement(Tooltip.a,{title:react_default.a.createElement("div",null,"Installed: ",react_default.a.createElement(SHATag,{tag:tag}),react_default.a.createElement("br",null),"Latest: ",react_default.a.createElement(SHATag,{tag:latestTag}),compareUrl?react_default.a.createElement("div",{style:{marginTop:10}},"Click to see the diff"):null)},compareUrl?react_default.a.createElement("a",{href:compareUrl,target:"_blank",rel:"noreferrer noopener"},react_default.a.createElement(es_tag.a,{color:"volcano",style:{cursor:"pointer"}},react_default.a.createElement(CloudDownloadOutlined.a,null)," Update available!")):react_default.a.createElement(es_tag.a,{color:"volcano"},react_default.a.createElement(CloudDownloadOutlined.a,null)," Update available!"))}try{UpdateAvailable.displayName="UpdateAvailable",UpdateAvailable.__docgenInfo={description:"",displayName:"UpdateAvailable",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},tag:{defaultValue:null,description:"",name:"tag",required:!0,type:{name:"string"}},latestTag:{defaultValue:null,description:"",name:"latestTag",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/UpdateAvailable.tsx#UpdateAvailable"]={docgenInfo:UpdateAvailable.__docgenInfo,name:"UpdateAvailable",path:"frontend/src/scenes/plugins/plugin/UpdateAvailable.tsx#UpdateAvailable"})}catch(__react_docgen_typescript_loader_error){}var LinkButton=__webpack_require__(263),PluginUpdateButton_PluginUpdateButton=function PluginUpdateButton(_ref){var updateStatus=_ref.updateStatus,pluginId=_ref.pluginId,rearranging=_ref.rearranging,_useActions=Object(index_esm.useActions)(pluginsLogic),editPlugin=_useActions.editPlugin,updatePlugin=_useActions.updatePlugin,pluginsUpdating=Object(index_esm.useValues)(pluginsLogic).pluginsUpdating;return react_default.a.createElement(es_button.a,{type:(null==updateStatus?void 0:updateStatus.updated)?"default":"primary",className:"padding-under-500",onClick:function onClick(){return(null==updateStatus?void 0:updateStatus.updated)?editPlugin(pluginId):updatePlugin(pluginId)},loading:pluginsUpdating.includes(pluginId),icon:(null==updateStatus?void 0:updateStatus.updated)?react_default.a.createElement(CheckOutlined.a,null):react_default.a.createElement(CloudDownloadOutlined.a,null),disabled:rearranging,"data-attr":"plugin-update"},react_default.a.createElement("span",{className:"show-over-500"},(null==updateStatus?void 0:updateStatus.updated)?"Updated":"Update"))};try{PluginUpdateButton_PluginUpdateButton.displayName="PluginUpdateButton",PluginUpdateButton_PluginUpdateButton.__docgenInfo={description:"",displayName:"PluginUpdateButton",props:{updateStatus:{defaultValue:null,description:"",name:"updateStatus",required:!0,type:{name:"PluginUpdateStatusType | undefined"}},pluginId:{defaultValue:null,description:"",name:"pluginId",required:!0,type:{name:"number"}},rearranging:{defaultValue:null,description:"",name:"rearranging",required:!0,type:{name:"boolean | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/PluginUpdateButton.tsx#PluginUpdateButton"]={docgenInfo:PluginUpdateButton_PluginUpdateButton.__docgenInfo,name:"PluginUpdateButton",path:"frontend/src/scenes/plugins/plugin/PluginUpdateButton.tsx#PluginUpdateButton"})}catch(__react_docgen_typescript_loader_error){}function PluginAboutButton(_ref){var url=_ref.url,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled;return react_default.a.createElement(space.b,null,react_default.a.createElement(Tooltip.a,{title:"About"},react_default.a.createElement(LinkButton.a,{to:url,target:"_blank",rel:"noopener noreferrer",disabled:disabled},react_default.a.createElement(InfoCircleOutlined.a,null))))}function PluginCard(_ref2){var _pluginConfig$enabled,plugin=_ref2.plugin,error=_ref2.error,maintainer=_ref2.maintainer,showUpdateButton=_ref2.showUpdateButton,order=_ref2.order,maxOrder=_ref2.maxOrder,rearranging=_ref2.rearranging,_ref2$DragColumn=_ref2.DragColumn,DragColumn=void 0===_ref2$DragColumn?function(_ref3){var children=_ref3.children;return react_default.a.createElement(col.a,{className:"order-handle"},children)}:_ref2$DragColumn,_ref2$unorderedPlugin=_ref2.unorderedPlugin,unorderedPlugin=void 0!==_ref2$unorderedPlugin&&_ref2$unorderedPlugin,name=plugin.name,description=plugin.description,url=plugin.url,pluginType=plugin.plugin_type,pluginConfig=plugin.pluginConfig,tag=plugin.tag,latestTag=plugin.latest_tag,pluginId=plugin.id,updateStatus=plugin.updateStatus,hasMoved=plugin.hasMoved,is_global=plugin.is_global,organization_id=plugin.organization_id,organization_name=plugin.organization_name,_useActions=Object(index_esm.useActions)(pluginsLogic),editPlugin=_useActions.editPlugin,toggleEnabled=_useActions.toggleEnabled,installPlugin=_useActions.installPlugin,resetPluginConfigError=_useActions.resetPluginConfigError,rearrange=_useActions.rearrange,showPluginLogs=_useActions.showPluginLogs,showPluginMetrics=_useActions.showPluginMetrics,_useValues=Object(index_esm.useValues)(pluginsLogic),loading=_useValues.loading,installingPluginUrl=_useValues.installingPluginUrl,checkingForUpdates=_useValues.checkingForUpdates,pluginUrlToMaintainer=_useValues.pluginUrlToMaintainer,user=Object(index_esm.useValues)(userLogic.a).user,hasSpecifiedMaintainer=maintainer||plugin.url&&pluginUrlToMaintainer[plugin.url],pluginMaintainer=maintainer||pluginUrlToMaintainer[plugin.url||""];return react_default.a.createElement(col.a,{style:{width:"100%",marginBottom:20},className:"plugins-scene-plugin-card-col".concat(rearranging?" rearranging":""),"data-attr":"plugin-card-".concat(pluginConfig?"installed":"available")},react_default.a.createElement(card.a,{className:"plugins-scene-plugin-card"},react_default.a.createElement(row.a,{align:"middle",className:"plugin-card-row"},"number"==typeof order&&"number"==typeof maxOrder?react_default.a.createElement(DragColumn,null,react_default.a.createElement("div",{className:"arrow".concat(1===order?" hide":"")},react_default.a.createElement(DownOutlined.a,null)),react_default.a.createElement("div",null,react_default.a.createElement(es_tag.a,{color:hasMoved?"#bd0225":"#555",onClick:rearrange},order)),react_default.a.createElement("div",{className:"arrow".concat(order===maxOrder?" hide":"")},react_default.a.createElement(DownOutlined.a,null))):null,unorderedPlugin?react_default.a.createElement(Tooltip.a,{title:"This plugin does not do any processing in order.",placement:"topRight"},react_default.a.createElement(col.a,null,react_default.a.createElement(es_tag.a,{color:"#555"},"-"))):null,pluginConfig&&react_default.a.createElement(col.a,null,react_default.a.createElement(popconfirm.a,{placement:"topLeft",title:"Are you sure you wish to ".concat(pluginConfig.enabled?"disable":"enable"," this plugin?"),onConfirm:function onConfirm(){return pluginConfig.id?toggleEnabled({id:pluginConfig.id,enabled:!pluginConfig.enabled}):editPlugin(pluginId||null,{__enabled:!0})},okText:"Yes",cancelText:"No",disabled:rearranging},react_default.a.createElement(es_switch.a,{checked:null!==(_pluginConfig$enabled=pluginConfig.enabled)&&void 0!==_pluginConfig$enabled&&_pluginConfig$enabled,disabled:rearranging}))),react_default.a.createElement(col.a,{className:pluginConfig?"hide-plugin-image-below-500":""},react_default.a.createElement(PluginImage,{pluginType:pluginType,url:url})),react_default.a.createElement(col.a,{style:{flex:1}},react_default.a.createElement("div",null,react_default.a.createElement("strong",{style:{marginRight:8}},name),hasSpecifiedMaintainer&&react_default.a.createElement(CommunityPluginTag,{isCommunity:"community"===pluginMaintainer}),(null==pluginConfig?void 0:pluginConfig.error)?react_default.a.createElement(PluginError,{error:pluginConfig.error,reset:function reset(){return resetPluginConfigError((null==pluginConfig?void 0:pluginConfig.id)||0)}}):error?react_default.a.createElement(PluginError,{error:error}):null,is_global&&react_default.a.createElement(es_tag.a,{color:"blue"},react_default.a.createElement(GlobalOutlined.a,null)," Managed by ",organization_name),Object(access.c)(null==user?void 0:user.organization,organization_id)&&react_default.a.createElement(react_default.a.Fragment,null,(null==url?void 0:url.startsWith("file:"))?react_default.a.createElement(LocalPluginTag,{url:url,title:"Local"}):null,(null==updateStatus?void 0:updateStatus.error)?react_default.a.createElement(es_tag.a,{color:"red"},react_default.a.createElement(WarningOutlined.a,null)," Error checking for updates"):!checkingForUpdates||updateStatus||pluginType===PluginInstallationType.Source||(null==url?void 0:url.startsWith("file:"))?url&&latestTag&&tag?tag===latestTag?react_default.a.createElement(es_tag.a,{color:"green"},react_default.a.createElement(CheckOutlined.a,null)," Up to date"):react_default.a.createElement(UpdateAvailable,{url:url,tag:tag,latestTag:latestTag}):null:react_default.a.createElement(es_tag.a,{color:"blue"},react_default.a.createElement(LoadingOutlined.a,null)," Checking for updates…"),pluginType===PluginInstallationType.Source?react_default.a.createElement(SourcePluginTag,null):null)),react_default.a.createElement("div",null,Object(utils.w)(description))),react_default.a.createElement(col.a,null,react_default.a.createElement(space.b,null,url&&react_default.a.createElement(PluginAboutButton,{url:url,disabled:rearranging}),showUpdateButton&&pluginId?react_default.a.createElement(PluginUpdateButton_PluginUpdateButton,{updateStatus:updateStatus,pluginId:pluginId,rearranging:rearranging}):pluginId?react_default.a.createElement(react_default.a.Fragment,null,Object.keys(plugin.metrics||{}).length>0?react_default.a.createElement(space.b,null,react_default.a.createElement(Tooltip.a,{title:"Metrics"},react_default.a.createElement(es_button.a,{onClick:function onClick(){return showPluginMetrics(pluginId)}},react_default.a.createElement(LineChartOutlined.a,null)))):null,react_default.a.createElement(Tooltip.a,{title:(null==pluginConfig?void 0:pluginConfig.id)?"Logs":"Logs – enable the plugin for the first time to view them"},react_default.a.createElement(es_button.a,{className:"padding-under-500",disabled:rearranging||!(null==pluginConfig?void 0:pluginConfig.id),onClick:function onClick(){return showPluginLogs(pluginId)},"data-attr":"plugin-logs"},react_default.a.createElement(UnorderedListOutlined.a,null))),react_default.a.createElement(Tooltip.a,{title:"Configure"},react_default.a.createElement(es_button.a,{type:"primary",className:"padding-under-500",disabled:rearranging,onClick:function onClick(){return editPlugin(pluginId)},"data-attr":"plugin-configure"},react_default.a.createElement(SettingOutlined.a,null)))):pluginId?null:react_default.a.createElement(es_button.a,{type:"primary",className:"padding-under-500",loading:loading&&installingPluginUrl===url,disabled:loading&&installingPluginUrl!==url,onClick:url?function(){return installPlugin(url,PluginInstallationType.Repository)}:void 0,icon:react_default.a.createElement(CloudDownloadOutlined.a,null),"data-attr":"plugin-install"},react_default.a.createElement("span",{className:"show-over-500"},"Install")))))))}try{PluginAboutButton.displayName="PluginAboutButton",PluginAboutButton.__docgenInfo={description:"",displayName:"PluginAboutButton",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},disabled:{defaultValue:{value:"false"},description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/PluginCard.tsx#PluginAboutButton"]={docgenInfo:PluginAboutButton.__docgenInfo,name:"PluginAboutButton",path:"frontend/src/scenes/plugins/plugin/PluginCard.tsx#PluginAboutButton"})}catch(__react_docgen_typescript_loader_error){}try{PluginCard.displayName="PluginCard",PluginCard.__docgenInfo={description:"",displayName:"PluginCard",props:{plugin:{defaultValue:null,description:"",name:"plugin",required:!0,type:{name:"Partial<PluginTypeWithConfig>"}},pluginConfig:{defaultValue:null,description:"",name:"pluginConfig",required:!1,type:{name:"PluginConfigType"}},error:{defaultValue:null,description:"",name:"error",required:!1,type:{name:"PluginErrorType"}},maintainer:{defaultValue:null,description:"",name:"maintainer",required:!1,type:{name:"string"}},showUpdateButton:{defaultValue:null,description:"",name:"showUpdateButton",required:!1,type:{name:"boolean"}},order:{defaultValue:null,description:"",name:"order",required:!1,type:{name:"number"}},maxOrder:{defaultValue:null,description:"",name:"maxOrder",required:!1,type:{name:"number"}},rearranging:{defaultValue:null,description:"",name:"rearranging",required:!1,type:{name:"boolean"}},DragColumn:{defaultValue:{value:'({ children }) => <Col className="order-handle">{children}</Col>'},description:"",name:"DragColumn",required:!1,type:{name:"ComponentClass<{}, any> | FC<{}>"}},unorderedPlugin:{defaultValue:{value:"false"},description:"",name:"unorderedPlugin",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/PluginCard.tsx#PluginCard"]={docgenInfo:PluginCard.__docgenInfo,name:"PluginCard",path:"frontend/src/scenes/plugins/plugin/PluginCard.tsx#PluginCard"})}catch(__react_docgen_typescript_loader_error){}var PageHeader=__webpack_require__(209),skeleton=__webpack_require__(1161);function PluginLoading(){return react_default.a.createElement(react_default.a.Fragment,null,[1,2,3].map((function(i){return react_default.a.createElement(col.a,{key:i,style:{marginBottom:20,width:"100%"},className:"plugins-scene-plugin-card-col"},react_default.a.createElement(card.a,{className:"plugins-scene-plugin-card"},react_default.a.createElement(row.a,{align:"middle",className:"plugin-card-row"},react_default.a.createElement(col.a,{className:"hide-plugin-image-below-500"},react_default.a.createElement(skeleton.a.Avatar,{active:!0,size:"large",shape:"square"})),react_default.a.createElement(col.a,{style:{flex:1}},react_default.a.createElement(skeleton.a,{title:!1,paragraph:{rows:2},active:!0})),react_default.a.createElement(col.a,null,react_default.a.createElement("span",{className:"show-over-500"},react_default.a.createElement(skeleton.a.Button,{style:{width:100}})),react_default.a.createElement("span",{className:"hide-over-500"},react_default.a.createElement(skeleton.a.Button,{style:{width:32}}))))))})))}function PluginsSearch(){var _useValues=Object(index_esm.useValues)(pluginsLogic),searchTerm=_useValues.searchTerm,rearranging=_useValues.rearranging,setSearchTerm=Object(index_esm.useActions)(pluginsLogic).setSearchTerm;return react_default.a.createElement(es_input.a.Search,{"data-attr":"plugins-search",placeholder:"Start typing to search for a plugin",autoFocus:!0,value:searchTerm||"",onChange:function onChange(e){return setSearchTerm(e.target.value)},enterButton:!0,allowClear:!0,style:{maxWidth:400,marginTop:5,marginBottom:10},disabled:rearranging})}var RepositorySection,CaretDownOutlined=__webpack_require__(2563),CaretRightOutlined=__webpack_require__(5876);function RepositoryTab(){var _useValues=Object(index_esm.useValues)(pluginsLogic),repositoryLoading=_useValues.repositoryLoading,filteredUninstalledPlugins=_useValues.filteredUninstalledPlugins,_useState=Object(react.useState)([RepositorySection.Official]),_useState2=slicedToArray_default()(_useState,2),repositorySectionsOpen=_useState2[0],setRepositorySectionsOpen=_useState2[1],officialPlugins=filteredUninstalledPlugins.filter((function(plugin){return"official"===plugin.maintainer})),communityPlugins=filteredUninstalledPlugins.filter((function(plugin){return"community"===plugin.maintainer})),toggleRepositorySectionOpen=function toggleRepositorySectionOpen(section){repositorySectionsOpen.includes(section)?setRepositorySectionsOpen(repositorySectionsOpen.filter((function(s){return section!==s}))):setRepositorySectionsOpen([].concat(toConsumableArray_default()(repositorySectionsOpen),[section]))};return react_default.a.createElement("div",null,react_default.a.createElement(PageHeader.b,{subtitle:"Plugin Repository"}),react_default.a.createElement(PluginsSearch,null),react_default.a.createElement("div",null,(!repositoryLoading||filteredUninstalledPlugins.length>0)&&react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(row.a,{gutter:16,style:{marginTop:16,display:"block"}},react_default.a.createElement("div",{className:"plugins-repository-tab-section-header",onClick:function onClick(){return toggleRepositorySectionOpen(RepositorySection.Official)}},react_default.a.createElement(PageHeader.b,{subtitle:react_default.a.createElement(react_default.a.Fragment,null,repositorySectionsOpen.includes(RepositorySection.Official)?react_default.a.createElement(CaretDownOutlined.a,null):react_default.a.createElement(CaretRightOutlined.a,null)," Official Plugins (".concat(officialPlugins.length,")"))})),repositorySectionsOpen.includes(RepositorySection.Official)&&react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(col.a,{span:24},officialPlugins.length>0?"Official plugins are built and maintained by the PostHog team.":"You have already installed all official plugins!"),react_default.a.createElement("br",null),officialPlugins.map((function(plugin){return react_default.a.createElement(PluginCard,{key:plugin.url,plugin:{name:plugin.name,url:plugin.url,description:plugin.description},maintainer:plugin.maintainer})})))),react_default.a.createElement(row.a,{gutter:16,style:{marginTop:16,display:"block"}},react_default.a.createElement("div",{className:"plugins-repository-tab-section-header",onClick:function onClick(){return toggleRepositorySectionOpen(RepositorySection.Community)}},react_default.a.createElement(PageHeader.b,{subtitle:react_default.a.createElement(react_default.a.Fragment,null,repositorySectionsOpen.includes(RepositorySection.Community)?react_default.a.createElement(CaretDownOutlined.a,null):react_default.a.createElement(CaretRightOutlined.a,null)," Community Plugins (".concat(communityPlugins.length,")"))})),repositorySectionsOpen.includes(RepositorySection.Community)&&react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(col.a,{span:24},communityPlugins.length>0?react_default.a.createElement("span",null,"Community plugins are not built nor maintained by the PostHog team."," ",react_default.a.createElement("a",{href:"https://posthog.com/docs/plugins/build",target:"_blank",rel:"noopener"},"Anyone, including you, can build a plugin.")):"You have already installed all community plugins!"),react_default.a.createElement("br",null),communityPlugins.map((function(plugin){return react_default.a.createElement(PluginCard,{key:plugin.url,plugin:{name:plugin.name,url:plugin.url,description:plugin.description},maintainer:plugin.maintainer})})))))),repositoryLoading&&0===filteredUninstalledPlugins.length&&react_default.a.createElement(row.a,{gutter:16},react_default.a.createElement(PluginLoading,null)))}!function(RepositorySection){RepositorySection.Official="official",RepositorySection.Community="community"}(RepositorySection||(RepositorySection={}));var Search=__webpack_require__(2413),Search_default=__webpack_require__.n(Search),ResizableTable=__webpack_require__(572),types=__webpack_require__(9),pluginLogsLogic=(__webpack_require__(196),Object(index_esm.kea)({props:{},key:function key(_ref){return _ref.pluginConfigId},connect:{values:[teamLogic.a,["currentTeamId"]]},actions:{clearPluginLogsBackground:!0,markLogsEnd:!0},loaders:function loaders(_ref2){var _loadPluginLogsBackgroundPoll,_loadPluginLogsMore,_loadPluginLogsSearch,_loadPluginLogsInitially,pluginConfigId=_ref2.props.pluginConfigId,values=_ref2.values,actions=_ref2.actions,cache=_ref2.cache;return{pluginLogs:{__default:[],loadPluginLogsInitially:(_loadPluginLogsInitially=asyncToGenerator_default()(regenerator_default.a.mark((function _callee(){var response;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,api.a.get("api/projects/".concat(values.currentTeamId,"/plugin_configs/").concat(pluginConfigId,"/logs?limit=").concat(50));case 2:return response=_context.sent,cache.pollingInterval=setInterval(actions.loadPluginLogsBackgroundPoll,2e3),actions.clearPluginLogsBackground(),_context.abrupt("return",response.results);case 6:case"end":return _context.stop()}}),_callee)}))),function loadPluginLogsInitially(){return _loadPluginLogsInitially.apply(this,arguments)}),loadPluginLogsSearch:(_loadPluginLogsSearch=asyncToGenerator_default()(regenerator_default.a.mark((function _callee2(searchTerm){var response;return regenerator_default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api.a.get("api/projects/".concat(values.currentTeamId,"/plugin_configs/").concat(pluginConfigId,"/logs?limit=").concat(50,"&search=").concat(searchTerm));case 2:return response=_context2.sent,actions.clearPluginLogsBackground(),_context2.abrupt("return",response.results);case 5:case"end":return _context2.stop()}}),_callee2)}))),function loadPluginLogsSearch(_x){return _loadPluginLogsSearch.apply(this,arguments)}),loadPluginLogsMore:(_loadPluginLogsMore=asyncToGenerator_default()(regenerator_default.a.mark((function _callee3(){var before,search,response;return regenerator_default.a.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return before=values.trailingEntry?"&before="+values.trailingEntry.timestamp:"",search=values.searchTerm?"&search=".concat(values.searchTerm):"",_context3.next=4,api.a.get("api/projects/".concat(values.currentTeamId,"/plugin_configs/").concat(pluginConfigId,"/logs?limit=").concat(50).concat(before).concat(search));case 4:return(response=_context3.sent).count<50&&actions.markLogsEnd(),_context3.abrupt("return",[].concat(toConsumableArray_default()(values.pluginLogs),toConsumableArray_default()(response.results)));case 7:case"end":return _context3.stop()}}),_callee3)}))),function loadPluginLogsMore(){return _loadPluginLogsMore.apply(this,arguments)}),revealBackground:function revealBackground(){var newArray=[].concat(toConsumableArray_default()(values.pluginLogsBackground),toConsumableArray_default()(values.pluginLogs));return actions.clearPluginLogsBackground(),newArray}},pluginLogsBackground:{__default:[],loadPluginLogsBackgroundPoll:(_loadPluginLogsBackgroundPoll=asyncToGenerator_default()(regenerator_default.a.mark((function _callee4(){var after,search,response;return regenerator_default.a.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(!values.pluginLogsLoading){_context4.next=2;break}return _context4.abrupt("return",values.pluginLogsBackground);case 2:return after=values.leadingEntry?"after="+values.leadingEntry.timestamp:"",search=values.searchTerm?"search=".concat(values.searchTerm):"",_context4.next=6,api.a.get("api/projects/".concat(values.currentTeamId,"/plugin_configs/").concat(pluginConfigId,"/logs?").concat([after,search].filter(Boolean).join("&")));case 6:return response=_context4.sent,_context4.abrupt("return",[].concat(toConsumableArray_default()(response.results),toConsumableArray_default()(values.pluginLogsBackground)));case 8:case"end":return _context4.stop()}}),_callee4)}))),function loadPluginLogsBackgroundPoll(){return _loadPluginLogsBackgroundPoll.apply(this,arguments)})}}},reducers:{pluginLogsBackground:[[],{clearPluginLogsBackground:function clearPluginLogsBackground(){return[]}}],searchTerm:["",{loadPluginLogsSearch:function loadPluginLogsSearch(_,searchTerm){return searchTerm||""}}],isThereMoreToLoad:[!0,{loadPluginLogsInitiallySuccess:function loadPluginLogsInitiallySuccess(_,_ref3){return _ref3.pluginLogs.length>=50},markLogsEnd:function markLogsEnd(){return!1}}]},selectors:function selectors(_ref4){var _selectors=_ref4.selectors;return{leadingEntry:[function(){return[_selectors.pluginLogs,_selectors.pluginLogsBackground]},function(pluginLogs,pluginLogsBackground){return pluginLogsBackground.length?pluginLogsBackground[0]:pluginLogs.length?pluginLogs[0]:null}],trailingEntry:[function(){return[_selectors.pluginLogs,_selectors.pluginLogsBackground]},function(pluginLogs,pluginLogsBackground){return pluginLogs.length?pluginLogs[pluginLogs.length-1]:pluginLogsBackground.length?pluginLogsBackground[pluginLogsBackground.length-1]:null}]}},events:function events(_ref5){var actions=_ref5.actions,cache=_ref5.cache;return{afterMount:function afterMount(){actions.loadPluginLogsInitially()},beforeUnmount:function beforeUnmount(){clearInterval(cache.pollingInterval)}}},path:function path(key){return["scenes","plugins","plugin","pluginLogsLogic",key]}}));var columns=[{title:"Timestamp",key:"timestamp",dataIndex:"timestamp",span:3,render:function render(timestamp){return dayjs_min_default()(timestamp).format("YYYY-MM-DD HH:mm:ss.SSS UTC")}},{title:"Source",key:"source",dataIndex:"source",span:1},{title:"Type",key:"type",dataIndex:"type",span:1,render:function PluginLogEntryTypeDisplay(type){var color;switch(type){case types.r.Debug:color="var(--muted)";break;case types.r.Log:color="var(--text-default)";break;case types.r.Info:color="var(--blue)";break;case types.r.Warn:color="var(--warning)";break;case types.r.Error:color="var(--danger)"}return react_default.a.createElement("span",{style:{color:color}},type)}},{title:"Message",key:"message",dataIndex:"message",span:6}];function PluginLogs(_ref){var pluginConfigId=_ref.pluginConfigId,logic=pluginLogsLogic({pluginConfigId:pluginConfigId}),_useValues=Object(index_esm.useValues)(logic),pluginLogs=_useValues.pluginLogs,pluginLogsLoading=_useValues.pluginLogsLoading,pluginLogsBackground=_useValues.pluginLogsBackground,isThereMoreToLoad=_useValues.isThereMoreToLoad,_useActions=Object(index_esm.useActions)(logic),revealBackground=_useActions.revealBackground,loadPluginLogsMore=_useActions.loadPluginLogsMore,loadPluginLogsSearch=_useActions.loadPluginLogsSearch;return react_default.a.createElement(space.b,{direction:"vertical",style:{flexGrow:1},className:"ph-no-capture plugin-logs"},react_default.a.createElement(row.a,null,react_default.a.createElement(Search_default.a,{loading:pluginLogsLoading,onSearch:function onSearch(term){return loadPluginLogsSearch(term)},placeholder:"Search for messages containing…",allowClear:!0})),react_default.a.createElement(row.a,null,react_default.a.createElement(es_button.a,{onClick:revealBackground,loading:pluginLogsLoading,style:{flexGrow:1},disabled:!pluginLogsBackground.length,icon:react_default.a.createElement(LoadingOutlined.a,null)},pluginLogsBackground.length?"Load ".concat(Object(utils.eb)(pluginLogsBackground.length,"newer entry","newer entries")):"No new entries")),react_default.a.createElement(ResizableTable.b,{dataSource:pluginLogs,columns:columns,loading:pluginLogsLoading,size:"small",className:"ph-no-capture",rowKey:"id",style:{flexGrow:1},pagination:{pageSize:200,hideOnSinglePage:!0}}),!!pluginLogs.length&&react_default.a.createElement(row.a,null,react_default.a.createElement(es_button.a,{onClick:loadPluginLogsMore,loading:pluginLogsLoading,style:{flexGrow:1},disabled:!isThereMoreToLoad},isThereMoreToLoad?"Load up to ".concat(50," older entries"):"No older entries")))}try{PluginLogs.displayName="PluginLogs",PluginLogs.__docgenInfo={description:"",displayName:"PluginLogs",props:{pluginConfigId:{defaultValue:null,description:"",name:"pluginConfigId",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/PluginLogs.tsx#PluginLogs"]={docgenInfo:PluginLogs.__docgenInfo,name:"PluginLogs",path:"frontend/src/scenes/plugins/plugin/PluginLogs.tsx#PluginLogs"})}catch(__react_docgen_typescript_loader_error){}var drawer=__webpack_require__(5474);function LogsDrawer(){var _useValues=Object(index_esm.useValues)(pluginsLogic),showingLogsPlugin=_useValues.showingLogsPlugin,lastShownLogsPlugin=_useValues.lastShownLogsPlugin,hidePluginLogs=Object(index_esm.useActions)(pluginsLogic).hidePluginLogs;return react_default.a.createElement(drawer.a,{visible:!!showingLogsPlugin,onClose:hidePluginLogs,width:"min(90vw, 80rem)",title:"Viewing Plugin Logs: ".concat(null==lastShownLogsPlugin?void 0:lastShownLogsPlugin.name),placement:"left",destroyOnClose:!0},!!lastShownLogsPlugin&&react_default.a.createElement(PluginLogs,{pluginConfigId:lastShownLogsPlugin.pluginConfig.id}))}var metrics_drawer=__webpack_require__(5864),metrics_drawer_default=__webpack_require__.n(metrics_drawer),metrics_drawer_options={insert:"head",singleton:!1},viz=(injectStylesIntoStyleTag_default()(metrics_drawer_default.a,metrics_drawer_options),metrics_drawer_default.a.locals,__webpack_require__(582)),insightLogic=__webpack_require__(30);function MetricsChart_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function MetricsChart_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?MetricsChart_ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):MetricsChart_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var baseFilters={insight:"TRENDS",interval:"day",display:"ActionsLineGraph",filter_test_accounts:!1,actions:[],new_entity:[],date_from:"-30d",refresh:!0};function MetricsChart(_ref){var plugin=_ref.plugin,eventFilters=Object.entries(plugin.metrics||{}).map((function(_ref2){var _ref3=slicedToArray_default()(_ref2,2),metricName=_ref3[0];return{math:_ref3[1],id:"$$plugin_metrics",name:"$$plugin_metrics",type:"events",order:0,math_property:metricName}})),pluginNameFilter={key:"plugin_name",value:[plugin.name],operator:"exact",type:"event"},pluginTagFilter=plugin.tag?{key:"plugin_tag",value:[plugin.tag],operator:"exact",type:"event"}:{},filters=MetricsChart_objectSpread(MetricsChart_objectSpread({},baseFilters),{},{events:eventFilters,properties:[pluginNameFilter,pluginTagFilter]});return react_default.a.createElement("div",{className:"metrics-chart-wrapper"},react_default.a.createElement(index_esm.BindLogic,{logic:insightLogic.b,props:{filters:filters,dashboardItemId:null,doNotPersist:!0}},react_default.a.createElement(viz.b,{filters:filters,showPersonsModal:!1})))}try{MetricsChart.displayName="MetricsChart",MetricsChart.__docgenInfo={description:"",displayName:"MetricsChart",props:{plugin:{defaultValue:null,description:"",name:"plugin",required:!0,type:{name:"PluginTypeWithConfig"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/MetricsChart.tsx#MetricsChart"]={docgenInfo:MetricsChart.__docgenInfo,name:"MetricsChart",path:"frontend/src/scenes/plugins/plugin/MetricsChart.tsx#MetricsChart"})}catch(__react_docgen_typescript_loader_error){}function MetricsDrawer(){var showingMetricsPlugin=Object(index_esm.useValues)(pluginsLogic).showingMetricsPlugin,hidePluginMetrics=Object(index_esm.useActions)(pluginsLogic).hidePluginMetrics;return react_default.a.createElement(drawer.a,{visible:!!showingMetricsPlugin,onClose:hidePluginMetrics,width:"min(90vw, 80rem)",title:"Plugin Metrics".concat(showingMetricsPlugin?": ".concat(showingMetricsPlugin.name):""),placement:"left",destroyOnClose:!0,className:"metrics-drawer"},showingMetricsPlugin?react_default.a.createElement(MetricsChart,{plugin:showingMetricsPlugin}):null)}var empty=__webpack_require__(466);function PluginsEmptyState(){var setPluginTab=Object(index_esm.useActions)(pluginsLogic).setPluginTab,loading=Object(index_esm.useValues)(pluginsLogic).loading,user=Object(index_esm.useValues)(userLogic.a).user;return react_default.a.createElement(react_default.a.Fragment,null,loading?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(PageHeader.b,{subtitle:react_default.a.createElement(react_default.a.Fragment,null," ",react_default.a.createElement(CaretRightOutlined.a,null)," ","Enabled plugins"," "),buttons:react_default.a.createElement(skeleton.a.Button,{style:{width:150}})}),react_default.a.createElement(PluginLoading,null)):react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(PageHeader.b,{subtitle:"Installed plugins"}),react_default.a.createElement(row.a,{gutter:16,style:{marginTop:16}},react_default.a.createElement(col.a,{span:24},react_default.a.createElement(empty.a,{description:react_default.a.createElement("span",null,"You haven't installed any plugins yet")},Object(access.b)(null==user?void 0:user.organization)&&react_default.a.createElement(es_button.a,{type:"default",onClick:function onClick(){return setPluginTab(PluginTab.Repository)}},"Open the Plugin Repository"))))))}function InstalledPlugin(_ref){var plugin=_ref.plugin,showUpdateButton=_ref.showUpdateButton,order=_ref.order,maxOrder=_ref.maxOrder,rearranging=_ref.rearranging,DragColumn=_ref.DragColumn,_ref$unorderedPlugin=_ref.unorderedPlugin,unorderedPlugin=void 0!==_ref$unorderedPlugin&&_ref$unorderedPlugin;return react_default.a.createElement(PluginCard,{key:plugin.id,plugin:plugin,showUpdateButton:showUpdateButton,order:order,maxOrder:maxOrder,rearranging:rearranging,DragColumn:DragColumn,unorderedPlugin:unorderedPlugin})}try{InstalledPlugin.displayName="InstalledPlugin",InstalledPlugin.__docgenInfo={description:"",displayName:"InstalledPlugin",props:{plugin:{defaultValue:null,description:"",name:"plugin",required:!0,type:{name:"PluginTypeWithConfig"}},showUpdateButton:{defaultValue:null,description:"",name:"showUpdateButton",required:!1,type:{name:"boolean"}},order:{defaultValue:null,description:"",name:"order",required:!1,type:{name:"number"}},maxOrder:{defaultValue:null,description:"",name:"maxOrder",required:!1,type:{name:"number"}},rearranging:{defaultValue:null,description:"",name:"rearranging",required:!1,type:{name:"boolean"}},DragColumn:{defaultValue:null,description:"",name:"DragColumn",required:!1,type:{name:"ComponentClass<{}, any> | FC<{}>"}},unorderedPlugin:{defaultValue:{value:"false"},description:"",name:"unorderedPlugin",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/tabs/installed/InstalledPlugin.tsx#InstalledPlugin"]={docgenInfo:InstalledPlugin.__docgenInfo,name:"InstalledPlugin",path:"frontend/src/scenes/plugins/tabs/installed/InstalledPlugin.tsx#InstalledPlugin"})}catch(__react_docgen_typescript_loader_error){}function DisabledPluginSection(){var _useValues=Object(index_esm.useValues)(pluginsLogic),filteredDisabledPlugins=_useValues.filteredDisabledPlugins,sectionsOpen=_useValues.sectionsOpen,disabledPlugins=_useValues.disabledPlugins,toggleSectionOpen=Object(index_esm.useActions)(pluginsLogic).toggleSectionOpen;return 0===disabledPlugins.length?react_default.a.createElement(react_default.a.Fragment,null):react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("div",{className:"plugins-installed-tab-section-header",onClick:function onClick(){return toggleSectionOpen(PluginSection.Disabled)}},react_default.a.createElement(PageHeader.b,{subtitle:react_default.a.createElement(react_default.a.Fragment,null,sectionsOpen.includes(PluginSection.Disabled)?react_default.a.createElement(CaretDownOutlined.a,null):react_default.a.createElement(CaretRightOutlined.a,null)," Installed plugins (".concat(filteredDisabledPlugins.length,")"))})),sectionsOpen.includes(PluginSection.Disabled)?react_default.a.createElement(react_default.a.Fragment,null,filteredDisabledPlugins.length>0?react_default.a.createElement(row.a,{gutter:16,style:{marginTop:16}},filteredDisabledPlugins.map((function(plugin){return react_default.a.createElement(InstalledPlugin,{key:plugin.id,plugin:plugin})}))):react_default.a.createElement("p",{style:{margin:10}},"No plugins match your search.")):null)}var SyncOutlined=__webpack_require__(5482);function UpgradeSection(){var _useActions=Object(index_esm.useActions)(pluginsLogic),checkForUpdates=_useActions.checkForUpdates,toggleSectionOpen=_useActions.toggleSectionOpen,sectionsOpen=Object(index_esm.useValues)(pluginsLogic).sectionsOpen,user=Object(index_esm.useValues)(userLogic.a).user,_useValues3=Object(index_esm.useValues)(pluginsLogic),filteredPluginsNeedingUpdates=_useValues3.filteredPluginsNeedingUpdates,pluginsNeedingUpdates=_useValues3.pluginsNeedingUpdates,checkingForUpdates=_useValues3.checkingForUpdates,installedPluginUrls=_useValues3.installedPluginUrls,updateStatus=_useValues3.updateStatus,rearranging=_useValues3.rearranging,hasUpdatablePlugins=_useValues3.hasUpdatablePlugins,upgradeButton=Object(access.c)(null==user?void 0:user.organization)&&hasUpdatablePlugins&&react_default.a.createElement(es_button.a,{type:"default",icon:pluginsNeedingUpdates.length>0?react_default.a.createElement(SyncOutlined.a,null):react_default.a.createElement(CloudDownloadOutlined.a,null),onClick:function onClick(e){e.stopPropagation(),checkForUpdates(!0)},loading:checkingForUpdates},checkingForUpdates?"Checking plugin ".concat(Object.keys(updateStatus).length+1," out of ").concat(Object.keys(installedPluginUrls).length):pluginsNeedingUpdates.length>0?"Check again for updates":"Check for updates");return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("div",{className:"plugins-installed-tab-section-header",onClick:function onClick(){return toggleSectionOpen(PluginSection.Upgrade)}},react_default.a.createElement(PageHeader.b,{subtitle:react_default.a.createElement(react_default.a.Fragment,null,sectionsOpen.includes(PluginSection.Upgrade)?react_default.a.createElement(CaretDownOutlined.a,null):react_default.a.createElement(CaretRightOutlined.a,null)," Plugins to update (".concat(filteredPluginsNeedingUpdates.length,")")),buttons:!rearranging&&sectionsOpen.includes(PluginSection.Upgrade)&&upgradeButton})),sectionsOpen.includes(PluginSection.Upgrade)?react_default.a.createElement(react_default.a.Fragment,null,pluginsNeedingUpdates.length>0?react_default.a.createElement(row.a,{gutter:16,style:{marginTop:16}},filteredPluginsNeedingUpdates.length>0?react_default.a.createElement(react_default.a.Fragment,null,filteredPluginsNeedingUpdates.map((function(plugin){return react_default.a.createElement(InstalledPlugin,{key:plugin.id,plugin:plugin,showUpdateButton:!0})}))):react_default.a.createElement("p",{style:{margin:10}},"No plugins match your search.")):react_default.a.createElement("p",{style:{margin:10}},"All your plugins are up to date. Great work!")):null)}__webpack_require__(592);var SaveOutlined=__webpack_require__(5577),OrderedListOutlined=__webpack_require__(5578),react_sortable_hoc_esm=__webpack_require__(1154);function EnabledPluginsSection_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function EnabledPluginsSection_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return EnabledPluginsSection_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return EnabledPluginsSection_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function EnabledPluginsSection_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var EnabledPluginsSection_DragColumn=Object(react_sortable_hoc_esm.c)((function(_ref){var children=_ref.children;return react_default.a.createElement(col.a,{className:"order-handle"},children)})),SortablePlugin=Object(react_sortable_hoc_esm.b)((function(_ref2){var plugin=_ref2.plugin,order=_ref2.order,maxOrder=_ref2.maxOrder,rearranging=_ref2.rearranging;return react_default.a.createElement(InstalledPlugin,{plugin:plugin,order:order,maxOrder:maxOrder,rearranging:rearranging,DragColumn:EnabledPluginsSection_DragColumn})})),SortablePlugins=Object(react_sortable_hoc_esm.a)((function(_ref3){var children=_ref3.children;return react_default.a.createElement(row.a,{gutter:16,style:{marginTop:16}},children)}));function EnabledPluginSection(){var user=Object(index_esm.useValues)(userLogic.a).user,_useActions=Object(index_esm.useActions)(pluginsLogic),rearrange=_useActions.rearrange,setTemporaryOrder=_useActions.setTemporaryOrder,cancelRearranging=_useActions.cancelRearranging,savePluginOrders=_useActions.savePluginOrders,makePluginOrderSaveable=_useActions.makePluginOrderSaveable,toggleSectionOpen=_useActions.toggleSectionOpen,_useValues2=Object(index_esm.useValues)(pluginsLogic),enabledPlugins=_useValues2.enabledPlugins,filteredEnabledPlugins=_useValues2.filteredEnabledPlugins,sortableEnabledPlugins=_useValues2.sortableEnabledPlugins,unsortableEnabledPlugins=_useValues2.unsortableEnabledPlugins,rearranging=_useValues2.rearranging,loading=_useValues2.loading,temporaryOrder=_useValues2.temporaryOrder,pluginOrderSaveable=_useValues2.pluginOrderSaveable,searchTerm=_useValues2.searchTerm,sectionsOpen=_useValues2.sectionsOpen,canRearrange=Object(access.a)(null==user?void 0:user.organization)&&sortableEnabledPlugins.length>1,rearrangingButtons=rearranging?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(es_button.a,{type:"primary",icon:react_default.a.createElement(SaveOutlined.a,null),loading:loading,onClick:function onClick(e){e.stopPropagation(),savePluginOrders(temporaryOrder)},disabled:!pluginOrderSaveable},"Save order"),react_default.a.createElement(es_button.a,{type:"default",icon:react_default.a.createElement(CloseOutlined.a,null),onClick:function onClick(e){cancelRearranging(),e.stopPropagation()}},"Cancel")):react_default.a.createElement(Tooltip.a,{title:enabledPlugins.length<=1?"At least two plugins need to be enabled for reordering.":react_default.a.createElement(react_default.a.Fragment,null,searchTerm?"Editing the order of plugins is disabled when searching.":react_default.a.createElement(react_default.a.Fragment,null,"Order matters because event processing with plugins works like a pipe: the event is processed by every enabled plugin ",react_default.a.createElement("b",null,"in sequence"),".")),placement:"top"},react_default.a.createElement(es_button.a,{icon:react_default.a.createElement(OrderedListOutlined.a,null),onClick:function onClick(e){e.stopPropagation(),rearrange()},disabled:!!searchTerm||sortableEnabledPlugins.length<=1},"Edit order")),EnabledPluginsHeader=function EnabledPluginsHeader(){return react_default.a.createElement("div",{className:"plugins-installed-tab-section-header",onClick:function onClick(){return toggleSectionOpen(PluginSection.Enabled)}},react_default.a.createElement(PageHeader.b,{subtitle:react_default.a.createElement(react_default.a.Fragment,null,sectionsOpen.includes(PluginSection.Enabled)?react_default.a.createElement(CaretDownOutlined.a,null):react_default.a.createElement(CaretRightOutlined.a,null)," Enabled plugins (".concat(filteredEnabledPlugins.length,")"),rearranging&&sectionsOpen.includes(PluginSection.Enabled)&&react_default.a.createElement(es_tag.a,{color:"red",style:{fontWeight:"normal",marginLeft:10}},"Reordering in progress")),buttons:react_default.a.createElement(space.b,null,sectionsOpen.includes(PluginSection.Enabled)&&rearrangingButtons)}))};return 0===enabledPlugins.length?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(EnabledPluginsHeader,null),sectionsOpen.includes(PluginSection.Enabled)&&react_default.a.createElement("p",{style:{margin:10}},"No plugins enabled.")):react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(EnabledPluginsHeader,null),sectionsOpen.includes(PluginSection.Enabled)&&react_default.a.createElement(react_default.a.Fragment,null,0===sortableEnabledPlugins.length&&0===unsortableEnabledPlugins.length&&react_default.a.createElement("p",{style:{margin:10}},"No plugins match your search."),canRearrange||rearranging?react_default.a.createElement(react_default.a.Fragment,null,sortableEnabledPlugins.length>0&&react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(SortablePlugins,{useDragHandle:!0,onSortEnd:function onSortEnd(_ref4){var _enabledPlugins$oldIn,oldIndex=_ref4.oldIndex,newIndex=_ref4.newIndex;if(oldIndex!==newIndex){var _step,movedPluginId=null===(_enabledPlugins$oldIn=enabledPlugins[oldIndex])||void 0===_enabledPlugins$oldIn?void 0:_enabledPlugins$oldIn.id,newTemporaryOrder={},_iterator=EnabledPluginsSection_createForOfIteratorHelper(function move(arr,from,to){var clone=toConsumableArray_default()(arr);return Array.prototype.splice.call(clone,to,0,Array.prototype.splice.call(clone,from,1)[0]),clone.map((function(_ref5,order){return{id:_ref5.id,order:order+1}}))}(enabledPlugins,oldIndex,newIndex));try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_step.value,id=_step$value.id,order=_step$value.order;newTemporaryOrder[id]=order}}catch(err){_iterator.e(err)}finally{_iterator.f()}rearranging||rearrange(),setTemporaryOrder(newTemporaryOrder,movedPluginId)}},onSortOver:makePluginOrderSaveable},sortableEnabledPlugins.map((function(plugin,index){return react_default.a.createElement(SortablePlugin,{key:plugin.id,plugin:plugin,index:index,order:index+1,maxOrder:enabledPlugins.length,rearranging:rearranging})}))))):react_default.a.createElement(row.a,{gutter:16,style:{marginTop:16}},sortableEnabledPlugins.length>0&&react_default.a.createElement(react_default.a.Fragment,null,sortableEnabledPlugins.map((function(plugin,index){return react_default.a.createElement(InstalledPlugin,{key:plugin.id,plugin:plugin,order:index+1,maxOrder:filteredEnabledPlugins.length})})))),unsortableEnabledPlugins.map((function(plugin){return react_default.a.createElement(InstalledPlugin,{key:plugin.id,plugin:plugin,maxOrder:enabledPlugins.length,rearranging:rearranging,unorderedPlugin:!0})}))))}function InstalledTab(){return 0===Object(index_esm.useValues)(pluginsLogic).installedPlugins.length?react_default.a.createElement(PluginsEmptyState,null):react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("div",null,react_default.a.createElement(PluginsSearch,null),react_default.a.createElement(UpgradeSection,null),react_default.a.createElement(EnabledPluginSection,null),react_default.a.createElement(DisabledPluginSection,null)),react_default.a.createElement(LogsDrawer,null),react_default.a.createElement(MetricsDrawer,null))}var tabs=__webpack_require__(1755),es_alert=__webpack_require__(695),Title=__webpack_require__(865),Paragraph=__webpack_require__(1771);function SourcePlugin(){var _useValues=Object(index_esm.useValues)(pluginsLogic),sourcePluginName=_useValues.sourcePluginName,pluginError=_useValues.pluginError,loading=_useValues.loading,_useActions=Object(index_esm.useActions)(pluginsLogic),setSourcePluginName=_useActions.setSourcePluginName,installPlugin=_useActions.installPlugin;return react_default.a.createElement("div",{style:{marginTop:16}},react_default.a.createElement(card.a,null,react_default.a.createElement(Title.a,{level:5},"Plugin Editor"),react_default.a.createElement(Paragraph.a,null,"Write your plugin directly in PostHog."," ",react_default.a.createElement("a",{href:"https://posthog.com/docs/plugins/overview",target:"_blank"},"Read the documentation for more information!")),react_default.a.createElement(row.a,{style:{width:"100%"},gutter:16},react_default.a.createElement(col.a,{style:{flex:1}},react_default.a.createElement(es_input.a,{value:sourcePluginName,disabled:loading,onChange:function onChange(e){return setSourcePluginName(e.target.value)},placeholder:'For example: "Hourly Weather Sync Plugin"'})),react_default.a.createElement(col.a,null,react_default.a.createElement(es_button.a,{disabled:loading||!sourcePluginName,loading:loading,type:"default",onClick:function onClick(){return installPlugin(sourcePluginName,PluginInstallationType.Source)}},"Start Coding"))),pluginError?react_default.a.createElement("p",{style:{color:"var(--red)",marginTop:10}},pluginError):null))}function CustomPlugin(){var _useValues=Object(index_esm.useValues)(pluginsLogic),customPluginUrl=_useValues.customPluginUrl,pluginError=_useValues.pluginError,loading=_useValues.loading,_useActions=Object(index_esm.useActions)(pluginsLogic),setCustomPluginUrl=_useActions.setCustomPluginUrl,installPlugin=_useActions.installPlugin;return react_default.a.createElement("div",{style:{marginTop:16}},react_default.a.createElement(card.a,null,react_default.a.createElement(Title.a,{level:5},"Install from GitHub, GitLab or npm"),react_default.a.createElement(Paragraph.a,null,"To install a third-party or custom plugin, paste its URL below. For"," ",react_default.a.createElement("a",{href:"https://docs.github.com/en/github/authenticating-to-github/creating-a-personal-access-token",target:"_blank",rel:"noopener noreferrer"},"GitHub"),", ",react_default.a.createElement("a",{href:"https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html",target:"_blank",rel:"noopener noreferrer"},"GitLab")," and ",react_default.a.createElement("a",{href:"https://docs.npmjs.com/creating-and-viewing-access-tokens",target:"_blank",rel:"noopener noreferrer"},"npm")," ","private repositories, append ",react_default.a.createElement("code",null,"?private_token=TOKEN")," to the end of the URL.",react_default.a.createElement("br",null),react_default.a.createElement("b",{className:"text-warning"},"Warning: Only install plugins from trusted sources.")),react_default.a.createElement(row.a,{style:{width:"100%"},gutter:16},react_default.a.createElement(col.a,{style:{flex:1}},react_default.a.createElement(es_input.a,{value:customPluginUrl,disabled:loading,onChange:function onChange(e){return setCustomPluginUrl(e.target.value)},placeholder:"https://github.com/user/repo"})),react_default.a.createElement(col.a,null,react_default.a.createElement(es_button.a,{disabled:loading||!customPluginUrl,loading:loading,type:"default",onClick:function onClick(){return installPlugin(customPluginUrl,PluginInstallationType.Custom)}},"Fetch and install"))),pluginError?react_default.a.createElement("p",{style:{color:"var(--red)",marginTop:10}},pluginError):null))}function LocalPlugin(){var _useValues=Object(index_esm.useValues)(pluginsLogic),localPluginUrl=_useValues.localPluginUrl,pluginError=_useValues.pluginError,loading=_useValues.loading,_useActions=Object(index_esm.useActions)(pluginsLogic),setLocalPluginUrl=_useActions.setLocalPluginUrl,installPlugin=_useActions.installPlugin;return react_default.a.createElement("div",{style:{marginTop:16}},react_default.a.createElement(card.a,null,react_default.a.createElement(Title.a,{level:5},"Install Local Plugin"),react_default.a.createElement(Paragraph.a,null,"To install a local plugin from this computer/server, give its full path below."),react_default.a.createElement(row.a,{style:{width:"100%"},gutter:16},react_default.a.createElement(col.a,{style:{flex:1}},react_default.a.createElement(es_input.a,{value:localPluginUrl,disabled:loading,onChange:function onChange(e){return setLocalPluginUrl(e.target.value)},placeholder:"/var/posthog/plugins/helloworldplugin"})),react_default.a.createElement(col.a,null,react_default.a.createElement(es_button.a,{disabled:loading||!localPluginUrl,loading:loading,type:"default",onClick:function onClick(){return installPlugin(localPluginUrl,PluginInstallationType.Local)}},"Install"))),pluginError?react_default.a.createElement("p",{style:{color:"var(--red)",marginTop:10}},pluginError):null))}function AdvancedTab(){var preflight=Object(index_esm.useValues)(PreflightCheck_logic.a).preflight,setPluginTab=Object(index_esm.useActions)(pluginsLogic).setPluginTab;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(es_alert.a,{message:"Advanced Features Ahead",description:react_default.a.createElement(react_default.a.Fragment,null,"Create and install your ",react_default.a.createElement("b",null,"own plugins")," or plugins from ",react_default.a.createElement("b",null,"third-parties"),". If you're looking for officially supported plugins, try the"," ",react_default.a.createElement("a",{href:"#",onClick:function onClick(e){e.preventDefault(),setPluginTab(PluginTab.Repository)}},"Plugin Repository"),"."),type:"warning",showIcon:!0}),react_default.a.createElement(PageHeader.b,{subtitle:"Advanced Options"}),react_default.a.createElement(SourcePlugin,null),react_default.a.createElement(CustomPlugin,null),preflight&&!preflight.cloud&&react_default.a.createElement(LocalPlugin,null))}function Plugins_Plugins(_ref){var user=_ref.user,pluginTab=Object(index_esm.useValues)(pluginsLogic).pluginTab,setPluginTab=Object(index_esm.useActions)(pluginsLogic).setPluginTab,TabPane=tabs.a.TabPane;return Object(react.useEffect)((function(){Object(access.d)(user.organization)||(window.location.href="/")}),[user]),Object(access.d)(user.organization)?react_default.a.createElement("div",{className:"plugins-scene"},react_default.a.createElement(PageHeader.a,{title:"Plugins",caption:react_default.a.createElement(react_default.a.Fragment,null,"Plugins enable you to extend PostHog's core data processing functionality.",react_default.a.createElement("br",null),"Make use of verified plugins from the"," ",react_default.a.createElement("a",{href:"https://posthog.com/plugins",target:"_blank"},"Plugin Library")," ","– or"," ",react_default.a.createElement("a",{href:"https://posthog.com/docs/plugins/build",target:"_blank"},"build your own"),".")}),Object(access.c)(user.organization)?react_default.a.createElement(tabs.a,{activeKey:pluginTab,onChange:function onChange(activeKey){return setPluginTab(activeKey)}},react_default.a.createElement(TabPane,{tab:"Installed",key:PluginTab.Installed},react_default.a.createElement(InstalledTab,null)),Object(access.b)(user.organization)&&react_default.a.createElement(TabPane,{tab:"Repository",key:PluginTab.Repository},react_default.a.createElement(RepositoryTab,null)),react_default.a.createElement(TabPane,{tab:"Advanced",key:PluginTab.Advanced},react_default.a.createElement(AdvancedTab,null))):react_default.a.createElement(InstalledTab,null),react_default.a.createElement(PluginDrawer,null)):null}try{Plugins_Plugins.displayName="Plugins",Plugins_Plugins.__docgenInfo={description:"",displayName:"Plugins",props:{user:{defaultValue:null,description:"",name:"user",required:!0,type:{name:"UserType"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/Plugins.tsx#Plugins"]={docgenInfo:Plugins_Plugins.__docgenInfo,name:"Plugins",path:"frontend/src/scenes/plugins/Plugins.tsx#Plugins"})}catch(__react_docgen_typescript_loader_error){}}}]);