(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"./frontend/src/lib/components/ExportButton/ExportButton.tsx":function(U,O,e){"use strict";e.d(O,"a",function(){return n});var B=e("./node_modules/@babel/runtime/helpers/extends.js"),ce=e.n(B),M=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),t=e.n(M),c=e("./node_modules/core-js/modules/es.array.map.js"),f=e.n(c),k=e("./node_modules/core-js/modules/es.regexp.exec.js"),q=e.n(k),ue=e("./node_modules/core-js/modules/es.string.split.js"),Ue=e.n(ue),ee=e("./node_modules/react/index.js"),S=e.n(ee),J=e("./frontend/src/lib/components/LemonButton/index.ts"),F=e("./node_modules/kea/lib/index.esm.js"),L=e("./frontend/src/lib/components/ExportButton/exporterLogic.ts"),Ee=e("./frontend/src/lib/components/LemonDivider/index.ts"),N=e("./frontend/src/scenes/insights/insightLogic.ts"),z=["dashboardId","insightShortId"];function n(E){var P=E.dashboardId,V=E.insightShortId,w=t()(E,z),te={dashboardItemId:V,doNotLoad:!0},W=Object(F.useValues)(Object(N.c)(te)),X=W.supportsCsvExport,A=W.csvExportUrl,T=W.insight,ae=Object(F.useActions)(Object(L.b)({dashboardId:P,insightId:T==null?void 0:T.id})),ge=ae.exportItem,je=Object(F.useValues)(Object(L.b)({dashboardId:P,insightId:T==null?void 0:T.id})),se=je.exportInProgress,x=[];(P||V)&&x.push(L.a.PNG),X&&x.push(L.a.CSV);var _e=function(H){if(H===L.a.CSV){window.open(A,"_blank");return}ge(H)};return S.a.createElement(J.b,ce()({type:"stealth",loading:se,"data-attr":"export-button"},w,{popup:{actionable:!0,placement:"right-start",overlay:S.a.createElement(S.a.Fragment,null,S.a.createElement("h5",null,"File type"),S.a.createElement(Ee.a,null),x.map(function(Q){return S.a.createElement(J.a,{key:Q,fullWidth:!0,type:"stealth",onClick:function(){return _e(Q)},"data-attr":"export-button-".concat(Q.split("/").pop())},".",Q.split("/").pop())}))}}),"Export")}try{n.displayName="ExportButton",n.__docgenInfo={description:"",displayName:"ExportButton",props:{dashboardId:{defaultValue:null,description:"",name:"dashboardId",required:!1,type:{name:"number"}},insightShortId:{defaultValue:null,description:"",name:"insightShortId",required:!1,type:{name:"InsightShortId"}},icon:{defaultValue:null,description:"",name:"icon",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>> | null"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"alt"'},{value:'"default"'},{value:'"highlighted"'},{value:'"primary"'},{value:'"secondary"'},{value:'"tertiary"'},{value:'"stealth"'}]}},fullWidth:{defaultValue:null,description:"Whether the row should take up the parent's full width.",name:"fullWidth",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/ExportButton/ExportButton.tsx#ExportButton"]={docgenInfo:n.__docgenInfo,name:"ExportButton",path:"frontend/src/lib/components/ExportButton/ExportButton.tsx#ExportButton"})}catch(E){}},"./frontend/src/lib/components/ExportButton/exporterLogic.ts":function(U,O,e){"use strict";e.d(O,"a",function(){return Z}),e.d(O,"b",function(){return K});var B=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),ce=e.n(B),M=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),t=e.n(M),c=e("./node_modules/@babel/runtime/regenerator/index.js"),f=e.n(c),k=e("./node_modules/core-js/modules/es.array.concat.js"),q=e.n(k),ue=e("./node_modules/core-js/modules/es.array.iterator.js"),Ue=e.n(ue),ee=e("./node_modules/core-js/modules/es.object.to-string.js"),S=e.n(ee),J=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),F=e.n(J),L=e("./node_modules/core-js/modules/es.object.keys.js"),Ee=e.n(L),N=e("./node_modules/core-js/modules/es.symbol.js"),z=e.n(N),n=e("./node_modules/core-js/modules/es.array.filter.js"),E=e.n(n),P=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),V=e.n(P),w=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),te=e.n(w),W=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),X=e.n(W),A=e("./node_modules/kea/lib/index.esm.js"),T=e("./frontend/src/lib/api.ts"),ae=e("./frontend/src/lib/utils.tsx"),ge=e("./node_modules/posthog-js/dist/es.js"),je=e("./frontend/src/scenes/teamLogic.tsx"),se=e("./frontend/src/lib/components/lemonToast.tsx");function x(d,I){var p=Object.keys(d);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(d);I&&(u=u.filter(function(me){return Object.getOwnPropertyDescriptor(d,me).enumerable})),p.push.apply(p,u)}return p}function _e(d){for(var I=1;I<arguments.length;I++){var p=arguments[I]!=null?arguments[I]:{};I%2?x(Object(p),!0).forEach(function(u){ce()(d,u,p[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(p)):x(Object(p)).forEach(function(u){Object.defineProperty(d,u,Object.getOwnPropertyDescriptor(p,u))})}return d}var Q=1e3,H=10,Z;(function(d){d.PNG="image/png",d.CSV="text/csv",d.PDF="application/pdf"})(Z||(Z={}));var K=Object(A.kea)([Object(A.path)(["lib","components","ExportButton","ExporterLogic"]),Object(A.props)({}),Object(A.key)(function(d){var I=d.dashboardId,p=d.insightId;return"dash:".concat(I,"::insight:").concat(p)}),Object(A.actions)({exportItem:function(I,p,u){return{exportFormat:I,exportContext:p,successCallback:u}},exportItemSuccess:!0,exportItemFailure:!0}),Object(A.reducers)({exportInProgress:[!1,{exportItem:function(){return!0},exportItemSuccess:function(){return!1},exportItemFailure:function(){return!1}}]}),Object(A.listeners)(function(d){var I=d.actions,p=d.props;return{exportItem:function(){var u=t()(f.a.mark(function Me(ye){var he,ne,pe,re,Oe,oe,Fe,De;return f.a.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return he=ye.exportFormat,ne=ye.exportContext,pe=ye.successCallback,se.d.info("Export started..."),re={export_format:he,dashboard:p.dashboardId,insight:p.insightId,total_time_ms:0},Oe=performance.now(),b.prev=4,b.next=7,T.b.create("api/projects/".concat(je.a.values.currentTeamId,"/exports"),_e({export_format:he,dashboard:p.dashboardId,insight:p.insightId},ne||{}));case 7:if(oe=b.sent,oe.id){b.next=10;break}throw new Error("Missing export_id from response");case 10:Fe=T.b.exports.determineExportUrl(oe.id),De=0;case 12:if(!(De<H)){b.next=29;break}if(De++,!oe.has_content){b.next=22;break}return I.exportItemSuccess(),se.d.success("Export complete."),pe==null||pe(),window.open(Fe,"_blank"),re.total_time_ms=performance.now()-Oe,ge.a.capture("export succeeded",re),b.abrupt("return");case 22:return b.next=24,Object(ae.w)(Q);case 24:return b.next=26,T.b.get("api/projects/".concat(je.a.values.currentTeamId,"/exports/").concat(oe.id));case 26:oe=b.sent,b.next=12;break;case 29:throw new Error("Content not loaded in time...");case 32:b.prev=32,b.t0=b.catch(4),I.exportItemFailure(),re.total_time_ms=performance.now()-Oe,ge.a.capture("export failed",re),se.d.error("Export failed: ".concat(JSON.stringify(b.t0)));case 38:case"end":return b.stop()}},Me,null,[[4,32]])}));function me(Me){return u.apply(this,arguments)}return me}()}})])},"./frontend/src/lib/hooks/useKeyboardHotkeys.tsx":function(U,O,e){"use strict";e.d(O,"a",function(){return Ee});var B=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),ce=e.n(B),M=e("./node_modules/core-js/modules/es.array.includes.js"),t=e.n(M),c=e("./node_modules/core-js/modules/es.string.includes.js"),f=e.n(c),k=e("./node_modules/core-js/modules/es.object.to-string.js"),q=e.n(k),ue=e("./node_modules/core-js/modules/es.object.keys.js"),Ue=e.n(ue),ee=e("./node_modules/core-js/modules/es.array.concat.js"),S=e.n(ee),J=e("./frontend/src/lib/hooks/useEventListener.ts"),F=function(z,n){var E=z.composedPath()||z.path;if(!E)return!1;var P=E[0],V=P.tagName||"not an html element";return n.includes(V.toLowerCase())},L=[".hotkey-block",".hotkey-block *"];function Ee(N,z){var n=["input","textarea"];Object(J.a)("keydown",function(E){var P=E.key;if(!(E.metaKey||E.ctrlKey||E.altKey)&&!L.some(function(A){return E.target.matches(A)})){var V=n.includes(E.target.tagName.toLowerCase());if(!(P!=="Escape"&&(V||F(E,n))))for(var w=0,te=Object.keys(N);w<te.length;w++){var W=te[w],X=N[W];if(!(!X||X.disabled)&&P.toLowerCase()===W){E.preventDefault(),X.action();break}}}},void 0,[N].concat(ce()(z||[])))}},"./frontend/src/scenes/dashboard/Dashboard.tsx":function(U,O,e){"use strict";e.r(O),e.d(O,"scene",function(){return _t}),e.d(O,"Dashboard",function(){return Re});var B=e("./node_modules/core-js/modules/es.array.includes.js"),ce=e("./node_modules/core-js/modules/es.string.includes.js"),M=e("./node_modules/react/index.js"),t=e.n(M),c=e("./node_modules/kea/lib/index.esm.js"),f=e("./frontend/src/scenes/dashboard/dashboardLogic.ts"),k=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),q=e.n(k),ue=e("./node_modules/core-js/modules/es.array.map.js"),Ue=e("./node_modules/core-js/modules/es.function.name.js"),ee=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),S=e.n(ee),J=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/DashboardItems.scss"),F=e.n(J),L={};L.insert="head",L.singleton=!1;var Ee=S()(F.a,L),N=F.a.locals||{},z=e("./node_modules/react-grid-layout/index.js"),n=e("./frontend/src/types.ts"),E=e("./frontend/src/models/insightsModel.tsx"),P=e("./node_modules/clsx/dist/clsx.m.js"),V=e("./frontend/src/lib/components/InsightCard/index.tsx"),w=e("./frontend/src/lib/hooks/useResizeObserver.ts");function te(){var s=Object(c.useValues)(f.c),a=s.dashboard,r=s.items,l=s.layouts,o=s.dashboardMode,g=s.placement,j=s.isRefreshing,_=s.highlightedInsightId,y=s.refreshStatus,D=Object(c.useActions)(f.c),G=D.updateLayouts,C=D.updateContainerWidth,m=D.updateItemColor,R=D.removeItem,de=D.refreshAllDashboardItems,Y=Object(c.useActions)(E.a),fe=Y.duplicateInsight,xe=Y.renameInsight,le=Y.moveToDashboard,be=Object(M.useState)(null),Se=q()(be,2),Ie=Se[0],Be=Se[1],Ce=Object(M.useRef)(!1),ie=Object(M.useRef)(null),Pe=Object(P.a)({"dashboard-view-mode":o!==n.k.Edit,"dashboard-edit-mode":o===n.k.Edit}),We=Object(w.b)(),ve=We.width,ze=We.ref,Ke=!ve||ve>f.a.sm;return t.a.createElement("div",{className:"dashboard-items-wrapper",ref:ze},t.a.createElement(z.Responsive,{width:ve||0,className:Pe,isDraggable:o===n.k.Edit,isResizable:o===n.k.Edit,layouts:l,rowHeight:80,margin:[16,16],containerPadding:[0,0],onLayoutChange:function($,i){o===n.k.Edit&&G(i)},onWidthChange:function($,i,h){C($,h)},breakpoints:f.a,resizeHandles:Ke?["s","e","se"]:["s"],cols:f.b,onResize:function($,i,h){(!Ie||Ie.w!==h.w||Ie.h!==h.h)&&Be(h)},onResizeStop:function(){Be(null)},onDrag:function(){Ce.current=!0,ie.current&&window.clearTimeout(ie.current)},onDragStop:function(){ie.current&&window.clearTimeout(ie.current),ie.current=window.setTimeout(function(){Ce.current=!1},250)},draggableCancel:".anticon,.ant-dropdown,table,.ant-popover-content,button,.Popup"},r==null?void 0:r.map(function(v){var $;return t.a.createElement(V.a,{key:v.short_id,insight:v,dashboardId:a==null?void 0:a.id,loading:j(v.short_id),apiErrored:(($=y[v.short_id])===null||$===void 0?void 0:$.error)||!1,highlighted:_&&v.short_id===_,showResizeHandles:o===n.k.Edit,canResizeWidth:Ke,updateColor:function(h){return m(v.id,h)},removeFromDashboard:function(){return R(v)},refresh:function(){return de([v])},rename:function(){return xe(v)},duplicate:function(){return fe(v)},moveToDashboardOld:function(h){return fe(v,h,!0)},moveToDashboard:function(h){var Ve=h.id,yt=h.name;if(!a)throw new Error("must be on a dashboard to move an insight");le(v,a.id,Ve,yt)},showEditingControls:[n.l.Dashboard,n.l.ProjectHomepage].includes(g),showDetailsControls:g!=n.l.Export})})))}var W=e("./frontend/src/lib/components/DateFilter/DateFilter.tsx"),X=e("./node_modules/@ant-design/icons/es/icons/CalendarOutlined.js"),A=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/Dashboard.scss"),T=e.n(A),ae={};ae.insert="head",ae.singleton=!1;var ge=S()(T.a,ae),je=T.a.locals||{},se=e("./frontend/src/lib/hooks/useKeyboardHotkeys.tsx"),x=e("./frontend/src/lib/utils/eventUsageLogic.ts"),_e=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),Q=e("./node_modules/core-js/modules/es.array.fill.js"),H=e("./node_modules/antd/es/card/index.js"),Z=e("./node_modules/antd/es/row/index.js"),K=e("./node_modules/antd/es/col/index.js"),d=e("./node_modules/antd/es/skeleton/index.js"),I=e("./frontend/src/lib/components/Link.tsx"),p=e("./frontend/src/scenes/urls.ts"),u=e("./frontend/src/lib/components/LemonButton/index.ts");function me(s){var a=s.active;return t.a.createElement(H.a,{className:"hide-lte-lg"},t.a.createElement(Z.a,null,t.a.createElement(K.a,{span:12},t.a.createElement(d.a,{paragraph:{rows:1},active:a}),t.a.createElement("div",{className:"mt"},t.a.createElement("div",{className:"mt"},t.a.createElement(d.a.Button,{active:a}),t.a.createElement(d.a.Button,{active:a,style:{marginLeft:4,width:140}})),t.a.createElement("div",{className:"mt"},t.a.createElement(d.a.Button,{active:a}),t.a.createElement(d.a.Button,{active:a,style:{marginLeft:4,width:140}})),t.a.createElement("div",{className:"mt"},t.a.createElement(d.a.Button,{active:a}),t.a.createElement(d.a.Button,{active:a,style:{marginLeft:4,width:140}})))),t.a.createElement(K.a,{span:12},t.a.createElement("div",{className:"skeleton-actions"},t.a.createElement(d.a.Avatar,{active:a,shape:"circle",size:"small"}),t.a.createElement(d.a.Avatar,{active:a,shape:"circle",size:"small"})),t.a.createElement(d.a.Avatar,{active:a,shape:"circle",size:"large",className:"pie-chart"}))))}function Me(){return t.a.createElement("div",{className:"bar-chart ant-skeleton-content"},Array(8).fill(0).map(function(s,a){var r=200,l=40,o=Math.floor(Math.random()*(r-l+1))+l;return t.a.createElement("div",{className:"bar-el ant-skeleton-title",key:a,style:{height:o}})}))}var ye=t.a.memo(Me);function he(s){var a=s.active;return t.a.createElement(H.a,{className:Object(P.a)("ant-skeleton",a&&"ant-skeleton-active")},t.a.createElement(Z.a,null,t.a.createElement(K.a,{span:12},t.a.createElement(d.a,{active:a,paragraph:{rows:1}})),t.a.createElement(K.a,{span:12},t.a.createElement("div",{className:"skeleton-actions"},t.a.createElement(d.a.Avatar,{active:a,shape:"circle",size:"small"}),t.a.createElement(d.a.Avatar,{active:a,shape:"circle",size:"small"})))),t.a.createElement(ye,null))}function ne(s){var a=s.loading,r=Object(c.useValues)(f.c),l=r.dashboard;return t.a.createElement("div",{className:"empty-state"},!a&&t.a.createElement("div",{className:"cta"},t.a.createElement(H.a,{className:"card-elevated"},t.a.createElement("h3",{className:"l3"},"Dashboard empty"),t.a.createElement("p",null,"This dashboard sure would look better with some graphs!"),t.a.createElement("div",{className:"mt text-center"},t.a.createElement(I.a,{to:p.a.insightNew(void 0,l==null?void 0:l.id)},t.a.createElement(u.a,{"data-attr":"dashboard-add-graph-header"},"Add insight"))))),t.a.createElement(Z.a,{gutter:16},t.a.createElement(K.a,{span:24,lg:12},t.a.createElement(me,{active:a})),t.a.createElement(K.a,{span:24,lg:12},t.a.createElement(he,{active:a}))),t.a.createElement(Z.a,{gutter:16,className:"fade-out-graphs"},t.a.createElement(K.a,{span:24,lg:12},t.a.createElement(me,{active:a})),t.a.createElement(K.a,{span:24,lg:12},t.a.createElement(he,{active:a}))))}try{ne.displayName="EmptyDashboardComponent",ne.__docgenInfo={description:"",displayName:"EmptyDashboardComponent",props:{loading:{defaultValue:null,description:"",name:"loading",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/EmptyDashboardComponent.tsx#EmptyDashboardComponent"]={docgenInfo:ne.__docgenInfo,name:"EmptyDashboardComponent",path:"frontend/src/scenes/dashboard/EmptyDashboardComponent.tsx#EmptyDashboardComponent"})}catch(s){}var pe=e("./frontend/src/lib/components/NotFound/index.tsx"),re=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),Oe=e.n(re),oe=e("./node_modules/core-js/modules/es.array.from.js"),Fe=e("./node_modules/core-js/modules/es.string.iterator.js"),De=e("./node_modules/antd/es/dropdown/index.js"),Le=e("./node_modules/antd/es/menu/index.js"),b=e("./node_modules/antd/es/checkbox/index.js"),we=e("./node_modules/antd/es/radio/index.js"),qe=e("./node_modules/antd/es/space/index.js"),et=e("./node_modules/@ant-design/icons/es/icons/DownOutlined.js"),tt=e("./node_modules/@ant-design/icons/es/icons/LoadingOutlined.js"),at=e("./node_modules/@ant-design/icons/es/icons/ReloadOutlined.js"),He=e("./frontend/src/lib/utils.tsx"),st=e("./frontend/src/lib/components/Tooltip.tsx"),nt=e("./frontend/src/lib/dayjs.ts"),Ge=function(){var a=Object(c.useValues)(f.c),r=a.lastRefreshed;return t.a.createElement("span",null,"Last updated ",t.a.createElement("b",null,r?Object(nt.a)(r).fromNow():"a while ago"))},rt=Oe()(Array.from([60,120,300,900],function(s){return{label:Object(He.N)(s),value:s}}));function ot(){var s=Object(c.useValues)(f.c),a=s.itemsLoading,r=s.autoRefresh,l=s.refreshMetrics,o=Object(c.useActions)(f.c),g=o.refreshAllDashboardItemsManual,j=o.setAutoRefresh,_=Object(M.useState)(!1),y=q()(_,2),D=y[0],G=y[1];return t.a.createElement(t.a.Fragment,null,t.a.createElement(De.a.Button,{overlay:t.a.createElement(Le.a,{"data-attr":"auto-refresh-picker",id:"auto-refresh-picker"},t.a.createElement("div",{id:"auto-refresh-check",key:"auto-refresh-check",onClick:function(m){m.stopPropagation(),G(!0),j(!r.enabled,r.interval)}},t.a.createElement(st.a,{title:"Refresh dashboard automatically",placement:"bottomLeft"},t.a.createElement(b.a,{onChange:function(m){m.stopPropagation(),m.preventDefault()},checked:r.enabled}),t.a.createElement("label",{style:{marginLeft:10,cursor:"pointer"}},"Auto refresh"))),t.a.createElement(Le.a.Divider,null),t.a.createElement(Le.a.ItemGroup,{title:"Refresh interval"},t.a.createElement(we.a.Group,{onChange:function(m){j(!0,parseInt(m.target.value))},value:r.interval,style:{width:"100%"}},t.a.createElement(qe.b,{direction:"vertical",style:{width:"100%"}},rt.map(function(C){var m=C.label,R=C.value;return t.a.createElement(we.a,{key:R,value:R,style:{width:"100%"}},m)}))))),trigger:["click"],onClick:function(){return g()},icon:t.a.createElement(et.a,null),disabled:a,buttonsRender:function(m){var R=q()(m,2),de=R[0],Y=R[1];return[t.a.cloneElement(de,{style:{paddingLeft:10}}),Y]},visible:D,onVisibleChange:function(m){return G(m)}},t.a.createElement("span",{className:"dashboard-items-action-icon"},a?t.a.createElement(tt.a,null):t.a.createElement(at.a,null)),t.a.createElement("span",{className:Object(P.a)("dashboard-items-action-refresh-text",{hidden:a})},t.a.createElement(Ge,null)),t.a.createElement("span",{className:Object(P.a)("dashboard-items-action-refresh-text","completed",{hidden:!a})},"Refreshed ",l.completed," out of ",l.total)))}var dt=e("./frontend/src/scenes/insights/EmptyStates/index.ts"),Ot=e("./node_modules/core-js/modules/es.symbol.js"),Dt=e("./node_modules/core-js/modules/es.symbol.description.js"),xt=e("./node_modules/core-js/modules/es.array.filter.js"),It=e("./node_modules/core-js/modules/es.object.to-string.js"),Ct=e("./node_modules/core-js/modules/es.array.concat.js"),Pt=e("./node_modules/core-js/modules/es.array.join.js"),Ye=e("./frontend/src/lib/components/EditableField/EditableField.tsx");function Ae(s){var a=s.onExit,r="aside.ant-layout-sider, .layout-top-content";return Object(M.useEffect)(function(){for(var l=window.document.querySelectorAll(r),o=0;o<l.length;o++)l[o].style.display="none";var g=function(){window.document.fullscreenElement===null&&(a==null||a())};try{window.document.body.requestFullscreen().then(function(){window.addEventListener("fullscreenchange",g,!1)})}catch(j){}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch(j){}return function(){for(var j=window.document.querySelectorAll(r),_=0;_<j.length;_++)j[_].style.display="block";try{window.removeEventListener("fullscreenchange",g,!1),window.document.fullscreenElement!==null&&window.document.exitFullscreen()}catch(y){}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch(y){}}},[]),null}try{Ae.displayName="FullScreen",Ae.__docgenInfo={description:"",displayName:"FullScreen",props:{onExit:{defaultValue:null,description:"",name:"onExit",required:!1,type:{name:"(() => any)"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/FullScreen.tsx#FullScreen"]={docgenInfo:Ae.__docgenInfo,name:"FullScreen",path:"frontend/src/lib/components/FullScreen.tsx#FullScreen"})}catch(s){}var lt=e("./frontend/src/lib/components/LemonButton/More.tsx"),it=e("./frontend/src/lib/components/LemonRow/index.ts"),Ne=e("./frontend/src/lib/components/LemonDivider/index.ts"),$e=e("./frontend/src/lib/components/ObjectTags/ObjectTags.tsx"),ct=e("./frontend/src/lib/components/PageHeader.tsx"),Je=e("./frontend/src/models/dashboardsModel.tsx"),ut=e("./frontend/src/scenes/dashboard/dashboardsLogic.ts"),Xe=e("./frontend/src/scenes/dashboard/ShareModal.tsx"),mt=e("./frontend/src/scenes/userLogic.ts"),Te=e("./frontend/src/lib/constants.tsx"),ht=e("./frontend/src/lib/components/ProfilePicture/ProfileBubbles.tsx"),pt=e("./frontend/src/scenes/dashboard/dashboardCollaboratorsLogic.ts"),ft=e("./frontend/src/lib/components/icons.tsx"),Qe=e("./frontend/src/lib/logic/featureFlagLogic.ts"),bt=e("./frontend/src/lib/components/ExportButton/ExportButton.tsx"),Ze=e("./frontend/src/lib/components/Subscriptions/SubscriptionsModal.tsx"),vt=e("./node_modules/kea-router/lib/index.js");function Et(){var s=Object(c.useValues)(f.c),a=s.dashboard,r=s.allItemsLoading,l=s.dashboardMode,o=s.canEditDashboard,g=s.showSubscriptions,j=s.subscriptionId,_=Object(c.useActions)(f.c),y=_.setDashboardMode,D=_.triggerDashboardUpdate,G=Object(c.useValues)(ut.b),C=G.dashboardTags,m=Object(c.useActions)(Je.a),R=m.updateDashboard,de=m.pinDashboard,Y=m.unpinDashboard,fe=m.deleteDashboard,xe=m.duplicateDashboard,le=Object(c.useValues)(Je.a),be=le.dashboardLoading,Se=Object(c.useValues)(mt.a),Ie=Se.hasAvailableFeature,Be=Object(M.useState)(!1),Ce=q()(Be,2),ie=Ce[0],Pe=Ce[1],We=Object(c.useValues)(Qe.a),ve=We.featureFlags,ze=ve[Te.h.EXPORT_DASHBOARD_INSIGHTS],Ke=ve[Te.h.INSIGHT_SUBSCRIPTIONS],v=Object(c.useActions)(vt.router),$=v.push;return a||r?t.a.createElement(t.a.Fragment,null,l===n.k.Fullscreen&&t.a.createElement(Ae,{onExit:function(){return y(null,x.a.Browser)}}),a&&t.a.createElement(Xe.b,{onCancel:function(){return Pe(!1)},visible:ie}),a&&t.a.createElement(Ze.c,{visible:g,closeModal:function(){return $(p.a.dashboard(a.id))},dashboardId:a.id,subscriptionId:j}),t.a.createElement(ct.a,{title:t.a.createElement("div",{style:{display:"flex",alignItems:"center"}},t.a.createElement(Ye.a,{name:"name",value:(a==null?void 0:a.name)||(r?"Loading\u2026":""),placeholder:"Name this dashboard",onSave:a?function(i){return R({id:a.id,name:i})}:void 0,minLength:1,maxLength:400,mode:o?void 0:"view",notice:a&&!o?{icon:t.a.createElement(ft.IconLock,null),tooltip:"You don't have edit permissions in this dashboard. Ask a dashboard collaborator with edit access to add you."}:void 0})),buttons:l===n.k.Edit?t.a.createElement(u.a,{"data-attr":"dashboard-edit-mode-save",type:"primary",onClick:function(){return y(null,x.a.DashboardHeader)},tabIndex:10,disabled:r},"Done editing"):l===n.k.Fullscreen?t.a.createElement(u.a,{type:"secondary",onClick:function(){return y(null,x.a.DashboardHeader)},"data-attr":"dashboard-exit-presentation-mode",disabled:r},"Exit full screen"):t.a.createElement(t.a.Fragment,null,t.a.createElement(lt.a,{overlay:a?t.a.createElement(t.a.Fragment,null,a.created_by&&t.a.createElement(t.a.Fragment,null,t.a.createElement(it.a,{fullWidth:!0,style:{color:"var(--muted-alt)"}},"Created by"," ",a.created_by.first_name||a.created_by.email||"-"," ","on ",Object(He.M)(a.created_at)),t.a.createElement(Ne.a,null)),o&&t.a.createElement(u.a,{onClick:function(){return y(n.k.Edit,x.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Edit layout (E)"),t.a.createElement(u.a,{onClick:function(){return y(n.k.Fullscreen,x.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Go full screen (F)"),o&&(a.pinned?t.a.createElement(u.a,{onClick:function(){return Y(a.id,x.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Unpin dashboard"):t.a.createElement(u.a,{onClick:function(){return de(a.id,x.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Pin dashboard")),Ke&&t.a.createElement(Ze.a,{dashboardId:a.id}),ze&&t.a.createElement(bt.a,{dashboardId:a.id,fullWidth:!0,type:"stealth"}),t.a.createElement(Ne.a,null),t.a.createElement(u.a,{onClick:function(){return xe({id:a.id,name:a.name,show:!0})},type:"stealth",fullWidth:!0},"Duplicate dashboard"),o&&t.a.createElement(u.a,{onClick:function(){return fe({id:a.id,redirect:!0})},status:"danger",type:"stealth",fullWidth:!0},"Delete dashboard")):void 0}),t.a.createElement(Ne.a,{vertical:!0}),a&&t.a.createElement(gt,{dashboard:a,onClick:function(){return Pe(function(h){return!h})}}),t.a.createElement(u.a,{type:"secondary","data-attr":"dashboard-share-button",onClick:function(){return Pe(function(h){return!h})}},"Share"),o&&t.a.createElement(I.a,{to:p.a.insightNew(void 0,a==null?void 0:a.id)},t.a.createElement(u.a,{type:"primary","data-attr":"dashboard-add-graph-header"},"Add insight"))),caption:t.a.createElement(t.a.Fragment,null,a&&!!(o||a.description)&&t.a.createElement(Ye.a,{multiline:!0,name:"description",value:a.description||"",placeholder:"Description (optional)",onSave:function(h){return R({id:a.id,description:h})},compactButtons:!0,mode:o?void 0:"view",paywall:!Ie(n.d.DASHBOARD_COLLABORATION)}),(a==null?void 0:a.tags)&&t.a.createElement(t.a.Fragment,null,o?t.a.createElement($e.a,{tags:a.tags,onChange:function(h,Ve){return D({tags:Ve})},saving:be,tagsAvailable:C.filter(function(i){var h;return!((h=a.tags)!==null&&h!==void 0&&h.includes(i))}),className:"insight-metadata-tags"}):a.tags.length?t.a.createElement($e.a,{tags:a.tags,saving:be,staticOnly:!0,className:"insight-metadata-tags"}):null)),delimited:!0})):null}function gt(s){var a=s.dashboard,r=s.onClick,l=Object(c.useValues)(Object(pt.a)({dashboardId:a.id})),o=l.allCollaborators;if(!a)return null;var g=Xe.a[a.effective_restriction_level],j=[];return g!=null&&g.label&&j.push(g.label),a.is_shared&&j.push("Shared publicly"),t.a.createElement(ht.a,{people:o.map(function(_){return{email:_.user.email,name:_.user.first_name,title:"".concat(_.user.first_name," (").concat(Te.C[_.level],")")}}),tooltip:j.join(" \u2022 "),onClick:r})}var jt=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),_t={component:ke,logic:f.c,paramsToProps:function(a){var r=a.params,l=r.id,o=r.shareToken,g=r.placement;return{id:l?parseInt(l):void 0,shareToken:o,placement:g}}};function Re(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=s.id,r=s.shareToken,l=s.placement;return t.a.createElement(c.BindLogic,{logic:f.c,props:{id:a?parseInt(a):void 0,shareToken:r,placement:l}},t.a.createElement(ke,null))}function ke(){var s,a,r=Object(c.useValues)(f.c),l=r.placement,o=r.dashboard,g=r.canEditDashboard,j=r.items,_=r.itemsLoading,y=r.filters,D=r.dashboardMode,G=r.receivedErrorsFromAPI,C=Object(c.useActions)(f.c),m=C.setDashboardMode,R=C.setDates,de=C.reportDashboardViewed,Y=C.setProperties,fe=Object(c.useValues)(Qe.a),xe=fe.featureFlags;return Object(M.useEffect)(function(){de()},[]),Object(se.a)([n.l.Public,n.l.InternalMetrics].includes(l)?{}:{e:{action:function(){return m(D===n.k.Edit?null:n.k.Edit,x.a.Hotkey)},disabled:!g||D!==null&&D!==n.k.Edit},f:{action:function(){return m(D===n.k.Fullscreen?null:n.k.Fullscreen,x.a.Hotkey)},disabled:D!==null&&D!==n.k.Fullscreen},escape:{action:function(){return m(null,x.a.Hotkey)},disabled:D!==n.k.Edit}},[m,D]),!o&&!_&&G?t.a.createElement(pe.a,{object:"dashboard"}):t.a.createElement("div",{className:"dashboard"},![n.l.ProjectHomepage,n.l.Public,n.l.Export,n.l.InternalMetrics].includes(l)&&t.a.createElement(Et,null),G?t.a.createElement(dt.d,{title:"There was an error loading this dashboard"}):!j||j.length===0?t.a.createElement(ne,{loading:_}):t.a.createElement("div",null,![n.l.Public,n.l.Export].includes(l)&&t.a.createElement("div",{className:"flex pb border-bottom space-x"},t.a.createElement("div",{className:"flex-grow flex",style:{height:30}},t.a.createElement(_e.a,{style:{marginRight:8,fontWeight:"bold",lineHeight:"30px"}}),t.a.createElement(W.a,{defaultValue:"Custom",showCustom:!0,dateFrom:(s=y==null?void 0:y.date_from)!==null&&s!==void 0?s:void 0,dateTo:(a=y==null?void 0:y.date_to)!==null&&a!==void 0?a:void 0,onChange:R,disabled:!g,makeLabel:function(be){return t.a.createElement(t.a.Fragment,null,t.a.createElement(X.a,null),t.a.createElement("span",{className:"hide-when-small"}," ",be))}})),(xe[Te.h.PROPERTY_FILTER_ON_DASHBOARD]||(o==null?void 0:o.filters.properties))&&t.a.createElement(jt.a,{onChange:Y,pageKey:"dashboard_"+(o==null?void 0:o.id),propertyFilters:o==null?void 0:o.filters.properties,useLemonButton:!0})),l!==n.l.Export&&t.a.createElement("div",{className:"flex pt pb space-x dashoard-items-actions"},t.a.createElement("div",{className:"left-item",style:l===n.l.Public?{textAlign:"right"}:void 0},l===n.l.Public?t.a.createElement(Ge,null):t.a.createElement(ot,null))),t.a.createElement(te,null)))}try{Re.displayName="Dashboard",Re.__docgenInfo={description:"",displayName:"Dashboard",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},shareToken:{defaultValue:null,description:"",name:"shareToken",required:!1,type:{name:"string"}},placement:{defaultValue:null,description:"",name:"placement",required:!1,type:{name:"enum",value:[{value:'"dashboard"'},{value:'"internal-metrics"'},{value:'"project-homepage"'},{value:'"public"'},{value:'"export"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/Dashboard.tsx#Dashboard"]={docgenInfo:Re.__docgenInfo,name:"Dashboard",path:"frontend/src/scenes/dashboard/Dashboard.tsx#Dashboard"})}catch(s){}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/Dashboard.scss":function(U,O,e){var B=e("./node_modules/css-loader/dist/runtime/api.js");O=B(!1),O.push([U.i,'.dashboard .empty-state .fade-out-graphs:after{content:"";width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent);position:absolute;pointer-events:none;bottom:0}.dashboard-header .dashboard-select{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.dashboard{margin-top:1rem}.dashboard .dashboard-items-action-icon{margin-right:6px}.dashboard .dashboard-items-action-refresh-text{visibility:visible}.dashboard .dashboard-items-action-refresh-text.hidden{visibility:hidden}.dashboard .dashboard-items-action-refresh-text.completed{position:absolute;left:30px}.dashboard .empty-state{position:relative}.dashboard .empty-state .skeleton-actions{text-align:right}.dashboard .empty-state .skeleton-actions .ant-skeleton-avatar{margin-right:8px}.dashboard .empty-state .pie-chart{height:200px;width:200px;max-width:100%;margin-top:1rem}@media(max-width:992px){.dashboard .empty-state .pie-chart{height:140px;width:140px}}.dashboard .empty-state .bar-chart{display:flex;margin-top:1rem;align-items:flex-end}.dashboard .empty-state .bar-chart .bar-el{width:12.5%;margin-left:4px;height:100px}.dashboard .empty-state .ant-col{flex-grow:1}.dashboard .empty-state .ant-col .ant-card{height:100%}.dashboard .empty-state .fade-out-graphs{margin-top:1rem;height:150px;overflow:hidden;position:relative}.dashboard .empty-state .fade-out-graphs:after{width:calc(100% - 16px);left:8px;height:150px}.dashboard .empty-state .cta{width:360px;max-width:calc(100% - 32px);position:absolute;top:16px;left:50%;transform:translateX(-50%);z-index:var(--z-content-overlay)}.dashboard-header{display:flex;justify-content:space-between;margin-bottom:1rem;width:100%}.dashboard-header.full-screen{margin-top:1rem}.dashboard-header .dashboard-select{flex:1;padding-right:2rem}.dashboard-header .dashboard-select .ant-select-single{max-width:100%;line-height:40px}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector{align-items:center;padding-left:0;padding-right:8px;line-height:40px;height:40px}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector .ant-select-selection-item{font-size:28px;font-weight:600;line-height:40px;width:100%;height:35px;display:flex;align-items:center}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector .ant-select-selection-item .anticon-share-alt{font-size:16px;margin-left:6px!important;margin-right:4px}.dashboard-header .dashboard-select .ant-select-single.ant-select-open .ant-select-arrow{color:var(--depr-rgba-text-default-0-4)}.dashboard-header .dashboard-select .ant-select-single .ant-select-arrow{color:var(--text-default);font-size:14px}.dashboard-header .dashboard-meta{white-space:nowrap;display:flex;align-items:center}.dashboard-header .dashboard-meta .ant-btn{margin-left:10px}.dashboard-header .dashboard-meta .ant-btn .anticon{vertical-align:baseline}.dashboard-header .dashboard-meta .ant-btn.button-box{padding:4px 8px}@media(max-width:768px){.dashboard-header{flex-direction:column}.dashboard-header .dashboard-meta{padding-top:1rem;justify-content:flex-end}}#auto-refresh-check{padding:5px 12px;cursor:pointer}.CollaboratorRow{justify-content:space-between;height:2rem;margin-top:.5rem;padding-left:.5rem}.CollaboratorRow,.CollaboratorRow__details{display:flex;align-items:center}.CollaboratorRow__details>span{margin-right:.5rem}',""]),U.exports=O},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/DashboardItems.scss":function(U,O,e){var B=e("./node_modules/css-loader/dist/runtime/api.js");O=B(!1),O.push([U.i,".dashboard-items-wrapper{width:100%}.react-grid-layout{position:relative;transition:height .1s ease;margin-bottom:2rem}.react-grid-layout.dashboard-view-mode .react-grid-item{transition:none}.react-grid-item{transition:all .1s ease;transition-property:left,top}.react-grid-item.cssTransforms{transition-property:transform}.react-grid-item.resizing{z-index:1;will-change:width,height}.react-grid-item.react-draggable{cursor:move}.react-grid-item.react-draggable-dragging{transition:none;z-index:105;will-change:transform}.react-grid-item.dropping{visibility:hidden}.react-grid-item.react-grid-placeholder{transition:.1s ease;max-width:100%;position:relative;border:1px solid var(--primary);outline:1px solid var(--primary);border-radius:var(--radius);z-index:2;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-resizable-hide>.react-resizable-handle{display:none}.react-grid-item>.react-resizable-handle{position:absolute;width:2rem;height:2rem;bottom:-.5rem;right:-.5rem;cursor:se-resize;z-index:10}.react-grid-item>.react-resizable-handle.react-resizable-handle-se{cursor:se-resize}.react-grid-item>.react-resizable-handle.react-resizable-handle-e{top:0;bottom:2rem;height:auto;cursor:ew-resize}.react-grid-item>.react-resizable-handle.react-resizable-handle-s{left:0;right:2rem;width:auto;cursor:ns-resize}.ant-dropdown{z-index:700}.dive-btn{margin-right:.5rem}.dive-btn.dive-btn-dive{border-color:var(--primary);color:var(--primary)}.dive-btn.dive-btn-dive:hover{border-color:var(--depr-darken-primary-30);color:var(--depr-darken-primary-30)}",""]),U.exports=O}}]);
