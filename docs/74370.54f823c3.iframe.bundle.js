"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[74370],{"../../frontend/src/scenes/groups/groupsSceneLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>groupsSceneLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_router__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),lib_introductions_groupsAccessLogic__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/introductions/groupsAccessLogic.ts"),lib_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/utils.tsx"),scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/scenes/urls.ts"),_models_groupsModel__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/models/groupsModel.ts");let groupsSceneLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","groups","groupsSceneLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)(()=>({values:[_models_groupsModel__WEBPACK_IMPORTED_MODULE_6__.$,["aggregationLabel","groupTypes","groupTypesLoading","groupsAccessStatus"]]})),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setGroupTypeIndex:groupTypeIndex=>({groupTypeIndex})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({groupTypeIndex:[0,{setGroupTypeIndex:(_,_ref)=>{let{groupTypeIndex}=_ref;return groupTypeIndex}}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({tabs:[()=>[],()=>[]],groupTypeName:[s=>[s.aggregationLabel,s.groupTypeIndex],(aggregationLabel,groupTypeIndex)=>aggregationLabel(groupTypeIndex).singular],groupTypeNamePlural:[s=>[s.aggregationLabel,s.groupTypeIndex],(aggregationLabel,groupTypeIndex)=>aggregationLabel(groupTypeIndex).plural],breadcrumbs:[s=>[s.groupTypeIndex,s.groupTypeNamePlural,s.showGroupsIntroductionPage],(groupTypeIndex,groupTypeNamePlural,showGroupsIntroductionPage)=>[{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_4__.x.Groups,name:showGroupsIntroductionPage?"Groups":(0,lib_utils__WEBPACK_IMPORTED_MODULE_3__.fm)(groupTypeNamePlural),path:scenes_urls__WEBPACK_IMPORTED_MODULE_5__.j.groups(groupTypeIndex),iconType:"group"}]],showGroupsIntroductionPage:[s=>[s.groupsAccessStatus],groupsAccessStatus=>[lib_introductions_groupsAccessLogic__WEBPACK_IMPORTED_MODULE_2__.Q.HasAccess,lib_introductions_groupsAccessLogic__WEBPACK_IMPORTED_MODULE_2__.Q.HasGroupTypes,lib_introductions_groupsAccessLogic__WEBPACK_IMPORTED_MODULE_2__.Q.NoAccess].includes(groupsAccessStatus)]}),(0,kea_router__WEBPACK_IMPORTED_MODULE_1__.urlToAction)(_ref2=>{let{actions}=_ref2;return{[scenes_urls__WEBPACK_IMPORTED_MODULE_5__.j.groups(":key")]:_ref3=>{let{key}=_ref3;key&&actions.setGroupTypeIndex(parseInt(key))}}})])},"../../frontend/src/scenes/persons-management/PersonsManagementSceneTabs.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>PersonsManagementSceneTabs});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),LemonTabs=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTabs/index.ts"),constants=__webpack_require__("../../frontend/src/lib/constants.tsx"),groupsAccessLogic=__webpack_require__("../../frontend/src/lib/introductions/groupsAccessLogic.ts"),featureFlagLogic=__webpack_require__("../../frontend/src/lib/logic/featureFlagLogic.ts"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),groupsSceneLogic=__webpack_require__("../../frontend/src/scenes/groups/groupsSceneLogic.ts"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),groupsModel=__webpack_require__("../../frontend/src/models/groupsModel.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let personsManagementSceneLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","persons-management","personsManagementSceneLogic"]),(0,index_esm.connect)(()=>({actions:[groupsSceneLogic.C,["setGroupTypeIndex"]],values:[groupsModel.$,["aggregationLabel","groupTypes","groupTypesLoading","groupsAccessStatus"],featureFlagLogic.featureFlagLogic,["featureFlags"]]})),(0,index_esm.selectors)({tabs:[s=>[s.groupTabs],groupTabs=>[{key:"persons",url:urls.j.persons(),label:"Persons",tooltipDocLink:"https://posthog.com/docs/data/persons"},{key:"cohorts",url:urls.j.cohorts(),label:"Cohorts",tooltipDocLink:"https://posthog.com/docs/data/cohorts"},...groupTabs]],crmFeatureFlag:[s=>[s.featureFlags],featureFlags=>featureFlags[constants.y8.CRM_ITERATION_ONE]],groupTabs:[s=>[s.groupTypes,s.groupsAccessStatus,s.aggregationLabel],(groupTypes,groupsAccessStatus,aggregationLabel)=>[groupsAccessLogic.Q.HasAccess,groupsAccessLogic.Q.HasGroupTypes,groupsAccessLogic.Q.NoAccess].includes(groupsAccessStatus)?[{key:"groups-0",label:"Groups",url:urls.j.groups(0)}]:Array.from(groupTypes.values()).map(_ref=>{let{group_type_index}=_ref;return{key:`groups-${group_type_index}`,label:(0,utils.fm)(aggregationLabel(group_type_index).plural),url:urls.j.groups(group_type_index)}})],lemonTabs:[s=>[s.tabs],tabs=>tabs.map(tab=>({key:tab.key,label:(0,jsx_runtime.jsx)("span",{"data-attr":`persons-management-${tab.key}-tab`,children:tab.label}),tooltipDocLink:tab.tooltipDocLink,link:tab.url}))]})]);function PersonsManagementSceneTabs(_ref){let{tabKey}=_ref,{lemonTabs}=(0,index_esm.useValues)(personsManagementSceneLogic);return(0,jsx_runtime.jsx)(LemonTabs.T,{activeKey:tabKey,tabs:lemonTabs,sceneInset:!0,className:"[&>ul]:mb-0"})}},"../../frontend/src/scenes/persons/PersonsScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PersonsScene:()=>PersonsScene,scene:()=>scene});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.34.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),LemonField=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonField/index.ts"),Link=__webpack_require__("../../frontend/src/lib/lemon-ui/Link/index.ts"),PersonsManagementSceneTabs=__webpack_require__("../../frontend/src/scenes/persons-management/PersonsManagementSceneTabs.tsx"),sceneTypes=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),scenes=__webpack_require__("../../frontend/src/scenes/scenes.ts"),teamLogic=__webpack_require__("../../frontend/src/scenes/teamLogic.tsx"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),SceneContent=__webpack_require__("../../frontend/src/layout/scenes/components/SceneContent.tsx"),SceneDivider=__webpack_require__("../../frontend/src/layout/scenes/components/SceneDivider.tsx"),SceneTitleSection=__webpack_require__("../../frontend/src/layout/scenes/components/SceneTitleSection.tsx"),Query=__webpack_require__("../../frontend/src/queries/Query/Query.tsx"),types=__webpack_require__("../../frontend/src/types.ts"),fast_deep_equal=__webpack_require__("../../node_modules/.pnpm/fast-deep-equal@3.1.3/node_modules/fast-deep-equal/index.js"),fast_deep_equal_default=__webpack_require__.n(fast_deep_equal),api=__webpack_require__("../../frontend/src/lib/api.ts"),tabAwareActionToUrl=__webpack_require__("../../frontend/src/lib/logic/scenes/tabAwareActionToUrl.ts"),tabAwareScene=__webpack_require__("../../frontend/src/lib/logic/scenes/tabAwareScene.ts"),tabAwareUrlToAction=__webpack_require__("../../frontend/src/lib/logic/scenes/tabAwareUrlToAction.ts"),utils=__webpack_require__("../../frontend/src/queries/nodes/DataTable/utils.ts"),schema_general=__webpack_require__("../../frontend/src/queries/schema/schema-general.ts");let defaultQuery={kind:schema_general.OH.DataTableNode,source:{kind:schema_general.OH.ActorsQuery,select:[...(0,utils.Qi)(schema_general.OH.ActorsQuery),"person.$delete"]},full:!0,propertiesViaUrl:!0},personsSceneLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","persons","personsSceneLogic"]),(0,tabAwareScene.P)(),(0,index_esm.actions)({setQuery:query=>({query}),resetDeletedDistinctId:distinct_id=>({distinct_id})}),(0,index_esm.reducers)({query:[defaultQuery,{setQuery:(_,_ref)=>{let{query}=_ref;return query}}]}),(0,index_esm.listeners)({resetDeletedDistinctId:async _ref2=>{let{distinct_id}=_ref2;await api.ZP.persons.resetPersonDistinctId(distinct_id),src.UJ.success("Distinct ID reset. It may take a few minutes to process.")}}),(0,index_esm.selectors)({breadcrumbs:[()=>[],()=>[{key:"persons",name:scenes.lc[sceneTypes.x.Persons].name,iconType:scenes.lc[sceneTypes.x.Persons].iconType||"default_icon_type"}]]}),(0,tabAwareActionToUrl.N)(_ref3=>{let{values}=_ref3;return{setQuery:()=>[urls.j.persons(),{},fast_deep_equal_default()(values.query,defaultQuery)?{}:{q:values.query},{replace:!0}]}}),(0,tabAwareUrlToAction.O)(_ref4=>{let{actions,values}=_ref4;return{[urls.j.persons()]:(_,__,_ref5)=>{let{q:queryParam}=_ref5;fast_deep_equal_default()(queryParam,values.query)||(queryParam?"object"==typeof queryParam?actions.setQuery(queryParam):(src.UJ.error("Invalid query in URL"),console.error({queryParam})):actions.setQuery(values.query))}}})]);var jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let scene={component:PersonsScene,logic:personsSceneLogic};function PersonsScene(){let{tabId}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!tabId)throw Error("PersonsScene rendered with no tabId");let{query}=(0,index_esm.useValues)(personsSceneLogic),{setQuery}=(0,index_esm.useActions)(personsSceneLogic),{resetDeletedDistinctId}=(0,index_esm.useAsyncActions)(personsSceneLogic),{currentTeam}=(0,index_esm.useValues)(teamLogic.teamLogic);return(0,jsx_runtime.jsxs)(SceneContent._,{children:[(0,jsx_runtime.jsx)(PersonsManagementSceneTabs.c,{tabKey:"persons"}),(0,jsx_runtime.jsx)(SceneTitleSection.s,{name:scenes.lc[sceneTypes.x.Persons].name,description:scenes.lc[sceneTypes.x.Persons].description,resourceType:{type:scenes.lc[sceneTypes.x.Persons].iconType||"default_icon_type"},actions:(0,jsx_runtime.jsx)(src.d6,{items:[{label:"Reset a deleted person...",onClick:()=>src.dn.openForm({width:"30rem",title:"Reset deleted person",description:`Once a person is deleted, the "distinct_id" associated with them can no longer be used. 
                                            You can use this tool to reset the "distinct_id" for a person so that new events associated with it will create a new Person profile.`,initialValues:{distinct_id:""},content:(0,jsx_runtime.jsx)(LemonField.D,{name:"distinct_id",label:"Distinct ID to reset",children:(0,jsx_runtime.jsx)(src.DF,{type:"text",autoFocus:!0})}),errors:{distinct_id:distinct_id=>distinct_id?void 0:"This is required"},onSubmit:async _ref=>{let{distinct_id}=_ref;return await resetDeletedDistinctId(distinct_id)}})}],children:(0,jsx_runtime.jsx)(src.Jp,{"aria-label":"more",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconEllipsis,{}),size:"small"})})}),(0,jsx_runtime.jsx)(SceneDivider.V,{}),(0,jsx_runtime.jsx)(Query.A,{uniqueKey:`persons-query-${tabId}`,attachTo:personsSceneLogic({tabId}),query:query,setQuery:setQuery,context:{refresh:"blocking",emptyStateHeading:currentTeam?.ingested_event?"There are no matching persons for this query":"No persons exist because no events have been ingested",emptyStateDetail:currentTeam?.ingested_event?"Try changing the date range or property filters.":(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Go to the"," ",(0,jsx_runtime.jsx)(Link.r,{to:urls.j.onboarding(types.Md.PRODUCT_ANALYTICS,types.Hr.INSTALL),"data-attr":"real_project_with_no_events-ingestion_link",children:"onboarding wizard"})," ","to get things moving"]})},dataAttr:"persons-table"})]})}}}]);
//# sourceMappingURL=74370.54f823c3.iframe.bundle.js.map