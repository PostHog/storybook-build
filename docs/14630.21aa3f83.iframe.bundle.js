"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[14630],{"../../frontend/src/scenes/new-tab/NewTabScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{NewTabScene:()=>NewTabScene,scene:()=>scene});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),react=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),LemonButton=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/index.ts"),Link=__webpack_require__("../../frontend/src/lib/lemon-ui/Link/index.ts"),css_classes=__webpack_require__("../../frontend/src/lib/utils/css-classes.ts"),lib=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.30.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),featureFlagLogic=__webpack_require__("../../frontend/src/lib/logic/featureFlagLogic.ts"),defaultTree=__webpack_require__("../../frontend/src/layout/panel-layout/ProjectTree/defaultTree.tsx"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function getIconForFileSystemItem(fs){return"icon"in fs&&fs.icon?(0,jsx_runtime.jsx)(defaultTree.ee,{type:fs.type,colorOverride:fs.iconColor,children:fs.icon}):(0,defaultTree.PO)("iconType"in fs?fs.iconType:fs.type,fs.iconColor)}let newTabSceneLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","new-tab","newTabSceneLogic"]),(0,index_esm.props)({}),(0,index_esm.connect)(()=>({values:[featureFlagLogic.featureFlagLogic,["featureFlags"]]})),(0,index_esm.key)(props=>props.tabId||"default"),(0,index_esm.actions)({setSearch:search=>({search}),selectNext:!0,selectPrevious:!0,onFocus:!0,onBlur:!0,onSubmit:!0}),(0,index_esm.reducers)({search:["",{setSearch:(_,_ref)=>{let{search}=_ref;return search}}],rawSelectedIndex:[0,{selectNext:state=>state+1,selectPrevious:state=>state-1,setSearch:()=>0}],focused:[!1,{onFocus:()=>!0,onBlur:()=>!1}]}),(0,index_esm.selectors)({itemsGrid:[s=>[s.featureFlags],featureFlags=>{let newInsightItems=(0,defaultTree.eq)().filter(_ref2=>{let{path}=_ref2;return path.startsWith("Insight/")}).map(fs=>({href:fs.href,name:fs.path.substring(8),icon:getIconForFileSystemItem(fs),flag:fs.flag})).filter(_ref3=>{let{flag}=_ref3;return!flag||featureFlags[flag]}),newDataItems=(0,defaultTree.eq)().filter(_ref4=>{let{path}=_ref4;return path.startsWith("Data/")}).map(fs=>({href:fs.href,name:"Data "+fs.path.substring(5).toLowerCase(),icon:getIconForFileSystemItem(fs),flag:fs.flag})).filter(_ref5=>{let{flag}=_ref5;return!flag||featureFlags[flag]}),newOtherItems=(0,defaultTree.eq)().filter(_ref6=>{let{path}=_ref6;return!path.startsWith("Insight/")&&!path.startsWith("Data/")}).map(fs=>({href:fs.href,name:fs.path,icon:getIconForFileSystemItem(fs),flag:fs.flag})).filter(_ref7=>{let{flag}=_ref7;return!flag||featureFlags[flag]}),products=[...(0,defaultTree.UC)(),...(0,defaultTree.We)()].map(fs=>({href:fs.href,name:fs.path,icon:getIconForFileSystemItem(fs),flag:fs.flag})).filter(_ref8=>{let{flag}=_ref8;return!flag||featureFlags[flag]}).toSorted((a,b)=>a.name.localeCompare(b.name)),data=(0,defaultTree.T7)().map(fs=>({href:fs.href,name:fs.path,icon:getIconForFileSystemItem(fs),flag:fs.flag})).filter(_ref9=>{let{flag}=_ref9;return!flag||featureFlags[flag]});return[{category:"Create new insight",types:[{name:"SQL query",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconDatabase,{}),href:"/sql"},...newInsightItems]},{category:"Create new ...",types:[...newOtherItems,...newDataItems,{name:"Hog program",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconHogQL,{}),href:"/debug/hog"}]},{category:"Apps",types:[...products]},{category:"Data in or out",types:[...data]}]}],filteredItemsGrid:[s=>[s.itemsGrid,s.search],(itemsGrid,search)=>{if(!search.trim())return itemsGrid;let lowerSearchChunks=search.toLowerCase().split(" ").map(s=>s.trim()).filter(s=>s);return itemsGrid.map(_ref10=>{let{category,types}=_ref10;return{category,types:types.filter(t=>0===lowerSearchChunks.filter(lowerSearch=>!`${category} ${t.name}`.toLowerCase().includes(lowerSearch)).length)}}).filter(_ref11=>{let{types}=_ref11;return types.length>0})}],filteredItemsList:[s=>[s.filteredItemsGrid],filteredItemsGrid=>filteredItemsGrid.flatMap(_ref12=>{let{category,types}=_ref12;return types.map(type=>({category,type}))})],selectedIndex:[s=>[s.rawSelectedIndex,s.filteredItemsList],(rawSelectedIndex,filteredItemsList)=>0===filteredItemsList.length?null:(rawSelectedIndex%filteredItemsList.length+filteredItemsList.length)%filteredItemsList.length],selectedItem:[s=>[s.selectedIndex,s.filteredItemsList],(selectedIndex,filteredItemsList)=>null!==selectedIndex&&selectedIndex<filteredItemsList.length?filteredItemsList[selectedIndex]:null]}),(0,index_esm.listeners)(_ref13=>{let{values}=_ref13;return{onSubmit:()=>{values.selectedItem?.type?.href&&lib.router.actions.push(values.selectedItem.type.href)}}})]);var SearchHighlight=__webpack_require__("../../frontend/src/layout/navigation-3000/components/SearchHighlight.tsx");let scene={component:NewTabScene,logic:newTabSceneLogic},generateHash=string=>{let hash=0;for(let char of string)hash=(hash<<5)-hash+char.charCodeAt(0)|0;return Math.abs(hash)};function NewTabScene(){let{tabId}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{filteredItemsGrid,search,selectedItem,focused}=(0,index_esm.useValues)(newTabSceneLogic({tabId})),{setSearch,selectNext,selectPrevious,onFocus,onBlur,onSubmit}=(0,index_esm.useActions)(newTabSceneLogic({tabId})),swatches=["bg-sky-500/10 text-sky-700 dark:bg-sky-500/20 dark:text-sky-100","bg-emerald-500/10 text-emerald-700 dark:bg-emerald-500/20 dark:text-emerald-100","bg-violet-500/10 text-violet-700 dark:bg-violet-500/20 dark:text-violet-100","bg-amber-500/10 text-amber-700 dark:bg-amber-500/20 dark:text-amber-100","bg-pink-500/10 text-pink-700 dark:bg-pink-500/20 dark:text-pink-100","bg-stone-500/10 text-stone-700 dark:bg-stone-500/20 dark:text-stone-100"],darkSwatches=["bg-sky-800/80 text-sky-300 dark:bg-sky-300/80 dark:text-sky-700","bg-emerald-800/80 text-emerald-300 dark:bg-emerald-300/80 dark:text-emerald-700","bg-violet-800/80 text-violet-300 dark:bg-violet-300/80 dark:text-violet-700","bg-amber-800/80 text-amber-300 dark:bg-amber-300/80 dark:text-amber-700","bg-pink-800/80 text-pink-300 dark:bg-pink-300/80 dark:text-pink-700","bg-stone-800/80 text-stone-300 dark:bg-stone-300/80 dark:text-stone-700"];return(0,react.useEffect)(()=>{if(selectedItem){let element=document.querySelector(".selected-new-tab-item");element?.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}},[selectedItem]),(0,jsx_runtime.jsxs)("div",{className:"w-full py-24",children:[(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 max-w-[800px] px-8 m-auto mt-2 mb-12",children:[(0,jsx_runtime.jsx)("input",{type:"text",value:search,onChange:e=>setSearch(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),onSubmit()),"Tab"===e.key&&(e.preventDefault(),e.stopPropagation(),e.shiftKey?selectPrevious():selectNext())},onFocus:onFocus,onBlur:onBlur,autoFocus:!0,placeholder:"Type to filter, then press ENTER to run and (shift+)tab to move.",className:"flex-1 px-4 py-3 rounded-lg border border-border dark:border-border-dark bg-white dark:bg-gray-900 text-primary dark:text-primary-dark text-base focus:ring-2 focus:ring-red dark:focus:ring-yellow focus:border-transparent transition-all"}),(0,jsx_runtime.jsx)(LemonButton.J,{type:"primary",disabledReason:search.trim()?0===Object.keys(filteredItemsGrid).length?"No results":"":"Please write a filter",onClick:onSubmit,children:"Take me there"})]}),filteredItemsGrid.map(_ref=>{let{category,types}=_ref;return(0,jsx_runtime.jsxs)("div",{className:"w-full overflow-auto p-4 px-12 max-w-[880px] m-auto",children:[(0,jsx_runtime.jsx)("div",{className:"px-2 py-8 text-center",children:search?(0,jsx_runtime.jsx)(SearchHighlight.r,{string:category,substring:search}):category}),(0,jsx_runtime.jsx)("div",{className:"grid gap-12",style:{gridTemplateColumns:"repeat(auto-fit, minmax(7rem, 1fr))"},children:types.map(qt=>{var _qt$icon;return(0,jsx_runtime.jsx)("div",{className:"text-center m-auto",children:(0,jsx_runtime.jsxs)(Link.r,{to:qt.href,className:(0,css_classes.cn)("group flex flex-col items-center text-center cursor-pointer select-none focus:outline-none",focused&&selectedItem?.type===qt?"underline selected-new-tab-item":""),children:[(0,jsx_runtime.jsx)("div",{className:`flex items-center justify-center w-16 h-16 rounded-xl shadow-sm group-hover:shadow-md transition ${focused&&selectedItem?.type===qt?darkSwatches[generateHash(qt.name)%darkSwatches.length]:swatches[generateHash(qt.name)%swatches.length]}`,children:(0,jsx_runtime.jsx)("span",{className:"text-2xl font-semibold",children:null!==(_qt$icon=qt.icon)&&void 0!==_qt$icon?_qt$icon:qt.name[0]})}),(0,jsx_runtime.jsx)("span",{className:"mt-2 w-full text-xs font-medium truncate px-1 text-primary",children:search?(0,jsx_runtime.jsx)(SearchHighlight.r,{string:qt.name,substring:search}):qt.name})]})},qt.name)})})]},category)})]})}}}]);