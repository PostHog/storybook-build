(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[22071,60676],{"./frontend/src/scenes/batch_exports/BatchExportsListScene.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{BatchExportsList:function(){return BatchExportsList},BatchExportsListScene:function(){return BatchExportsListScene},scene:function(){return scene}});var PageHeader=__webpack_require__("./frontend/src/lib/components/PageHeader.tsx"),src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),urls=__webpack_require__("./frontend/src/scenes/urls.ts"),index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),lib=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),api=__webpack_require__("./frontend/src/lib/api.ts");const batchExportsListLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","batch_exports","batchExportsListLogic"]),(0,index_esm.actions)({loadBatchExports:offset=>({offset:offset})}),(0,index_esm.reducers)({offset:[0,{loadBatchExports:(_,_ref)=>{let{offset:offset}=_ref;return offset||0}}]}),(0,lib.loaders)((()=>({batchExportConfigs:[null,{loadBatchExports:async(_ref2,breakpoint)=>{let{offset:offset}=_ref2;await breakpoint(100);return await api.ZP.batchExports.list({offset:offset||0,limit:10})}}]}))),(0,index_esm.listeners)((_ref3=>{let{actions:actions,values:values,cache:cache}=_ref3;return{loadBatchExportsSuccess:()=>{clearTimeout(cache.refreshTimeout),cache.refreshTimeout=setTimeout((()=>{actions.loadBatchExports(values.offset)}),1e4)}}})),(0,index_esm.beforeUnmount)((_ref4=>{let{cache:cache}=_ref4;clearTimeout(cache.refreshTimeout)})),(0,index_esm.afterMount)((_ref5=>{let{actions:actions}=_ref5;actions.loadBatchExports()})),(0,index_esm.selectors)((_ref6=>{let{actions:actions}=_ref6;return{pagination:[s=>[s.offset,s.batchExportConfigs],(offset,configs)=>{var _configs$count;return{controlled:!0,pageSize:10,currentPage:Math.floor(offset/10)+1,entryCount:null!==(_configs$count=configs?.count)&&void 0!==_configs$count?_configs$count:0,onBackward:()=>actions.loadBatchExports(offset-10),onForward:()=>actions.loadBatchExports(offset+10)}}]}}))]);var LemonMenu=__webpack_require__("./frontend/src/lib/lemon-ui/LemonMenu/index.ts"),icons=__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts"),components=__webpack_require__("./frontend/src/scenes/batch_exports/components.tsx"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");const scene={component:BatchExportsListScene};function BatchExportsListScene(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(PageHeader.m,{title:"Batch Exports",buttons:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(src.LemonButton,{type:"primary",to:urls.j.batchExportNew(),children:"Create export workflow"})})}),(0,jsx_runtime.jsx)("p",{children:"Batch exports allow you to export your data to a destination of your choice."}),(0,jsx_runtime.jsx)(BatchExportsList,{})]})}function BatchExportsList(){var _batchExportConfigs$r;const{batchExportConfigs:batchExportConfigs,batchExportConfigsLoading:batchExportConfigsLoading,pagination:pagination}=(0,index_esm.useValues)(batchExportsListLogic);return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(src.LemonTable,{dataSource:null!==(_batchExportConfigs$r=batchExportConfigs?.results)&&void 0!==_batchExportConfigs$r?_batchExportConfigs$r:[],loading:batchExportConfigsLoading,pagination:pagination,columns:[{title:"Name",key:"name",width:0,render:function RenderName(_,batchExport){return(0,jsx_runtime.jsx)(src.Link,{className:"font-semibold truncate",to:urls.j.batchExport(batchExport.id),children:batchExport.name})}},{title:"Latest runs",key:"runs",render:function RenderStatus(_,batchExport){return(0,jsx_runtime.jsx)("div",{className:"flex gap-2",children:[...batchExport.latest_runs||[]].reverse()?.map((run=>(0,jsx_runtime.jsx)(src.LemonButton,{to:urls.j.batchExport(batchExport.id),status:"stealth",className:"flex gap-1",noPadding:!0,children:(0,jsx_runtime.jsx)(components.pP,{runs:[run]})},run.id)))})}},{title:"Destination",key:"destination",render:function RenderType(_,batchExport){return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:batchExport.destination.type})}},{title:"Frequency",key:"frequency",dataIndex:"interval"},{title:"Status",key:"status",width:0,render:function RenderStatus(_,batchExport){return(0,jsx_runtime.jsx)(components.$o,{batchExportConfig:batchExport})}},{width:0,render:function Render(_,batchExport){const menuItems=[{label:"View",to:urls.j.batchExport(batchExport.id)},{label:"Edit",to:urls.j.batchExportEdit(batchExport.id)},{label:batchExport.paused?"Resume":"Pause",status:batchExport.paused?"primary":"danger",onClick:()=>{}}];return(0,jsx_runtime.jsx)(LemonMenu.d,{items:menuItems,placement:"left",children:(0,jsx_runtime.jsx)(src.LemonButton,{size:"small",status:"stealth",noPadding:!0,icon:(0,jsx_runtime.jsx)(icons.YRX,{})})})}}]})})}},"./frontend/src/scenes/batch_exports/components.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{pP:function(){return BatchExportRunIcon},$o:function(){return BatchExportTag}});var src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),clsx_m=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),Tooltip=__webpack_require__("./frontend/src/lib/lemon-ui/Tooltip.tsx"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/.pnpm/style-loader@2.0.0_webpack@5.88.2/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),BatchExports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/scenes/batch_exports/BatchExports.scss"),BatchExports_default=__webpack_require__.n(BatchExports),options={insert:"head",singleton:!1},jsx_runtime=(injectStylesIntoStyleTag_default()(BatchExports_default(),options),BatchExports_default().locals,__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js"));function BatchExportTag(_ref){let{batchExportConfig:batchExportConfig}=_ref;return(0,jsx_runtime.jsx)(Tooltip.u,{title:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:batchExportConfig.paused?"This export is paused - no future export runs will be scheduled ":"This export is active - new runs will be triggered at the configured interval."}),children:(0,jsx_runtime.jsx)(src.LemonTag,{type:batchExportConfig.paused?"default":"primary",children:batchExportConfig.paused?"Paused":"Active"})})}const colorForStatus=status=>{switch(status){case"Completed":return"success";case"ContinuedAsNew":case"Running":case"Starting":return"primary";case"Cancelled":case"Terminated":case"TimedOut":return"warning";case"Failed":return"danger";default:return"default"}};function BatchExportRunIcon(_ref2){let{runs:runs,showLabel:showLabel=!1}=_ref2;const latestRun=runs[0],color=colorForStatus(latestRun.status);return(0,jsx_runtime.jsx)(Tooltip.u,{title:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Run status: ",latestRun.status,runs.length>1&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("br",{}),"Attempts: ",runs.length]})]}),children:(0,jsx_runtime.jsx)("span",{className:(0,clsx_m.default)(`BatchExportRunIcon h-6 p-2 border-2 flex items-center justify-center rounded-full font-semibold text-xs border-${color} text-${color}-dark select-none`,"primary"===color&&"BatchExportRunIcon--pulse",showLabel?"":"w-6"),children:showLabel?(0,jsx_runtime.jsx)("span",{className:"text-center",children:latestRun.status}):runs.length})})}try{BatchExportTag.displayName="BatchExportTag",BatchExportTag.__docgenInfo={description:"",displayName:"BatchExportTag",props:{batchExportConfig:{defaultValue:null,description:"",name:"batchExportConfig",required:!0,type:{name:"BatchExportConfiguration"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/batch_exports/components.tsx#BatchExportTag"]={docgenInfo:BatchExportTag.__docgenInfo,name:"BatchExportTag",path:"frontend/src/scenes/batch_exports/components.tsx#BatchExportTag"})}catch(__react_docgen_typescript_loader_error){}try{BatchExportRunIcon.displayName="BatchExportRunIcon",BatchExportRunIcon.__docgenInfo={description:"",displayName:"BatchExportRunIcon",props:{runs:{defaultValue:null,description:"",name:"runs",required:!0,type:{name:"BatchExportRun[]"}},showLabel:{defaultValue:{value:"false"},description:"",name:"showLabel",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/batch_exports/components.tsx#BatchExportRunIcon"]={docgenInfo:BatchExportRunIcon.__docgenInfo,name:"BatchExportRunIcon",path:"frontend/src/scenes/batch_exports/components.tsx#BatchExportRunIcon"})}catch(__react_docgen_typescript_loader_error){}try{colorForStatus.displayName="colorForStatus",colorForStatus.__docgenInfo={description:"",displayName:"colorForStatus",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/batch_exports/components.tsx#colorForStatus"]={docgenInfo:colorForStatus.__docgenInfo,name:"colorForStatus",path:"frontend/src/scenes/batch_exports/components.tsx#colorForStatus"})}catch(__react_docgen_typescript_loader_error){}},"./frontend/src/scenes/plugins/Plugins.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Plugins:function(){return Plugins_Plugins},scene:function(){return Plugins_scene}});var injectStylesIntoStyleTag=__webpack_require__("./node_modules/.pnpm/style-loader@2.0.0_webpack@5.88.2/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),Plugins=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/scenes/plugins/Plugins.scss"),Plugins_default=__webpack_require__.n(Plugins),options={insert:"head",singleton:!1},react=(injectStylesIntoStyleTag_default()(Plugins_default(),options),Plugins_default().locals,__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js")),PluginDrawer=__webpack_require__("./frontend/src/scenes/plugins/edit/PluginDrawer.tsx"),row=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/row/index.js"),index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),pluginsLogic=__webpack_require__("./frontend/src/scenes/plugins/pluginsLogic.ts"),es_button=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/button/index.js"),es_tag=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/tag/index.js"),InfoCircleOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),UpOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/UpOutlined.js"),DownOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/DownOutlined.js"),GlobalOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/GlobalOutlined.js"),WarningOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/WarningOutlined.js"),LoadingOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/LoadingOutlined.js"),CheckOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/CheckOutlined.js"),LineChartOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/LineChartOutlined.js"),ClockCircleOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/ClockCircleOutlined.js"),UnorderedListOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/UnorderedListOutlined.js"),SettingOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/SettingOutlined.js"),CloudDownloadOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/CloudDownloadOutlined.js"),PluginImage=__webpack_require__("./frontend/src/scenes/plugins/plugin/PluginImage.tsx"),popover=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/popover/index.js"),ClearOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/ClearOutlined.js"),CodeSnippet=__webpack_require__("./frontend/src/lib/components/CodeSnippet/index.ts"),dayjs=__webpack_require__("./frontend/src/lib/dayjs.ts"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function PluginError(_ref){let{error:error,reset:reset}=_ref;return error?(0,jsx_runtime.jsx)(popover.Z,{title:(0,jsx_runtime.jsx)("div",{style:{textAlign:"center"},children:(0,dayjs.Bv)(error.time).format("YYYY-MM-DD - HH:mm:ss")}),content:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[reset?(0,jsx_runtime.jsxs)(es_button.Z,{size:"small",onClick:reset,style:{float:"right",marginLeft:10},children:[(0,jsx_runtime.jsx)(ClearOutlined.Z,{})," Delete"]}):null,(0,jsx_runtime.jsxs)("div",{children:[error.name?(0,jsx_runtime.jsxs)("strong",{children:[error.name,": "]}):"",error.message]}),error.stack?(0,jsx_runtime.jsx)(CodeSnippet.O,{wrap:!0,style:{fontSize:10},language:CodeSnippet.S.JavaScript,children:error.stack}):null,error.event?(0,jsx_runtime.jsx)(CodeSnippet.O,{wrap:!0,style:{fontSize:10},language:CodeSnippet.S.JSON,children:JSON.stringify(error.event,null,2)}):null]}),trigger:"click",placement:"top",children:(0,jsx_runtime.jsx)(es_tag.Z,{color:"red",style:{cursor:"pointer"},children:"ERROR"})}):null}try{PluginError.displayName="PluginError",PluginError.__docgenInfo={description:"",displayName:"PluginError",props:{error:{defaultValue:null,description:"",name:"error",required:!0,type:{name:"PluginErrorType"}},reset:{defaultValue:null,description:"",name:"reset",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/PluginError.tsx#PluginError"]={docgenInfo:PluginError.__docgenInfo,name:"PluginError",path:"frontend/src/scenes/plugins/plugin/PluginError.tsx#PluginError"})}catch(__react_docgen_typescript_loader_error){}var utils=__webpack_require__("./frontend/src/lib/utils.tsx"),Tooltip=__webpack_require__("./frontend/src/lib/lemon-ui/Tooltip.tsx");function LocalPluginTag(_ref){let{url:url,title:title,style:style}=_ref;return(0,jsx_runtime.jsx)(Tooltip.u,{title:url.substring(5),children:(0,jsx_runtime.jsx)(es_tag.Z,{color:"purple",onClick:async()=>await(0,utils.vQ)(url.substring(5)),style:style,children:title||"Local App"})})}try{LocalPluginTag.displayName="LocalPluginTag",LocalPluginTag.__docgenInfo={description:"",displayName:"LocalPluginTag",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/LocalPluginTag.tsx#LocalPluginTag"]={docgenInfo:LocalPluginTag.__docgenInfo,name:"LocalPluginTag",path:"frontend/src/scenes/plugins/plugin/LocalPluginTag.tsx#LocalPluginTag"})}catch(__react_docgen_typescript_loader_error){}var types=__webpack_require__("./frontend/src/scenes/plugins/types.ts");function SourcePluginTag(_ref){let{title:title="Source Code",style:style}=_ref;return(0,jsx_runtime.jsx)(es_tag.Z,{style:style,children:title})}try{SourcePluginTag.displayName="SourcePluginTag",SourcePluginTag.__docgenInfo={description:"",displayName:"SourcePluginTag",props:{title:{defaultValue:{value:"Source Code"},description:"",name:"title",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/SourcePluginTag.tsx#SourcePluginTag"]={docgenInfo:SourcePluginTag.__docgenInfo,name:"SourcePluginTag",path:"frontend/src/scenes/plugins/plugin/SourcePluginTag.tsx#SourcePluginTag"})}catch(__react_docgen_typescript_loader_error){}function SHATag(_ref){let{tag:tag}=_ref;return tag.match(/^[a-f0-9]{40}$/)?(0,jsx_runtime.jsx)("code",{children:tag.substring(0,7)}):(0,jsx_runtime.jsx)("code",{children:tag})}function UpdateAvailable(_ref2){let{url:url,tag:tag,latestTag:latestTag}=_ref2,compareUrl="";return url.match(/^https:\/\/(www.|)github.com\//)&&(compareUrl=`${url}/compare/${tag}...${latestTag}`),url.match(/^https:\/\/(www.|)gitlab.com\//)&&(compareUrl=`${url}/-/compare/${tag}...${latestTag}`),(0,jsx_runtime.jsx)(Tooltip.u,{title:(0,jsx_runtime.jsxs)("div",{children:["Installed: ",(0,jsx_runtime.jsx)(SHATag,{tag:tag}),(0,jsx_runtime.jsx)("br",{}),"Latest: ",(0,jsx_runtime.jsx)(SHATag,{tag:latestTag}),compareUrl?(0,jsx_runtime.jsx)("div",{style:{marginTop:10},children:"Click to see the diff"}):null]}),children:compareUrl?(0,jsx_runtime.jsx)("a",{href:compareUrl,target:"_blank",rel:"noreferrer noopener",children:(0,jsx_runtime.jsxs)(es_tag.Z,{color:"volcano",style:{cursor:"pointer"},children:[(0,jsx_runtime.jsx)(CloudDownloadOutlined.Z,{})," Update available!"]})}):(0,jsx_runtime.jsxs)(es_tag.Z,{color:"volcano",children:[(0,jsx_runtime.jsx)(CloudDownloadOutlined.Z,{})," Update available!"]})})}try{UpdateAvailable.displayName="UpdateAvailable",UpdateAvailable.__docgenInfo={description:"",displayName:"UpdateAvailable",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},tag:{defaultValue:null,description:"",name:"tag",required:!0,type:{name:"string"}},latestTag:{defaultValue:null,description:"",name:"latestTag",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/UpdateAvailable.tsx#UpdateAvailable"]={docgenInfo:UpdateAvailable.__docgenInfo,name:"UpdateAvailable",path:"frontend/src/scenes/plugins/plugin/UpdateAvailable.tsx#UpdateAvailable"})}catch(__react_docgen_typescript_loader_error){}var userLogic=__webpack_require__("./frontend/src/scenes/userLogic.ts"),access=__webpack_require__("./frontend/src/scenes/plugins/access.ts");const PluginUpdateButton=_ref=>{let{updateStatus:updateStatus,pluginId:pluginId,rearranging:rearranging}=_ref;const{editPlugin:editPlugin,updatePlugin:updatePlugin}=(0,index_esm.useActions)(pluginsLogic.C),{pluginsUpdating:pluginsUpdating}=(0,index_esm.useValues)(pluginsLogic.C);return(0,jsx_runtime.jsx)(es_button.Z,{type:updateStatus?.updated?"default":"primary",className:"padding-under-500",onClick:()=>updateStatus?.updated?editPlugin(pluginId):updatePlugin(pluginId),loading:pluginsUpdating.includes(pluginId),icon:updateStatus?.updated?(0,jsx_runtime.jsx)(CheckOutlined.Z,{}):(0,jsx_runtime.jsx)(CloudDownloadOutlined.Z,{}),disabled:rearranging,"data-attr":"plugin-update",children:(0,jsx_runtime.jsx)("span",{className:"show-over-500",children:updateStatus?.updated?"Updated":"Update"})})};try{PluginUpdateButton.displayName="PluginUpdateButton",PluginUpdateButton.__docgenInfo={description:"",displayName:"PluginUpdateButton",props:{updateStatus:{defaultValue:null,description:"",name:"updateStatus",required:!0,type:{name:"PluginUpdateStatusType | undefined"}},pluginId:{defaultValue:null,description:"",name:"pluginId",required:!0,type:{name:"number"}},rearranging:{defaultValue:null,description:"",name:"rearranging",required:!0,type:{name:"boolean | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/PluginUpdateButton.tsx#PluginUpdateButton"]={docgenInfo:PluginUpdateButton.__docgenInfo,name:"PluginUpdateButton",path:"frontend/src/scenes/plugins/plugin/PluginUpdateButton.tsx#PluginUpdateButton"})}catch(__react_docgen_typescript_loader_error){}var src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),organizationLogic=__webpack_require__("./frontend/src/scenes/organizationLogic.tsx"),constants=__webpack_require__("./frontend/src/lib/constants.tsx"),urls=__webpack_require__("./frontend/src/scenes/urls.ts"),Link=__webpack_require__("./frontend/src/lib/lemon-ui/Link/index.ts");function SuccessRateBadge(_ref){let{deliveryRate:deliveryRate,pluginConfigId:pluginConfigId}=_ref;const[status,tooltip]=function successRateSummary(deliveryRate){if(null===deliveryRate)return["muted","No events processed by this app in the past 24 hours"];{let color;return color=deliveryRate>=.99?"success":deliveryRate>=.75?"warning":"danger",[color,`Success rate for past 24 hours: ${Math.floor(1e3*deliveryRate)/10}%`]}}(deliveryRate);return(0,jsx_runtime.jsx)(Tooltip.u,{title:tooltip,children:(0,jsx_runtime.jsx)(Link.r,{to:urls.j.appMetrics(pluginConfigId),children:(0,jsx_runtime.jsx)(src.LemonBadge,{status:status})})})}try{SuccessRateBadge.displayName="SuccessRateBadge",SuccessRateBadge.__docgenInfo={description:"",displayName:"SuccessRateBadge",props:{deliveryRate:{defaultValue:null,description:"",name:"deliveryRate",required:!0,type:{name:"number | null"}},pluginConfigId:{defaultValue:null,description:"",name:"pluginConfigId",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/SuccessRateBadge.tsx#SuccessRateBadge"]={docgenInfo:SuccessRateBadge.__docgenInfo,name:"SuccessRateBadge",path:"frontend/src/scenes/plugins/plugin/SuccessRateBadge.tsx#SuccessRateBadge"})}catch(__react_docgen_typescript_loader_error){}var clsx_m=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js");function CommunityTag(_ref){let{isCommunity:isCommunity,noun:noun="app"}=_ref;return(0,jsx_runtime.jsx)(Tooltip.u,{title:isCommunity?`This ${noun} was built by a community member, not the PostHog team.`:`This ${noun} was built by the PostHog team.`,children:(0,jsx_runtime.jsx)(es_tag.Z,{color:isCommunity?"cyan":"geekblue",children:isCommunity?"Community":"Official"})})}try{CommunityTag.displayName="CommunityTag",CommunityTag.__docgenInfo={description:"",displayName:"CommunityTag",props:{isCommunity:{defaultValue:null,description:"",name:"isCommunity",required:!1,type:{name:"boolean"}},noun:{defaultValue:{value:"app"},description:"",name:"noun",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/CommunityTag.tsx#CommunityTag"]={docgenInfo:CommunityTag.__docgenInfo,name:"CommunityTag",path:"frontend/src/lib/CommunityTag.tsx#CommunityTag"})}catch(__react_docgen_typescript_loader_error){}function PluginAboutButton(_ref){let{url:url,disabled:disabled=!1}=_ref;return(0,jsx_runtime.jsx)(Tooltip.u,{title:"About",children:(0,jsx_runtime.jsx)(src.Link,{to:url,target:"_blank",children:(0,jsx_runtime.jsx)(es_button.Z,{disabled:disabled,children:(0,jsx_runtime.jsx)(InfoCircleOutlined.Z,{})})})})}function PluginCard(_ref2){var _pluginConfig$enabled,_pluginConfig$deliver;let{plugin:plugin,error:error,maintainer:maintainer,showUpdateButton:showUpdateButton,order:order,maxOrder:maxOrder,rearranging:rearranging,DragColumn:DragColumn=(_ref3=>{let{children:children}=_ref3;return(0,jsx_runtime.jsx)("div",{className:"order-handle",children:children})}),unorderedPlugin:unorderedPlugin=!1}=_ref2;const{name:name,description:description,url:url,plugin_type:pluginType,pluginConfig:pluginConfig,tag:tag,latest_tag:latestTag,id:pluginId,updateStatus:updateStatus,hasMoved:hasMoved,is_global:is_global,organization_id:organization_id,organization_name:organization_name}=plugin,{editPlugin:editPlugin,toggleEnabled:toggleEnabled,installPlugin:installPlugin,resetPluginConfigError:resetPluginConfigError,rearrange:rearrange,showPluginLogs:showPluginLogs}=(0,index_esm.useActions)(pluginsLogic.C),{loading:loading,installingPluginUrl:installingPluginUrl,checkingForUpdates:checkingForUpdates,pluginUrlToMaintainer:pluginUrlToMaintainer,showAppMetricsForPlugin:showAppMetricsForPlugin}=(0,index_esm.useValues)(pluginsLogic.C),{currentOrganization:currentOrganization}=(0,index_esm.useValues)(organizationLogic.p),{user:user}=(0,index_esm.useValues)(userLogic.userLogic),hasSpecifiedMaintainer=maintainer||plugin.url&&pluginUrlToMaintainer[plugin.url],pluginMaintainer=maintainer||pluginUrlToMaintainer[plugin.url||""];return(0,jsx_runtime.jsx)("div",{className:"w-full mb-5","data-attr":"plugin-card-"+(pluginConfig?"installed":"available"),children:(0,jsx_runtime.jsx)("div",{className:"border rounded p-4 bg-bg-light plugins-scene-plugin-card",children:(0,jsx_runtime.jsxs)("div",{className:"flex space-x-3 items-center",children:["number"==typeof order&&"number"==typeof maxOrder?(0,jsx_runtime.jsxs)(DragColumn,{children:[(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.default)("arrow",1===order&&"invisible"),children:(0,jsx_runtime.jsx)(UpOutlined.Z,{})}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(es_tag.Z,{color:hasMoved?"#bd0225":"#555",onClick:rearrange,children:order})}),(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.default)("arrow",order===maxOrder&&"invisible"),children:(0,jsx_runtime.jsx)(DownOutlined.Z,{})})]}):null,unorderedPlugin?(0,jsx_runtime.jsx)(Tooltip.u,{title:"This app does not do any processing in order.",placement:"topRight",children:(0,jsx_runtime.jsx)(es_tag.Z,{color:"#555",children:"-"})}):null,pluginConfig&&(pluginConfig.id?(0,jsx_runtime.jsx)(src.LemonSwitch,{checked:null!==(_pluginConfig$enabled=pluginConfig.enabled)&&void 0!==_pluginConfig$enabled&&_pluginConfig$enabled,disabled:rearranging,onChange:()=>toggleEnabled({id:pluginConfig.id,enabled:!pluginConfig.enabled})}):(0,jsx_runtime.jsx)(Tooltip.u,{title:"Please configure this plugin before enabling it",children:(0,jsx_runtime.jsx)(src.LemonSwitch,{checked:!1,disabled:!0})})),(0,jsx_runtime.jsx)("div",{className:pluginConfig?"hide-plugin-image-below-500":"",children:(0,jsx_runtime.jsx)(PluginImage.c,{plugin:plugin})}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center",children:[(0,jsx_runtime.jsxs)("strong",{className:"flex items-center mr-2 gap-1",children:[showAppMetricsForPlugin(plugin)&&pluginConfig?.id&&(0,jsx_runtime.jsx)(SuccessRateBadge,{deliveryRate:null!==(_pluginConfig$deliver=pluginConfig.delivery_rate_24h)&&void 0!==_pluginConfig$deliver?_pluginConfig$deliver:null,pluginConfigId:pluginConfig.id}),name]}),hasSpecifiedMaintainer&&(0,jsx_runtime.jsx)(CommunityTag,{isCommunity:"community"===pluginMaintainer}),pluginConfig?.error?(0,jsx_runtime.jsx)(PluginError,{error:pluginConfig.error,reset:()=>resetPluginConfigError(pluginConfig?.id||0)}):error?(0,jsx_runtime.jsx)(PluginError,{error:error}):null,is_global&&!!currentOrganization&&currentOrganization.plugins_access_level>=constants.zB.Install&&(0,jsx_runtime.jsx)(Tooltip.u,{title:`This plugin is managed by the ${organization_name} organization`,children:(0,jsx_runtime.jsx)(es_tag.Z,{color:"blue",icon:(0,jsx_runtime.jsx)(GlobalOutlined.Z,{}),children:"Global"})}),(0,access.FZ)(user?.organization,organization_id)&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[url?.startsWith("file:")?(0,jsx_runtime.jsx)(LocalPluginTag,{url:url,title:"Local"}):null,updateStatus?.error?(0,jsx_runtime.jsxs)(es_tag.Z,{color:"red",children:[(0,jsx_runtime.jsx)(WarningOutlined.Z,{})," Error checking for updates"]}):!checkingForUpdates||updateStatus||pluginType===types.ak.Source||url?.startsWith("file:")?url&&latestTag&&tag?tag===latestTag?(0,jsx_runtime.jsxs)(es_tag.Z,{color:"green",children:[(0,jsx_runtime.jsx)(CheckOutlined.Z,{})," Up to date"]}):(0,jsx_runtime.jsx)(UpdateAvailable,{url:url,tag:tag,latestTag:latestTag}):null:(0,jsx_runtime.jsxs)(es_tag.Z,{color:"blue",children:[(0,jsx_runtime.jsx)(LoadingOutlined.Z,{})," Checking for updates…"]}),pluginType===types.ak.Source?(0,jsx_runtime.jsx)(SourcePluginTag,{}):null]})]}),(0,jsx_runtime.jsx)("div",{children:(0,utils.ne)(description)})]}),(0,jsx_runtime.jsxs)("div",{className:"space-x-2",children:[url&&(0,jsx_runtime.jsx)(PluginAboutButton,{url:url,disabled:rearranging}),showUpdateButton&&pluginId?(0,jsx_runtime.jsx)(PluginUpdateButton,{updateStatus:updateStatus,pluginId:pluginId,rearranging:rearranging}):pluginId?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[showAppMetricsForPlugin(plugin)&&pluginConfig?.id?(0,jsx_runtime.jsx)(Tooltip.u,{title:"App metrics",children:(0,jsx_runtime.jsx)(es_button.Z,{className:"padding-under-500",disabled:rearranging,"data-attr":"app-metrics",children:(0,jsx_runtime.jsx)(src.Link,{to:urls.j.appMetrics(pluginConfig.id),children:(0,jsx_runtime.jsx)(LineChartOutlined.Z,{})})})}):null,pluginConfig?.id?(0,jsx_runtime.jsx)(Tooltip.u,{title:"Activity history",children:(0,jsx_runtime.jsx)(es_button.Z,{className:"padding-under-500",disabled:rearranging,"data-attr":"plugin-history",children:(0,jsx_runtime.jsx)(src.Link,{to:urls.j.appHistory(pluginConfig.id),children:(0,jsx_runtime.jsx)(ClockCircleOutlined.Z,{})})})}):null,(0,jsx_runtime.jsx)(Tooltip.u,{title:pluginConfig?.id?"Logs":"Logs – enable the app for the first time to view them",children:(0,jsx_runtime.jsx)(es_button.Z,{className:"padding-under-500",disabled:rearranging||!pluginConfig?.id,onClick:()=>showPluginLogs(pluginId),"data-attr":"plugin-logs",children:(0,jsx_runtime.jsx)(UnorderedListOutlined.Z,{})})}),(0,jsx_runtime.jsx)(Tooltip.u,{title:"Configure",children:(0,jsx_runtime.jsx)(es_button.Z,{type:"primary",className:"padding-under-500",disabled:rearranging,onClick:()=>editPlugin(pluginId),"data-attr":"plugin-configure",children:(0,jsx_runtime.jsx)(SettingOutlined.Z,{})})})]}):pluginId?null:(0,jsx_runtime.jsx)(es_button.Z,{type:"primary",className:"padding-under-500",loading:loading&&installingPluginUrl===url,disabled:loading&&installingPluginUrl!==url,onClick:url?()=>installPlugin(url,types.ak.Repository):void 0,icon:(0,jsx_runtime.jsx)(CloudDownloadOutlined.Z,{}),"data-attr":"plugin-install",children:(0,jsx_runtime.jsx)("span",{className:"show-over-500",children:"Install"})})]})]})})})}try{PluginAboutButton.displayName="PluginAboutButton",PluginAboutButton.__docgenInfo={description:"",displayName:"PluginAboutButton",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},disabled:{defaultValue:{value:"false"},description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/PluginCard.tsx#PluginAboutButton"]={docgenInfo:PluginAboutButton.__docgenInfo,name:"PluginAboutButton",path:"frontend/src/scenes/plugins/plugin/PluginCard.tsx#PluginAboutButton"})}catch(__react_docgen_typescript_loader_error){}try{PluginCard.displayName="PluginCard",PluginCard.__docgenInfo={description:"",displayName:"PluginCard",props:{plugin:{defaultValue:null,description:"",name:"plugin",required:!0,type:{name:"Partial<PluginTypeWithConfig>"}},pluginConfig:{defaultValue:null,description:"",name:"pluginConfig",required:!1,type:{name:"PluginConfigType"}},error:{defaultValue:null,description:"",name:"error",required:!1,type:{name:"PluginErrorType"}},maintainer:{defaultValue:null,description:"",name:"maintainer",required:!1,type:{name:"string"}},showUpdateButton:{defaultValue:null,description:"",name:"showUpdateButton",required:!1,type:{name:"boolean"}},order:{defaultValue:null,description:"",name:"order",required:!1,type:{name:"number"}},maxOrder:{defaultValue:null,description:"",name:"maxOrder",required:!1,type:{name:"number"}},rearranging:{defaultValue:null,description:"",name:"rearranging",required:!1,type:{name:"boolean"}},DragColumn:{defaultValue:{value:'({ children }) => <div className="order-handle">{children}</div>'},description:"",name:"DragColumn",required:!1,type:{name:"ComponentClass<{}, any> | FC<{}>"}},unorderedPlugin:{defaultValue:{value:"false"},description:"",name:"unorderedPlugin",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/PluginCard.tsx#PluginCard"]={docgenInfo:PluginCard.__docgenInfo,name:"PluginCard",path:"frontend/src/scenes/plugins/plugin/PluginCard.tsx#PluginCard"})}catch(__react_docgen_typescript_loader_error){}var PageHeader=__webpack_require__("./frontend/src/lib/components/PageHeader.tsx"),skeleton=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/skeleton/index.js");function PluginLoading(){return(0,jsx_runtime.jsx)("div",{className:"space-y-5",children:[1,2,3].map((i=>(0,jsx_runtime.jsx)("div",{className:"w-full",children:(0,jsx_runtime.jsx)("div",{className:"border rounded plugins-scene-plugin-card",children:(0,jsx_runtime.jsxs)("div",{className:"flex items-center p-4 space-x-4",children:[(0,jsx_runtime.jsx)("div",{className:"hide-plugin-image-below-500",children:(0,jsx_runtime.jsx)(skeleton.Z.Avatar,{active:!0,size:"large",shape:"square"})}),(0,jsx_runtime.jsx)("div",{className:"flex-1",children:(0,jsx_runtime.jsx)(skeleton.Z,{title:!1,paragraph:{rows:2},active:!0})}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("span",{className:"show-over-500",children:(0,jsx_runtime.jsx)(skeleton.Z.Button,{style:{width:100}})}),(0,jsx_runtime.jsx)("span",{className:"hide-over-500",children:(0,jsx_runtime.jsx)(skeleton.Z.Button,{style:{width:32}})})]})]})})},i)))})}function PluginsSearch(){const{searchTerm:searchTerm,rearranging:rearranging}=(0,index_esm.useValues)(pluginsLogic.C),{setSearchTerm:setSearchTerm}=(0,index_esm.useActions)(pluginsLogic.C);return(0,jsx_runtime.jsx)(src.LemonInput,{type:"search","data-attr":"plugins-search",placeholder:"Search for apps",autoFocus:!0,value:searchTerm||"",onChange:setSearchTerm,disabled:rearranging})}var CaretDownOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/CaretDownOutlined.js"),CaretRightOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/CaretRightOutlined.js");let RepositorySection=function(RepositorySection){return RepositorySection.Official="official",RepositorySection.Community="community",RepositorySection}({});function RepositoryTab(){return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(PageHeader.Q,{subtitle:"App Repository"}),(0,jsx_runtime.jsx)(PluginsSearch,{}),(0,jsx_runtime.jsx)(RepositoryApps,{})]})}function RepositoryApps(){const{repositoryLoading:repositoryLoading,filteredUninstalledPlugins:filteredUninstalledPlugins}=(0,index_esm.useValues)(pluginsLogic.C),[repositorySectionsOpen,setRepositorySectionsOpen]=(0,react.useState)([RepositorySection.Official,RepositorySection.Community]),officialPlugins=filteredUninstalledPlugins.filter((plugin=>"official"===plugin.maintainer)),communityPlugins=filteredUninstalledPlugins.filter((plugin=>"community"===plugin.maintainer)),toggleRepositorySectionOpen=section=>{repositorySectionsOpen.includes(section)?setRepositorySectionsOpen(repositorySectionsOpen.filter((s=>section!==s))):setRepositorySectionsOpen([...repositorySectionsOpen,section])};return(0,jsx_runtime.jsxs)("div",{children:[(!repositoryLoading||filteredUninstalledPlugins.length>0)&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"-mx-2",children:[(0,jsx_runtime.jsx)("div",{className:"plugins-repository-tab-section-header",onClick:()=>toggleRepositorySectionOpen(RepositorySection.Official),children:(0,jsx_runtime.jsx)(PageHeader.Q,{subtitle:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[repositorySectionsOpen.includes(RepositorySection.Official)?(0,jsx_runtime.jsx)(CaretDownOutlined.Z,{}):(0,jsx_runtime.jsx)(CaretRightOutlined.Z,{}),` Official apps (${officialPlugins.length})`]})})}),repositorySectionsOpen.includes(RepositorySection.Official)&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"px-2",children:officialPlugins.length>0?"Official apps are built and maintained by the PostHog team.":"You have already installed all official apps!"}),(0,jsx_runtime.jsx)("br",{}),officialPlugins.map((plugin=>(0,jsx_runtime.jsx)(PluginCard,{plugin:{name:plugin.name,url:plugin.url,icon:plugin.icon,description:plugin.description},maintainer:plugin.maintainer},plugin.url)))]})]}),(0,jsx_runtime.jsxs)("div",{className:"-mx-2",children:[(0,jsx_runtime.jsx)("div",{className:"plugins-repository-tab-section-header",onClick:()=>toggleRepositorySectionOpen(RepositorySection.Community),children:(0,jsx_runtime.jsx)(PageHeader.Q,{subtitle:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[repositorySectionsOpen.includes(RepositorySection.Community)?(0,jsx_runtime.jsx)(CaretDownOutlined.Z,{}):(0,jsx_runtime.jsx)(CaretRightOutlined.Z,{}),` Community apps (${communityPlugins.length})`]})})}),repositorySectionsOpen.includes(RepositorySection.Community)&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"px-2",children:communityPlugins.length>0?(0,jsx_runtime.jsxs)("span",{children:["Community apps are not built nor maintained by the PostHog team."," ",(0,jsx_runtime.jsx)("a",{href:"https://posthog.com/docs/apps/build",target:"_blank",rel:"noopener",children:"Anyone, including you, can build an app."})]}):"You have already installed all community apps!"}),(0,jsx_runtime.jsx)("br",{}),communityPlugins.map((plugin=>(0,jsx_runtime.jsx)(PluginCard,{plugin:{name:plugin.name,url:plugin.url,icon:plugin.icon,description:plugin.description},maintainer:plugin.maintainer},plugin.url)))]})]})]}),repositoryLoading&&0===filteredUninstalledPlugins.length&&(0,jsx_runtime.jsx)(row.Z,{gutter:16,children:(0,jsx_runtime.jsx)(PluginLoading,{})})]})}var PluginLogs=__webpack_require__("./frontend/src/scenes/plugins/plugin/PluginLogs.tsx"),drawer=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/drawer/index.js");function LogsDrawer(){const{showingLogsPlugin:showingLogsPlugin,lastShownLogsPlugin:lastShownLogsPlugin}=(0,index_esm.useValues)(pluginsLogic.C),{hidePluginLogs:hidePluginLogs}=(0,index_esm.useActions)(pluginsLogic.C);return(0,jsx_runtime.jsx)(drawer.Z,{visible:!!showingLogsPlugin,onClose:hidePluginLogs,width:"min(90vw, 80rem)",title:`Viewing App Logs: ${lastShownLogsPlugin?.name}`,placement:"left",destroyOnClose:!0,children:!!lastShownLogsPlugin?.pluginConfig.id&&(0,jsx_runtime.jsx)(PluginLogs.b,{pluginConfigId:lastShownLogsPlugin.pluginConfig.id})})}var empty=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/empty/index.js");function PluginsEmptyState(){const{setPluginTab:setPluginTab}=(0,index_esm.useActions)(pluginsLogic.C),{loading:loading}=(0,index_esm.useValues)(pluginsLogic.C),{user:user}=(0,index_esm.useValues)(userLogic.userLogic);return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:loading?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(PageHeader.Q,{subtitle:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[" ",(0,jsx_runtime.jsx)(CaretRightOutlined.Z,{})," ","Enabled apps"," "]}),buttons:(0,jsx_runtime.jsx)(skeleton.Z.Button,{style:{width:150}})}),(0,jsx_runtime.jsx)(PluginLoading,{})]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(PageHeader.Q,{subtitle:"Installed apps"}),(0,jsx_runtime.jsx)("div",{className:"mt-4",children:(0,jsx_runtime.jsx)(empty.Z,{description:(0,jsx_runtime.jsx)("span",{children:"You haven't installed any apps yet"}),children:(0,access.YU)(user?.organization)&&(0,jsx_runtime.jsx)(src.LemonButton,{onClick:()=>setPluginTab(types.xb.Repository),status:"muted",type:"secondary",children:"Open the App Repository"})})})]})})}function InstalledPlugin(_ref){let{plugin:plugin,showUpdateButton:showUpdateButton,order:order,maxOrder:maxOrder,rearranging:rearranging,DragColumn:DragColumn,unorderedPlugin:unorderedPlugin=!1}=_ref;return(0,jsx_runtime.jsx)(PluginCard,{plugin:plugin,showUpdateButton:showUpdateButton,order:order,maxOrder:maxOrder,rearranging:rearranging,DragColumn:DragColumn,unorderedPlugin:unorderedPlugin},plugin.id)}try{InstalledPlugin.displayName="InstalledPlugin",InstalledPlugin.__docgenInfo={description:"",displayName:"InstalledPlugin",props:{plugin:{defaultValue:null,description:"",name:"plugin",required:!0,type:{name:"PluginTypeWithConfig"}},showUpdateButton:{defaultValue:null,description:"",name:"showUpdateButton",required:!1,type:{name:"boolean"}},order:{defaultValue:null,description:"",name:"order",required:!1,type:{name:"number"}},maxOrder:{defaultValue:null,description:"",name:"maxOrder",required:!1,type:{name:"number"}},rearranging:{defaultValue:null,description:"",name:"rearranging",required:!1,type:{name:"boolean"}},DragColumn:{defaultValue:null,description:"",name:"DragColumn",required:!1,type:{name:"ComponentClass<{}, any> | FC<{}>"}},unorderedPlugin:{defaultValue:{value:"false"},description:"",name:"unorderedPlugin",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/tabs/installed/InstalledPlugin.tsx#InstalledPlugin"]={docgenInfo:InstalledPlugin.__docgenInfo,name:"InstalledPlugin",path:"frontend/src/scenes/plugins/tabs/installed/InstalledPlugin.tsx#InstalledPlugin"})}catch(__react_docgen_typescript_loader_error){}function DisabledPluginSection(){const{filteredDisabledPlugins:filteredDisabledPlugins,sectionsOpen:sectionsOpen,disabledPlugins:disabledPlugins}=(0,index_esm.useValues)(pluginsLogic.C),{toggleSectionOpen:toggleSectionOpen}=(0,index_esm.useActions)(pluginsLogic.C);return 0===disabledPlugins.length?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"plugins-installed-tab-section-header",onClick:()=>toggleSectionOpen(pluginsLogic.W.Disabled),children:(0,jsx_runtime.jsx)(PageHeader.Q,{subtitle:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[sectionsOpen.includes(pluginsLogic.W.Disabled)?(0,jsx_runtime.jsx)(CaretDownOutlined.Z,{}):(0,jsx_runtime.jsx)(CaretRightOutlined.Z,{}),` Installed apps (${filteredDisabledPlugins.length})`]})})}),sectionsOpen.includes(pluginsLogic.W.Disabled)?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:filteredDisabledPlugins.length>0?(0,jsx_runtime.jsx)(row.Z,{gutter:16,style:{marginTop:16},children:filteredDisabledPlugins.map((plugin=>(0,jsx_runtime.jsx)(InstalledPlugin,{plugin:plugin},plugin.id)))}):(0,jsx_runtime.jsx)("p",{className:"m-2.5",children:"No apps match your search."})}):null]})}var SyncOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/SyncOutlined.js");function UpgradeSection(){const{checkForUpdates:checkForUpdates,toggleSectionOpen:toggleSectionOpen}=(0,index_esm.useActions)(pluginsLogic.C),{sectionsOpen:sectionsOpen}=(0,index_esm.useValues)(pluginsLogic.C),{user:user}=(0,index_esm.useValues)(userLogic.userLogic),{filteredPluginsNeedingUpdates:filteredPluginsNeedingUpdates,pluginsNeedingUpdates:pluginsNeedingUpdates,checkingForUpdates:checkingForUpdates,installedPluginUrls:installedPluginUrls,updateStatus:updateStatus,rearranging:rearranging,hasUpdatablePlugins:hasUpdatablePlugins}=(0,index_esm.useValues)(pluginsLogic.C),upgradeButton=(0,access.FZ)(user?.organization)&&hasUpdatablePlugins&&(0,jsx_runtime.jsx)(es_button.Z,{type:"default",icon:pluginsNeedingUpdates.length>0?(0,jsx_runtime.jsx)(SyncOutlined.Z,{}):(0,jsx_runtime.jsx)(CloudDownloadOutlined.Z,{}),onClick:e=>{e.stopPropagation(),checkForUpdates(!0)},loading:checkingForUpdates,children:checkingForUpdates?`Checking app ${Object.keys(updateStatus).length+1} out of ${Object.keys(installedPluginUrls).length}`:pluginsNeedingUpdates.length>0?"Check again for updates":"Check for updates"});return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"plugins-installed-tab-section-header",onClick:()=>toggleSectionOpen(pluginsLogic.W.Upgrade),children:(0,jsx_runtime.jsx)(PageHeader.Q,{subtitle:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[sectionsOpen.includes(pluginsLogic.W.Upgrade)?(0,jsx_runtime.jsx)(CaretDownOutlined.Z,{}):(0,jsx_runtime.jsx)(CaretRightOutlined.Z,{}),` Apps to update (${filteredPluginsNeedingUpdates.length})`]}),buttons:!rearranging&&upgradeButton})}),sectionsOpen.includes(pluginsLogic.W.Upgrade)?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:pluginsNeedingUpdates.length>0?(0,jsx_runtime.jsx)(row.Z,{gutter:16,style:{marginTop:16},children:filteredPluginsNeedingUpdates.length>0?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:filteredPluginsNeedingUpdates.map((plugin=>(0,jsx_runtime.jsx)(InstalledPlugin,{plugin:plugin,showUpdateButton:!0},plugin.id)))}):(0,jsx_runtime.jsx)("p",{className:"m-2.5",children:"No apps match your search."})}):(0,jsx_runtime.jsx)("p",{className:"m-2.5",children:"All your apps are up to date. Great work!"})}):null]})}var SaveOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/SaveOutlined.js"),CloseOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),OrderedListOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/OrderedListOutlined.js"),react_sortable_hoc_esm=__webpack_require__("./node_modules/.pnpm/react-sortable-hoc@1.11.0_prop-types@15.8.1_react-dom@16.14.0_react@16.14.0/node_modules/react-sortable-hoc/dist/react-sortable-hoc.esm.js");const DragColumn=(0,react_sortable_hoc_esm.W6)((_ref=>{let{children:children}=_ref;return(0,jsx_runtime.jsx)("div",{className:"order-handle",children:children})})),SortablePlugin=(0,react_sortable_hoc_esm.W8)((_ref2=>{let{plugin:plugin,order:order,maxOrder:maxOrder,rearranging:rearranging}=_ref2;return(0,jsx_runtime.jsx)(InstalledPlugin,{plugin:plugin,order:order,maxOrder:maxOrder,rearranging:rearranging,DragColumn:DragColumn})})),SortablePlugins=(0,react_sortable_hoc_esm.JN)((_ref3=>{let{children:children}=_ref3;return(0,jsx_runtime.jsx)("div",{className:"mt-4",children:children})}));function EnabledPluginSection(){const{user:user}=(0,index_esm.useValues)(userLogic.userLogic),{rearrange:rearrange,setTemporaryOrder:setTemporaryOrder,cancelRearranging:cancelRearranging,savePluginOrders:savePluginOrders,makePluginOrderSaveable:makePluginOrderSaveable,toggleSectionOpen:toggleSectionOpen}=(0,index_esm.useActions)(pluginsLogic.C),{enabledPlugins:enabledPlugins,filteredEnabledPlugins:filteredEnabledPlugins,sortableEnabledPlugins:sortableEnabledPlugins,unsortableEnabledPlugins:unsortableEnabledPlugins,rearranging:rearranging,loading:loading,temporaryOrder:temporaryOrder,pluginOrderSaveable:pluginOrderSaveable,searchTerm:searchTerm,sectionsOpen:sectionsOpen}=(0,index_esm.useValues)(pluginsLogic.C),canRearrange=(0,access.z9)(user?.organization)&&sortableEnabledPlugins.length>1,rearrangingButtons=rearranging?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(es_button.Z,{type:"primary",icon:(0,jsx_runtime.jsx)(SaveOutlined.Z,{}),loading:loading,onClick:e=>{e.stopPropagation(),savePluginOrders(temporaryOrder)},disabled:!pluginOrderSaveable,children:"Save order"}),(0,jsx_runtime.jsx)(es_button.Z,{type:"default",icon:(0,jsx_runtime.jsx)(CloseOutlined.Z,{}),onClick:e=>{cancelRearranging(),e.stopPropagation()},children:"Cancel"})]}):(0,jsx_runtime.jsx)(Tooltip.u,{title:enabledPlugins.length<=1?"At least two apps need to be enabled for reordering.":(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:searchTerm?"Editing the order of apps is disabled when searching.":(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Order matters because event processing with apps works like a pipe: the event is processed by every enabled app ",(0,jsx_runtime.jsx)("b",{children:"in sequence"}),"."]})}),placement:"top",children:(0,jsx_runtime.jsx)(es_button.Z,{icon:(0,jsx_runtime.jsx)(OrderedListOutlined.Z,{}),onClick:e=>{e.stopPropagation(),rearrange()},disabled:!!searchTerm||sortableEnabledPlugins.length<=1,children:"Edit order"})}),EnabledPluginsHeader=()=>(0,jsx_runtime.jsx)("div",{className:"plugins-installed-tab-section-header",onClick:()=>toggleSectionOpen(pluginsLogic.W.Enabled),children:(0,jsx_runtime.jsx)(PageHeader.Q,{subtitle:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[sectionsOpen.includes(pluginsLogic.W.Enabled)?(0,jsx_runtime.jsx)(CaretDownOutlined.Z,{}):(0,jsx_runtime.jsx)(CaretRightOutlined.Z,{}),` Enabled apps (${filteredEnabledPlugins.length})`,rearranging&&sectionsOpen.includes(pluginsLogic.W.Enabled)&&(0,jsx_runtime.jsx)(es_tag.Z,{color:"red",style:{fontWeight:"normal",marginLeft:10},children:"Reordering in progress"})]}),buttons:(0,jsx_runtime.jsx)("div",{className:"space-x-2",children:sectionsOpen.includes(pluginsLogic.W.Enabled)&&rearrangingButtons})})});return 0===enabledPlugins.length?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(EnabledPluginsHeader,{}),sectionsOpen.includes(pluginsLogic.W.Enabled)&&(0,jsx_runtime.jsx)("p",{className:"m-2.5",children:"No apps enabled."})]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(EnabledPluginsHeader,{}),sectionsOpen.includes(pluginsLogic.W.Enabled)&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[0===sortableEnabledPlugins.length&&0===unsortableEnabledPlugins.length&&(0,jsx_runtime.jsx)("p",{className:"m-2.5",children:"No apps match your search."}),canRearrange||rearranging?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:sortableEnabledPlugins.length>0&&(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(SortablePlugins,{useDragHandle:!0,onSortEnd:_ref4=>{let{oldIndex:oldIndex,newIndex:newIndex}=_ref4;if(oldIndex===newIndex)return;const movedPluginId=enabledPlugins[oldIndex]?.id,newTemporaryOrder={};for(const{id:id,order:order}of((arr,from,to)=>{const clone=[...arr];return Array.prototype.splice.call(clone,to,0,Array.prototype.splice.call(clone,from,1)[0]),clone.map(((_ref5,order)=>{let{id:id}=_ref5;return{id:id,order:order+1}}))})(enabledPlugins,oldIndex,newIndex))newTemporaryOrder[id]=order;rearranging||rearrange(),setTemporaryOrder(newTemporaryOrder,movedPluginId)},onSortOver:makePluginOrderSaveable,children:sortableEnabledPlugins.map(((plugin,index)=>(0,jsx_runtime.jsx)(SortablePlugin,{plugin:plugin,index:index,order:index+1,maxOrder:enabledPlugins.length,rearranging:rearranging},plugin.id)))})})}):(0,jsx_runtime.jsx)("div",{className:"mt-4",children:sortableEnabledPlugins.length>0&&(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:sortableEnabledPlugins.map(((plugin,index)=>(0,jsx_runtime.jsx)(InstalledPlugin,{plugin:plugin,order:index+1,maxOrder:filteredEnabledPlugins.length},plugin.id)))})}),unsortableEnabledPlugins.map((plugin=>(0,jsx_runtime.jsx)(InstalledPlugin,{plugin:plugin,maxOrder:enabledPlugins.length,rearranging:rearranging,unorderedPlugin:!0},plugin.id)))]})]})}function InstalledTab(){const{installedPlugins:installedPlugins}=(0,index_esm.useValues)(pluginsLogic.C);return 0===installedPlugins.length?(0,jsx_runtime.jsx)(PluginsEmptyState,{}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(PluginsSearch,{}),(0,jsx_runtime.jsx)(UpgradeSection,{}),(0,jsx_runtime.jsx)(EnabledPluginSection,{}),(0,jsx_runtime.jsx)(DisabledPluginSection,{})]}),(0,jsx_runtime.jsx)(LogsDrawer,{})]})}var es_alert=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/alert/index.js"),Title=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/lib/typography/Title.js"),Paragraph=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/lib/typography/Paragraph.js");function SourcePlugin(){const{sourcePluginName:sourcePluginName,pluginError:pluginError,loading:loading}=(0,index_esm.useValues)(pluginsLogic.C),{setSourcePluginName:setSourcePluginName,installPlugin:installPlugin}=(0,index_esm.useActions)(pluginsLogic.C);return(0,jsx_runtime.jsxs)("div",{className:"border rounded p-4",children:[(0,jsx_runtime.jsx)(Title.Z,{level:5,children:"App editor"}),(0,jsx_runtime.jsxs)(Paragraph.Z,{children:["Write your app directly in PostHog."," ",(0,jsx_runtime.jsx)("a",{href:"https://posthog.com/docs/apps",target:"_blank",children:"Read the documentation for more information!"})]}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-1 space-x-2",children:[(0,jsx_runtime.jsx)(src.LemonInput,{value:sourcePluginName,disabled:loading,onChange:value=>setSourcePluginName(value),placeholder:'For example: "Hourly Weather Sync App"',fullWidth:!0,size:"small"}),(0,jsx_runtime.jsx)(src.LemonButton,{disabledReason:loading||!sourcePluginName?"Enter a plugin name":void 0,loading:loading,onClick:()=>installPlugin(sourcePluginName,types.ak.Source),size:"small",status:"muted",type:"secondary",children:"Start coding"})]}),pluginError?(0,jsx_runtime.jsx)("p",{style:{color:"var(--red)",marginTop:10},children:pluginError}):null]})}function CustomPlugin(){const{customPluginUrl:customPluginUrl,pluginError:pluginError,loading:loading}=(0,index_esm.useValues)(pluginsLogic.C),{setCustomPluginUrl:setCustomPluginUrl,installPlugin:installPlugin}=(0,index_esm.useActions)(pluginsLogic.C);return(0,jsx_runtime.jsxs)("div",{className:"border rounded p-4",children:[(0,jsx_runtime.jsx)(Title.Z,{level:5,children:"Install from GitHub, GitLab or npm"}),(0,jsx_runtime.jsxs)(Paragraph.Z,{children:["To install a third-party or custom app, paste its URL below. For"," ",(0,jsx_runtime.jsx)("a",{href:"https://docs.github.com/en/github/authenticating-to-github/creating-a-personal-access-token",target:"_blank",rel:"noopener noreferrer",children:"GitHub"}),", ",(0,jsx_runtime.jsx)("a",{href:"https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html",target:"_blank",rel:"noopener noreferrer",children:"GitLab"})," and ",(0,jsx_runtime.jsx)("a",{href:"https://docs.npmjs.com/creating-and-viewing-access-tokens",target:"_blank",rel:"noopener noreferrer",children:"npm"})," ","private repositories, append ",(0,jsx_runtime.jsx)("code",{children:"?private_token=TOKEN"})," to the end of the URL.",(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("b",{className:"text-warning",children:"Warning: Only install apps from trusted sources."})]}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-1 space-x-2",children:[(0,jsx_runtime.jsx)(src.LemonInput,{value:customPluginUrl,disabled:loading,onChange:value=>setCustomPluginUrl(value),placeholder:"https://github.com/user/repo",fullWidth:!0,size:"small"}),(0,jsx_runtime.jsx)(src.LemonButton,{disabledReason:loading||!customPluginUrl?"Enter a plugin URL":void 0,loading:loading,onClick:()=>installPlugin(customPluginUrl,types.ak.Custom),size:"small",status:"muted",type:"secondary",children:"Fetch and install"})]}),pluginError?(0,jsx_runtime.jsx)("p",{style:{color:"var(--red)",marginTop:10},children:pluginError}):null]})}function LocalPlugin(){const{localPluginUrl:localPluginUrl,pluginError:pluginError,loading:loading}=(0,index_esm.useValues)(pluginsLogic.C),{setLocalPluginUrl:setLocalPluginUrl,installPlugin:installPlugin}=(0,index_esm.useActions)(pluginsLogic.C);return(0,jsx_runtime.jsxs)("div",{className:"border rounded p-4",children:[(0,jsx_runtime.jsx)(Title.Z,{level:5,children:"Install Local App"}),(0,jsx_runtime.jsx)(Paragraph.Z,{children:"To install a local app from this computer/server, give its full path below."}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-1 space-x-2",children:[(0,jsx_runtime.jsx)(src.LemonInput,{value:localPluginUrl,disabled:loading,onChange:value=>setLocalPluginUrl(value),placeholder:"/var/posthog/plugins/helloworldplugin",fullWidth:!0,size:"small"}),(0,jsx_runtime.jsx)(src.LemonButton,{disabledReason:loading||!localPluginUrl?"Enter a plugin URL":void 0,loading:loading,onClick:()=>installPlugin(localPluginUrl,types.ak.Local),size:"small",status:"muted",type:"secondary",children:"Install"})]}),pluginError?(0,jsx_runtime.jsx)("p",{style:{color:"var(--red)",marginTop:10},children:pluginError}):null]})}var preflightLogic=__webpack_require__("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx");function AdvancedTab(){const{preflight:preflight}=(0,index_esm.useValues)(preflightLogic.preflightLogic),{setPluginTab:setPluginTab}=(0,index_esm.useActions)(pluginsLogic.C);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(es_alert.Z,{message:"Advanced features ahead",description:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Create and install your ",(0,jsx_runtime.jsx)("b",{children:"own apps"})," or apps from ",(0,jsx_runtime.jsx)("b",{children:"third-parties"}),". If you're looking for officially supported apps, try the"," ",(0,jsx_runtime.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),setPluginTab(types.xb.Repository)},children:"App Repository"}),"."]}),type:"warning",showIcon:!0}),(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsx)(PageHeader.Q,{subtitle:"Advanced Options"}),(0,jsx_runtime.jsx)(SourcePlugin,{}),(0,jsx_runtime.jsx)(CustomPlugin,{}),preflight&&!preflight.cloud&&(0,jsx_runtime.jsx)(LocalPlugin,{})]})]})}var ActivityLog=__webpack_require__("./frontend/src/lib/components/ActivityLog/ActivityLog.tsx"),humanizeActivity=__webpack_require__("./frontend/src/lib/components/ActivityLog/humanizeActivity.tsx"),LemonTabs=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTabs/index.ts"),BatchExportsListScene=__webpack_require__("./frontend/src/scenes/batch_exports/BatchExportsListScene.tsx");function BatchExportsTab(){return(0,jsx_runtime.jsx)(BatchExportsListScene.BatchExportsList,{})}var icons=__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts"),LemonModal=__webpack_require__("./frontend/src/lib/lemon-ui/LemonModal/index.ts"),LemonBanner=__webpack_require__("./frontend/src/lib/lemon-ui/LemonBanner/index.ts");function AdvancedInstallModal(){const{preflight:preflight}=(0,index_esm.useValues)(preflightLogic.preflightLogic),{advancedInstallModalOpen:advancedInstallModalOpen,pluginError:pluginError,loading:loading,sourcePluginName:sourcePluginName,customPluginUrl:customPluginUrl,localPluginUrl:localPluginUrl}=(0,index_esm.useValues)(pluginsLogic.C),{closeAdvancedInstallModal:closeAdvancedInstallModal,installPlugin:installPlugin,setSourcePluginName:setSourcePluginName,setCustomPluginUrl:setCustomPluginUrl,setLocalPluginUrl:setLocalPluginUrl}=(0,index_esm.useActions)(pluginsLogic.C);return(0,jsx_runtime.jsx)(LemonModal.f,{onClose:closeAdvancedInstallModal,isOpen:advancedInstallModalOpen,width:600,title:"Advanced app installation",footer:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",onClick:closeAdvancedInstallModal,children:"Cancel"})}),children:(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsx)(LemonBanner.V,{type:"warning",children:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("b",{children:"Advanced features ahead"}),(0,jsx_runtime.jsx)("br",{}),"Create and install your ",(0,jsx_runtime.jsx)("b",{children:"own apps"})," or apps from ",(0,jsx_runtime.jsx)("b",{children:"third-parties"}),"."]})}),pluginError?(0,jsx_runtime.jsx)(LemonBanner.V,{type:"error",children:pluginError}):null,(0,jsx_runtime.jsxs)("div",{className:"",children:[(0,jsx_runtime.jsx)(src.LemonLabel,{children:"Code your own app"}),(0,jsx_runtime.jsxs)("p",{children:["Write your app directly in PostHog."," ",(0,jsx_runtime.jsx)("a",{href:"https://posthog.com/docs/apps",target:"_blank",children:"Read the documentation for more information!"})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(src.LemonInput,{value:sourcePluginName,disabled:loading,onChange:setSourcePluginName,placeholder:'For example: "Hourly Weather Sync App"',className:"flex-1"}),(0,jsx_runtime.jsx)(src.LemonButton,{disabledReason:sourcePluginName?void 0:"Please enter a name",loading:loading,type:"primary",onClick:()=>installPlugin(sourcePluginName,types.ak.Source),children:"Start coding"})]})]}),(0,jsx_runtime.jsxs)("div",{className:"",children:[(0,jsx_runtime.jsx)(src.LemonLabel,{children:"Install from GitHub, GitLab or npm"}),(0,jsx_runtime.jsxs)("p",{children:["To install a third-party or custom app, paste its URL below. For"," ",(0,jsx_runtime.jsx)("a",{href:"https://docs.github.com/en/github/authenticating-to-github/creating-a-personal-access-token",target:"_blank",rel:"noopener noreferrer",children:"GitHub"}),", ",(0,jsx_runtime.jsx)("a",{href:"https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html",target:"_blank",rel:"noopener noreferrer",children:"GitLab"})," and ",(0,jsx_runtime.jsx)("a",{href:"https://docs.npmjs.com/creating-and-viewing-access-tokens",target:"_blank",rel:"noopener noreferrer",children:"npm"})," ","private repositories, append ",(0,jsx_runtime.jsx)("code",{children:"?private_token=TOKEN"})," to the end of the URL.",(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("b",{className:"text-warning",children:"Warning: Only install apps from trusted sources."})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(src.LemonInput,{value:customPluginUrl,disabled:loading,onChange:setCustomPluginUrl,placeholder:"https://github.com/user/repo",className:"flex-1"}),(0,jsx_runtime.jsx)(src.LemonButton,{disabledReason:customPluginUrl?void 0:"Please enter a url",loading:loading,type:"primary",onClick:()=>installPlugin(customPluginUrl,types.ak.Custom),children:"Fetch and install"})]})]}),preflight&&!preflight.cloud&&(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)("div",{className:"",children:[(0,jsx_runtime.jsx)(src.LemonLabel,{children:"Install Local App"}),(0,jsx_runtime.jsx)("p",{children:"To install a local app from this computer/server, give its full path below."}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(src.LemonInput,{value:localPluginUrl,disabled:loading,onChange:setLocalPluginUrl,placeholder:"/var/posthog/plugins/helloworldplugin",className:"flex-1"}),(0,jsx_runtime.jsx)(src.LemonButton,{disabledReason:localPluginUrl?void 0:"Please enter a path",loading:loading,type:"primary",onClick:()=>installPlugin(localPluginUrl,types.ak.Local),children:"Install"})]})]})})]})})}var LemonMenu=__webpack_require__("./frontend/src/lib/lemon-ui/LemonMenu/index.ts"),components=__webpack_require__("./frontend/src/scenes/plugins/tabs/apps/components.tsx");function AppView(_ref){var _pluginConfig$deliver;let{plugin:plugin}=_ref;const{installingPluginUrl:installingPluginUrl,pluginsNeedingUpdates:pluginsNeedingUpdates,pluginsUpdating:pluginsUpdating,showAppMetricsForPlugin:showAppMetricsForPlugin,loading:loading,sortableEnabledPlugins:sortableEnabledPlugins}=(0,index_esm.useValues)(pluginsLogic.C),{installPlugin:installPlugin,editPlugin:editPlugin,toggleEnabled:toggleEnabled,updatePlugin:updatePlugin,openReorderModal:openReorderModal}=(0,index_esm.useActions)(pluginsLogic.C),pluginConfig="pluginConfig"in plugin?plugin.pluginConfig:null,isConfigured=!!pluginConfig?.id,orderedIndex=sortableEnabledPlugins.indexOf(plugin)+1,menuItems=[];return plugin.url&&menuItems.push({label:"Source",sideIcon:(0,jsx_runtime.jsx)(icons.JHz,{}),to:plugin.url,targetBlank:!0}),isConfigured&&menuItems.push({label:pluginConfig?.enabled?"Disable":"Enable",status:pluginConfig.enabled?"danger":"primary",onClick:()=>toggleEnabled({id:pluginConfig.id,enabled:!pluginConfig.enabled})}),(0,jsx_runtime.jsxs)("div",{className:"flex justify-between items-center",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-4",children:[isConfigured&&pluginConfig.enabled&&(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)(Tooltip.u,{title:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[" ",orderedIndex?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Apps that react to incoming events run in order. This app runs in position"," ",orderedIndex,".",(0,jsx_runtime.jsx)("br",{}),"Click to change the order of the plugins."]}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"As this app is not part of the processing flow, the order is unimportant "})]}),children:(0,jsx_runtime.jsx)(src.LemonButton,{onClick:()=>openReorderModal(),noPadding:!0,children:orderedIndex?(0,jsx_runtime.jsx)(src.LemonBadge.Number,{status:"primary",count:orderedIndex,maxDigits:3}):(0,jsx_runtime.jsx)(src.LemonBadge,{status:"primary",content:"-"})})})}),(0,jsx_runtime.jsx)(PluginImage.c,{plugin:plugin}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 items-center",children:[pluginConfig&&showAppMetricsForPlugin(plugin)&&pluginConfig.id&&(0,jsx_runtime.jsx)(SuccessRateBadge,{deliveryRate:null!==(_pluginConfig$deliver=pluginConfig.delivery_rate_24h)&&void 0!==_pluginConfig$deliver?_pluginConfig$deliver:null,pluginConfigId:pluginConfig.id}),(0,jsx_runtime.jsx)("span",{className:"font-semibold truncate",children:isConfigured?(0,jsx_runtime.jsx)(src.Link,{to:isConfigured?urls.j.appMetrics(pluginConfig.id||""):plugin.url,target:isConfigured?void 0:"blank",children:plugin.name}):plugin.name}),(0,jsx_runtime.jsx)(components.WZ,{plugin:plugin})]}),(0,jsx_runtime.jsx)("div",{className:"text-sm",children:plugin.description})]})]}),(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 whitespace-nowrap items-center justify-end",children:["id"in plugin&&pluginConfig?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[!pluginConfig.enabled&&isConfigured&&(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",size:"small",onClick:()=>toggleEnabled({id:pluginConfig.id,enabled:!0}),children:"Enable"}),"updateStatus"in plugin&&pluginsNeedingUpdates.find((x=>x.id===plugin.id))&&(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",size:"small",onClick:()=>{plugin.updateStatus?.updated?editPlugin(plugin.id):updatePlugin(plugin.id)},loading:pluginsUpdating.includes(plugin.id),icon:plugin.updateStatus?.updated?(0,jsx_runtime.jsx)(icons.DLh,{}):(0,jsx_runtime.jsx)(icons.fY8,{}),children:plugin.updateStatus?.updated?"Updated":"Update"}),pluginConfig.id&&(pluginConfig.error?(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",status:"danger",size:"small",icon:(0,jsx_runtime.jsx)(icons.b8K,{}),to:urls.j.appLogs(pluginConfig.id),children:"Errors"}):(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",size:"small",icon:(0,jsx_runtime.jsx)(icons._yM,{}),to:urls.j.appLogs(pluginConfig.id),children:"Logs & metrics"})),(0,jsx_runtime.jsx)(src.LemonButton,{type:"primary",size:"small",icon:(0,jsx_runtime.jsx)(icons.iCC,{}),onClick:()=>editPlugin(plugin.id),children:"Configure"})]}):(0,jsx_runtime.jsx)(src.LemonButton,{type:"primary",loading:loading&&installingPluginUrl===plugin.url,icon:(0,jsx_runtime.jsx)(icons.fY8,{}),size:"small",onClick:()=>plugin.url?installPlugin(plugin.url,types.ak.Repository):void 0,children:"Install"}),(0,jsx_runtime.jsx)(LemonMenu.d,{items:menuItems,placement:"left",children:(0,jsx_runtime.jsx)(src.LemonButton,{size:"small",icon:(0,jsx_runtime.jsx)(icons.YRX,{})})})]})]})}try{AppView.displayName="AppView",AppView.__docgenInfo={description:"",displayName:"AppView",props:{plugin:{defaultValue:null,description:"",name:"plugin",required:!0,type:{name:"PluginType | PluginRepositoryEntry | PluginTypeWithConfig"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/tabs/apps/AppView.tsx#AppView"]={docgenInfo:AppView.__docgenInfo,name:"AppView",path:"frontend/src/scenes/plugins/tabs/apps/AppView.tsx#AppView"})}catch(__react_docgen_typescript_loader_error){}const SortableAppView=(0,react_sortable_hoc_esm.W8)((_ref=>{let{plugin:plugin,order:order}=_ref;return(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 cursor-move border rounded p-2 items-center bg-light",style:{zIndex:999999},children:[(0,jsx_runtime.jsx)(src.LemonBadge.Number,{count:order+1,maxDigits:3}),(0,jsx_runtime.jsx)(PluginImage.c,{plugin:plugin,size:"small"}),(0,jsx_runtime.jsx)("span",{className:"font-semibold",children:plugin.name})]})})),SortableAppList=(0,react_sortable_hoc_esm.JN)((_ref2=>{let{children:children}=_ref2;return(0,jsx_runtime.jsx)("span",{className:"flex flex-col gap-2",children:children})}));function InstalledAppsReorderModal(){const{reorderModalOpen:reorderModalOpen,sortableEnabledPlugins:sortableEnabledPlugins,temporaryOrder:temporaryOrder,pluginConfigsLoading:pluginConfigsLoading}=(0,index_esm.useValues)(pluginsLogic.C),{closeReorderModal:closeReorderModal,setTemporaryOrder:setTemporaryOrder,cancelRearranging:cancelRearranging,savePluginOrders:savePluginOrders}=(0,index_esm.useActions)(pluginsLogic.C),onClose=()=>{cancelRearranging(),closeReorderModal()};return(0,jsx_runtime.jsx)(LemonModal.f,{onClose:onClose,isOpen:reorderModalOpen,width:600,title:"Re-order processing apps",description:(0,jsx_runtime.jsxs)("p",{children:["The order of some apps is important as they are processed sequentially. You can"," ",(0,jsx_runtime.jsx)("b",{children:"drag and drop the apps below"})," to change their order."]}),footer:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",onClick:onClose,children:"Cancel"}),(0,jsx_runtime.jsx)(src.LemonButton,{loading:pluginConfigsLoading,type:"primary",onClick:()=>savePluginOrders(temporaryOrder),children:"Save order"})]}),children:(0,jsx_runtime.jsx)("div",{className:"space-y-4",children:(0,jsx_runtime.jsx)(SortableAppList,{onSortEnd:_ref3=>{let{oldIndex:oldIndex,newIndex:newIndex}=_ref3;const cloned=[...sortableEnabledPlugins],[removed]=cloned.splice(oldIndex,1);cloned.splice(newIndex,0,removed);const newTemporaryOrder=cloned.reduce(((acc,plugin,index)=>({...acc,[plugin.id]:index+1})),{});setTemporaryOrder(newTemporaryOrder,removed.id)},axis:"y",lockAxis:"y",lockToContainerEdges:!0,distance:5,children:sortableEnabledPlugins.map(((plugin,index)=>(0,jsx_runtime.jsx)(SortableAppView,{index:index,order:index,plugin:plugin},`item-${index}`)))})})})}function AppsTab(){const{user:user}=(0,index_esm.useValues)(userLogic.userLogic),{checkForUpdates:checkForUpdates,openAdvancedInstallModal:openAdvancedInstallModal}=(0,index_esm.useActions)(pluginsLogic.C),{sortableEnabledPlugins:sortableEnabledPlugins,unsortableEnabledPlugins:unsortableEnabledPlugins,filteredDisabledPlugins:filteredDisabledPlugins,installedPluginUrls:installedPluginUrls,filteredPluginsNeedingUpdates:filteredPluginsNeedingUpdates,loading:loading,filteredUninstalledPlugins:filteredUninstalledPlugins,repositoryLoading:repositoryLoading,pluginsNeedingUpdates:pluginsNeedingUpdates,hasUpdatablePlugins:hasUpdatablePlugins,checkingForUpdates:checkingForUpdates,updateStatus:updateStatus}=(0,index_esm.useValues)(pluginsLogic.C),officialPlugins=(0,react.useMemo)((()=>filteredUninstalledPlugins.filter((plugin=>"official"===plugin.maintainer))),[filteredUninstalledPlugins]),communityPlugins=(0,react.useMemo)((()=>filteredUninstalledPlugins.filter((plugin=>"community"===plugin.maintainer))),[filteredUninstalledPlugins]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 items-center justify-between",children:[(0,jsx_runtime.jsx)(PluginsSearch,{}),(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,access.FZ)(user?.organization)&&hasUpdatablePlugins&&(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",icon:pluginsNeedingUpdates.length>0?(0,jsx_runtime.jsx)(icons.tr8,{}):(0,jsx_runtime.jsx)(icons.fY8,{}),onClick:e=>{e.stopPropagation(),checkForUpdates(!0)},loading:checkingForUpdates,children:checkingForUpdates?`Checking app ${Object.keys(updateStatus).length+1} out of ${Object.keys(installedPluginUrls).length}`:pluginsNeedingUpdates.length>0?"Check again for updates":"Check for updates"}),(0,access.FZ)(user?.organization)&&(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",onClick:openAdvancedInstallModal,children:"Install app (advanced)"})]})]}),(0,jsx_runtime.jsx)(components.Gs,{}),filteredPluginsNeedingUpdates.length>0&&(0,jsx_runtime.jsx)(AppsTable,{title:"Apps to Update",plugins:filteredPluginsNeedingUpdates,loading:loading||checkingForUpdates}),(0,jsx_runtime.jsx)(AppsTable,{title:"Enabled Apps",plugins:[...sortableEnabledPlugins,...unsortableEnabledPlugins],loading:loading}),(0,jsx_runtime.jsx)(AppsTable,{title:"Available Apps",plugins:filteredDisabledPlugins,loading:loading}),(0,access.YU)(user?.organization)&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(src.LemonDivider,{className:"my-8"}),(0,jsx_runtime.jsx)(AppsTable,{title:"Repository - Official",plugins:officialPlugins,loading:repositoryLoading}),(0,jsx_runtime.jsx)(AppsTable,{title:"Repository - Community",plugins:communityPlugins,loading:repositoryLoading})]})]}),(0,jsx_runtime.jsx)(AdvancedInstallModal,{}),(0,jsx_runtime.jsx)(PluginDrawer.e,{}),(0,jsx_runtime.jsx)(InstalledAppsReorderModal,{})]})}function AppsTable(_ref){let{title:title="Apps",plugins:plugins,loading:loading}=_ref;const[expanded,setExpanded]=(0,react.useState)(!0),{searchTerm:searchTerm}=(0,index_esm.useValues)(pluginsLogic.C);return(0,jsx_runtime.jsx)(src.LemonTable,{dataSource:expanded?plugins:[],loading:loading,columns:[{title:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(src.LemonButton,{size:"small",status:"stealth",sideIcon:expanded?(0,jsx_runtime.jsx)(icons.So7,{}):(0,jsx_runtime.jsx)(icons.GZ,{}),onClick:()=>setExpanded(!expanded),className:"-ml-2 mr-2"}),title]}),key:"app",render:(_,plugin)=>(0,jsx_runtime.jsx)(AppView,{plugin:plugin})}],emptyState:expanded?searchTerm?"No apps matching your search criteria":"No apps found":(0,jsx_runtime.jsx)("span",{className:"flex gap-2 items-center",children:(0,jsx_runtime.jsx)(src.LemonButton,{size:"small",onClick:()=>setExpanded(!0),children:"Show apps"})})})}try{AppsTable.displayName="AppsTable",AppsTable.__docgenInfo={description:"",displayName:"AppsTable",props:{title:{defaultValue:{value:"Apps"},description:"",name:"title",required:!1,type:{name:"string"}},plugins:{defaultValue:null,description:"",name:"plugins",required:!0,type:{name:"(PluginType | PluginRepositoryEntry | PluginTypeWithConfig)[]"}},loading:{defaultValue:null,description:"",name:"loading",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/tabs/apps/AppsTab.tsx#AppsTable"]={docgenInfo:AppsTable.__docgenInfo,name:"AppsTable",path:"frontend/src/scenes/plugins/tabs/apps/AppsTab.tsx#AppsTable"})}catch(__react_docgen_typescript_loader_error){}pluginsLogic.C;function AppsScene(){const{user:user}=(0,index_esm.useValues)(userLogic.userLogic),{pluginTab:pluginTab}=(0,index_esm.useValues)(pluginsLogic.C),{setPluginTab:setPluginTab}=(0,index_esm.useActions)(pluginsLogic.C);return(0,react.useEffect)((()=>{(0,access.XW)(user?.organization)||(window.location.href="/")}),[user]),user&&(0,access.XW)(user?.organization)?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(PageHeader.m,{title:"Apps & Exports",tabbedPage:!0,buttons:pluginTab===types.xb.BatchExports?(0,jsx_runtime.jsx)(src.LemonButton,{type:"primary",to:urls.j.batchExportNew(),children:"Create export workflow"}):void 0}),(0,jsx_runtime.jsx)(LemonTabs.T,{"data-attr":"apps-tabs",activeKey:pluginTab,onChange:newKey=>setPluginTab(newKey),tabs:[{key:types.xb.Apps,label:"Apps",content:(0,jsx_runtime.jsx)(AppsTab,{})},{key:types.xb.BatchExports,label:"Batch Exports",content:(0,jsx_runtime.jsx)(BatchExportsTab,{})},{key:types.xb.History,label:"History",content:(0,jsx_runtime.jsx)(ActivityLog.D,{scope:humanizeActivity.jc.PLUGIN})}]})]}):null}var featureFlagLogic=__webpack_require__("./frontend/src/lib/logic/featureFlagLogic.ts");const Plugins_scene={component:Plugins_Plugins,logic:pluginsLogic.C},BetaTag=()=>(0,jsx_runtime.jsx)(src.LemonTag,{type:"warning",className:"uppercase",style:{verticalAlign:"0.125em",marginLeft:6},children:"BETA"});function Plugins_Plugins(){const{user:user}=(0,index_esm.useValues)(userLogic.userLogic),{pluginTab:pluginTab}=(0,index_esm.useValues)(pluginsLogic.C),{setPluginTab:setPluginTab}=(0,index_esm.useActions)(pluginsLogic.C);(0,react.useEffect)((()=>{(0,access.XW)(user?.organization)||(window.location.href="/")}),[user]);const{featureFlags:featureFlags}=(0,index_esm.useValues)(featureFlagLogic.h),newUI=featureFlags[constants.y8.APPS_AND_EXPORTS_UI];return(0,react.useEffect)((()=>{const newUiTabs=[types.xb.Apps,types.xb.BatchExports];newUI&&!newUiTabs.includes(pluginTab)?setPluginTab(types.xb.Apps):!newUI&&newUiTabs.includes(pluginTab)&&setPluginTab(types.xb.Installed)}),[newUI]),featureFlags[constants.y8.APPS_AND_EXPORTS_UI]?(0,jsx_runtime.jsx)(AppsScene,{}):user&&(0,access.XW)(user?.organization)?(0,jsx_runtime.jsxs)("div",{className:"plugins-scene",children:[(0,jsx_runtime.jsx)(PageHeader.m,{title:"Apps",caption:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Apps enable you to extend PostHog's core data processing functionality.",(0,jsx_runtime.jsx)("br",{}),"Make use of verified apps from the"," ",(0,jsx_runtime.jsx)("a",{href:"https://posthog.com/apps",target:"_blank",children:"App Library"})," ","– or"," ",(0,jsx_runtime.jsx)("a",{href:"https://posthog.com/docs/apps/build",target:"_blank",children:"build your own"}),"."]}),tabbedPage:!0}),(0,jsx_runtime.jsx)(LemonTabs.T,{"data-attr":"apps-tabs",activeKey:pluginTab,onChange:newKey=>setPluginTab(newKey),tabs:[{key:types.xb.Installed,label:"Installed",content:(0,jsx_runtime.jsx)(InstalledTab,{})},(0,access.YU)(user.organization)&&{key:types.xb.Repository,label:"Repository",content:(0,jsx_runtime.jsx)(RepositoryTab,{})},{key:types.xb.History,label:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("span",{children:"History"}),(0,jsx_runtime.jsx)(BetaTag,{})]}),content:(0,jsx_runtime.jsx)(ActivityLog.D,{scope:humanizeActivity.jc.PLUGIN})},(0,access.FZ)(user.organization)&&{key:types.xb.Advanced,label:"Advanced",content:(0,jsx_runtime.jsx)(AdvancedTab,{})}]}),(0,jsx_runtime.jsx)(PluginDrawer.e,{})]}):null}},"./frontend/src/scenes/plugins/plugin/PluginLogs.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{b:function(){return PluginLogs}});var antd__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/checkbox/index.js"),kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),lib_components_ResizableTable__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./frontend/src/lib/components/ResizableTable/index.tsx"),lib_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/lib/utils.tsx"),_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/types.ts"),_pluginLogsLogic__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/scenes/plugins/plugin/pluginLogsLogic.ts"),lib_dayjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./frontend/src/lib/dayjs.ts"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");const columns=[{title:"Timestamp",key:"timestamp",dataIndex:"timestamp",span:3,render:timestamp=>(0,lib_dayjs__WEBPACK_IMPORTED_MODULE_5__.Bv)(timestamp).format("YYYY-MM-DD HH:mm:ss.SSS UTC")},{title:"Source",key:"source",dataIndex:"source",span:1},{title:"Type",key:"type",dataIndex:"type",span:1,render:function PluginLogEntryTypeDisplay(type){let color;switch(type){case _types__WEBPACK_IMPORTED_MODULE_3__.oX.Debug:color="var(--muted)";break;case _types__WEBPACK_IMPORTED_MODULE_3__.oX.Log:color="var(--default)";break;case _types__WEBPACK_IMPORTED_MODULE_3__.oX.Info:color="var(--blue)";break;case _types__WEBPACK_IMPORTED_MODULE_3__.oX.Warn:color="var(--warning)";break;case _types__WEBPACK_IMPORTED_MODULE_3__.oX.Error:color="var(--danger)"}return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("span",{style:{color:color},children:type})}},{title:"Message",key:"message",dataIndex:"message",span:6}];function PluginLogs(_ref){let{pluginConfigId:pluginConfigId}=_ref;const logic=(0,_pluginLogsLogic__WEBPACK_IMPORTED_MODULE_4__.D)({pluginConfigId:pluginConfigId}),{pluginLogs:pluginLogs,pluginLogsLoading:pluginLogsLoading,pluginLogsBackground:pluginLogsBackground,isThereMoreToLoad:isThereMoreToLoad,pluginLogsTypes:pluginLogsTypes}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(logic),{revealBackground:revealBackground,loadPluginLogsMore:loadPluginLogsMore,setPluginLogsTypes:setPluginLogsTypes,setSearchTerm:setSearchTerm}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(logic);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)("div",{className:"ph-no-capture space-y-2 flex-1",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_6__.LemonInput,{type:"search",placeholder:"Search for messages containing…",fullWidth:!0,onChange:setSearchTerm,allowClear:!0}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)("div",{className:"flex items-center gap-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("span",{children:"Show logs of type: "}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(antd__WEBPACK_IMPORTED_MODULE_8__.Z.Group,{options:Object.values(_types__WEBPACK_IMPORTED_MODULE_3__.oX),value:pluginLogsTypes,onChange:setPluginLogsTypes,style:{marginLeft:"8px"}})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_6__.LemonButton,{onClick:revealBackground,loading:pluginLogsLoading,type:"secondary",fullWidth:!0,center:!0,disabledReason:pluginLogsBackground.length?void 0:"There's nothing to load",children:pluginLogsBackground.length?`Load ${(0,lib_utils__WEBPACK_IMPORTED_MODULE_2__._6)(pluginLogsBackground.length,"newer entry","newer entries")}`:"No new entries"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(lib_components_ResizableTable__WEBPACK_IMPORTED_MODULE_1__.M,{dataSource:pluginLogs,columns:columns,loading:pluginLogsLoading,size:"small",className:"ph-no-capture",rowKey:"id",style:{flexGrow:1,whiteSpace:"pre-wrap",overflowWrap:"anywhere"},pagination:{pageSize:200,hideOnSinglePage:!0}}),!!pluginLogs.length&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_6__.LemonButton,{onClick:loadPluginLogsMore,loading:pluginLogsLoading,type:"secondary",fullWidth:!0,center:!0,disabledReason:isThereMoreToLoad?void 0:"There's nothing mote to load",children:isThereMoreToLoad?`Load up to ${_pluginLogsLogic__WEBPACK_IMPORTED_MODULE_4__.F} older entries`:"No older entries"})]})}try{PluginLogs.displayName="PluginLogs",PluginLogs.__docgenInfo={description:"",displayName:"PluginLogs",props:{pluginConfigId:{defaultValue:null,description:"",name:"pluginConfigId",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/PluginLogs.tsx#PluginLogs"]={docgenInfo:PluginLogs.__docgenInfo,name:"PluginLogs",path:"frontend/src/scenes/plugins/plugin/PluginLogs.tsx#PluginLogs"})}catch(__react_docgen_typescript_loader_error){}},"./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/scenes/batch_exports/BatchExports.scss":function(module,exports,__webpack_require__){(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".BatchExportRunIcon--pulse{outline:2px solid transparent;outline-offset:0;animation:pulse 2s ease-out infinite}@keyframes pulse{0%{outline-offset:0;outline-color:var(--primary-light)}80%{outline-offset:20px;outline-color:transparent}to{outline-offset:20px;outline-color:transparent}}",""]),module.exports=exports},"./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/scenes/plugins/Plugins.scss":function(module,exports,__webpack_require__){(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".plugins-scene{padding-bottom:60px}.plugins-installed-tab-section-header:hover,.plugins-repository-tab-section-header:hover{cursor:pointer}.plugins-repository-tab-section-header{margin-left:5px}.plugin-capabilities-tag{cursor:default}.plugins-scene-plugin-card>.ant-card-body{padding:15px}.plugins-scene-plugin-card a.plugin-title-link{color:var(--color-text)}.plugins-scene-plugin-card a.plugin-title-link:hover{text-decoration:underline}.plugins-scene-plugin-card .plugin-image{width:60px;height:60px;display:flex;justify-content:center;align-items:center;margin-left:auto;margin-right:auto;border:none;padding:4px}.plugins-scene-plugin-card .order-handle{cursor:move;text-align:center;height:100%;margin-top:-10px;margin-bottom:-10px}.plugins-scene-plugin-card .order-handle .ant-tag{margin-right:0;cursor:move}.plugins-scene-plugin-card .order-handle .arrow{color:#888;height:19px}.plugins-scene-plugin-card .hide-over-500{display:none}@media(max-width:500px){.plugins-scene-plugin-card .show-over-500{display:none}.plugins-scene-plugin-card .hide-over-500{display:inline-block}.plugins-scene-plugin-card button.ant-btn.padding-under-500{padding:4px 8px}.plugins-scene-plugin-card .hide-plugin-image-below-500{display:none}}.plugins-popconfirm{z-index:var(--z-plugins-popconfirm)}.plugin-job-json-editor{border:1px solid #efefef}.plugin-run-job-button{color:var(--success);cursor:pointer}.plugin-run-job-button-disabled{color:#9a9a9a;cursor:default}",""]),module.exports=exports}}]);