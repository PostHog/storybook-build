var f=(S,v,n)=>new Promise((a,b)=>{var r=d=>{try{u(n.next(d))}catch(m){b(m)}},o=d=>{try{u(n.throw(d))}catch(m){b(m)}},u=d=>d.done?a(d.value):Promise.resolve(d.value).then(r,o);u((n=n.apply(S,v)).next())});(window.webpackJsonp=window.webpackJsonp||[]).push([[319],{"./frontend/src/scenes/session-recordings/playlist/SessionRecordingsPlaylistScene.tsx":function(S,v,n){"use strict";n.r(v),n.d(v,"scene",function(){return M}),n.d(v,"SessionRecordingsPlaylistScene",function(){return N});var a=n("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),b=n("./frontend/src/scenes/session-recordings/playlist/SessionRecordingsPlaylist.scss"),r=n("./frontend/@posthog/lemon-ui/src/index.ts"),o=n("./frontend/src/lib/components/LemonSkeleton/index.tsx"),u=n("./frontend/src/lib/components/EditableField/EditableField.tsx"),d=n("./frontend/src/lib/components/PageHeader.tsx"),m=n("./frontend/src/types.ts"),h=n("./frontend/src/scenes/urls.ts"),R=n("./node_modules/.pnpm/fast-deep-equal@3.1.3/node_modules/fast-deep-equal/index.js"),B=n.n(R),x=n("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.0/node_modules/kea-router/lib/index.js"),F=n("./frontend/src/models/cohortsModel.ts"),j=n("./frontend/src/scenes/session-recordings/playlist/playlistUtils.ts"),L=n("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js");const g=Object(a.kea)([Object(a.path)(s=>["scenes","session-recordings","playlist","sessionRecordingsPlaylistLogic",s]),Object(a.props)({}),Object(a.key)(s=>s.shortId),Object(a.connect)({values:[F.a,["cohortsById"]]}),Object(a.actions)({updatePlaylist:function(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{properties:s,silent:e}},setFilters:s=>({filters:s})}),Object(L.loaders)(s=>{let{values:e,props:i}=s;return{playlist:[null,{getPlaylist:()=>f(this,null,function*(){return Object(j.d)(i.shortId)}),updatePlaylist:t=>f(this,null,function*(){var p,c;let{properties:y,silent:O}=t;return(p=e.playlist)!==null&&p!==void 0&&p.short_id?Object(j.f)((c=e.playlist)===null||c===void 0?void 0:c.short_id,y!=null?y:{filters:e.filters||void 0},O):e.playlist}),duplicatePlaylist:()=>f(this,null,function*(){var t;return Object(j.c)((t=e.playlist)!==null&&t!==void 0?t:{},!0)}),deletePlaylist:()=>f(this,null,function*(){return e.playlist?Object(j.b)(e.playlist,()=>{x.router.actions.replace(h.a.sessionRecordings(m.Z.Playlists))}):null})}]}}),Object(a.reducers)(s=>{let{}=s;return{filters:[null,{getPlaylistSuccess:(e,i)=>{let{playlist:t}=i;return(t==null?void 0:t.filters)||null},updatePlaylistSuccess:(e,i)=>{let{playlist:t}=i;return(t==null?void 0:t.filters)||null},setFilters:(e,i)=>{let{filters:t}=i;return t}}]}}),Object(a.listeners)(s=>{let{actions:e,values:i}=s;return{getPlaylistSuccess:()=>{var t;((t=i.playlist)===null||t===void 0?void 0:t.derived_name)!==i.derivedName&&e.updatePlaylist({derived_name:i.derivedName},!0)}}}),Object(x.beforeUnload)(s=>{let{values:e,actions:i}=s;return{enabled:t=>e.hasChanges&&(t==null?void 0:t.pathname)!==x.router.values.location.pathname,message:"Leave playlist? Changes you made will be discarded.",onConfirm:()=>{var t;i.setFilters(((t=e.playlist)===null||t===void 0?void 0:t.filters)||null)}}}),Object(a.selectors)(s=>{let{}=s;return{breadcrumbs:[e=>[e.playlist],e=>[{name:"Recordings",path:h.a.sessionRecordings()},{name:"Playlists",path:h.a.sessionRecordings(m.Z.Playlists)},{name:(e==null?void 0:e.name)||(e==null?void 0:e.derived_name)||"(Untitled)",path:h.a.sessionRecordingPlaylist((e==null?void 0:e.short_id)||"")}]],hasChanges:[e=>[e.playlist,e.filters],(e,i)=>(console.log(e==null?void 0:e.filters,i),!B()(e==null?void 0:e.filters,i))],derivedName:[e=>[e.filters,e.cohortsById],(e,i)=>{var t;return((t=Object(j.e)(e||{},i))===null||t===void 0?void 0:t.slice(0,400))||"(Untitled)"}]}}),Object(a.afterMount)(s=>{let{actions:e}=s;e.getPlaylist()})]);var C=n("./frontend/src/lib/components/NotFound/index.tsx"),I=n("./frontend/src/lib/components/UserActivityIndicator/UserActivityIndicator.tsx"),U=n("./frontend/src/lib/components/LemonButton/More.tsx"),D=n("./frontend/src/scenes/session-recordings/playlist/SessionRecordingsPlaylist.tsx"),l=n("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");const M={component:N,logic:g,paramsToProps:s=>{let{params:{id:e}}=s;return{shortId:e}}};function N(){const{playlist:s,playlistLoading:e,hasChanges:i,derivedName:t}=Object(a.useValues)(g),{setFilters:p,updatePlaylist:c,duplicatePlaylist:y,deletePlaylist:O}=Object(a.useActions)(g);return!s&&e?Object(l.jsxs)("div",{className:"space-y-4 mt-6",children:[Object(l.jsx)(o.a,{className:"h-10 w-1/4"}),Object(l.jsx)(o.a,{className:" w-1/3"}),Object(l.jsx)(o.a,{className:" w-1/4"}),Object(l.jsxs)("div",{className:"flex justify-between mt-4",children:[Object(l.jsx)(o.a.Button,{}),Object(l.jsxs)("div",{className:"flex gap-4",children:[Object(l.jsx)(o.a.Button,{}),Object(l.jsx)(o.a.Button,{})]})]}),Object(l.jsxs)("div",{className:"flex justify-between gap-4 mt-8",children:[Object(l.jsx)("div",{className:"space-y-8 w-1/4",children:Object(l.jsx)(o.a,{className:"h-10",repeat:10})}),Object(l.jsx)("div",{className:"flex-1"})]})]}):s?Object(l.jsxs)("div",{children:[Object(l.jsx)(d.a,{title:Object(l.jsx)(u.a,{name:"name",value:s.name||"",placeholder:t,onSave:P=>c({short_id:s.short_id,name:P}),saveOnBlur:!0,maxLength:400,mode:void 0,"data-attr":"playlist-name"}),buttons:Object(l.jsxs)("div",{className:"flex justify-between items-center gap-2",children:[Object(l.jsx)(U.a,{overlay:Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(r.LemonButton,{status:"stealth",onClick:()=>y(),fullWidth:!0,"data-attr":"duplicate-playlist",children:"Duplicate"}),Object(l.jsx)(r.LemonButton,{status:"stealth",onClick:()=>c({short_id:s.short_id,pinned:!s.pinned}),fullWidth:!0,children:s.pinned?"Unpin playlist":"Pin playlist"}),Object(l.jsx)(r.LemonDivider,{}),Object(l.jsx)(r.LemonButton,{status:"danger",onClick:()=>O(),fullWidth:!0,children:"Delete playlist"})]})}),Object(l.jsx)(r.LemonDivider,{vertical:!0}),Object(l.jsx)(r.LemonButton,{type:"primary",disabled:!i,loading:i&&e,onClick:()=>{c()},children:"Save changes"})]}),caption:Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(u.a,{multiline:!0,name:"description",value:s.description||"",placeholder:"Description (optional)",onSave:P=>c({description:P}),saveOnBlur:!0,maxLength:400,"data-attr":"playlist-description",compactButtons:!0}),Object(l.jsx)(I.a,{at:s.last_modified_at,by:s.last_modified_by,className:"mt-2"})]})}),s.short_id?Object(l.jsx)(D.a,{playlistShortId:s.short_id,filters:s.filters,onFiltersChange:p}):null]}):Object(l.jsx)(C.a,{object:"Recording Playlist"})}}}]);
