(window.webpackJsonp=window.webpackJsonp||[]).push([[7,10],{"./frontend/src/scenes/apps/ErrorDetailsDrawer.tsx":function(Y,P,e){"use strict";e.r(P),e.d(P,"ErrorDetailsDrawer",function(){return G});var y=e("./node_modules/core-js/modules/es.object.keys.js"),J=e.n(y),U=e("./node_modules/core-js/modules/es.symbol.js"),b=e.n(U),R=e("./node_modules/core-js/modules/es.array.filter.js"),D=e.n(R),B=e("./node_modules/core-js/modules/es.object.to-string.js"),Z=e.n(B),K=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),k=e.n(K),W=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),q=e.n(W),h=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),ee=e.n(h),x=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),N=e.n(x),S=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),V=e.n(S),T=e("./node_modules/kea/lib/index.esm.js"),L=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),F=e("./frontend/src/lib/components/Drawer.tsx"),z=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),$=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),H=e("./frontend/src/lib/components/PaginationControl/index.tsx"),m=e("./node_modules/antd/es/tabs/index.js"),p=e("./frontend/src/lib/components/LemonLabel/LemonLabel.tsx"),C=e("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),o=e("./node_modules/react/jsx-runtime.js"),A=e.n(o);function f(n,d){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);d&&(u=u.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),i.push.apply(i,u)}return i}function M(n){for(var d=1;d<arguments.length;d++){var i=arguments[d]!=null?arguments[d]:{};d%2?f(Object(i),!0).forEach(function(u){N()(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):f(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function G(){var n=Object(T.useValues)(L.appMetricsSceneLogic),d=n.errorDetailsDrawerError,i=n.errorDetailsLoading,u=Object(T.useActions)(L.appMetricsSceneLogic),c=u.closeErrorDetailsDrawer;return Object(o.jsx)(F.a,{visible:!!d,onClose:c,title:"Viewing error details: ".concat(d),width:"min(50vw, 80rem)",destroyOnClose:!0,children:i?Object(o.jsx)(z.a,{className:"h-10"}):Object(o.jsx)(I,{})})}function I(){var n=Object(T.useValues)(L.appMetricsSceneLogic),d=n.errorDetails,i=Object(H.c)(d,{pageSize:1}),u=V()(i.dataSourcePage,1),c=u[0];return Object(o.jsxs)("div",{children:[Object(o.jsx)(H.a,M(M({},i),{},{nouns:["sample error","sample errors"]})),Object(o.jsxs)(m.a,{children:[Object(o.jsxs)(m.a.TabPane,{tab:"Overview",children:[Object(o.jsxs)("div",{children:[Object(o.jsx)(p.a,{children:"Error:"})," ",c.error_type]}),c.error_details.error.message&&Object(o.jsxs)("div",{children:[Object(o.jsx)(p.a,{children:"Error message:"})," ",c.error_details.error.message]}),Object(o.jsxs)("div",{children:[Object(o.jsx)(p.a,{children:"When:"})," ",Object(o.jsx)($.b,{time:c.timestamp,showSeconds:!0})]}),c.error_details.eventCount&&Object(o.jsxs)("div",{children:[Object(o.jsx)(p.a,{children:"Event count:"})," ",c.error_details.eventCount]})]},"overview"),c.error_details.event&&Object(o.jsx)(m.a.TabPane,{tab:"Event",children:Object(o.jsx)(C.a,{language:C.b.JSON,children:JSON.stringify(c.error_details.event,null,2)})},"event"),c.error_details.error.stack&&Object(o.jsx)(m.a.TabPane,{tab:"Stack trace",children:Object(o.jsx)(C.a,{wrap:!0,language:C.b.JavaScript,children:c.error_details.error.stack})},"stacktrace")]})]})}},"./frontend/src/scenes/apps/appMetricsSceneLogic.ts":function(Y,P,e){"use strict";e.r(P),e.d(P,"AppMetricsTab",function(){return n}),e.d(P,"appMetricsSceneLogic",function(){return u});var y=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),J=e.n(y),U=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),b=e.n(U),R=e("./node_modules/@babel/runtime/regenerator/index.js"),D=e.n(R),B=e("./node_modules/core-js/modules/es.array.iterator.js"),Z=e.n(B),K=e("./node_modules/core-js/modules/es.object.to-string.js"),k=e.n(K),W=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),q=e.n(W),h=e("./node_modules/core-js/modules/es.array.concat.js"),ee=e.n(h),x=e("./node_modules/core-js/modules/es.function.name.js"),N=e.n(x),S=e("./node_modules/core-js/modules/es.array.includes.js"),V=e.n(S),T=e("./node_modules/core-js/modules/es.string.includes.js"),L=e.n(T),F=e("./node_modules/core-js/modules/es.array.filter.js"),z=e.n(F),$=e("./node_modules/core-js/modules/es.number.constructor.js"),H=e.n($),m=e("./node_modules/kea/lib/index.esm.js"),p=e("./node_modules/kea-loaders/lib/index.js"),C=e.n(p),o=e("./frontend/src/scenes/urls.ts"),A=e("./frontend/src/lib/api.ts"),f=e("./frontend/src/scenes/teamLogic.tsx"),M=e("./node_modules/kea-router/lib/index.js"),G=e.n(M),I=e("./frontend/src/lib/utils.tsx"),n;(function(s){s.ProcessEvent="processEvent",s.OnEvent="onEvent",s.ExportEvents="exportEvents",s.HistoricalExports="historical_exports"})(n||(n={}));var d="-30d",i=[n.ProcessEvent,n.OnEvent,n.ExportEvents],u=Object(m.kea)([Object(m.path)(function(s){return["scenes","apps","appMetricsSceneLogic",s]}),Object(m.props)({}),Object(m.key)(function(s){return s.pluginConfigId}),Object(m.actions)({setActiveTab:function(a){return{tab:a}},setDateFrom:function(a){return{dateFrom:a}},openErrorDetailsDrawer:function(a,r,t){return{errorType:a,category:r,jobId:t}},closeErrorDetailsDrawer:!0}),Object(m.reducers)({activeTab:[null,{setActiveTab:function(a,r){var t=r.tab;return t}}],dateFrom:[d,{setDateFrom:function(a,r){var t=r.dateFrom;return t}}],errorDetailsDrawerError:[null,{openErrorDetailsDrawer:function(a,r){var t=r.errorType;return t},closeErrorDetailsDrawer:function(){return null}}]}),Object(p.loaders)(function(s){var a=s.values,r=s.props;return{pluginConfig:[null,{loadPluginConfig:function(){var t=b()(D.a.mark(function E(){return D.a.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,A.b.get("api/projects/".concat(f.a.values.currentTeamId,"/plugin_configs/").concat(r.pluginConfigId));case 2:return j.abrupt("return",j.sent);case 3:case"end":return j.stop()}},E)}));function _(){return t.apply(this,arguments)}return _}()}],appMetricsResponse:[null,{loadMetrics:function(){var t=b()(D.a.mark(function E(){var l;return D.a.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return l=Object(I.Eb)({category:a.activeTab,date_from:a.dateFrom}),O.next=3,A.b.get("api/projects/".concat(f.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"?").concat(l));case 3:return O.abrupt("return",O.sent);case 4:case"end":return O.stop()}},E)}));function _(){return t.apply(this,arguments)}return _}()}],historicalExports:[[],{loadHistoricalExports:function(){var t=b()(D.a.mark(function E(){var l,j;return D.a.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,A.b.get("api/projects/".concat(f.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"/historical_exports"));case 2:return l=v.sent,j=l.results,v.abrupt("return",j);case 5:case"end":return v.stop()}},E)}));function _(){return t.apply(this,arguments)}return _}()}],errorDetails:[[],{openErrorDetailsDrawer:function(){var t=b()(D.a.mark(function E(l){var j,O,v,w,Q,X;return D.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return j=l.category,O=l.jobId,v=l.errorType,w=Object(I.Eb)({category:j,job_id:O,error_type:v}),g.next=4,A.b.get("api/projects/".concat(f.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"/error_details?").concat(w));case 4:return Q=g.sent,X=Q.result,g.abrupt("return",X);case 7:case"end":return g.stop()}},E)}));function _(E){return t.apply(this,arguments)}return _}()}]}}),Object(m.selectors)(function(s){var a=s.values;return{breadcrumbs:[function(r){return[r.pluginConfig,function(t,_){return _.pluginConfigId}]},function(r,t){var _;return[{name:"Apps",path:o.a.projectApps()},{name:r==null||(_=r.plugin_info)===null||_===void 0?void 0:_.name,path:o.a.appMetrics(t)}]}],showTab:[function(){return[]},function(){return function(r){var t;if(a.pluginConfigLoading||!a.pluginConfig)return!1;var _=((t=a.pluginConfig.plugin_info.capabilities)===null||t===void 0?void 0:t.methods)||[];return r===n.HistoricalExports?_.includes("exportEvents"):r===n.OnEvent&&_.includes("exportEvents")?!1:_.includes(r)}}]}}),Object(m.listeners)(function(s){var a=s.values,r=s.actions;return{loadPluginConfigSuccess:function(){if(!a.activeTab){var _=i.filter(function(j){return a.showTab(j)}),E=J()(_,1),l=E[0];r.setActiveTab(l)}},setActiveTab:function(_){var E=_.tab;E===n.HistoricalExports?r.loadHistoricalExports():r.loadMetrics()},setDateFrom:function(){r.loadMetrics()}}}),Object(M.actionToUrl)(function(s){var a=s.values,r=s.props;return{setActiveTab:function(){return c(a,r)},setDateFrom:function(){return c(a,r)}}}),Object(M.urlToAction)(function(s){var a=s.values,r=s.actions,t=s.props;return{"/app/:pluginConfigId/:page":function(E,l){t.pluginConfigId===Number(E.pluginConfigId)&&(a.pluginConfig||r.loadPluginConfig(),E.page===n.HistoricalExports?r.setActiveTab(n.HistoricalExports):(l.tab&&i.includes(l.tab)&&r.setActiveTab(l.tab),l.from&&r.setDateFrom(l.from)))}}})]);function c(s,a){if(s.activeTab===n.HistoricalExports)return o.a.appHistoricalExports(a.pluginConfigId);var r={};return s.activeTab&&(r.tab=s.activeTab),s.dateFrom!==d&&(r.from=s.dateFrom),o.a.appMetrics(a.pluginConfigId,r)}}}]);
