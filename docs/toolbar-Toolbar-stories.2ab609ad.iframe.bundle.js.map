{"version":3,"file":"toolbar-Toolbar-stories.2ab609ad.iframe.bundle.js","mappings":";AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAmDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAkCA;AACA;AACA","sources":["webpack://@posthog/storybook/../../frontend/src/toolbar/bar/piiMaskingStyles.ts"],"sourcesContent":["import { PostHog } from 'posthog-js'\n\nconst SHIMMER_EFFECT_CSS = `\n    @keyframes shimmer {\n        0% {\n            background-position: -200% 0;\n        }\n        100% {\n            background-position: 200% 0;\n        }\n    }\n`\n\ninterface Color {\n    r: number\n    g: number\n    b: number\n}\n\nconst lighten = (color: Color, amount: number): Color => {\n    const newR = Math.min(255, color.r + amount)\n    const newG = Math.min(255, color.g + amount)\n    const newB = Math.min(255, color.b + amount)\n    return { r: newR, g: newG, b: newB }\n}\n\nconst darken = (color: Color, amount: number): Color => {\n    const newR = Math.max(0, color.r - amount)\n    const newG = Math.max(0, color.g - amount)\n    const newB = Math.max(0, color.b - amount)\n    return { r: newR, g: newG, b: newB }\n}\n\nconst parseColorFromHex = (hex: string): Color => {\n    const r = parseInt(hex.substring(0, 2), 16)\n    const g = parseInt(hex.substring(2, 4), 16)\n    const b = parseInt(hex.substring(4, 6), 16)\n    return { r, g, b }\n}\n\nconst colorToHex = (color: Color): string => {\n    return `#${color.r.toString(16).padStart(2, '0')}${color.g.toString(16).padStart(2, '0')}${color.b.toString(16).padStart(2, '0')}`\n}\n\nconst getColorPalette = (color: string): [Color, Color, Color, Color, Color] => {\n    const hex = color.replace('#', '')\n    const baseColor = parseColorFromHex(hex)\n\n    const color1 = darken(baseColor, 30)\n    const color2 = darken(baseColor, 15)\n    const color3 = baseColor\n    const color4 = lighten(baseColor, 15)\n    const color5 = darken(baseColor, 15)\n\n    return [color1, color2, color3, color4, color5]\n}\n\nconst generatePiiMaskingCSSForSelector = (\n    selector: string,\n    colors: [string, string, string, string, string]\n): string => {\n    return `\n        ${selector} {\n            position: relative !important;\n        }\n        ${selector}::before {\n            content: '';\n            position: absolute;\n            inset: 0;\n            background: linear-gradient(\n                90deg,\n                ${colors[0]} 0%,\n                ${colors[1]} 20%,\n                ${colors[2]} 40%,\n                ${colors[3]} 60%,\n                ${colors[4]} 80%,\n                ${colors[0]} 100%\n            );\n            background-size: 200% 100%;\n            animation: shimmer 6s ease-in-out infinite;\n            z-index: 999999;\n            pointer-events: none;\n        }\n        ${selector} img,\n        ${selector} video {\n            opacity: 0 !important;\n        }\n        ${selector} * {\n            color: transparent !important;\n            text-shadow: none !important;\n        }\n    `\n}\n\nexport const generatePiiMaskingCSS = (baseColor: string, posthog: PostHog | null): string => {\n    const [color1, color2, color3, color4, color5] = getColorPalette(baseColor).map(colorToHex)\n\n    // There's some checks that can be a regexp or even done via JS which means we can't do it CSS based\n    // We're ok with that for now, but we should consider reworking this in the future\n    // to make use of ResizeObserver to detect changes in the DOM and update the CSS accordingly\n    const selectors = new Set<string>(['.ph-no-capture', '.ph-sensitive'])\n    if (posthog) {\n        selectors.add(\n            typeof posthog.config.session_recording?.blockClass === 'string'\n                ? `.${posthog.config.session_recording?.blockClass}`\n                : '.ph-no-capture'\n        )\n        selectors.add(\n            typeof posthog.config.session_recording?.maskTextClass === 'string'\n                ? `.${posthog.config.session_recording?.maskTextClass}`\n                : '.ph-mask'\n        )\n        if (typeof posthog.config.session_recording?.maskTextSelector === 'string') {\n            selectors.add(posthog.config.session_recording?.maskTextSelector)\n        }\n        if (posthog.config.session_recording?.maskAllInputs === true) {\n            selectors.add('input, textarea')\n        }\n    }\n\n    const selectorsCss = Array.from(selectors)\n        .map((selector) => generatePiiMaskingCSSForSelector(selector, [color1, color2, color3, color4, color5]))\n        .join('\\n')\n\n    return `\n        ${SHIMMER_EFFECT_CSS}\n        ${selectorsCss}\n    `\n}\n\nexport const PII_MASKING_PRESET_COLORS = [\n    { label: 'Grey', value: '#888888' },\n    { label: 'Red', value: '#aa7777' },\n    { label: 'Blue', value: '#7788aa' },\n    { label: 'Green', value: '#88aa88' },\n    { label: 'Purple', value: '#9988aa' },\n    { label: 'Orange', value: '#aa9988' },\n] as const\n"],"names":[],"sourceRoot":""}