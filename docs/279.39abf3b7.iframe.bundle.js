var K=(y,c,e)=>new Promise((t,j)=>{var u=r=>{try{l(e.next(r))}catch(m){j(m)}},p=r=>{try{l(e.throw(r))}catch(m){j(m)}},l=r=>r.done?t(r.value):Promise.resolve(r.value).then(u,p);l((e=e.apply(y,c)).next())});(window.webpackJsonp=window.webpackJsonp||[]).push([[279],{"./frontend/src/scenes/groups/groupsListLogic.ts":function(y,c,e){"use strict";e.d(c,"a",function(){return i});var t=e("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),j=e("./frontend/src/lib/api.ts"),u=e("./frontend/src/lib/introductions/groupsAccessLogic.ts"),p=e("./frontend/src/lib/utils.tsx"),l=e("./frontend/src/scenes/teamLogic.tsx"),r=e("./frontend/src/scenes/urls.ts"),m=e("./frontend/src/models/groupsModel.ts");const i=Object(t.kea)({path:["groups","groupsListLogic"],connect:{values:[l.a,["currentTeamId"],m.a,["groupTypes","aggregationLabel"],u.b,["groupsEnabled"]]},actions:()=>({loadGroups:n=>({url:n}),setTab:n=>({tab:n})}),loaders:n=>{let{values:o}=n;return{groups:[{next:null,previous:null,results:[]},{loadGroups:d=>K(this,null,function*(){let{url:a}=d;if(o.groupsEnabled)return a=a||`api/projects/${o.currentTeamId}/groups/?group_type_index=${o.currentTab}`,yield j.b.get(a)})}]}},reducers:{currentTab:["-1",{setTab:(n,o)=>{let{tab:d}=o;return d}}]},selectors:{currentTabName:[n=>[n.currentTab,n.groupTypes,n.aggregationLabel],(n,o,d)=>n==="-1"?"Persons":o!=null&&o.length?Object(p.i)(d(parseInt(n)).singular):""],groupName:[n=>[n.currentTab,n.aggregationLabel],(n,o)=>n==="-1"?{singular:"person",plural:"persons"}:o(parseInt(n))],breadcrumbs:[n=>[n.currentTabName,n.currentTab],(n,o)=>[{name:n,path:r.a.groups(o)}]]},actionToUrl:()=>({setTab:n=>{let{tab:o}=n;return o!=="-1"?r.a.groups(o):r.a.persons()}}),urlToAction:n=>{let{actions:o,values:d}=n;return{"/groups/:id":a=>{let{id:s}=a;s&&(o.setTab(s),o.loadGroups())},"/persons":()=>{d.currentTab!=="-1"&&o.setTab("-1")}}}})},"./frontend/src/scenes/persons/PersonPageHeader.tsx":function(y,c,e){"use strict";e.d(c,"a",function(){return o});var t=e("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),j=e("./frontend/src/lib/components/PageHeader.tsx"),u=e("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/tabs/index.js"),p=e("./frontend/src/lib/introductions/groupsAccessLogic.ts"),l=e("./frontend/src/lib/utils.tsx"),r=e("./frontend/src/models/groupsModel.ts"),m=e("./frontend/src/scenes/groups/groupsListLogic.ts"),i=e("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function n(){const{setTab:d}=Object(t.useActions)(m.a),{currentTab:a}=Object(t.useValues)(m.a),{groupTypes:s,aggregationLabel:b}=Object(t.useValues)(r.a),{groupsAccessStatus:A}=Object(t.useValues)(p.b),g=[p.a.HasAccess,p.a.HasGroupTypes,p.a.NoAccess].includes(A);return Object(i.jsxs)(u.a,{activeKey:a,onChange:h=>d(h),children:[Object(i.jsx)(u.a.TabPane,{tab:"Persons"},"-1"),g?Object(i.jsx)(u.a.TabPane,{tab:"Groups"},"0"):s.map(h=>Object(i.jsx)(u.a.TabPane,{tab:Object(l.i)(b(h.group_type_index).plural)},h.group_type_index))]})}function o(d){let{hideGroupTabs:a}=d;const{showGroupsOptions:s}=Object(t.useValues)(r.a);return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(j.a,{title:`Persons${s?" & Groups":""}`,caption:`A catalog of your product's end users${s?" and groups":""}.`}),!a&&s&&Object(i.jsx)(n,{})]})}try{o.displayName="PersonPageHeader",o.__docgenInfo={description:"",displayName:"PersonPageHeader",props:{hideGroupTabs:{defaultValue:null,description:"",name:"hideGroupTabs",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"]={docgenInfo:o.__docgenInfo,name:"PersonPageHeader",path:"frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"})}catch(d){}},"./frontend/src/scenes/persons/Persons.scss":function(y,c,e){"use strict";var t=e("./node_modules/.pnpm/style-loader@2.0.0_webpack@4.46.0/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),j=e.n(t),u=e("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/persons/Persons.scss"),p=e.n(u),l={};l.insert="head",l.singleton=!1;var r=j()(p.a,l),m=p.a.locals||{}},"./frontend/src/scenes/persons/Persons.tsx":function(y,c,e){"use strict";e.d(c,"a",function(){return I});var t=e("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),j=e("./frontend/src/lib/components/TZLabel/index.tsx"),u=e("./frontend/src/lib/components/PropertiesTable/index.ts"),p=e("./frontend/src/scenes/persons/Persons.scss"),l=e("./frontend/src/lib/components/CopyToClipboard.tsx"),r=e("./frontend/src/scenes/persons/PersonHeader.tsx"),m=e("./frontend/src/lib/components/LemonTable/index.ts"),i=e("./frontend/@posthog/lemon-ui/src/index.ts"),n=e("./frontend/src/lib/components/icons.tsx"),o=e("./frontend/src/scenes/persons/PersonDeleteModal.tsx"),d=e("./frontend/src/scenes/persons/personDeleteModalLogic.tsx"),a=e("./frontend/src/scenes/persons/personsLogic.tsx"),s=e("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function b(f){let{people:C,loading:v=!1,hasPrevious:P,hasNext:D,loadPrevious:E,loadNext:R,compact:V}=f;const{showPersonDeleteModal:H}=Object(t.useActions)(d.a),{loadPersons:U}=Object(t.useActions)(a.a),G=[{title:"Person",key:"person",render:function(S,_){return Object(s.jsx)(r.a,{withIcon:!0,person:_})}},{title:"ID",key:"id",render:function(S,_){return Object(s.jsx)("div",{className:"overflow-hidden",children:_.distinct_ids.length&&Object(s.jsx)(l.a,{explicitValue:_.distinct_ids[0],iconStyle:{color:"var(--primary)"},description:"person distinct ID",children:_.distinct_ids[0]})})}},...V?[]:[{title:"First seen",dataIndex:"created_at",render:function(S){return S?Object(s.jsx)(j.a,{time:S}):Object(s.jsx)(s.Fragment,{})}},{render:function(S,_){return Object(s.jsx)(i.LemonButton,{onClick:()=>H(_,()=>U()),icon:Object(s.jsx)(n.IconDelete,{}),status:"danger",size:"small"})}}]];return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(m.a,{"data-attr":"persons-table",columns:G,loading:v,rowKey:"id",pagination:{controlled:!0,pageSize:100,onForward:D?()=>{R==null||R(),window.scrollTo(0,0)}:void 0,onBackward:P?()=>{E==null||E(),window.scrollTo(0,0)}:void 0},expandable:{expandedRowRender:function(S){let{properties:_}=S;return Object.keys(_).length?Object(s.jsx)(u.a,{properties:_}):"This person has no properties."}},dataSource:C,emptyState:"No persons",nouns:["person","persons"]}),Object(s.jsx)(o.a,{})]})}try{b.displayName="PersonsTable",b.__docgenInfo={description:"",displayName:"PersonsTable",props:{people:{defaultValue:null,description:"",name:"people",required:!0,type:{name:"PersonType[]"}},loading:{defaultValue:{value:"false"},description:"",name:"loading",required:!1,type:{name:"boolean"}},hasPrevious:{defaultValue:null,description:"",name:"hasPrevious",required:!1,type:{name:"boolean"}},hasNext:{defaultValue:null,description:"",name:"hasNext",required:!1,type:{name:"boolean"}},loadPrevious:{defaultValue:null,description:"",name:"loadPrevious",required:!1,type:{name:"(() => void)"}},loadNext:{defaultValue:null,description:"",name:"loadNext",required:!1,type:{name:"(() => void)"}},compact:{defaultValue:null,description:"",name:"compact",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"]={docgenInfo:b.__docgenInfo,name:"PersonsTable",path:"frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"})}catch(f){}var A=e("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/popconfirm/index.js"),g=e("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),h=e("./frontend/src/lib/components/Tooltip.tsx"),M=e("./node_modules/.pnpm/use-debounce@6.0.1_react@16.14.0/node_modules/use-debounce/esm/useDebouncedCallback.js");const O=()=>{const{loadPersons:f,setListFilters:C}=Object(t.useActions)(a.a),{listFilters:v}=Object(t.useValues)(a.a),[P,D]=Object(g.useState)(""),E=Object(M.a)(f,800);return Object(g.useEffect)(()=>{D(v.search||"")},[]),Object(g.useEffect)(()=>{C({search:P||void 0}),E()},[P]),Object(s.jsxs)("div",{className:"flex items-center gap-2",children:[Object(s.jsx)(i.LemonInput,{type:"search",placeholder:"Search for persons",onChange:D,value:P,"data-attr":"persons-search"}),Object(s.jsx)(h.a,{title:Object(s.jsx)(s.Fragment,{children:'Search by email or Distinct ID. Email will match partially, for example: "@gmail.com". Distinct ID needs to match exactly.'}),children:Object(s.jsx)(n.IconInfo,{className:"text-2xl text-muted-alt shrink-0"})})]})};var x=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),T=e("./frontend/src/lib/components/TaxonomicFilter/types.ts"),N=e("./frontend/src/lib/components/LemonButton/index.ts"),F=e("./frontend/src/lib/components/ExportButton/exporter.tsx");function I(){let{cohort:f}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object(s.jsx)(t.BindLogic,{logic:a.a,props:{cohort:f,syncWithUrl:!f},children:Object(s.jsx)(L,{})})}function L(){const{loadPersons:f,setListFilters:C}=Object(t.useActions)(a.a),{persons:v,listFilters:P,personsLoading:D,exporterProps:E,apiDocsURL:R}=Object(t.useValues)(a.a);return Object(s.jsx)("div",{className:"persons-list",children:Object(s.jsxs)("div",{className:"space-y-2",children:[Object(s.jsxs)("div",{className:"flex justify-between items-center gap-2",children:[Object(s.jsx)(O,{}),Object(s.jsx)(A.a,{placement:"topRight",title:Object(s.jsxs)(s.Fragment,{children:["Exporting by CSV is limited to 10,000 users.",Object(s.jsx)("br",{}),"To export more, please use ",Object(s.jsx)("a",{href:R,children:"the API"}),". Do you want to export by CSV?"]}),onConfirm:()=>Object(F.a)(E[0]),children:Object(s.jsx)(N.a,{type:"secondary",icon:Object(s.jsx)(n.IconExport,{style:{color:"var(--primary)"}}),children:P.properties&&P.properties.length>0?Object(s.jsxs)("div",{style:{display:"block"},children:["Export (",Object(s.jsx)("strong",{children:P.properties.length})," filter)"]}):"Export"})})]}),Object(s.jsx)(x.a,{pageKey:"persons-list-page",propertyFilters:P.properties,onChange:V=>{C({properties:V}),f()},endpoint:"person",taxonomicGroupTypes:[T.a.PersonProperties],showConditionBadge:!0}),Object(s.jsx)(b,{people:v.results,loading:D,hasPrevious:!!v.previous,hasNext:!!v.next,loadPrevious:()=>f(v.previous),loadNext:()=>f(v.next)})]})})}try{I.displayName="Persons",I.__docgenInfo={description:"",displayName:"Persons",props:{cohort:{defaultValue:null,description:"",name:"cohort",required:!1,type:{name:'number | "new"'}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/Persons.tsx#Persons"]={docgenInfo:I.__docgenInfo,name:"Persons",path:"frontend/src/scenes/persons/Persons.tsx#Persons"})}catch(f){}},"./frontend/src/scenes/persons/PersonsScene.tsx":function(y,c,e){"use strict";e.r(c),e.d(c,"scene",function(){return h}),e.d(c,"PersonsScene",function(){return M});var t=e("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),j=e("./frontend/src/lib/logic/featureFlagLogic.ts"),u=e("./frontend/src/lib/constants.tsx"),p=e("./frontend/src/queries/Query/Query.tsx"),l=e("./frontend/src/scenes/persons/Persons.tsx"),r=e("./frontend/src/scenes/persons/PersonPageHeader.tsx"),m=e("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.0/node_modules/kea-router/lib/index.js"),i=e("./node_modules/.pnpm/fast-deep-equal@3.1.3/node_modules/fast-deep-equal/index.js"),n=e.n(i),o=e("./frontend/src/queries/schema.ts"),d=e("./frontend/src/scenes/urls.ts"),a=e("./frontend/src/lib/utils.tsx"),s=e("./frontend/src/lib/components/lemonToast.tsx");const b=()=>({kind:o.a.DataTableNode,source:{kind:o.a.PersonsNode},full:!0,columns:void 0,propertiesViaUrl:!0}),A=Object(t.kea)([Object(t.path)(["scenes","persons","personsSceneLogic"]),Object(t.actions)({setQuery:O=>({query:O})}),Object(t.reducers)({query:[b(),{setQuery:(O,x)=>{let{query:T}=x;return T}}]}),Object(m.actionToUrl)(O=>{let{values:x}=O;return{setQuery:()=>[d.a.persons(),{},Object(a.qb)(x.query,b())?{}:{q:x.query},{replace:!0}]}}),Object(m.urlToAction)(O=>{let{actions:x,values:T}=O;return{[d.a.persons()]:(N,F,I)=>{let{q:L}=I;n()(L,T.query)||(L?typeof L=="object"?x.setQuery(L):(s.d.error("Invalid query in URL"),console.error({queryParam:L})):Object(a.qb)(T.query,b())||x.setQuery(b()))}}})]);var g=e("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");const h={component:M};function M(){const{featureFlags:O}=Object(t.useValues)(j.a),x=O[u.i.DATA_EXPLORATION_LIVE_EVENTS],{query:T}=Object(t.useValues)(A),{setQuery:N}=Object(t.useActions)(A);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(r.a,{}),x?Object(g.jsx)(p.a,{query:T,setQuery:N}):Object(g.jsx)(l.a,{})]})}},"./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/persons/Persons.scss":function(y,c,e){var t=e("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/runtime/api.js");c=t(!1),c.push([y.i,".extra-ids{display:inline-flex;align-items:center;height:1.25rem;line-height:1.125rem;margin:0 0 0 .25rem;padding:0 .25rem 0 .375rem;color:var(--primary);cursor:pointer}.extra-ids svg{margin-left:.25rem}",""]),y.exports=c}}]);
