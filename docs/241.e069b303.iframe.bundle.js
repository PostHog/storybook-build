(window.webpackJsonp=window.webpackJsonp||[]).push([[241],{"./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx":function(O,d,e){"use strict";e.d(d,"a",function(){return m});var v=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),N=e.n(v),re=e("./node_modules/core-js/modules/es.regexp.exec.js"),ne=e("./node_modules/core-js/modules/es.string.match.js"),U=e("./node_modules/react/index.js"),n=e.n(U),F=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),J=e.n(F),H=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.scss"),C=e.n(H),g={};g.insert="head",g.singleton=!1;var $=J()(C.a,g),ae=C.a.locals||{},D=e("./node_modules/clsx/dist/clsx.m.js"),b=e("./node_modules/kea/lib/index.esm.js"),y=e("./frontend/src/lib/components/LemonTable/index.ts"),A=e("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),f=e("./node_modules/@ant-design/icons/es/icons/CheckCircleFilled.js"),p=e("./frontend/src/lib/components/LemonButton/index.ts"),G=e("./node_modules/antd/es/input/index.js"),V=e("./node_modules/antd/es/button/index.js"),R=e("./frontend/src/scenes/toolbar-launch/authorizedUrlsLogic.ts"),K=e("./frontend/src/lib/utils.tsx"),P=e("./frontend/src/lib/components/LemonButton/More.tsx");function m(B){var W=B.pageKey,me=B.actionId,Q=Object(R.c)({actionId:me}),I=Object(b.useValues)(Q),oe=I.appUrlsKeyed,Ee=I.suggestionsLoading,X=I.searchTerm,fe=I.launchUrl,Y=I.appUrls,je=I.editUrlIndex,T=Object(b.useActions)(Q),he=T.addUrl,Z=T.removeUrl,ve=T.setSearchTerm,le=T.updateUrl,ge=T.newUrl,de=T.setEditUrlIndex,pe=[{title:"URLs",dataIndex:"url",key:"url",render:function(S,o){var k=Object(U.useState)(o.url),L=N()(k,2),j=L[0],q=L[1],Oe=Object(U.useState)(""),ee=N()(Oe,2),te=ee[0],z=ee[1];Object(U.useEffect)(function(){return q(o.url)},[o]);var x=function(){if(z(""),j===R.a&&Z(o.originalIndex),j.indexOf("*")>-1&&!j.match(/^(.*)\*[^\*]*\.[^\*]+\.[^\*]+$/)){z("You can only wildcard subdomains. If you wildcard the domain or TLD, people might be able to gain access to your PostHog data.");return}if(!Object(K.db)(j)){z("Please type a valid URL or domain.");return}if(Y.indexOf(j)>-1&&Y.indexOf(j,o.originalIndex)!==o.originalIndex&&Y.indexOf(j,o.originalIndex+1)!==o.originalIndex){z("This URL is already registered.");return}le(o.originalIndex,j)};return o.type==="suggestion"||S!==R.a&&je!==o.originalIndex?n.a.createElement("div",{className:Object(D.a)("authorized-url-col",o.type)},o.type==="authorized"&&n.a.createElement(f.a,{style:{marginRight:4}}),S,o.type==="suggestion"&&n.a.createElement(A.a,null,"Suggestion")):n.a.createElement("div",null,n.a.createElement("div",{style:{display:"flex"}},n.a.createElement(G.a,{value:j,onChange:function(ce){return q(ce.target.value)},onPressEnter:x,autoFocus:!0,placeholder:"Enter a URL or wildcard subdomain (e.g. https://*.posthog.com)"}),n.a.createElement(V.a,{type:"primary",onClick:x},"Save")),te&&n.a.createElement("span",{className:"text-small text-danger"},te))}},{title:"",key:"actions",render:function(S,o,k){return n.a.createElement("div",{className:"actions-col"},o.type==="suggestion"?n.a.createElement(p.a,{type:"secondary",onClick:function(){return he(o.url)}},"Apply suggestion"):n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{type:"highlighted",href:fe(o.url),className:"mr"},"Open with Toolbar"),n.a.createElement(P.a,{overlay:n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{fullWidth:!0,type:"stealth",onClick:function(){return de(o.originalIndex)}},"Edit authorized URL"),n.a.createElement(p.a,{fullWidth:!0,style:{color:"var(--danger)"},type:"stealth",onClick:function(){return Z(k)}},"Remove authorized URL"))})))}}];return n.a.createElement("div",null,n.a.createElement("div",{className:"flex-center mb"},n.a.createElement("div",{style:{flexGrow:1}},n.a.createElement(G.a.Search,{allowClear:!0,enterButton:!0,placeholder:"Search for authorized URLs",style:{maxWidth:480},value:X,onChange:function(S){ve(S.target.value)},autoFocus:W==="toolbar-launch"&&!Object(K.W)()})),n.a.createElement(p.a,{type:"primary",onClick:ge},"Add",W==="toolbar-launch"&&" authorized domain")),n.a.createElement(y.a,{className:"authorized-urls-table",columns:pe,dataSource:oe,emptyState:X?"There are no authorized URLs that match your search.":"There are no authorized URLs or domains. Add one to get started.",loading:Ee}))}try{m.displayName="AuthorizedUrlsTable",m.__docgenInfo={description:"",displayName:"AuthorizedUrlsTable",props:{pageKey:{defaultValue:null,description:"",name:"pageKey",required:!1,type:{name:"string"}},actionId:{defaultValue:null,description:"",name:"actionId",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx#AuthorizedUrlsTable"]={docgenInfo:m.__docgenInfo,name:"AuthorizedUrlsTable",path:"frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx#AuthorizedUrlsTable"})}catch(B){}},"./frontend/src/scenes/toolbar-launch/ToolbarLaunch.tsx":function(O,d,e){"use strict";e.r(d),e.d(d,"scene",function(){return V});var v=e("./node_modules/@babel/runtime/helpers/extends.js"),N=e.n(v),re=e("./node_modules/core-js/modules/es.array.map.js"),ne=e("./frontend/src/lib/components/PageHeader.tsx"),U=e("./node_modules/react/index.js"),n=e.n(U),F=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),J=e.n(F),H=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/ToolbarLaunch.scss"),C=e.n(H),g={};g.insert="head",g.singleton=!1;var $=J()(C.a,g),ae=C.a.locals||{},D=e("./node_modules/@ant-design/icons/es/icons/SearchOutlined.js"),b=e("./frontend/src/lib/components/Link.tsx"),y=e("./frontend/src/scenes/urls.ts"),A=e("./frontend/src/lib/components/icons.tsx"),f=e("./node_modules/antd/es/row/index.js"),p=e("./node_modules/antd/es/col/index.js"),G=e("./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx"),V={component:R};function R(){var P=[{title:"Heatmaps",caption:"Understand where your users interact the most.",icon:n.a.createElement(A.IconHeatmap,null)},{title:"Actions",caption:"Create actions visually from elements in your website.",icon:n.a.createElement(A.IconGroupedEvents,null)},{title:"Feature Flags",caption:"Toggle feature flags on/off right on your app.",icon:n.a.createElement(A.IconFlag,null)},{title:"Inspect",caption:"Inspect clickable elements on your website.",icon:n.a.createElement(D.a,null)}];return n.a.createElement("div",{className:"toolbar-launch-page"},n.a.createElement(ne.a,{title:"Toolbar",caption:"The toolbar launches PostHog right in your app or website."}),n.a.createElement(G.a,{pageKey:"toolbar-launch"}),n.a.createElement("div",{className:"footer-caption"},"Make sure you're using the ",n.a.createElement(b.a,{to:"".concat(y.a.projectSettings(),"#snippet")},"HTML snippet")," or the latest ",n.a.createElement("code",null,"posthog-js")," version."),n.a.createElement(f.a,{className:"feature-highlight-list"},P.map(function(m){return n.a.createElement(K,N()({key:m.title},m))})))}function K(P){var m=P.title,B=P.caption,W=P.icon;return n.a.createElement(p.a,{sm:12,className:"fh-item"},n.a.createElement("div",{className:"fh-icon"},W),n.a.createElement("div",null,n.a.createElement("h4",null,m),n.a.createElement("div",{className:"caption"},B)))}},"./frontend/src/scenes/toolbar-launch/authorizedUrlsLogic.ts":function(O,d,e){"use strict";e.d(d,"b",function(){return Te}),e.d(d,"a",function(){return ie}),e.d(d,"c",function(){return De});var v=e("./node_modules/core-js/modules/es.object.keys.js"),N=e.n(v),re=e("./node_modules/core-js/modules/es.symbol.js"),ne=e.n(re),U=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n=e.n(U),F=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),J=e.n(F),H=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),C=e.n(H),g=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),$=e.n(g),ae=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),D=e.n(ae),b=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=e.n(b),A=e("./node_modules/@babel/runtime/regenerator/index.js"),f=e.n(A),p=e("./node_modules/core-js/modules/es.array.concat.js"),G=e.n(p),V=e("./node_modules/core-js/modules/es.array.iterator.js"),R=e.n(V),K=e("./node_modules/core-js/modules/es.object.to-string.js"),P=e.n(K),m=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),B=e.n(m),W=e("./node_modules/core-js/modules/es.array.slice.js"),me=e.n(W),Q=e("./node_modules/core-js/modules/es.array.map.js"),I=e.n(Q),oe=e("./node_modules/core-js/modules/es.array.filter.js"),Ee=e.n(oe),X=e("./node_modules/core-js/modules/es.string.iterator.js"),fe=e.n(X),Y=e("./node_modules/core-js/modules/web.url.js"),je=e.n(Y),T=e("./node_modules/core-js/modules/web.url-search-params.js"),he=e.n(T),Z=e("./node_modules/core-js/modules/es.regexp.to-string.js"),ve=e.n(Z),le=e("./node_modules/core-js/modules/es.array.includes.js"),ge=e.n(le),de=e("./node_modules/core-js/modules/es.string.includes.js"),pe=e.n(de),w=e("./node_modules/core-js/modules/es.object.assign.js"),S=e.n(w),o=e("./node_modules/core-js/modules/es.array.splice.js"),k=e.n(o),L=e("./node_modules/core-js/modules/es.regexp.exec.js"),j=e.n(L),q=e("./node_modules/core-js/modules/es.string.search.js"),Oe=e.n(q),ee=e("./node_modules/kea/lib/index.esm.js"),te=e("./frontend/src/lib/api.ts"),z=e("./frontend/src/lib/utils.tsx"),x=e("./frontend/src/scenes/teamLogic.ts"),ue=e("./frontend/src/lib/dayjs.ts"),ce=e("./node_modules/fuse.js/dist/fuse.esm.js"),Ue=e("./node_modules/kea-router/lib/index.js"),Ae=e.n(Ue);function ye(l,r){var t=Object.keys(l);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(l);r&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(l,a).enumerable})),t.push.apply(t,s)}return t}function Pe(l){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?ye(Object(t),!0).forEach(function(s){y()(l,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(t)):ye(Object(t)).forEach(function(s){Object.defineProperty(l,s,Object.getOwnPropertyDescriptor(t,s))})}return l}function Te(l,r,t){var s=Pe(Pe({userIntent:t?void 0:r?"edit-action":"add-action"},r?{actionId:r}:{}),l?{appUrl:l}:{});return"/api/user/redirect_to_site/"+Object(Ue.encodeParams)(s,"?")}var ie="https://",De=Object(ee.kea)({path:function(r){return["lib","components","AppEditorLink","appUrlsLogic",r]},key:function(r){return"".concat(r.pageKey).concat(r.actionId)||"global"},props:{},connect:{values:[x.a,["currentTeam","currentTeamId"]],actions:[x.a,["updateCurrentTeam"]]},actions:function(){return{setAppUrls:function(t){return{appUrls:t}},addUrl:function(t,s){return{url:t,launch:s}},newUrl:!0,removeUrl:function(t){return{index:t}},updateUrl:function(t,s){return{index:t,url:s}},launchAtUrl:function(t){return{url:t}},setSearchTerm:function(t){return{term:t}},setEditUrlIndex:function(t){return{originalIndex:t}}}},loaders:function(r){var t=r.values;return{suggestions:{__default:[],loadSuggestions:function(){var s=D()(f.a.mark(function c(){var E,u,i,h;return f.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return u={events:[{id:"$pageview",name:"$pageview",type:"events"}],breakdown:"$current_url",date_from:Object(ue.a)().subtract(3,"days").toISOString()},_.next=3,te.b.get("api/projects/".concat(t.currentTeamId,"/insights/trend/?").concat(Object(z.yb)(u)));case 3:if(i=_.sent.result,!(i&&((E=i[0])===null||E===void 0?void 0:E.count)===0)){_.next=6;break}return _.abrupt("return",[]);case 6:return h=[],_.abrupt("return",(i||[]).filter(function(M){if(!M.breakdown_value)return!1;try{var _e=new URL(M.breakdown_value.toString()).hostname;return h.indexOf(_e)>-1||t.appUrls.filter(function(Me){return Me.indexOf(_e)>-1}).length>0?void 0:(h.push(_e),!0)}catch(Me){return!1}}).map(function(M){return M.breakdown_value}).slice(0,20));case 8:case"end":return _.stop()}},c)}));function a(){return s.apply(this,arguments)}return a}()}}},events:function(r){var t=r.actions,s=r.values;return{afterMount:function(){t.loadSuggestions(),s.currentTeam&&t.setAppUrls(s.currentTeam.app_urls)}}},reducers:function(){return{appUrls:[[],{setAppUrls:function(t,s){var a=s.appUrls;return a},addUrl:function(t,s){var a=s.url;return t.concat([a])},newUrl:function(t){return t.includes(ie)?t:[ie].concat(t)},updateUrl:function(t,s){var a=s.index,c=s.url;return Object.assign($()(t),y()({},a,c))},removeUrl:function(t,s){var a=s.index,c=$()(t);return c.splice(a,1),c}}],suggestions:[[],{addUrl:function(t,s){var a=s.url;return $()(t).filter(function(c){return a!==c})}}],searchTerm:["",{setSearchTerm:function(t,s){var a=s.term;return a}}],editUrlIndex:[null,{setEditUrlIndex:function(t,s){var a=s.originalIndex;return a},removeUrl:function(t,s){var a=s.index;return t&&a<t?t-1:a===t?null:t}}]}},listeners:function(r){var t,s=r.sharedListeners,a=r.values,c=r.actions;return t={addUrl:[s.saveAppUrls,function(){var E=D()(f.a.mark(function u(i){var h,se;return f.a.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:h=i.url,se=i.launch,se&&c.launchAtUrl(h);case 2:case"end":return M.stop()}},u)}));return function(u){return E.apply(this,arguments)}}()],removeUrl:s.saveAppUrls,updateUrl:[s.saveAppUrls,function(){return c.setEditUrlIndex(null)}]},y()(t,x.a.actionTypes.loadCurrentTeamSuccess,function(){var E=D()(f.a.mark(function u(i){var h;return f.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:h=i.currentTeam,h&&c.setAppUrls(h.app_urls);case 2:case"end":return _.stop()}},u)}));return function(u){return E.apply(this,arguments)}}()),y()(t,"launchAtUrl",function(u){var i=u.url;window.location.href=a.launchUrl(i)}),t},sharedListeners:function(r){var t=r.values;return{saveAppUrls:function(){x.a.actions.updateCurrentTeam({app_urls:t.appUrls})}}},selectors:function(r){var t=r.props;return{appUrlsKeyed:[function(s){return[s.appUrls,s.suggestions,s.searchTerm]},function(s,a,c){var E=s.map(function(u,i){return{url:u,type:"authorized",originalIndex:i}}).concat(a.map(function(u,i){return{url:u,type:"suggestion",originalIndex:i}}));return c?new ce.a(E,{keys:["url"],threshold:.3}).search(c).map(function(u){return u.item}):E}],launchUrl:[function(){return[]},function(){return function(s){return Te(s,t.actionId,!t.actionId)}}]}}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.scss":function(O,d,e){var v=e("./node_modules/css-loader/dist/runtime/api.js");d=v(!1),d.push([O.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.authorized-urls-table .authorized-url-col{display:flex;align-items:center}.authorized-urls-table .authorized-url-col .lemon-tag{margin-left:6px}.authorized-urls-table .authorized-url-col.suggestion{color:#747ea1}.authorized-urls-table .authorized-url-col.authorized{color:var(--success)}.authorized-urls-table .actions-col{display:flex;align-items:center;justify-content:flex-end}",""]),O.exports=d},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/ToolbarLaunch.scss":function(O,d,e){var v=e("./node_modules/css-loader/dist/runtime/api.js");d=v(!1),d.push([O.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.toolbar-launch-page{margin-bottom:48px}.toolbar-launch-page .footer-caption{text-align:center;color:var(--muted);margin-top:1rem}.toolbar-launch-page .feature-highlight-list{max-width:800px;margin:2rem auto 0}.toolbar-launch-page .feature-highlight-list .fh-item{display:flex;align-items:center;margin-top:1rem}.toolbar-launch-page .feature-highlight-list .fh-item .fh-icon{color:#747ea1;margin-right:8px;font-size:1.6em}.toolbar-launch-page .feature-highlight-list .fh-item h4{color:#747ea1;margin-bottom:0;font-size:1.2em}",""]),O.exports=d}}]);
