var qe=Object.defineProperty,en=Object.defineProperties;var nn=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var Me=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var Se=(M,x,t)=>x in M?qe(M,x,{enumerable:!0,configurable:!0,writable:!0,value:t}):M[x]=t,de=(M,x)=>{for(var t in x||(x={}))Me.call(x,t)&&Se(M,t,x[t]);if(ce)for(var t of ce(x))Le.call(x,t)&&Se(M,t,x[t]);return M},be=(M,x)=>en(M,nn(x));var Ae=(M,x)=>{var t={};for(var m in M)Me.call(M,m)&&x.indexOf(m)<0&&(t[m]=M[m]);if(M!=null&&ce)for(var m of ce(M))x.indexOf(m)<0&&Le.call(M,m)&&(t[m]=M[m]);return t};var N=(M,x,t)=>new Promise((m,$)=>{var r=T=>{try{A(t.next(T))}catch(W){$(W)}},p=T=>{try{A(t.throw(T))}catch(W){$(W)}},A=T=>T.done?m(T.value):Promise.resolve(T.value).then(r,p);A((t=t.apply(M,x)).next())});(window.webpackJsonp=window.webpackJsonp||[]).push([[283],{"./frontend/src/lib/hooks/useAnchor.ts":function(M,x,t){"use strict";t.d(x,"a",function(){return r});var m=t("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),$=t.n(m);function r(p){Object(m.useEffect)(()=>{if(p&&document.getElementById(p.substr(1))){const A=document.getElementById(p.substr(1));if(!A)return;A.classList.add("highlighted");const T=A.getBoundingClientRect().top+window.pageYOffset;window.scrollTo({top:T-50-32,behavior:"smooth"})}},[p])}},"./frontend/src/scenes/organization/Settings/Permissions/Roles/rolesLogic.tsx":function(M,x,t){"use strict";t.d(x,"a",function(){return W});var m=t("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),$=t("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js"),r=t.n($),p=t("./frontend/src/lib/api.ts"),A=t("./frontend/src/scenes/project/Settings/teamMembersLogic.tsx"),T=t("./frontend/src/types.ts");const W=Object(m.kea)([Object(m.path)(["scenes","organization","rolesLogic"]),Object(m.connect)({values:[A.b,["allMembers"]]}),Object(m.actions)({setCreateRoleModalShown:b=>({shown:b}),setRoleInFocus:b=>({role:b}),setRoleMembersInFocus:b=>({roleMembers:b}),setRoleMembersToAdd:b=>({uuids:b}),openCreateRoleModal:!0,setPermission:(b,j)=>({resource:b,access:j}),clearPermission:!0,updateRole:b=>({role:b})}),Object(m.reducers)({createRoleModalShown:[!1,{setCreateRoleModalShown:(b,j)=>{let{shown:f}=j;return f}}],roleInFocus:[null,{setRoleInFocus:(b,j)=>{let{role:f}=j;return f}}],roleMembersInFocus:[[],{setRoleMembersInFocus:(b,j)=>{let{roleMembers:f}=j;return f}}],roleMembersToAdd:[[],{setRoleMembersToAdd:(b,j)=>{let{uuids:f}=j;return f}}],roles:[[],{updateRole:(b,j)=>{let{role:f}=j;return b.map(c=>c.id==f.id?f:c)}}]}),Object($.loaders)(b=>{let{values:j,actions:f}=b;return{roles:{loadRoles:()=>N(this,null,function*(){const c=yield p.b.roles.list();return(c==null?void 0:c.results)||[]}),createRole:c=>N(this,null,function*(){const{roles:O,roleMembersToAdd:V}=j,e=yield p.b.roles.create(c);return yield f.addRoleMembers({role:e,membersToAdd:V}),f.setRoleMembersInFocus([]),f.setRoleMembersToAdd([]),f.clearPermission(),f.setCreateRoleModalShown(!1),[e,...O]}),deleteRole:c=>N(this,null,function*(){return yield p.b.roles.delete(c.id),j.roles.filter(O=>O.id!==c.id)})},roleMembersInFocus:[[],{loadRoleMembers:c=>N(this,null,function*(){let{roleId:O}=c;const V=yield p.b.roles.members.list(O);return(V==null?void 0:V.results)||[]}),addRoleMembers:c=>N(this,null,function*(){let{role:O,membersToAdd:V}=c;const e=yield Promise.all(V.map(L=>N(this,null,function*(){return yield p.b.roles.members.create(O.id,L)})));return f.setRoleMembersToAdd([]),[...j.roleMembersInFocus,...e]}),deleteRoleMember:c=>N(this,null,function*(){let{roleMemberUuid:O}=c;return j.roleInFocus&&(yield p.b.roles.members.delete(j.roleInFocus.id,O)),j.roleMembersInFocus.filter(V=>V.id!==O)})}]}}),Object(m.listeners)(b=>{let{actions:j,values:f}=b;return{setRoleInFocus:c=>{let{role:O}=c;O&&j.loadRoleMembers({roleId:O.id}),j.setCreateRoleModalShown(!0)},openCreateRoleModal:()=>{j.setRoleInFocus(null),j.setRoleMembersInFocus([]),j.setCreateRoleModalShown(!0)},setCreateRoleModalShown:()=>{f.roleInFocus?j.setPermission(T.T.FEATURE_FLAGS,f.roleInFocus.feature_flags_access_level):j.setPermission(T.T.FEATURE_FLAGS,T.a.WRITE)},deleteRoleSuccess:()=>{j.setCreateRoleModalShown(!1)}}}),Object(m.selectors)({addableMembers:[b=>[b.allMembers,b.roleMembersInFocus],(b,j)=>{const f=[];for(const c of b)j.some(O=>O.user.uuid===c.user.uuid)||f.push(c.user);return f.sort((c,O)=>c.first_name.localeCompare(O.first_name)),f}]}),Object(m.afterMount)(b=>{let{actions:j}=b;j.loadRoles()})])},"./frontend/src/scenes/organization/Settings/Permissions/permissionsLogic.tsx":function(M,x,t){"use strict";t.d(x,"a",function(){return c}),t.d(x,"b",function(){return V});var m=t("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),$=t("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js"),r=t.n($),p=t("./frontend/src/lib/api.ts"),A=t("./frontend/src/types.ts"),T=t("./frontend/src/lib/logic/featureFlagLogic.ts"),W=t("./frontend/src/lib/constants.tsx"),b=t("./frontend/src/scenes/organization/Settings/Permissions/Roles/rolesLogic.tsx"),j=t("./frontend/@posthog/lemon-ui/src/index.ts");const f={[A.T.FEATURE_FLAGS]:"Feature Flags"},c={[A.a.WRITE]:"View & Edit",[A.a.READ]:"View Only"},O={[A.T.FEATURE_FLAGS]:"feature_flags_access_level"},V=Object(m.kea)([Object(m.path)(["scenes","organization","Settings","Permissions","permissionsLogic"]),Object(m.connect)({values:[T.a,["featureFlags"],b.a,["roles"]],actions:[b.a,["updateRole"]]}),Object(m.actions)({updatePermission:(e,L,R,E)=>({checked:e,role:L,resourceId:R,resourceType:E})}),Object($.loaders)(e=>{let{values:L}=e;return{organizationResourcePermissions:[[],{loadOrganizationResourcePermissions:()=>N(this,null,function*(){const R=yield p.b.resourcePermissions.list();return(R==null?void 0:R.results)||[]}),updateOrganizationResourcePermission:R=>N(this,null,function*(){let{id:E,resource:B,access_level:y}=R;if(E){const D=yield p.b.resourcePermissions.update(E,{access_level:y});return L.organizationResourcePermissions.map(G=>G.id==D.id?D:G)}else{const D=yield p.b.resourcePermissions.create({resource:B,access_level:y});return[...L.organizationResourcePermissions,D]}})}]}}),Object(m.listeners)(e=>{let{actions:L}=e;return{updatePermission:R=>N(this,null,function*(){let{checked:E,role:B,resourceId:y,resourceType:D}=R;const G=E?A.a.WRITE:A.a.READ;if(B.id){const _=yield p.b.roles.update(B.id,{[O[D]]:G});_&&(L.updateRole(_),j.lemonToast.success(`${B.name} role ${D} edit access updated`))}else L.updateOrganizationResourcePermission({id:y,access_level:G})}),updateOrganizationResourcePermissionSuccess:()=>{j.lemonToast.success("Organizational edit access updated")}}}),Object(m.selectors)({organizationResourcePermissionsMap:[e=>[e.organizationResourcePermissions],e=>e.reduce((L,R)=>be(de({},L),{[R.resource]:R}),{})],allPermissions:[e=>[e.organizationResourcePermissionsMap],e=>Object.keys(f).map(L=>{var R,E;return{id:((R=e[L])===null||R===void 0?void 0:R.id)||null,resource:L,name:f[L],access_level:((E=e[L])===null||E===void 0?void 0:E.access_level)||A.a.WRITE}})],shouldShowPermissionsTable:[e=>[e.featureFlags],e=>e[W.i.ROLE_BASED_ACCESS]==="control"],resourceRolesAccess:[e=>[e.allPermissions,e.roles],(e,L)=>{const R=e.map(E=>({[E.resource]:{organization_default:E.access_level,id:E.id}}));for(const E of L)for(const B of R){const y=Object.keys(B)[0];B[y][`${E.name}`]=E[O[y]]}return R}]}),Object(m.afterMount)(e=>{let{actions:L}=e;L.loadOrganizationResourcePermissions()})])},"./frontend/src/scenes/organization/Settings/index.tsx":function(M,x,t){"use strict";t.r(x),t.d(x,"scene",function(){return Je}),t.d(x,"OrganizationSettingsTabs",function(){return le}),t.d(x,"OrganizationSettings",function(){return ye});var m=t("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),$=t("./frontend/src/lib/components/PageHeader.tsx"),r=t("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),p=t("./frontend/src/lib/components/CopyToClipboard.tsx"),A=t("./frontend/src/lib/components/ProfilePicture/index.ts"),T=t("./frontend/src/scenes/organization/Settings/inviteLogic.ts"),W=t("./frontend/src/scenes/organization/Settings/InviteModal.tsx"),b=t("./frontend/src/lib/components/LemonTable/index.ts"),j=t("./frontend/src/lib/components/LemonTable/columnUtils.tsx"),f=t("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),c=t("./frontend/src/lib/components/LemonButton/index.ts"),O=t("./frontend/src/lib/components/icons.tsx"),V=t("./frontend/src/lib/components/LemonDialog/index.ts"),e=t("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function L(n,s){const o=new URL(`/signup/${n}`,document.baseURI).href;return s.is_expired?Object(e.jsx)("b",{children:"Expired! Delete and recreate"}):Object(e.jsx)(p.a,{"data-attr":"invite-link",description:"invite link",children:o})}function R(n){return function(o,i){return Object(e.jsx)(c.a,{title:"Cancel the invite","data-attr":"invite-delete",icon:Object(e.jsx)(O.IconClose,{}),status:"danger",onClick:()=>{i.is_expired?n(i):V.a.open({title:`Do you want to cancel the invite for ${i.target_email}?`,primaryButton:{children:"Yes, cancel invite",status:"danger",onClick:()=>n(i)},secondaryButton:{children:"No, keep invite"}})}})}}function E(){const{invites:n,invitesLoading:s}=Object(r.useValues)(T.a),{deleteInvite:o,showInviteModal:i}=Object(r.useActions)(T.a),{preflight:a}=Object(r.useValues)(f.a),d=[{key:"user_profile_picture",render:function(u,l){return Object(e.jsx)(A.b,{name:l.first_name,email:l.target_email})},width:32},{title:"Invitee",dataIndex:"target_email",key:"target_email",render:function(u,l){return l.target_email?Object(e.jsxs)("div",{className:"flex items-center",children:[l.target_email,l.first_name?` (${l.first_name})`:""]}):Object(e.jsx)("i",{children:"no one"})},width:"20%"},Object(j.b)(),Object(j.a)(),{title:"Invite Link",dataIndex:"id",key:"link",render:(h,u)=>L(u.id,u)},{title:"",key:"actions",width:24,render:R(o)}];return Object(e.jsxs)("div",{children:[Object(e.jsxs)("h2",{id:"invites",className:"subtitle",style:{justifyContent:"space-between"},children:["Pending Invites",Object(e.jsx)(c.a,{type:"primary",onClick:i,"data-attr":"invite-teammate-button",children:"Invite team member"})]}),!(a!=null&&a.email_service_available)&&Object(e.jsx)(W.a,{}),Object(e.jsx)(b.a,{dataSource:n,columns:d,rowKey:"id",loading:s,style:{marginTop:"1rem"},"data-attr":"invites-table",emptyState:"There are no outstanding invitations. You can invite another team member above."})]})}var B=t("./frontend/src/scenes/organization/Settings/membersLogic.tsx"),y=t("./frontend/src/lib/constants.tsx"),D=t("./frontend/src/scenes/organizationLogic.tsx"),G=t("./frontend/src/scenes/userLogic.ts"),_=t("./frontend/src/lib/utils/permissioning.ts"),Re=t("./frontend/src/lib/components/TZLabel/index.tsx"),Oe=t("./frontend/src/lib/components/LemonButton/More.tsx"),ue=t("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),Ce=t("./frontend/src/lib/components/LemonDivider/index.ts"),C=t("./frontend/@posthog/lemon-ui/src/index.ts");function De(n,s){var o;const{user:i}=Object(r.useValues)(G.a),{currentOrganization:a}=Object(r.useValues)(D.a),{removeMember:d,changeMemberAccessLevel:h}=Object(r.useActions)(B.a);if(!i)return null;const u=(o=a==null?void 0:a.membership_level)!==null&&o!==void 0?o:-1,l=(u>=y.p.Admin&&s.level<=u||s.user.uuid===i.uuid)&&s.level!==y.p.Owner,S=a?a.membership_level:null,v=_.c.filter(g=>!Object(_.a)(S,i,s,g)),w=Object(_.a)(S,i,s,v);return Object(e.jsx)(Oe.a,{overlay:Object(e.jsxs)(e.Fragment,{children:[w?Object(e.jsx)("div",{children:w}):v.map(g=>Object(e.jsx)(c.a,{status:"stealth",fullWidth:!0,onClick:P=>{if(P.preventDefault(),!i)throw Error;if(g===y.p.Owner){var I;V.a.open({title:`Transfer organization ownership to ${s.user.first_name}?`,description:`You will no longer be the owner of ${(I=i.organization)===null||I===void 0?void 0:I.name}. After the transfer you will become an administrator.`,primaryButton:{status:"danger",children:"Transfer Ownership",onClick:()=>h(s,g)},secondaryButton:{children:"Cancel"}})}else h(s,g)},"data-test-level":g,children:g===y.p.Owner?Object(e.jsx)(e.Fragment,{children:"Transfer organization ownership"}):g>s.level?Object(e.jsxs)(e.Fragment,{children:["Upgrade to ",_.b.get(g)]}):Object(e.jsxs)(e.Fragment,{children:["Downgrade to ",_.b.get(g)]})},`${s.user.uuid}-level-${g}`)),l?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Ce.a,{}),Object(e.jsx)(c.a,{status:"danger","data-attr":"delete-org-membership",onClick:()=>{var g;if(!i)throw Error;V.a.open({title:`${s.user.uuid==i.uuid?"Leave":`Remove ${s.user.first_name} from`} organization ${(g=i.organization)===null||g===void 0?void 0:g.name}?`,primaryButton:{children:s.user.uuid==i.uuid?"Leave":"Remove",status:"danger",onClick:()=>d(s)},secondaryButton:{children:"Cancel"}})},fullWidth:!0,children:s.user.uuid!==i.uuid?"Remove from organization":"Leave organization"})]}):null]})})}function te(n){let{user:s}=n;const{filteredMembers:o,membersLoading:i,search:a}=Object(r.useValues)(B.a),{setSearch:d}=Object(r.useActions)(B.a),h=[{key:"user_profile_picture",render:function(l,S){return Object(e.jsx)(A.b,{name:S.user.first_name,email:S.user.email})},width:32},{title:"Name",key:"user_first_name",render:(u,l)=>l.user.uuid==s.uuid?`${l.user.first_name} (me)`:l.user.first_name,sorter:(u,l)=>u.user.first_name.localeCompare(l.user.first_name)},{title:"Email",key:"user_email",render:(u,l)=>l.user.email,sorter:(u,l)=>u.user.email.localeCompare(l.user.email)},{title:"Level",dataIndex:"level",key:"level",render:function(l,S){var v;return Object(e.jsx)(ue.a,{"data-attr":"membership-level",children:S.level===y.p.Owner?"Organization owner":`Project ${(v=_.b.get(S.level))!==null&&v!==void 0?v:`unknown (${S.level})`}`})},sorter:(u,l)=>u.level-l.level},{title:"Joined",dataIndex:"joined_at",key:"joined_at",render:function(l){return Object(e.jsx)("div",{className:"whitespace-nowrap",children:Object(e.jsx)(Re.a,{time:l})})},sorter:(u,l)=>u.joined_at.localeCompare(l.joined_at)},{key:"actions",width:0,render:De}];return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h2",{className:"subtitle",children:"Members"}),Object(e.jsx)(C.LemonInput,{type:"search",placeholder:"Search for members",value:a,onChange:d}),Object(e.jsx)(b.a,{dataSource:o,columns:h,rowKey:"id",style:{marginTop:"1rem"},loading:i,"data-attr":"org-members-table",defaultSorting:{columnKey:"level",order:-1},pagination:{pageSize:50}})]})}try{te.displayName="Members",te.__docgenInfo={description:"",displayName:"Members",props:{user:{defaultValue:null,description:"Currently logged-in user.",name:"user",required:!0,type:{name:"UserType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/organization/Settings/Members.tsx#Members"]={docgenInfo:te.__docgenInfo,name:"Members",path:"frontend/src/scenes/organization/Settings/Members.tsx#Members"})}catch(n){}function se(n){let{isOpen:s,setIsOpen:o}=n;const{currentOrganization:i,organizationBeingDeleted:a}=Object(r.useValues)(D.a),{deleteOrganization:d}=Object(r.useActions)(D.a),[h,u]=Object(m.useState)(!1),l=!!i&&(a==null?void 0:a.id)===i.id;return Object(e.jsxs)(C.LemonModal,{title:"Delete the entire organization?",onClose:l?void 0:()=>o(!1),footer:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(C.LemonButton,{disabled:l,type:"secondary",onClick:()=>o(!1),children:"Cancel"}),Object(e.jsx)(C.LemonButton,{type:"primary",disabled:!h,loading:l,"data-attr":"delete-organization-ok",status:"danger",onClick:i?()=>d(i):void 0,children:`Delete ${i?i.name:"the current organization"}`})]}),isOpen:s,children:[Object(e.jsxs)("p",{children:["Organization deletion ",Object(e.jsx)("b",{children:"cannot be undone"}),". You will lose all data, ",Object(e.jsx)("b",{children:"including all events"}),", related to all projects within this organization."]}),Object(e.jsxs)("p",{children:["Please type"," ",Object(e.jsx)("strong",{children:i?i.name:"this organization's name"})," to confirm."]}),Object(e.jsx)(C.LemonInput,{type:"text",onChange:S=>{i&&u(S.toLowerCase()===i.name.toLowerCase())}})]})}function ie(n){let{isRestricted:s}=n;const{currentOrganization:o}=Object(r.useValues)(D.a),[i,a]=Object(m.useState)(!1);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"text-danger",children:[Object(e.jsx)("h2",{className:"text-danger subtitle",children:"Danger Zone"}),Object(e.jsxs)("div",{className:"mt-4",children:[!s&&Object(e.jsxs)("p",{className:"text-danger",children:["This is ",Object(e.jsx)("b",{children:"irreversible"}),". Please be certain."]}),Object(e.jsxs)(C.LemonButton,{status:"danger",type:"secondary",onClick:()=>a(!0),"data-attr":"delete-organization-button",icon:Object(e.jsx)(O.IconDelete,{}),disabled:s,children:["Delete ",(o==null?void 0:o.name)||"the current organization"]})]})]}),Object(e.jsx)(se,{isOpen:i,setIsOpen:a})]})}try{se.displayName="DeleteOrganizationModal",se.__docgenInfo={description:"",displayName:"DeleteOrganizationModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},setIsOpen:{defaultValue:null,description:"",name:"setIsOpen",required:!0,type:{name:"Dispatch<SetStateAction<boolean>>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/organization/Settings/DangerZone.tsx#DeleteOrganizationModal"]={docgenInfo:se.__docgenInfo,name:"DeleteOrganizationModal",path:"frontend/src/scenes/organization/Settings/DangerZone.tsx#DeleteOrganizationModal"})}catch(n){}try{ie.displayName="DangerZone",ie.__docgenInfo={description:"",displayName:"DangerZone",props:{isRestricted:{defaultValue:null,description:"",name:"isRestricted",required:!0,type:{name:"boolean"}},restrictionReason:{defaultValue:null,description:"",name:"restrictionReason",required:!0,type:{name:"string | null"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/organization/Settings/DangerZone.tsx#DangerZone"]={docgenInfo:ie.__docgenInfo,name:"DangerZone",path:"frontend/src/scenes/organization/Settings/DangerZone.tsx#DangerZone"})}catch(n){}var X=t("./frontend/src/lib/components/RestrictedArea.tsx"),Ee=t("./frontend/src/lib/hooks/useAnchor.ts"),q=t("./frontend/src/lib/components/Tooltip.tsx"),J=t("./frontend/src/lib/api.ts"),oe=t("./frontend/src/lib/components/lemonToast.tsx"),ee=t("./frontend/src/types.ts"),fe=t("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.0/node_modules/kea-forms/lib/index.js"),Ie=t("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js");const U=Object(r.kea)([Object(r.path)(["scenes","organization","verifiedDomainsLogic"]),Object(r.connect)({values:[D.a,["currentOrganization"]]}),Object(r.actions)({replaceDomain:n=>({domain:n}),setAddModalShown:n=>({shown:n}),setConfigureSAMLModalId:n=>({id:n}),setVerifyModal:n=>({id:n})}),Object(r.reducers)({verifiedDomains:[[],{replaceDomain:(n,s)=>{let{domain:o}=s;const i=[...n.filter(a=>{let{id:d}=a;return d!==o.id}),o];return i.sort((a,d)=>a.domain.localeCompare(d.domain)),i}}],addModalShown:[!1,{setAddModalShown:(n,s)=>{let{shown:o}=s;return o},addVerifiedDomainSuccess:()=>!1}],configureSAMLModalId:[null,{setConfigureSAMLModalId:(n,s)=>{let{id:o}=s;return o}}],verifyModal:[null,{setVerifyModal:(n,s)=>{let{id:o}=s;return o}}]}),Object(Ie.loaders)(n=>{let{values:s,actions:o}=n;return{verifiedDomains:[[],{loadVerifiedDomains:()=>N(this,null,function*(){var i;return(yield J.b.get(`api/organizations/${(i=s.currentOrganization)===null||i===void 0?void 0:i.id}/domains`)).results}),addVerifiedDomain:i=>N(this,null,function*(){var a;return[yield J.b.create(`api/organizations/${(a=s.currentOrganization)===null||a===void 0?void 0:a.id}/domains`,{domain:i}),...s.verifiedDomains]}),deleteVerifiedDomain:i=>N(this,null,function*(){var a;return yield J.b.delete(`api/organizations/${(a=s.currentOrganization)===null||a===void 0?void 0:a.id}/domains/${i}`),[...s.verifiedDomains.filter(d=>d.id!==i)]})}],updatingDomain:[!1,{updateDomain:i=>N(this,null,function*(){var a;const d=yield J.b.update(`api/organizations/${(a=s.currentOrganization)===null||a===void 0?void 0:a.id}/domains/${i.id}`,be(de({},i),{id:void 0}));return oe.d.success("Domain updated successfully! Changes will take immediately."),o.replaceDomain(d),!1}),verifyDomain:()=>N(this,null,function*(){var i;const a=yield J.b.create(`api/organizations/${(i=s.currentOrganization)===null||i===void 0?void 0:i.id}/domains/${s.verifyModal}/verify`);return a.is_verified?oe.d.success("Domain verified successfully."):oe.d.warning("We could not verify your domain yet. DNS propagation may take up to 72 hours. Please try again later."),o.replaceDomain(a),o.setVerifyModal(null),!1})}]}}),Object(r.listeners)(n=>{let{actions:s,values:o}=n;return{setConfigureSAMLModalId:i=>{let{id:a}=i;const d=o.verifiedDomains.find(h=>{let{id:u}=h;return u===a});if(a&&d){const{saml_acs_url:h,saml_entity_id:u,saml_x509_cert:l}=d;s.setSamlConfigValues({saml_acs_url:h,saml_entity_id:u,saml_x509_cert:l,id:a})}}}}),Object(r.selectors)({domainBeingVerified:[n=>[n.verifiedDomains,n.verifyModal],(n,s)=>s&&n.find(o=>{let{id:i}=o;return i===s})||null],isSSOEnforcementAvailable:[n=>[n.currentOrganization],n=>{var s;return(s=n==null?void 0:n.available_features.includes(ee.e.SSO_ENFORCEMENT))!==null&&s!==void 0?s:!1}],isSAMLAvailable:[n=>[n.currentOrganization],n=>{var s;return(s=n==null?void 0:n.available_features.includes(ee.e.SAML))!==null&&s!==void 0?s:!1}]}),Object(r.afterMount)(n=>{let{actions:s}=n;return s.loadVerifiedDomains()}),Object(fe.forms)(n=>{let{actions:s,values:o}=n;return{samlConfig:{defaults:{},errors:i=>({saml_acs_url:i.saml_acs_url&&!i.saml_acs_url.match(y.w)?"Please enter a valid URL, including https://":void 0}),submit:(i,a)=>N(this,null,function*(){var d;const S=i,{id:h}=S,u=Ae(S,["id"]);if(!h)return;const l=yield J.b.update(`api/organizations/${(d=o.currentOrganization)===null||d===void 0?void 0:d.id}/domains/${i.id}`,de({},u));a(),s.replaceDomain(l),s.setConfigureSAMLModalId(null),s.setSamlConfigValues({}),oe.d.success(`SAML configuration for ${l.domain} updated successfully.`)})}}})]);var me=t("./node_modules/.pnpm/@ant-design+icons@4.7.0_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),H=t("./frontend/src/lib/components/LemonModal/index.ts");function Te(){const{addModalShown:n,verifiedDomainsLoading:s}=Object(r.useValues)(U),{setAddModalShown:o,addVerifiedDomain:i}=Object(r.useActions)(U),[a,d]=Object(m.useState)(""),[h,u]=Object(m.useState)(!1),l=!a||!a.match(y.e),S=()=>{d(""),u(!1)},v=()=>{o(!1),S()},w=()=>{u(!0),l||(i(a),S())};return Object(e.jsxs)(H.a,{onClose:v,isOpen:n,title:"Add authentication domain",footer:Object(e.jsx)(c.a,{type:"primary",disabled:a===""||h&&l||s,onClick:w,children:"Add domain"}),children:[Object(e.jsx)(C.LemonInput,{placeholder:"posthog.com",autoFocus:!0,value:a,onChange:d,onPressEnter:w}),h&&l&&Object(e.jsx)("span",{className:"text-danger text-xs",children:"Please enter a valid domain or subdomain name (e.g. my.posthog.com)"})]})}var Pe=t("./frontend/src/scenes/organization/Settings/VerifiedDomains/SSOSelect.tsx"),Y=t("./frontend/src/lib/forms/Field.tsx");function ze(){const{domainBeingVerified:n,updatingDomainLoading:s}=Object(r.useValues)(U),{setVerifyModal:o,verifyDomain:i}=Object(r.useActions)(U),a=`_posthog-challenge.${n==null?void 0:n.domain}.`;return Object(e.jsx)(H.a,{isOpen:!!n,onClose:()=>o(null),title:"Verify your domain",description:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(ue.a,{className:"uppercase",children:(n==null?void 0:n.domain)||""}),Object(e.jsx)("p",{children:"To verify your domain, you need to add a record to your DNS zone."})]}),footer:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(c.a,{type:"secondary",onClick:()=>o(null),children:"Verify later"}),Object(e.jsx)(c.a,{type:"primary",disabled:s,onClick:i,children:"Verify"})]}),children:Object(e.jsx)("div",{children:Object(e.jsxs)("ol",{children:[Object(e.jsx)("li",{children:"Sign in to your DNS provider."}),Object(e.jsxs)("li",{children:["Add the following ",Object(e.jsx)("b",{children:"TXT"})," record.",Object(e.jsxs)("div",{className:"my-4 space-y-2",children:[Object(e.jsx)(Y.b,{label:"Name",children:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)("div",{className:"border rounded p-2 h-10 flex-1",children:a}),Object(e.jsx)(p.a,{explicitValue:a})]})}),Object(e.jsx)(Y.b,{label:"Value or content",children:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)("div",{className:"border rounded p-2 h-10 flex-1",children:n==null?void 0:n.verification_challenge}),Object(e.jsx)(p.a,{explicitValue:n==null?void 0:n.verification_challenge})]})}),Object(e.jsx)(Y.b,{label:"TTL",children:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)("div",{className:"border rounded p-2 h-10 flex-1",children:"Default or 3600"}),Object(e.jsx)(p.a,{explicitValue:"3600"})]})})]})]}),Object(e.jsx)("li",{children:"Press verify below."})]})})})}var ge=t("./frontend/src/lib/components/Link.tsx"),Ne=t("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),Ve=t("./frontend/src/lib/components/AlertMessage/index.ts"),he=t("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),Fe=t("./frontend/src/lib/components/LemonTextArea/LemonTextArea.tsx");function we(){var n;const{configureSAMLModalId:s,isSamlConfigSubmitting:o,samlConfig:i}=Object(r.useValues)(U),{setConfigureSAMLModalId:a}=Object(r.useActions)(U),{preflight:d}=Object(r.useValues)(f.a),h=(n=d==null?void 0:d.site_url)!==null&&n!==void 0?n:window.location.origin,u=i.saml_acs_url&&i.saml_entity_id&&i.saml_x509_cert,l=()=>{a(null)};return Object(e.jsx)(H.a,{onClose:l,isOpen:!!s,title:"",simple:!0,children:Object(e.jsxs)(fe.Form,{logic:U,formKey:"samlConfig",enableFormOnSubmit:!0,className:"LemonModal__layout ",children:[Object(e.jsx)(H.a.Header,{children:Object(e.jsx)("h3",{children:"Configure SAML authentication and provisioning"})}),Object(e.jsxs)(H.a.Content,{className:"space-y-2",children:[Object(e.jsx)(Y.a,{label:"ACS Consumer URL",name:"_ACSConsumerUrl",children:Object(e.jsx)(p.a,{children:`${h}/complete/saml`})}),Object(e.jsx)(Y.a,{label:"RelayState",name:"_RelayState",children:Object(e.jsx)(p.a,{children:s!=null?s:void 0})}),Object(e.jsx)(Y.a,{name:"saml_acs_url",label:"SAML ACS URL",children:Object(e.jsx)(he.a,{className:"ph-ignore-input",placeholder:"Your IdP's ACS or single sign-on URL."})}),Object(e.jsx)(Y.a,{name:"saml_entity_id",label:"SAML Entity ID",children:Object(e.jsx)(he.a,{className:"ph-ignore-input",placeholder:"Entity ID provided by your IdP."})}),Object(e.jsx)(Y.a,{name:"saml_x509_cert",label:"SAML X.509 Certificate",children:Object(e.jsx)(Fe.a,{className:"ph-ignore-input",minRows:10,placeholder:`Enter the public certificate of your IdP. Keep all line breaks.
-----BEGIN CERTIFICATE-----
MIICVjCCAb+gAwIBAgIBADANBgkqhkiG9w0BAQ0FADBIMQswCQYDVQQGEwJ1czEL
-----END CERTIFICATE-----`})}),!u&&Object(e.jsx)(Ve.a,{type:"info",children:"SAML will not be enabled unless you enter all attributes above. However you can still settings as draft."})]}),Object(e.jsx)(H.a.Footer,{children:Object(e.jsx)(c.a,{loading:o,type:"primary",htmlType:"submit",children:"Save settings"})})]})})}const Q={marginRight:4,fontSize:"1.15em",paddingTop:2};function Be(){const{verifiedDomainsLoading:n,updatingDomainLoading:s}=Object(r.useValues)(U),{setAddModalShown:o}=Object(r.useActions)(U);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"flex items-center",children:[Object(e.jsxs)("div",{style:{flexGrow:1},children:[Object(e.jsx)("div",{id:"domain-whitelist"})," ",Object(e.jsx)("h2",{id:"authentication-domains",className:"subtitle",children:"Authentication domains"}),Object(e.jsx)("p",{className:"text-muted-alt",children:"Enable users to sign up automatically with an email address on verified domains and enforce SSO for accounts under your domains."})]}),Object(e.jsx)(c.a,{type:"primary",onClick:()=>o(!0),disabled:n||s,children:"Add domain"})]}),Object(e.jsx)($e,{})]})}function $e(){const{verifiedDomains:n,verifiedDomainsLoading:s,currentOrganization:o,updatingDomainLoading:i,isSSOEnforcementAvailable:a,isSAMLAvailable:d}=Object(r.useValues)(U),{updateDomain:h,deleteVerifiedDomain:u,setVerifyModal:l,setConfigureSAMLModalId:S}=Object(r.useActions)(U),{preflight:v}=Object(r.useValues)(f.a),w=[{key:"domain",title:"Domain name",dataIndex:"domain",render:function(P,I){let{domain:z}=I;return Object(e.jsx)(ue.a,{children:z})}},...v!=null&&v.cloud?[{key:"is_verified",title:Object(e.jsxs)(e.Fragment,{children:["Verification",Object(e.jsx)(q.a,{title:"Verification (through DNS) is required to use domains for authentication (e.g. SAML or enforce SSO).",children:Object(e.jsx)(me.a,{style:{marginLeft:4}})})]}),render:function(P,I){let{is_verified:z,verified_at:F}=I;return z?Object(e.jsxs)("div",{className:"flex items-center text-success",children:[Object(e.jsx)(O.IconCheckmark,{style:Q})," Verified"]}):F?Object(e.jsxs)("div",{className:"flex items-center text-danger",children:[Object(e.jsx)(O.IconExclamation,{style:Q})," Verification expired"]}):Object(e.jsxs)("div",{className:"flex items-center text-warning",children:[Object(e.jsx)(O.IconWarning,{style:Q})," Pending verification"]})}}]:[],{key:"jit_provisioning_enabled",title:Object(e.jsxs)(e.Fragment,{children:["Automatic provisioning"," ",Object(e.jsx)(q.a,{title:`Enables just-in-time provisioning. If a user logs in with SSO with an email address on this domain an account will be created in ${(o==null?void 0:o.name)||"this organization"} if it does not exist.`,children:Object(e.jsx)(me.a,{})})]}),render:function(P,I){let{jit_provisioning_enabled:z,id:F,is_verified:K}=I;return K?Object(e.jsx)("div",{className:"flex items-center",children:Object(e.jsx)(Ne.a,{checked:z,disabled:i||!K,onChange:k=>h({id:F,jit_provisioning_enabled:k}),label:Object(e.jsx)("span",{className:"font-normal",children:z?"Enabled":"Disabled"})})}):Object(e.jsx)("i",{className:"text-muted-alt",children:"Verify domain to enable automatic provisioning"})}},{key:"sso_enforcement",title:Object(e.jsxs)(e.Fragment,{children:["Enforce SSO"," ",Object(e.jsx)(q.a,{title:"Require users with email addresses on this domain to always log in using a specific SSO provider.",children:Object(e.jsx)(me.a,{})})]}),render:function(P,I,z){let{sso_enforcement:F,is_verified:K,id:k,has_saml:Z}=I;return a?K?Object(e.jsx)(Pe.a,{value:F,loading:i,onChange:ne=>h({id:k,sso_enforcement:ne}),samlAvailable:Z}):Object(e.jsx)("i",{className:"text-muted-alt",children:"Verify domain to enable"}):z===0?Object(e.jsxs)(ge.a,{to:Object(y.D)(v==null?void 0:v.cloud).url,target:Object(y.D)(v==null?void 0:v.cloud).target,className:"flex items-center",children:[Object(e.jsx)(O.IconLock,{style:{color:"var(--warning)",marginLeft:4}})," Upgrade to enable SSO enforcement"]}):Object(e.jsx)(e.Fragment,{})}},{key:"saml",title:"SAML",render:function(P,I,z){let{is_verified:F,saml_acs_url:K,saml_entity_id:k,saml_x509_cert:Z,has_saml:ne}=I;return d?F?Object(e.jsx)(e.Fragment,{children:ne?Object(e.jsxs)("div",{className:"flex items-center text-success",children:[Object(e.jsx)(O.IconCheckmark,{style:Q})," SAML enabled"]}):K||k||Z?Object(e.jsxs)("div",{className:"flex items-center text-warning",children:[Object(e.jsx)(O.IconWarning,{style:Q})," SAML partially configured"]}):Object(e.jsxs)("div",{className:"flex items-center",children:[Object(e.jsx)(O.IconOffline,{style:Q})," SAML not set up"]})}):Object(e.jsx)("i",{className:"text-muted-alt",children:"Verify domain to enable"}):z===0?Object(e.jsxs)(ge.a,{to:Object(y.D)(v==null?void 0:v.cloud).url,target:Object(y.D)(v==null?void 0:v.cloud).target,className:"flex items-center",children:[Object(e.jsx)(O.IconLock,{style:{color:"var(--warning)",marginLeft:4}})," Upgrade to enable SAML"]}):Object(e.jsx)(e.Fragment,{})}},{key:"actions",width:32,align:"center",render:function(P,I){let{is_verified:z,id:F,domain:K}=I;return z?Object(e.jsx)(Oe.a,{overlay:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(c.a,{status:"stealth",onClick:()=>S(F),fullWidth:!0,disabled:!d,title:d?void 0:"Upgrade to enable SAML",children:"Configure SAML"}),Object(e.jsxs)(c.a,{status:"danger",onClick:()=>V.a.open({title:`Remove ${K}?`,description:"This cannot be undone. If you have SAML configured or SSO enforced,it will be immediately disabled.",primaryButton:{status:"danger",children:"Remove domain",onClick:()=>u(F)},secondaryButton:{children:"Cancel"}}),fullWidth:!0,children:[Object(e.jsx)(O.IconDelete,{})," Remove domain"]})]}),style:{display:"inline-block"}}):Object(e.jsx)(c.a,{type:"primary",onClick:()=>l(F),children:"Verify"})}}];return Object(e.jsxs)("div",{children:[Object(e.jsx)(b.a,{dataSource:n,columns:w,loading:s,rowKey:"id",emptyState:"You haven't registered any authentication domains yet."}),Object(e.jsx)(Te,{}),Object(e.jsx)(we,{}),Object(e.jsx)(ze,{})]})}var Ue=t("./frontend/src/lib/components/PayGateMini/PayGateMini.tsx"),ke=t("./frontend/src/lib/logic/featureFlagLogic.ts"),je=t("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/tabs/index.js"),xe=t("./frontend/src/scenes/urls.ts"),Ke=t("./frontend/src/lib/components/TitleWithIcon.tsx"),ve=t("./frontend/src/scenes/organization/Settings/Permissions/permissionsLogic.tsx"),We=t("./frontend/src/lib/components/LemonSelectMultiple/LemonSelectMultiple.tsx"),_e=t("./frontend/src/lib/components/Spinner/Spinner.tsx"),Ge=t("./frontend/src/lib/components/UserSelectItem.tsx"),ae=t("./frontend/src/scenes/organization/Settings/Permissions/Roles/rolesLogic.tsx");function Ye(){const{roleInFocus:n,createRoleModalShown:s,roleMembersToAdd:o,roleMembersInFocusLoading:i,addableMembers:a,rolesLoading:d,roleMembersInFocus:h}=Object(r.useValues)(ae.a),{setCreateRoleModalShown:u,setRoleMembersToAdd:l,createRole:S,deleteRoleMember:v,addRoleMembers:w,deleteRole:g}=Object(r.useActions)(ae.a),{isAdminOrOwner:P}=Object(r.useValues)(D.a),[I,z]=Object(m.useState)(""),F=()=>{u(!1),l([])},K=()=>{S(I),z("")},k=!n;return Object(e.jsxs)(H.a,{onClose:F,isOpen:s,title:k?"Create role":P?`Edit ${n.name} role`:`${n.name} role`,footer:d?Object(e.jsx)(_e.a,{monocolor:!0}):P?Object(e.jsxs)("div",{className:"flex flex-row justify-between w-full",children:[Object(e.jsx)("div",{children:!k&&Object(e.jsx)(c.a,{htmlType:"submit",type:"primary",status:"danger",onClick:()=>g(n),"data-attr":"role-delete-submit",children:"Delete role"})}),Object(e.jsx)(c.a,{type:"primary",onClick:K,children:"Save"})]}):void 0,children:[k&&Object(e.jsxs)("div",{className:"mb-5",children:[Object(e.jsx)("h5",{children:"Role Name"}),Object(e.jsx)(C.LemonInput,{placeholder:"Product",autoFocus:!0,value:I,onChange:z})]}),P&&Object(e.jsxs)("div",{className:"mb-5",children:[Object(e.jsx)("h5",{children:"Members"}),Object(e.jsxs)("div",{className:"flex gap-2",children:[Object(e.jsx)("div",{className:"flex-1",children:Object(e.jsx)(We.a,{placeholder:"Search for team members to add\u2026",value:o,loading:i,onChange:Z=>l(Z),filterOption:!0,mode:"multiple","data-attr":"subscribed-emails",options:Object(Ge.a)(a,"uuid")})}),!k&&Object(e.jsx)(c.a,{type:"primary",loading:i,disabled:o.length===0,onClick:()=>w({role:n,membersToAdd:o}),children:"Add"})]})]}),!k&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h5",{children:"Role Members"}),h.length>0?Object(e.jsx)("div",{className:"mt-2 pb-2 rounded overflow-y-auto",style:{maxHeight:300},children:h.map(Z=>Object(e.jsx)(Ze,{member:Z,deleteMember:ne=>v({roleMemberUuid:ne}),isAdminOrOwner:!!P},Z.id))}):Object(e.jsx)("div",{className:"text-muted mb-2",children:"No members added yet"})]})]})}function Ze(n){let{member:s,deleteMember:o,isAdminOrOwner:i}=n;const{user:a}=s;return Object(e.jsxs)("div",{className:"flex items-center justify-between mt-2 h-8",children:[Object(e.jsx)(A.b,{email:a.email,name:a.first_name,size:"md",showName:!0}),i&&o&&Object(e.jsx)(c.a,{icon:Object(e.jsx)(O.IconDelete,{}),onClick:()=>o(s.id),tooltip:"Remove user from role",status:"primary-alt",type:"tertiary",size:"small"})]})}function He(n){switch(n){case ee.T.FEATURE_FLAGS:return"flag";default:return"resource"}}function re(n){let{isRestricted:s}=n;const{resourceRolesAccess:o,organizationResourcePermissionsLoading:i}=Object(r.useValues)(ve.b),{updatePermission:a}=Object(r.useActions)(ve.b),{roles:d,rolesLoading:h}=Object(r.useValues)(ae.a),{setRoleInFocus:u,openCreateRoleModal:l}=Object(r.useActions)(ae.a),{isAdminOrOwner:S}=Object(r.useValues)(D.a),v=[{key:"role",title:"",width:150,render:function(g,P){return Object(e.jsx)(e.Fragment,{children:P.name=="organization_default"?Object(e.jsx)("b",{children:"All users by default"}):Object(e.jsx)(C.LemonButton,{type:"tertiary",noPadding:!0,onClick:()=>u(P),children:P.name})})}},...o.flatMap(w=>{const g=Object.keys(w)[0];return[{key:"view",title:Object(e.jsx)(q.a,{title:"View defaults cannot be changed",children:Object(e.jsxs)("div",{className:"text-center",children:[g," ",Object(e.jsx)("br",{})," View"]})}),align:"center",render:function(){return Object(e.jsx)("div",{className:"flex justify-center",children:Object(e.jsx)(C.LemonCheckbox,{defaultChecked:!0,disabled:!0,color:"gray"})})}},{key:"edit",title:Object(e.jsx)(Ke.a,{icon:Object(e.jsx)(q.a,{title:`You can extend permissions on a per ${He(g)} basis.`,children:Object(e.jsx)(O.IconInfo,{})}),children:Object(e.jsxs)(e.Fragment,{children:[g," ",Object(e.jsx)("br",{})," Edit"]})}),align:"center",render:function(I,z){return Object(e.jsx)("div",{className:"flex justify-center",children:Object(e.jsx)(C.LemonCheckbox,{onChange:F=>{a(F,z,w[g].id,g)},checked:w[`${g}`][z.name]>=ee.a.WRITE,disabled:!S,color:S?"":"gray"})})}}]})];return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"flex flex-row justify-between items-center mb-4",children:[Object(e.jsx)("div",{className:"text-muted-alt",children:"Edit organizational default permission levels for posthog resources. Use roles to apply permissions to specific sets of users."}),!s&&Object(e.jsx)(C.LemonButton,{type:"primary",onClick:l,"data-attr":"create-role-button",children:"Create role"})]}),Object(e.jsx)(C.LemonTable,{bordered:!0,columns:v,loading:h||i,dataSource:[{name:"organization_default"},...d]}),Object(e.jsx)(Ye,{})]})}try{re.displayName="PermissionsGrid",re.__docgenInfo={description:"",displayName:"PermissionsGrid",props:{isRestricted:{defaultValue:null,description:"",name:"isRestricted",required:!0,type:{name:"boolean"}},restrictionReason:{defaultValue:null,description:"",name:"restrictionReason",required:!0,type:{name:"string | null"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/organization/Settings/Permissions/PermissionsGrid.tsx#PermissionsGrid"]={docgenInfo:re.__docgenInfo,name:"PermissionsGrid",path:"frontend/src/scenes/organization/Settings/Permissions/PermissionsGrid.tsx#PermissionsGrid"})}catch(n){}const Je={component:ye,logic:D.a};let le;(function(n){n.GENERAL="general",n.ROLE_BASED_ACCESS="role_based_access"})(le||(le={}));function Qe(n){let{isRestricted:s}=n;const{currentOrganization:o,currentOrganizationLoading:i}=Object(r.useValues)(D.a),{updateOrganization:a}=Object(r.useActions)(D.a),[d,h]=Object(m.useState)((o==null?void 0:o.name)||"");return Object(e.jsxs)("div",{style:{maxWidth:"40rem"},children:[Object(e.jsx)("h2",{id:"name",className:"subtitle mt-0",children:"Display Name"}),Object(e.jsx)(C.LemonInput,{className:"mb-4",value:d,onChange:h,disabled:s}),Object(e.jsx)(C.LemonButton,{type:"primary",onClick:u=>{u.preventDefault(),a({name:d})},disabled:s||!d||!o||d===o.name,loading:i,children:"Rename Organization"})]})}function Xe(n){let{isRestricted:s}=n;const{currentOrganization:o}=Object(r.useValues)(D.a),{updateOrganization:i}=Object(r.useActions)(D.a);return Object(e.jsxs)("div",{children:[Object(e.jsx)("h2",{id:"notification-preferences",className:"subtitle",children:"Notification Preferences"}),Object(e.jsx)("div",{children:Object(e.jsx)(C.LemonSwitch,{"data-attr":"is-member-join-email-enabled-switch",onChange:a=>{i({is_member_join_email_enabled:a})},checked:!!(o!=null&&o.is_member_join_email_enabled),disabled:s||!o,label:"Email all current members when a new member joins",bordered:!0})})]})}const pe=Object(r.kea)({path:["scenes","organization","Settings","index"],actions:{setTab:n=>({tab:n})},reducers:{tab:[le.GENERAL,{setTab:(n,s)=>{let{tab:o}=s;return o}}]},actionToUrl:()=>({setTab:n=>{let{tab:s}=n;return`${xe.a.organizationSettings()}?tab=${s}`}}),urlToAction:n=>{let{values:s,actions:o}=n;return{[xe.a.organizationSettings()]:(i,a)=>{a.tab&&s.tab!==a.tab&&o.setTab(a.tab)}}}});function ye(){const{user:n}=Object(r.useValues)(G.a),{featureFlags:s}=Object(r.useValues)(ke.a);Object(Ee.a)(location.hash);const{tab:o}=Object(r.useValues)(pe),{setTab:i}=Object(r.useActions)(pe);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)($.a,{title:"Organization Settings",caption:"View and manage your organization here. Build an even better product together."}),Object(e.jsxs)(je.a,{activeKey:o,destroyInactiveTabPane:!0,onChange:a=>i(a),children:[Object(e.jsx)(je.a.TabPane,{tab:"General",children:Object(e.jsxs)("div",{className:"border rounded p-6",children:[Object(e.jsx)(X.a,{Component:Qe,minimumAccessLevel:y.p.Admin}),Object(e.jsx)(C.LemonDivider,{className:"my-6"}),Object(e.jsx)(E,{}),Object(e.jsx)(C.LemonDivider,{className:"my-6"}),n&&Object(e.jsx)(te,{user:n}),Object(e.jsx)(C.LemonDivider,{className:"my-6"}),Object(e.jsx)(X.a,{Component:Be,minimumAccessLevel:y.p.Admin}),Object(e.jsx)(C.LemonDivider,{className:"my-6"}),Object(e.jsx)(X.a,{Component:Xe,minimumAccessLevel:y.p.Admin}),Object(e.jsx)(C.LemonDivider,{className:"my-6"}),Object(e.jsx)(X.a,{Component:ie,minimumAccessLevel:y.p.Owner})]})},"general"),s[y.i.ROLE_BASED_ACCESS]&&Object(e.jsx)(je.a.TabPane,{tab:"Role-based access",children:Object(e.jsx)(Ue.a,{feature:ee.e.ROLE_BASED_ACCESS,children:Object(e.jsx)(X.a,{Component:re,minimumAccessLevel:y.p.Admin})})},"role_based_access")]})]})}}}]);
