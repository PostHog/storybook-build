"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[87287,92746],{"../../frontend/src/scenes/pipeline/NewButton.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{R:()=>NewButton});var _posthog_icons__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.28.1_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/index.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/scenes/urls.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function NewButton(_ref){let{stage,size}=_ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_1__.J,{"data-attr":`new-${stage}`,to:scenes_urls__WEBPACK_IMPORTED_MODULE_2__.j.pipelineNodeNew(stage),type:"primary",icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_0__.IconPlusSmall,{}),size:size,children:["New ",stage]})}},"../../frontend/src/scenes/pipeline/PipelineNode.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PIPELINE_TAB_TO_NODE_STAGE:()=>PIPELINE_TAB_TO_NODE_STAGE,PipelineNode:()=>PipelineNode,scene:()=>scene});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),ActivityLog=__webpack_require__("../../frontend/src/lib/components/ActivityLog/ActivityLog.tsx"),FlaggedFeature=__webpack_require__("../../frontend/src/lib/components/FlaggedFeature.tsx"),NotFound=__webpack_require__("../../frontend/src/lib/components/NotFound/index.tsx"),LemonTabs=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTabs/LemonTabs.tsx"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),HogFunctionMetricsV2=__webpack_require__("../../frontend/src/scenes/hog-functions/metrics/HogFunctionMetricsV2.tsx"),HogFunctionTesting=__webpack_require__("../../frontend/src/scenes/hog-functions/testing/HogFunctionTesting.tsx"),PipelineNodeLogs=__webpack_require__("../../frontend/src/scenes/pipeline/PipelineNodeLogs.tsx"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),types=__webpack_require__("../../frontend/src/types.ts"),BatchExportBackfills=__webpack_require__("../../frontend/src/scenes/data-pipelines/batch-exports/BatchExportBackfills.tsx"),BatchExportRuns=__webpack_require__("../../frontend/src/scenes/data-pipelines/batch-exports/BatchExportRuns.tsx"),HogFunctionLogs=__webpack_require__("../../frontend/src/scenes/hog-functions/logs/HogFunctionLogs.tsx"),HogFunctionMetrics=__webpack_require__("../../frontend/src/scenes/hog-functions/metrics/HogFunctionMetrics.tsx"),BatchExportConfiguration=__webpack_require__("../../frontend/src/scenes/data-pipelines/batch-exports/BatchExportConfiguration.tsx"),HogFunctionConfiguration=__webpack_require__("../../frontend/src/scenes/hog-functions/configuration/HogFunctionConfiguration.tsx"),PipelinePluginConfiguration=__webpack_require__("../../frontend/src/scenes/pipeline/PipelinePluginConfiguration.tsx"),pipelineNodeLogic=__webpack_require__("../../frontend/src/scenes/pipeline/pipelineNodeLogic.tsx"),pipeline_types=__webpack_require__("../../frontend/src/scenes/pipeline/types.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function PipelineNodeConfiguration(){let{node,stage}=(0,index_esm.useValues)(pipelineNodeLogic.y);return stage?(0,jsx_runtime.jsx)("div",{className:"deprecated-space-y-3",children:node.backend===pipeline_types.b.HogFunction?(0,jsx_runtime.jsx)(HogFunctionConfiguration.g,{id:node.id}):node.backend===pipeline_types.b.Plugin?(0,jsx_runtime.jsx)(PipelinePluginConfiguration.s,{stage:stage,pluginConfigId:node.id}):(0,jsx_runtime.jsx)(BatchExportConfiguration.J,{id:node.id.toString()})}):(0,jsx_runtime.jsx)(NotFound.T,{object:"pipeline app stage"})}var PipelineNodeMetrics=__webpack_require__("../../frontend/src/scenes/pipeline/PipelineNodeMetrics.tsx");let PIPELINE_TAB_TO_NODE_STAGE={[types.J9.Transformations]:types.We.Transformation,[types.J9.Destinations]:types.We.Destination,[types.J9.SiteApps]:types.We.SiteApp,[types.J9.ImportApps]:types.We.ImportApp,[types.J9.Sources]:types.We.Source},paramsToProps=_ref=>{let{params:{stage,id}}=_ref,numericId=id&&/^\d+$/.test(id)?parseInt(id):void 0;if(!stage||!id)throw Error("Loaded PipelineNode without either `stage` or `id` passed in");return{stage:PIPELINE_TAB_TO_NODE_STAGE[stage]||null,id:numericId&&!isNaN(numericId)?numericId:id}},scene={component:PipelineNode,logic:pipelineNodeLogic.y,paramsToProps};function PipelineNode(){let params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{stage,id}=paramsToProps({params}),{currentTab,node}=(0,index_esm.useValues)(pipelineNodeLogic.y);if(!stage)return(0,jsx_runtime.jsx)(NotFound.T,{object:"pipeline stage"});let tabToContent={[types.il.Configuration]:(0,jsx_runtime.jsx)(PipelineNodeConfiguration,{}),[types.il.Metrics]:node.backend===pipeline_types.b.HogFunction?(0,jsx_runtime.jsx)(FlaggedFeature.P,{flag:"cdp-app-metrics-new",fallback:(0,jsx_runtime.jsx)(HogFunctionMetrics.k,{id:node.id}),children:(0,jsx_runtime.jsx)(HogFunctionMetricsV2.n,{id:node.id})}):(0,jsx_runtime.jsx)(PipelineNodeMetrics._,{id:id}),[types.il.Logs]:node.backend===pipeline_types.b.HogFunction?(0,jsx_runtime.jsx)(HogFunctionLogs.x,{hogFunctionId:id.toString().substring(4)}):(0,jsx_runtime.jsx)(PipelineNodeLogs.e,{id:id,stage:stage})};return node.backend===pipeline_types.b.BatchExport&&(tabToContent[types.il.Runs]=(0,jsx_runtime.jsx)(BatchExportRuns.t_,{id:node.id}),tabToContent[types.il.Backfills]=(0,jsx_runtime.jsx)(BatchExportBackfills.F,{id:node.id})),node.backend===pipeline_types.b.Plugin&&(tabToContent[types.il.History]=(0,jsx_runtime.jsx)(ActivityLog.DA,{id:id,scope:types.jc.PLUGIN})),node.backend===pipeline_types.b.HogFunction&&(stage===types.We.Destination&&(tabToContent[types.il.Testing]=(0,jsx_runtime.jsx)(HogFunctionTesting.D,{id:node.id})),tabToContent[types.il.History]=(0,jsx_runtime.jsx)(ActivityLog.DA,{id:String(id).startsWith("hog-")?String(id).substring(4):id,scope:types.jc.HOG_FUNCTION})),stage===types.We.SiteApp&&(delete tabToContent[types.il.Logs],delete tabToContent[types.il.Metrics]),(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(LemonTabs.T,{activeKey:currentTab,tabs:Object.entries(tabToContent).map(_ref2=>{let[tab,content]=_ref2;return{label:(0,utils.fm)(tab),key:tab,content:content,link:params.stage?urls.j.pipelineNode(stage,id,tab):void 0}})})})}},"../../frontend/src/scenes/pipeline/PipelineNodeNew.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PipelineNodeNew:()=>PipelineNodeNew,scene:()=>scene});var lib_components_NotFound__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../frontend/src/lib/components/NotFound/index.tsx"),lib_components_PayGateMini_PayGateMini__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/src/lib/components/PayGateMini/PayGateMini.tsx"),lib_hooks_useFeatureFlag__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/hooks/useFeatureFlag.ts"),scenes_data_pipelines_batch_exports_BatchExportConfiguration__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/scenes/data-pipelines/batch-exports/BatchExportConfiguration.tsx"),scenes_data_warehouse_new_NewSourceWizard__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/scenes/data-warehouse/new/NewSourceWizard.tsx"),scenes_hog_functions_configuration_HogFunctionConfiguration__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/scenes/hog-functions/configuration/HogFunctionConfiguration.tsx"),_types__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/types.ts"),_PipelineNode__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/scenes/pipeline/PipelineNode.tsx"),_PipelinePluginConfiguration__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../frontend/src/scenes/pipeline/PipelinePluginConfiguration.tsx"),_destinations_NewDestinations__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../frontend/src/scenes/pipeline/destinations/NewDestinations.tsx"),_destinations_constants__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("../../frontend/src/scenes/pipeline/destinations/constants.ts"),_pipelineNodeNewLogic__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../frontend/src/scenes/pipeline/pipelineNodeNewLogic.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let paramsToProps=_ref=>{let{params:{stage,id}={},searchParams:{kind}={}}=_ref,numericId=id&&/^\d+$/.test(id)?parseInt(id):void 0,pluginId=numericId&&!isNaN(numericId)?numericId:null,hogFunctionId=pluginId?null:id?.startsWith("hog-")?id.slice(4):null,batchExportDestination=hogFunctionId?null:null!=id?id:null;return{stage:_PipelineNode__WEBPACK_IMPORTED_MODULE_7__.PIPELINE_TAB_TO_NODE_STAGE[stage+"s"]||null,pluginId,batchExportDestination,hogFunctionId,kind:null!=kind?kind:null}},scene={component:PipelineNodeNew,logic:_pipelineNodeNewLogic__WEBPACK_IMPORTED_MODULE_10__.Q,paramsToProps};function PipelineNodeNew(){let params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{stage,pluginId,batchExportDestination,hogFunctionId}=paramsToProps({params}),hasNewPricing=!!(0,lib_hooks_useFeatureFlag__WEBPACK_IMPORTED_MODULE_2__.y)("CDP_NEW_PRICING");if(!stage)return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(lib_components_NotFound__WEBPACK_IMPORTED_MODULE_0__.T,{object:"pipeline app stage"});if(pluginId){let res=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_PipelinePluginConfiguration__WEBPACK_IMPORTED_MODULE_8__.s,{stage:stage,pluginId:pluginId});return stage===_types__WEBPACK_IMPORTED_MODULE_6__.We.Destination?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(lib_components_PayGateMini_PayGateMini__WEBPACK_IMPORTED_MODULE_1__.E,{feature:_types__WEBPACK_IMPORTED_MODULE_6__.P$.DATA_PIPELINES,children:res}):res}return batchExportDestination?stage!==_types__WEBPACK_IMPORTED_MODULE_6__.We.Destination?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(lib_components_NotFound__WEBPACK_IMPORTED_MODULE_0__.T,{object:batchExportDestination}):hasNewPricing?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(scenes_data_pipelines_batch_exports_BatchExportConfiguration__WEBPACK_IMPORTED_MODULE_3__.J,{service:batchExportDestination}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(lib_components_PayGateMini_PayGateMini__WEBPACK_IMPORTED_MODULE_1__.E,{feature:_types__WEBPACK_IMPORTED_MODULE_6__.P$.DATA_PIPELINES,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(scenes_data_pipelines_batch_exports_BatchExportConfiguration__WEBPACK_IMPORTED_MODULE_3__.J,{service:batchExportDestination})}):hogFunctionId?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(scenes_hog_functions_configuration_HogFunctionConfiguration__WEBPACK_IMPORTED_MODULE_5__.g,{templateId:hogFunctionId}):stage===_types__WEBPACK_IMPORTED_MODULE_6__.We.Transformation?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_destinations_NewDestinations__WEBPACK_IMPORTED_MODULE_9__.n,{types:["transformation"]}):stage===_types__WEBPACK_IMPORTED_MODULE_6__.We.Destination?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_destinations_NewDestinations__WEBPACK_IMPORTED_MODULE_9__.n,{types:_destinations_constants__WEBPACK_IMPORTED_MODULE_12__.SO}):stage===_types__WEBPACK_IMPORTED_MODULE_6__.We.SiteApp?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_destinations_NewDestinations__WEBPACK_IMPORTED_MODULE_9__.n,{types:_destinations_constants__WEBPACK_IMPORTED_MODULE_12__.hz}):stage===_types__WEBPACK_IMPORTED_MODULE_6__.We.Source?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(scenes_data_warehouse_new_NewSourceWizard__WEBPACK_IMPORTED_MODULE_4__.NewSourceWizardScene,{}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(lib_components_NotFound__WEBPACK_IMPORTED_MODULE_0__.T,{object:"pipeline new options"})}},"../../frontend/src/scenes/pipeline/destinations/DestinationsFilters.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{B:()=>DestinationsFilters});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),scenes_pipeline_NewButton__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/scenes/pipeline/NewButton.tsx"),_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/types.ts"),_types__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/scenes/pipeline/types.ts"),_destinationsFiltersLogic__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/scenes/pipeline/destinations/destinationsFiltersLogic.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function DestinationsFilters(_ref){var _filters$search,_filters$kind;let{types,hideSearch,hideShowPaused,hideKind,hideFeedback,hideAddDestinationButton=!0}=_ref,{filters}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)((0,_destinationsFiltersLogic__WEBPACK_IMPORTED_MODULE_5__.T)({types})),{setFilters,openFeedbackDialog}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)((0,_destinationsFiltersLogic__WEBPACK_IMPORTED_MODULE_5__.T)({types})),isTransformationsOnly=types.includes("transformation");return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"deprecated-space-y-2",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"flex items-center gap-2",children:[!hideSearch&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.DF,{type:"search",placeholder:"Search...",value:null!==(_filters$search=filters.search)&&void 0!==_filters$search?_filters$search:"",onChange:e=>setFilters({search:e})}),hideFeedback?null:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.rU,{className:"text-sm font-semibold",subtle:!0,onClick:()=>openFeedbackDialog(),children:"Can't find what you're looking for?"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"flex-1"}),"boolean"!=typeof hideShowPaused&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Hw,{label:"Show paused",bordered:!0,size:"small",checked:filters.showPaused,onChange:e=>setFilters({showPaused:null!=e?e:void 0})}),!hideKind&&!isTransformationsOnly&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Yv,{type:"secondary",size:"small",options:[{label:"All kinds",value:null},{label:"Realtime",value:_types__WEBPACK_IMPORTED_MODULE_4__.b.HogFunction},{label:"Batch exports",value:_types__WEBPACK_IMPORTED_MODULE_4__.b.BatchExport}].filter(Boolean),value:null!==(_filters$kind=filters.kind)&&void 0!==_filters$kind?_filters$kind:null,onChange:e=>setFilters({kind:null!=e?e:null})}),hideAddDestinationButton?null:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(scenes_pipeline_NewButton__WEBPACK_IMPORTED_MODULE_2__.R,{stage:isTransformationsOnly?_types__WEBPACK_IMPORTED_MODULE_3__.We.Transformation:_types__WEBPACK_IMPORTED_MODULE_3__.We.Destination,size:"small"})]})})}},"../../frontend/src/scenes/pipeline/destinations/NewDestinations.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{h:()=>DestinationOptionsTable,n:()=>NewDestinations});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.28.1_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),PayGateButton=__webpack_require__("../../frontend/src/lib/components/PayGateMini/PayGateButton.tsx"),PayGateMini=__webpack_require__("../../frontend/src/lib/components/PayGateMini/PayGateMini.tsx"),useFeatureFlag=__webpack_require__("../../frontend/src/lib/hooks/useFeatureFlag.ts"),LemonTableLink=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/LemonTableLink.tsx"),userLogic=__webpack_require__("../../frontend/src/scenes/userLogic.ts"),sidePanelStateLogic=__webpack_require__("../../frontend/src/layout/navigation-3000/sidepanel/sidePanelStateLogic.tsx"),src_types=__webpack_require__("../../frontend/src/types.ts"),pipelineAccessLogic=__webpack_require__("../../frontend/src/scenes/pipeline/pipelineAccessLogic.tsx"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function DestinationTag(_ref){let{status}=_ref;switch(status){case"alpha":return(0,jsx_runtime.jsx)(src.oe,{type:"danger",children:"Experimental"});case"beta":return(0,jsx_runtime.jsx)(src.oe,{type:"completion",children:"Beta"});case"stable":return null;case"coming_soon":return(0,jsx_runtime.jsx)(src.oe,{type:"muted",children:"Roadmap"});case"hidden":return(0,jsx_runtime.jsx)(src.oe,{type:"muted",children:"Hidden"});default:return status?(0,jsx_runtime.jsx)(src.oe,{type:"highlight",children:(0,utils.fm)(status)}):null}}var DestinationsFilters=__webpack_require__("../../frontend/src/scenes/pipeline/destinations/DestinationsFilters.tsx"),destinationsFiltersLogic=__webpack_require__("../../frontend/src/scenes/pipeline/destinations/destinationsFiltersLogic.tsx"),fuse_esm=__webpack_require__("../../node_modules/.pnpm/fuse.js@6.6.2/node_modules/fuse.js/dist/fuse.esm.js"),lib=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.7_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),kea_router_lib=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),api=__webpack_require__("../../frontend/src/lib/api.ts"),constants=__webpack_require__("../../frontend/src/lib/constants.tsx"),featureFlagLogic=__webpack_require__("../../frontend/src/lib/logic/featureFlagLogic.ts"),BatchExportIcon=__webpack_require__("../../frontend/src/scenes/data-pipelines/batch-exports/BatchExportIcon.tsx"),HogFunctionIcon=__webpack_require__("../../frontend/src/scenes/hog-functions/configuration/HogFunctionIcon.tsx"),hogFunctionTemplateListLogic=__webpack_require__("../../frontend/src/scenes/hog-functions/list/hogFunctionTemplateListLogic.tsx"),urls=__webpack_require__("../../frontend/src/scenes/hog-functions/misc/urls.ts"),scenes_urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),batch_exports_utils=__webpack_require__("../../frontend/src/scenes/data-pipelines/batch-exports/utils.ts"),types=__webpack_require__("../../frontend/src/scenes/pipeline/types.ts");let getDestinationDocPath=url=>url.split("/").pop()?.replace("hog-","")||"",newDestinationsLogic=(0,index_esm.kea)([(0,index_esm.path)(()=>["scenes","pipeline","destinations","newDestinationsLogic"]),(0,index_esm.props)({}),(0,index_esm.key)(props=>{var _props$types$join;return null!==(_props$types$join=props.types.join(","))&&void 0!==_props$types$join?_props$types$join:""}),(0,index_esm.connect)(_ref=>{let{types}=_ref;return{values:[userLogic.userLogic,["user"],featureFlagLogic.featureFlagLogic,["featureFlags"],(0,destinationsFiltersLogic.T)({types}),["filters"]]}}),(0,index_esm.actions)({openFeedbackDialog:!0}),(0,lib.loaders)(_ref2=>{let{props}=_ref2;return{hogFunctionTemplates:[{},{loadHogFunctionTemplates:async()=>(await api.ZP.hogFunctions.listTemplates({types:props.types})).results.reduce((acc,template)=>(acc[template.id]=template,acc),{})}]}}),(0,index_esm.selectors)(()=>({loading:[s=>[s.hogFunctionTemplatesLoading],hogFunctionTemplatesLoading=>hogFunctionTemplatesLoading],types:[()=>[(_,p)=>p.types],types=>types],batchExportServiceNames:[s=>[s.user,s.featureFlags,s.types],(user,featureFlags,types)=>{if(!types.includes("destination"))return[];let httpEnabled=featureFlags[constants.y8.BATCH_EXPORTS_POSTHOG_HTTP]||user?.is_impersonated||user?.is_staff;return src_types.e2.filter(service=>!!httpEnabled||"HTTP"!==service)}],destinations:[s=>[s.hogFunctionTemplates,s.batchExportServiceNames,kea_router_lib.router.selectors.hashParams,s.user],(hogFunctionTemplates,batchExportServiceNames,hashParams,user)=>[...Object.values(hogFunctionTemplates).filter(hogFunction=>(0,hogFunctionTemplateListLogic.I)(hogFunction,user)).map(hogFunction=>({icon:(0,jsx_runtime.jsx)(HogFunctionIcon._,{size:"small",src:hogFunction.icon_url}),name:hogFunction.name,description:"string"==typeof hogFunction.description?hogFunction.description:"",backend:types.b.HogFunction,url:(0,kea_router_lib.combineUrl)(scenes_urls.j.pipelineNodeNew((0,urls.R)(hogFunction.type),{id:`hog-${hogFunction.id}`}),{},hashParams).url,status:hogFunction.status,free:hogFunction.free})),...batchExportServiceNames.map(service=>({icon:(0,jsx_runtime.jsx)(BatchExportIcon.oe,{type:service}),name:(0,batch_exports_utils.x)(service),description:`${service} batch export`,backend:types.b.BatchExport,url:scenes_urls.j.pipelineNodeNew(src_types.We.Destination,{id:service}),free:!1}))]],destinationsFuse:[s=>[s.destinations],destinations=>new fuse_esm.Z(destinations||[],{keys:["name","description"],threshold:.3})],filteredDestinations:[s=>[s.filters,s.destinations,s.destinationsFuse],(filters,destinations,destinationsFuse)=>{let{search,kind}=filters;return(search?destinationsFuse.search(search).map(x=>x.item):destinations).filter(dest=>!kind||dest.backend===kind)}],hiddenDestinations:[s=>[s.destinations,s.filteredDestinations],(destinations,filteredDestinations)=>destinations.filter(dest=>!filteredDestinations.includes(dest))]})),(0,index_esm.afterMount)(_ref3=>{let{actions}=_ref3;actions.loadHogFunctionTemplates()})]);function NewDestinations(_ref){let{types}=_ref,hasNewPricing=!!(0,useFeatureFlag.y)("CDP_NEW_PRICING");return(0,jsx_runtime.jsxs)("div",{className:"deprecated-space-y-2",children:[types.includes("destination")&&!hasNewPricing?(0,jsx_runtime.jsx)(PayGateMini.E,{feature:src_types.P$.DATA_PIPELINES}):null,(0,jsx_runtime.jsx)(DestinationsFilters.B,{types:types,hideShowPaused:!0}),(0,jsx_runtime.jsx)(DestinationOptionsTable,{types:types})]})}function DestinationOptionsTable(_ref2){let{types}=_ref2,{loading,filteredDestinations,hiddenDestinations}=(0,index_esm.useValues)(newDestinationsLogic({types})),{canEnableDestination}=(0,index_esm.useValues)(pipelineAccessLogic.g),{resetFilters}=(0,index_esm.useActions)((0,destinationsFiltersLogic.T)({types})),{filters}=(0,index_esm.useValues)((0,destinationsFiltersLogic.T)({types})),{user}=(0,index_esm.useValues)(userLogic.userLogic),{openSidePanel}=(0,index_esm.useActions)(sidePanelStateLogic.f),visibleDestinations=filteredDestinations.filter(destination=>{var _filters$search$lengt;return"coming_soon"!==destination.status||(null!==(_filters$search$lengt=filters.search?.length)&&void 0!==_filters$search$lengt?_filters$search$lengt:0)>0});return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(src.g3,{dataSource:visibleDestinations,size:"small",loading:loading,columns:[{title:"App",width:0,render:(_,target)=>target.icon},{title:"Name",sticky:!0,key:"name",sorter:(a,b)=>a.name.localeCompare(b.name),render:function RenderName(_,target){return"coming_soon"===target.status?(0,jsx_runtime.jsx)(LemonTableLink.i,{onClick:()=>openSidePanel(src_types.H$.Docs,`https://posthog.com/docs/cdp/destinations/${getDestinationDocPath(target.url)}`),title:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[target.name,target.status&&(0,jsx_runtime.jsx)(DestinationTag,{status:target.status})]}),description:target.description}):(0,jsx_runtime.jsx)(LemonTableLink.i,{to:canEnableDestination(target)?target.url:void 0,title:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[target.name,target.status&&(0,jsx_runtime.jsx)(DestinationTag,{status:target.status})]}),description:target.description})}},{width:100,align:"right",render:function RenderActions(_,target){return"coming_soon"===target.status?(0,jsx_runtime.jsx)(src.Jp,{type:"primary","data-attr":`request-${src_types.We.Destination}`,icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconMegaphone,{}),className:"whitespace-nowrap",onClick:()=>openSidePanel(src_types.H$.Docs,`https://posthog.com/docs/cdp/destinations/${getDestinationDocPath(target.url)}`),children:"Notify me"}):canEnableDestination(target)?(0,jsx_runtime.jsx)(src.Jp,{type:"primary","data-attr":`new-${src_types.We.Destination}`,icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconPlusSmall,{}),to:target.url,children:"Create"}):(0,jsx_runtime.jsxs)("span",{className:"flex gap-2 items-center whitespace-nowrap",children:[(0,jsx_runtime.jsx)(PayGateButton.R,{feature:src_types.P$.DATA_PIPELINES,type:"secondary"}),user?.is_impersonated&&(0,jsx_runtime.jsx)(src.Jp,{type:"primary",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconPlusSmall,{}),tooltip:"Staff users can create destinations as an override",to:target.url})]})}}]}),hiddenDestinations.length>0&&(0,jsx_runtime.jsxs)("div",{className:"text-secondary",children:[hiddenDestinations.length," hidden. ",(0,jsx_runtime.jsx)(src.rU,{onClick:()=>resetFilters(),children:"Show all"})]})]})}}}]);