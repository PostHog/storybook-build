(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{5764:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return dashboardsLogic}));__webpack_require__(63),__webpack_require__(1192),__webpack_require__(1193),__webpack_require__(62);var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(8),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__),kea__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_models_dashboardsModel__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(86),kea_router__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(21),lib_utils__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(11),scenes_urls__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(28),dashboardsLogic=Object(kea__WEBPACK_IMPORTED_MODULE_5__.kea)({actions:{addNewDashboard:!0,setNewDashboardDrawer:function setNewDashboardDrawer(shown){return{shown:shown}}},reducers:{newDashboardDrawer:[!1,{setNewDashboardDrawer:function setNewDashboardDrawer(_,_ref){return _ref.shown}}]},selectors:{dashboards:[function(){return[_models_dashboardsModel__WEBPACK_IMPORTED_MODULE_6__.a.selectors.nameSortedDashboards]},function(dashboards){return dashboards.filter((function(d){return!d.deleted})).sort((function(a,b){var _a$name,_b$name;return(null!==(_a$name=a.name)&&void 0!==_a$name?_a$name:"Untitled").localeCompare(null!==(_b$name=b.name)&&void 0!==_b$name?_b$name:"Untitled")}))}],dashboardTags:[function(){return[_models_dashboardsModel__WEBPACK_IMPORTED_MODULE_6__.a.selectors.nameSortedDashboards]},function(dashboards){return Object(lib_utils__WEBPACK_IMPORTED_MODULE_8__.sb)(dashboards.flatMap((function(_ref2){return _ref2.tags})),(function(item){return item})).sort()}]},listeners:function listeners(){return _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4___default()({},_models_dashboardsModel__WEBPACK_IMPORTED_MODULE_6__.a.actionTypes.addDashboardSuccess,(function(_ref3){var dashboard=_ref3.dashboard;kea_router__WEBPACK_IMPORTED_MODULE_7__.router.actions.push(scenes_urls__WEBPACK_IMPORTED_MODULE_9__.a.dashboard(dashboard.id))}))},urlToAction:function urlToAction(_ref5){var actions=_ref5.actions;return{"/dashboard":function dashboard(_,_ref6){void 0!==_ref6.new&&actions.setNewDashboardDrawer(!0)}}},path:function path(){return["scenes","dashboard","dashboardsLogic"]}})},5839:function(module,exports,__webpack_require__){(exports=__webpack_require__(51)(!1)).push([module.i,'.bg-mid{background-color:#f2f2f2!important}.mixin-base-bordered-card{border-radius:4px;box-shadow:0 4px 10px rgba(0,0,0,.04)}.mixin-gradient-overlay{width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent)}.mixin-gradient-overlay,.mixin-gradient-overlay-right{content:"";position:absolute;pointer-events:none;bottom:0}.mixin-gradient-overlay-right{width:3rem;height:100%;background:linear-gradient(270deg,#fff,transparent)}.text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.description{margin-bottom:16px}.description .ant-card-body{padding:0}.description div:hover{cursor:text}.description .edit-box{display:flex;justify-content:space-between;align-items:center;-moz-column-gap:8px;column-gap:8px;padding:8px 16px}.description .add-description{color:#9c9797}',""]),module.exports=exports},5848:function(module,exports,__webpack_require__){(exports=__webpack_require__(51)(!1)).push([module.i,'.bg-mid{background-color:#f2f2f2!important}.mixin-base-bordered-card{border-radius:4px;box-shadow:0 4px 10px rgba(0,0,0,.04)}.dashboard .empty-state .fade-out-graphs:after,.mixin-gradient-overlay{content:"";width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent);position:absolute;pointer-events:none;bottom:0}.mixin-gradient-overlay-right{content:"";width:3rem;height:100%;background:linear-gradient(270deg,#fff,transparent);position:absolute;pointer-events:none;bottom:0}.dashboard-header .dashboard-select,.text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.dashboard{margin-top:32px}.dashboard .dashboard-items-actions{margin-bottom:16px;display:flex}.dashboard .dashboard-items-actions .left-item{flex-grow:1}.dashboard .dashboard-items-actions .left-item .dashboard-items-action-icon{margin-right:6px}.dashboard .dashboard-items-actions .left-item .dashboard-items-action-refresh-text{visibility:visible}.dashboard .dashboard-items-actions .left-item .dashboard-items-action-refresh-text.hidden{visibility:hidden}.dashboard .dashboard-items-actions .left-item .dashboard-items-action-refresh-text.completed{position:absolute;left:30px}.dashboard .dashboard-items-actions .right-item .ant-btn{padding-left:4px!important}.dashboard .empty-state{position:relative}.dashboard .empty-state .skeleton-actions{text-align:right}.dashboard .empty-state .skeleton-actions .ant-skeleton-avatar{margin-right:8px}.dashboard .empty-state .pie-chart{height:200px;width:200px;max-width:100%;margin-top:16px}@media(max-width:992px){.dashboard .empty-state .pie-chart{height:140px;width:140px}}.dashboard .empty-state .bar-chart{display:flex;margin-top:16px;align-items:flex-end}.dashboard .empty-state .bar-chart .bar-el{background-color:hsla(0,0%,74.5%,.2);border-radius:4px;width:12.5%;margin-left:4px;height:100px}.dashboard .empty-state .ant-col{flex-grow:1}.dashboard .empty-state .ant-col .ant-card{height:100%}.dashboard .empty-state .fade-out-graphs{margin-top:16px;height:150px;overflow:hidden;position:relative}.dashboard .empty-state .fade-out-graphs:after{width:calc(100% - 16px);left:8px;height:150px}.dashboard .empty-state .cta{width:360px;max-width:calc(100% - 32px);position:absolute;top:16px;left:50%;transform:translateX(-50%);z-index:488}.dashboard-header{display:flex;justify-content:space-between;margin-top:-1rem;margin-bottom:16px;width:100%}.dashboard-header.full-screen{margin-top:1rem}.dashboard-header .dashboard-select{flex:1;padding-right:32px}.dashboard-header .dashboard-select .ant-select-single{max-width:100%;line-height:32px}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector{padding-left:0;padding-right:8px;line-height:32px;height:32px}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector .ant-select-selection-item{font-size:32px;line-height:32px;width:100%;height:35px;display:block}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector .ant-select-selection-item .anticon-share-alt{font-size:20.8px;color:#77b96c;margin-left:6px!important;margin-right:4px;margin-top:8px}.dashboard-header .dashboard-select .ant-select-single.ant-select-open .ant-select-arrow{color:rgba(45,45,45,.4)}.dashboard-header .dashboard-select .ant-select-single .ant-select-arrow{color:#2d2d2d;font-size:16px}.dashboard-header .dashboard-meta{white-space:nowrap;display:flex;align-items:center}.dashboard-header .dashboard-meta .ant-btn{margin-left:10px}.dashboard-header .dashboard-meta .ant-btn .anticon{vertical-align:baseline}.dashboard-header .dashboard-meta .ant-btn.button-box{padding:4px 8px}@media(max-width:768px){.dashboard-header{flex-direction:column}.dashboard-header .dashboard-meta{padding-top:16px;justify-content:flex-end}}#auto-refresh-check{padding:5px 12px;cursor:pointer}',""]),module.exports=exports},5906:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene})),__webpack_require__.d(__webpack_exports__,"Dashboard",(function(){return Dashboard_Dashboard}));var react=__webpack_require__(0),react_default=__webpack_require__.n(react),utils=__webpack_require__(11),index_esm=__webpack_require__(2),dashboardLogic=__webpack_require__(1795),slicedToArray=(__webpack_require__(63),__webpack_require__(90),__webpack_require__(36),__webpack_require__(62),__webpack_require__(110),__webpack_require__(15)),slicedToArray_default=__webpack_require__.n(slicedToArray),dropdown=__webpack_require__(864),menu=__webpack_require__(320),es_button=__webpack_require__(106),input=__webpack_require__(709),es_select=__webpack_require__(208),dashboardsModel=__webpack_require__(86),modal=__webpack_require__(1190),es_switch=__webpack_require__(5616),CopyToClipboard=__webpack_require__(609);function ShareModal(_ref){var visible=_ref.visible,onCancel=_ref.onCancel,dashboard=Object(index_esm.useValues)(dashboardLogic.a).dashboard,setIsSharedDashboard=Object(index_esm.useActions)(dashboardLogic.a).setIsSharedDashboard,_useState=Object(react.useState)(null==dashboard?void 0:dashboard.is_shared),_useState2=slicedToArray_default()(_useState,2),isShared=_useState2[0],setIsShared=_useState2[1],url=window.location.origin;return dashboard?react_default.a.createElement(modal.a,{visible:visible,onCancel:onCancel,footer:react_default.a.createElement(es_button.a,{onClick:onCancel},"Close"),title:"Share your dashboard with people outside of PostHog.",destroyOnClose:!0},react_default.a.createElement(es_switch.a,{onClick:function onClick(_,e){return e.stopPropagation()},checked:isShared,"data-attr":"share-dashboard-switch",onChange:function onChange(active){setIsShared(active),setIsSharedDashboard(dashboard.id,active)}})," ","Share your dashboard",react_default.a.createElement("br",null),react_default.a.createElement("br",null),isShared?react_default.a.createElement("span",null,"Your dashboard is visible to everyone with the link.",dashboard.share_token&&react_default.a.createElement(CopyToClipboard.b,{"data-attr":"share-dashboard-link",value:url+"/shared_dashboard/"+dashboard.share_token,description:"link"})):"Your dashboard is private."):react_default.a.createElement("div",null)}try{ShareModal.displayName="ShareModal",ShareModal.__docgenInfo={description:"",displayName:"ShareModal",props:{visible:{defaultValue:null,description:"",name:"visible",required:!0,type:{name:"boolean"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/ShareModal.tsx#ShareModal"]={docgenInfo:ShareModal.__docgenInfo,name:"ShareModal",path:"frontend/src/scenes/dashboard/ShareModal.tsx#ShareModal"})}catch(__react_docgen_typescript_loader_error){}var EditOutlined=__webpack_require__(2616),FullscreenOutlined=__webpack_require__(6132),PushpinFilled=__webpack_require__(5660),PushpinOutlined=__webpack_require__(5908),CopyOutlined=__webpack_require__(869),DeleteOutlined=__webpack_require__(5630),EllipsisOutlined=__webpack_require__(1175),PlusOutlined=__webpack_require__(1792),ShareAltOutlined=__webpack_require__(6133),FullscreenExitOutlined=__webpack_require__(6134);function FullScreen(_ref){var onExit=_ref.onExit,selector="aside.ant-layout-sider, .layout-top-content";return Object(react.useEffect)((function(){for(var myClasses=window.document.querySelectorAll(selector),i=0;i<myClasses.length;i++)myClasses[i].style.display="none";var handler=function handler(){null===window.document.fullscreenElement&&(null==onExit||onExit())};try{window.document.body.requestFullscreen().then((function(){window.addEventListener("fullscreenchange",handler,!1)}))}catch(_unused){}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch(_unused2){}return function(){for(var elements=window.document.querySelectorAll(selector),_i=0;_i<elements.length;_i++)elements[_i].style.display="block";try{window.removeEventListener("fullscreenchange",handler,!1),null!==window.document.fullscreenElement&&window.document.exitFullscreen()}catch(_unused3){}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch(_unused4){}}}),[]),null}try{FullScreen.displayName="FullScreen",FullScreen.__docgenInfo={description:"",displayName:"FullScreen",props:{onExit:{defaultValue:null,description:"",name:"onExit",required:!1,type:{name:"(() => any)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/FullScreen.tsx#FullScreen"]={docgenInfo:FullScreen.__docgenInfo,name:"FullScreen",path:"frontend/src/lib/components/FullScreen.tsx#FullScreen"})}catch(__react_docgen_typescript_loader_error){}var dayjs_min=__webpack_require__(30),dayjs_min_default=__webpack_require__.n(dayjs_min),types=__webpack_require__(6),eventUsageLogic=__webpack_require__(35),HotkeyButton=__webpack_require__(1825),lib=__webpack_require__(21),ObjectTags=__webpack_require__(874),dashboardsLogic=__webpack_require__(5764),urls=__webpack_require__(28),card=(__webpack_require__(322),__webpack_require__(357),__webpack_require__(5650)),injectStylesIntoStyleTag=__webpack_require__(22),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),Description=__webpack_require__(5839),Description_default=__webpack_require__.n(Description),options={insert:"head",singleton:!1};injectStylesIntoStyleTag_default()(Description_default.a,options),Description_default.a.locals;function Description_Description_Description(_ref){var item=_ref.item,itemMode=_ref.itemMode,setItemMode=_ref.setItemMode,triggerItemUpdate=_ref.triggerItemUpdate,descriptionInputRef=_ref.descriptionInputRef,_useState=Object(react.useState)(item.description),_useState2=slicedToArray_default()(_useState,2),newDescription=_useState2[0],setNewDescription=_useState2[1];return react_default.a.createElement(card.a,{className:"description",bordered:!(itemMode===types.n.Edit)},itemMode===types.n.Edit?react_default.a.createElement(input.a.TextArea,{placeholder:"Add a description that helps others understand it better.",value:newDescription,onChange:function onChange(e){setNewDescription(e.target.value),triggerItemUpdate({description:e.target.value})},onKeyDown:function onKeyDown(e){"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&setItemMode(null,eventUsageLogic.a.InputEnter)},ref:descriptionInputRef,tabIndex:5,allowClear:!0}):react_default.a.createElement("div",{className:"edit-box",onClick:function onClick(){return setItemMode(types.n.Edit,eventUsageLogic.a.AddDescription)}},item.description?react_default.a.createElement("span",null,item.description):react_default.a.createElement("span",{className:"add-description"},"Add a description..."),react_default.a.createElement(EditOutlined.a,null)))}try{Description_Description_Description.displayName="Description",Description_Description_Description.__docgenInfo={description:"",displayName:"Description",props:{item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"Partial<DashboardItemType>"}},itemMode:{defaultValue:null,description:"",name:"itemMode",required:!0,type:{name:"DashboardMode | ItemMode | null"}},setItemMode:{defaultValue:null,description:"",name:"setItemMode",required:!0,type:{name:"((mode: ItemMode | null, eventSource: DashboardEventSource) => void) | ((mode: DashboardMode | null, eventSource: DashboardEventSource) => void)"}},triggerItemUpdate:{defaultValue:null,description:"",name:"triggerItemUpdate",required:!0,type:{name:"(description: Partial<DashboardItemType>) => void"}},descriptionInputRef:{defaultValue:null,description:"",name:"descriptionInputRef",required:!0,type:{name:"Ref<TextAreaRef> | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Description/Description.tsx#Description"]={docgenInfo:Description_Description_Description.__docgenInfo,name:"Description",path:"frontend/src/lib/components/Description/Description.tsx#Description"})}catch(__react_docgen_typescript_loader_error){}var userLogic=__webpack_require__(70),Tooltip=__webpack_require__(56);function DashboardHeader(){var _user$organization,_user$organization$av,_useValues=Object(index_esm.useValues)(dashboardLogic.a),dashboard=_useValues.dashboard,dashboardMode=_useValues.dashboardMode,lastDashboardModeSource=_useValues.lastDashboardModeSource,_useActions=Object(index_esm.useActions)(dashboardLogic.a),addNewDashboard=_useActions.addNewDashboard,triggerDashboardUpdate=_useActions.triggerDashboardUpdate,setDashboardMode=_useActions.setDashboardMode,addGraph=_useActions.addGraph,saveNewTag=_useActions.saveNewTag,deleteTag=_useActions.deleteTag,dashboardTags=Object(index_esm.useValues)(dashboardsLogic.a).dashboardTags,_useValues3=Object(index_esm.useValues)(dashboardsModel.a),nameSortedDashboards=_useValues3.nameSortedDashboards,dashboardsLoading=_useValues3.dashboardsLoading,dashboardLoading=_useValues3.dashboardLoading,_useActions2=Object(index_esm.useActions)(dashboardsModel.a),pinDashboard=_useActions2.pinDashboard,unpinDashboard=_useActions2.unpinDashboard,deleteDashboard=_useActions2.deleteDashboard,duplicateDashboard=_useActions2.duplicateDashboard,user=Object(index_esm.useValues)(userLogic.a).user,_useState=Object(react.useState)((null==dashboard?void 0:dashboard.name)||null),_useState2=slicedToArray_default()(_useState,2),newName=_useState2[0],setNewName=_useState2[1],nameInputRef=Object(react.useRef)(null),descriptionInputRef=Object(react.useRef)(null);if(!dashboard)return react_default.a.createElement("div",null);var actionsDefault=react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(dropdown.a,{trigger:["click"],overlay:react_default.a.createElement(menu.a,null,dashboard.created_by&&react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(menu.a.Item,{disabled:!0},"Created by ",dashboard.created_by.first_name||dashboard.created_by.email||"-"," on"," ",dayjs_min_default()(dashboard.created_at).format(dayjs_min_default()(dashboard.created_at).year()===dayjs_min_default()().year()?"MMMM Do":"MMMM Do YYYY")),react_default.a.createElement(menu.a.Divider,null)),react_default.a.createElement(menu.a.Item,{icon:react_default.a.createElement(EditOutlined.a,null),onClick:function onClick(){return setDashboardMode(types.e.Edit,eventUsageLogic.a.MoreDropdown)}},"Edit mode (E)"),react_default.a.createElement(menu.a.Item,{icon:react_default.a.createElement(FullscreenOutlined.a,null),onClick:function onClick(){return setDashboardMode(types.e.Fullscreen,eventUsageLogic.a.MoreDropdown)}},"Full screen mode (F)"),dashboard.pinned?react_default.a.createElement(menu.a.Item,{icon:react_default.a.createElement(PushpinFilled.a,null),onClick:function onClick(){return unpinDashboard(dashboard.id,eventUsageLogic.a.MoreDropdown)}},"Unpin dashboard"):react_default.a.createElement(menu.a.Item,{icon:react_default.a.createElement(PushpinOutlined.a,null),onClick:function onClick(){return pinDashboard(dashboard.id,eventUsageLogic.a.MoreDropdown)}},"Pin dashboard"),react_default.a.createElement(menu.a.Divider,null),react_default.a.createElement(menu.a.Item,{icon:react_default.a.createElement(CopyOutlined.a,null),onClick:function onClick(){return duplicateDashboard({id:dashboard.id,name:dashboard.name,show:!0})}},"Duplicate dashboard"),react_default.a.createElement(menu.a.Item,{icon:react_default.a.createElement(DeleteOutlined.a,null),onClick:function onClick(){return deleteDashboard({id:dashboard.id,redirect:!0})},danger:!0},"Delete dashboard")),placement:"bottomRight"},react_default.a.createElement(es_button.a,{type:"link",className:"btn-lg-2x","data-attr":"dashboard-more",icon:react_default.a.createElement(EllipsisOutlined.a,null)})),react_default.a.createElement(es_button.a,{type:"link","data-attr":"dashboard-edit-mode",icon:react_default.a.createElement(EditOutlined.a,null),onClick:function onClick(){return setDashboardMode(types.e.Edit,eventUsageLogic.a.DashboardHeader)}}),react_default.a.createElement(HotkeyButton.a,{onClick:function onClick(){return addGraph()},"data-attr":"dashboard-add-graph-header",icon:react_default.a.createElement(PlusOutlined.a,null),hotkey:"n",className:"hide-lte-md"},"Add graph"),react_default.a.createElement(HotkeyButton.a,{type:"primary",onClick:function onClick(){return setDashboardMode(types.e.Sharing,eventUsageLogic.a.DashboardHeader)},"data-attr":"dashboard-share-button",icon:react_default.a.createElement(ShareAltOutlined.a,null),hotkey:"k"},"Send or share")),actionsPresentationMode=react_default.a.createElement(es_button.a,{onClick:function onClick(){return setDashboardMode(null,eventUsageLogic.a.DashboardHeader)},"data-attr":"dashboard-exit-presentation-mode",icon:react_default.a.createElement(FullscreenExitOutlined.a,null)},"Exit full screen mode"),actionsEditMode=react_default.a.createElement(es_button.a,{"data-attr":"dashboard-edit-mode-save",type:"primary",onClick:function onClick(){return setDashboardMode(null,eventUsageLogic.a.DashboardHeader)},tabIndex:10},"Finish editing");return Object(react.useEffect)((function(){dashboardMode===types.e.Edit&&(lastDashboardModeSource===eventUsageLogic.a.AddDescription?setTimeout((function(){var _descriptionInputRef$;return null===(_descriptionInputRef$=descriptionInputRef.current)||void 0===_descriptionInputRef$?void 0:_descriptionInputRef$.focus()}),10):Object(utils.O)()||setTimeout((function(){var _nameInputRef$current;return null===(_nameInputRef$current=nameInputRef.current)||void 0===_nameInputRef$current?void 0:_nameInputRef$current.focus()}),10))}),[dashboardMode]),react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("div",{className:"dashboard-header".concat(dashboardMode===types.e.Fullscreen?" full-screen":"")},dashboardMode===types.e.Fullscreen&&react_default.a.createElement(FullScreen,{onExit:function onExit(){return setDashboardMode(null,eventUsageLogic.a.Browser)}}),react_default.a.createElement(ShareModal,{onCancel:function onCancel(){return setDashboardMode(null,eventUsageLogic.a.Browser)},visible:dashboardMode===types.e.Sharing}),dashboardsLoading?react_default.a.createElement(utils.c,null):react_default.a.createElement(react_default.a.Fragment,null,dashboardMode===types.e.Edit?react_default.a.createElement(input.a,{placeholder:"Dashboard name (e.g. Weekly KPIs)",value:newName||"",size:"large",style:{maxWidth:400},onChange:function onChange(e){setNewName(e.target.value),triggerDashboardUpdate({name:e.target.value})},onKeyDown:function onKeyDown(e){"Enter"===e.key&&setDashboardMode(null,eventUsageLogic.a.InputEnter)},ref:nameInputRef,tabIndex:0}):react_default.a.createElement("div",{className:"dashboard-select"},react_default.a.createElement(es_select.a,{value:(null==dashboard?void 0:dashboard.id)||void 0,onChange:function onChange(id){"new"===id?addNewDashboard():(lib.router.actions.push(urls.a.dashboard(id)),eventUsageLogic.e.actions.reportDashboardDropdownNavigation())},bordered:!1,dropdownMatchSelectWidth:!1},nameSortedDashboards.map((function(dash){return react_default.a.createElement(es_select.a.Option,{key:dash.id,value:dash.id},dash.name||react_default.a.createElement("span",{style:{color:"var(--muted)"}},"Untitled"),dash.is_shared&&react_default.a.createElement(Tooltip.a,{title:"This dashboard is publicly shared"},react_default.a.createElement(ShareAltOutlined.a,{style:{marginLeft:4,float:"right"}})))})),react_default.a.createElement(es_select.a.Option,{value:"new"},"+ New Dashboard"))),react_default.a.createElement("div",{className:"dashboard-meta"},dashboardMode===types.e.Edit?actionsEditMode:dashboardMode===types.e.Fullscreen?actionsPresentationMode:actionsDefault))),(null==user||null===(_user$organization=user.organization)||void 0===_user$organization||null===(_user$organization$av=_user$organization.available_features)||void 0===_user$organization$av?void 0:_user$organization$av.includes(types.c.DASHBOARD_COLLABORATION))&&react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("div",{className:"mb","data-attr":"dashboard-tags"},react_default.a.createElement(ObjectTags.a,{tags:dashboard.tags,onTagSave:saveNewTag,onTagDelete:deleteTag,saving:dashboardLoading,tagsAvailable:dashboardTags.filter((function(tag){return!dashboard.tags.includes(tag)}))})),react_default.a.createElement(Description_Description_Description,{item:dashboard,setItemMode:setDashboardMode,itemMode:dashboardMode,triggerItemUpdate:triggerDashboardUpdate,descriptionInputRef:descriptionInputRef})))}__webpack_require__(151),__webpack_require__(41),__webpack_require__(37),__webpack_require__(82),__webpack_require__(112),__webpack_require__(100),__webpack_require__(294),__webpack_require__(44),__webpack_require__(532),__webpack_require__(2653);var react_grid_layout=__webpack_require__(5840),DashboardItem=__webpack_require__(594),dashboardItemsModel=__webpack_require__(289),clsx_m=__webpack_require__(92),ReactGridLayout=Object(react_grid_layout.WidthProvider)(react_grid_layout.Responsive);function DashboardItems_DashboardItems(){var _useValues=Object(index_esm.useValues)(dashboardLogic.a),dashboard=_useValues.dashboard,items=_useValues.items,layouts=_useValues.layouts,layoutForItem=_useValues.layoutForItem,breakpoints=_useValues.breakpoints,cols=_useValues.cols,dashboardMode=_useValues.dashboardMode,isRefreshing=_useValues.isRefreshing,_useActions=Object(index_esm.useActions)(dashboardLogic.a),loadDashboardItems=_useActions.loadDashboardItems,updateLayouts=_useActions.updateLayouts,updateContainerWidth=_useActions.updateContainerWidth,updateItemColor=_useActions.updateItemColor,setDashboardMode=_useActions.setDashboardMode,setDiveDashboard=_useActions.setDiveDashboard,refreshAllDashboardItems=_useActions.refreshAllDashboardItems,duplicateDashboardItem=Object(index_esm.useActions)(dashboardItemsModel.a).duplicateDashboardItem;Object(react.useEffect)((function(){return Object(utils.rb)()}),[]);var _useState=Object(react.useState)(null),_useState2=slicedToArray_default()(_useState,2),resizingItem=_useState2[0],setResizingItem=_useState2[1],isDragging=Object(react.useRef)(!1),dragEndTimeout=Object(react.useRef)(null),className=Object(clsx_m.default)({"dashboard-view-mode":dashboardMode!==types.e.Edit,"dashboard-edit-mode":dashboardMode===types.e.Edit,wobbly:dashboardMode===types.e.Edit&&Object(utils.O)()});return react_default.a.createElement(ReactGridLayout,{className:className,isDraggable:dashboardMode===types.e.Edit,isResizable:dashboardMode===types.e.Edit,layouts:layouts,rowHeight:50,margin:[20,20],containerPadding:[0,0],onLayoutChange:function onLayoutChange(_,newLayouts){updateLayouts(newLayouts),Object(utils.qb)()},onWidthChange:function onWidthChange(containerWidth,_,newCols){updateContainerWidth(containerWidth,newCols)},measureBeforeMount:!0,breakpoints:breakpoints,resizeHandles:["s","e","se"],cols:cols,onResize:function onResize(_layout,_oldItem,newItem){resizingItem&&resizingItem.w===newItem.w&&resizingItem.h===newItem.h||setResizingItem(newItem);var item=null==items?void 0:items.find((function(i){return i.id===parseInt(newItem.i)}));"FunnelViz"===(null==item?void 0:item.filters.display)&&Object(utils.qb)()},onResizeStop:function onResizeStop(){setResizingItem(null),Object(utils.rb)()},onDrag:function onDrag(){isDragging.current=!0,dragEndTimeout.current&&window.clearTimeout(dragEndTimeout.current)},onDragStop:function onDragStop(){dragEndTimeout.current&&window.clearTimeout(dragEndTimeout.current),dragEndTimeout.current=window.setTimeout((function(){isDragging.current=!1}),250)},draggableCancel:".anticon,.ant-dropdown,table,.ant-popover-content"},null==items?void 0:items.map((function(item,index){var _resizingItem$i;return react_default.a.createElement("div",{key:item.id,className:"dashboard-item-wrapper"},react_default.a.createElement(DashboardItem.a,{key:item.id,doNotLoad:!0,dashboardId:null==dashboard?void 0:dashboard.id,item:item,layout:(null==resizingItem||null===(_resizingItem$i=resizingItem.i)||void 0===_resizingItem$i?void 0:_resizingItem$i.toString())===item.id.toString()?resizingItem:layoutForItem[item.id],isReloading:isRefreshing(item.id),reload:function reload(){return refreshAllDashboardItems([item])},loadDashboardItems:loadDashboardItems,setDiveDashboard:setDiveDashboard,duplicateDashboardItem:duplicateDashboardItem,moveDashboardItem:function moveDashboardItem(it,dashboardId){return duplicateDashboardItem(it,dashboardId,!0)},updateItemColor:updateItemColor,isDraggingRef:isDragging,dashboardMode:dashboardMode,isHighlighted:item.id===parseInt(new URLSearchParams(window.location.search).get("dive_source_id")||"0"),isOnEditMode:dashboardMode===types.e.Edit,setEditMode:function setEditMode(){return setDashboardMode(types.e.Edit,eventUsageLogic.a.LongPress)},index:index}))})))}var DateFilter=__webpack_require__(513),CalendarOutlined=__webpack_require__(5625),Dashboard=__webpack_require__(5848),Dashboard_default=__webpack_require__.n(Dashboard),Dashboard_options={insert:"head",singleton:!1},useKeyboardHotkeys=(injectStylesIntoStyleTag_default()(Dashboard_default.a,Dashboard_options),Dashboard_default.a.locals,__webpack_require__(839)),TimezoneAware=__webpack_require__(468),row=(__webpack_require__(1818),__webpack_require__(356)),col=__webpack_require__(230),skeleton=__webpack_require__(1187);function SkeletonOne(){return react_default.a.createElement(card.a,{className:"hide-lte-lg"},react_default.a.createElement(row.a,null,react_default.a.createElement(col.a,{span:12},react_default.a.createElement(skeleton.a,{paragraph:{rows:1}}),react_default.a.createElement("div",{className:"mt"},react_default.a.createElement("div",{className:"mt"},react_default.a.createElement(skeleton.a.Button,null),react_default.a.createElement(skeleton.a.Button,{style:{marginLeft:4,width:140}})),react_default.a.createElement("div",{className:"mt"},react_default.a.createElement(skeleton.a.Button,null),react_default.a.createElement(skeleton.a.Button,{style:{marginLeft:4,width:140}})),react_default.a.createElement("div",{className:"mt"},react_default.a.createElement(skeleton.a.Button,null),react_default.a.createElement(skeleton.a.Button,{style:{marginLeft:4,width:140}})))),react_default.a.createElement(col.a,{span:12},react_default.a.createElement("div",{className:"skeleton-actions"},react_default.a.createElement(skeleton.a.Avatar,{shape:"circle",size:"small"}),react_default.a.createElement(skeleton.a.Avatar,{shape:"circle",size:"small"})),react_default.a.createElement(skeleton.a.Avatar,{shape:"circle",size:"large",className:"pie-chart"}))))}function SkeletonTwo(){return react_default.a.createElement(card.a,null,react_default.a.createElement(row.a,null,react_default.a.createElement(col.a,{span:12},react_default.a.createElement(skeleton.a,{paragraph:{rows:1}})),react_default.a.createElement(col.a,{span:12},react_default.a.createElement("div",{className:"skeleton-actions"},react_default.a.createElement(skeleton.a.Avatar,{shape:"circle",size:"small"}),react_default.a.createElement(skeleton.a.Avatar,{shape:"circle",size:"small"})))),react_default.a.createElement("div",{className:"bar-chart"},Array(8).fill(0).map((function(_,index){var height=Math.floor(161*Math.random())+40;return react_default.a.createElement("div",{className:"bar-el",key:index,style:{height:height}})}))))}function EmptyDashboardComponent(){var addGraph=Object(index_esm.useActions)(dashboardLogic.a).addGraph;return react_default.a.createElement("div",{className:"empty-state"},react_default.a.createElement("div",{className:"cta"},react_default.a.createElement(card.a,{className:"card-elevated"},react_default.a.createElement("h3",{className:"l3"},"Dashboard empty"),react_default.a.createElement("p",null,"This dashboard sure would look better with some graphs!"),react_default.a.createElement("div",{className:"mt text-center"},react_default.a.createElement(HotkeyButton.a,{onClick:function onClick(){return addGraph()},"data-attr":"dashboard-add-graph-header",icon:react_default.a.createElement(PlusOutlined.a,null),hotkey:"n"},"Add graph")))),react_default.a.createElement(row.a,{gutter:16},react_default.a.createElement(col.a,{span:24,lg:12},react_default.a.createElement(SkeletonOne,null)),react_default.a.createElement(col.a,{span:24,lg:12},react_default.a.createElement(SkeletonTwo,null))),react_default.a.createElement(row.a,{gutter:16,className:"fade-out-graphs"},react_default.a.createElement(col.a,{span:24,lg:12},react_default.a.createElement(SkeletonOne,null)),react_default.a.createElement(col.a,{span:24,lg:12},react_default.a.createElement(SkeletonTwo,null))))}var NotFound=__webpack_require__(1681),toConsumableArray=(__webpack_require__(188),__webpack_require__(18)),toConsumableArray_default=__webpack_require__.n(toConsumableArray),es_checkbox=__webpack_require__(863),es_radio=__webpack_require__(1167),space=__webpack_require__(5654),DownOutlined=__webpack_require__(595),LoadingOutlined=__webpack_require__(374),ReloadOutlined=__webpack_require__(5658),DashboardReloadAction_LastRefreshText=function LastRefreshText(){var lastRefreshed=Object(index_esm.useValues)(dashboardLogic.a).lastRefreshed;return react_default.a.createElement(react_default.a.Fragment,null,"Last updated ",react_default.a.createElement("b",null,lastRefreshed?dayjs_min_default()(lastRefreshed).fromNow():"a while ago"))},intervalOptions=toConsumableArray_default()(Array.from([60,120,300,900],(function(v){return{label:Object(utils.I)(v),value:v}})));function DashboardReloadAction(){var _useValues2=Object(index_esm.useValues)(dashboardLogic.a),itemsLoading=_useValues2.itemsLoading,autoRefresh=_useValues2.autoRefresh,refreshMetrics=_useValues2.refreshMetrics,_useActions=Object(index_esm.useActions)(dashboardLogic.a),refreshAllDashboardItemsManual=_useActions.refreshAllDashboardItemsManual,setAutoRefresh=_useActions.setAutoRefresh,_useState=Object(react.useState)(!1),_useState2=slicedToArray_default()(_useState,2),open=_useState2[0],setOpen=_useState2[1];return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(dropdown.a.Button,{overlay:react_default.a.createElement(menu.a,{"data-attr":"auto-refresh-picker",id:"auto-refresh-picker"},react_default.a.createElement("div",{id:"auto-refresh-check",key:"auto-refresh-check",onClick:function onClick(e){e.stopPropagation(),setOpen(!0),setAutoRefresh(!autoRefresh.enabled,autoRefresh.interval)}},react_default.a.createElement(Tooltip.a,{title:"Refresh dashboard automatically",placement:"bottomLeft"},react_default.a.createElement(es_checkbox.a,{onChange:function onChange(e){e.stopPropagation(),e.preventDefault()},checked:autoRefresh.enabled}),react_default.a.createElement("label",{style:{marginLeft:10,cursor:"pointer"}},"Auto refresh"))),react_default.a.createElement(menu.a.Divider,null),react_default.a.createElement(menu.a.ItemGroup,{title:"Refresh interval"},react_default.a.createElement(es_radio.a.Group,{onChange:function onChange(e){setAutoRefresh(!0,parseInt(e.target.value))},value:autoRefresh.interval,style:{width:"100%"}},react_default.a.createElement(space.b,{direction:"vertical",style:{width:"100%"}},intervalOptions.map((function(_ref){var label=_ref.label,value=_ref.value;return react_default.a.createElement(es_radio.a,{key:value,value:value,style:{width:"100%"}},label)})))))),trigger:["click"],onClick:function onClick(){return refreshAllDashboardItemsManual()},icon:react_default.a.createElement(DownOutlined.a,null),disabled:itemsLoading,buttonsRender:function buttonsRender(_ref2){var _ref3=slicedToArray_default()(_ref2,2),leftButton=_ref3[0],rightButton=_ref3[1];return[react_default.a.cloneElement(leftButton,{style:{paddingLeft:10}}),rightButton]},visible:open,onVisibleChange:function onVisibleChange(toOpen){return setOpen(toOpen)}},react_default.a.createElement("span",{className:"dashboard-items-action-icon"},itemsLoading?react_default.a.createElement(LoadingOutlined.a,null):react_default.a.createElement(ReloadOutlined.a,null)),react_default.a.createElement("span",{className:Object(clsx_m.default)("dashboard-items-action-refresh-text",{hidden:itemsLoading})},react_default.a.createElement(DashboardReloadAction_LastRefreshText,null)),react_default.a.createElement("span",{className:Object(clsx_m.default)("dashboard-items-action-refresh-text","completed",{hidden:!itemsLoading})},"Refreshed ",refreshMetrics.completed," out of ",refreshMetrics.total)))}var scene={component:Dashboard_Dashboard,logic:dashboardLogic.a,paramsToProps:function paramsToProps(_ref){var id=_ref.params.id;return{id:parseInt(id)}}};function Dashboard_Dashboard(){var _ref2=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},id=_ref2.id,shareToken=_ref2.shareToken,internal=_ref2.internal;return react_default.a.createElement(index_esm.BindLogic,{logic:dashboardLogic.a,props:{id:id?parseInt(id):void 0,shareToken:shareToken,internal:internal}},react_default.a.createElement(DashboardView,null))}function DashboardView(){var _dashboardFilters$dat,_dashboardFilters$dat2,_useValues=Object(index_esm.useValues)(dashboardLogic.a),dashboard=_useValues.dashboard,loadingFirstTime=_useValues.allItemsLoading,items=_useValues.items,dashboardFilters=_useValues.filters,dashboardMode=_useValues.dashboardMode,dashboardsLoading=Object(index_esm.useValues)(dashboardsModel.a).dashboardsLoading,_useActions=Object(index_esm.useActions)(dashboardLogic.a),setDashboardMode=_useActions.setDashboardMode,addGraph=_useActions.addGraph,setDates=_useActions.setDates;return Object(useKeyboardHotkeys.b)(dashboardMode===types.e.Public||dashboardMode===types.e.Internal?{}:{e:{action:function action(){return setDashboardMode(dashboardMode===types.e.Edit?null:types.e.Edit,eventUsageLogic.a.Hotkey)},disabled:null!==dashboardMode&&dashboardMode!==types.e.Edit},f:{action:function action(){return setDashboardMode(dashboardMode===types.e.Fullscreen?null:types.e.Fullscreen,eventUsageLogic.a.Hotkey)},disabled:null!==dashboardMode&&dashboardMode!==types.e.Fullscreen},k:{action:function action(){return setDashboardMode(dashboardMode===types.e.Sharing?null:types.e.Sharing,eventUsageLogic.a.Hotkey)},disabled:null!==dashboardMode&&dashboardMode!==types.e.Sharing},n:{action:function action(){return addGraph()},disabled:null!==dashboardMode&&dashboardMode!==types.e.Edit},escape:{action:function action(){return setDashboardMode(null,eventUsageLogic.a.Hotkey)},disabled:dashboardMode!==types.e.Edit}},[setDashboardMode,dashboardMode]),dashboardsLoading||loadingFirstTime?react_default.a.createElement(utils.d,null):dashboard?react_default.a.createElement("div",{className:"dashboard"},dashboardMode!==types.e.Public&&dashboardMode!==types.e.Internal&&react_default.a.createElement(DashboardHeader,null),items&&items.length?react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"dashboard-items-actions"},react_default.a.createElement("div",{className:"left-item"},dashboardMode===types.e.Public?react_default.a.createElement(DashboardReloadAction_LastRefreshText,null):react_default.a.createElement(DashboardReloadAction,null)),dashboardMode!==types.e.Public&&react_default.a.createElement("div",{className:"right-item",style:{display:"flex",alignItems:"center",justifyContent:"flex-end"}},react_default.a.createElement(TimezoneAware.a,{style:{marginRight:8,fontWeight:"bold"}}),react_default.a.createElement(DateFilter.a,{defaultValue:"Custom",showCustom:!0,dateFrom:null!==(_dashboardFilters$dat=null==dashboardFilters?void 0:dashboardFilters.date_from)&&void 0!==_dashboardFilters$dat?_dashboardFilters$dat:void 0,dateTo:null!==(_dashboardFilters$dat2=null==dashboardFilters?void 0:dashboardFilters.date_to)&&void 0!==_dashboardFilters$dat2?_dashboardFilters$dat2:void 0,onChange:setDates,makeLabel:function makeLabel(key){return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(CalendarOutlined.a,null),react_default.a.createElement("span",{className:"hide-when-small"}," ",key))}}))),react_default.a.createElement(DashboardItems_DashboardItems,null)):react_default.a.createElement(EmptyDashboardComponent,null)):react_default.a.createElement(NotFound.a,{object:"dashboard"})}try{Dashboard_Dashboard.displayName="Dashboard",Dashboard_Dashboard.__docgenInfo={description:"",displayName:"Dashboard",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},shareToken:{defaultValue:null,description:"",name:"shareToken",required:!1,type:{name:"string"}},internal:{defaultValue:null,description:"",name:"internal",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/Dashboard.tsx#Dashboard"]={docgenInfo:Dashboard_Dashboard.__docgenInfo,name:"Dashboard",path:"frontend/src/scenes/dashboard/Dashboard.tsx#Dashboard"})}catch(__react_docgen_typescript_loader_error){}}}]);