(window.webpackJsonp=window.webpackJsonp||[]).push([[238],{"./frontend/src/lib/components/Table/utils.tsx":function(Y,O,e){"use strict";e.d(O,"a",function(){return E});var v=e("./node_modules/react/index.js"),K=e.n(v),T=e("./frontend/src/lib/hooks/useWindowSize.js"),U=e("./frontend/src/lib/utils/responsiveUtils.tsx");function E(f){return K.a.createElement("span",{style:{whiteSpace:"nowrap"}},f)}var L=function(p){var C=Object(T.a)(),t=C.width,m=Object(U.b)(p),P=!!t&&t<=m;return{isTableScrolling:P,tableScrollBreakpoint:m,tableScrollX:P?"max-content":"".concat(m,"px")}};try{E.displayName="normalizeColumnTitle",E.__docgenInfo={description:"",displayName:"normalizeColumnTitle",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Table/utils.tsx#normalizeColumnTitle"]={docgenInfo:E.__docgenInfo,name:"normalizeColumnTitle",path:"frontend/src/lib/components/Table/utils.tsx#normalizeColumnTitle"})}catch(f){}try{L.displayName="useIsTableScrolling",L.__docgenInfo={description:"",displayName:"useIsTableScrolling",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Table/utils.tsx#useIsTableScrolling"]={docgenInfo:L.__docgenInfo,name:"useIsTableScrolling",path:"frontend/src/lib/components/Table/utils.tsx#useIsTableScrolling"})}catch(f){}},"./frontend/src/scenes/feature-flags/FeatureFlags.tsx":function(Y,O,e){"use strict";e.r(O),e.d(O,"scene",function(){return G}),e.d(O,"FeatureFlags",function(){return B});var v=e("./node_modules/core-js/modules/es.array.includes.js"),K=e.n(v),T=e("./node_modules/core-js/modules/es.array.some.js"),U=e.n(T),E=e("./node_modules/core-js/modules/es.function.name.js"),L=e.n(E),f=e("./node_modules/core-js/modules/es.number.constructor.js"),p=e.n(f),C=e("./node_modules/react/index.js"),t=e.n(C),m=e("./node_modules/kea/lib/index.esm.js"),P=e("./frontend/src/scenes/feature-flags/featureFlagsLogic.ts"),b=e("./node_modules/antd/es/input/index.js"),$=e("./frontend/src/lib/components/Link.tsx"),j=e("./frontend/src/lib/utils.tsx"),H=e("./node_modules/@ant-design/icons/es/icons/PlusOutlined.js"),F=e("./frontend/src/lib/components/PageHeader.tsx"),J=e("./frontend/src/lib/components/LinkButton.tsx"),S=e("./frontend/src/lib/components/Table/utils.tsx"),D=e("./frontend/src/scenes/urls.ts"),x=e("./frontend/src/lib/utils/stringWithWBR.tsx"),M=e("./frontend/src/scenes/teamLogic.tsx"),g=e("./frontend/src/lib/components/LemonButton/index.ts"),X=e("./frontend/src/lib/components/LemonRow/index.ts"),N=e("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),R=e("./frontend/src/lib/components/LemonTable/index.ts"),z=e("./frontend/src/lib/components/LemonButton/More.tsx"),h=e("./frontend/src/lib/components/LemonTable/columnUtils.tsx"),A=e("./frontend/src/lib/components/PropertyFilters/components/PropertyFiltersDisplay.tsx"),G={component:B,logic:P.a};function B(){var s=Object(m.useValues)(M.a),r=s.currentTeamId,n=Object(m.useValues)(P.a),o=n.featureFlagsLoading,l=n.searchedFeatureFlags,_=n.searchTerm,u=Object(m.useActions)(P.a),y=u.updateFeatureFlag,i=u.loadFeatureFlags,I=u.setSearchTerm,Q=[{title:Object(S.a)("Key"),dataIndex:"key",className:"ph-no-capture",sticky:!0,width:"40%",sorter:function(d,a){return(d.key||"").localeCompare(a.key||"")},render:function(d,a){return t.a.createElement(t.a.Fragment,null,t.a.createElement($.a,{to:a.id?D.a.featureFlag(a.id):void 0,className:"row-name"},Object(x.a)(a.key,17)),a.name&&t.a.createElement("span",{className:"row-description"},a.name))}},Object(h.b)(),Object(h.a)(),{title:"Rollout",width:200,render:function(d,a){return V(a.filters.groups)}},{title:"Status",dataIndex:"active",sorter:function(d,a){return Number(d.active)-Number(a.active)},width:100,render:function(d,a){var W="feature-flag-".concat(a.id,"-switch");return t.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},t.a.createElement("label",{htmlFor:W},a.active?"Enabled":"Disabled"),t.a.createElement(N.a,{id:W,checked:a.active,onChange:function(Z){return a.id?y({id:a.id,payload:{active:Z}}):null},style:{marginLeft:"0.5rem"}}))}},{width:0,render:function(d,a){return t.a.createElement(z.a,{overlay:t.a.createElement(t.a.Fragment,null,t.a.createElement(g.a,{type:"stealth",onClick:function(){Object(j.r)(a.key,"feature flag key")},fullWidth:!0},"Copy key"),a.id&&t.a.createElement(g.a,{type:"stealth",to:D.a.featureFlag(a.id),fullWidth:!0},"Edit"),t.a.createElement(g.a,{type:"stealth",to:D.a.insightNew({events:[{id:"$pageview",name:"$pageview",type:"events",math:"dau"}],breakdown_type:"event",breakdown:"$feature/".concat(a.key)}),"data-attr":"usage",fullWidth:!0},"Try out in Insights"),t.a.createElement(X.b,null),a.id&&t.a.createElement(g.a,{type:"stealth",style:{color:"var(--danger)"},onClick:function(){Object(j.v)({endpoint:"projects/".concat(r,"/feature_flags"),object:{name:a.name,id:a.id},callback:i})},fullWidth:!0},"Delete feature flag"))})}}];return t.a.createElement("div",{className:"feature_flags"},t.a.createElement(F.a,{title:"Feature Flags",caption:"Feature Flags are a way of turning functionality in your app on or off, based on user properties."}),t.a.createElement("div",null,t.a.createElement(b.a.Search,{placeholder:"Search for feature flags",allowClear:!0,enterButton:!0,style:{maxWidth:400,width:"initial",flexGrow:1},value:_,onChange:function(d){I(d.target.value)}}),t.a.createElement("div",{className:"mb float-right"},t.a.createElement(J.a,{type:"primary",to:D.a.featureFlag("new"),"data-attr":"new-feature-flag",icon:t.a.createElement(H.a,null)},"New Feature Flag"))),t.a.createElement(R.a,{dataSource:l,columns:Q,rowKey:"key",loading:o,defaultSorting:{columnKey:"key",order:1},pagination:{pageSize:100},nouns:["feature flag","feature flags"],"data-attr":"feature-flag-table"}))}function V(s){if(s.length===0||!s.some(function(_){return _.rollout_percentage!==0}))return"No users";if(s.some(function(_){var u;return!(!((u=_.properties)===null||u===void 0)&&u.length)&&[null,void 0,100].includes(_.rollout_percentage)}))return"All users";if(s.length===1){var r=s[0],n=r.properties,o=r.rollout_percentage,l=o===void 0?null:o;return(n==null?void 0:n.length)>0&&l!=null?t.a.createElement("div",{style:{display:"flex",alignItems:"center"}},t.a.createElement("span",{style:{flexShrink:0,marginRight:5}},l,"% of"),t.a.createElement(A.a,{filters:n,style:{margin:0,width:"100%"}})):(n==null?void 0:n.length)>0?t.a.createElement(A.a,{filters:n,style:{margin:0}}):l!==null?"".concat(l,"% of all users"):(console.error("A group with full rollout was not detected early"),"All users")}return"".concat(s.length," groups")}},"./frontend/src/scenes/feature-flags/featureFlagsLogic.ts":function(Y,O,e){"use strict";e.d(O,"a",function(){return V});var v=e("./node_modules/core-js/modules/es.array.concat.js"),K=e.n(v),T=e("./node_modules/core-js/modules/es.array.filter.js"),U=e.n(T),E=e("./node_modules/core-js/modules/es.array.find.js"),L=e.n(E),f=e("./node_modules/core-js/modules/es.array.iterator.js"),p=e.n(f),C=e("./node_modules/core-js/modules/es.array.map.js"),t=e.n(C),m=e("./node_modules/core-js/modules/es.object.to-string.js"),P=e.n(m),b=e("./node_modules/core-js/modules/es.regexp.exec.js"),$=e.n(b),j=e("./node_modules/core-js/modules/es.string.search.js"),H=e.n(j),F=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),J=e.n(F),S=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),D=e.n(S),x=e("./node_modules/@babel/runtime/regenerator/index.js"),M=e.n(x),g=e("./node_modules/regenerator-runtime/runtime.js"),X=e.n(g),N=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),R=e.n(N),z=e("./node_modules/kea/lib/index.esm.js"),h=e("./frontend/src/lib/api.ts"),A=e("./node_modules/fuse.js/dist/fuse.esm.js"),G=e("./frontend/src/scenes/teamLogic.tsx"),B=e("./frontend/src/scenes/urls.ts"),V=Object(z.kea)({path:["scenes","feature-flags","featureFlagsLogic"],connect:{values:[G.a,["currentTeamId"]]},actions:{updateFlag:function(r){return{flag:r}},deleteFlag:function(r){return{id:r}},setSearchTerm:function(r){return{searchTerm:r}}},loaders:function(r){var n=r.values;return{featureFlags:{__default:[],loadFeatureFlags:function(){var o=R()(M.a.mark(function _(){var u;return M.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,h.a.get("api/projects/".concat(n.currentTeamId,"/feature_flags/"));case 2:return u=i.sent,i.abrupt("return",u.results);case 4:case"end":return i.stop()}},_)}));function l(){return o.apply(this,arguments)}return l}(),updateFeatureFlag:function(){var o=R()(M.a.mark(function _(u){var y,i,I;return M.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return y=u.id,i=u.payload,c.next=3,h.a.update("api/projects/".concat(n.currentTeamId,"/feature_flags/").concat(y),i);case 3:return I=c.sent,c.abrupt("return",D()(n.featureFlags).map(function(d){return d.id===I.id?I:d}));case 5:case"end":return c.stop()}},_)}));function l(_){return o.apply(this,arguments)}return l}()}}},selectors:{searchedFeatureFlags:[function(s){return[s.featureFlags,s.searchTerm]},function(s,r){return r?new A.a(s,{keys:["key","name"],threshold:.3}).search(r).map(function(n){return n.item}):s}],breadcrumbs:[function(){return[]},function(){return[{name:"Feature Flags",path:B.a.featureFlags()}]}]},reducers:{searchTerm:{setSearchTerm:function(r,n){var o=n.searchTerm;return o}},featureFlags:{updateFlag:function(r,n){var o=n.flag;return r.find(function(l){var _=l.id;return _===o.id})?r.map(function(l){return l.id===o.id?o:l}):[o].concat(D()(r))},deleteFlag:function(r,n){var o=n.id;return r.filter(function(l){return l.id!==o})}}},events:function(r){var n=r.actions;return{afterMount:function(){n.loadFeatureFlags()}}}})}}]);
