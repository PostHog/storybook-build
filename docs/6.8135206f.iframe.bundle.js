(window.webpackJsonp=window.webpackJsonp||[]).push([[6,8,10,309],{"./frontend/src/scenes/apps/AppMetricsGraph.scss":function(T,c,e){"use strict";e.r(c);var O=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),p=e.n(O),m=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/apps/AppMetricsGraph.scss"),i=e.n(m),M={};M.insert="head",M.singleton=!1;var j=p()(i.a,M);c.default=i.a.locals||{}},"./frontend/src/scenes/apps/AppMetricsGraph.tsx":function(T,c,e){"use strict";e.r(c),e.d(c,"AppMetricsGraph",function(){return A});var O=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),p=e.n(O),m=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),i=e.n(m),M=e("./node_modules/core-js/modules/es.array.concat.js"),j=e.n(M),R=e("./node_modules/core-js/modules/es.object.keys.js"),V=e.n(R),B=e("./node_modules/core-js/modules/es.symbol.js"),J=e.n(B),K=e("./node_modules/core-js/modules/es.array.filter.js"),Y=e.n(K),U=e("./node_modules/core-js/modules/es.object.to-string.js"),Z=e.n(U),W=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),z=e.n(W),x=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Q=e.n(x),S=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),X=e.n(S),b=e("./node_modules/react/index.js"),w=e.n(b),G=e("./frontend/src/lib/colors.ts"),F=e("./node_modules/chart.js/dist/chart.mjs"),f=e("./frontend/src/scenes/apps/constants.tsx"),L=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),k=e("./frontend/src/scenes/apps/AppMetricsGraph.scss"),g=e("./frontend/src/lib/utils.tsx"),D=e("./node_modules/react/jsx-runtime.js"),I=e.n(D);function C(l,u){var s=Object.keys(l);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(l);u&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(l,r).enumerable})),s.push.apply(s,t)}return s}function h(l){for(var u=1;u<arguments.length;u++){var s=arguments[u]!=null?arguments[u]:{};u%2?C(Object(s),!0).forEach(function(t){p()(l,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(s)):C(Object(s)).forEach(function(t){Object.defineProperty(l,t,Object.getOwnPropertyDescriptor(s,t))})}return l}function A(l){var u=l.tab,s=l.metrics,t=l.metricsLoading,r=Object(b.useRef)(null),o=f.DescriptionColumns[u];return Object(b.useEffect)(function(){var n;if(r.current&&s){var _;n=new F.a((_=r.current)===null||_===void 0?void 0:_.getContext("2d"),{type:"line",data:{labels:s.dates,datasets:[h({label:o.successes,data:s.successes,borderColor:""},d("data-brand-blue"))].concat(i()(o.successes_on_retry?[h({label:o.successes_on_retry,data:s.successes_on_retry},d("data-yellow"))]:[]),[h({label:o.failures,data:s.failures},d("data-pink"))])},options:{scales:{x:{ticks:{maxRotation:0},grid:{display:!1}},y:{beginAtZero:!0}},plugins:{crosshair:!1,legend:{display:!1}},maintainAspectRatio:!1,interaction:{mode:"index",axis:"x",intersect:!1}}})}return function(){var a;(a=n)===null||a===void 0||a.destroy()}},[s]),t||!s?Object(D.jsx)(L.a,{className:"AppMetricsGraph"}):Object(D.jsx)("div",{className:"AppMetricsGraph",children:Object(D.jsx)("canvas",{ref:r})})}function d(l){var u=Object(G.b)(l);return{borderColor:u,hoverBorderColor:Object(g.lb)(u,-20),hoverBackgroundColor:Object(g.lb)(u,-20),backgroundColor:u,fill:!1,borderWidth:2,pointRadius:0}}try{A.displayName="AppMetricsGraph",A.__docgenInfo={description:"",displayName:"AppMetricsGraph",props:{tab:{defaultValue:null,description:"",name:"tab",required:!0,type:{name:"enum",value:[{value:'"processEvent"'},{value:'"onEvent"'},{value:'"exportEvents"'},{value:'"historical_exports"'}]}},metrics:{defaultValue:null,description:"",name:"metrics",required:!1,type:{name:"AppMetrics | null"}},metricsLoading:{defaultValue:null,description:"",name:"metricsLoading",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/apps/AppMetricsGraph.tsx#AppMetricsGraph"]={docgenInfo:A.__docgenInfo,name:"AppMetricsGraph",path:"frontend/src/scenes/apps/AppMetricsGraph.tsx#AppMetricsGraph"})}catch(l){}},"./frontend/src/scenes/apps/appMetricsSceneLogic.ts":function(T,c,e){"use strict";e.r(c),e.d(c,"AppMetricsTab",function(){return d}),e.d(c,"appMetricsSceneLogic",function(){return u});var O=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),p=e.n(O),m=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),i=e.n(m),M=e("./node_modules/@babel/runtime/regenerator/index.js"),j=e.n(M),R=e("./node_modules/core-js/modules/es.array.iterator.js"),V=e.n(R),B=e("./node_modules/core-js/modules/es.object.to-string.js"),J=e.n(B),K=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Y=e.n(K),U=e("./node_modules/core-js/modules/es.array.concat.js"),Z=e.n(U),W=e("./node_modules/core-js/modules/es.function.name.js"),z=e.n(W),x=e("./node_modules/core-js/modules/es.array.includes.js"),Q=e.n(x),S=e("./node_modules/core-js/modules/es.string.includes.js"),X=e.n(S),b=e("./node_modules/core-js/modules/es.array.filter.js"),w=e.n(b),G=e("./node_modules/core-js/modules/es.number.constructor.js"),F=e.n(G),f=e("./node_modules/kea/lib/index.esm.js"),L=e("./node_modules/kea-loaders/lib/index.js"),k=e.n(L),g=e("./frontend/src/scenes/urls.ts"),D=e("./frontend/src/lib/api.ts"),I=e("./frontend/src/scenes/teamLogic.tsx"),C=e("./node_modules/kea-router/lib/index.js"),h=e.n(C),A=e("./frontend/src/lib/utils.tsx"),d;(function(s){s.ProcessEvent="processEvent",s.OnEvent="onEvent",s.ExportEvents="exportEvents",s.HistoricalExports="historical_exports"})(d||(d={}));var l=[d.ProcessEvent,d.OnEvent,d.ExportEvents],u=Object(f.kea)([Object(f.path)(function(s){return["scenes","apps","appMetricsSceneLogic",s]}),Object(f.props)({}),Object(f.key)(function(s){return s.pluginConfigId}),Object(f.actions)({setActiveTab:function(t){return{tab:t}},setDateFrom:function(t){return{dateFrom:t}},openErrorDetailsDrawer:function(t,r,o){return{errorType:t,category:r,jobId:o}},closeErrorDetailsDrawer:!0}),Object(f.reducers)({activeTab:[null,{setActiveTab:function(t,r){var o=r.tab;return o}}],dateFrom:["-30d",{setDateFrom:function(t,r){var o=r.dateFrom;return o}}],errorDetailsDrawerError:[null,{openErrorDetailsDrawer:function(t,r){var o=r.errorType;return o},closeErrorDetailsDrawer:function(){return null}}]}),Object(L.loaders)(function(s){var t=s.values,r=s.props;return{pluginConfig:[null,{loadPluginConfig:function(){var o=i()(j.a.mark(function _(){return j.a.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,D.b.get("api/projects/".concat(I.a.values.currentTeamId,"/plugin_configs/").concat(r.pluginConfigId));case 2:return E.abrupt("return",E.sent);case 3:case"end":return E.stop()}},_)}));function n(){return o.apply(this,arguments)}return n}()}],appMetricsResponse:[null,{loadMetrics:function(){var o=i()(j.a.mark(function _(){var a;return j.a.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return a=Object(A.Eb)({category:t.activeTab,date_from:t.dateFrom}),v.next=3,D.b.get("api/projects/".concat(I.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"?").concat(a));case 3:return v.abrupt("return",v.sent);case 4:case"end":return v.stop()}},_)}));function n(){return o.apply(this,arguments)}return n}()}],historicalExports:[[],{loadHistoricalExports:function(){var o=i()(j.a.mark(function _(){var a,E;return j.a.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,D.b.get("api/projects/".concat(I.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"/historical_exports"));case 2:return a=P.sent,E=a.results,P.abrupt("return",E);case 5:case"end":return P.stop()}},_)}));function n(){return o.apply(this,arguments)}return n}()}],errorDetails:[[],{openErrorDetailsDrawer:function(){var o=i()(j.a.mark(function _(a){var E,v,P,H,$,N;return j.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return E=a.category,v=a.jobId,P=a.errorType,H=Object(A.Eb)({category:E,job_id:v,error_type:P}),y.next=4,D.b.get("api/projects/".concat(I.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"/error_details?").concat(H));case 4:return $=y.sent,N=$.result,y.abrupt("return",N);case 7:case"end":return y.stop()}},_)}));function n(_){return o.apply(this,arguments)}return n}()}]}}),Object(f.selectors)(function(s){var t=s.values;return{breadcrumbs:[function(r){return[r.pluginConfig,function(o,n){return n.pluginConfigId}]},function(r,o){var n;return[{name:"Apps",path:g.a.projectApps()},{name:r==null||(n=r.plugin_info)===null||n===void 0?void 0:n.name,path:g.a.appMetrics(o)}]}],showTab:[function(){return[]},function(){return function(r){var o;if(t.pluginConfigLoading||!t.pluginConfig)return!1;var n=((o=t.pluginConfig.plugin_info.capabilities)===null||o===void 0?void 0:o.methods)||[];return r===d.HistoricalExports?n.includes("exportEvents"):r===d.OnEvent&&n.includes("exportEvents")?!1:n.includes(r)}}]}}),Object(f.listeners)(function(s){var t=s.values,r=s.actions;return{loadPluginConfigSuccess:function(){if(!t.activeTab){var n=l.filter(function(E){return t.showTab(E)}),_=p()(n,1),a=_[0];r.setActiveTab(a)}},setActiveTab:function(n){var _=n.tab;_===d.HistoricalExports?r.loadHistoricalExports():r.loadMetrics()},setDateFrom:function(){r.loadMetrics()}}}),Object(C.actionToUrl)(function(s){var t=s.values,r=s.props;return{setActiveTab:function(){var n;return t.activeTab===d.HistoricalExports?g.a.appHistoricalExports(r.pluginConfigId):g.a.appMetrics(r.pluginConfigId,(n=t.activeTab)!==null&&n!==void 0?n:void 0)}}}),Object(C.urlToAction)(function(s){var t=s.values,r=s.actions,o=s.props;return{"/app/:pluginConfigId/:page":function(_,a){o.pluginConfigId===Number(_.pluginConfigId)&&(t.pluginConfig||r.loadPluginConfig(),_.page===d.HistoricalExports?r.setActiveTab(d.HistoricalExports):a.tab&&l.includes(a.tab)&&r.setActiveTab(a.tab))}}})])},"./frontend/src/scenes/apps/constants.tsx":function(T,c,e){"use strict";e.r(c),e.d(c,"DescriptionColumns",function(){return M});var O=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),p=e.n(O),m=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),i,M=(i={},p()(i,m.AppMetricsTab.ProcessEvent,{successes:"Events processed",failures:"Failed events"}),p()(i,m.AppMetricsTab.OnEvent,{successes:"Events processed",successes_on_retry:"Events processed on retry",failures:"Failed events"}),p()(i,m.AppMetricsTab.ExportEvents,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),p()(i,m.AppMetricsTab.HistoricalExports,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),i)},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/apps/AppMetricsGraph.scss":function(T,c,e){var O=e("./node_modules/css-loader/dist/runtime/api.js");c=O(!1),c.push([T.i,".AppMetricsGraph{height:300px}",""]),T.exports=c}}]);
