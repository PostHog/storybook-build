(window.webpackJsonp=window.webpackJsonp||[]).push([[245],{"./frontend/src/lib/introductions/GroupsIntroductionOption.tsx":function(K,j,n){"use strict";n.d(j,"a",function(){return O});var N=n("./node_modules/core-js/modules/es.array.includes.js"),Z=n.n(N),de=n("./node_modules/core-js/modules/es.string.includes.js"),Ve=n.n(de),me=n("./node_modules/react/index.js"),G=n.n(me),F=n("./node_modules/kea/lib/index.esm.js"),t=n("./node_modules/@ant-design/icons/es/icons/LockOutlined.js"),B=n("./node_modules/rc-select/es/index.js"),A=n("./frontend/src/lib/components/Link.tsx"),p=n("./frontend/src/lib/introductions/groupsAccessLogic.ts");function O($){var _=$.value,W=Object(F.useValues)(p.b),q=W.groupsAccessStatus;return[p.a.HasAccess,p.a.HasGroupTypes,p.a.NoAccess].includes(q)?G.a.createElement(B.default.Option,{key:"groups",value:_,disabled:!0,style:{height:"100%",width:"100%",overflow:"hidden",textOverflow:"ellipsis",backgroundColor:"var(--bg-side)",color:"var(--text-muted)"}},G.a.createElement(t.a,{style:{marginRight:6,color:"var(--warning)"}}),"Unique groups \u2013"," ",G.a.createElement(A.a,{to:"https://posthog.com/docs/user-guides/group-analytics?utm_medium=in-product&utm_campaign=group-analytics-learn-more",target:"_blank","data-attr":"group-analytics-learn-more",style:{fontWeight:600}},"Learn more")):null}try{O.displayName="GroupsIntroductionOption",O.__docgenInfo={description:"",displayName:"GroupsIntroductionOption",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"]={docgenInfo:O.__docgenInfo,name:"GroupsIntroductionOption",path:"frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"})}catch($){}},"./frontend/src/scenes/feature-flags/FeatureFlag.tsx":function(K,j,n){"use strict";n.r(j),n.d(j,"scene",function(){return ft}),n.d(j,"FeatureFlag",function(){return R});var N=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),Z=n.n(N),de=n("./node_modules/core-js/modules/es.array.map.js"),Ve=n("./node_modules/core-js/modules/es.object.to-string.js"),me=n("./node_modules/core-js/modules/es.regexp.to-string.js"),G=n("./node_modules/core-js/modules/es.array.concat.js"),F=n("./node_modules/react/index.js"),t=n.n(F),B=n("./node_modules/kea-forms/lib/index.js"),A=n("./node_modules/antd/es/row/index.js"),p=n("./node_modules/antd/es/col/index.js"),O=n("./node_modules/antd/es/collapse/index.js"),$=n("./node_modules/antd/es/popconfirm/index.js"),_=n("./node_modules/antd/es/radio/index.js"),W=n("./node_modules/antd/es/button/index.js"),q=n("./node_modules/antd/es/slider/index.js"),fe=n("./node_modules/antd/es/input-number/index.js"),ee=n("./node_modules/antd/es/select/index.js"),ge=n("./node_modules/antd/es/card/index.js"),h=n("./node_modules/kea/lib/index.esm.js"),V=n("./frontend/src/lib/utils.tsx"),Re=n("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),w=n("./node_modules/@ant-design/icons/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),De={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917.7 148.8l-42.4-42.4c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-76.1 76.1a199.27 199.27 0 00-112.1-34.3c-51.2 0-102.4 19.5-141.5 58.6L432.3 308.7a8.03 8.03 0 000 11.3L704 591.7c1.6 1.6 3.6 2.3 5.7 2.3 2 0 4.1-.8 5.7-2.3l101.9-101.9c68.9-69 77-175.7 24.3-253.5l76.1-76.1c3.1-3.2 3.1-8.3 0-11.4zM578.9 546.7a8.03 8.03 0 00-11.3 0L501 613.3 410.7 523l66.7-66.7c3.1-3.1 3.1-8.2 0-11.3L441 408.6a8.03 8.03 0 00-11.3 0L363 475.3l-43-43a7.85 7.85 0 00-5.7-2.3c-2 0-4.1.8-5.7 2.3L206.8 534.2c-68.9 68.9-77 175.7-24.3 253.5l-76.1 76.1a8.03 8.03 0 000 11.3l42.4 42.4c1.6 1.6 3.6 2.3 5.7 2.3s4.1-.8 5.7-2.3l76.1-76.1c33.7 22.9 72.9 34.3 112.1 34.3 51.2 0 102.4-19.5 141.5-58.6l101.9-101.9c3.1-3.1 3.1-8.2 0-11.3l-43-43 66.7-66.7c3.1-3.1 3.1-8.2 0-11.3l-36.6-36.2z"}}]},name:"api",theme:"filled"},Ke=De,pe=n("./node_modules/@ant-design/icons/es/components/AntdIcon.js"),ve=function(e,o){return F.createElement(pe.a,Object(w.a)(Object(w.a)({},e),{},{ref:o,icon:Ke}))};ve.displayName="ApiFilled";var Ge=F.forwardRef(ve),Be=n("./node_modules/@ant-design/icons/es/icons/LockOutlined.js"),$e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482.2 508.4L331.3 389c-3-2.4-7.3-.2-7.3 3.6V478H184V184h204v128c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V144c0-15.5-12.5-28-28-28H144c-15.5 0-28 12.5-28 28v736c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v128H184V546h140v85.4c0 3.8 4.4 6 7.3 3.6l150.9-119.4a4.5 4.5 0 000-7.2zM880 116H596c-15.5 0-28 12.5-28 28v168c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V184h204v294H700v-85.4c0-3.8-4.3-6-7.3-3.6l-151 119.4a4.52 4.52 0 000 7.1l151 119.5c2.9 2.3 7.3.2 7.3-3.6V546h140v294H636V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v168c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V144c0-15.5-12.5-28-28-28z"}}]},name:"merge-cells",theme:"outlined"},We=$e,ye=function(e,o){return F.createElement(pe.a,Object(w.a)(Object(w.a)({},e),{},{ref:o,icon:We}))};ye.displayName="MergeCellsOutlined";var we=F.forwardRef(ye),Ue=n("./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js"),Nt=n("./node_modules/core-js/modules/es.object.keys.js"),Vt=n("./node_modules/core-js/modules/es.symbol.js"),Rt=n("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Dt=n("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),ze=n("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),He=n.n(ze),Je=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),U=n.n(Je),Ye=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),b=n.n(Ye),ke=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),he=n.n(ke),Xe=n("./node_modules/@babel/runtime/regenerator/index.js"),S=n.n(Xe),Kt=n("./node_modules/core-js/modules/es.regexp.exec.js"),Gt=n("./node_modules/core-js/modules/es.string.match.js"),Bt=n("./node_modules/core-js/modules/es.array.splice.js"),$t=n("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Wt=n("./node_modules/core-js/modules/es.array.iterator.js"),wt=n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Ut=n("./node_modules/core-js/modules/es.string.replace.js"),zt=n("./node_modules/core-js/modules/es.function.name.js"),Ht=n("./node_modules/core-js/modules/es.array.filter.js"),Jt=n("./node_modules/core-js/modules/es.array.find.js"),te=n("./frontend/src/lib/api.ts"),ae=n("./node_modules/kea-router/lib/index.js"),z=n("./frontend/src/scenes/urls.ts"),Ee=n("./frontend/src/scenes/teamLogic.ts"),ne=n("./frontend/src/scenes/feature-flags/featureFlagsLogic.ts"),je=n("./frontend/src/models/groupsModel.ts"),Fe=n("./frontend/src/lib/components/TaxonomicFilter/types.ts"),Qe=n("./frontend/src/lib/components/lemonToast.tsx"),Ze=n("./node_modules/kea-loaders/lib/index.js"),_e=["created_at","id"];function Oe(a,e){var o=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),o.push.apply(o,r)}return o}function l(a){for(var e=1;e<arguments.length;e++){var o=arguments[e]!=null?arguments[e]:{};e%2?Oe(Object(o),!0).forEach(function(r){he()(a,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):Oe(Object(o)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(o,r))})}return a}var re={id:null,created_at:null,key:"",name:"",filters:{groups:[{properties:[],rollout_percentage:null}],multivariate:null},deleted:!1,active:!0,created_by:null,is_simple_flag:!1,rollout_percentage:null},qe={key:"",name:"",rollout_percentage:0},et={variants:[{key:"",name:"",rollout_percentage:100}]},H=Object(h.kea)([Object(h.path)(["scenes","feature-flags","featureFlagLogic"]),Object(h.props)({}),Object(h.key)(function(a){var e=a.id;return e!=null?e:"new"}),Object(h.connect)({values:[Ee.a,["currentTeamId"],je.a,["groupTypes","groupsTaxonomicTypes","aggregationLabel"]]}),Object(h.actions)({setFeatureFlag:function(e){return{featureFlag:e}},addConditionSet:!0,setAggregationGroupTypeIndex:function(e){return{value:e}},removeConditionSet:function(e){return{index:e}},duplicateConditionSet:function(e){return{index:e}},updateConditionSet:function(e,o,r){return{index:e,newRolloutPercentage:o,newProperties:r}},deleteFeatureFlag:function(e){return{featureFlag:e}},setMultivariateEnabled:function(e){return{enabled:e}},setMultivariateOptions:function(e){return{multivariateOptions:e}},addVariant:!0,removeVariant:function(e){return{index:e}},distributeVariantsEqually:!0}),Object(B.forms)(function(a){var e=a.actions;return{featureFlag:{defaults:l({},re),errors:function(r){var s,u,i,c=r.key,v=r.filters;return{key:c?(s=c.match)!==null&&s!==void 0&&s.call(c,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key",filters:{multivariate:{variants:v==null||(u=v.multivariate)===null||u===void 0||(i=u.variants)===null||i===void 0?void 0:i.map(function(g){var x,f=g.key;return{key:f?(x=f.match)!==null&&x!==void 0&&x.call(f,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key"}})}}}},submit:function(r){e.saveFeatureFlag(r)}}}}),Object(h.reducers)({featureFlag:[l({},re),{setFeatureFlag:function(e,o){var r=o.featureFlag;if(r.filters.groups){var s=r.filters.groups.map(function(u){return u.properties?l(l({},u),{},{properties:Object(V.r)(u.properties)}):u});return l(l({},r),{},{filters:l(l({},r==null?void 0:r.filters),{},{groups:s})})}return r},addConditionSet:function(e){if(!e)return e;var o=[].concat(b()(e==null?void 0:e.filters.groups),[{properties:[],rollout_percentage:null}]);return l(l({},e),{},{filters:l(l({},e.filters),{},{groups:o})})},updateConditionSet:function(e,o){var r=o.index,s=o.newRolloutPercentage,u=o.newProperties;if(!e)return e;var i=b()(e==null?void 0:e.filters.groups);return s!==void 0&&(i[r]=l(l({},i[r]),{},{rollout_percentage:s})),u!==void 0&&(i[r]=l(l({},i[r]),{},{properties:u})),l(l({},e),{},{filters:l(l({},e.filters),{},{groups:i})})},removeConditionSet:function(e,o){var r=o.index;if(!e)return e;var s=b()(e.filters.groups);return s.splice(r,1),l(l({},e),{},{filters:l(l({},e.filters),{},{groups:s})})},duplicateConditionSet:function(e,o){var r=o.index;if(!e)return e;var s=e.filters.groups.concat([e.filters.groups[r]]);return l(l({},e),{},{filters:l(l({},e.filters),{},{groups:s})})},setMultivariateOptions:function(e,o){var r=o.multivariateOptions;return e&&l(l({},e),{},{filters:l(l({},e.filters),{},{multivariate:r})})},addVariant:function(e){var o;if(!e)return e;var r=b()(((o=e.filters.multivariate)===null||o===void 0?void 0:o.variants)||[]);return l(l({},e),{},{filters:l(l({},e.filters),{},{multivariate:l(l({},e.filters.multivariate||{}),{},{variants:[].concat(b()(r),[qe])})})})},removeVariant:function(e,o){var r,s=o.index;if(!e)return e;var u=b()(((r=e.filters.multivariate)===null||r===void 0?void 0:r.variants)||[]);return u.splice(s,1),l(l({},e),{},{filters:l(l({},e.filters),{},{multivariate:l(l({},e.filters.multivariate),{},{variants:u})})})},distributeVariantsEqually:function(e){var o;if(!e)return e;var r=b()(((o=e.filters.multivariate)===null||o===void 0?void 0:o.variants)||[]),s=r.length;if(s>0&&s<=100){var u=Math.round(100/s),i=u*s,c=i-100;r.forEach(function(v,g){r[g]=l(l({},v),{},{rollout_percentage:u})}),r[s-1]=l(l({},r[s-1]),{},{rollout_percentage:u-c})}return l(l({},e),{},{filters:l(l({},e.filters),{},{multivariate:l(l({},e.filters.multivariate),{},{variants:r})})})},setAggregationGroupTypeIndex:function(e,o){var r=o.value;return!e||e.filters.aggregation_group_type_index==r?e:l(l({},e),{},{filters:l(l({},e.filters),{},{aggregation_group_type_index:r,groups:[{properties:[],rollout_percentage:null}]})})}}]}),Object(Ze.loaders)(function(a){var e=a.values,o=a.props;return{featureFlag:{loadFeatureFlag:function(){var r=U()(S.a.mark(function u(){return S.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(o.id&&o.id!=="new")){c.next=4;break}return c.next=3,te.b.get("api/projects/".concat(e.currentTeamId,"/feature_flags/").concat(o.id));case 3:return c.abrupt("return",c.sent);case 4:return c.abrupt("return",re);case 5:case"end":return c.stop()}},u)}));function s(){return r.apply(this,arguments)}return s}(),saveFeatureFlag:function(){var r=U()(S.a.mark(function u(i){var c,v,g;return S.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(c=i.created_at,v=i.id,g=He()(i,_e),i.id){f.next=7;break}return f.next=4,te.b.create("api/projects/".concat(e.currentTeamId,"/feature_flags"),g);case 4:return f.abrupt("return",f.sent);case 7:return f.next=9,te.b.update("api/projects/".concat(e.currentTeamId,"/feature_flags/").concat(i.id),g);case 9:return f.abrupt("return",f.sent);case 10:case"end":return f.stop()}},u)}));function s(u){return r.apply(this,arguments)}return s}()}}}),Object(h.listeners)(function(a){var e=a.actions,o=a.values;return{saveFeatureFlagSuccess:function(s){var u,i=s.featureFlag;Qe.b.success("Feature flag saved"),(u=ne.a.findMounted())===null||u===void 0||u.actions.updateFlag(i),ae.router.actions.replace(z.a.featureFlag(i.id))},deleteFeatureFlag:function(){var r=U()(S.a.mark(function u(i){var c;return S.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:c=i.featureFlag,Object(V.w)({endpoint:"projects/".concat(o.currentTeamId,"/feature_flags"),object:{name:c.name,id:c.id},callback:function(){var f;c.id&&((f=ne.a.findMounted())===null||f===void 0||f.actions.deleteFlag(c.id)),ae.router.actions.push(z.a.featureFlags())}});case 2:case"end":return g.stop()}},u)}));function s(u){return r.apply(this,arguments)}return s}(),setMultivariateEnabled:function(){var r=U()(S.a.mark(function u(i){var c;return S.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:c=i.enabled,c?e.setMultivariateOptions(et):e.setMultivariateOptions(null);case 2:case"end":return g.stop()}},u)}));function s(u){return r.apply(this,arguments)}return s}()}}),Object(h.selectors)({props:[function(){return[function(a,e){return e}]},function(a){return a}],multivariateEnabled:[function(a){return[a.featureFlag]},function(a){return!!(a!=null&&a.filters.multivariate)}],variants:[function(a){return[a.featureFlag]},function(a){var e;return(a==null||(e=a.filters.multivariate)===null||e===void 0?void 0:e.variants)||[]}],nonEmptyVariants:[function(a){return[a.variants]},function(a){return a.filter(function(e){var o=e.key;return!!o})}],variantRolloutSum:[function(a){return[a.variants]},function(a){return a.reduce(function(e,o){var r=o.rollout_percentage;return e+r},0)}],areVariantRolloutsValid:[function(a){return[a.variants,a.variantRolloutSum]},function(a,e){return a.every(function(o){var r=o.rollout_percentage;return r>=0&&r<=100})&&e===100}],aggregationTargetName:[function(a){return[a.featureFlag,a.groupTypes,a.aggregationLabel]},function(a,e,o){return a&&a.filters.aggregation_group_type_index!=null&&e.length>0?o(a.filters.aggregation_group_type_index).plural:"users"}],taxonomicGroupTypes:[function(a){return[a.featureFlag,a.groupsTaxonomicTypes]},function(a,e){return a&&a.filters.aggregation_group_type_index!=null&&e.length>0?[e[a.filters.aggregation_group_type_index]]:[Fe.a.PersonProperties,Fe.a.Cohorts]}],breadcrumbs:[function(a){return[a.featureFlag]},function(a){return[{name:"Feature Flags",path:z.a.featureFlags()}].concat(b()(a?[{name:a.key||"Unnamed"}]:[]))}]}),Object(ae.urlToAction)(function(a){var e,o=a.actions,r=a.props;return he()({},z.a.featureFlag((e=r.id)!==null&&e!==void 0?e:"new"),function(s,u,i,c){var v=c.method;v==="PUSH"&&(r.id?o.loadFeatureFlag():o.resetFeatureFlag())})}),Object(h.afterMount)(function(a){var e,o=a.props,r=a.actions,s=(e=ne.a.findMounted())===null||e===void 0?void 0:e.values.featureFlags.find(function(u){return u.id===o.id});s?r.setFeatureFlag(s):o.id!=="new"&&r.loadFeatureFlag()})]),tt=n("./frontend/src/lib/components/PageHeader.tsx"),at=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),nt=n.n(at),rt=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss"),be=n.n(rt),oe={};oe.insert="head",oe.singleton=!1;var Yt=nt()(be.a,oe),kt=be.a.locals||{},C=n("./frontend/src/lib/components/icons.tsx"),J=n("./frontend/src/lib/components/Tooltip.tsx"),P=n("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),Y="?utm_medium=in-product&utm_campaign=feature-flag";function k(a){var e=a.flagKey;return t.a.createElement(t.a.Fragment,null,t.a.createElement(P.a,{language:P.b.JavaScript,wrap:!0},"if\xA0(posthog.isFeatureEnabled('".concat(e!=null?e:"",`')) {
    // run your activation code here
}`)),t.a.createElement("div",{className:"mt"},"Need more information?"," ",t.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://posthog.com/docs/integrations/js-integration".concat(Y,"#feature-flags")},"Check the docs ",t.a.createElement(C.IconOpenInNew,null))))}function X(a){var e=a.flagKey;return t.a.createElement(t.a.Fragment,null,t.a.createElement(P.a,{language:P.b.Python,wrap:!0},'if\xA0posthog.feature_enabled("'.concat(e,`", "user_distinct_id"):
    runAwesomeFeature()
`)),t.a.createElement("div",{className:"mt"},"Need more information?"," ",t.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://posthog.com/docs/integrations/python-integration".concat(Y,"#feature-flags")},"Check the docs ",t.a.createElement(C.IconOpenInNew,null))))}function ot(){var a=Object(h.useValues)(Ee.a),e=a.currentTeam;return t.a.createElement(t.a.Fragment,null,t.a.createElement(P.a,{language:P.b.Bash,wrap:!0},"curl ".concat(window.location.origin,`/decide/ \\
-X POST -H 'Content-Type: application/json' \\
-d '{
    "api_key": "`).concat(e?e.api_token:"[project_api_key]",`",
    "distinct_id": "[user distinct id]"
}'
                `)),t.a.createElement("div",{className:"mt"},"Need more information?"," ",t.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://posthog.com/docs/api/feature-flags".concat(Y)},"Check the docs ",t.a.createElement(C.IconOpenInNew,null))))}try{k.displayName="JSSnippet",k.__docgenInfo={description:"",displayName:"JSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"]={docgenInfo:k.__docgenInfo,name:"JSSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"})}catch(a){}try{X.displayName="PythonSnippet",X.__docgenInfo={description:"",displayName:"PythonSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"]={docgenInfo:X.__docgenInfo,name:"PythonSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"})}catch(a){}var Se=n("./frontend/src/lib/components/LemonDivider/index.ts"),lt=n("./frontend/src/lib/introductions/GroupsIntroductionOption.tsx"),st=n("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),it=n("./frontend/src/scenes/userLogic.ts"),le=n("./frontend/src/types.ts"),ut=n("./frontend/src/lib/components/Link.tsx"),L=n("./frontend/src/lib/components/LemonButton/index.ts"),ct=n("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),I=n("./frontend/src/lib/forms/Field.tsx"),dt=n("./frontend/src/lib/forms/VerticalForm.tsx"),mt=n("./frontend/src/lib/components/LemonTextArea/LemonTextArea.tsx"),se=n("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),ft={component:R,logic:H,paramsToProps:function(e){var o=e.params.id;return{id:o&&o!=="new"?parseInt(o):"new"}}};function Ce(a){setTimeout(function(){var e;return(e=document.querySelector('.variant-form-list input[data-key-index="'.concat(a,'"]')))===null||e===void 0?void 0:e.focus()},50)}function R(){var a,e,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=o.id,s=Object(h.useValues)(H),u=s.props,i=s.featureFlag,c=s.multivariateEnabled,v=s.variants,g=s.nonEmptyVariants,x=s.areVariantRolloutsValid,f=s.variantRolloutSum,gt=s.groupTypes,D=s.aggregationTargetName,pt=s.taxonomicGroupTypes,vt=s.featureFlagLoading,E=Object(h.useActions)(H),yt=E.addConditionSet,xe=E.updateConditionSet,ht=E.removeConditionSet,Et=E.duplicateConditionSet,jt=E.deleteFeatureFlag,Te=E.setMultivariateEnabled,Ft=E.addVariant,Ot=E.removeVariant,bt=E.distributeVariantsEqually,St=E.setAggregationGroupTypeIndex,Ae=Object(h.useValues)(je.a),Ct=Ae.showGroupsOptions,xt=Ae.aggregationLabel,Le=Object(h.useValues)(it.a),ie=Le.hasAvailableFeature,Tt=Le.upgradeLink,At=Object(F.useState)(!1),Ie=Z()(At,2),Pe=Ie[0],Lt=Ie[1],It=Object(F.useState)(!1),Me=Z()(It,2),Pt=Me[0],ue=Me[1],Mt=Object(lt.a)({value:-2});return t.a.createElement("div",{className:"feature-flag"},i?t.a.createElement(dt.a,{logic:H,props:u,formKey:"featureFlag",enableFormOnSubmit:!0},t.a.createElement(tt.a,{title:"Feature Flag",buttons:t.a.createElement("div",{className:"flex-center"},t.a.createElement(I.a,{name:"active"},function(m){var d=m.value,y=m.onChange;return t.a.createElement(ct.a,{checked:d,onChange:y,label:d?t.a.createElement("span",{className:"text-success"},"Enabled"):t.a.createElement("span",{className:"text-danger"},"Disabled")})}),(i==null?void 0:i.id)&&t.a.createElement(L.a,{"data-attr":"delete-flag",status:"danger",type:"secondary",onClick:function(){jt(i)},style:{marginRight:16}},"Delete"),t.a.createElement(L.a,{type:"primary","data-attr":"feature-flag-submit",loading:vt,htmlType:"submit"},"Save changes"))}),t.a.createElement("h3",{className:"l3"},"General configuration"),t.a.createElement("div",{className:"text-muted mb"},"General settings for your feature flag and integration instructions."),t.a.createElement(A.a,{gutter:16,style:{marginBottom:32}},t.a.createElement(p.a,{span:12},t.a.createElement(I.a,{name:"key",label:"Key (must be unique)",validateStatus:Pe?"warning":void 0,hint:Pe&&r!=="new"?t.a.createElement("small",null,t.a.createElement("b",null,"Warning! "),"Changing this key will",t.a.createElement("a",{href:"https://posthog.com/docs/features/feature-flags".concat(Y,"#feature-flag-persistence"),target:"_blank",rel:"noopener"}," ","affect the persistence of your flag ",t.a.createElement(C.IconOpenInNew,null))):void 0},function(m){var d=m.value,y=m.onChange;return t.a.createElement(se.a,{value:d,onChange:function(T){T!==d&&Lt(!0),y(T)},"data-attr":"feature-flag-key",className:"ph-ignore-input",autoFocus:!0,placeholder:"examples: new-landing-page, betaFeature, ab_test_1",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})}),t.a.createElement(I.a,{name:"name",label:"Description"},t.a.createElement(mt.a,{className:"ph-ignore-input","data-attr":"feature-flag-description",placeholder:"Adding a helpful description can ensure others know what this feature is for."}))),t.a.createElement(p.a,{span:12,style:{paddingTop:31}},t.a.createElement(O.a,null,t.a.createElement(O.a.Panel,{header:t.a.createElement("div",{style:{display:"flex",fontWeight:"bold",alignItems:"center"}},t.a.createElement(C.IconJavascript,{style:{marginRight:6}})," Javascript integration instructions"),key:"js"},t.a.createElement(k,{flagKey:i.key||"my-flag"})),t.a.createElement(O.a.Panel,{header:t.a.createElement("div",{style:{display:"flex",fontWeight:"bold",alignItems:"center"}},t.a.createElement(C.IconPython,{style:{marginRight:6}})," Python integration instructions"),key:"python"},t.a.createElement(X,{flagKey:i.key||"my-flag"})),t.a.createElement(O.a.Panel,{header:t.a.createElement("div",{style:{display:"flex",fontWeight:"bold",alignItems:"center"}},t.a.createElement(Ge,{style:{marginRight:6}})," API integration instructions"),key:"api"},t.a.createElement(ot,null))))),t.a.createElement("div",{className:"mb-2"},t.a.createElement("h3",{className:"l3"},"Served value"),t.a.createElement("div",{className:"mb-05"},t.a.createElement($.a,{placement:"top",title:"Change value type? The variants below will be lost.",visible:Pt,onConfirm:function(){Te(!1),ue(!1)},onCancel:function(){return ue(!1)},okText:"OK",cancelText:"Cancel"},t.a.createElement(_.a.Group,{options:[{label:"Boolean value (A/B test)",value:!1},{label:t.a.createElement(J.a,{title:ie(le.d.MULTIVARIATE_FLAGS)?"":"This feature is not available on your current plan."},t.a.createElement("div",null,!ie(le.d.MULTIVARIATE_FLAGS)&&t.a.createElement(ut.a,{to:Tt,target:"_blank"},t.a.createElement(Be.a,{style:{marginRight:4,color:"var(--warning)"}})),"String value (Multivariate test)"," ",t.a.createElement(st.a,{type:"warning"},"Beta"))),value:!0,disabled:!ie(le.d.MULTIVARIATE_FLAGS)}],onChange:function(d){var y=d.target.value;y===!1&&g.length?ue(!0):(Te(y),Ce(0))},value:c,optionType:"button"}))),t.a.createElement("div",{className:"text-muted mb"},Object(V.i)(D)," will be served"," ",c?t.a.createElement(t.a.Fragment,null,t.a.createElement("strong",null,"a variant key")," according to the below distribution"):t.a.createElement("strong",null,t.a.createElement("code",null,"true"))," ","if they match one or more release condition groups."),c&&t.a.createElement("div",{className:"variant-form-list"},t.a.createElement(A.a,{gutter:8,className:"label-row"},t.a.createElement(p.a,{span:7},"Variant key"),t.a.createElement(p.a,{span:7},"Description"),t.a.createElement(p.a,{span:9},t.a.createElement("span",null,"Rollout percentage"),t.a.createElement(W.a,{type:"link",onClick:bt,icon:t.a.createElement(we,null),style:{padding:"0 0 0 0.5em"},title:"Distribute variants equally"},"Distribute"))),v.map(function(m,d){return t.a.createElement(B.Group,{key:d,name:["filters","multivariate","variants",d]},t.a.createElement(A.a,{gutter:8},t.a.createElement(p.a,{span:7},t.a.createElement(I.a,{name:"key"},t.a.createElement(se.a,{"data-attr":"feature-flag-variant-key","data-key-index":d.toString(),className:"ph-ignore-input",placeholder:"example-variant-".concat(d+1),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}))),t.a.createElement(p.a,{span:7},t.a.createElement(I.a,{name:"name"},t.a.createElement(se.a,{"data-attr":"feature-flag-variant-name",className:"ph-ignore-input",placeholder:"Description"}))),t.a.createElement(p.a,{span:7},t.a.createElement(I.a,{name:"rollout_percentage"},t.a.createElement(q.a,{tooltipPlacement:"top"}))),t.a.createElement(p.a,{span:2},t.a.createElement(I.a,{name:"rollout_percentage"},function(y){var M=y.value,T=y.onChange;return t.a.createElement(fe.a,{min:0,max:100,value:M,onChange:function(ce){if(ce!=null){var Ne=parseInt(ce.toString());isNaN(Ne)||T(Ne)}},style:{width:"100%",borderColor:x?void 0:"var(--danger)"}})})),v.length>1&&t.a.createElement(p.a,{span:1},t.a.createElement(J.a,{title:"Delete this variant",placement:"bottomLeft"},t.a.createElement(W.a,{type:"link",icon:t.a.createElement(Ue.a,null),onClick:function(){return Ot(d)},style:{color:"var(--danger)"}})))))}),v.length>0&&!x&&t.a.createElement("p",{className:"text-danger"},"Percentage rollouts for variants must sum to 100 (currently ",f,")."),t.a.createElement(L.a,{type:"secondary",onClick:function(){var d=v.length;Ft(),Ce(d)},style:{margin:"1rem 0"},size:"small",fullWidth:!0,center:!0},"Add variant"))),t.a.createElement("div",{className:"feature-flag-form-row"},t.a.createElement("div",null,t.a.createElement("h3",{className:"l3"},"Release conditions"),t.a.createElement("div",{className:"text-muted mb"},"Specify the ",D," to which you want to release this flag. Note that condition sets are rolled out independently of each other.")),Ct&&t.a.createElement("div",{className:"centered"},"Match by",t.a.createElement(ee.a,{value:((a=i.filters)===null||a===void 0?void 0:a.aggregation_group_type_index)!=null?(e=i.filters)===null||e===void 0?void 0:e.aggregation_group_type_index:-1,onChange:function(d){var y=d!==-1?d:null;St(y)},style:{marginLeft:8},"data-attr":"feature-flag-aggregation-filter",dropdownMatchSelectWidth:!1,dropdownAlign:{points:["tr","br"]}},t.a.createElement(ee.a.Option,{key:-1,value:-1},"Users"),gt.map(function(m){return t.a.createElement(ee.a.Option,{key:m.group_type_index,value:m.group_type_index},Object(V.i)(xt(m.group_type_index).plural))}),Mt))),t.a.createElement(A.a,{gutter:16},i.filters.groups.map(function(m,d){var y,M;return t.a.createElement(p.a,{span:24,md:24,key:"".concat(d,"-").concat(i.filters.groups.length)},d>0&&t.a.createElement("div",{style:{display:"flex",marginLeft:16}},t.a.createElement("div",{className:"stateful-badge or-light-grey mb"},"OR")),t.a.createElement(ge.a,{style:{marginBottom:16}},t.a.createElement("div",{className:"feature-flag-form-row",style:{height:24}},t.a.createElement("div",null,t.a.createElement("span",{className:"simple-tag tag-light-blue",style:{marginRight:8}},"Set ",d+1),(y=m.properties)!==null&&y!==void 0&&y.length?t.a.createElement(t.a.Fragment,null,"Matching ",t.a.createElement("b",null,D)," with filters"):t.a.createElement(t.a.Fragment,null,"Condition set will match ",t.a.createElement("b",null,"all ",D))),t.a.createElement(A.a,{align:"middle"},t.a.createElement(J.a,{title:"Duplicate this condition set",placement:"bottomLeft"},t.a.createElement(L.a,{icon:t.a.createElement(C.IconCopy,null),size:"small",onClick:function(){return Et(d)}})),i.filters.groups.length>1&&t.a.createElement(J.a,{title:"Delete this condition set",placement:"bottomLeft"},t.a.createElement(L.a,{icon:t.a.createElement(C.IconDelete,null),size:"small",onClick:function(){return ht(d)}})))),t.a.createElement(Se.a,{large:!0}),t.a.createElement(Re.a,{style:{marginLeft:15},pageKey:"feature-flag-".concat(i.id,"-").concat(d,"-").concat(i.filters.groups.length,"-").concat((M=i.filters.aggregation_group_type_index)!==null&&M!==void 0?M:""),propertyFilters:m==null?void 0:m.properties,onChange:function(Q){return xe(d,void 0,Q)},taxonomicGroupTypes:pt,showConditionBadge:!0}),t.a.createElement(Se.a,{large:!0}),t.a.createElement("div",{className:"feature-flag-form-row"},t.a.createElement("div",{className:"centered"},"Roll out to"," ",t.a.createElement(fe.a,{style:{width:100,marginLeft:8,marginRight:8},onChange:function(Q){xe(d,Q)},value:m.rollout_percentage!=null?m.rollout_percentage:100,min:0,max:100,addonAfter:"%"})," ","of ",t.a.createElement("b",null,D)," in this set"))))})),t.a.createElement(ge.a,{size:"small",style:{marginBottom:16}},t.a.createElement(L.a,{onClick:yt,fullWidth:!0},"Add condition set")),t.a.createElement("div",{className:"text-right"},t.a.createElement(L.a,{htmlType:"submit",type:"primary","data-attr":"feature-flag-submit-bottom"},"Save changes"))):t.a.createElement(V.b,null))}try{R.displayName="FeatureFlag",R.__docgenInfo={description:"",displayName:"FeatureFlag",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"]={docgenInfo:R.__docgenInfo,name:"FeatureFlag",path:"frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"})}catch(a){}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss":function(K,j,n){var N=n("./node_modules/css-loader/dist/runtime/api.js");j=N(!1),j.push([K.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.variant-form-list .ant-form-item{min-height:32px}.variant-form-list .label-row{margin-bottom:4px;font-weight:700}.variant-form-list .label-row .ant-col{min-height:32px;display:flex;justify-content:space-between;align-items:center}.feature-flag-form-row{display:flex;justify-content:space-between;align-items:center;width:100%}.feature-flag-form-row .centered{display:flex;align-items:center;white-space:pre-wrap}",""]),K.exports=j}}]);
