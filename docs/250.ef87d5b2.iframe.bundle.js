(window.webpackJsonp=window.webpackJsonp||[]).push([[250],{"./frontend/src/lib/components/Table/utils.tsx":function(ae,T,e){"use strict";e.d(T,"a",function(){return D});var C=e("./node_modules/react/index.js"),Y=e.n(C),h=e("./frontend/src/lib/hooks/useWindowSize.js"),H=e("./frontend/src/lib/utils/responsiveUtils.tsx");function D(M){return Y.a.createElement("span",{style:{whiteSpace:"nowrap"}},M)}var R=function($){var b=Object(h.a)(),t=b.width,E=Object(H.b)($),v=!!t&&t<=E;return{isTableScrolling:v,tableScrollBreakpoint:E,tableScrollX:v?"max-content":"".concat(E,"px")}};try{D.displayName="normalizeColumnTitle",D.__docgenInfo={description:"",displayName:"normalizeColumnTitle",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Table/utils.tsx#normalizeColumnTitle"]={docgenInfo:D.__docgenInfo,name:"normalizeColumnTitle",path:"frontend/src/lib/components/Table/utils.tsx#normalizeColumnTitle"})}catch(M){}try{R.displayName="useIsTableScrolling",R.__docgenInfo={description:"",displayName:"useIsTableScrolling",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Table/utils.tsx#useIsTableScrolling"]={docgenInfo:R.__docgenInfo,name:"useIsTableScrolling",path:"frontend/src/lib/components/Table/utils.tsx#useIsTableScrolling"})}catch(M){}},"./frontend/src/scenes/feature-flags/FeatureFlags.tsx":function(ae,T,e){"use strict";e.r(T),e.d(T,"scene",function(){return N}),e.d(T,"FeatureFlags",function(){return G}),e.d(T,"groupFilters",function(){return y});var C=e("./node_modules/core-js/modules/es.array.includes.js"),Y=e.n(C),h=e("./node_modules/core-js/modules/es.array.some.js"),H=e.n(h),D=e("./node_modules/core-js/modules/es.function.name.js"),R=e.n(D),M=e("./node_modules/core-js/modules/es.number.constructor.js"),$=e.n(M),b=e("./node_modules/react/index.js"),t=e.n(b),E=e("./node_modules/kea/lib/index.esm.js"),v=e("./frontend/src/scenes/feature-flags/featureFlagsLogic.ts"),J=e("./node_modules/antd/es/input/index.js"),W=e("./node_modules/antd/es/tabs/index.js"),X=e("./frontend/src/lib/components/Link.tsx"),Q=e("./frontend/src/lib/utils.tsx"),K=e("./node_modules/@ant-design/icons/es/icons/PlusOutlined.js"),re=e("./frontend/src/lib/components/PageHeader.tsx"),U=e("./frontend/src/lib/components/LinkButton.tsx"),se=e("./frontend/src/lib/components/Table/utils.tsx"),L=e("./frontend/src/scenes/urls.ts"),oe=e("./frontend/src/lib/utils/stringWithWBR.tsx"),Z=e("./frontend/src/scenes/teamLogic.ts"),p=e("./frontend/src/lib/components/LemonButton/index.ts"),w=e("./frontend/src/lib/components/LemonRow/index.ts"),F=e("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),k=e("./frontend/src/lib/components/LemonTable/index.ts"),S=e("./frontend/src/lib/components/LemonButton/More.tsx"),x=e("./frontend/src/lib/components/LemonTable/columnUtils.tsx"),P=e("./frontend/src/lib/components/PropertyFilters/components/PropertyFiltersDisplay.tsx"),V=e("./frontend/src/lib/logic/featureFlagLogic.ts"),q=e("./frontend/src/lib/constants.tsx"),ee=e("./frontend/src/lib/components/ActivityLog/ActivityLog.tsx"),B=e("./frontend/src/scenes/feature-flags/activityDescriptions.tsx"),te=e("./frontend/src/lib/components/ActivityLog/humanizeActivity.tsx"),N={component:G,logic:v.a};function z(){var u=Object(E.useValues)(Z.a),j=u.currentTeamId,c=Object(E.useValues)(v.a),A=c.featureFlagsLoading,i=c.searchedFeatureFlags,O=c.searchTerm,n=Object(E.useActions)(v.a),a=n.updateFeatureFlag,r=n.loadFeatureFlags,s=n.setSearchTerm,_=Object(E.useValues)(V.a),d=_.featureFlags,g=d[q.n.FEATURE_FLAGS_ACTIVITY_LOG],I=[{title:Object(se.a)("Key"),dataIndex:"key",className:"ph-no-capture",sticky:!0,width:"40%",sorter:function(m,o){return(m.key||"").localeCompare(o.key||"")},render:function(m,o){return t.a.createElement(t.a.Fragment,null,t.a.createElement(X.a,{to:o.id?L.a.featureFlag(o.id):void 0,className:"row-name"},Object(oe.a)(o.key,17)),o.name&&t.a.createElement("span",{className:"row-description"},o.name))}},Object(x.b)(),Object(x.a)(),{title:"Rollout",width:200,render:function(m,o){return y(o.filters.groups)}},{title:"Status",dataIndex:"active",sorter:function(m,o){return Number(m.active)-Number(o.active)},width:100,render:function(m,o){var f="feature-flag-".concat(o.id,"-switch");return t.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},t.a.createElement("label",{htmlFor:f},o.active?"Enabled":"Disabled"),t.a.createElement(F.a,{id:f,checked:o.active,onChange:function(le){return o.id?a({id:o.id,payload:{active:le}}):null},style:{marginLeft:"0.5rem"}}))}},{width:0,render:function(m,o){return t.a.createElement(S.a,{overlay:t.a.createElement(t.a.Fragment,null,t.a.createElement(p.a,{type:"stealth",onClick:function(){Object(Q.t)(o.key,"feature flag key")},fullWidth:!0},"Copy key"),o.id&&t.a.createElement(p.a,{type:"stealth",to:L.a.featureFlag(o.id),fullWidth:!0},"Edit"),t.a.createElement(p.a,{type:"stealth",to:L.a.insightNew({events:[{id:"$pageview",name:"$pageview",type:"events",math:"dau"}],breakdown_type:"event",breakdown:"$feature/".concat(o.key)}),"data-attr":"usage",fullWidth:!0},"Try out in Insights"),t.a.createElement(w.b,null),o.id&&t.a.createElement(p.a,{type:"stealth",style:{color:"var(--danger)"},onClick:function(){Object(Q.x)({endpoint:"projects/".concat(j,"/feature_flags"),object:{name:o.key,id:o.id},callback:r})},fullWidth:!0},"Delete feature flag"))})}}];return t.a.createElement(t.a.Fragment,null,t.a.createElement("div",null,t.a.createElement(J.a.Search,{placeholder:"Search for feature flags",allowClear:!0,enterButton:!0,style:{maxWidth:400,width:"initial",flexGrow:1,marginBottom:"1rem"},value:O,onChange:function(m){s(m.target.value)}}),!g&&t.a.createElement("div",{className:"mb float-right"},t.a.createElement(U.a,{type:"primary",to:L.a.featureFlag("new"),"data-attr":"new-feature-flag",icon:t.a.createElement(K.a,null)},"New Feature Flag"))),t.a.createElement(k.a,{dataSource:i,columns:I,rowKey:"key",loading:A,defaultSorting:{columnKey:"key",order:1},pagination:{pageSize:100},nouns:["feature flag","feature flags"],"data-attr":"feature-flag-table"}))}function G(){var u=Object(E.useValues)(V.a),j=u.featureFlags,c=j[q.n.FEATURE_FLAGS_ACTIVITY_LOG],A=Object(E.useValues)(v.a),i=A.activeTab,O=Object(E.useActions)(v.a),n=O.setActiveTab;return t.a.createElement("div",{className:"feature_flags"},t.a.createElement(re.a,{title:"Feature Flags",caption:c?"":"Feature Flags are a way of turning functionality in your app on or off, based on user properties.",buttons:c?t.a.createElement(U.a,{type:"primary",to:L.a.featureFlag("new"),"data-attr":"new-feature-flag",icon:t.a.createElement(K.a,null)},"New Feature Flag"):!1}),c?t.a.createElement(W.a,{activeKey:i,destroyInactiveTabPane:!0,onChange:function(r){return n(r)}},t.a.createElement(W.a.TabPane,{tab:"Overview",key:"overview"},t.a.createElement(z,null)),t.a.createElement(W.a.TabPane,{tab:"History",key:"history"},t.a.createElement(ee.a,{scope:te.a.FEATURE_FLAG,describer:B.b}))):t.a.createElement(z,null))}function y(u){if(u.length===0||!u.some(function(O){return O.rollout_percentage!==0}))return"No users";if(u.some(function(O){var n;return!(!((n=O.properties)===null||n===void 0)&&n.length)&&[null,void 0,100].includes(O.rollout_percentage)}))return"All users";if(u.length===1){var j=u[0],c=j.properties,A=j.rollout_percentage,i=A===void 0?null:A;return(c==null?void 0:c.length)>0&&i!=null?t.a.createElement("div",{style:{display:"flex",alignItems:"center"}},t.a.createElement("span",{style:{flexShrink:0,marginRight:5}},i,"% of"),t.a.createElement(P.a,{filters:c,style:{margin:0,width:"100%"}})):(c==null?void 0:c.length)>0?t.a.createElement(P.a,{filters:c,style:{margin:0}}):i!==null?"".concat(i,"% of all users"):(console.error("A group with full rollout was not detected early"),"All users")}return"".concat(u.length," groups")}try{y.displayName="groupFilters",y.__docgenInfo={description:"",displayName:"groupFilters",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlags.tsx#groupFilters"]={docgenInfo:y.__docgenInfo,name:"groupFilters",path:"frontend/src/scenes/feature-flags/FeatureFlags.tsx#groupFilters"})}catch(u){}},"./frontend/src/scenes/feature-flags/featureFlagsLogic.ts":function(ae,T,e){"use strict";e.d(T,"a",function(){return O});var C=e("./node_modules/core-js/modules/es.array.concat.js"),Y=e.n(C),h=e("./node_modules/core-js/modules/es.array.filter.js"),H=e.n(h),D=e("./node_modules/core-js/modules/es.array.find.js"),R=e.n(D),M=e("./node_modules/core-js/modules/es.array.includes.js"),$=e.n(M),b=e("./node_modules/core-js/modules/es.array.iterator.js"),t=e.n(b),E=e("./node_modules/core-js/modules/es.array.map.js"),v=e.n(E),J=e("./node_modules/core-js/modules/es.object.to-string.js"),W=e.n(J),X=e("./node_modules/core-js/modules/es.object.values.js"),Q=e.n(X),K=e("./node_modules/core-js/modules/es.regexp.exec.js"),re=e.n(K),U=e("./node_modules/core-js/modules/es.string.includes.js"),se=e.n(U),L=e("./node_modules/core-js/modules/es.string.search.js"),oe=e.n(L),Z=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),p=e.n(Z),w=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),F=e.n(w),k=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),S=e.n(k),x=e("./node_modules/@babel/runtime/regenerator/index.js"),P=e.n(x),V=e("./node_modules/regenerator-runtime/runtime.js"),q=e.n(V),ee=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),B=e.n(ee),te=e("./node_modules/kea/lib/index.esm.js"),N=e("./frontend/src/lib/api.ts"),z=e("./node_modules/fuse.js/dist/fuse.esm.js"),G=e("./frontend/src/scenes/teamLogic.ts"),y=e("./frontend/src/scenes/urls.ts"),u=e("./node_modules/kea-router/lib/index.js"),j=e.n(u);function c(n,a){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);a&&(s=s.filter(function(_){return Object.getOwnPropertyDescriptor(n,_).enumerable})),r.push.apply(r,s)}return r}function A(n){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?c(Object(r),!0).forEach(function(s){F()(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}var i;(function(n){n.OVERVIEW="overview",n.HISTORY="history"})(i||(i={}));var O=Object(te.kea)({path:["scenes","feature-flags","featureFlagsLogic"],connect:{values:[G.a,["currentTeamId"]]},actions:{updateFlag:function(a){return{flag:a}},deleteFlag:function(a){return{id:a}},setSearchTerm:function(a){return{searchTerm:a}},setActiveTab:function(a){return{tabKey:a}}},loaders:function(a){var r=a.values;return{featureFlags:{__default:[],loadFeatureFlags:function(){var s=B()(P.a.mark(function d(){var g;return P.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,N.b.get("api/projects/".concat(r.currentTeamId,"/feature_flags/"));case 2:return g=l.sent,l.abrupt("return",g.results);case 4:case"end":return l.stop()}},d)}));function _(){return s.apply(this,arguments)}return _}(),updateFeatureFlag:function(){var s=B()(P.a.mark(function d(g){var I,l,m;return P.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return I=g.id,l=g.payload,f.next=3,N.b.update("api/projects/".concat(r.currentTeamId,"/feature_flags/").concat(I),l);case 3:return m=f.sent,f.abrupt("return",S()(r.featureFlags).map(function(ne){return ne.id===m.id?m:ne}));case 5:case"end":return f.stop()}},d)}));function _(d){return s.apply(this,arguments)}return _}()}}},selectors:{searchedFeatureFlags:[function(n){return[n.featureFlags,n.searchTerm]},function(n,a){return a?new z.a(n,{keys:["key","name"],threshold:.3}).search(a).map(function(r){return r.item}):n}],breadcrumbs:[function(){return[]},function(){return[{name:"Feature Flags",path:y.a.featureFlags()}]}]},reducers:{searchTerm:{setSearchTerm:function(a,r){var s=r.searchTerm;return s}},featureFlags:{updateFlag:function(a,r){var s=r.flag;return a.find(function(_){var d=_.id;return d===s.id})?a.map(function(_){return _.id===s.id?s:_}):[s].concat(S()(a))},deleteFlag:function(a,r){var s=r.id;return a.filter(function(_){return _.id!==s})}},activeTab:[i.OVERVIEW,{setActiveTab:function(a,r){var s=r.tabKey;return Object.values(i).includes(s)?s:a}}]},actionToUrl:function(a){var r=a.values;return{setActiveTab:function(){var _=A({},u.router.values.searchParams),d=!1;return!_.tab&&r.activeTab===i.OVERVIEW&&(d=!0),_.tab=r.activeTab,[u.router.values.location.pathname,_,u.router.values.hashParams,{replace:d}]}}},urlToAction:function(a){var r=a.actions,s=a.values;return F()({},y.a.featureFlags(),function(){var _=B()(P.a.mark(function d(g,I){var l;return P.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:l=I.tab,l?l!==s.activeTab&&r.setActiveTab(l):s.activeTab!==i.OVERVIEW&&r.setActiveTab(i.OVERVIEW);case 2:case"end":return o.stop()}},d)}));return function(d,g){return _.apply(this,arguments)}}())},events:function(a){var r=a.actions;return{afterMount:function(){r.loadFeatureFlags()}}}})}}]);
