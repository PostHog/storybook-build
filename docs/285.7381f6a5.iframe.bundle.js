(window.webpackJsonp=window.webpackJsonp||[]).push([[285],{"./frontend/src/scenes/feature-flags/FeatureFlag.tsx":function(je,M,n){"use strict";n.r(M),n.d(M,"scene",function(){return kn}),n.d(M,"FeatureFlag",function(){return ht});var q=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),$=n.n(q),Ee=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),S=n.n(Ee),Oe=n("./node_modules/core-js/modules/es.function.name.js"),Ie=n("./node_modules/core-js/modules/es.array.map.js"),de=n("./node_modules/core-js/modules/es.object.to-string.js"),Ce=n("./node_modules/core-js/modules/es.regexp.to-string.js"),Te=n("./node_modules/core-js/modules/es.array.find.js"),Ve=n("./node_modules/core-js/modules/es.array.includes.js"),ue=n("./node_modules/core-js/modules/es.string.includes.js"),Pe=n("./node_modules/core-js/modules/es.array.concat.js"),fe=n("./node_modules/react/index.js"),he=n("./node_modules/kea-forms/lib/index.js"),be=n("./node_modules/antd/es/divider/index.js"),A=n("./node_modules/antd/es/row/index.js"),L=n("./node_modules/antd/es/col/index.js"),x=n("./node_modules/antd/es/card/index.js"),Fe=n("./node_modules/antd/es/skeleton/index.js"),J=n("./node_modules/antd/es/tabs/index.js"),ie=n("./node_modules/antd/es/popconfirm/index.js"),_e=n("./node_modules/antd/es/radio/index.js"),V=n("./node_modules/antd/es/input-number/index.js"),le=n("./node_modules/antd/es/select/index.js"),m=n("./node_modules/kea/lib/index.esm.js"),T=n("./frontend/src/lib/utils.tsx"),Ke=n("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),Xe=n("./node_modules/@ant-design/icons/es/icons/LockOutlined.js"),at=n("./node_modules/core-js/modules/es.object.keys.js"),ne=n("./node_modules/core-js/modules/es.symbol.js"),Ze=n("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),yt=n("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Et=n("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),ot=n.n(Et),ke=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),me=n.n(ke),gt=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),Me=n.n(gt),it=n("./node_modules/@babel/runtime/regenerator/index.js"),C=n.n(it),pt=n("./node_modules/core-js/modules/es.array.iterator.js"),wt=n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Rt=n("./node_modules/core-js/modules/es.regexp.exec.js"),w=n("./node_modules/core-js/modules/es.string.match.js"),Q=n("./node_modules/core-js/modules/es.array.splice.js"),X=n("./node_modules/core-js/modules/web.dom-collections.for-each.js"),se=n("./node_modules/core-js/modules/es.string.replace.js"),qe=n("./node_modules/core-js/modules/es.promise.js"),Ue=n("./node_modules/core-js/modules/es.string.iterator.js"),lt=n("./node_modules/core-js/modules/es.array.filter.js"),y=n("./frontend/src/types.ts"),ce=n("./frontend/src/lib/api.ts"),we=n("./node_modules/kea-router/lib/index.js"),H=n("./frontend/src/scenes/urls.ts"),ct=n("./frontend/src/scenes/teamLogic.tsx"),ee=n("./frontend/src/scenes/feature-flags/featureFlagsLogic.ts"),nt=n("./frontend/src/models/groupsModel.ts"),Ge=n("./frontend/src/lib/components/TaxonomicFilter/types.ts"),xt=n("./frontend/src/lib/components/lemonToast.tsx"),Pt=n("./frontend/src/lib/utils/eventUsageLogic.ts"),jt=n("./node_modules/kea-loaders/lib/index.js"),$t=n("./frontend/src/scenes/insights/utils/cleanFilters.ts"),j=n("./frontend/src/lib/dayjs.ts"),p=n("./frontend/src/scenes/insights/sharedUtils.ts"),g=n("./node_modules/core-js/modules/es.array.slice.js"),O=n("./node_modules/core-js/modules/es.array.from.js"),D=n("./node_modules/core-js/modules/es.symbol.description.js"),B=n("./node_modules/core-js/modules/es.symbol.iterator.js");function N(s,t){var r=typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(!r){if(Array.isArray(s)||(r=K(s))||t&&s&&typeof s.length=="number"){r&&(s=r);var a=0,i=function(){};return{s:i,n:function(){return a>=s.length?{done:!0}:{done:!1,value:s[a++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,d=!1,c;return{s:function(){r=r.call(s)},n:function(){var l=r.next();return o=l.done,l},e:function(l){d=!0,c=l},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(d)throw c}}}}function K(s,t){if(!!s){if(typeof s=="string")return P(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P(s,t)}}function P(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=s[r];return a}var U=Object(m.kea)([Object(m.path)(["scenes","feature-flags","featureFlagPermissionsLogic"]),Object(m.props)({}),Object(m.key)(function(s){return"".concat(s.flagId)}),Object(m.actions)({setModalOpen:function(t){return{visible:t}},setRolesToAdd:function(t){return{roleIds:t}}}),Object(m.reducers)({permissionModalVisible:[!1,{setModalOpen:function(t,r){var a=r.visible;return a}}],rolesToAdd:[[],{setRolesToAdd:function(t,r){var a=r.roleIds;return a}}]}),Object(jt.loaders)(function(s){var t=s.props,r=s.values,a=s.actions;return{unfilteredAddableRoles:[[],{loadPossibleRolesToAdd:function(){var i=me()(C.a.mark(function d(){var c;return C.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,ce.b.roles.list({feature_flags_access_level:y.a.READ});case 2:return c=l.sent,l.abrupt("return",c.results||[]);case 4:case"end":return l.stop()}},d)}));function o(){return i.apply(this,arguments)}return o}()}],associatedRoles:[[],{loadAssociatedRoles:function(){var i=me()(C.a.mark(function d(){var c;return C.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!t.flagId){l.next=7;break}return l.next=3,ce.b.resourceAccessPermissions.featureFlags.list(t.flagId);case 3:return c=l.sent,l.abrupt("return",c.results||[]);case 7:return l.abrupt("return",[]);case 8:case"end":return l.stop()}},d)}));function o(){return i.apply(this,arguments)}return o}(),addAssociatedRoles:function(){var i=me()(C.a.mark(function d(c){var u,l,h;return C.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(u=r.rolesToAdd,l=t.flagId||c,!l){_.next=8;break}return _.next=5,Promise.all(u.map(function(){var E=me()(C.a.mark(function v(F){return C.a.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,ce.b.resourceAccessPermissions.featureFlags.create(l,F);case 2:return R.abrupt("return",R.sent);case 3:case"end":return R.stop()}},v)}));return function(v){return E.apply(this,arguments)}}()));case 5:return h=_.sent,a.setRolesToAdd([]),_.abrupt("return",[].concat($()(r.associatedRoles),$()(h)));case 8:return _.abrupt("return",r.associatedRoles);case 9:case"end":return _.stop()}},d)}));function o(d){return i.apply(this,arguments)}return o}(),deleteAssociatedRole:function(){var i=me()(C.a.mark(function d(c){var u,l,h;return C.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(l=c.roleId,h=(u=r.associatedRoles.find(function(E){return E.role.id===l}))===null||u===void 0?void 0:u.id,!t.flagId){_.next=7;break}if(_.t0=h,!_.t0){_.next=7;break}return _.next=7,ce.b.resourceAccessPermissions.featureFlags.delete(t.flagId,h);case 7:return _.abrupt("return",r.associatedRoles.filter(function(E){return E.id!==h}));case 8:case"end":return _.stop()}},d)}));function o(d){return i.apply(this,arguments)}return o}()}]}}),Object(m.selectors)({derivedRoles:[function(s){return[s.associatedRoles]},function(s){return s.map(function(t){return t.role})}],addableRoles:[function(s){return[s.unfilteredAddableRoles,s.associatedRoles]},function(s,t){var r=[],a=N(s),i;try{var o=function(){var c=i.value;t.some(function(u){return u.role.id===c.id})||r.push(c)};for(a.s();!(i=a.n()).done;)o()}catch(d){a.e(d)}finally{a.f()}return r}]}),Object(m.afterMount)(function(s){var t=s.actions;t.loadPossibleRolesToAdd(),t.loadAssociatedRoles()})]),G=n("./frontend/src/scenes/userLogic.ts"),He=["created_at","id"];function Se(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),r.push.apply(r,a)}return r}function f(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Se(Object(r),!0).forEach(function(a){Me()(s,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Se(Object(r)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(r,a))})}return s}var Gt=function(){return{operator:"gt",threshold_type:y.V.Sentry,threshold:50,threshold_metric:f({},Object($t.a)({insight:y.F.TRENDS,date_from:Object(j.a)().subtract(7,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(j.a)().endOf("d").format("YYYY-MM-DDTHH:mm")}))}},Ft={id:null,created_at:null,key:"",name:"",filters:{groups:[{properties:[],rollout_percentage:null,variant:null}],multivariate:null},deleted:!1,active:!0,created_by:null,is_simple_flag:!1,rollout_percentage:null,ensure_experience_continuity:!1,experiment_set:null,rollback_conditions:[],performed_rollback:!1,can_edit:!0},et={key:"",name:"",rollout_percentage:0},vn={variants:[{key:"",name:"",rollout_percentage:100}]},On=function(t){return{events:[{id:"$feature_flag_called",name:"$feature_flag_called",type:"events",properties:Ht(t)}]}},Ht=function(t){return[{key:"$feature/"+t,type:y.N.Event,value:["false"],operator:y.P.IsNot},{key:"$feature/"+t,type:y.N.Event,value:"is_set",operator:y.P.IsSet},{key:"$feature_flag",type:y.N.Event,value:t,operator:y.P.Exact}]},Be=Object(m.kea)([Object(m.path)(["scenes","feature-flags","featureFlagLogic"]),Object(m.props)({}),Object(m.key)(function(s){var t=s.id;return t!=null?t:"unknown"}),Object(m.connect)({values:[ct.a,["currentTeamId","sentryIntegrationEnabled"],nt.a,["groupTypes","groupsTaxonomicTypes","aggregationLabel"],G.a,["hasAvailableFeature"]]}),Object(m.actions)({setFeatureFlag:function(t){return{featureFlag:t}},setFeatureFlagMissing:!0,addConditionSet:!0,addRollbackCondition:!0,setAggregationGroupTypeIndex:function(t){return{value:t}},removeConditionSet:function(t){return{index:t}},removeRollbackCondition:function(t){return{index:t}},duplicateConditionSet:function(t){return{index:t}},updateConditionSet:function(t,r,a,i){return{index:t,newRolloutPercentage:r,newProperties:a,newVariant:i}},deleteFeatureFlag:function(t){return{featureFlag:t}},setMultivariateEnabled:function(t){return{enabled:t}},setMultivariateOptions:function(t){return{multivariateOptions:t}},addVariant:!0,duplicateVariant:function(t){return{index:t}},removeVariant:function(t){return{index:t}},editFeatureFlag:function(t){return{editing:t}},distributeVariantsEqually:!0,setFilters:function(t){return{filters:t}},loadInsightAtIndex:function(t,r){return{index:t,filters:r}},setInsightResultAtIndex:function(t,r){return{index:t,average:r}},loadAllInsightsForFlag:!0,setAffectedUsers:function(t,r){return{index:t,count:r}},setTotalUsers:function(t){return{count:t}}}),Object(he.forms)(function(s){var t=s.actions,r=s.values;return{featureFlag:{defaults:f({},Ft),errors:function(i){var o,d,c,u=i.key,l=i.filters;return{key:u?(o=u.match)!==null&&o!==void 0&&o.call(u,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key",filters:{multivariate:{variants:l==null||(d=l.multivariate)===null||d===void 0||(c=d.variants)===null||c===void 0?void 0:c.map(function(h){var b,_=h.key;return{key:_?(b=_.match)!==null&&b!==void 0&&b.call(_,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key"}})},groups:r.propertySelectErrors}}},submit:function(i){t.saveFeatureFlag(i)}}}}),Object(m.reducers)({featureFlag:[f({},Ft),{setFeatureFlag:function(t,r){var a=r.featureFlag;if(a.filters.groups){var i=a.filters.groups.map(function(o){return o.properties?f(f({},o),{},{properties:Object(T.r)(o.properties)}):o});return f(f({},a),{},{filters:f(f({},a==null?void 0:a.filters),{},{groups:i})})}return a},addConditionSet:function(t){if(!t)return t;var r=[].concat($()(t==null?void 0:t.filters.groups),[{properties:[],rollout_percentage:null,variant:null}]);return f(f({},t),{},{filters:f(f({},t.filters),{},{groups:r})})},addRollbackCondition:function(t){return t&&f(f({},t),{},{rollback_conditions:[].concat($()(t.rollback_conditions),[Gt()])})},removeRollbackCondition:function(t,r){var a=r.index;if(!t)return t;var i=$()(t.rollback_conditions);return i.splice(a,1),f(f({},t),{},{rollback_conditions:i})},updateConditionSet:function(t,r){var a=r.index,i=r.newRolloutPercentage,o=r.newProperties,d=r.newVariant;if(!t)return t;var c=$()(t==null?void 0:t.filters.groups);return i!==void 0&&(c[a]=f(f({},c[a]),{},{rollout_percentage:i})),o!==void 0&&(c[a]=f(f({},c[a]),{},{properties:o})),d!==void 0&&(c[a]=f(f({},c[a]),{},{variant:d})),f(f({},t),{},{filters:f(f({},t.filters),{},{groups:c})})},removeConditionSet:function(t,r){var a=r.index;if(!t)return t;var i=$()(t.filters.groups);return i.splice(a,1),f(f({},t),{},{filters:f(f({},t.filters),{},{groups:i})})},duplicateConditionSet:function(t,r){var a=r.index;if(!t)return t;var i=t.filters.groups.concat([t.filters.groups[a]]);return f(f({},t),{},{filters:f(f({},t.filters),{},{groups:i})})},setMultivariateOptions:function(t,r){var a=r.multivariateOptions;return t&&f(f({},t),{},{filters:f(f({},t.filters),{},{multivariate:a})})},addVariant:function(t){var r;if(!t)return t;var a=$()(((r=t.filters.multivariate)===null||r===void 0?void 0:r.variants)||[]);return f(f({},t),{},{filters:f(f({},t.filters),{},{multivariate:f(f({},t.filters.multivariate||{}),{},{variants:[].concat($()(a),[et])})})})},removeVariant:function(t,r){var a,i=r.index;if(!t)return t;var o=$()(((a=t.filters.multivariate)===null||a===void 0?void 0:a.variants)||[]);return o.splice(i,1),f(f({},t),{},{filters:f(f({},t.filters),{},{multivariate:f(f({},t.filters.multivariate),{},{variants:o})})})},distributeVariantsEqually:function(t){var r;if(!t)return t;var a=$()(((r=t.filters.multivariate)===null||r===void 0?void 0:r.variants)||[]),i=a.length;if(i>0&&i<=100){var o=Math.round(100/i),d=o*i,c=d-100;a.forEach(function(u,l){a[l]=f(f({},u),{},{rollout_percentage:o})}),a[i-1]=f(f({},a[i-1]),{},{rollout_percentage:o-c})}return f(f({},t),{},{filters:f(f({},t.filters),{},{multivariate:f(f({},t.filters.multivariate),{},{variants:a})})})},setAggregationGroupTypeIndex:function(t,r){var a=r.value;return!t||t.filters.aggregation_group_type_index==a?t:f(f({},t),{},{filters:f(f({},t.filters),{},{aggregation_group_type_index:a,groups:[{properties:[],rollout_percentage:null,variant:null}]})})}}],featureFlagMissing:[!1,{setFeatureFlagMissing:function(){return!0}}],isEditingFlag:[!1,{editFeatureFlag:function(t,r){var a=r.editing;return a}}],insightRollingAverages:[{},{setInsightResultAtIndex:function(t,r){var a=r.index,i=r.average;return f(f({},t),{},Me()({},"".concat(a),i))}}],affectedUsers:[{},{setAffectedUsers:function(t,r){var a=r.index,i=r.count;return f(f({},t),{},Me()({},a,i))},resetFeatureFlag:function(){return{0:-1}},loadFeatureFlag:function(){return{0:-1}}}],totalUsers:[null,{setTotalUsers:function(t,r){var a=r.count;return a}}]}),Object(jt.loaders)(function(s){var t=s.values,r=s.props,a=s.actions;return{featureFlag:{loadFeatureFlag:function(){var i=me()(C.a.mark(function d(){return C.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(r.id&&r.id!=="new")){u.next=11;break}return u.prev=1,u.next=4,ce.b.get("api/projects/".concat(t.currentTeamId,"/feature_flags/").concat(r.id));case 4:return u.abrupt("return",u.sent);case 7:throw u.prev=7,u.t0=u.catch(1),a.setFeatureFlagMissing(),u.t0;case 11:return u.abrupt("return",Ft);case 12:case"end":return u.stop()}},d,null,[[1,7]])}));function o(){return i.apply(this,arguments)}return o}(),saveFeatureFlag:function(){var i=me()(C.a.mark(function d(c){var u,l,h,b,_;return C.a.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(u=c.created_at,l=c.id,h=ot()(c,He),v.prev=1,c.id){v.next=10;break}return v.next=5,ce.b.create("api/projects/".concat(t.currentTeamId,"/feature_flags"),h);case 5:return b=v.sent,t.roleBasedAccessEnabled&&((_=U({flagId:null}))===null||_===void 0||_.actions.addAssociatedRoles(b.id)),v.abrupt("return",b);case 10:return v.next=12,ce.b.update("api/projects/".concat(t.currentTeamId,"/feature_flags/").concat(c.id),h);case 12:return v.abrupt("return",v.sent);case 13:v.next=19;break;case 15:throw v.prev=15,v.t0=v.catch(1),(v.t0.code==="behavioral_cohort_found"||v.t0.code==="cohort_does_not_exist")&&Pt.e.actions.reportFailedToCreateFeatureFlagWithCohort(v.t0.code,v.t0.detail),v.t0;case 19:case"end":return v.stop()}},d,null,[[1,15]])}));function o(d){return i.apply(this,arguments)}return o}()},recentInsights:[[],{loadRecentInsights:function(){var i=me()(C.a.mark(function d(){var c;return C.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(r.id&&r.id!=="new"&&t.featureFlag.key)){l.next=5;break}return l.next=3,ce.b.get("api/projects/".concat(t.currentTeamId,"/insights/?feature_flag=").concat(t.featureFlag.key,"&order=-created_at"));case 3:return c=l.sent,l.abrupt("return",c.results);case 5:return l.abrupt("return",[]);case 6:case"end":return l.stop()}},d)}));function o(){return i.apply(this,arguments)}return o}()}],sentryErrorCount:[void 0,{loadSentryErrorCount:function(){var i=me()(C.a.mark(function d(){var c;return C.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,ce.b.get("api/sentry_errors/");case 2:return c=l.sent,l.abrupt("return",c.total_count);case 4:case"end":return l.stop()}},d)}));function o(){return i.apply(this,arguments)}return o}()}]}}),Object(m.listeners)(function(s){var t=s.actions,r=s.values;return{saveFeatureFlagSuccess:function(i){var o,d=i.featureFlag;xt.d.success("Feature flag saved"),(o=ee.b.findMounted())===null||o===void 0||o.actions.updateFlag(d),we.router.actions.replace(H.a.featureFlag(d.id)),t.editFeatureFlag(!1)},deleteFeatureFlag:function(){var a=me()(C.a.mark(function o(d){var c;return C.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:c=d.featureFlag,Object(T.x)({endpoint:"projects/".concat(r.currentTeamId,"/feature_flags"),object:{name:c.name,id:c.id},callback:function(){var b,_;c.id&&((b=ee.b.findMounted())===null||b===void 0||b.actions.deleteFlag(c.id)),(_=ee.b.findMounted())===null||_===void 0||_.actions.loadFeatureFlags(),we.router.actions.push(H.a.featureFlags())}});case 2:case"end":return l.stop()}},o)}));function i(o){return a.apply(this,arguments)}return i}(),setMultivariateEnabled:function(){var a=me()(C.a.mark(function o(d){var c;return C.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:c=d.enabled,c?t.setMultivariateOptions(vn):t.setMultivariateOptions(null);case 2:case"end":return l.stop()}},o)}));function i(o){return a.apply(this,arguments)}return i}(),loadFeatureFlagSuccess:function(){var a=me()(C.a.mark(function o(){return C.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:t.loadRecentInsights(),t.loadAllInsightsForFlag();case 2:case"end":return c.stop()}},o)}));function i(){return a.apply(this,arguments)}return i}(),loadInsightAtIndex:function(){var a=me()(C.a.mark(function o(d){var c,u,l,h,b,_,E;return C.a.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(c=d.index,u=d.filters,!u){F.next=8;break}return F.next=4,ce.b.get("api/projects/".concat(r.currentTeamId,"/insights/trend/?").concat(Object(T.Gb)(Object(p.a)(u))));case 4:b=F.sent,_=(l=b.result)===null||l===void 0||(h=l[0])===null||h===void 0?void 0:h.data,E=Math.round(Object(T.Fb)(_)/7),t.setInsightResultAtIndex(c,E);case 8:case"end":return F.stop()}},o)}));function i(o){return a.apply(this,arguments)}return i}(),loadAllInsightsForFlag:function(){var i;(i=r.featureFlag.rollback_conditions)===null||i===void 0||i.forEach(function(o,d){o.threshold_metric&&t.loadInsightAtIndex(d,o.threshold_metric)})},addRollbackCondition:function(){var i=r.featureFlag.rollback_conditions.length-1;t.loadInsightAtIndex(i,r.featureFlag.rollback_conditions[i].threshold_metric)},updateConditionSet:function(){var a=me()(C.a.mark(function o(d,c){var u,l,h;return C.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(u=d.index,l=d.newProperties,l&&t.setAffectedUsers(u,void 0),!(!l||l.some(function(E){return E.value===null||E.value===void 0||Array.isArray(E.value)&&E.value.length===0}))){_.next=4;break}return _.abrupt("return");case 4:return _.next=6,c(1e3);case 6:return _.next=8,ce.b.create("api/projects/".concat(r.currentTeamId,"/feature_flags/user_blast_radius"),{condition:{properties:l}});case 8:h=_.sent,t.setAffectedUsers(u,h.users_affected),t.setTotalUsers(h.total_users);case 11:case"end":return _.stop()}},o)}));function i(o,d){return a.apply(this,arguments)}return i}(),addConditionSet:function(){t.setAffectedUsers(r.featureFlag.filters.groups.length-1,-1)},editFeatureFlag:function(){var a=me()(C.a.mark(function o(d){var c,u,l,h,b,_;return C.a.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(h=d.editing,h){v.next=3;break}return v.abrupt("return");case 3:return b=[],(c=r.featureFlag)===null||c===void 0||(u=c.filters)===null||u===void 0||(l=u.groups)===null||l===void 0||l.forEach(function(F,I){t.setAffectedUsers(I,void 0);var R=F.properties;if(!R||(R==null?void 0:R.length)===0||R.some(function(ge){return ge.value===null||ge.value===void 0||Array.isArray(ge.value)&&ge.value.length===0}))b.push(Promise.resolve({users_affected:-1,total_users:-1}));else{var ae=ce.b.create("api/projects/".concat(r.currentTeamId,"/feature_flags/user_blast_radius"),{condition:F});b.push(ae)}}),v.next=7,Promise.all(b);case 7:_=v.sent,_.forEach(function(F,I){t.setAffectedUsers(I,F.users_affected),F.total_users!==-1&&t.setTotalUsers(F.total_users)});case 9:case"end":return v.stop()}},o)}));function i(o){return a.apply(this,arguments)}return i}()}}),Object(m.selectors)({props:[function(){return[function(s,t){return t}]},function(s){return s}],multivariateEnabled:[function(s){return[s.featureFlag]},function(s){return!!(s!=null&&s.filters.multivariate)}],roleBasedAccessEnabled:[function(s){return[s.hasAvailableFeature]},function(s){return s(y.e.ROLE_BASED_ACCESS)}],variants:[function(s){return[s.featureFlag]},function(s){var t;return(s==null||(t=s.filters.multivariate)===null||t===void 0?void 0:t.variants)||[]}],nonEmptyVariants:[function(s){return[s.variants]},function(s){return s.filter(function(t){var r=t.key;return!!r})}],variantRolloutSum:[function(s){return[s.variants]},function(s){return s.reduce(function(t,r){var a=r.rollout_percentage;return t+a},0)}],areVariantRolloutsValid:[function(s){return[s.variants,s.variantRolloutSum]},function(s,t){return s.every(function(r){var a=r.rollout_percentage;return a>=0&&a<=100})&&t===100}],aggregationTargetName:[function(s){return[s.featureFlag,s.groupTypes,s.aggregationLabel]},function(s,t,r){return s&&s.filters.aggregation_group_type_index!=null&&t.length>0?r(s.filters.aggregation_group_type_index).plural:"users"}],taxonomicGroupTypes:[function(s){return[s.featureFlag,s.groupsTaxonomicTypes]},function(s,t){return s&&s.filters.aggregation_group_type_index!=null&&t.length>0?[t[s.filters.aggregation_group_type_index]]:[Ge.a.PersonProperties,Ge.a.Cohorts]}],breadcrumbs:[function(s){return[s.featureFlag]},function(s){return[{name:"Feature Flags",path:H.a.featureFlags()}].concat($()(s?[{name:s.key||"Unnamed"}]:[]))}],propertySelectErrors:[function(s){return[s.featureFlag]},function(s){var t,r;return s==null||(t=s.filters)===null||t===void 0||(r=t.groups)===null||r===void 0?void 0:r.map(function(a){var i=a.properties;return{properties:i==null?void 0:i.map(function(o){return{value:o.value===null||o.value===void 0||Array.isArray(o.value)&&o.value.length===0?"Property filters can't be empty":void 0}})}})}],computeBlastRadiusPercentage:[function(s){return[s.affectedUsers,s.totalUsers]},function(s,t){return function(r,a){var i=r;if(r==null&&(i=100),s[a]===-1||t===-1||!t)return i;var o=t;return o===0&&(o=1),i*(s[a]/o)}}],approximateTotalBlastRadius:[function(s){return[s.computeBlastRadiusPercentage,s.featureFlag]},function(s,t){if(!t||!t.filters.groups)return 0;var r=0;return t.filters.groups.forEach(function(a,i){r+=s(a.rollout_percentage,i)}),Math.min(r,100)}]}),Object(we.urlToAction)(function(s){var t,r=s.actions,a=s.props;return Me()({},H.a.featureFlag((t=a.id)!==null&&t!==void 0?t:"new"),function(i,o,d,c){var u=c.method;u==="PUSH"&&(a.id?r.loadFeatureFlag():r.resetFeatureFlag())})}),Object(m.afterMount)(function(s){var t,r=s.props,a=s.actions,i=(t=ee.b.findMounted())===null||t===void 0?void 0:t.values.featureFlags.find(function(o){return o.id===r.id});i?(a.setFeatureFlag(i),a.loadRecentInsights(),a.loadAllInsightsForFlag()):r.id!=="new"&&a.loadFeatureFlag(),a.loadSentryErrorCount()})]),Yt=n("./frontend/src/lib/logic/featureFlagLogic.ts"),Z=n("./frontend/src/lib/components/icons.tsx"),Ye=n("./frontend/src/lib/components/LemonDivider/index.ts"),Re=n("./frontend/src/lib/components/CodeSnippet/index.tsx"),e=n("./node_modules/react/jsx-runtime.js"),tt="?utm_medium=in-product&utm_campaign=feature-flag";function At(s){var t=s.flagKey;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(Re.a,{language:Re.b.JavaScript,wrap:!0,children:"const isMyFlagEnabledForUser = await client.isFeatureEnabled('".concat(t,`', 'user distinct id')

if (isMyFlagEnabledForUser) {
    // Do something differently for this user
}`)})})}function It(s){var t=s.flagKey;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(Re.a,{language:Re.b.JavaScript,wrap:!0,children:"if\xA0(posthog.isFeatureEnabled('".concat(t!=null?t:"",`')) {
    // run your activation code here
}`)})})}function Ct(s){var t=s.flagKey;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(Re.a,{language:Re.b.PHP,wrap:!0,children:"if (PostHog::isFeatureEnabled('".concat(t,`', 'some distinct id')) {
    // do something here
}`)})})}function Tt(s){var t=s.flagKey;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(Re.a,{language:Re.b.Go,wrap:!0,children:`isFlagEnabledForUser, err := client.IsFeatureEnabled(
                    FeatureFlagPayload{
                        Key:        '`.concat(t,`',
                        DistinctId: "distinct-id",
                    })

if (isFlagEnabledForUser) {
  // Do something differently for this user
}`)})})}function Mt(s){var t=s.flagKey;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(Re.a,{language:Re.b.Ruby,wrap:!0,children:"is_my_flag_enabled = posthog.is_feature_enabled('".concat(t,`', 'user distinct id')

if is_my_flag_enabled
  # Do something differently for this user
end`)})})}function St(s){var t=s.flagKey;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(Re.a,{language:Re.b.Python,wrap:!0,children:'if posthog.feature_enabled("'.concat(t,`", "user_distinct_id"):
    runAwesomeFeature()
`)})})}function hn(){var s=Object(m.useValues)(ct.a),t=s.currentTeam;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(Re.a,{language:Re.b.Bash,wrap:!0,children:"curl ".concat(window.location.origin,`/decide/ \\
-X POST -H 'Content-Type: application/json' \\
-d '{
    "api_key": "`).concat(t?t.api_token:"[project_api_key]",`",
    "distinct_id": "[user distinct id]"
}'
                `)})})}try{At.displayName="NodeJSSnippet",At.__docgenInfo={description:"",displayName:"NodeJSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#NodeJSSnippet"]={docgenInfo:At.__docgenInfo,name:"NodeJSSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#NodeJSSnippet"})}catch(s){}try{It.displayName="JSSnippet",It.__docgenInfo={description:"",displayName:"JSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"]={docgenInfo:It.__docgenInfo,name:"JSSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"})}catch(s){}try{Ct.displayName="PHPSnippet",Ct.__docgenInfo={description:"",displayName:"PHPSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PHPSnippet"]={docgenInfo:Ct.__docgenInfo,name:"PHPSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PHPSnippet"})}catch(s){}try{Tt.displayName="GolangSnippet",Tt.__docgenInfo={description:"",displayName:"GolangSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#GolangSnippet"]={docgenInfo:Tt.__docgenInfo,name:"GolangSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#GolangSnippet"})}catch(s){}try{Mt.displayName="RubySnippet",Mt.__docgenInfo={description:"",displayName:"RubySnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#RubySnippet"]={docgenInfo:Mt.__docgenInfo,name:"RubySnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#RubySnippet"})}catch(s){}try{St.displayName="PythonSnippet",St.__docgenInfo={description:"",displayName:"PythonSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"]={docgenInfo:St.__docgenInfo,name:"PythonSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"})}catch(s){}var bn=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),qt=n.n(bn),yn=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlagInstructions.scss"),en=n.n(yn),zt={};zt.insert="head",zt.singleton=!1;var ts=qt()(en.a,zt),ns=en.a.locals||{},st="https://posthog.com/docs/",dt="#feature-flags",Jt=[{value:"JavaScript",documentationLink:"".concat(st,"integrations/js-integration").concat(tt).concat(dt),Icon:Z.IconJavascript,Snippet:It},{value:"Node.js",documentationLink:"".concat(st,"integrations/node-integration").concat(tt).concat(dt),Icon:Z.IconNodeJS,Snippet:At},{value:"PHP",documentationLink:"".concat(st,"integrations/php-integration").concat(tt).concat(dt),Icon:Z.IconPHP,Snippet:Ct},{value:"Ruby",documentationLink:"".concat(st,"integrations/ruby-integration").concat(tt).concat(dt),Icon:Z.IconRuby,Snippet:Mt},{value:"Golang",documentationLink:"".concat(st,"integrations/go-integration").concat(tt).concat(dt),Icon:Z.IconGolang,Snippet:Tt},{value:"Python",documentationLink:"".concat(st,"integrations/python-integration").concat(tt).concat(dt),Icon:Z.IconPython,Snippet:St},{value:"API",documentationLink:"".concat(st,"api/feature-flags").concat(tt),Icon:Z.IconOpenInNew,Snippet:hn}];function En(s){var t=s.selectedOptionValue,r=s.selectOption;return Object(e.jsxs)(A.a,{className:"FeatureFlagInstructionsHeader",justify:"space-between",align:"middle",children:[Object(e.jsxs)("div",{className:"FeatureFlagInstructionsHeader__header-title",children:[Object(e.jsx)(Z.IconFlag,{className:"FeatureFlagInstructionsHeader__header-title__icon"}),Object(e.jsx)("b",{children:"Learn how to use feature flags in your code"})]}),Object(e.jsx)(le.a,{"data-attr":"feature-flag-instructions-select",value:t,style:{width:140},onChange:r,children:Jt.map(function(a,i){var o=a.value,d=a.Icon;return Object(e.jsx)(le.a.Option,{"data-attr":"feature-flag-instructions-select-option-"+o,value:o,children:Object(e.jsxs)("div",{className:"FeatureFlagInstructionsHeader__option",children:[Object(e.jsx)("div",{className:"FeatureFlagInstructionsHeader__option__icon",children:Object(e.jsx)(d,{})}),Object(e.jsx)("div",{children:o})]})},i)})})]})}function Rn(s){var t=s.documenrationLink;return Object(e.jsxs)("div",{className:"mt-4",children:["Need more information?"," ",Object(e.jsxs)("a",{"data-attr":"feature-flag-doc-link",target:"_blank",rel:"noopener",href:t,children:["Check the docs ",Object(e.jsx)(Z.IconOpenInNew,{})]})]})}function _t(s){var t=s.featureFlagKey,r=Jt[0],a=Object(fe.useState)(r),i=S()(a,2),o=i[0],d=i[1],c=function(l){var h=Jt.find(function(b){return b.value===l});h&&d(h)};return Object(e.jsxs)(x.a,{size:"small",children:[Object(e.jsx)(En,{selectedOptionValue:o.value,selectOption:c}),Object(e.jsx)(Ye.a,{}),Object(e.jsx)("div",{className:"mt mb",children:Object(e.jsx)(o.Snippet,{"data-attr":"feature-flag-instructions-snippet",flagKey:t})}),Object(e.jsx)(Ye.a,{}),Object(e.jsx)(Rn,{documenrationLink:o.documentationLink})]})}try{_t.displayName="FeatureFlagInstructions",_t.__docgenInfo={description:"",displayName:"FeatureFlagInstructions",props:{featureFlagKey:{defaultValue:null,description:"",name:"featureFlagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagInstructions.tsx#FeatureFlagInstructions"]={docgenInfo:_t.__docgenInfo,name:"FeatureFlagInstructions",path:"frontend/src/scenes/feature-flags/FeatureFlagInstructions.tsx#FeatureFlagInstructions"})}catch(s){}var tn=n("./frontend/src/lib/components/PageHeader.tsx"),xn=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss"),nn=n.n(xn),Qt={};Qt.insert="head",Qt.singleton=!1;var ss=qt()(nn.a,Qt),rs=nn.a.locals||{},Pn=n("./frontend/src/lib/components/Tooltip.tsx"),Fn=n("./node_modules/rc-select/es/index.js"),Lt=n("./frontend/src/lib/components/Link.tsx"),Dt=n("./frontend/src/lib/introductions/groupsAccessLogic.ts");function Kt(s){var t=s.value,r=Object(m.useValues)(Dt.b),a=r.groupsAccessStatus;return[Dt.a.HasAccess,Dt.a.HasGroupTypes,Dt.a.NoAccess].includes(a)?Object(e.jsxs)(Fn.c.Option,{value:t,disabled:!0,style:{height:"100%",width:"100%",overflow:"hidden",textOverflow:"ellipsis",backgroundColor:"var(--side)",color:"var(--muted)"},children:[Object(e.jsx)(Xe.a,{style:{marginRight:6,color:"var(--warning)"}}),"Unique groups \u2013"," ",Object(e.jsx)(Lt.a,{to:"https://posthog.com/docs/user-guides/group-analytics?utm_medium=in-product&utm_campaign=group-analytics-learn-more",target:"_blank","data-attr":"group-analytics-learn-more",className:"font-semibold",children:"Learn more"})]},"groups"):null}try{Kt.displayName="GroupsIntroductionOption",Kt.__docgenInfo={description:"",displayName:"GroupsIntroductionOption",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"]={docgenInfo:Kt.__docgenInfo,name:"GroupsIntroductionOption",path:"frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"})}catch(s){}var ye=n("./frontend/src/lib/components/LemonButton/index.ts"),Ae=n("./frontend/src/lib/forms/Field.tsx"),An=n("./frontend/src/lib/components/LemonTextArea/LemonTextArea.tsx"),Xt=n("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),sn=n("./frontend/src/lib/components/LemonCheckbox/index.ts"),In=n("./frontend/src/scenes/events/EventBufferNotice.tsx"),rn=n("./frontend/src/lib/components/AlertMessage/index.ts"),vt=n("./frontend/src/lib/components/Spinner/Spinner.tsx"),an=n("./frontend/src/lib/components/CopyToClipboard.tsx"),Ut=n("./frontend/src/lib/components/Lettermark/Lettermark.tsx"),Ne=n("./frontend/src/lib/constants.tsx"),on=n("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),Cn=n("./frontend/src/lib/components/ActivityLog/ActivityLog.tsx"),Tn=n("./frontend/src/lib/components/ActivityLog/humanizeActivity.tsx"),Mn=n("./frontend/src/lib/components/DefinitionPopup/utils.ts"),ln=n("./frontend/src/lib/components/CompactList/CompactList.tsx"),Sn=n("./frontend/src/scenes/project-homepage/RecentInsights.tsx");function Ln(){var s=Object(m.useValues)(Be),t=s.recentInsights,r=s.recentInsightsLoading,a=s.featureFlag;return Object(e.jsx)(ln.a,{title:"Insights that use this feature flag",loading:r,emptyMessage:{title:"You have no insights that use this feature flag",description:"Explore this feature flag's insights by creating one below.",buttonText:"Create insight",buttonTo:H.a.insightNew({events:[{id:"$pageview",name:"$pageview",type:"events",math:"dau"}],breakdown_type:"event",breakdown:"$feature/".concat(a.key)})},items:t.slice(0,5),renderRow:function(o,d){return Object(e.jsx)(Sn.a,{insight:o},d)}})}var Dn=n("./frontend/src/lib/components/NotFound/index.tsx"),Kn=n("./frontend/src/models/cohortsModel.ts"),re=n("./frontend/@posthog/lemon-ui/src/index.ts"),Un=n("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilter.tsx"),Bn=n("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilterRow/ActionFilterRow.tsx");function cn(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),r.push.apply(r,a)}return r}function Nn(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cn(Object(r),!0).forEach(function(a){Me()(s,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):cn(Object(r)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(r,a))})}return s}function Ot(s){var t=s.readOnly,r=Object(m.useValues)(Be),a=r.featureFlag,i=r.sentryIntegrationEnabled,o=r.sentryErrorCount,d=r.insightRollingAverages,c=Object(m.useActions)(Be),u=c.addRollbackCondition,l=c.removeRollbackCondition,h=c.loadInsightAtIndex,b=Object(m.useValues)(G.a),_=b.user;return Object(e.jsxs)("div",{children:[Object(e.jsxs)("div",{className:"mb-2",children:[Object(e.jsx)("b",{children:"Auto rollback"}),Object(e.jsx)(re.LemonTag,{type:"warning",className:"uppercase ml-2",children:"Beta"}),!t&&Object(e.jsx)("div",{className:"mt-2",children:"Specify the conditions in which this feature flag will automatically roll back."})]}),t&&a.rollback_conditions&&a.rollback_conditions.map(function(E,v){var F,I,R;return Object(e.jsxs)(e.Fragment,{children:[v>0&&Object(e.jsx)("div",{className:"condition-set-separator",children:"OR"}),E.threshold_type==="insight"&&(F=E.threshold_metric)!==null&&F!==void 0&&(I=F.events)!==null&&I!==void 0&&(R=I[0])!==null&&R!==void 0&&R.name?Object(e.jsxs)("div",{className:"mb-4 border rounded p-4",children:[Object(e.jsx)("b",{children:"".concat(Object(T.i)(E.threshold_type)," based rollback")}),Object(e.jsx)(re.LemonDivider,{className:"my-3"}),Object(e.jsxs)(A.a,{align:"middle",children:[d[v]&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("b",{children:E.threshold_metric.events[0].name}),"\xA0 trailing average is ",d[v],"."]}),"\xA0Trigger when trailing average of \xA0",Object(e.jsx)("b",{children:E.threshold_metric.events[0].name}),"\xA0 is\xA0",E.operator&&T.J[E.operator]," ",E.threshold]})]}):Object(e.jsxs)("div",{className:"mb-4 border rounded p-4",children:[Object(e.jsx)("b",{children:"".concat(Object(T.i)(E.threshold_type)," based rollback")}),Object(e.jsx)(re.LemonDivider,{className:"my-3"}),Object(e.jsxs)(A.a,{align:"middle",children:["Trigger when there is a\xA0",Object(e.jsxs)("b",{children:[E.threshold,"%"]}),"\xA0increase in errors"]})]})]})}),!t&&a.rollback_conditions&&a.rollback_conditions.map(function(E,v){return Object(e.jsxs)(e.Fragment,{children:[v>0&&Object(e.jsx)("div",{className:"condition-set-separator",children:"OR"}),Object(e.jsx)("div",{className:"mb-4 border rounded p-4",children:Object(e.jsxs)(he.Group,{name:["rollback_conditions",v],children:[Object(e.jsxs)(A.a,{align:"middle",justify:"space-between",children:[Object(e.jsxs)(A.a,{children:[Object(e.jsx)("div",{className:"mt-3 mr-3",children:Object(e.jsx)("b",{children:"Rollback Condition Type"})}),Object(e.jsx)(Ae.a,{name:"threshold_type",children:function(I){var R=I.value,ae=I.onChange;return Object(e.jsx)(re.LemonSelect,{value:R,onChange:ae,options:[{value:y.V.Sentry,label:"Error Based"},{value:y.V.Insight,label:"Metric Based"}]})}})]}),Object(e.jsx)(re.LemonButton,{icon:Object(e.jsx)(Z.IconDelete,{}),status:"muted",noPadding:!0,onClick:function(){l(v)}})]}),Object(e.jsx)(re.LemonDivider,{className:"my-3"}),a.rollback_conditions[v].threshold_type=="insight"?Object(e.jsxs)("div",{className:"flex gap-2 items-center mt-4",children:[Object(e.jsx)(Ae.a,{name:"threshold_metric",children:function(I){var R=I.value,ae=I.onChange;return Object(e.jsx)(Un.a,{filters:R,setFilters:function(te){ae(Nn({},te)),h(v,te)},typeKey:"feature-flag-rollback-trends-"+v,buttonCopy:"Add graph series",showSeriesIndicator:!1,showNestedArrow:!0,hideRename:!0,entitiesLimit:1,mathAvailability:Bn.b.None,propertiesTaxonomicGroupTypes:[Ge.a.EventProperties,Ge.a.PersonProperties,Ge.a.EventFeatureFlags,Ge.a.Cohorts,Ge.a.Elements]})}}),Object(e.jsxs)("span",{children:["trailing 7 day average is\xA0",d[v]!==void 0?Object(e.jsx)("b",{children:d[v]}):Object(e.jsx)(vt.a,{}),". Trigger when trailing average is"]}),Object(e.jsx)(Ae.a,{name:"operator",children:function(I){var R=I.value,ae=I.onChange;return Object(e.jsx)(re.LemonSelect,{value:R,onChange:ae,options:[{label:"greater than",value:"gt"},{label:"less than",value:"lt"}]})}}),Object(e.jsx)(Ae.a,{name:"threshold",children:Object(e.jsx)(re.LemonInput,{min:0,type:"number"})})]}):i?Object(e.jsx)("div",{children:Object(e.jsxs)(A.a,{align:"middle",children:[o?Object(e.jsxs)("span",{children:[Object(e.jsxs)("b",{children:[Object(T.Q)(o)," "]})," sentry errors in the past 24 hours."," "]}):Object(e.jsx)(vt.a,{}),Object(e.jsx)("span",{children:"\xA0Trigger when there is a"}),Object(e.jsx)(Ae.a,{name:"threshold",className:"ml-3 mr-3",children:function(I){var R=I.value,ae=I.onChange;return Object(e.jsx)(re.LemonInput,{value:R,suffix:Object(e.jsx)(e.Fragment,{children:"%"}),type:"number",min:0,onChange:ae})}}),Object(e.jsx)(Ae.a,{name:"operator",className:"mr-3",children:function(I){var R=I.value,ae=I.onChange;return Object(e.jsx)(re.LemonSelect,{options:[{label:"increase",value:"gt"},{label:"decrease",value:"lt"}],value:R,onChange:ae})}}),Object(e.jsxs)("span",{children:["to"," ",o?Object(e.jsx)("b",{children:Object(T.Q)(Math.round(o*(1+(a.rollback_conditions[v].threshold||0)/100)))}):Object(e.jsx)(vt.a,{})," ","errors."]}),Object(e.jsx)("div",{})]})}):_!=null&&_.is_staff?Object(e.jsxs)("div",{className:"mt-4",children:[Object(e.jsx)("b",{children:"This feature requires an active Sentry integration."}),Object(e.jsx)("br",{}),Object(e.jsx)(re.Link,{to:H.a.instanceSettings(),children:"Go to Instance Settings"})," and update the"," ",Object(e.jsx)("code",{children:'"SENTRY_"'})," properties from your Sentry account to enable."]}):Object(e.jsx)("p",{className:"text-muted",children:"This PostHog instance is not configured for Sentry. Please contact the instance owner to configure it."})]})})]})}),!t&&Object(e.jsx)(re.LemonButton,{type:"secondary",onClick:function(){u()},children:"Add condition"})]})}try{Ot.displayName="FeatureFlagAutoRollback",Ot.__docgenInfo={description:"",displayName:"FeatureFlagAutoRollback",props:{readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagAutoRollout.tsx#FeatureFlagAutoRollback"]={docgenInfo:Ot.__docgenInfo,name:"FeatureFlagAutoRollback",path:"frontend/src/scenes/feature-flags/FeatureFlagAutoRollout.tsx#FeatureFlagAutoRollback"})}catch(s){}var Wn=n("./frontend/src/scenes/project-homepage/RecentRecordings.tsx"),Vn=n("./frontend/src/scenes/session-recordings/player/modal/SessionPlayerModal.tsx"),wn=n("./frontend/src/scenes/session-recordings/playlist/sessionRecordingsListLogic.ts"),Bt=function(t){return{events:On(t).events}};function Nt(s){var t=s.flagKey,r=Object(m.useValues)(ct.a),a=r.currentTeam,i=Object(wn.d)({key:"feature-flag-".concat(t),filters:Bt(t)}),o=Object(m.useValues)(i),d=o.sessionRecordings,c=o.sessionRecordingsResponseLoading,u=o.filters;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Vn.a,{}),Object(e.jsx)(ln.a,{title:"Recordings with current feature flag",viewAllURL:H.a.sessionRecordings(void 0,u),loading:c,emptyMessage:a!=null&&a.session_recording_opt_in?{title:"There are no recordings for this project",description:"Make sure you have the javascript snippet setup in your website.",buttonText:"Learn more",buttonTo:"https://posthog.com/docs/user-guides/recordings"}:{title:"Recordings are not enabled for this project",description:"Once recordings are enabled, new recordings will display here.",buttonText:"Enable recordings",buttonTo:H.a.projectSettings()+"#recordings"},items:d.slice(0,5),renderRow:function(h,b){return Object(e.jsx)(Wn.b,{recording:h},b)}})]})}try{Nt.displayName="FeatureFlagRecordings",Nt.__docgenInfo={description:"",displayName:"FeatureFlagRecordings",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagRecordingsCard.tsx#FeatureFlagRecordings"]={docgenInfo:Nt.__docgenInfo,name:"FeatureFlagRecordings",path:"frontend/src/scenes/feature-flags/FeatureFlagRecordingsCard.tsx#FeatureFlagRecordings"})}catch(s){}try{Bt.displayName="filtersForFlag",Bt.__docgenInfo={description:"",displayName:"filtersForFlag",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagRecordingsCard.tsx#filtersForFlag"]={docgenInfo:Bt.__docgenInfo,name:"filtersForFlag",path:"frontend/src/scenes/feature-flags/FeatureFlagRecordingsCard.tsx#filtersForFlag"})}catch(s){}var $n=n("./frontend/src/scenes/billing/billingLogic.ts"),Gn=n("./frontend/src/scenes/events/index.ts"),Hn=n("./frontend/src/lib/components/PropertyFilters/utils.ts"),Yn=n("./frontend/src/lib/components/LemonSelectMultiple/LemonSelectMultiple.tsx"),dn=n("./frontend/src/scenes/organization/Settings/Permissions/permissionsLogic.tsx"),zn=n("./frontend/src/scenes/organization/Settings/Roles/rolesLogic.tsx");function un(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),r.push.apply(r,a)}return r}function fn(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?un(Object(r),!0).forEach(function(a){Me()(s,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):un(Object(r)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(r,a))})}return s}function Wt(s){return s.map(function(t){return{key:t.id,label:"".concat(t.name),labelComponent:Object(e.jsx)("span",{children:Object(e.jsx)("b",{children:"".concat(t.name)})})}})}function Zt(s){var t=s.title,r=s.visible,a=s.onClose,i=s.rolesToAdd,o=s.addableRoles,d=s.onChange,c=s.addableRolesLoading,u=s.onAdd,l=s.roles,h=s.deleteAssociatedRole,b=s.isNewResource,_=s.canEdit;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(re.LemonModal,{title:t,isOpen:r,onClose:a,children:Object(e.jsx)(ut,{resourceType:y.U.FEATURE_FLAGS,isNewResource:b,onChange:d,rolesToAdd:i,addableRoles:o,addableRolesLoading:c,onAdd:u,roles:l,deleteAssociatedRole:h,canEdit:_})})})}function ut(s){var t=s.rolesToAdd,r=s.addableRoles,a=s.onChange,i=s.addableRolesLoading,o=s.onAdd,d=s.roles,c=s.deleteAssociatedRole,u=s.isNewResource,l=s.resourceType,h=s.canEdit,b=Object(m.useValues)(dn.b),_=b.allPermissions,E=b.shouldShowPermissionsTable,v=Object(m.useValues)(zn.a),F=v.roles,I=_.find(function(te){return te.resource===l}),R=F.filter(function(te){return te.feature_flags_access_level===y.a.WRITE}),ae=[{title:"Role",dataIndex:"name",key:"name",render:function(We,ve){return Object(e.jsx)(e.Fragment,{children:ve.name==="Organization default"?Object(e.jsx)(re.Link,{to:"".concat(H.a.organizationSettings(),"?tab=role_access"),children:ve.name}):ve.name})}},{title:"Access",dataIndex:"feature_flags_access_level",key:"feature_flags_access_level",render:function(We,ve){return Object(e.jsxs)("div",{className:"flex flex-row justify-between",children:[ve.feature_flags_access_level===y.a.WRITE?"Edit":"View",ve.deletable&&Object(e.jsx)(re.LemonButton,{icon:Object(e.jsx)(Z.IconDelete,{}),onClick:function(){return c(ve.id)},tooltip:"Remove custom role from feature flag",status:"primary-alt",type:"tertiary",size:"small"})]})}}],ge=[{id:"",name:"Organization default",feature_flags_access_level:I?I.access_level:y.a.WRITE,created_by:null,created_at:""}].concat($()(R),$()(d.map(function(te){return fn(fn({},te),{},{feature_flags_access_level:y.a.WRITE,deletable:!0})})));return Object(e.jsxs)(e.Fragment,{children:[!E&&Object(e.jsxs)(e.Fragment,{children:[I&&Object(e.jsx)(Jn,{resourceLevel:I}),Object(e.jsx)(Qn,{roles:R})]}),(u||h)&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h5",{className:"mt-4",children:"Custom edit roles"}),Object(e.jsxs)("div",{className:"flex gap-2",children:[Object(e.jsx)("div",{className:"flex-1",children:Object(e.jsx)(Yn.a,{placeholder:"Search for roles to add\u2026",loading:i,onChange:a,value:t,filterOption:!0,mode:"multiple","data-attr":"resource-permissioning-select",options:Wt(r)})}),!u&&Object(e.jsx)(re.LemonButton,{type:"primary",loading:!1,disabled:t.length===0,onClick:o,children:"Add"})]})]}),E&&Object(e.jsx)(re.LemonTable,{dataSource:ge,columns:ae,className:"mt-4"}),!E&&!u&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h5",{className:"mt-4",children:"Roles"}),d.length>0?Object(e.jsx)("div",{className:"pb-2 rounded overflow-y-auto",style:{maxHeight:300},children:d.map(function(te){return Object(e.jsx)(Xn,{role:te,deleteRole:function(ve){return c(ve)}},te.id)})}):Object(e.jsx)("div",{className:"text-muted mb-2",children:"No roles added yet"})]})]})}function Jn(s){var t=s.resourceLevel;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h5",{children:"Organization Default"}),Object(e.jsx)(re.Link,{to:"".concat(H.a.organizationSettings(),"?tab=role_access"),children:Object(e.jsx)("b",{children:dn.a[t.access_level]})})]})}function Qn(s){var t=s.roles;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h5",{className:"mt-4",children:"Roles with edit access"}),Object(e.jsx)(A.a,{children:t.map(function(r){return Object(e.jsxs)("span",{className:"simple-tag tag-light-blue text-primary-alt",children:[Object(e.jsx)("b",{children:r.name})," "]},r.id)})})]})}function Xn(s){var t=s.role,r=s.deleteRole;return Object(e.jsxs)("div",{className:"flex items-center justify-between h-8",children:[Object(e.jsx)("b",{children:t.name}),r&&Object(e.jsx)(re.LemonButton,{icon:Object(e.jsx)(Z.IconDelete,{}),onClick:function(){return r(t.id)},tooltip:"Remove role from permission",status:"primary-alt",type:"tertiary",size:"small"})]})}try{Wt.displayName="roleLemonSelectOptions",Wt.__docgenInfo={description:"",displayName:"roleLemonSelectOptions",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/ResourcePermissionModal.tsx#roleLemonSelectOptions"]={docgenInfo:Wt.__docgenInfo,name:"roleLemonSelectOptions",path:"frontend/src/scenes/ResourcePermissionModal.tsx#roleLemonSelectOptions"})}catch(s){}try{Zt.displayName="ResourcePermissionModal",Zt.__docgenInfo={description:"",displayName:"ResourcePermissionModal",props:{title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},visible:{defaultValue:null,description:"",name:"visible",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},addableRoles:{defaultValue:null,description:"",name:"addableRoles",required:!0,type:{name:"RoleType[]"}},addableRolesLoading:{defaultValue:null,description:"",name:"addableRolesLoading",required:!0,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(newValue: string[]) => void"}},rolesToAdd:{defaultValue:null,description:"",name:"rolesToAdd",required:!0,type:{name:"string[]"}},onAdd:{defaultValue:null,description:"",name:"onAdd",required:!0,type:{name:"() => void"}},roles:{defaultValue:null,description:"",name:"roles",required:!0,type:{name:"RoleType[]"}},deleteAssociatedRole:{defaultValue:null,description:"",name:"deleteAssociatedRole",required:!0,type:{name:"(id: string) => void"}},isNewResource:{defaultValue:null,description:"",name:"isNewResource",required:!0,type:{name:"boolean"}},resourceType:{defaultValue:null,description:"",name:"resourceType",required:!0,type:{name:"Resource"}},canEdit:{defaultValue:null,description:"",name:"canEdit",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/ResourcePermissionModal.tsx#ResourcePermissionModal"]={docgenInfo:Zt.__docgenInfo,name:"ResourcePermissionModal",path:"frontend/src/scenes/ResourcePermissionModal.tsx#ResourcePermissionModal"})}catch(s){}try{ut.displayName="ResourcePermission",ut.__docgenInfo={description:"",displayName:"ResourcePermission",props:{addableRoles:{defaultValue:null,description:"",name:"addableRoles",required:!0,type:{name:"RoleType[]"}},addableRolesLoading:{defaultValue:null,description:"",name:"addableRolesLoading",required:!0,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(newValue: string[]) => void"}},rolesToAdd:{defaultValue:null,description:"",name:"rolesToAdd",required:!0,type:{name:"string[]"}},onAdd:{defaultValue:null,description:"",name:"onAdd",required:!0,type:{name:"() => void"}},roles:{defaultValue:null,description:"",name:"roles",required:!0,type:{name:"RoleType[]"}},deleteAssociatedRole:{defaultValue:null,description:"",name:"deleteAssociatedRole",required:!0,type:{name:"(id: string) => void"}},isNewResource:{defaultValue:null,description:"",name:"isNewResource",required:!0,type:{name:"boolean"}},resourceType:{defaultValue:null,description:"",name:"resourceType",required:!0,type:{name:"Resource"}},canEdit:{defaultValue:null,description:"",name:"canEdit",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/ResourcePermissionModal.tsx#ResourcePermission"]={docgenInfo:ut.__docgenInfo,name:"ResourcePermission",path:"frontend/src/scenes/ResourcePermissionModal.tsx#ResourcePermission"})}catch(s){}var mn=n("./frontend/src/lib/components/PayGateMini/PayGateMini.tsx"),gn=n("./frontend/src/queries/schema.ts"),Zn=n("./frontend/src/queries/Query/Query.tsx"),kn={component:ht,logic:Be,paramsToProps:function(t){var r=t.params.id;return{id:r&&r!=="new"?parseInt(r):"new"}}};function pn(s){setTimeout(function(){var t;return(t=document.querySelector('.variant-form-list input[data-key-index="'.concat(s,'"]')))===null||t===void 0?void 0:t.focus()},50)}function ht(){var s,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.id,a=Object(m.useValues)(Be),i=a.props,o=a.featureFlag,d=a.featureFlagLoading,c=a.featureFlagMissing,u=a.isEditingFlag,l=Object(m.useValues)(Yt.a),h=l.featureFlags,b=Object(m.useActions)(Be),_=b.deleteFeatureFlag,E=b.editFeatureFlag,v=b.loadFeatureFlag,F=Object(m.useValues)(U({flagId:o.id})),I=F.addableRoles,R=F.unfilteredAddableRolesLoading,ae=F.rolesToAdd,ge=F.derivedRoles,te=Object(m.useActions)(U({flagId:o.id})),We=te.setRolesToAdd,ve=te.addAssociatedRoles,rt=te.deleteAssociatedRole,Le=Object(fe.useState)(!1),oe=S()(Le,2),ze=oe[0],ft=oe[1],bt=Object(fe.useState)(ee.a.OVERVIEW),W=S()(bt,2),Y=W[0],xe=W[1],Je=r==="new"||r===void 0;return c?Object(e.jsx)(Dn.a,{object:"feature flag"}):d?Object(e.jsx)(vt.b,{}):Object(e.jsx)(e.Fragment,{children:Object(e.jsx)("div",{className:"feature-flag",children:Je||u?Object(e.jsxs)(he.Form,{logic:Be,props:i,formKey:"featureFlag",enableFormOnSubmit:!0,className:"space-y-4",children:[Object(e.jsx)(tn.a,{title:Je?"New feature flag":o.key||"Untitled",buttons:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)(ye.a,{"data-attr":"cancel-feature-flag",type:"secondary",onClick:function(){u?(E(!1),v()):we.router.actions.push(H.a.featureFlags())},disabled:d,children:"Cancel"}),Object(e.jsx)(ye.a,{type:"primary","data-attr":"save-feature-flag",htmlType:"submit",loading:d,disabled:d,children:"Save"})]})}),Object(e.jsx)(be.a,{}),o.experiment_set&&((s=o.experiment_set)===null||s===void 0?void 0:s.length)>0&&Object(e.jsxs)(rn.a,{type:"warning",children:["This feature flag is linked to an experiment. It's recommended to only make changes to this flag"," ",Object(e.jsx)(Lt.a,{to:H.a.experiment(o.experiment_set[0]),children:"using the experiment creation screen."})]}),Object(e.jsx)(In.a,{additionalInfo:", meaning it can take around 60 seconds for some flags to update for recently-identified persons. To sidestep this, you can choose to override server properties when requesting the feature flag"}),Object(e.jsxs)(A.a,{gutter:16,style:{marginBottom:32},children:[Object(e.jsxs)(L.a,{span:12,className:"space-y-4",children:[Object(e.jsx)(Ae.a,{name:"key",label:"Key",help:ze&&r!=="new"?Object(e.jsxs)("span",{className:"text-warning",children:[Object(e.jsx)("b",{children:"Warning! "}),"Changing this key will",Object(e.jsxs)("a",{href:"https://posthog.com/docs/features/feature-flags".concat(tt,"#feature-flag-persistence"),target:"_blank",rel:"noopener",children:[" ","affect the persistence of your flag ",Object(e.jsx)(Z.IconOpenInNew,{})]})]}):void 0,children:function(k){var De=k.value,Qe=k.onChange;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Xt.a,{value:De,onChange:function(z){z!==De&&ft(!0),Qe(z)},"data-attr":"feature-flag-key",className:"ph-ignore-input",autoFocus:!0,placeholder:"examples: new-landing-page, betaFeature, ab_test_1",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}),Object(e.jsx)("span",{style:{fontSize:13},className:"text-muted",children:"Feature flag keys must be unique"})]})}}),Object(e.jsx)(Ae.a,{name:"name",label:"Description",children:Object(e.jsx)(An.a,{className:"ph-ignore-input","data-attr":"feature-flag-description",defaultValue:o.name||""})}),Object(e.jsx)(Ae.a,{name:"ensure_experience_continuity",children:function(k){var De=k.value,Qe=k.onChange;return Object(e.jsxs)("div",{className:"border rounded p-4",children:[Object(e.jsx)(sn.a,{id:"continuity-checkbox",label:"Persist flag across authentication steps",onChange:function(){return Qe(!De)},fullWidth:!0,checked:De}),Object(e.jsxs)("div",{className:"text-muted text-sm pl-7",children:["If your feature flag is applied prior to an identify or authentication event, use this to ensure that feature flags are not reset after a person is identified. This ensures the experience for the anonymous person is carried forward to the authenticated person."," ",Object(e.jsxs)(Lt.a,{to:"https://posthog.com/manual/feature-flags#persisting-feature-flags-across-authentication-steps",target:"_blank",children:["Learn more ",Object(e.jsx)(Z.IconOpenInNew,{})]})]})]})}}),Object(e.jsx)(Ae.a,{name:"active",children:function(k){var De=k.value,Qe=k.onChange;return Object(e.jsx)("div",{className:"border rounded p-4",children:Object(e.jsx)(sn.a,{id:"flag-enabled-checkbox",label:"Enable feature flag",onChange:function(){return Qe(!De)},checked:De})})}})]}),Object(e.jsxs)(L.a,{span:12,children:[h[Ne.i.ROLE_BASED_ACCESS]&&Object(e.jsx)(x.a,{title:"Permissions",className:"mb-4",children:Object(e.jsx)(mn.a,{feature:y.e.ROLE_BASED_ACCESS,children:Object(e.jsx)(ut,{resourceType:y.U.FEATURE_FLAGS,isNewResource:r==="new",onChange:function(k){return We(k)},rolesToAdd:ae,addableRoles:I,addableRolesLoading:R,onAdd:function(){return ve()},roles:ge,deleteAssociatedRole:function(k){return rt({roleId:k})},canEdit:o.can_edit})})}),Object(e.jsx)(_t,{featureFlagKey:o.key||"my-flag"})]})]}),Object(e.jsx)(be.a,{}),Object(e.jsx)(jn,{}),Object(e.jsx)(be.a,{}),Object(e.jsx)(_n,{}),Object(e.jsx)(be.a,{}),h[Ne.i.AUTO_ROLLBACK_FEATURE_FLAGS]&&Object(e.jsx)(Ot,{}),Object(e.jsx)(Ye.a,{className:"mt-8"}),Object(e.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[Object(e.jsx)(ye.a,{"data-attr":"cancel-feature-flag",type:"secondary",onClick:function(){u?(E(!1),v()):we.router.actions.push(H.a.featureFlags())},disabled:d,children:"Cancel"}),Object(e.jsx)(ye.a,{type:"primary","data-attr":"save-feature-flag",htmlType:"submit",loading:d,disabled:d,children:"Save"})]})]}):Object(e.jsx)(e.Fragment,{children:d?Object(e.jsx)(Fe.a,{active:!0}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(tn.a,{title:Object(e.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[o.key||"Untitled",Object(e.jsx)(an.a,{explicitValue:o.key,iconStyle:{color:"var(--muted-alt)"}}),Object(e.jsx)("div",{className:"flex",children:o.active?Object(e.jsx)(on.a,{type:"success",className:"uppercase",children:"Enabled"}):Object(e.jsx)(on.a,{type:"default",className:"uppercase",children:"Disabled"})})]}),description:Object(e.jsx)(e.Fragment,{children:o.name?Object(e.jsx)("span",{style:{fontStyle:"normal"},children:o.name}):"There is no description for this feature flag."}),buttons:Object(e.jsx)(e.Fragment,{children:Object(e.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[Object(e.jsx)(ye.a,{"data-attr":"delete-feature-flag",status:"danger",type:"secondary",onClick:function(){_(o)},disabled:d||!o.can_edit,children:"Delete feature flag"}),Object(e.jsx)(ye.a,{"data-attr":"edit-feature-flag",type:"secondary",tooltip:h[Ne.i.ROLE_BASED_ACCESS]&&!o.can_edit&&"You have only 'View' access for this feature flag. To make changes, please contact the flag's creator.",onClick:function(){E(!0)},disabled:d||!o.can_edit,children:"Edit"})]})})}),Object(e.jsxs)(J.a,{activeKey:Y,destroyInactiveTabPane:!0,onChange:function(k){return xe(k)},children:[Object(e.jsx)(J.a.TabPane,{tab:"Overview",children:Object(e.jsxs)(A.a,{children:[Object(e.jsxs)(L.a,{span:13,children:[Object(e.jsx)(jn,{readOnly:!0}),Object(e.jsx)(_n,{readOnly:!0}),h[Ne.i.AUTO_ROLLBACK_FEATURE_FLAGS]&&Object(e.jsx)(Ot,{readOnly:!0})]}),Object(e.jsxs)(L.a,{span:11,className:"pl-4",children:[Object(e.jsx)(Ln,{}),Object(e.jsx)("div",{className:"my-4"}),h[Ne.i.RECORDINGS_ON_FEATURE_FLAGS]?Object(e.jsx)(Nt,{flagKey:o.key||"my-flag"}):Object(e.jsx)(_t,{featureFlagKey:o.key||"my-flag"})]})]})},"overview"),h[Ne.i.EXPOSURES_ON_FEATURE_FLAGS]&&o.key&&r&&Object(e.jsx)(J.a.TabPane,{tab:"Exposures",children:Object(e.jsx)(qn,{id:r,featureFlagKey:o.key})},"exposure"),o.id&&Object(e.jsx)(J.a.TabPane,{tab:"History",children:Object(e.jsx)(Cn.a,{scope:Tn.a.FEATURE_FLAG,id:o.id})},"history"),h[Ne.i.ROLE_BASED_ACCESS]&&o.can_edit&&Object(e.jsx)(J.a.TabPane,{tab:"Permissions",children:Object(e.jsx)(mn.a,{feature:y.e.ROLE_BASED_ACCESS,children:Object(e.jsx)(ut,{resourceType:y.U.FEATURE_FLAGS,isNewResource:r==="new",onChange:function(k){return We(k)},rolesToAdd:ae,addableRoles:I,addableRolesLoading:R,onAdd:function(){return ve()},roles:ge,deleteAssociatedRole:function(k){return rt({roleId:k})},canEdit:o.can_edit})})},"permissions")]})]})})})})}function qn(s){var t=s.id,r=s.featureFlagKey,a=Object(m.useValues)(Yt.a),i=a.featureFlags,o=i[Ne.i.DATA_EXPLORATION_LIVE_EVENTS];return o?Object(e.jsx)(Zn.a,{query:{kind:gn.a.DataTableNode,source:{kind:gn.a.EventsNode,event:"$feature_flag_called",properties:Ht(r)},showReload:!0,showColumnConfigurator:!0,showExport:!0}}):Object(e.jsx)(Gn.b,{fixedFilters:{event_filter:"$feature_flag_called",properties:Ht(r)},sceneUrl:H.a.featureFlag(t),fetchMonths:3,pageKey:"feature-flag-".concat(r,"}"),showEventFilter:!1,showPropertyFilter:!1})}function jn(s){var t=s.readOnly,r=Object(m.useValues)(Be),a=r.multivariateEnabled,i=r.variants,o=r.areVariantRolloutsValid,d=r.featureFlagLoading,c=r.variantRolloutSum,u=r.nonEmptyVariants,l=r.aggregationTargetName,h=r.featureFlag,b=Object(m.useActions)(Be),_=b.distributeVariantsEqually,E=b.addVariant,v=b.removeVariant,F=b.setMultivariateEnabled,I=Object(fe.useState)(!1),R=S()(I,2),ae=R[0],ge=R[1],te=Object(m.useValues)(G.a),We=te.hasAvailableFeature,ve=Object(m.useValues)($n.b),rt=ve.upgradeLink;return Object(e.jsxs)(e.Fragment,{children:[t?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"flex flex-col mb-4",children:[Object(e.jsx)("span",{className:"card-secondary",children:"Type"}),Object(e.jsx)("span",{children:h.filters.multivariate?"Multiple variants with rollout percentages (A/B/C test)":"Release toggle (boolean)"}),Object(e.jsx)("span",{className:"card-secondary mt-4",children:"Flag persistence"}),Object(e.jsxs)("span",{children:["This flag"," ",Object(e.jsxs)("b",{children:[h.ensure_experience_continuity?"persists":"does not persist"," "]}),"across authentication events."]})]}),Object(e.jsx)(Ye.a,{className:"my-3"}),h.filters.multivariate&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)("b",{children:"Variant keys"})}),Object(e.jsxs)("div",{className:"border rounded p-4 mb-4",children:[Object(e.jsxs)(A.a,{className:"font-semibold",children:[Object(e.jsx)(L.a,{span:10,children:"Key"}),Object(e.jsx)(L.a,{span:11,children:"Description"}),Object(e.jsx)(L.a,{span:3,children:"Rollout"})]}),Object(e.jsx)(Ye.a,{className:"my-3"}),i.map(function(Le,oe){return Object(e.jsxs)("div",{children:[Object(e.jsxs)(A.a,{children:[Object(e.jsxs)(L.a,{span:10,children:[Object(e.jsx)(Ut.a,{name:T.c[oe],color:Ut.b.Gray}),Object(e.jsx)(an.a,{tooltipMessage:null,description:"key",style:{marginLeft:"0.5rem"},iconStyle:{color:"var(--muted-alt)"},children:Le.key})]}),Object(e.jsx)(L.a,{span:12,children:Le.name||"There is no description for this variant key"}),Object(e.jsxs)(L.a,{span:2,children:[Le.rollout_percentage,"%"]})]}),oe!==i.length-1&&Object(e.jsx)(Ye.a,{className:"my-3"})]},oe)})]})]})]}):Object(e.jsxs)("div",{className:"mb-8",children:[Object(e.jsx)("h3",{className:"l4",children:"Served value"}),Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)(ie.a,{placement:"top",title:"Change value type? The variants below will be lost.",disabled:d,visible:ae,onConfirm:function(){F(!1),ge(!1)},onCancel:function(){return ge(!1)},okText:"OK",cancelText:"Cancel",children:Object(e.jsx)(_e.a.Group,{options:[{label:"Release toggle (boolean)",value:!1},{label:Object(e.jsx)(Pn.a,{title:We(y.e.MULTIVARIATE_FLAGS)?"":"This feature is not available on your current plan.",children:Object(e.jsxs)("div",{children:[!We(y.e.MULTIVARIATE_FLAGS)&&Object(e.jsx)(Lt.a,{to:rt,target:"_blank",children:Object(e.jsx)(Xe.a,{style:{marginRight:4,color:"var(--warning)"}})}),"Multiple variants with rollout percentages (A/B test)"]})}),value:!0,disabled:!We(y.e.MULTIVARIATE_FLAGS)}],onChange:function(oe){var ze=oe.target.value;ze===!1&&u.length?ge(!0):(F(ze),pn(0))},value:a,optionType:"button"})})}),Object(e.jsxs)("div",{className:"text-muted mb-4",children:[Object(T.i)(l)," will be served"," ",a?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("strong",{children:"a variant key"})," according to the below distribution"]}):Object(e.jsx)("strong",{children:Object(e.jsx)("code",{children:"true"})})," ","if they match one or more release condition groups."]})]}),!t&&a&&Object(e.jsxs)("div",{className:"feature-flag-variants",children:[Object(e.jsx)("h3",{className:"l4",children:"Variant keys"}),Object(e.jsx)("span",{children:"The rollout percentage of feature flag variants must add up to 100%"}),Object(e.jsxs)("div",{className:"variant-form-list space-y-2",children:[Object(e.jsxs)(A.a,{gutter:8,className:"label-row",children:[Object(e.jsx)(L.a,{span:1}),Object(e.jsx)(L.a,{span:6,children:"Variant key"}),Object(e.jsx)(L.a,{span:12,children:"Description"}),Object(e.jsxs)(L.a,{span:4,children:["Rollout",Object(e.jsx)(ye.a,{type:"tertiary",onClick:_,children:"(Redistribute)"})]})]}),i.map(function(Le,oe){return Object(e.jsx)(he.Group,{name:["filters","multivariate","variants",oe],children:Object(e.jsxs)(A.a,{gutter:8,align:"middle",children:[Object(e.jsx)(L.a,{span:1,children:Object(e.jsx)(Ut.a,{name:T.c[oe],color:Ut.b.Gray})}),Object(e.jsx)(L.a,{span:6,children:Object(e.jsx)(Ae.a,{name:"key",children:Object(e.jsx)(Xt.a,{"data-attr":"feature-flag-variant-key","data-key-index":oe.toString(),className:"ph-ignore-input",placeholder:"example-variant-".concat(oe+1),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})})}),Object(e.jsx)(L.a,{span:12,children:Object(e.jsx)(Ae.a,{name:"name",children:Object(e.jsx)(Xt.a,{"data-attr":"feature-flag-variant-name",className:"ph-ignore-input",placeholder:"Description"})})}),Object(e.jsx)(L.a,{span:3,children:Object(e.jsx)(Ae.a,{name:"rollout_percentage",children:function(ft){var bt=ft.value,W=ft.onChange;return Object(e.jsx)(V.a,{min:0,max:100,value:bt,onChange:function(xe){if(xe!=null){var Je=parseInt(xe.toString());isNaN(Je)||W(Je)}},style:{width:"100%",borderColor:o?void 0:"var(--danger)"}})}})}),Object(e.jsx)(L.a,{span:2,children:Object(e.jsx)(A.a,{children:i.length>1&&Object(e.jsx)(ye.a,{icon:Object(e.jsx)(Z.IconDelete,{}),status:"primary-alt","data-attr":"delete-prop-filter-".concat(oe),noPadding:!0,onClick:function(){return v(oe)}})})})]})},oe)}),i.length>0&&!o&&Object(e.jsxs)("p",{className:"text-danger",children:["Percentage rollouts for variants must sum to 100 (currently ",c,")."]}),Object(e.jsx)(ye.a,{type:"secondary",onClick:function(){var oe=i.length;E(),pn(oe)},icon:Object(e.jsx)(Z.IconPlus,{}),center:!0,children:"Add variant"})]})]})]})}function _n(s){var t,r,a=s.readOnly,i=Object(m.useValues)(nt.a),o=i.showGroupsOptions,d=i.aggregationLabel,c=Object(m.useValues)(Be),u=c.aggregationTargetName,l=c.featureFlag,h=c.groupTypes,b=c.taxonomicGroupTypes,_=c.nonEmptyVariants,E=c.propertySelectErrors,v=c.computeBlastRadiusPercentage,F=c.affectedUsers,I=c.totalUsers,R=Object(m.useActions)(Be),ae=R.setAggregationGroupTypeIndex,ge=R.updateConditionSet,te=R.duplicateConditionSet,We=R.removeConditionSet,ve=R.addConditionSet,rt=Object(m.useValues)(Kn.a),Le=rt.cohortsById,oe=Object(m.useValues)(Yt.a),ze=oe.featureFlags,ft=Kt({value:-2}),bt=function(Y){return!!Y.find(function(xe){return xe.type==="cohort"||!Ne.l.includes(xe.key||"")})};return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"feature-flag-form-row",children:[Object(e.jsx)("div",{"data-attr":"feature-flag-release-conditions",children:a?Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)("b",{children:"Release conditions"})}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h3",{className:"l4",children:"Release conditions"}),Object(e.jsxs)("div",{className:"text-muted mb-4",children:["Specify the ",u," to which you want to release this flag. Note that condition sets are rolled out independently of each other."]})]})}),!a&&o&&Object(e.jsxs)("div",{className:"centered",children:["Match by",Object(e.jsxs)(le.a,{value:((t=l.filters)===null||t===void 0?void 0:t.aggregation_group_type_index)!=null?(r=l.filters)===null||r===void 0?void 0:r.aggregation_group_type_index:-1,onChange:function(Y){var xe=Y!==-1?Y:null;ae(xe)},style:{marginLeft:8},"data-attr":"feature-flag-aggregation-filter",dropdownMatchSelectWidth:!1,dropdownAlign:{points:["tr","br"]},children:[Object(e.jsx)(le.a.Option,{value:-1,children:"Users"},-1),h.map(function(W){return Object(e.jsx)(le.a.Option,{value:W.group_type_index,children:Object(T.i)(d(W.group_type_index).plural)},W.group_type_index)}),ft]})]})]}),Object(e.jsx)(A.a,{gutter:16,children:l.filters.groups.map(function(W,Y){var xe,Je,pe,k,De,Qe,mt;return Object(e.jsxs)(L.a,{span:24,md:24,children:[Y>0&&Object(e.jsx)("div",{className:"condition-set-separator",children:"OR"}),Object(e.jsxs)("div",{className:"mb-4 border rounded p-4",children:[Object(e.jsxs)(A.a,{align:"middle",justify:"space-between",children:[Object(e.jsxs)(A.a,{align:"middle",children:[Object(e.jsxs)("span",{className:"simple-tag tag-light-blue font-medium mr-2",children:["Set ",Y+1]}),Object(e.jsx)("div",{children:(xe=W.properties)!==null&&xe!==void 0&&xe.length?Object(e.jsx)(e.Fragment,{children:a?Object(e.jsxs)(e.Fragment,{children:["Match ",Object(e.jsx)("b",{children:u})," against ",Object(e.jsx)("b",{children:"all"})," criteria"]}):Object(e.jsxs)(e.Fragment,{children:["Matching ",Object(e.jsx)("b",{children:u})," against the criteria"]})}):Object(e.jsxs)(e.Fragment,{children:["Condition set will match ",Object(e.jsxs)("b",{children:["all ",u]})]})})]}),!a&&Object(e.jsxs)(A.a,{children:[Object(e.jsx)(ye.a,{icon:Object(e.jsx)(Z.IconCopy,{}),status:"muted",noPadding:!0,onClick:function(){return te(Y)}}),l.filters.groups.length>1&&Object(e.jsx)(ye.a,{icon:Object(e.jsx)(Z.IconDelete,{}),status:"muted",noPadding:!0,onClick:function(){return We(Y)}})]})]}),Object(e.jsx)(Ye.a,{className:"my-3"}),!a&&bt(W.properties)&&Object(e.jsxs)(rn.a,{type:"info",className:"mt-3 mb-3",children:["These properties aren't immediately available on first page load for unidentified persons. This feature flag requires that at least one event is sent prior to becoming available to your product or website."," ",Object(e.jsxs)("a",{href:"https://posthog.com/docs/integrate/client/js#bootstrapping-flags",target:"_blank",children:[" ","Learn more about how to make feature flags available instantly."]})]}),a?Object(e.jsx)(e.Fragment,{children:W.properties.map(function(z,$e){return Object(e.jsx)(e.Fragment,{children:Object(e.jsxs)("div",{className:"feature-flag-property-display",children:[$e===0?Object(e.jsx)(ye.a,{icon:Object(e.jsx)(Z.IconSubArrowRight,{className:"arrow-right"}),status:"muted",size:"small"}):Object(e.jsx)(ye.a,{icon:Object(e.jsx)("span",{className:"text-sm",children:"&"}),status:"muted",size:"small"}),Object(e.jsxs)("span",{className:"simple-tag tag-light-blue text-primary-alt",children:[z.type==="cohort"?"Cohort":z.key," "]}),Object(Hn.d)(z)?Object(e.jsxs)("span",{children:[Object(Mn.a)(z.operator)," "]}):null,$()(Array.isArray(z.value)?z.value:[z.value]).map(function(Vt,es){var kt;return Object(e.jsx)("span",{className:"simple-tag tag-light-blue text-primary-alt display-value",children:z.type==="cohort"?Vt&&((kt=Le[Vt])===null||kt===void 0?void 0:kt.name)||"ID ".concat(Vt):Vt},es)})]},$e)})})}):Object(e.jsx)("div",{children:Object(e.jsx)(Ke.a,{orFiltering:!0,pageKey:"feature-flag-".concat(l.id,"-").concat(Y,"-").concat(l.filters.groups.length,"-").concat((Je=l.filters.aggregation_group_type_index)!==null&&Je!==void 0?Je:""),propertyFilters:W==null?void 0:W.properties,logicalRowDivider:!0,addButton:Object(e.jsx)(ye.a,{icon:Object(e.jsx)(Z.IconPlusMini,{}),noPadding:!0,children:"Add condition"}),onChange:function($e){return ge(Y,void 0,$e)},taxonomicGroupTypes:b,hasRowOperator:!1,sendAllKeyUpdates:!0,errorMessages:E!=null&&(pe=E[Y])!==null&&pe!==void 0&&(k=pe.properties)!==null&&k!==void 0&&k.some(function(z){return!!z.value})?E[Y].properties.map(function(z,$e){return z.value?Object(e.jsxs)("div",{className:"text-danger flex items-center gap-1 text-sm",children:[Object(e.jsx)(Z.IconErrorOutline,{className:"text-xl"})," ",z.value]},$e):Object(e.jsx)(e.Fragment,{})}):null})}),(!a||a&&((De=W.properties)===null||De===void 0?void 0:De.length)>0)&&Object(e.jsx)(Ye.a,{className:"my-3"}),a?Object(e.jsxs)("div",{children:["Rolled out to"," ",Object(e.jsxs)("b",{children:[W.rollout_percentage!=null?W.rollout_percentage:100,"%"]})," of"," ",Object(e.jsx)("b",{children:u})," in this set."," "]}):Object(e.jsx)("div",{className:"feature-flag-form-row",children:Object(e.jsxs)("div",{className:"centered",children:["Roll out to"," ",Object(e.jsx)(V.a,{style:{width:100,marginLeft:8,marginRight:8},onChange:function($e){ge(Y,$e)},value:W.rollout_percentage!=null?W.rollout_percentage:100,min:0,max:100,addonAfter:"%"})," ","of ",Object(e.jsx)("b",{children:u})," in this set."," ",ze[Ne.i.FEATURE_FLAG_ROLLOUT_UX]&&Object(e.jsxs)(e.Fragment,{children:["Will match approximately"," ",F[Y]!==void 0?Object(e.jsx)("b",{children:"".concat(Object(T.Q)(v(W.rollout_percentage,Y)),"% ")}):Object(e.jsx)(vt.a,{className:"mr-1"})," ",F[Y]&&F[Y]>=0&&I?"(".concat(Object(T.Q)(Math.floor(F[Y]*((Qe=W.rollout_percentage)!==null&&Qe!==void 0?Qe:100)/100))," / ").concat(Object(T.Q)(I),")"):""," ","of total ",u,"."]})]})}),ze[Ne.i.VARIANT_OVERRIDES]&&_.length>0&&Object(e.jsxs)(e.Fragment,{children:[(!a||a&&((mt=W.properties)===null||mt===void 0?void 0:mt.length)>0)&&Object(e.jsx)(Ye.a,{className:"my-3"}),a?Object(e.jsxs)("div",{children:["All ",Object(e.jsx)("b",{children:u})," in this set"," ",W.variant?Object(e.jsxs)(e.Fragment,{children:[" ","will be in variant ",Object(e.jsx)("b",{children:W.variant})]}):Object(e.jsx)(e.Fragment,{children:"have no variant override"})]}):Object(e.jsx)("div",{className:"feature-flag-form-row",children:Object(e.jsxs)("div",{className:"centered",children:[Object(e.jsx)("b",{children:"Optional override:"})," Set variant for all"," ",Object(e.jsx)("b",{children:u})," in this set to"," ",Object(e.jsx)(re.LemonSelect,{placeholder:"Select variant",allowClear:!0,value:W.variant,onChange:function($e){return ge(Y,void 0,void 0,$e)},options:_.map(function(z){return{label:z.key,value:z.key}}),"data-attr":"feature-flags-variant-override-select"})]})})]})]})]},"".concat(Y,"-").concat(l.filters.groups.length))})}),!a&&Object(e.jsx)(ye.a,{type:"secondary",className:"mt-0",onClick:ve,icon:Object(e.jsx)(Z.IconPlus,{}),children:"Add condition set"})]})}try{ht.displayName="FeatureFlag",ht.__docgenInfo={description:"",displayName:"FeatureFlag",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"]={docgenInfo:ht.__docgenInfo,name:"FeatureFlag",path:"frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"})}catch(s){}},"./frontend/src/scenes/organization/Settings/Permissions/permissionsLogic.tsx":function(je,M,n){"use strict";n.d(M,"a",function(){return wt}),n.d(M,"b",function(){return Rt});var q=n("./node_modules/core-js/modules/es.symbol.js"),$=n.n(q),Ee=n("./node_modules/core-js/modules/es.array.filter.js"),S=n.n(Ee),Oe=n("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Ie=n.n(Oe),de=n("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Ce=n.n(de),Te=n("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Ve=n.n(Te),ue=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),Pe=n.n(ue),fe=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),he=n.n(fe),be=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),A=n.n(be),L=n("./node_modules/@babel/runtime/regenerator/index.js"),x=n.n(L),Fe=n("./node_modules/core-js/modules/es.array.iterator.js"),J=n.n(Fe),ie=n("./node_modules/core-js/modules/es.object.to-string.js"),_e=n.n(ie),V=n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),le=n.n(V),m=n("./node_modules/core-js/modules/es.array.map.js"),T=n.n(m),Ke=n("./node_modules/core-js/modules/es.array.concat.js"),Xe=n.n(Ke),at=n("./node_modules/core-js/modules/es.object.keys.js"),ne=n.n(at),Ze=n("./node_modules/kea/lib/index.esm.js"),yt=n("./node_modules/kea-loaders/lib/index.js"),Et=n.n(yt),ot=n("./frontend/src/lib/api.ts"),ke=n("./frontend/src/types.ts"),me=n("./frontend/src/lib/logic/featureFlagLogic.ts"),gt=n("./frontend/src/lib/constants.tsx"),Me;function it(w,Q){var X=Object.keys(w);if(Object.getOwnPropertySymbols){var se=Object.getOwnPropertySymbols(w);Q&&(se=se.filter(function(qe){return Object.getOwnPropertyDescriptor(w,qe).enumerable})),X.push.apply(X,se)}return X}function C(w){for(var Q=1;Q<arguments.length;Q++){var X=arguments[Q]!=null?arguments[Q]:{};Q%2?it(Object(X),!0).forEach(function(se){A()(w,se,X[se])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(X)):it(Object(X)).forEach(function(se){Object.defineProperty(w,se,Object.getOwnPropertyDescriptor(X,se))})}return w}var pt=A()({},ke.U.FEATURE_FLAGS,"Feature Flags"),wt=(Me={},A()(Me,ke.a.WRITE,"View & Edit"),A()(Me,ke.a.READ,"View Only"),Me),Rt=Object(Ze.kea)([Object(Ze.path)(["scenes","organization","Settings","Permissions","permissionsLogic"]),Object(Ze.connect)({values:[me.a,["featureFlags"]]}),Object(yt.loaders)(function(w){var Q=w.values;return{organizationResourcePermissions:[[],{loadOrganizationResourcePermissions:function(){var X=he()(x.a.mark(function qe(){var Ue;return x.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,ot.b.resourcePermissions.list();case 2:return Ue=y.sent,y.abrupt("return",(Ue==null?void 0:Ue.results)||[]);case 4:case"end":return y.stop()}},qe)}));function se(){return X.apply(this,arguments)}return se}(),updateOrganizationResourcePermission:function(){var X=he()(x.a.mark(function qe(Ue){var lt,y,ce,we,H;return x.a.wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:if(lt=Ue.id,y=Ue.resource,ce=Ue.access_level,!lt){ee.next=8;break}return ee.next=4,ot.b.resourcePermissions.update(lt,{access_level:ce});case 4:return we=ee.sent,ee.abrupt("return",Q.organizationResourcePermissions.map(function(nt){return nt.id==we.id?we:nt}));case 8:return ee.next=10,ot.b.resourcePermissions.create({resource:y,access_level:ce});case 10:return H=ee.sent,ee.abrupt("return",[].concat(Pe()(Q.organizationResourcePermissions),[H]));case 12:case"end":return ee.stop()}},qe)}));function se(qe){return X.apply(this,arguments)}return se}()}]}}),Object(Ze.selectors)({organizationResourcePermissionsMap:[function(w){return[w.organizationResourcePermissions]},function(w){return w.reduce(function(Q,X){return C(C({},Q),{},A()({},X.resource,X))},{})}],allPermissions:[function(w){return[w.organizationResourcePermissionsMap]},function(w){return Object.keys(pt).map(function(Q){var X,se;return{id:((X=w[Q])===null||X===void 0?void 0:X.id)||null,resource:Q,name:pt[Q],access_level:((se=w[Q])===null||se===void 0?void 0:se.access_level)||ke.a.WRITE}})}],shouldShowPermissionsTable:[function(w){return[w.featureFlags]},function(w){return w[gt.i.ROLE_BASED_ACCESS]==="control"}]}),Object(Ze.afterMount)(function(w){var Q=w.actions;Q.loadOrganizationResourcePermissions()})])},"./frontend/src/scenes/organization/Settings/Roles/rolesLogic.tsx":function(je,M,n){"use strict";n.d(M,"a",function(){return $t});var q=n("./node_modules/core-js/modules/es.object.keys.js"),$=n.n(q),Ee=n("./node_modules/core-js/modules/es.symbol.js"),S=n.n(Ee),Oe=n("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Ie=n.n(Oe),de=n("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Ce=n.n(de),Te=n("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Ve=n.n(Te),ue=n("./node_modules/core-js/modules/es.array.slice.js"),Pe=n.n(ue),fe=n("./node_modules/core-js/modules/es.function.name.js"),he=n.n(fe),be=n("./node_modules/core-js/modules/es.array.from.js"),A=n.n(be),L=n("./node_modules/core-js/modules/es.regexp.exec.js"),x=n.n(L),Fe=n("./node_modules/core-js/modules/es.symbol.description.js"),J=n.n(Fe),ie=n("./node_modules/core-js/modules/es.symbol.iterator.js"),_e=n.n(ie),V=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),le=n.n(V),m=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),T=n.n(m),Ke=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),Xe=n.n(Ke),at=n("./node_modules/@babel/runtime/regenerator/index.js"),ne=n.n(at),Ze=n("./node_modules/core-js/modules/es.array.map.js"),yt=n.n(Ze),Et=n("./node_modules/core-js/modules/es.array.iterator.js"),ot=n.n(Et),ke=n("./node_modules/core-js/modules/es.object.to-string.js"),me=n.n(ke),gt=n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Me=n.n(gt),it=n("./node_modules/core-js/modules/es.array.concat.js"),C=n.n(it),pt=n("./node_modules/core-js/modules/es.array.filter.js"),wt=n.n(pt),Rt=n("./node_modules/core-js/modules/es.promise.js"),w=n.n(Rt),Q=n("./node_modules/core-js/modules/es.string.iterator.js"),X=n.n(Q),se=n("./node_modules/core-js/modules/es.object.assign.js"),qe=n.n(se),Ue=n("./node_modules/core-js/modules/es.array.sort.js"),lt=n.n(Ue),y=n("./node_modules/kea/lib/index.esm.js"),ce=n("./node_modules/kea-loaders/lib/index.js"),we=n.n(ce),H=n("./frontend/src/lib/api.ts"),ct=n("./frontend/src/scenes/project/Settings/teamMembersLogic.tsx"),ee=n("./frontend/src/types.ts");function nt(j,p){var g=typeof Symbol!="undefined"&&j[Symbol.iterator]||j["@@iterator"];if(!g){if(Array.isArray(j)||(g=Ge(j))||p&&j&&typeof j.length=="number"){g&&(j=g);var O=0,D=function(){};return{s:D,n:function(){return O>=j.length?{done:!0}:{done:!1,value:j[O++]}},e:function(U){throw U},f:D}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var B=!0,N=!1,K;return{s:function(){g=g.call(j)},n:function(){var U=g.next();return B=U.done,U},e:function(U){N=!0,K=U},f:function(){try{!B&&g.return!=null&&g.return()}finally{if(N)throw K}}}}function Ge(j,p){if(!!j){if(typeof j=="string")return xt(j,p);var g=Object.prototype.toString.call(j).slice(8,-1);if(g==="Object"&&j.constructor&&(g=j.constructor.name),g==="Map"||g==="Set")return Array.from(j);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return xt(j,p)}}function xt(j,p){(p==null||p>j.length)&&(p=j.length);for(var g=0,O=new Array(p);g<p;g++)O[g]=j[g];return O}function Pt(j,p){var g=Object.keys(j);if(Object.getOwnPropertySymbols){var O=Object.getOwnPropertySymbols(j);p&&(O=O.filter(function(D){return Object.getOwnPropertyDescriptor(j,D).enumerable})),g.push.apply(g,O)}return g}function jt(j){for(var p=1;p<arguments.length;p++){var g=arguments[p]!=null?arguments[p]:{};p%2?Pt(Object(g),!0).forEach(function(O){Xe()(j,O,g[O])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(g)):Pt(Object(g)).forEach(function(O){Object.defineProperty(j,O,Object.getOwnPropertyDescriptor(g,O))})}return j}var $t=Object(y.kea)([Object(y.path)(["scenes","organization","rolesLogic"]),Object(y.connect)({values:[ct.b,["allMembers"]]}),Object(y.actions)({setCreateRoleModalShown:function(p){return{shown:p}},setRoleInFocus:function(p){return{role:p}},setRoleMembersInFocus:function(p){return{roleMembers:p}},setRoleMembersToAdd:function(p){return{uuids:p}},openCreateRoleModal:!0,setPermission:function(p,g){return{resource:p,access:g}},setPermissionInPlace:function(p,g){return{resource:p,access:g}},clearPermission:!0,updateRole:function(p){return{role:p}}}),Object(y.reducers)({createRoleModalShown:[!1,{setCreateRoleModalShown:function(p,g){var O=g.shown;return O}}],roleInFocus:[null,{setRoleInFocus:function(p,g){var O=g.role;return O}}],roleMembersInFocus:[[],{setRoleMembersInFocus:function(p,g){var O=g.roleMembers;return O}}],roleMembersToAdd:[[],{setRoleMembersToAdd:function(p,g){var O=g.uuids;return O}}],permissionsToSet:[{},{setPermission:function(p,g){var O=g.resource,D=g.access;return jt(jt({},p),{},Xe()({},"".concat(O),D))},clearPermission:function(){return{}}}],roles:[[],{updateRole:function(p,g){var O=g.role;return p.map(function(D){return D.id==O.id?O:D})}}]}),Object(ce.loaders)(function(j){var p=j.values,g=j.actions;return{roles:{loadRoles:function(){var O=T()(ne.a.mark(function B(){var N;return ne.a.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,H.b.roles.list();case 2:return N=P.sent,P.abrupt("return",(N==null?void 0:N.results)||[]);case 4:case"end":return P.stop()}},B)}));function D(){return O.apply(this,arguments)}return D}(),createRole:function(){var O=T()(ne.a.mark(function B(N){var K,P,U,G;return ne.a.wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:return K=p.roles,P=p.roleMembersToAdd,U=p.permissionsToSet,Se.next=3,H.b.roles.create(N,U[ee.U.FEATURE_FLAGS]);case 3:return G=Se.sent,Se.next=6,g.addRoleMembers({role:G,membersToAdd:P});case 6:return g.setRoleMembersInFocus([]),g.setRoleMembersToAdd([]),g.clearPermission(),g.setCreateRoleModalShown(!1),Se.abrupt("return",[G].concat(le()(K)));case 11:case"end":return Se.stop()}},B)}));function D(B){return O.apply(this,arguments)}return D}(),deleteRole:function(){var O=T()(ne.a.mark(function B(N){return ne.a.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,H.b.roles.delete(N.id);case 2:return P.abrupt("return",p.roles.filter(function(U){return U.id!==N.id}));case 3:case"end":return P.stop()}},B)}));function D(B){return O.apply(this,arguments)}return D}()},roleMembersInFocus:[[],{loadRoleMembers:function(){var O=T()(ne.a.mark(function B(N){var K,P;return ne.a.wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return K=N.roleId,G.next=3,H.b.roles.members.list(K);case 3:return P=G.sent,G.abrupt("return",(P==null?void 0:P.results)||[]);case 5:case"end":return G.stop()}},B)}));function D(B){return O.apply(this,arguments)}return D}(),addRoleMembers:function(){var O=T()(ne.a.mark(function B(N){var K,P,U;return ne.a.wrap(function(He){for(;;)switch(He.prev=He.next){case 0:return K=N.role,P=N.membersToAdd,He.next=3,Promise.all(P.map(function(){var Se=T()(ne.a.mark(function f(Gt){return ne.a.wrap(function(et){for(;;)switch(et.prev=et.next){case 0:return et.next=2,H.b.roles.members.create(K.id,Gt);case 2:return et.abrupt("return",et.sent);case 3:case"end":return et.stop()}},f)}));return function(f){return Se.apply(this,arguments)}}()));case 3:return U=He.sent,g.setRoleMembersToAdd([]),He.abrupt("return",[].concat(le()(p.roleMembersInFocus),le()(U)));case 6:case"end":return He.stop()}},B)}));function D(B){return O.apply(this,arguments)}return D}(),deleteRoleMember:function(){var O=T()(ne.a.mark(function B(N){var K;return ne.a.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(K=N.roleMemberUuid,U.t0=p.roleInFocus,!U.t0){U.next=5;break}return U.next=5,H.b.roles.members.delete(p.roleInFocus.id,K);case 5:return U.abrupt("return",p.roleMembersInFocus.filter(function(G){return G.id!==K}));case 6:case"end":return U.stop()}},B)}));function D(B){return O.apply(this,arguments)}return D}()}]}}),Object(y.listeners)(function(j){var p=j.actions,g=j.values;return{setRoleInFocus:function(D){var B=D.role;B&&p.loadRoleMembers({roleId:B.id}),p.setCreateRoleModalShown(!0)},openCreateRoleModal:function(){p.setRoleInFocus(null),p.setRoleMembersInFocus([]),p.setCreateRoleModalShown(!0)},setCreateRoleModalShown:function(){g.roleInFocus?p.setPermission(ee.U.FEATURE_FLAGS,g.roleInFocus.feature_flags_access_level):p.setPermission(ee.U.FEATURE_FLAGS,ee.a.WRITE)},setPermissionInPlace:function(){var O=T()(ne.a.mark(function B(N){var K,P;return ne.a.wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(K=N.access,!g.roleInFocus){G.next=9;break}if(G.t0=K,!G.t0){G.next=6;break}return G.next=6,H.b.roles.update(g.roleInFocus.id,{feature_flags_access_level:K});case 6:P=Object.assign({},g.roleInFocus),P.feature_flags_access_level=K,p.updateRole(P);case 9:case"end":return G.stop()}},B)}));function D(B){return O.apply(this,arguments)}return D}()}}),Object(y.selectors)({addableMembers:[function(j){return[j.allMembers,j.roleMembersInFocus]},function(j,p){var g=[],O=nt(j),D;try{var B=function(){var K=D.value;p.some(function(P){return P.user.uuid===K.user.uuid})||g.push(K.user)};for(O.s();!(D=O.n()).done;)B()}catch(N){O.e(N)}finally{O.f()}return g.sort(function(N,K){return N.first_name.localeCompare(K.first_name)}),g}]}),Object(y.afterMount)(function(j){var p=j.actions;p.loadRoles()})])},"./frontend/src/scenes/project-homepage/ProjectHomePageCompactListItem.tsx":function(je,M,n){"use strict";n.d(M,"a",function(){return Ie});var q=n("./frontend/@posthog/lemon-ui/src/index.ts"),$=n("./node_modules/react/index.js"),Ee=n.n($),S=n("./node_modules/react/jsx-runtime.js"),Oe=n.n(S);function Ie(de){var Ce=de.to,Te=de.onClick,Ve=de.title,ue=de.subtitle,Pe=de.prefix,fe=de.suffix;return Object(S.jsx)(q.LemonButton,{fullWidth:!0,to:Ce,onClick:Te,children:Object(S.jsxs)("div",{className:"flex items-center justify-between h-10 overflow-hidden gap-2 flex-1",children:[Pe?Object(S.jsx)("span",{className:"shrink-0",children:Pe}):null,Object(S.jsxs)("div",{className:"truncate space-y-1 flex-1",children:[Object(S.jsx)("div",{className:"text-primary font-semibold truncate",children:Ve}),Object(S.jsx)("div",{className:"truncate text-default font-normal",children:ue})]}),fe?Object(S.jsx)("span",{className:"shrink-0",children:fe}):null]})})}try{Ie.displayName="ProjectHomePageCompactListItem",Ie.__docgenInfo={description:"",displayName:"ProjectHomePageCompactListItem",props:{to:{defaultValue:null,description:"URL to link to.",name:"to",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},subtitle:{defaultValue:null,description:"",name:"subtitle",required:!0,type:{name:"string"}},prefix:{defaultValue:null,description:"",name:"prefix",required:!1,type:{name:"ReactNode"}},suffix:{defaultValue:null,description:"",name:"suffix",required:!1,type:{name:"ReactNode"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/project-homepage/ProjectHomePageCompactListItem.tsx#ProjectHomePageCompactListItem"]={docgenInfo:Ie.__docgenInfo,name:"ProjectHomePageCompactListItem",path:"frontend/src/scenes/project-homepage/ProjectHomePageCompactListItem.tsx#ProjectHomePageCompactListItem"})}catch(de){}},"./frontend/src/scenes/project-homepage/ProjectHomepage.scss":function(je,M,n){"use strict";var q=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),$=n.n(q),Ee=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/project-homepage/ProjectHomepage.scss"),S=n.n(Ee),Oe={};Oe.insert="head",Oe.singleton=!1;var Ie=$()(S.a,Oe),de=S.a.locals||{}},"./frontend/src/scenes/project-homepage/RecentInsights.tsx":function(je,M,n){"use strict";n.d(M,"a",function(){return x}),n.d(M,"b",function(){return Fe});var q=n("./node_modules/core-js/modules/es.function.name.js"),$=n.n(q),Ee=n("./node_modules/core-js/modules/es.array.slice.js"),S=n.n(Ee),Oe=n("./node_modules/react/index.js"),Ie=n.n(Oe),de=n("./frontend/src/scenes/project-homepage/ProjectHomepage.scss"),Ce=n("./node_modules/kea/lib/index.esm.js"),Te=n("./frontend/src/lib/dayjs.ts"),Ve=n("./frontend/src/lib/components/CompactList/CompactList.tsx"),ue=n("./frontend/src/scenes/urls.ts"),Pe=n("./frontend/src/scenes/saved-insights/SavedInsights.tsx"),fe=n("./frontend/src/scenes/project-homepage/projectHomepageLogic.tsx"),he=n("./frontend/src/lib/utils/eventUsageLogic.ts"),be=n("./frontend/src/scenes/project-homepage/ProjectHomePageCompactListItem.tsx"),A=n("./node_modules/react/jsx-runtime.js"),L=n.n(A);function x(J){var ie=J.insight,_e=Object(Ce.useActions)(he.e),V=_e.reportInsightOpenedFromRecentInsightList;return Object(A.jsx)(be.a,{title:ie.name||ie.derived_name||"Insight",subtitle:"Last modified ".concat(Object(Te.a)(ie.last_modified_at).fromNow()),prefix:Object(A.jsx)(Pe.InsightIcon,{insight:ie}),to:ue.a.insightView(ie.short_id),onClick:function(){V()}})}function Fe(){var J=Object(Ce.useValues)(fe.a),ie=J.recentInsights,_e=J.recentInsightsLoading,V=Object(Ce.useActions)(fe.a),le=V.loadRecentInsights;return Object(Oe.useEffect)(function(){le()},[]),Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(Ve.a,{title:"Your recently viewed insights",viewAllURL:ue.a.savedInsights(),loading:_e,emptyMessage:{title:"You have no recently viewed insights",description:"Explore this project's insights by clicking below.",buttonText:"View insights",buttonTo:ue.a.savedInsights()},items:ie.slice(0,5),renderRow:function(T,Ke){return Object(A.jsx)(x,{insight:T},Ke)}})})}try{x.displayName="InsightRow",x.__docgenInfo={description:"",displayName:"InsightRow",props:{insight:{defaultValue:null,description:"",name:"insight",required:!0,type:{name:"InsightModel"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/project-homepage/RecentInsights.tsx#InsightRow"]={docgenInfo:x.__docgenInfo,name:"InsightRow",path:"frontend/src/scenes/project-homepage/RecentInsights.tsx#InsightRow"})}catch(J){}},"./frontend/src/scenes/project-homepage/RecentRecordings.tsx":function(je,M,n){"use strict";n.d(M,"b",function(){return J}),n.d(M,"a",function(){return ie});var q=n("./node_modules/core-js/modules/es.array.slice.js"),$=n.n(q),Ee=n("./frontend/src/lib/dayjs.ts"),S=n("./node_modules/kea/lib/index.esm.js"),Oe=n("./frontend/src/scenes/project-homepage/ProjectHomepage.scss"),Ie=n("./frontend/src/lib/components/CompactList/CompactList.tsx"),de=n("./frontend/src/lib/components/ProfilePicture/index.ts"),Ce=n("./frontend/src/scenes/persons/PersonHeader.tsx"),Te=n("./frontend/src/scenes/session-recordings/playlist/sessionRecordingsListLogic.ts"),Ve=n("./frontend/src/scenes/urls.ts"),ue=n("./frontend/src/lib/utils/eventUsageLogic.ts"),Pe=n("./frontend/src/lib/utils.tsx"),fe=n("./frontend/src/lib/components/icons.tsx"),he=n("./frontend/src/scenes/session-recordings/player/modal/SessionPlayerModal.tsx"),be=n("./frontend/src/scenes/teamLogic.tsx"),A=n("./frontend/src/scenes/session-recordings/player/modal/sessionPlayerModalLogic.ts"),L=n("./frontend/src/scenes/project-homepage/ProjectHomePageCompactListItem.tsx"),x=n("./node_modules/react/jsx-runtime.js"),Fe=n.n(x);function J(_e){var V=_e.recording,le=Object(S.useActions)(A.a),m=le.openSessionPlayer,T=Object(S.useActions)(ue.e),Ke=T.reportRecordingOpenedFromRecentRecordingList;return Object(x.jsx)(L.a,{title:Object(Ce.b)(V.person),subtitle:"Recorded ".concat(Object(Ee.a)(V.start_time).fromNow()),prefix:Object(x.jsx)(de.b,{name:Object(Ce.b)(V.person)}),suffix:Object(x.jsxs)("div",{className:"flex items-center justify-end text-default",children:[Object(x.jsx)("span",{children:Object(Pe.P)(V.recording_duration)}),Object(x.jsx)(fe.IconPlayCircle,{className:"text-2xl ml-2"})]}),onClick:function(){m({id:V.id,matching_events:V.matching_events}),Ke()}})}function ie(){var _e=Object(S.useValues)(be.a),V=_e.currentTeam,le=Object(Te.d)({key:"projectHomepage"}),m=Object(S.useValues)(le),T=m.sessionRecordings,Ke=m.sessionRecordingsResponseLoading;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(he.a,{}),Object(x.jsx)(Ie.a,{title:"Recent recordings",viewAllURL:Ve.a.sessionRecordings(),loading:Ke,emptyMessage:V!=null&&V.session_recording_opt_in?{title:"There are no recordings for this project",description:"Make sure you have the javascript snippet setup in your website.",buttonText:"Learn more",buttonTo:"https://posthog.com/docs/user-guides/recordings"}:{title:"Recordings are not enabled for this project",description:"Once recordings are enabled, new recordings will display here.",buttonText:"Enable recordings",buttonTo:Ve.a.projectSettings()+"#recordings"},items:T.slice(0,5),renderRow:function(at,ne){return Object(x.jsx)(J,{recording:at},ne)}})]})}try{J.displayName="RecordingRow",J.__docgenInfo={description:"",displayName:"RecordingRow",props:{recording:{defaultValue:null,description:"",name:"recording",required:!0,type:{name:"SessionRecordingType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/project-homepage/RecentRecordings.tsx#RecordingRow"]={docgenInfo:J.__docgenInfo,name:"RecordingRow",path:"frontend/src/scenes/project-homepage/RecentRecordings.tsx#RecordingRow"})}catch(_e){}},"./frontend/src/scenes/project-homepage/projectHomepageLogic.tsx":function(je,M,n){"use strict";n.d(M,"a",function(){return L});var q=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),$=n.n(q),Ee=n("./node_modules/@babel/runtime/regenerator/index.js"),S=n.n(Ee),Oe=n("./node_modules/core-js/modules/es.array.iterator.js"),Ie=n.n(Oe),de=n("./node_modules/core-js/modules/es.object.to-string.js"),Ce=n.n(de),Te=n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Ve=n.n(Te),ue=n("./node_modules/kea/lib/index.esm.js"),Pe=n("./frontend/src/scenes/teamLogic.tsx"),fe=n("./frontend/src/types.ts"),he=n("./frontend/src/lib/api.ts"),be=n("./node_modules/kea-loaders/lib/index.js"),A=n.n(be),L=Object(ue.kea)([Object(ue.path)(["scenes","project-homepage","projectHomepageLogic"]),Object(ue.connect)({values:[Pe.a,["currentTeamId","currentTeam"]]}),Object(ue.selectors)({primaryDashboardId:[function(){return[Pe.a.selectors.currentTeam]},function(x){return x==null?void 0:x.primary_dashboard}],dashboardLogicProps:[function(x){return[x.primaryDashboardId]},function(x){return{id:x!=null?x:void 0,placement:fe.n.ProjectHomepage}}]}),Object(be.loaders)(function(x){var Fe=x.values;return{recentInsights:[[],{loadRecentInsights:function(){var J=$()(S.a.mark(function _e(){var V;return S.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,he.b.get("api/projects/".concat(Fe.currentTeamId,"/insights/?my_last_viewed=true&order=-my_last_viewed_at"));case 2:return V=m.sent,m.abrupt("return",V.results);case 4:case"end":return m.stop()}},_e)}));function ie(){return J.apply(this,arguments)}return ie}()}],persons:[[],{loadPersons:function(){var J=$()(S.a.mark(function _e(){var V;return S.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,he.b.persons.list();case 2:return V=m.sent,m.abrupt("return",V.results);case 4:case"end":return m.stop()}},_e)}));function ie(){return J.apply(this,arguments)}return ie}()}]}}),Object(ue.afterMount)(function(x){var Fe=x.actions;Fe.loadRecentInsights(),Fe.loadPersons()})])},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss":function(je,M,n){var q=n("./node_modules/css-loader/dist/runtime/api.js");M=q(!1),M.push([je.i,".variant-form-list{font-size:13px;border:1px solid var(--border);border-radius:var(--radius);padding:16px;margin-top:16px}.variant-form-list .ant-form-item{min-height:32px}.variant-form-list .label-row{font-weight:700}.variant-form-list .label-row .ant-col{min-height:32px;display:flex;justify-content:space-between;align-items:center}.feature-flag-property-display{display:flex;flex-direction:row;align-items:center;flex-wrap:wrap;gap:.5rem;margin-top:.5rem}.feature-flag-property-display .arrow-right{margin-right:-8px;margin-top:.25rem}.feature-flag-property-display .display-value{word-break:break-all}.condition-set-separator{color:var(--primary-alt);font-size:12px;font-weight:var(--font-semibold);margin-left:.5rem;margin-bottom:.5rem}.feature-flag-form-row{display:flex;justify-content:space-between;align-items:center;width:100%}.feature-flag-form-row .centered{display:flex;align-items:center;white-space:pre-wrap}",""]),je.exports=M},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlagInstructions.scss":function(je,M,n){var q=n("./node_modules/css-loader/dist/runtime/api.js");M=q(!1),M.push([je.i,".FeatureFlagInstructionsHeader{flex-wrap:nowrap}.FeatureFlagInstructionsHeader .FeatureFlagInstructionsHeader__header-title{display:flex;justify-items:center}.FeatureFlagInstructionsHeader .FeatureFlagInstructionsHeader__header-title .FeatureFlagInstructionsHeader__header-title__icon{color:var(--text-muted-alt);margin-right:12px;font-size:1.6em}.FeatureFlagInstructionsHeader__option{display:flex;justify-items:center}.FeatureFlagInstructionsHeader__option .FeatureFlagInstructionsHeader__option__icon{margin-top:2px;margin-right:8px}",""]),je.exports=M},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/project-homepage/ProjectHomepage.scss":function(je,M,n){var q=n("./node_modules/css-loader/dist/runtime/api.js");M=q(!1),M.push([je.i,".project-homepage .homepage-dashboard-header{display:flex;justify-content:space-between;align-items:center}.project-homepage .homepage-dashboard-header .dashboard-title-container{display:flex;flex-direction:row;align-items:center}.project-homepage .homepage-dashboard-header .dashboard-title-container .ant-skeleton{width:300px}.project-homepage .homepage-dashboard-header .dashboard-title-container .ant-skeleton h3{margin:0}.project-homepage .top-list-container-horizontal{display:flex}.project-homepage .top-list-container-horizontal .top-list{margin-bottom:1.5rem;width:33%}.project-homepage .top-list-container-horizontal .spacer{width:1rem}.project-homepage .top-list-container-vertical{margin-bottom:1.5rem}.project-homepage .top-list-container-vertical .spacer{height:1rem}.project-homepage .empty-state-container{background-color:var(--side);width:100%;justify-content:center;align-items:center;padding:4rem;display:flex;flex-direction:column}",""]),je.exports=M}}]);
