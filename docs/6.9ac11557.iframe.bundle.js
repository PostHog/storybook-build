(window.webpackJsonp=window.webpackJsonp||[]).push([[6,8,10,309],{"./frontend/src/scenes/apps/AppMetricsGraph.scss":function(y,i,e){"use strict";e.r(i);var D=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),j=e.n(D),f=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/apps/AppMetricsGraph.scss"),d=e.n(f),P={};P.insert="head",P.singleton=!1;var v=j()(d.a,P);i.default=d.a.locals||{}},"./frontend/src/scenes/apps/AppMetricsGraph.tsx":function(y,i,e){"use strict";e.r(i),e.d(i,"AppMetricsGraph",function(){return C});var D=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),j=e.n(D),f=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),d=e.n(f),P=e("./node_modules/core-js/modules/es.array.concat.js"),v=e.n(P),K=e("./node_modules/core-js/modules/es.object.keys.js"),Y=e.n(K),U=e("./node_modules/core-js/modules/es.symbol.js"),Z=e.n(U),W=e("./node_modules/core-js/modules/es.array.filter.js"),z=e.n(W),x=e("./node_modules/core-js/modules/es.object.to-string.js"),Q=e.n(x),S=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),X=e.n(S),G=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),w=e.n(G),F=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),k=e.n(F),L=e("./node_modules/react/index.js"),q=e.n(L),H=e("./frontend/src/lib/colors.ts"),$=e("./node_modules/chart.js/dist/chart.mjs"),M=e("./frontend/src/scenes/apps/constants.tsx"),R=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),ee=e("./frontend/src/scenes/apps/AppMetricsGraph.scss"),T=e("./frontend/src/lib/utils.tsx"),g=e("./node_modules/react/jsx-runtime.js"),h=e.n(g);function b(_,c){var a=Object.keys(_);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(_);c&&(m=m.filter(function(s){return Object.getOwnPropertyDescriptor(_,s).enumerable})),a.push.apply(a,m)}return a}function B(_){for(var c=1;c<arguments.length;c++){var a=arguments[c]!=null?arguments[c]:{};c%2?b(Object(a),!0).forEach(function(m){j()(_,m,a[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach(function(m){Object.defineProperty(_,m,Object.getOwnPropertyDescriptor(a,m))})}return _}function C(_){var c=_.tab,a=_.metrics,m=_.metricsLoading,s=Object(L.useRef)(null),o=M.DescriptionColumns[c];return Object(L.useEffect)(function(){var r;if(s.current&&a){var t;r=new $.a((t=s.current)===null||t===void 0?void 0:t.getContext("2d"),{type:"line",data:{labels:a.dates,datasets:[B({label:o.successes,data:a.successes,borderColor:""},u("data-brand-blue"))].concat(d()(o.successes_on_retry?[B({label:o.successes_on_retry,data:a.successes_on_retry},u("data-yellow"))]:[]),[B({label:o.failures,data:a.failures},u("data-vermilion"))])},options:{scales:{x:{ticks:{maxRotation:0},grid:{display:!1}},y:{beginAtZero:!0}},plugins:{crosshair:!1,legend:{display:!1}},maintainAspectRatio:!1,interaction:{mode:"index",axis:"x",intersect:!1}}})}return function(){var n;(n=r)===null||n===void 0||n.destroy()}},[a]),m||!a?Object(g.jsx)(R.a,{className:"AppMetricsGraph border rounded p-6"}):Object(g.jsx)("div",{className:"AppMetricsGraph border rounded p-6",children:Object(g.jsx)("canvas",{ref:s})})}function u(_){var c=Object(H.b)(_);return{borderColor:c,hoverBorderColor:Object(T.lb)(c,-20),hoverBackgroundColor:Object(T.lb)(c,-20),backgroundColor:c,fill:!1,borderWidth:2,pointRadius:0}}try{C.displayName="AppMetricsGraph",C.__docgenInfo={description:"",displayName:"AppMetricsGraph",props:{tab:{defaultValue:null,description:"",name:"tab",required:!0,type:{name:"enum",value:[{value:'"processEvent"'},{value:'"onEvent"'},{value:'"exportEvents"'},{value:'"historical_exports"'}]}},metrics:{defaultValue:null,description:"",name:"metrics",required:!1,type:{name:"AppMetrics | null"}},metricsLoading:{defaultValue:null,description:"",name:"metricsLoading",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/apps/AppMetricsGraph.tsx#AppMetricsGraph"]={docgenInfo:C.__docgenInfo,name:"AppMetricsGraph",path:"frontend/src/scenes/apps/AppMetricsGraph.tsx#AppMetricsGraph"})}catch(_){}},"./frontend/src/scenes/apps/appMetricsSceneLogic.ts":function(y,i,e){"use strict";e.r(i),e.d(i,"AppMetricsTab",function(){return u}),e.d(i,"appMetricsSceneLogic",function(){return a});var D=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),j=e.n(D),f=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),d=e.n(f),P=e("./node_modules/@babel/runtime/regenerator/index.js"),v=e.n(P),K=e("./node_modules/core-js/modules/es.array.iterator.js"),Y=e.n(K),U=e("./node_modules/core-js/modules/es.object.to-string.js"),Z=e.n(U),W=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),z=e.n(W),x=e("./node_modules/core-js/modules/es.array.concat.js"),Q=e.n(x),S=e("./node_modules/core-js/modules/es.function.name.js"),X=e.n(S),G=e("./node_modules/core-js/modules/es.array.includes.js"),w=e.n(G),F=e("./node_modules/core-js/modules/es.string.includes.js"),k=e.n(F),L=e("./node_modules/core-js/modules/es.array.filter.js"),q=e.n(L),H=e("./node_modules/core-js/modules/es.number.constructor.js"),$=e.n(H),M=e("./node_modules/kea/lib/index.esm.js"),R=e("./node_modules/kea-loaders/lib/index.js"),ee=e.n(R),T=e("./frontend/src/scenes/urls.ts"),g=e("./frontend/src/lib/api.ts"),h=e("./frontend/src/scenes/teamLogic.tsx"),b=e("./node_modules/kea-router/lib/index.js"),B=e.n(b),C=e("./frontend/src/lib/utils.tsx"),u;(function(s){s.ProcessEvent="processEvent",s.OnEvent="onEvent",s.ExportEvents="exportEvents",s.HistoricalExports="historical_exports"})(u||(u={}));var _="-30d",c=[u.ProcessEvent,u.OnEvent,u.ExportEvents],a=Object(M.kea)([Object(M.path)(function(s){return["scenes","apps","appMetricsSceneLogic",s]}),Object(M.props)({}),Object(M.key)(function(s){return s.pluginConfigId}),Object(M.actions)({setActiveTab:function(o){return{tab:o}},setDateFrom:function(o){return{dateFrom:o}},openErrorDetailsModal:function(o,r,t){return{errorType:o,category:r,jobId:t}},closeErrorDetailsModal:!0}),Object(M.reducers)({activeTab:[null,{setActiveTab:function(o,r){var t=r.tab;return t}}],dateFrom:[_,{setDateFrom:function(o,r){var t=r.dateFrom;return t}}],errorDetailsModalError:[null,{openErrorDetailsModal:function(o,r){var t=r.errorType;return t},closeErrorDetailsModal:function(){return null}}]}),Object(R.loaders)(function(s){var o=s.values,r=s.props;return{pluginConfig:[null,{loadPluginConfig:function(){var t=d()(v.a.mark(function E(){return v.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,g.b.get("api/projects/".concat(h.a.values.currentTeamId,"/plugin_configs/").concat(r.pluginConfigId));case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},E)}));function n(){return t.apply(this,arguments)}return n}()}],appMetricsResponse:[null,{loadMetrics:function(){var t=d()(v.a.mark(function E(){var l;return v.a.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return l=Object(C.Eb)({category:o.activeTab,date_from:o.dateFrom}),O.next=3,g.b.get("api/projects/".concat(h.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"?").concat(l));case 3:return O.abrupt("return",O.sent);case 4:case"end":return O.stop()}},E)}));function n(){return t.apply(this,arguments)}return n}()}],historicalExports:[[],{loadHistoricalExports:function(){var t=d()(v.a.mark(function E(){var l,p;return v.a.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,g.b.get("api/projects/".concat(h.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"/historical_exports"));case 2:return l=A.sent,p=l.results,A.abrupt("return",p);case 5:case"end":return A.stop()}},E)}));function n(){return t.apply(this,arguments)}return n}()}],errorDetails:[[],{openErrorDetailsModal:function(){var t=d()(v.a.mark(function E(l){var p,O,A,N,V,J;return v.a.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return p=l.category,O=l.jobId,A=l.errorType,N=Object(C.Eb)({category:p,job_id:O,error_type:A}),I.next=4,g.b.get("api/projects/".concat(h.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"/error_details?").concat(N));case 4:return V=I.sent,J=V.result,I.abrupt("return",J);case 7:case"end":return I.stop()}},E)}));function n(E){return t.apply(this,arguments)}return n}()}]}}),Object(M.selectors)(function(s){var o=s.values;return{breadcrumbs:[function(r){return[r.pluginConfig,function(t,n){return n.pluginConfigId}]},function(r,t){var n;return[{name:"Apps",path:T.a.projectApps()},{name:r==null||(n=r.plugin_info)===null||n===void 0?void 0:n.name,path:T.a.appMetrics(t)}]}],showTab:[function(){return[]},function(){return function(r){var t;if(o.pluginConfigLoading||!o.pluginConfig)return!1;var n=((t=o.pluginConfig.plugin_info.capabilities)===null||t===void 0?void 0:t.methods)||[];return r===u.HistoricalExports?n.includes("exportEvents"):r===u.OnEvent&&n.includes("exportEvents")?!1:n.includes(r)}}]}}),Object(M.listeners)(function(s){var o=s.values,r=s.actions;return{loadPluginConfigSuccess:function(){if(!o.activeTab){var n=c.filter(function(p){return o.showTab(p)}),E=j()(n,1),l=E[0];r.setActiveTab(l)}},setActiveTab:function(n){var E=n.tab;E===u.HistoricalExports?r.loadHistoricalExports():r.loadMetrics()},setDateFrom:function(){r.loadMetrics()}}}),Object(b.actionToUrl)(function(s){var o=s.values,r=s.props;return{setActiveTab:function(){return m(o,r)},setDateFrom:function(){return m(o,r)}}}),Object(b.urlToAction)(function(s){var o=s.values,r=s.actions,t=s.props;return{"/app/:pluginConfigId/:page":function(E,l){t.pluginConfigId===Number(E.pluginConfigId)&&(o.pluginConfig||r.loadPluginConfig(),E.page===u.HistoricalExports?r.setActiveTab(u.HistoricalExports):(l.tab&&c.includes(l.tab)&&r.setActiveTab(l.tab),l.from&&r.setDateFrom(l.from)))}}})]);function m(s,o){if(s.activeTab===u.HistoricalExports)return T.a.appHistoricalExports(o.pluginConfigId);var r={};return s.activeTab&&(r.tab=s.activeTab),s.dateFrom!==_&&(r.from=s.dateFrom),T.a.appMetrics(o.pluginConfigId,r)}},"./frontend/src/scenes/apps/constants.tsx":function(y,i,e){"use strict";e.r(i),e.d(i,"DescriptionColumns",function(){return P});var D=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),j=e.n(D),f=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),d,P=(d={},j()(d,f.AppMetricsTab.ProcessEvent,{successes:"Events processed",failures:"Failed events"}),j()(d,f.AppMetricsTab.OnEvent,{successes:"Events processed",successes_on_retry:"Events processed on retry",failures:"Failed events"}),j()(d,f.AppMetricsTab.ExportEvents,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),j()(d,f.AppMetricsTab.HistoricalExports,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),d)},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/apps/AppMetricsGraph.scss":function(y,i,e){var D=e("./node_modules/css-loader/dist/runtime/api.js");i=D(!1),i.push([y.i,".AppMetricsGraph{height:300px}",""]),y.exports=i}}]);
