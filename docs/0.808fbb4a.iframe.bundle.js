(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"./frontend/src/scenes/actions/EventName.tsx":function(pe,B,e){"use strict";e.d(B,"a",function(){return ie}),e.d(B,"b",function(){return q});var G=e("./node_modules/react/index.js"),N=e.n(G),te=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),ne=e("./frontend/src/lib/components/TaxonomicPopup/TaxonomicPopup.tsx"),le=e("./frontend/src/lib/components/TaxonomicFilter/types.ts");function ie(Q){var re=Q.value,X=Q.onChange;return N.a.createElement(ne.d,{groupType:le.a.Events,onChange:X,value:re,type:"secondary",style:{maxWidth:"24rem"},placeholder:"Choose an event",dataAttr:"event-name-box",renderValue:function(s){return N.a.createElement(te.a,{value:s,disablePopover:!0})},allowClear:!0})}function q(Q){var re=Q.value,X=Q.onChange;return N.a.createElement(ne.b,{groupType:le.a.Events,onChange:X,value:re,type:"secondary",placeholder:"Select an event",dataAttr:"event-name-box",renderValue:function(s){return N.a.createElement(te.a,{value:s,disablePopover:!0})},allowClear:!0})}try{ie.displayName="EventName",ie.__docgenInfo={description:"",displayName:"EventName",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/actions/EventName.tsx#EventName"]={docgenInfo:ie.__docgenInfo,name:"EventName",path:"frontend/src/scenes/actions/EventName.tsx#EventName"})}catch(Q){}try{q.displayName="LemonEventName",q.__docgenInfo={description:"",displayName:"LemonEventName",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/actions/EventName.tsx#LemonEventName"]={docgenInfo:q.__docgenInfo,name:"LemonEventName",path:"frontend/src/scenes/actions/EventName.tsx#LemonEventName"})}catch(Q){}},"./frontend/src/scenes/events/EventDetails.tsx":function(pe,B,e){"use strict";e.d(B,"a",function(){return z});var G=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),N=e.n(G),te=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),ne=e.n(te),le=e("./node_modules/core-js/modules/es.object.keys.js"),ie=e("./node_modules/core-js/modules/es.symbol.js"),q=e("./node_modules/core-js/modules/es.array.filter.js"),Q=e("./node_modules/core-js/modules/es.object.to-string.js"),re=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),X=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Z=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),s=e("./node_modules/react/index.js"),C=e.n(s),D=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),se=e("./frontend/src/lib/components/PropertiesTable.tsx"),F=e("./frontend/src/scenes/events/EventElements.tsx"),ce=e("./node_modules/antd/es/tabs/index.js"),Te=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),he=e.n(Te),Ce=e("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),fe=e("./frontend/src/lib/utils.tsx"),oe=["event","id","uuid","distinct_id","properties","elements","timestamp","person"];function ue(_,a){var h=Object.keys(_);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(_);a&&(j=j.filter(function(S){return Object.getOwnPropertyDescriptor(_,S).enumerable})),h.push.apply(h,j)}return h}function J(_){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?ue(Object(h),!0).forEach(function(j){N()(_,j,h[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(h)):ue(Object(h)).forEach(function(j){Object.defineProperty(_,j,Object.getOwnPropertyDescriptor(h,j))})}return _}function U(_){var a=_.event,h=a.event,j=a.id,S=a.uuid,K=a.distinct_id,ve=a.properties,V=a.elements,me=a.timestamp,k=a.person,ae=he()(a,oe),R=J(J(J(J({},j?{id:j}:null),S?{uuid:S}:null),{},{timestamp:me,event:h,distinct_id:K,properties:Object(fe.wb)(ve)},V&&V.length>0?{elements:V}:null),ae);return C.a.createElement(Ce.a,{language:Ce.b.JSON},JSON.stringify(R,null,4))}try{U.displayName="EventJSON",U.__docgenInfo={description:"",displayName:"EventJSON",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"Record<string, any>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventJSON.tsx#EventJSON"]={docgenInfo:U.__docgenInfo,name:"EventJSON",path:"frontend/src/scenes/events/EventJSON.tsx#EventJSON"})}catch(_){}var Oe=e("./frontend/src/lib/dayjs.ts"),W=e("./frontend/src/lib/components/LemonButton/index.ts");function w(_,a){var h=Object.keys(_);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(_);a&&(j=j.filter(function(S){return Object.getOwnPropertyDescriptor(_,S).enumerable})),h.push.apply(h,j)}return h}function b(_){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?w(Object(h),!0).forEach(function(j){N()(_,j,h[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(h)):w(Object(h)).forEach(function(j){Object.defineProperty(_,j,Object.getOwnPropertyDescriptor(h,j))})}return _}var de=ce.a.TabPane;function z(_){for(var a=_.event,h=Object(s.useState)(!1),j=ne()(h,2),S=j[0],K=j[1],ve={},V={},me=0,k=0,ae=Object.keys(a.properties);k<ae.length;k++){var R=ae[k];D.e.event[R]&&D.e.event[R].hide&&(me+=1,S&&(V[R]=a.properties[R])),(!D.e.event[R]||!D.e.event[R].hide)&&(ve[R]=a.properties[R])}return C.a.createElement(ce.a,{"data-attr":"event-details",defaultActiveKey:"properties",style:{float:"left",width:"100%"},tabBarStyle:{margin:0}},C.a.createElement(de,{tab:"Properties",key:"properties"},C.a.createElement(se.a,{properties:b(b({$timestamp:Object(Oe.a)(a.timestamp).toISOString()},ve),V),useDetectedPropertyType:!0}),me>0&&C.a.createElement(W.a,{className:"mb-05",onClick:function(){return K(!S)},size:"small"},S?"Hide":"Show"," ",Object(fe.pb)(me,"hidden property","hidden properties"))),C.a.createElement(de,{tab:"JSON",key:"json"},C.a.createElement(U,{event:a})),a.elements&&a.elements.length>0&&C.a.createElement(de,{tab:"Elements",key:"elements"},C.a.createElement(F.a,{event:a})))}try{z.displayName="EventDetails",z.__docgenInfo={description:"",displayName:"EventDetails",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"EventType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventDetails.tsx#EventDetails"]={docgenInfo:z.__docgenInfo,name:"EventDetails",path:"frontend/src/scenes/events/EventDetails.tsx#EventDetails"})}catch(_){}},"./frontend/src/scenes/events/EventElements.tsx":function(pe,B,e){"use strict";e.d(B,"a",function(){return J});var G=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),N=e.n(G),te=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),ne=e.n(te),le=e("./node_modules/core-js/modules/es.array.join.js"),ie=e.n(le),q=e("./node_modules/core-js/modules/es.array.fill.js"),Q=e.n(q),re=e("./node_modules/core-js/modules/es.array.slice.js"),X=e.n(re),Z=e("./node_modules/core-js/modules/es.array.map.js"),s=e.n(Z),C=e("./node_modules/core-js/modules/es.object.entries.js"),D=e.n(C),se=e("./node_modules/core-js/modules/es.array.concat.js"),F=e.n(se),ce=e("./node_modules/core-js/modules/es.regexp.exec.js"),Te=e.n(ce),he=e("./node_modules/core-js/modules/es.string.replace.js"),Ce=e.n(he),fe=e("./node_modules/react/index.js"),oe=e.n(fe);function ue(U){return Array(U).fill("    ").join("")}function J(U){var Oe=U.event,W=ne()(Oe.elements||[]).reverse();return W=W.slice(Math.max(W.length-10,1)),oe.a.createElement("div",null,W.map(function(w,b){return oe.a.createElement("pre",{className:"code",key:b,style:{margin:0,padding:0,borderRadius:0,backgroundColor:b===W.length-1?"var(--primary)":void 0}},ue(b),"<",w.tag_name,w.attr_id&&' id="'.concat(w.attr_id,'"'),Object.entries(w.attributes).map(function(de){var z=N()(de,2),_=z[0],a=z[1];return oe.a.createElement("span",{key:_}," ".concat(_.replace("attr__",""),'="').concat(a,'"'))}),">",w.text,b===W.length-1&&oe.a.createElement("span",null,"</",w.tag_name,">"))}),ne()(W).reverse().slice(1).map(function(w,b){return oe.a.createElement("pre",{className:"code",key:b,style:{margin:0,padding:0,borderRadius:0}},ue(W.length-b-2),"</",w.tag_name,">")}))}try{J.displayName="EventElements",J.__docgenInfo={description:"",displayName:"EventElements",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"EventType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventElements.tsx#EventElements"]={docgenInfo:J.__docgenInfo,name:"EventElements",path:"frontend/src/scenes/events/EventElements.tsx#EventElements"})}catch(U){}},"./frontend/src/scenes/events/EventsTable.tsx":function(pe,B,e){"use strict";e.d(B,"a",function(){return H});var G=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),N=e.n(G),te=e("./node_modules/core-js/modules/es.array.splice.js"),ne=e("./node_modules/core-js/modules/es.array.map.js"),le=e("./node_modules/core-js/modules/es.array.find.js"),ie=e("./node_modules/core-js/modules/es.object.to-string.js"),q=e("./node_modules/core-js/modules/es.array.concat.js"),Q=e("./node_modules/core-js/modules/es.array.join.js"),re=e("./node_modules/core-js/modules/es.object.keys.js"),X=e("./node_modules/core-js/modules/es.regexp.to-string.js"),Z=e("./node_modules/react/index.js"),s=e.n(Z),C=e("./node_modules/kea/lib/index.esm.js"),D=e("./frontend/src/scenes/events/EventDetails.tsx"),se=e("./frontend/src/lib/components/Link.tsx"),F=e("./node_modules/antd/es/button/index.js"),ce=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),Te=e.n(ce),he=e("./node_modules/core-js/modules/es.array.filter.js"),Ce=e("./node_modules/core-js/modules/es.symbol.js"),fe=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),oe=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),ue=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),J=e("./node_modules/kea-router/lib/index.js"),U=e("./node_modules/@babel/runtime/helpers/typeof.js"),Oe=e.n(U),W=e("./node_modules/core-js/modules/es.regexp.exec.js"),w=e("./node_modules/core-js/modules/es.string.replace.js");function b(l){var f=l.value;return s.a.createElement("span",{title:f},Oe()(f)==="object"?JSON.stringify(f):f&&f.toString().replace(/(^\w+:|^)\/\//,""))}try{b.displayName="Property",b.__docgenInfo={description:"",displayName:"Property",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Property.tsx#Property"]={docgenInfo:b.__docgenInfo,name:"Property",path:"frontend/src/lib/components/Property.tsx#Property"})}catch(l){}var de=e("./frontend/src/lib/components/PropertyFilters/utils.ts");function z(l,f){var m=Object.keys(l);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(l);f&&(y=y.filter(function($){return Object.getOwnPropertyDescriptor(l,$).enumerable})),m.push.apply(m,y)}return m}function _(l){for(var f=1;f<arguments.length;f++){var m=arguments[f]!=null?arguments[f]:{};f%2?z(Object(m),!0).forEach(function(y){Te()(l,y,m[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(m)):z(Object(m)).forEach(function(y){Object.defineProperty(l,y,Object.getOwnPropertyDescriptor(m,y))})}return l}function a(l){var f=l.property,m=l.value,y=l.filters,$=l.onClick,O=l.className,Ee=Object(de.c)(y.properties),P=Ee.find(function(Y){return Y.key===f&&Y.value===m&&!Y.operator})?Ee.filter(function(Y){return Y.key!==f||Y.value!==m||Y.operator}):[].concat(N()(Ee),[{key:f,value:m}]),be=Object(J.combineUrl)(window.location.pathname,_(_({},y),{},{properties:P}),{}),_e=be.url;return s.a.createElement(se.a,{to:_e,className:O,onClick:function(){$&&$(f,m)}},s.a.createElement(b,{value:m}))}try{a.displayName="FilterPropertyLink",a.__docgenInfo={description:"",displayName:"FilterPropertyLink",props:{property:{defaultValue:null,description:"",name:"property",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string | number"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((property: string, value: string | number) => void)"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/FilterPropertyLink.tsx#FilterPropertyLink"]={docgenInfo:a.__docgenInfo,name:"FilterPropertyLink",path:"frontend/src/lib/components/FilterPropertyLink.tsx#FilterPropertyLink"})}catch(l){}var h=e("./frontend/src/lib/utils.tsx"),j=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),S=e.n(j),K=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/events/EventsTable.scss"),ve=e.n(K),V={};V.insert="head",V.singleton=!1;var me=S()(ve.a,V),k=ve.a.locals||{},ae=e("./frontend/src/scenes/events/eventsTableLogic.ts"),R=e("./frontend/src/scenes/persons/PersonHeader.tsx"),x=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),De=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),Pe=e("./frontend/src/types.ts"),xe=e("./frontend/src/scenes/actions/EventName.tsx"),Be=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),ge=e("./frontend/src/lib/components/Tooltip.tsx"),Me=e("./node_modules/clsx/dist/clsx.m.js"),p=e("./frontend/src/lib/components/ResizableTable/tableConfigLogic.ts"),t=e("./frontend/src/scenes/urls.ts"),n=e("./frontend/src/lib/components/LemonTable/index.ts"),r=e("./frontend/src/lib/components/icons.tsx"),u=e("./frontend/src/lib/components/LemonButton/index.ts"),o=e("./frontend/src/lib/components/LemonButton/More.tsx"),v=e("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),i=e("./frontend/src/scenes/teamLogic.tsx"),d=e("./frontend/src/scenes/events/createActionFromEvent.tsx");function M(l){Object(Z.useEffect)(function(){var f="hidden",m="visibilitychange";typeof document.msHidden!="undefined"?(f="msHidden",m="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(f="webkitHidden",m="webkitvisibilitychange");var y=function(){l(!document[f])};return document.addEventListener(m,y),function(){document.removeEventListener(m,y)}},[])}var I=e("./frontend/src/lib/components/ResizableTable/TableConfig.tsx");function H(l){var f=l.pageKey,m=l.fixedFilters,y=l.fixedColumns,$=l.sceneUrl,O=l.fetchMonths,Ee=O===void 0?12:O,P=l.startingColumns,be=l.showCustomizeColumns,_e=be===void 0?!0:be,Y=l.showExport,Ae=Y===void 0?!0:Y,Ke=l.showAutoload,ye=Ke===void 0?!0:Ke,$e=l.showEventFilter,Ne=$e===void 0?!0:$e,Ye=l.showPropertyFilter,Fe=Ye===void 0?!0:Ye,Je=l.showRowExpanders,et=Je===void 0?!0:Je,ze=l.showActionsButton,tt=ze===void 0?!0:ze,He=l.showPersonColumn,nt=He===void 0?!0:He,Ge=l.linkPropertiesToFilters,Ue=Ge===void 0?!0:Ge,rt=Object(C.useValues)(i.a),We=rt.currentTeam,Qe=Object(ae.a)({fixedFilters:m,key:f,sceneUrl:$||t.a.events(),fetchMonths:Ee}),ee=Object(C.useValues)(Qe),Le=ee.properties,st=ee.eventsFormatted,Xe=ee.isLoading,ot=ee.hasNext,Ze=ee.isLoadingNext,Re=ee.eventFilter,at=ee.automaticLoadEnabled,lt=ee.exportUrl,it=ee.highlightEvents,ct=ee.months,ke=Object(C.useValues)(Object(p.a)({startingColumns:P})),we=ke.tableWidth,Se=ke.selectedColumns,je=Object(C.useActions)(Qe),ut=je.fetchNextEvents,dt=je.prependNewEvents,vt=je.setEventFilter,mt=je.toggleAutomaticLoad,pt=je.startDownload,ft=je.setPollingActive,Et=je.setProperties,_t=!(m!=null&&m.person_id);M(ft);var qe=function(c,T){var g=c.date_break,E=c.new_events;return{children:g||(E?s.a.createElement(u.a,{icon:s.a.createElement(r.IconSync,null),style:{borderRadius:0},onClick:function(){return dt()},center:!0,fullWidth:!0},"There are new events. Click here to load them"):"???"),props:{colSpan:T+1,style:E?{padding:0}:void 0}}},yt={title:"Person",key:"person",render:function(c,T){var g,E,L=T.event;return L?_t&&(g=L.person)!==null&&g!==void 0&&(E=g.distinct_ids)!==null&&E!==void 0&&E.length?s.a.createElement(se.a,{to:t.a.person(L.person.distinct_ids[0])},s.a.createElement(R.a,{withIcon:!0,person:L.person})):s.a.createElement(R.a,{withIcon:!0,person:L.person}):{props:{colSpan:0}}}},Ve=Object(Z.useMemo)(function(){var A=[{title:"Event",key:"event",width:"16rem",render:function(T,g){if(!g.event)return qe(g,we);var E=g.event;return s.a.createElement(De.a,{value:Object(h.f)(E)})}},{title:"URL / Screen",key:"url",width:"4rem",render:function(T,g){var E=g.event;if(!E)return{props:{colSpan:0}};var L=E.properties.$current_url?"$current_url":"$screen_name";return Ue?s.a.createElement(a,{className:"ph-no-capture",property:L,value:E.properties[L],filters:{properties:Le}}):s.a.createElement(b,{value:E.properties[L]})}},{title:s.a.createElement(ge.a,{title:'This is the "Library" property on events. Sent by the SDK as "$lib"'},"Source"),key:"source",render:function(T,g){var E=g.event;return E?Ue?s.a.createElement(a,{property:"$lib",value:E.properties.$lib,filters:{properties:Le}}):s.a.createElement(b,{value:E.properties.$lib}):{props:{colSpan:0}}}}];return nt&&A.splice(1,0,yt),A},[we]),jt=Object(Z.useMemo)(function(){var A=Se==="DEFAULT"?N()(Ve):Se.map(function(c,T){return Ve.find(function(g){return g.key===c})||{title:De.e.event[c]?De.e.event[c].label:c,key:c,render:function(E,L){var Ie=L.event;return Ie?Ue?s.a.createElement(a,{className:"ph-no-capture ",property:c,value:Ie.properties[c],filters:{properties:Le}}):s.a.createElement(b,{value:Ie.properties[c]}):T===0?qe(L,we):{props:{colSpan:0}}}}});return A.push({title:"Time",key:"time",render:function(T,g){var E=g.event;return E?s.a.createElement(x.b,{time:E.timestamp,showSeconds:!0}):{props:{colSpan:0}}}}),tt&&A.push({key:"actions",width:0,render:function(T,g){var E=g.event;if(!E)return{props:{colSpan:0}};var L;return E.event==="$pageview"?L={insight:Pe.y.TRENDS,interval:"day",display:Pe.i.ActionsLineGraph,actions:[],events:[{id:"$pageview",name:"$pageview",type:"events",order:0,properties:[{key:"$current_url",value:E.properties.$current_url,type:"event"}]}]}:E.event!=="$autocapture"&&(L={insight:Pe.y.TRENDS,interval:"day",display:Pe.i.ActionsLineGraph,actions:[],events:[{id:E.event,name:E.event,type:"events",order:0,properties:[]}]}),s.a.createElement(o.a,{overlay:s.a.createElement(s.a.Fragment,null,We&&s.a.createElement(u.a,{type:"stealth",onClick:function(){return Object(d.a)(We.id,E,0,We.data_attributes||[])},fullWidth:!0,"data-attr":"events-table-create-action"},"Create action from event"),L&&s.a.createElement(u.a,{type:"stealth",to:t.a.insightNew(L),fullWidth:!0,"data-attr":"events-table-usage"},"Try out in Insights"))})}}),y?A.concat(y):A},[Se]);return s.a.createElement("div",{"data-attr":"manage-events-table"},s.a.createElement("div",{className:"events","data-attr":"events-table"},(Ne||Fe)&&s.a.createElement("div",{className:"flex pt pb space-x border-top"},Ne&&s.a.createElement(xe.b,{value:Re,onChange:function(c){vt(c||"")}}),Fe&&s.a.createElement(Be.a,{propertyFilters:Le,onChange:Et,pageKey:f,taxonomicPopoverPlacement:"bottom-start",style:{marginBottom:0,marginTop:0},eventNames:Re?[Re]:[],useLemonButton:!0})),ye||_e||Ae?s.a.createElement("div",{className:Object(Me.a)("space-between-items pt pb",(Ne||Fe)&&"border-top")},ye&&s.a.createElement(v.a,{type:"primary",id:"autoload-switch",label:"Automatically load new events",checked:at,onChange:mt}),s.a.createElement("div",{className:"flex space-x-05"},_e&&s.a.createElement(I.a,{immutableColumns:["event","person"],defaultColumns:Ve.map(function(A){return A.key||""})}),Ae&&lt&&s.a.createElement(ge.a,{title:"Export up to 10,000 latest events.",placement:"left"},s.a.createElement(u.a,{type:"secondary",icon:s.a.createElement(r.IconExport,{style:{color:"var(--primary)"}}),onClick:pt},"Export")))):null,s.a.createElement(n.a,{dataSource:st,loading:Xe,columns:jt,key:Se==="DEFAULT"?"default":Se.join("-"),className:"ph-no-capture",loadingSkeletonRows:20,emptyState:Xe?void 0:Le.some(function(A){return Object.keys(A).length})||Re?"No events matching filters found in the last ".concat(ct," months!"):s.a.createElement(s.a.Fragment,null,"This project doesn't have any events. If you haven't integrated PostHog yet,"," ",s.a.createElement(se.a,{to:"/project/settings"},"click here to instrument analytics with PostHog in your product"),"."),rowKey:function(c){var T;return c.event?c.event.id+"-"+c.event.event:((T=c.date_break)===null||T===void 0?void 0:T.toString())||""},rowClassName:function(c){return Object(Me.a)({"event-row":c.event,highlighted:c.event&&it[c.event.id],"event-row-is-exception":c.event&&c.event.event==="$exception","event-row-date-separator":c.date_break,"event-row-new":c.new_events})},expandable:et?{expandedRowRender:function(c){var T=c.event;return T&&s.a.createElement(D.a,{event:T})},rowExpandable:function(c){var T=c.event,g=c.date_break,E=c.new_events;return g||E?-1:!!T}}:void 0}),s.a.createElement(F.a,{type:"primary",onClick:ut,loading:Ze,style:{display:ot||Ze?"block":"none",margin:"2rem auto 1rem"}},"Load more events")))}try{H.displayName="EventsTable",H.__docgenInfo={description:"",displayName:"EventsTable",props:{pageKey:{defaultValue:null,description:"",name:"pageKey",required:!0,type:{name:"string"}},fixedFilters:{defaultValue:null,description:"",name:"fixedFilters",required:!1,type:{name:"FixedFilters"}},fixedColumns:{defaultValue:null,description:"",name:"fixedColumns",required:!1,type:{name:"LemonTableColumn<EventsTableRowItem, keyof EventsTableRowItem>[]"}},sceneUrl:{defaultValue:null,description:"",name:"sceneUrl",required:!1,type:{name:"string"}},fetchMonths:{defaultValue:{value:"12"},description:"",name:"fetchMonths",required:!1,type:{name:"number"}},startingColumns:{defaultValue:null,description:"",name:"startingColumns",required:!1,type:{name:"ColumnChoice"}},showCustomizeColumns:{defaultValue:{value:"true"},description:"",name:"showCustomizeColumns",required:!1,type:{name:"boolean"}},showExport:{defaultValue:{value:"true"},description:"",name:"showExport",required:!1,type:{name:"boolean"}},showAutoload:{defaultValue:{value:"true"},description:"",name:"showAutoload",required:!1,type:{name:"boolean"}},showEventFilter:{defaultValue:{value:"true"},description:"",name:"showEventFilter",required:!1,type:{name:"boolean"}},showPropertyFilter:{defaultValue:{value:"true"},description:"",name:"showPropertyFilter",required:!1,type:{name:"boolean"}},showRowExpanders:{defaultValue:{value:"true"},description:"",name:"showRowExpanders",required:!1,type:{name:"boolean"}},showActionsButton:{defaultValue:{value:"true"},description:"",name:"showActionsButton",required:!1,type:{name:"boolean"}},showPersonColumn:{defaultValue:{value:"true"},description:"",name:"showPersonColumn",required:!1,type:{name:"boolean"}},linkPropertiesToFilters:{defaultValue:{value:"true"},description:"",name:"linkPropertiesToFilters",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventsTable.tsx#EventsTable"]={docgenInfo:H.__docgenInfo,name:"EventsTable",path:"frontend/src/scenes/events/EventsTable.tsx#EventsTable"})}catch(l){}},"./frontend/src/scenes/events/eventsTableLogic.ts":function(pe,B,e){"use strict";e.d(B,"a",function(){return Me});var G=e("./node_modules/core-js/modules/es.object.keys.js"),N=e.n(G),te=e("./node_modules/core-js/modules/es.symbol.js"),ne=e.n(te),le=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),ie=e.n(le),q=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Q=e.n(q),re=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),X=e.n(re),Z=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),s=e.n(Z),C=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),D=e.n(C),se=e("./node_modules/@babel/runtime/regenerator/index.js"),F=e.n(se),ce=e("./node_modules/core-js/modules/es.array.map.js"),Te=e.n(ce),he=e("./node_modules/core-js/modules/es.object.to-string.js"),Ce=e.n(he),fe=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),oe=e.n(fe),ue=e("./node_modules/core-js/modules/es.array.splice.js"),J=e.n(ue),U=e("./node_modules/core-js/modules/es.array.join.js"),Oe=e.n(U),W=e("./node_modules/core-js/modules/es.array.filter.js"),w=e.n(W),b=e("./node_modules/core-js/modules/es.array.concat.js"),de=e.n(b),z=e("./node_modules/core-js/modules/es.array.iterator.js"),_=e.n(z),a=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),h=e.n(a),j=e("./node_modules/kea/lib/index.esm.js"),S=e("./frontend/src/lib/utils.tsx"),K=e("./node_modules/kea-router/lib/index.js"),ve=e.n(K),V=e("./frontend/src/lib/api.ts"),me=e("./frontend/src/scenes/teamLogic.tsx"),k=e("./frontend/src/lib/dayjs.ts"),ae=e("./frontend/src/lib/components/lemonToast.tsx");function R(p,t){var n=Object.keys(p);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(p);t&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(p,u).enumerable})),n.push.apply(n,r)}return n}function x(p){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?R(Object(n),!0).forEach(function(r){s()(p,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach(function(r){Object.defineProperty(p,r,Object.getOwnPropertyDescriptor(n,r))})}return p}var De=5,Pe=365,xe=5e3,Be=function(t,n){var r=[];return r=t.map(function(u){return{event:u}}),r.forEach(function(u,o){var v=r[o-1];o>0&&u.event&&v.event&&!Object(k.a)(u.event.timestamp).isSame(v.event.timestamp,"day")&&r.splice(o,0,{date_break:Object(k.a)(u.event.timestamp).format("LL")})}),n.length>0&&r.splice(0,0,{new_events:!0}),r},ge=function(t){return Object(k.b)().subtract(t,"day").toISOString()},Me=Object(j.kea)({path:function(t){return["scenes","events","eventsTableLogic",t]},props:{},key:function(t){return[t.fixedFilters?JSON.stringify(t.fixedFilters):"all",t.key,t.sceneUrl].filter(function(n){return!!n}).join("-")},connect:{values:[me.a,["currentTeamId"]]},actions:{setPollingActive:function(t){return{pollingActive:t}},setProperties:function(t){return Array.isArray(t)?t.length===0?{properties:[{}]}:{properties:t}:{properties:[t]}},fetchEvents:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return{nextParams:t}},fetchEventsSuccess:function(t){return t},fetchNextEvents:!0,fetchOrPollFailure:function(t){return{error:t}},pollEvents:!0,pollEventsSuccess:function(t){return{events:t}},prependEvents:function(t){return{events:t}},prependNewEvents:!0,setSelectedEvent:function(t){return{selectedEvent:t}},setPollTimeout:function(t){return{pollTimeout:t}},setEventFilter:function(t){return{event:t}},toggleAutomaticLoad:function(t){return{automaticLoadEnabled:t}},noop:function(t){return t},startDownload:!0},reducers:function(t){var n,r,u=t.props;return{pollingIsActive:[!0,{setPollingActive:function(v,i){var d=i.pollingActive;return d},pollEventsSuccess:function(v,i){var d=i.events;return d&&d.length?!1:v},prependNewEvents:function(){return!0},toggleAutomaticLoad:function(){return!0}}],properties:[[],{setProperties:function(v,i){var d=i.properties;return Object(S.s)(d)}}],eventFilter:[(n=(r=u.fixedFilters)===null||r===void 0?void 0:r.event_filter)!==null&&n!==void 0?n:"",{setEventFilter:function(v,i){var d=i.event;return d}}],isLoading:[!0,{fetchEvents:function(){return!0},fetchEventsSuccess:function(){return!1},fetchOrPollFailure:function(){return!1}}],isLoadingNext:[!1,{fetchNextEvents:function(){return!0},fetchEventsSuccess:function(){return!1}}],events:[[],{fetchEventsSuccess:function(v,i){var d=i.events,M=i.isNext;return M?[].concat(D()(v),D()(d)):d},prependEvents:function(v,i){var d=i.events;return[].concat(D()(d),D()(v))}}],hasNext:[!1,{fetchEvents:function(){return!1},fetchNextEvents:function(){return!1},fetchEventsSuccess:function(v,i){var d=i.hasNext;return d}}],orderBy:["-timestamp",{}],selectedEvent:[null,{setSelectedEvent:function(v,i){var d=i.selectedEvent;return d}}],newEvents:[[],{setProperties:function(){return[]},pollEventsSuccess:function(v,i){var d=i.events;return d||[]},prependEvents:function(){return[]}}],highlightEvents:[{},{prependEvents:function(v,i){var d=i.events;return d.reduce(function(M,I){return M[I.id]=!0,M},{})}}],pollTimeout:[0,{setPollTimeout:function(v,i){return i.pollTimeout}}],automaticLoadEnabled:[!1,{persist:!0},{toggleAutomaticLoad:function(v,i){var d=i.automaticLoadEnabled;return d}}]}},selectors:function(t){var n=t.selectors,r=t.props;return{eventsFormatted:[function(){return[n.events,n.newEvents]},function(u,o){return Be(u,o)}],exportUrl:[function(){return[n.currentTeamId,n.eventFilter,n.orderBy,n.properties,n.minimumQueryDate]},function(u,o,v,i,d){var M;return"/api/projects/".concat(u,"/events.csv?").concat(Object(S.zb)(x(x(x({},r.fixedFilters||{}),{},{properties:[].concat(D()(i),D()(((M=r.fixedFilters)===null||M===void 0?void 0:M.properties)||[]))},o?{event:o}:{}),{},{orderBy:[v],after:d})))}],months:[function(){return[function(u,o){return o.fetchMonths}]},function(u){return u||12}],minimumQueryDate:[function(){return[n.months]},function(u){return Object(k.b)().subtract(u,"months").toISOString()}],pollAfter:[function(){return[n.events]},function(u){return(u==null?void 0:u.length)>0&&u[0].timestamp?u[0].timestamp:ge(0)}]}},actionToUrl:function(t){var n=t.values;return{setProperties:function(){return[K.router.values.location.pathname,x(x({},K.router.values.searchParams),{},{properties:n.properties.length===0?void 0:n.properties}),K.router.values.hashParams,{replace:!0}]},setEventFilter:function(){return[K.router.values.location.pathname,x(x({},K.router.values.searchParams),{},{eventFilter:n.eventFilter}),K.router.values.hashParams,{replace:!0}]}}},urlToAction:function(t){var n=t.actions,r=t.values,u=t.props;return s()({},u.sceneUrl,function(o,v){n.setProperties(v.properties||r.properties||{}),v.eventFilter&&n.setEventFilter(v.eventFilter)})},events:function(t){var n=t.values;return{beforeUnmount:function(){return clearTimeout(n.pollTimeout||void 0)}}},listeners:function(t){var n=t.actions,r=t.values,u=t.props;return{startDownload:function(){ae.d.success("The export is starting. It should finish soon"),window.location.href=r.exportUrl},setProperties:function(){return n.fetchEvents()},setEventFilter:function(){return n.fetchEvents()},fetchNextEvents:function(){var o=X()(F.a.mark(function i(){var d;return F.a.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:d=r.events,d.length===0?n.fetchEvents():n.fetchEvents({before:d[d.length-1].timestamp});case 2:case"end":return I.stop()}},i)}));function v(){return o.apply(this,arguments)}return v}(),fetchEvents:function(){var o=X()(F.a.mark(function i(d,M){var I,H,l,f,m,y,$,O;return F.a.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(m=function(){return m=X()(F.a.mark(function _e(Y){var Ae;return F.a.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:return Ae=x(x(x(x({after:Y},u.fixedFilters||{}),{},{properties:l},H||{}),r.eventFilter?{event:r.eventFilter}:{}),{},{orderBy:[r.orderBy]}),ye.abrupt("return",V.b.get("api/projects/".concat(r.currentTeamId,"/events/?").concat(Object(S.zb)(Ae))));case 2:case"end":return ye.stop()}},_e)})),m.apply(this,arguments)},f=function(_e){return m.apply(this,arguments)},H=d.nextParams,clearTimeout(r.pollTimeout),!(r.events.length>0)){P.next=9;break}return P.next=7,M(300);case 7:P.next=11;break;case 9:return P.next=11,M(1);case 11:return l=[].concat(D()(r.properties),D()(((I=u.fixedFilters)===null||I===void 0?void 0:I.properties)||[])),y=null,$=!1,P.prev=14,P.next=17,f(ge(De));case 17:if(y=P.sent,y.results.length!==0){P.next=23;break}return P.next=21,f(ge(Pe));case 21:y=P.sent,$=!0;case 23:P.next=29;break;case 25:return P.prev=25,P.t0=P.catch(14),n.fetchOrPollFailure(P.t0),P.abrupt("return");case 29:M(),n.fetchEventsSuccess({events:y.results,hasNext:!!y.next||!$,isNext:!!H}),O=window.setTimeout(n.pollEvents,xe),n.setPollTimeout(O);case 33:case"end":return P.stop()}},i,null,[[14,25]])}));function v(i,d){return o.apply(this,arguments)}return v}(),pollEvents:function(){var o=X()(F.a.mark(function i(d,M){var I,H,l,f,m,y;return F.a.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(H=function(){var P=window.setTimeout(n.pollEvents,xe);n.setPollTimeout(P)},r.orderBy==="-timestamp"){O.next=3;break}return O.abrupt("return");case 3:if(u.sceneUrl===K.router.values.location.pathname){O.next=5;break}return O.abrupt("return");case 5:if(r.pollingIsActive){O.next=8;break}return H(),O.abrupt("return");case 8:return l=[].concat(D()(r.properties),D()(((I=u.fixedFilters)===null||I===void 0?void 0:I.properties)||[])),f=x(x(x({},u.fixedFilters||{}),{},{properties:l},r.eventFilter?{event:r.eventFilter}:{}),{},{orderBy:[r.orderBy],after:r.pollAfter}),m=Object(S.zb)(f),y=null,O.prev=12,O.next=15,V.b.get("api/projects/".concat(r.currentTeamId,"/events/?").concat(m));case 15:y=O.sent,O.next=21;break;case 18:return O.prev=18,O.t0=O.catch(12),O.abrupt("return");case 21:M(),r.automaticLoadEnabled?n.prependEvents(y.results):n.pollEventsSuccess(y.results),H();case 24:case"end":return O.stop()}},i,null,[[12,18]])}));function v(i,d){return o.apply(this,arguments)}return v}(),prependNewEvents:function(){r.newEvents.length&&n.prependEvents(r.newEvents)},fetchOrPollFailure:function(v){var i=v.error;ae.d.error("There was a problem fetching your events: ".concat(i.statusText))},toggleAutomaticLoad:function(v){var i=v.automaticLoadEnabled;i&&n.prependNewEvents()}}}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/events/EventsTable.scss":function(pe,B,e){var G=e("./node_modules/css-loader/dist/runtime/api.js");B=G(!1),B.push([pe.i,".events .events-table-button-clear{padding:0 4px;margin-left:4px}.events .events-table-button-clear.visible,.events .events-table-button-clear:focus,.events .events-table-button-clear:hover{border:1px solid var(--primary)}.events .event-row-new{height:2.5rem}.events .event-row-date-separator{background-color:var(--bg-mid);color:var(--text-muted);font-weight:600;font-size:.75rem;height:2rem;text-align:center}.events .event-row-is-exception{background-color:var(--depr-lighten-danger-40)}.events td{max-width:20rem}",""]),pe.exports=B}}]);
