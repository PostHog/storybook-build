(window.webpackJsonp=window.webpackJsonp||[]).push([[315],{"./frontend/src/scenes/performance/WebPerformance.tsx":function(B,c,n){"use strict";n.r(c),n.d(c,"webPerformancePropertyFilters",function(){return M}),n.d(c,"WebPerformance",function(){return E}),n.d(c,"scene",function(){return W});var I=n("./frontend/src/scenes/performance/WebPerformance.scss"),b=n("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),g=n("./frontend/src/lib/components/PageHeader.tsx"),m=n("./frontend/src/types.ts"),a=n("./frontend/src/scenes/performance/webPerformanceLogic.tsx"),u=n("./frontend/src/scenes/urls.ts"),l=n("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),x=n("./frontend/src/scenes/performance/WebPerformanceWaterfallChart.tsx"),h=n("./frontend/src/lib/components/icons.tsx"),i=n("./frontend/@posthog/lemon-ui/src/index.ts"),p=n("./frontend/src/lib/logic/featureFlagLogic.ts"),D=n("./frontend/src/lib/constants.tsx"),L=n("./frontend/src/queries/Query/Query.tsx"),f=n("./frontend/src/queries/schema.ts"),O=n("./frontend/src/lib/utils.tsx"),v=n("./frontend/src/lib/components/TZLabel/index.tsx"),P=n("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),y=n.n(P),e=n("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js"),U=n.n(e);const M=[{key:"$performance_raw",value:"is_set",operator:m.P.IsSet,type:m.N.Event}];function j(r){return Object(e.jsx)("div",{children:Object(e.jsx)(i.LemonButton,{"data-attr":`view-waterfall-button-${r.record.pageview_id}`,icon:Object(e.jsx)(h.IconPlay,{}),type:"secondary",size:"small",to:u.a.webPerformanceWaterfall(r.record),children:"View waterfall chart"})})}const T=()=>{const{recentPageViews:r,recentPageViewsLoading:_}=Object(l.useValues)(a.b),{loadRecentPageViews:R}=Object(l.useActions)(a.b),{featureFlags:A}=Object(l.useValues)(p.a),d=A[D.i.DATA_EXPLORATION_LIVE_EVENTS];Object(P.useEffect)(()=>{!!r.length&&!d&&R()},[d]);const C=[{title:"Page",key:"page_url",width:"45%",render:function(o,t){return Object(e.jsx)("div",{className:"max-w-100 overflow-auto",children:t.page_url})}},{title:"Page load",key:"duration",render:function(o,t){return t.duration?Object(e.jsx)(e.Fragment,{children:Object(O.P)(t.duration/1e3)}):Object(e.jsx)(e.Fragment,{children:"-"})}},{title:"timestamp",key:"timestamp",render:function(o,t){return Object(e.jsx)(v.a,{time:t.timestamp})}},{title:"",render:function(o,t){return Object(e.jsx)(j,{record:t,onClick:()=>console.log(t)})}}];return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("div",{className:"pt-4 border-t"}),d?Object(e.jsx)(L.a,{query:{kind:f.a.DataTableNode,source:{kind:f.a.RecentPerformancePageViewNode},columns:["context.columns.page_url","context.columns.duration","timestamp","context.columns.waterfallButton"],showReload:!0,showColumnConfigurator:!1,showExport:!1,showEventFilter:!1,showPropertyFilter:!1,showActions:!1,expandable:!1},context:{columns:{page_url:{title:"Page",render:function(o){let{record:t}=o;return t.page_url?Object(e.jsx)("div",{className:"max-w-100 overflow-auto",children:t.page_url}):Object(e.jsx)(e.Fragment,{children:"-"})}},duration:{title:"Page load",render:function(o){let{record:t}=o;return t.duration?Object(e.jsx)(e.Fragment,{children:Object(O.P)(t.duration/1e3)}):Object(e.jsx)(e.Fragment,{children:"-"})}},waterfallButton:{title:"",render:function(o){let{record:t}=o;return Object(e.jsx)(j,{record:t,onClick:()=>console.log(t)})}}}}}):Object(e.jsx)(i.LemonTable,{"data-attr":"web-performance-table",dataSource:r,loading:_,columns:C,loadingSkeletonRows:20,emptyState:_?void 0:Object(e.jsx)(e.Fragment,{children:"need an empty state that makes sense"}),rowKey:s=>s.pageview_id})]})},E=()=>{const{currentPage:r}=Object(l.useValues)(a.b);return Object(e.jsxs)("div",{className:"web-performance",children:[Object(e.jsx)(g.a,{title:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:["Web Performance",Object(e.jsx)(b.a,{type:"warning",className:"uppercase",children:"Alpha"})]}),caption:r===a.a.TABLE?Object(e.jsxs)("div",{children:[Object(e.jsx)("p",{children:"Shows page view events where performance information has been captured. Not all events have all performance information."}),Object(e.jsxs)("p",{children:["To capture performance information you must be using posthog-js and set"," ",Object(e.jsx)("code",{children:"_capture_performance"})," to true. See the"," ",Object(e.jsx)(i.Link,{to:"https://posthog.com/docs/integrate/client/js#config",disableClientSideRouting:!0,children:"config instructions in our handbook"})]})]}):null}),Object(e.jsx)("div",{children:r===a.a.TABLE?Object(e.jsx)(T,{}):r===a.a.WATERFALL_CHART?Object(e.jsx)(x.b,{}):Object(e.jsx)(e.Fragment,{children:"404?"})})]})},W={component:E,logic:a.b,paramsToProps:()=>({sceneUrl:u.a.webPerformance()})}}}]);
