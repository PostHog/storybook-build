"use strict";(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[4603],{"./frontend/src/scenes/data-management/DataManagementPageTabs.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{H:function(){return DataManagementTab},q:function(){return DataManagementPageTabs}});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),scenes_urls__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./frontend/src/scenes/urls.ts"),lib_lemon_ui_Tooltip__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/lib/lemon-ui/Tooltip.tsx"),lib_lemon_ui_icons__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts"),lib_components_TitleWithIcon__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/lib/components/TitleWithIcon.tsx"),lib_constants__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./frontend/src/lib/constants.tsx"),lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./frontend/src/lib/logic/featureFlagLogic.ts"),lib_lemon_ui_LemonTag_LemonTag__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTag/LemonTag.tsx"),lib_lemon_ui_LemonTabs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTabs/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");let DataManagementTab=function(DataManagementTab){return DataManagementTab.Actions="actions",DataManagementTab.EventDefinitions="events",DataManagementTab.PropertyDefinitions="properties",DataManagementTab.History="history",DataManagementTab.IngestionWarnings="warnings",DataManagementTab.Database="database",DataManagementTab}({});const tabUrls={[DataManagementTab.PropertyDefinitions]:scenes_urls__WEBPACK_IMPORTED_MODULE_1__.j.propertyDefinitions(),[DataManagementTab.EventDefinitions]:scenes_urls__WEBPACK_IMPORTED_MODULE_1__.j.eventDefinitions(),[DataManagementTab.Actions]:scenes_urls__WEBPACK_IMPORTED_MODULE_1__.j.actions(),[DataManagementTab.History]:scenes_urls__WEBPACK_IMPORTED_MODULE_1__.j.dataManagementHistory(),[DataManagementTab.IngestionWarnings]:scenes_urls__WEBPACK_IMPORTED_MODULE_1__.j.ingestionWarnings(),[DataManagementTab.Database]:scenes_urls__WEBPACK_IMPORTED_MODULE_1__.j.database()},eventsTabsLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)({path:["scenes","events","eventsTabsLogic"],connect:{values:[lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_6__.h,["featureFlags"]]},actions:{setTab:tab=>({tab:tab})},reducers:{tab:[DataManagementTab.EventDefinitions,{setTab:(_,_ref)=>{let{tab:tab}=_ref;return tab}}]},selectors:{showWarningsTab:[s=>[s.featureFlags],featureFlags=>!!featureFlags[lib_constants__WEBPACK_IMPORTED_MODULE_5__.y8.INGESTION_WARNINGS_ENABLED]]},actionToUrl:()=>({setTab:_ref2=>{let{tab:tab}=_ref2;return tabUrls[tab]||scenes_urls__WEBPACK_IMPORTED_MODULE_1__.j.events()}}),urlToAction:_ref3=>{let{actions:actions,values:values}=_ref3;return Object.fromEntries(Object.entries(tabUrls).map((_ref4=>{let[key,url]=_ref4;return[url,()=>{values.tab!==key&&actions.setTab(key)}]})))}});function DataManagementPageTabs(_ref5){let{tab:tab}=_ref5;const{showWarningsTab:showWarningsTab}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(eventsTabsLogic),{setTab:setTab}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(eventsTabsLogic);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.Fragment,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(lib_lemon_ui_LemonTabs__WEBPACK_IMPORTED_MODULE_8__.T,{activeKey:tab,onChange:t=>setTab(t),tabs:[{key:DataManagementTab.EventDefinitions,label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("span",{"data-attr":"data-management-events-tab",children:"Events"})},{key:DataManagementTab.Actions,label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(lib_components_TitleWithIcon__WEBPACK_IMPORTED_MODULE_4__.H,{icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(lib_lemon_ui_Tooltip__WEBPACK_IMPORTED_MODULE_2__.u,{title:"Actions consist of one or more events that you have decided to put into a deliberately-labeled bucket. They're used in insights and dashboards.",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(lib_lemon_ui_icons__WEBPACK_IMPORTED_MODULE_3__.aUG,{})}),"data-attr":"data-management-actions-tab",children:"Actions"})},{key:DataManagementTab.PropertyDefinitions,label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(lib_components_TitleWithIcon__WEBPACK_IMPORTED_MODULE_4__.H,{icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(lib_lemon_ui_Tooltip__WEBPACK_IMPORTED_MODULE_2__.u,{title:"Properties are additional data sent along with an event capture. Use properties to understand additional information about events and the actors that generate them.",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(lib_lemon_ui_icons__WEBPACK_IMPORTED_MODULE_3__.aUG,{})}),"data-attr":"data-management-event-properties-tab",children:"Properties"})},{key:DataManagementTab.History,label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("span",{"data-attr":"data-management-history-tab",children:"History"})},showWarningsTab&&{key:DataManagementTab.IngestionWarnings,label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("span",{"data-attr":"data-management-warnings-tab",children:"Ingestion Warnings"})},{key:DataManagementTab.Database,label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("span",{"data-attr":"data-management-database-tab",children:["Database",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(lib_lemon_ui_LemonTag_LemonTag__WEBPACK_IMPORTED_MODULE_7__.o,{type:"warning",className:"uppercase ml-2",children:"Beta"})]})}]})})}try{DataManagementPageTabs.displayName="DataManagementPageTabs",DataManagementPageTabs.__docgenInfo={description:"",displayName:"DataManagementPageTabs",props:{tab:{defaultValue:null,description:"",name:"tab",required:!0,type:{name:"enum",value:[{value:'"actions"'},{value:'"events"'},{value:'"properties"'},{value:'"history"'},{value:'"warnings"'},{value:'"database"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/data-management/DataManagementPageTabs.tsx#DataManagementPageTabs"]={docgenInfo:DataManagementPageTabs.__docgenInfo,name:"DataManagementPageTabs",path:"frontend/src/scenes/data-management/DataManagementPageTabs.tsx#DataManagementPageTabs"})}catch(__react_docgen_typescript_loader_error){}},"./frontend/src/scenes/data-management/ingestion-warnings/IngestionWarningsView.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{IngestionWarningsView:function(){return IngestionWarningsView},scene:function(){return scene}});var index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),urls=__webpack_require__("./frontend/src/scenes/urls.ts"),PageHeader=__webpack_require__("./frontend/src/lib/components/PageHeader.tsx"),DataManagementPageTabs=__webpack_require__("./frontend/src/scenes/data-management/DataManagementPageTabs.tsx"),lib=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),api=__webpack_require__("./frontend/src/lib/api.ts"),teamLogic=__webpack_require__("./frontend/src/scenes/teamLogic.tsx"),utils=__webpack_require__("./frontend/src/lib/utils.tsx"),dayjs=__webpack_require__("./frontend/src/lib/dayjs.ts");const ingestionWarningsLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","data-management","ingestion-warnings","ingestionWarningsLogic"]),(0,index_esm.connect)({values:[teamLogic.teamLogic,["currentTeamId","timezone"]]}),(0,lib.loaders)((_ref=>{let{values:values}=_ref;return{data:[[],{loadData:async()=>{const{results:results}=await api.ZP.get(`api/projects/${values.currentTeamId}/ingestion_warnings`);return results}}]}})),(0,index_esm.selectors)({breadcrumbs:[()=>[],()=>[{name:"Data Management",path:urls.j.eventDefinitions()},{name:"Ingestion Warnings",path:urls.j.ingestionWarnings()}]],dates:[()=>[],()=>(0,utils.w6)(0,30).map((i=>(0,dayjs.Bv)().subtract(i,"days").format("D MMM YYYY"))).reverse()],summaryDatasets:[s=>[s.data,s.timezone],(data,timezone)=>{const summaryDatasets={};return data.forEach((summary=>{const result=new Array(30).fill(0);for(const warning of summary.warnings){const date=(0,dayjs.fp)(warning.timestamp,timezone);result[(0,dayjs.Bv)().diff(date,"days")]+=1}summaryDatasets[summary.type]=result.reverse()})),summaryDatasets}]}),(0,index_esm.events)((_ref2=>{let{actions:actions}=_ref2;return{afterMount:()=>{actions.loadData()}}}))]);var LemonTable=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTable/index.ts"),TZLabel=__webpack_require__("./frontend/src/lib/components/TZLabel/index.tsx"),Link=__webpack_require__("./frontend/src/lib/lemon-ui/Link/index.ts"),TableCellSparkline=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTable/TableCellSparkline.tsx"),ProductIntroduction=__webpack_require__("./frontend/src/lib/components/ProductIntroduction/ProductIntroduction.tsx"),types=__webpack_require__("./frontend/src/types.ts"),hedgehogs=__webpack_require__("./frontend/src/lib/components/hedgehogs.tsx"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");const scene={component:IngestionWarningsView,logic:ingestionWarningsLogic},WARNING_TYPE_TO_DESCRIPTION={cannot_merge_already_identified:"Refused to merge an already identified user",cannot_merge_with_illegal_distinct_id:"Refused to merge with an illegal distinct id",skipping_event_invalid_uuid:"Refused to process event with invalid uuid",ignored_invalid_timestamp:"Ignored an invalid timestamp, event was still ingested",event_timestamp_in_future:"An event was sent more than 23 hours in the future",ingestion_capacity_overflow:"Event ingestion has overflowed capacity"},WARNING_TYPE_RENDERER={cannot_merge_already_identified:function Render(warning){const details=warning.details;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Refused to merge already identified person"," ",(0,jsx_runtime.jsx)(Link.r,{to:urls.j.person(details.sourcePersonDistinctId),children:details.sourcePersonDistinctId})," into"," ",(0,jsx_runtime.jsx)(Link.r,{to:urls.j.person(details.targetPersonDistinctId),children:details.targetPersonDistinctId})," via an $identify or $create_alias call (event uuid: ",(0,jsx_runtime.jsx)("code",{children:details.eventUuid}),")."]})},cannot_merge_with_illegal_distinct_id:function Render(warning){const details=warning.details;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Refused to merge an illegal distinct_id"," ",(0,jsx_runtime.jsx)(Link.r,{to:urls.j.person(details.illegalDistinctId),children:details.illegalDistinctId})," with"," ",(0,jsx_runtime.jsx)(Link.r,{to:urls.j.person(details.otherDistinctId),children:details.otherDistinctId})," via an $identify or $create_alias call (event uuid: ",(0,jsx_runtime.jsx)("code",{children:details.eventUuid}),")."]})},skipping_event_invalid_uuid:function Render(warning){const details=warning.details;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Refused to process event with invalid uuid: ",(0,jsx_runtime.jsx)("code",{children:details.eventUuid}),"."]})},ignored_invalid_timestamp:function Render(warning){const details=warning.details;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Used server timestamp when ingesting event due to invalid input:",(0,jsx_runtime.jsxs)("ul",{children:[details.eventUuid?(0,jsx_runtime.jsxs)("li",{children:["Event UUID: ",details.eventUuid]}):"",details.field?(0,jsx_runtime.jsxs)("li",{children:["Invalid field: ",details.field]}):"",details.value?(0,jsx_runtime.jsxs)("li",{children:["Invalid value: ",details.value]}):"",details.reason?(0,jsx_runtime.jsxs)("li",{children:["Error: ",details.reason]}):""]})]})},event_timestamp_in_future:function Render(warning){const details=warning.details;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["The event timestamp computed too far in the future, so the capture time was used instead. Event values:",(0,jsx_runtime.jsxs)("ul",{children:[(0,jsx_runtime.jsxs)("li",{children:["Computed timestamp: ",details.result]}),details.eventUuid?(0,jsx_runtime.jsxs)("li",{children:["Event UUID: ",details.eventUuid]}):"",details.timestamp?(0,jsx_runtime.jsxs)("li",{children:["Client provided timestamp: ",details.timestamp]}):"",details.sentAt?(0,jsx_runtime.jsxs)("li",{children:["Client provided sent_at: ",details.sentAt]}):"",details.offset?(0,jsx_runtime.jsxs)("li",{children:["Client provided time offset: ",details.offset]}):"",(0,jsx_runtime.jsxs)("li",{children:["PostHog server capture time: ",details.now]})]})]})},ingestion_capacity_overflow:function Render(warning){const details=warning.details;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Event ingestion has overflowed capacity for distinct_id"," ",(0,jsx_runtime.jsx)(Link.r,{to:urls.j.person(details.overflowDistinctId),children:details.overflowDistinctId}),". Events will still be processed, but are likely to be delayed longer than usual."]})}};function IngestionWarningsView(){const{data:data,dataLoading:dataLoading,summaryDatasets:summaryDatasets,dates:dates}=(0,index_esm.useValues)(ingestionWarningsLogic);return(0,jsx_runtime.jsxs)("div",{"data-attr":"manage-events-table",children:[(0,jsx_runtime.jsx)(PageHeader.m,{title:"Data Management",caption:"Use data management to organize events that come into PostHog. Reduce noise, clarify usage, and help collaborators get the most value from your data.",tabbedPage:!0}),(0,jsx_runtime.jsx)(DataManagementPageTabs.q,{tab:DataManagementPageTabs.H.IngestionWarnings}),data.length>0||dataLoading?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"mb-4",children:"Data ingestion related warnings from past 30 days."}),(0,jsx_runtime.jsx)(LemonTable.g,{dataSource:data,loading:dataLoading,columns:[{title:"Warning",dataIndex:"type",render:function Render(_,summary){const type=WARNING_TYPE_TO_DESCRIPTION[summary.type]||summary.type;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[type," (",(0,jsx_runtime.jsxs)(Link.r,{to:`https://posthog.com/manual/data-management#${type.toLowerCase().replace(",","").split(" ").join("-")}`,children:["docs",")"]})]})}},{title:"Graph",render:function Render(_,summary){return(0,jsx_runtime.jsx)(TableCellSparkline.F,{labels:dates,data:summaryDatasets[summary.type]})}},{title:"Events",dataIndex:"count",align:"right",sorter:(a,b)=>a.count-b.count},{title:"Last Seen",dataIndex:"lastSeen",render:function Render(_,summary){return(0,jsx_runtime.jsx)(TZLabel.w,{time:summary.lastSeen,showSeconds:!0})},align:"right",sorter:(a,b)=>new Date(a.lastSeen)>new Date(b.lastSeen)?1:-1}],expandable:{expandedRowRender:RenderNestedWarnings},defaultSorting:{columnKey:"lastSeen",order:-1},noSortingCancellation:!0})]}):(0,jsx_runtime.jsx)(ProductIntroduction.C,{productName:"Ingestion warnings",thingName:"ingestion warning",productKey:types.Md.INGESTION_WARNINGS,isEmpty:!0,description:"Nice! You've had no ingestion warnings in the past 30 days. If we detect any issues with your data, we'll show them here.",docsURL:"https://posthog.com/docs/data/data-management#ingestion-warnings",customHog:hedgehogs.ReadingHog})]})}function RenderNestedWarnings(warningSummary){return(0,jsx_runtime.jsx)(LemonTable.g,{dataSource:warningSummary.warnings,columns:[{title:"Description",key:"description",render:function Render(_,warning){const renderer=WARNING_TYPE_RENDERER[warning.type];return renderer?renderer(warning):(0,jsx_runtime.jsx)("pre",{children:JSON.stringify(warning.details,null,2)})}},{title:"Time",dataIndex:"timestamp",render:function Render(_,warning){return(0,jsx_runtime.jsx)(TZLabel.w,{time:warning.timestamp,showSeconds:!0})},align:"right"}],embedded:!0,size:"small",showHeader:!1})}}}]);