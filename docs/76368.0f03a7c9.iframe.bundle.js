"use strict";(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[76368],{"./frontend/src/scenes/error-tracking/ErrorTrackingConfigurationScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ErrorTrackingConfigurationScene:()=>ErrorTrackingConfigurationScene,scene:()=>scene});var _posthog_icons__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@posthog+icons@0.9.2_react-dom@18.2.0_react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),kea__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib_components_Errors_stackFrameLogic__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/lib/components/Errors/stackFrameLogic.ts"),lib_components_JSONViewer__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/lib/components/JSONViewer.tsx"),react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),_errorTrackingSymbolSetLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./frontend/src/scenes/error-tracking/errorTrackingSymbolSetLogic.tsx"),_SymbolSetUploadModal__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./frontend/src/scenes/error-tracking/SymbolSetUploadModal.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let scene={component:ErrorTrackingConfigurationScene,logic:_errorTrackingSymbolSetLogic__WEBPACK_IMPORTED_MODULE_6__._};function ErrorTrackingConfigurationScene(){let{missingSymbolSets,validSymbolSets}=(0,kea__WEBPACK_IMPORTED_MODULE_2__.useValues)(_errorTrackingSymbolSetLogic__WEBPACK_IMPORTED_MODULE_6__._);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("div",{className:"space-y-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("h2",{children:"Symbol sets"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("p",{children:"Source maps are required to demangle any minified code in your exception stack traces. PostHog automatically retrieves source maps where possible. Cases where it was not possible are listed below. Source maps can be uploaded retroactively but changes will only apply to all future exceptions ingested."}),missingSymbolSets.length>0&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(SymbolSetTable,{dataSource:missingSymbolSets,pageSize:5,missing:!0}),validSymbolSets.length>0&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(SymbolSetTable,{dataSource:validSymbolSets,pageSize:10}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_SymbolSetUploadModal__WEBPACK_IMPORTED_MODULE_7__.M,{})]})}let SymbolSetTable=_ref=>{let{dataSource,pageSize,missing}=_ref,{symbolSetsLoading}=(0,kea__WEBPACK_IMPORTED_MODULE_2__.useValues)(_errorTrackingSymbolSetLogic__WEBPACK_IMPORTED_MODULE_6__._),{deleteSymbolSet}=(0,kea__WEBPACK_IMPORTED_MODULE_2__.useActions)(_errorTrackingSymbolSetLogic__WEBPACK_IMPORTED_MODULE_6__._),columns=[{title:missing&&"Missing symbol sets",dataIndex:"ref"},{dataIndex:"id",render:(_,_ref2)=>{let{id}=_ref2;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{className:"flex justify-end",children:!missing&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{type:"secondary",size:"xsmall",tooltip:"Delete symbol set",icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_0__.IconTrash,{}),onClick:()=>deleteSymbolSet(id),className:"py-1"})})}}];return missing&&columns.splice(1,0,{title:"Failure reason",dataIndex:"failure_reason"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.g3,{showHeader:missing,pagination:{pageSize},columns:columns,loading:symbolSetsLoading,dataSource:dataSource,expandable:{noIndent:!0,expandedRowRender:function RenderPropertiesTable(symbolSet){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(SymbolSetStackFrames,{symbolSet:symbolSet})}}})},SymbolSetStackFrames=_ref3=>{let{symbolSet}=_ref3,{stackFrameRecords}=(0,kea__WEBPACK_IMPORTED_MODULE_2__.useValues)(lib_components_Errors_stackFrameLogic__WEBPACK_IMPORTED_MODULE_3__.e),{loadForSymbolSet}=(0,kea__WEBPACK_IMPORTED_MODULE_2__.useActions)(lib_components_Errors_stackFrameLogic__WEBPACK_IMPORTED_MODULE_3__.e),[activeTab,setActiveTab]=(0,react__WEBPACK_IMPORTED_MODULE_5__.useState)("contents");(0,react__WEBPACK_IMPORTED_MODULE_5__.useEffect)(()=>{loadForSymbolSet(symbolSet.id)},[loadForSymbolSet,symbolSet]);let frames=Object.values(stackFrameRecords).filter(r=>r.symbol_set_ref==symbolSet.ref);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.JL,{size:"small",panels:frames.map(_ref4=>{let{id,raw_id,contents,context}=_ref4;return{key:id,header:raw_id,className:"py-0",content:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.TP,{activeKey:activeTab,onChange:setActiveTab,tabs:[{key:"contents",label:"Contents",content:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(lib_components_JSONViewer__WEBPACK_IMPORTED_MODULE_4__.C,{src:contents,name:null})},context&&{key:"context",label:"Context",content:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(lib_components_JSONViewer__WEBPACK_IMPORTED_MODULE_4__.C,{src:context,name:null})}]})}}),embedded:!0})}},"./frontend/src/scenes/error-tracking/SymbolSetUploadModal.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{M:()=>SymbolSetUploadModal});var _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),kea__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_forms__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/kea-forms@3.2.0_kea@3.1.5/node_modules/kea-forms/lib/index.js"),lib_lemon_ui_icons__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts"),lib_lemon_ui_LemonField__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/lib/lemon-ui/LemonField/index.ts"),_errorTrackingSymbolSetLogic__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./frontend/src/scenes/error-tracking/errorTrackingSymbolSetLogic.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let SymbolSetUploadModal=()=>{let{setUploadSymbolSetReference}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useActions)(_errorTrackingSymbolSetLogic__WEBPACK_IMPORTED_MODULE_5__._),{uploadSymbolSetReference,isUploadSymbolSetSubmitting,uploadSymbolSet}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useValues)(_errorTrackingSymbolSetLogic__WEBPACK_IMPORTED_MODULE_5__._),onClose=()=>setUploadSymbolSetReference(null);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.fQ,{title:"",onClose:onClose,isOpen:!!uploadSymbolSetReference,simple:!0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(kea_forms__WEBPACK_IMPORTED_MODULE_2__.Form,{logic:_errorTrackingSymbolSetLogic__WEBPACK_IMPORTED_MODULE_5__._,formKey:"uploadSymbolSet",className:"gap-1",enableFormOnSubmit:!0,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.fQ.Header,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("h3",{children:"Upload source map"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.fQ.Content,{className:"space-y-2",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(lib_lemon_ui_LemonField__WEBPACK_IMPORTED_MODULE_4__.D,{name:"files",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.mH,{accept:"text/plain",multiple:!1,callToAction:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-2 border border-dashed rounded p-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("span",{className:"flex items-center gap-2 font-semibold",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(lib_lemon_ui_icons__WEBPACK_IMPORTED_MODULE_3__.bn,{className:"text-2xl"})," Add source map"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{children:"Drag and drop your local source map here or click to open the file browser."})]})})})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.fQ.Footer,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.Jp,{type:"secondary",onClick:onClose,children:"Cancel"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.Jp,{disabledReason:uploadSymbolSet.files.length<1?"Upload a source map":void 0,type:"primary",status:"alt",htmlType:"submit",loading:isUploadSymbolSetSubmitting,children:"Upload"})]})]})})}},"./frontend/src/scenes/error-tracking/errorTrackingSymbolSetLogic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_:()=>errorTrackingSymbolSetLogic});var _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),kea__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_forms__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/kea-forms@3.2.0_kea@3.1.5/node_modules/kea-forms/lib/index.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/lib/api.ts"),scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./frontend/src/scenes/sceneTypes.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./frontend/src/scenes/urls.ts");let errorTrackingSymbolSetLogic=(0,kea__WEBPACK_IMPORTED_MODULE_1__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_1__.path)(["scenes","error-tracking","errorTrackingSymbolSetLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_1__.actions)({setUploadSymbolSetReference:ref=>({ref})}),(0,kea__WEBPACK_IMPORTED_MODULE_1__.reducers)({uploadSymbolSetReference:[null,{setUploadSymbolSetReference:(_,_ref)=>{let{ref}=_ref;return ref}}]}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_3__.loaders)(_ref2=>{let{values}=_ref2;return{symbolSets:[[],{loadSymbolSets:async()=>{let response=await lib_api__WEBPACK_IMPORTED_MODULE_4__.ZP.errorTracking.symbolSets();return response.results},deleteSymbolSet:async ref=>{await lib_api__WEBPACK_IMPORTED_MODULE_4__.ZP.errorTracking.deleteSymbolSet(ref);let newValues=[...values.symbolSets];return newValues.filter(v=>v.ref!==ref)}}]}}),(0,kea__WEBPACK_IMPORTED_MODULE_1__.selectors)({breadcrumbs:[()=>[],()=>[{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_5__.x.ErrorTracking,name:"Error tracking",path:scenes_urls__WEBPACK_IMPORTED_MODULE_6__.j.errorTracking()},{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_5__.x.ErrorTrackingConfiguration,name:"Configuration"}]],validSymbolSets:[s=>[s.symbolSets],symbolSets=>symbolSets.filter(s=>!!s.storage_ptr)],missingSymbolSets:[s=>[s.symbolSets],symbolSets=>symbolSets.filter(s=>!s.storage_ptr)]}),(0,kea_forms__WEBPACK_IMPORTED_MODULE_2__.forms)(_ref3=>{let{values,actions}=_ref3;return{uploadSymbolSet:{defaults:{files:[]},submit:async _ref4=>{let{files}=_ref4;if(files.length>0&&values.uploadSymbolSetReference){let formData=new FormData,file=files[0];formData.append("source_map",file),await lib_api__WEBPACK_IMPORTED_MODULE_4__.ZP.errorTracking.updateSymbolSet(values.uploadSymbolSetReference,formData),actions.setUploadSymbolSetReference(null),actions.loadSymbolSets(),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.UJ.success("Source map uploaded")}}}}}),(0,kea__WEBPACK_IMPORTED_MODULE_1__.afterMount)(_ref5=>{let{actions}=_ref5;actions.loadSymbolSets()})])}}]);