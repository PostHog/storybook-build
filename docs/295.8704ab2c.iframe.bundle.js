var On=Object.defineProperty,Sn=Object.defineProperties;var En=Object.getOwnPropertyDescriptors;var Dt=Object.getOwnPropertySymbols;var Nn=Object.prototype.hasOwnProperty,wn=Object.prototype.propertyIsEnumerable;var Vt=(P,F,d)=>F in P?On(P,F,{enumerable:!0,configurable:!0,writable:!0,value:d}):P[F]=d,f=(P,F)=>{for(var d in F||(F={}))Nn.call(F,d)&&Vt(P,d,F[d]);if(Dt)for(var d of Dt(F))wn.call(F,d)&&Vt(P,d,F[d]);return P},M=(P,F)=>Sn(P,En(F));var w=(P,F,d)=>new Promise((J,m)=>{var b=G=>{try{ee(d.next(G))}catch(je){m(je)}},xe=G=>{try{ee(d.throw(G))}catch(je){m(je)}},ee=G=>G.done?J(G.value):Promise.resolve(G.value).then(b,xe);ee((d=d.apply(P,F)).next())});(window.webpackJsonp=window.webpackJsonp||[]).push([[295],{"./frontend/src/scenes/experiments/Experiment.tsx":function(P,F,d){"use strict";d.r(F),d.d(F,"scene",function(){return tn}),d.d(F,"Experiment",function(){return Tt});var J=d("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/skeleton/index.js"),m=d("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/col/index.js"),b=d("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/row/index.js"),xe=d("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/tooltip/index.js"),ee=d("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/card/index.js"),G=d("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/tag/index.js"),je=d("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/popconfirm/index.js"),xt=d("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/collapse/index.js"),jt=d("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/progress/index.js"),h=d("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),ft=d("./frontend/src/lib/components/PageHeader.tsx"),Yt=d("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),gt=d("./frontend/src/lib/components/PropertyFilters/utils.ts"),v=d("./frontend/src/lib/components/TaxonomicFilter/types.ts"),ce=d("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),Ee=d("./frontend/src/scenes/funnels/funnelLogic.ts"),pe=d("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilter.tsx"),fe=d("./frontend/src/scenes/insights/insightLogic.ts"),x=d("./frontend/src/types.ts"),zt=d("./node_modules/.pnpm/style-loader@2.0.0_webpack@4.46.0/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),Bt=d.n(zt),Kt=d("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/experiments/Experiment.scss"),bt=d.n(Kt),We={};We.insert="head",We.singleton=!1;var In=Bt()(bt.a,We),Fn=bt.a.locals||{},W=d("./frontend/src/lib/api.ts"),N=d("./frontend/src/lib/dayjs.ts"),Ne=d("./frontend/src/scenes/insights/utils/cleanFilters.ts"),Ue=d("./frontend/src/scenes/teamLogic.tsx"),Q=d("./frontend/src/scenes/urls.ts"),me=d("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.0/node_modules/kea-router/lib/index.js"),ht=d("./frontend/src/scenes/experiments/experimentsLogic.ts"),we=d("./frontend/src/lib/constants.tsx"),Ie=d("./frontend/src/scenes/trends/trendsLogic.ts"),vt=d("./frontend/src/lib/utils/eventUsageLogic.ts"),Gt=d("./frontend/src/scenes/userLogic.ts"),yt=d("./frontend/src/lib/components/Tooltip.tsx"),Fe=d("./node_modules/.pnpm/@ant-design+icons@4.7.0_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),Wt=d("./frontend/src/models/groupsModel.ts"),He=d("./frontend/src/lib/components/lemonToast.tsx"),k=d("./frontend/src/lib/utils.tsx"),te=d("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.0/node_modules/kea-forms/lib/index.js"),Ot=d("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js"),e=d("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");const ge=14,Je={id:"new",name:"",feature_flag_key:"",filters:{},parameters:{feature_flag_variants:[{key:"control",rollout_percentage:50},{key:"test",rollout_percentage:50}]},secondary_metrics:[],created_at:"",created_by:null},ne=Object(h.kea)([Object(h.props)({}),Object(h.key)(t=>t.experimentId||"new"),Object(h.path)(t=>["scenes","experiment","experimentLogic",t]),Object(h.connect)({values:[Ue.a,["currentTeamId"],Gt.a,["hasAvailableFeature"],Wt.a,["groupTypes","groupsTaxonomicTypes","aggregationLabel"]],actions:[ht.a,["updateExperiments","addToExperiments"],vt.e,["reportExperimentCreated","reportExperimentViewed","reportExperimentLaunched","reportExperimentCompleted","reportExperimentArchived","reportExperimentReset"]]}),Object(h.actions)({setExperiment:t=>({experiment:t}),createExperiment:(t,r,n)=>({draft:t,runningTime:r,sampleSize:n}),setExperimentInsightId:t=>({shortId:t}),createNewExperimentInsight:t=>({filters:t}),setFilters:t=>({filters:t}),removeExperimentGroup:t=>({idx:t}),setEditExperiment:t=>({editing:t}),setSecondaryMetrics:t=>({secondaryMetrics:t}),setExperimentResultCalculationError:t=>({error:t}),setFlagImplementationWarning:t=>({warning:t}),setFlagAvailabilityWarning:t=>({warning:t}),setExposureAndSampleSize:(t,r)=>({exposure:t,sampleSize:r}),updateExperimentGoal:t=>({filters:t}),launchExperiment:!0,endExperiment:!0,addExperimentGroup:!0,archiveExperiment:!0,resetRunningExperiment:!0,checkFlagImplementationWarning:!0,checkFlagAvailabilityWarning:!0,openExperimentGoalModal:!0,closeExperimentGoalModal:!0}),Object(h.reducers)({experiment:[f({},Je),{setExperiment:(t,r)=>{let{experiment:n}=r;if(n.filters){const a=f(f({},t.filters),n.filters);return M(f(f({},t),n),{filters:a})}if(n.parameters){const a=f(f({},t==null?void 0:t.parameters),n.parameters);return M(f(f({},t),n),{parameters:a})}return f(f({},t),n)},addExperimentGroup:t=>{var r;if(t!=null&&(r=t.parameters)!==null&&r!==void 0&&r.feature_flag_variants){const n=St(t.parameters.feature_flag_variants.length+1),a=t.parameters.feature_flag_variants.map((s,o)=>M(f({},s),{rollout_percentage:n[o]}));return M(f({},t),{parameters:M(f({},t.parameters),{feature_flag_variants:[...a,{key:`test_group_${t.parameters.feature_flag_variants.length}`,rollout_percentage:n[n.length-1]}]})})}return t},removeExperimentGroup:(t,r)=>{var n,a;let{idx:s}=r;if(!t)return t;const o=[...((n=t.parameters)===null||n===void 0?void 0:n.feature_flag_variants)||[]];o.splice(s,1);const l=St(((t==null||(a=t.parameters)===null||a===void 0?void 0:a.feature_flag_variants)||[]).length-1),p=o.map((u,O)=>M(f({},u),{rollout_percentage:l[O]}));return M(f({},t),{parameters:M(f({},t.parameters),{feature_flag_variants:p})})}}],experimentInsightId:[null,{setExperimentInsightId:(t,r)=>{let{shortId:n}=r;return n}}],editingExistingExperiment:[!1,{setEditExperiment:(t,r)=>{let{editing:n}=r;return n}}],changingGoalMetric:[!1,{updateExperimentGoal:()=>!0,loadExperimentResults:()=>!1}],experimentResultCalculationError:[null,{setExperimentResultCalculationError:(t,r)=>{let{error:n}=r;return n}}],flagImplementationWarning:[!1,{setFlagImplementationWarning:(t,r)=>{let{warning:n}=r;return n}}],flagAvailabilityWarning:[!1,{setFlagAvailabilityWarning:(t,r)=>{let{warning:n}=r;return n}}],exposureAndSampleSize:[{exposure:0,sampleSize:0},{setExposureAndSampleSize:(t,r)=>{let{exposure:n,sampleSize:a}=r;return{exposure:n,sampleSize:a}}}],isExperimentGoalModalOpen:[!1,{openExperimentGoalModal:()=>!0,closeExperimentGoalModal:()=>!1}]}),Object(h.listeners)(t=>{let{values:r,actions:n}=t;return{createExperiment:a=>w(this,null,function*(){var s;let{draft:o,runningTime:l,sampleSize:p}=a,u=null;const O=!!r.experimentId&&r.experimentId!=="new";try{if(O){var y,E;if(u=yield W.b.update(`api/projects/${r.currentTeamId}/experiments/${r.experimentId}`,f(M(f({},r.experiment),{parameters:M(f({},(y=r.experiment)===null||y===void 0?void 0:y.parameters),{recommended_running_time:l,recommended_sample_size:p})}),!o&&{start_date:Object(N.a)()})),(E=u)!==null&&E!==void 0&&E.id){n.updateExperiments(u),n.setEditExperiment(!1),n.setExperiment(u);return}}else{var D;u=yield W.b.create(`api/projects/${r.currentTeamId}/experiments`,f(M(f({},r.experiment),{parameters:M(f({},(D=r.experiment)===null||D===void 0?void 0:D.parameters),{recommended_running_time:l,recommended_sample_size:p})}),!o&&{start_date:Object(N.a)()})),u&&n.reportExperimentCreated(u)}}catch(_){He.d.error(_.detail||"Failed to create experiment");return}if((s=u)!==null&&s!==void 0&&s.id){const _=u.id;me.router.actions.push(Q.a.experiment(_)),n.addToExperiments(u),He.d.success(`Experiment ${O?"updated":"created"}`,{button:{label:"View it",action:()=>{me.router.actions.push(Q.a.experiment(_))}}})}}),createNewExperimentInsight:a=>w(this,null,function*(){let{filters:s}=a,o;(s==null?void 0:s.insight)===x.F.FUNNELS?o=Object(Ne.a)(f({insight:x.F.FUNNELS,funnel_viz_type:x.B.Steps,date_from:Object(N.a)().subtract(ge,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(N.a)().endOf("d").format("YYYY-MM-DDTHH:mm"),layout:we.k.horizontal},s)):o=Object(Ne.a)(f({insight:x.F.TRENDS,date_from:Object(N.a)().subtract(ge,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(N.a)().endOf("d").format("YYYY-MM-DDTHH:mm")},s));const l={name:"",description:"",tags:[],filters:o,result:null},p=yield W.b.create(`api/projects/${r.currentTeamId}/insights`,l);n.setExperimentInsightId(p.short_id),n.setExperiment({filters:f({},l.filters)})}),setFilters:a=>{let{filters:s}=a;if(r.experimentInsightType===x.F.FUNNELS){var o;(o=Ee.a.findMounted({dashboardItemId:r.experimentInsightId}))===null||o===void 0||o.actions.setFilters(s)}else{var l;(l=Ie.a.findMounted({dashboardItemId:r.experimentInsightId}))===null||l===void 0||l.actions.setFilters(s)}},loadExperimentSuccess:a=>w(this,null,function*(){let{experiment:s}=a;s&&n.reportExperimentViewed(s),s!=null&&s.start_date?(n.loadExperimentResults(),n.loadSecondaryMetricResults()):n.createNewExperimentInsight(s==null?void 0:s.filters)}),launchExperiment:()=>w(this,null,function*(){const a=Object(N.a)();n.updateExperiment({start_date:a.toISOString()}),r.experiment&&vt.e.actions.reportExperimentLaunched(r.experiment,a)}),endExperiment:()=>w(this,null,function*(){var a;const s=Object(N.a)();n.updateExperiment({end_date:s.toISOString()});const o=s.diff((a=r.experiment)===null||a===void 0?void 0:a.start_date,"second");r.experiment&&n.reportExperimentCompleted(r.experiment,s,o,r.areResultsSignificant)}),archiveExperiment:()=>w(this,null,function*(){n.updateExperiment({archived:!0}),r.experiment&&n.reportExperimentArchived(r.experiment)}),updateExperimentGoal:a=>w(this,null,function*(){let{filters:s}=a;n.updateExperiment({filters:s}),n.closeExperimentGoalModal()}),closeExperimentGoalModal:()=>{r.experimentChanged&&n.loadExperiment()},resetRunningExperiment:()=>w(this,null,function*(){n.updateExperiment({start_date:null,end_date:null}),r.experiment&&n.reportExperimentReset(r.experiment)}),updateExperimentSuccess:a=>w(this,null,function*(){let{experiment:s}=a;n.updateExperiments(s),r.changingGoalMetric&&n.loadExperimentResults()}),setExperiment:a=>w(this,null,function*(){var s,o;let{experiment:l}=a;const p=((s=l.filters)===null||s===void 0?void 0:s.events)&&l.filters.events.length>0||((o=l.filters)===null||o===void 0?void 0:o.actions)&&l.filters.actions.length>0;!l.filters||Object.keys(l.filters).length===0||(p&&n.checkFlagImplementationWarning(),n.checkFlagAvailabilityWarning())}),setExperimentValue:(a,s)=>w(this,null,function*(){let{name:o,value:l}=a;if(yield s(100),o==="filters"){const p=(l==null?void 0:l.events)&&l.events.length>0||(l==null?void 0:l.actions)&&l.actions.length>0;if(!l||Object.keys(l).length===0)return;p&&n.checkFlagImplementationWarning(),n.checkFlagAvailabilityWarning()}}),setExperimentValues:(a,s)=>w(this,null,function*(){var o,l;let{values:p}=a;yield s(100);const u=p,O=((o=u.filters)===null||o===void 0?void 0:o.events)&&u.filters.events.length>0||((l=u.filters)===null||l===void 0?void 0:l.actions)&&u.filters.actions.length>0;!u.filters||Object.keys(u.filters).length===0||(O&&n.checkFlagImplementationWarning(),n.checkFlagAvailabilityWarning())}),checkFlagImplementationWarning:(a,s)=>w(this,null,function*(){var o,l;const p=r.experiment,u=((o=p.filters)===null||o===void 0?void 0:o.events)&&p.filters.events.length>0||((l=p.filters)===null||l===void 0?void 0:l.actions)&&p.filters.actions.length>0;if(!(!p.filters||Object.keys(p.filters).length===0)&&u){const O=`/api/projects/${r.currentTeamId}/experiments/requires_flag_implementation?${Object(k.Gb)(p.filters||{})}`;yield s(100);try{const y=yield W.b.get(O);n.setFlagImplementationWarning(y.result)}catch(y){n.setFlagImplementationWarning(!1)}}}),checkFlagAvailabilityWarning:()=>w(this,null,function*(){var a;if((a=r.experiment.filters)!==null&&a!==void 0&&a.properties){const s=Object(k.r)(r.experiment.filters.properties)||[];if(s.length>0){const o=!!s.find(l=>l.type==="cohort"||!we.l.includes(l.key||""));n.setFlagAvailabilityWarning(o)}else n.setFlagAvailabilityWarning(!1)}}),openExperimentGoalModal:()=>w(this,null,function*(){var a;n.createNewExperimentInsight((a=r.experiment)===null||a===void 0?void 0:a.filters)})}}),Object(Ot.loaders)(t=>{let{actions:r,props:n,values:a}=t;return{experiment:{loadExperiment:()=>w(this,null,function*(){if(n.experimentId&&n.experimentId!=="new")try{return yield W.b.get(`api/projects/${a.currentTeamId}/experiments/${n.experimentId}`)}catch(s){throw s.status===404?s:(He.d.error(`Failed to load experiment ${n.experimentId}`),new Error(`Failed to load experiment ${n.experimentId}`))}return Je}),updateExperiment:s=>w(this,null,function*(){return yield W.b.update(`api/projects/${a.currentTeamId}/experiments/${a.experimentId}`,s)})},experimentResults:[null,{loadExperimentResults:()=>w(this,null,function*(){try{const s=yield W.b.get(`api/projects/${a.currentTeamId}/experiments/${a.experimentId}/results`);return M(f({},s),{itemID:Math.random().toString(36).substring(2,15)})}catch(s){return r.setExperimentResultCalculationError(s.detail),null}})}],secondaryMetricResults:[null,{loadSecondaryMetricResults:()=>w(this,null,function*(){var s;return yield Promise.all((((s=a.experiment)===null||s===void 0?void 0:s.secondary_metrics)||[]).map((o,l)=>w(this,null,function*(){try{return(yield W.b.get(`api/projects/${a.currentTeamId}/experiments/${a.experimentId}/secondary_results?id=${l}`)).result}catch(p){return{}}})))})}]}}),Object(h.selectors)({props:[()=>[(t,r)=>r],t=>t],experimentId:[()=>[(t,r)=>{var n;return(n=r.experimentId)!==null&&n!==void 0?n:"new"}],t=>t],experimentInsightType:[t=>[t.experiment],t=>{var r;return(t==null||(r=t.filters)===null||r===void 0?void 0:r.insight)||x.F.TRENDS}],breadcrumbs:[t=>[t.experiment,t.experimentId],(t,r)=>[{name:"Experiments",path:Q.a.experiments()},{name:(t==null?void 0:t.name)||"New",path:Q.a.experiment(r||"new")}]],variants:[t=>[t.experiment],t=>{var r;return(t==null||(r=t.parameters)===null||r===void 0?void 0:r.feature_flag_variants)||[]}],taxonomicGroupTypesForSelection:[t=>[t.experiment,t.groupsTaxonomicTypes],(t,r)=>{var n;return(t==null||(n=t.filters)===null||n===void 0?void 0:n.aggregation_group_type_index)!=null&&r.length>0?[r[t.filters.aggregation_group_type_index]]:[v.a.PersonProperties,v.a.Cohorts]}],minimumDetectableChange:[t=>[t.experiment],t=>{var r;return(t==null||(r=t.parameters)===null||r===void 0?void 0:r.minimum_detectable_effect)||5}],minimumSampleSizePerVariant:[t=>[t.minimumDetectableChange],t=>r=>Math.ceil(1600*r*(1-r/100)/(t*t))],areResultsSignificant:[t=>[t.experimentResults],t=>(t==null?void 0:t.significant)||!1],significanceBannerDetails:[t=>[t.experimentResults],t=>{if((t==null?void 0:t.significance_code)===x.bb.HighLoss){var r;return Object(e.jsxs)(e.Fragment,{children:["This is because the expected loss in conversion is greater than 1%",Object(e.jsx)(yt.a,{placement:"right",title:Object(e.jsxs)(e.Fragment,{children:["Current value is ",(r=((t==null?void 0:t.expected_loss)||0)*100)===null||r===void 0?void 0:r.toFixed(2),"%"]}),children:Object(e.jsx)(Fe.a,{style:{padding:"4px 2px"}})}),"."]})}if((t==null?void 0:t.significance_code)===x.bb.HighPValue){var n;return Object(e.jsxs)(e.Fragment,{children:["This is because the p value is greater than 0.05",Object(e.jsx)(yt.a,{placement:"right",title:Object(e.jsxs)(e.Fragment,{children:["Current value is ",(t==null||(n=t.p_value)===null||n===void 0?void 0:n.toFixed(3))||1,"."]}),children:Object(e.jsx)(Fe.a,{style:{padding:"4px 2px"}})}),"."]})}return(t==null?void 0:t.significance_code)===x.bb.LowWinProbability?"This is because the win probability of all test variants combined is less than 90%.":(t==null?void 0:t.significance_code)===x.bb.NotEnoughExposure?"This is because we need at least 100 people per variant to declare significance.":""}],recommendedExposureForCountData:[t=>[t.minimumDetectableChange],t=>r=>{const n=r*t/100,a=r,s=n+r;return parseFloat((4/Math.pow(Math.sqrt(a/ge)-Math.sqrt(s/ge),2)).toFixed(1))}],expectedRunningTime:[()=>[],()=>function(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ge;return parseFloat((r/(t/n)).toFixed(1))}],conversionRateForVariant:[t=>[t.experimentResults],t=>r=>{const n="--";if(!t)return n;const a=(t==null?void 0:t.insight).find(s=>{var o,l;return((o=s[0])===null||o===void 0||(l=o.breakdown_value)===null||l===void 0?void 0:l[0])===r});return a?(a[a.length-1].count/a[0].count*100).toFixed(1):n}],getIndexForVariant:[t=>[t.experimentResults],t=>(r,n)=>{let a;if(!t)a=0;else{let s=-1;n===x.F.FUNNELS?s=[...t==null?void 0:t.insight].sort((o,l)=>{var p,u;return((p=l[0])===null||p===void 0?void 0:p.count)-((u=o[0])===null||u===void 0?void 0:u.count)}).findIndex(o=>{var l,p;return((l=o[0])===null||l===void 0||(p=l.breakdown_value)===null||p===void 0?void 0:p[0])===r}):s=(t==null?void 0:t.insight).findIndex(o=>o.breakdown_value===r),a=s===-1?0:s}return n===x.F.FUNNELS&&a++,a}],countDataForVariant:[t=>[t.experimentResults],t=>r=>{const n="--";if(!t)return n;const a=(t==null?void 0:t.insight).find(s=>s.breakdown_value===r);return a?a.count.toString():n}],highestProbabilityVariant:[t=>[t.experimentResults],t=>{if(t){const r=Math.max(...Object.values(t.probability));return Object.keys(t.probability).find(n=>Math.abs(t.probability[n]-r)<Number.EPSILON)}}],areTrendResultsConfusing:[t=>[t.experimentResults,t.highestProbabilityVariant],(t,r)=>{if(!t)return!1;const n=(t==null?void 0:t.insight).reduce((a,s)=>s.count>a.count?s:a,{count:0,breakdown_value:""});return n.count?n.breakdown_value!==r:!1}],sortedExperimentResultVariants:[t=>[t.experimentResults,t.experiment],(t,r)=>{if(t){var n,a;const s=Object.keys(t.probability).sort((o,l)=>t.probability[l]-t.probability[o]);return r==null||(n=r.parameters)===null||n===void 0||(a=n.feature_flag_variants)===null||a===void 0||a.forEach(o=>{s.includes(o.key)||s.push(o.key)}),s}return[]}]}),Object(te.forms)(t=>{let{actions:r,values:n}=t;return{experiment:{defaults:f({},Je),errors:a=>{var s,o;let{name:l,feature_flag_key:p,parameters:u}=a;return{name:!l&&"You have to enter a name.",feature_flag_key:p?(s=p.match)!==null&&s!==void 0&&s.call(p,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You have to enter a feature flag key.",parameters:{feature_flag_variants:(o=u.feature_flag_variants)===null||o===void 0?void 0:o.map(O=>{var y;let{key:E}=O;return{key:(y=E.match)!==null&&y!==void 0&&y.call(E,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed."}})}}},submit:()=>{const{exposure:a,sampleSize:s}=n.exposureAndSampleSize;r.createExperiment(!0,a,s)}}}}),Object(me.urlToAction)(t=>{let{actions:r,values:n}=t;return{"/experiments/:id":(a,s,o,l,p)=>{let{id:u}=a;if(!n.hasAvailableFeature(x.e.EXPERIMENTATION)){me.router.actions.push("/experiments");return}const O=l.initial||l.pathname!==(p==null?void 0:p.pathname);if(r.setEditExperiment(!1),u&&O){const y=u==="new"?"new":parseInt(u);y==="new"&&(r.createNewExperimentInsight(),r.resetExperiment()),y!=="new"&&y===n.experimentId&&r.loadExperiment()}}}}),Object(h.afterMount)(t=>{var r;let{props:n,actions:a}=t;const s=(r=ht.a.findMounted())===null||r===void 0?void 0:r.values.experiments.find(o=>o.id===n.experimentId);s?a.setExperiment(s):n.experimentId!=="new"&&a.loadExperiment()})]);function St(t){const r=Math.round(100/t),a=r*t-100,s=new Array(t).fill(r);return s[t-1]=r-a,s}var Qe=d("./frontend/src/scenes/insights/InsightContainer.tsx"),R=d("./frontend/src/lib/components/icons.tsx"),Xe=d("./node_modules/.pnpm/@ant-design+icons@4.7.0_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),Ut=d("./frontend/src/lib/components/CopyToClipboard.tsx");const Et=14,Nt={name:"",filters:{insight:x.F.TRENDS,events:[{id:"$pageview",name:"$pageview",type:"events",order:0}]}},wt=Object(h.kea)([Object(h.props)({}),Object(h.path)(["scenes","experiment","secondaryMetricsLogic"]),Object(h.connect)({values:[Ue.a,["currentTeamId"]]}),Object(h.actions)({openModalToCreateSecondaryMetric:!0,openModalToEditSecondaryMetric:(t,r)=>({metric:t,metricId:r}),closeModal:!0,addNewMetric:t=>({metric:t}),setFilters:t=>({filters:t}),setPreviewInsightId:t=>({shortId:t}),createPreviewInsight:t=>({filters:t}),deleteMetric:t=>({metricId:t}),updateMetric:(t,r)=>({metric:t,metricId:r}),setMetricId:t=>({metricId:t}),saveSecondaryMetric:!0}),Object(Ot.loaders)(t=>{let{values:r}=t;return{experiments:[[],{loadExperiments:()=>w(this,null,function*(){return(yield W.b.get(`api/projects/${r.currentTeamId}/experiments`)).results})}]}}),Object(h.reducers)(t=>{let{props:r}=t;return{isModalOpen:[!1,{openModalToCreateSecondaryMetric:()=>!0,openModalToEditSecondaryMetric:()=>!0,closeModal:()=>!1}],existingModalSecondaryMetric:[null,{openModalToCreateSecondaryMetric:()=>null,openModalToEditSecondaryMetric:(n,a)=>{let{metric:s}=a;return s}}],previewInsightId:[null,{setPreviewInsightId:(n,a)=>{let{shortId:s}=a;return s}}],metrics:[r.initialMetrics,{addNewMetric:(n,a)=>{let{metric:s}=a;return[...n,f({},s)]},deleteMetric:(n,a)=>{let{metricId:s}=a;return n.filter((o,l)=>l!==s)},updateMetric:(n,a)=>{let{metric:s,metricId:o}=a;const l=[...n];return l[o]=s,l}}],metricId:[0,{setMetricId:(n,a)=>{let{metricId:s}=a;return s}}]}}),Object(te.forms)(()=>({secondaryMetricModal:{defaults:Nt,errors:()=>({}),submit:()=>w(this,null,function*(){})}})),Object(h.listeners)(t=>{let{props:r,actions:n,values:a}=t;return{openModalToEditSecondaryMetric:s=>{let{metric:{name:o,filters:l},metricId:p}=s;n.setSecondaryMetricModalValue("name",o),n.createPreviewInsight(l),n.setMetricId(p)},openModalToCreateSecondaryMetric:()=>{n.resetSecondaryMetricModal(),n.setFilters(Nt.filters)},createPreviewInsight:s=>w(this,null,function*(){let{filters:o}=s,l;(o==null?void 0:o.insight)===x.F.FUNNELS?l=Object(Ne.a)(f({insight:x.F.FUNNELS,funnel_viz_type:x.B.Steps,date_from:Object(N.a)().subtract(Et,"day").format("YYYY-MM-DD"),date_to:Object(N.a)().endOf("d").format("YYYY-MM-DDTHH:mm"),layout:we.k.horizontal},o)):l=Object(Ne.a)(f({insight:x.F.TRENDS,date_from:Object(N.a)().subtract(Et,"day").format("YYYY-MM-DD"),date_to:Object(N.a)().endOf("d").format("YYYY-MM-DDTHH:mm")},o));const p={description:"",tags:[],filters:l,result:null},u=yield W.b.create(`api/projects/${Ue.a.values.currentTeamId}/insights`,p);n.setPreviewInsightId(u.short_id),n.setSecondaryMetricModalValue("filters",p.filters)}),setFilters:s=>{let{filters:o}=s;if(o.insight===x.F.FUNNELS){var l;(l=Ee.a.findMounted({dashboardItemId:a.previewInsightId}))===null||l===void 0||l.actions.setFilters(o)}else{var p;(p=Ie.a.findMounted({dashboardItemId:a.previewInsightId}))===null||p===void 0||p.actions.setFilters(o)}},saveSecondaryMetric:()=>{a.existingModalSecondaryMetric?n.updateMetric(a.secondaryMetricModal,a.metricId):n.addNewMetric(a.secondaryMetricModal),r.onMetricsChange(a.metrics),n.closeModal()}}}),Object(h.events)(t=>{let{actions:r}=t;return{afterMount:()=>{r.createPreviewInsight()}}})]);var $=d("./frontend/src/lib/components/LemonButton/index.ts"),Ze=d("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilterRow/ActionFilterRow.tsx"),L=d("./frontend/@posthog/lemon-ui/src/index.ts"),re=d("./frontend/src/lib/forms/Field.tsx");function be(t){let{createPreviewInsight:r,previewInsightId:n,filters:a,setFilters:s}=t;const{insightProps:o}=Object(h.useValues)(Object(fe.c)({dashboardItemId:n,syncWithUrl:!1})),{isStepsEmpty:l,filterSteps:p,filters:u}=Object(h.useValues)(Object(Ee.a)(o)),{filters:O}=Object(h.useValues)(Object(Ie.a)(o)),y=a.insight;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"flex items-center w-full gap-2 mb-4",children:[Object(e.jsx)("span",{children:"Insight Type"}),Object(e.jsx)(L.LemonSelect,{value:y,onChange:E=>{E&&r({insight:E})},options:[{value:x.F.TRENDS,label:Object(e.jsx)("b",{children:"Trends"})},{value:x.F.FUNNELS,label:Object(e.jsx)("b",{children:"Funnels"})}]})]}),y===x.F.FUNNELS&&Object(e.jsx)(pe.a,{bordered:!0,filters:u,setFilters:E=>{s(f(M(f({},a),{insight:x.F.FUNNELS}),E))},typeKey:`experiment-funnel-goal-${JSON.stringify(a)}`,mathAvailability:Ze.b.None,hideDeleteBtn:p.length===1,buttonCopy:"Add funnel step",showSeriesIndicator:!l,seriesIndicatorType:"numeric",sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[v.a.EventProperties,v.a.PersonProperties,v.a.EventFeatureFlags,v.a.Cohorts,v.a.Elements]}),y===x.F.TRENDS&&Object(e.jsx)(pe.a,{bordered:!0,filters:O,setFilters:E=>{s(f(M(f({},a),{insight:x.F.TRENDS}),E))},typeKey:`experiment-trends-goal-${JSON.stringify(a)}`,buttonCopy:"Add graph series",showSeriesIndicator:!0,entitiesLimit:1,hideDeleteBtn:!0,propertiesTaxonomicGroupTypes:[v.a.EventProperties,v.a.PersonProperties,v.a.EventFeatureFlags,v.a.Cohorts,v.a.Elements]}),Object(e.jsx)("div",{className:"mt-4",children:Object(e.jsx)(h.BindLogic,{logic:fe.c,props:o,children:Object(e.jsx)(Qe.a,{disableHeader:!0,disableTable:!0,disableCorrelationTable:!0})})})]})}try{be.displayName="MetricSelector",be.__docgenInfo={description:"",displayName:"MetricSelector",props:{createPreviewInsight:{defaultValue:null,description:"",name:"createPreviewInsight",required:!0,type:{name:"(filters?: Partial<FilterType> | undefined) => void"}},setFilters:{defaultValue:null,description:"",name:"setFilters",required:!0,type:{name:"(filters: Partial<FilterType>) => void"}},previewInsightId:{defaultValue:null,description:"",name:"previewInsightId",required:!0,type:{name:"InsightShortId | null"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"Partial<FilterType>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/MetricSelector.tsx#MetricSelector"]={docgenInfo:be.__docgenInfo,name:"MetricSelector",path:"frontend/src/scenes/experiments/MetricSelector.tsx#MetricSelector"})}catch(t){}function _e(t){let{onMetricsChange:r,initialMetrics:n}=t;const a=wt({onMetricsChange:r,initialMetrics:n}),{previewInsightId:s,metrics:o,isModalOpen:l,isSecondaryMetricModalSubmitting:p,existingModalSecondaryMetric:u}=Object(h.useValues)(a),{setFilters:O,deleteMetric:y,openModalToCreateSecondaryMetric:E,openModalToEditSecondaryMetric:D,closeModal:_,saveSecondaryMetric:Y,createPreviewInsight:B}=Object(h.useActions)(a);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(L.LemonModal,{isOpen:l,onClose:_,width:650,title:u?"Edit secondary metric":"New secondary metric",footer:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)($.a,{form:"secondary-metric-modal-form",type:"secondary",onClick:_,children:"Cancel"}),Object(e.jsx)($.a,{form:"secondary-metric-modal-form",onClick:Y,type:"primary",loading:p,"data-attr":"create-annotation-submit",children:u?"Save":"Create"})]}),children:Object(e.jsxs)(te.Form,{logic:wt,formKey:"secondaryMetricModal",id:"secondary-metric-modal-form",className:"space-y-4",children:[Object(e.jsx)(re.a,{name:"name",label:"Name",children:Object(e.jsx)(L.LemonInput,{})}),Object(e.jsx)(re.a,{name:"filters",label:"Query",children:I=>{let{value:i,onChange:c}=I;return Object(e.jsx)(be,{createPreviewInsight:B,setFilters:ue=>{O(ue),c(ue)},previewInsightId:s,filters:i})}})]})}),Object(e.jsx)(b.a,{children:Object(e.jsxs)(m.a,{children:[o.map((I,i)=>Object(e.jsxs)(b.a,{className:"mt-4 border rounded p-4",children:[Object(e.jsxs)(b.a,{align:"middle",justify:"space-between",className:"w-full mb-3 pb-2 border-b",children:[Object(e.jsx)("div",{children:Object(e.jsx)("b",{children:I.name})}),Object(e.jsxs)("div",{className:"flex",children:[Object(e.jsx)($.a,{icon:Object(e.jsx)(R.IconEdit,{}),size:"small",status:"muted",onClick:()=>D(I,i)}),Object(e.jsx)($.a,{icon:Object(e.jsx)(R.IconDelete,{}),size:"small",status:"muted",onClick:()=>y(i)})]})]}),I.filters.insight===x.F.FUNNELS&&Object(e.jsx)(pe.a,{bordered:!0,filters:I.filters,setFilters:()=>{},typeKey:`funnel-preview-${i}`,mathAvailability:Ze.b.None,buttonCopy:"Add funnel step",seriesIndicatorType:"numeric",sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[v.a.EventProperties,v.a.PersonProperties,v.a.EventFeatureFlags,v.a.Cohorts,v.a.Elements],readOnly:!0}),I.filters.insight===x.F.TRENDS&&Object(e.jsx)(pe.a,{bordered:!0,filters:I.filters,setFilters:()=>{},typeKey:`trend-preview-${i}`,buttonCopy:"Add graph series",showSeriesIndicator:!0,entitiesLimit:1,propertiesTaxonomicGroupTypes:[v.a.EventProperties,v.a.PersonProperties,v.a.EventFeatureFlags,v.a.Cohorts,v.a.Elements],readOnly:!0})]},i)),o&&!(o.length>2)&&Object(e.jsx)(m.a,{children:Object(e.jsx)("div",{className:"mb-2 mt-4",children:Object(e.jsx)($.a,{type:"secondary",onClick:E,children:"Add metric"})})})]})})]})}try{_e.displayName="SecondaryMetrics",_e.__docgenInfo={description:"",displayName:"SecondaryMetrics",props:{onMetricsChange:{defaultValue:null,description:"",name:"onMetricsChange",required:!0,type:{name:"(metrics: SecondaryExperimentMetric[]) => void"}},initialMetrics:{defaultValue:null,description:"",name:"initialMetrics",required:!0,type:{name:"SecondaryExperimentMetric[]"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/SecondaryMetrics.tsx#SecondaryMetrics"]={docgenInfo:_e.__docgenInfo,name:"SecondaryMetrics",path:"frontend/src/scenes/experiments/SecondaryMetrics.tsx#SecondaryMetrics"})}catch(t){}var qe=d("./frontend/src/lib/colors.ts"),Ht=d("./frontend/src/lib/components/EntityFilterInfo.tsx"),Jt=d("./frontend/src/lib/components/EditableField/EditableField.tsx"),It=d("./frontend/src/lib/components/Link.tsx"),Qt=d("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/slider/index.js"),Xt=d("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/input-number/index.js"),Zt=d("./frontend/src/lib/components/InsightLabel/index.tsx"),Ft=d("./frontend/src/lib/components/PropertyFilters/components/PropertyFilterButton.tsx");function qt(){const[t,r]=Object(ce.useState)(!1),[n,a]=Object(ce.useState)(!1);return Object(e.jsxs)(ee.a,{className:"experiment-workflow",title:Object(e.jsx)("span",{className:"card-secondary",children:"Experiment workflow"}),children:[Object(e.jsx)(b.a,{children:Object(e.jsxs)(m.a,{className:"exp-workflow-step step-completed w-full",children:[Object(e.jsxs)(b.a,{align:"middle",children:[Object(e.jsx)(R.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}),Object(e.jsx)("b",{className:"ml-2",children:"Create experiment"})]}),Object(e.jsx)("div",{className:"ml-8",children:"Set variants, select participants, and add secondary metrics"})]})}),Object(e.jsx)(b.a,{children:Object(e.jsxs)(m.a,{className:`w-full exp-workflow-step ${t?"step-completed":""}`,onClick:()=>r(!t),children:[Object(e.jsxs)(b.a,{align:"middle",children:[t?Object(e.jsx)(R.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}):Object(e.jsx)(R.IconRadioButtonUnchecked,{}),Object(e.jsx)("b",{className:"ml-2",children:"Validate experiment"})]}),Object(e.jsx)("div",{className:"ml-8",children:"Once you've written your code, it's a good idea to test that each variant behaves as you'd expect."})]})}),Object(e.jsx)(b.a,{children:Object(e.jsxs)(m.a,{className:`w-full exp-workflow-step ${n?"step-completed":""}`,onClick:()=>a(!n),children:[Object(e.jsxs)(b.a,{align:"middle",children:[n?Object(e.jsx)(R.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}):Object(e.jsx)(R.IconRadioButtonUnchecked,{}),Object(e.jsx)("b",{className:"ml-2",children:"Launch experiment"})]}),Object(e.jsx)("div",{className:"ml-8",children:"Run your experiment, monitor results, and decide when to terminate your experiment."})]})})]})}function he(t){var r,n,a,s,o,l;let{experimentId:p,trendCount:u,funnelConversionRate:O,trendExposure:y,funnelSampleSize:E,funnelEntrants:D}=t;const{experimentInsightType:_,editingExistingExperiment:Y,minimumDetectableChange:B,expectedRunningTime:I,aggregationLabel:i,experiment:c,isExperimentGoalModalOpen:ue,experimentLoading:tt,experimentInsightId:De}=Object(h.useValues)(ne({experimentId:p})),{setExperiment:S,openExperimentGoalModal:Ve,closeExperimentGoalModal:X,updateExperimentGoal:C,setFilters:Oe,createNewExperimentInsight:H}=Object(h.useActions)(ne({experimentId:p})),oe=_===x.F.FUNNELS&&100-O<50?100-O:50,Se=Object(N.a)().diff(Object(N.a)(c==null?void 0:c.start_date),"hour");let Z=0;c!=null&&c.start_date?Z=I(D||1,E||0,Se):Z=I(D||1,E||0);const Ye=Object(N.a)(c==null?void 0:c.start_date).add(Z,"hour"),nt=!(c!=null&&c.end_date)&&Se>=24&&D&&E,q=Object(k.r)(c==null||(r=c.filters)===null||r===void 0?void 0:r.properties);return Object(e.jsxs)(b.a,{children:[Object(e.jsxs)(m.a,{span:!(c!=null&&c.start_date)&&p!=="new"&&!Y?12:24,children:[p==="new"&&Object(e.jsx)(b.a,{className:"experiment-preview-row",children:Object(e.jsxs)("div",{children:[Object(e.jsx)("div",{children:Object(e.jsx)("b",{children:"Experiment preview"})}),Object(e.jsxs)("div",{className:"text-muted",children:["Here are the baseline metrics for your experiment. Adjust your minimum detectible threshold to adjust for the smallest conversion value you'll accept, and the experiment duration."," "]})]})}),(p==="new"||Y)&&Object(e.jsx)(b.a,{className:"mb-4",children:Object(e.jsxs)(m.a,{span:24,children:[Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:"Minimum acceptable improvement"}),Object(e.jsx)(xe.a,{title:"Minimum acceptable improvement is a calculation that estimates the smallest significant improvement you are willing to accept.",children:Object(e.jsx)(Fe.a,{style:{marginLeft:4}})})]}),Object(e.jsxs)(b.a,{className:"mde-slider",children:[Object(e.jsx)(m.a,{span:8,children:Object(e.jsx)(Qt.a,{defaultValue:5,value:B,min:1,max:oe,trackStyle:{background:"var(--primary)"},handleStyle:{background:"var(--primary)"},onChange:T=>{S({parameters:M(f({},c.parameters),{minimum_detectable_effect:T})})},tipFormatter:T=>`${T}%`})}),Object(e.jsx)(Xt.a,{min:1,max:oe,defaultValue:5,formatter:T=>`${T}%`,style:{margin:"0 16px"},value:B,onChange:T=>{S({parameters:M(f({},c.parameters),{minimum_detectable_effect:T})})}})]})]})}),Object(e.jsxs)(b.a,{className:`experiment-preview-row ${c!=null&&c.start_date?"mr":""}`,children:[_===x.F.TRENDS?Object(e.jsxs)(e.Fragment,{children:[!(c!=null&&c.start_date)&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)(m.a,{span:6,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Baseline Count"}),Object(e.jsx)("div",{className:"l4",children:Object(k.Q)(u||0)})]}),Object(e.jsxs)(m.a,{span:6,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Minimum Acceptable Count"}),Object(e.jsx)("div",{className:"l4",children:Object(k.Q)(u+Math.ceil(u*(B/100))||0)})]})]}),Object(e.jsxs)(m.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Recommended running time"}),Object(e.jsxs)("div",{children:[Object(e.jsxs)("span",{className:"l4",children:["~",Object(k.Q)(y||0)]})," days"]})]})]}):Object(e.jsxs)(e.Fragment,{children:[!(c!=null&&c.start_date)&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)(m.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Baseline Conversion Rate"}),Object(e.jsxs)("div",{className:"l4",children:[O.toFixed(1),"%"]})]}),Object(e.jsxs)(m.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Minimum Acceptable Conversion Rate"}),Object(e.jsxs)("div",{className:"l4",children:[(O+B).toFixed(1),"%"]})]})]}),Object(e.jsxs)(m.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Recommended Sample Size"}),Object(e.jsxs)("div",{className:"pb-4",children:[Object(e.jsxs)("span",{className:"l4",children:["~",Object(k.Q)(E||0)]})," persons"]})]}),!(c!=null&&c.start_date)&&Object(e.jsxs)(m.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Recommended running time"}),Object(e.jsxs)("div",{children:[Object(e.jsxs)("span",{className:"l4",children:["~",Object(k.Q)(Z||0)]})," days"]})]})]}),Object(e.jsxs)(b.a,{className:"w-full mt-4",children:[Object(e.jsxs)(m.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Experiment variants"}),Object(e.jsx)("ul",{className:"variants-list",children:c==null||(n=c.parameters)===null||n===void 0||(a=n.feature_flag_variants)===null||a===void 0?void 0:a.map((T,U)=>Object(e.jsx)("li",{children:T.key},U))})]}),Object(e.jsxs)(m.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Participants"}),Object(e.jsx)("div",{children:q!=null&&q.length?Object(e.jsx)("div",{children:q==null?void 0:q.map(T=>Object(e.jsx)(Ft.a,{item:T,style:{margin:2,cursor:"default"}},T.key))}):Object(e.jsxs)(e.Fragment,{children:["100% of"," ",(c==null||(s=c.filters)===null||s===void 0?void 0:s.aggregation_group_type_index)!=null?Object(k.i)(i(c.filters.aggregation_group_type_index).plural):"users"]})})]})]}),Object(e.jsxs)(b.a,{className:"w-full",children:[p!=="new"&&!Y&&Object(e.jsxs)(m.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary mt-4",children:"Start date"}),c!=null&&c.start_date?Object(e.jsx)("span",{children:Object(N.a)(c==null?void 0:c.start_date).format("D MMM YYYY")}):Object(e.jsx)("span",{className:"description",children:"Not started yet"})]}),_===x.F.FUNNELS&&nt?Object(e.jsxs)(m.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary mt-4",children:"Expected end date"}),Object(e.jsx)("span",{children:Ye.isAfter(Object(N.a)())?Ye.format("D MMM YYYY"):Object(N.a)().format("D MMM YYYY")})]}):null,(c==null?void 0:c.end_date)&&Object(e.jsxs)(m.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary mt-4",children:"Completed date"}),Object(e.jsx)("span",{children:Object(N.a)(c==null?void 0:c.end_date).format("D MMM YYYY")})]})]})]}),p!=="new"&&!Y&&Object(e.jsx)(b.a,{className:"experiment-preview-row",children:Object(e.jsxs)(m.a,{children:[Object(e.jsx)("div",{className:"card-secondary mb-2",children:_===x.F.FUNNELS?"Conversion goal steps":"Trend goal"}),[...(c==null||(o=c.filters)===null||o===void 0?void 0:o.events)||[],...(c==null||(l=c.filters)===null||l===void 0?void 0:l.actions)||[]].sort((T,U)=>(T.order||0)-(U.order||0)).map((T,U)=>{var V;return Object(e.jsxs)(m.a,{className:"mb-2",children:[Object(e.jsxs)(b.a,{style:{marginBottom:4},children:[Object(e.jsx)("div",{className:"preview-conversion-goal-num",children:_===x.F.FUNNELS?(T.order||0)+1:U+1}),Object(e.jsx)("b",{children:Object(e.jsx)(Zt.a,{action:T,showCountedByTag:_===x.F.TRENDS,hideIcon:!0})})]}),(V=T.properties)===null||V===void 0?void 0:V.map(le=>Object(e.jsx)(Ft.a,{item:le},le.key))]},U)}),(c==null?void 0:c.start_date)&&Object(e.jsx)("div",{className:"mb-2 mt-4",children:Object(e.jsx)(L.LemonButton,{type:"secondary",onClick:Ve,children:"Change experiment goal"})})]})})]}),p!=="new"&&!Y&&!(c!=null&&c.start_date)&&Object(e.jsx)(m.a,{span:12,className:"pl-4",children:Object(e.jsx)(qt,{})}),Object(e.jsx)(L.LemonModal,{isOpen:ue,onClose:X,width:650,title:"Change experiment goal",footer:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)(L.LemonButton,{form:"edit-experiment-goal-form",type:"secondary",onClick:X,children:"Cancel"}),Object(e.jsx)(L.LemonButton,{form:"edit-experiment-goal-form",onClick:()=>{C(c.filters)},type:"primary",loading:tt,"data-attr":"create-annotation-submit",children:"Save"})]}),children:Object(e.jsx)(te.Form,{logic:ne,props:{experimentId:p},formKey:"experiment",id:"edit-experiment-goal-form",className:"space-y-4",children:Object(e.jsx)(te.Field,{name:"filters",children:T=>{let{value:U,onChange:V}=T;return Object(e.jsx)(be,{createPreviewInsight:H,setFilters:le=>{Oe(le),V(le)},previewInsightId:De,filters:U})}})})})]})}try{he.displayName="ExperimentPreview",he.__docgenInfo={description:"",displayName:"ExperimentPreview",props:{experimentId:{defaultValue:null,description:"",name:"experimentId",required:!0,type:{name:'number | "new"'}},trendCount:{defaultValue:null,description:"",name:"trendCount",required:!0,type:{name:"number"}},trendExposure:{defaultValue:null,description:"",name:"trendExposure",required:!1,type:{name:"number"}},funnelSampleSize:{defaultValue:null,description:"",name:"funnelSampleSize",required:!1,type:{name:"number"}},funnelConversionRate:{defaultValue:null,description:"",name:"funnelConversionRate",required:!0,type:{name:"number"}},funnelEntrants:{defaultValue:null,description:"",name:"funnelEntrants",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentPreview.tsx#ExperimentPreview"]={docgenInfo:he.__docgenInfo,name:"ExperimentPreview",path:"frontend/src/scenes/experiments/ExperimentPreview.tsx#ExperimentPreview"})}catch(t){}var Ce=d("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/select/index.js"),_t=d("./node_modules/.pnpm/@ant-design+icons@4.7.0_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/@ant-design/icons/es/icons/CaretDownOutlined.js"),A=d("./frontend/src/lib/components/CodeSnippet/index.tsx");function ve(){return Object(e.jsx)("div",{className:"warning",children:Object(e.jsxs)("p",{children:[Object(e.jsx)("b",{children:"Warning:"})," Server side experiment metrics require you to manually send the feature flag information."," ",Object(e.jsx)(L.Link,{to:"https://posthog.com/tutorials/experiments#step-2-sending-the-right-events",target:"_blank",children:"See this tutorial for more information."})]})})}function Te(t){let{flagKey:r,variant:n}=t;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(A.a,{language:A.b.JavaScript,wrap:!0,children:`const experimentFlagValue = await client.getFeatureFlag('${r}', 'user distinct id')

if (experimentFlagValue === '${n}' ) {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`}),Object(e.jsx)(ve,{})]})}function Me(t){let{flagKey:r,variant:n}=t;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(A.a,{language:A.b.JavaScript,wrap:!0,children:`if (posthog.getFeatureFlag('${r}') === '${n}') {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`}),Object(e.jsx)("b",{children:"Test that it works"}),Object(e.jsx)(A.a,{language:A.b.JavaScript,wrap:!0,children:`posthog.feature_flags.override({'${r}': '${n}'})`})]})}function ke(t){let{flagKey:r,variant:n}=t;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(A.a,{language:A.b.JavaScript,wrap:!0,children:`if (posthog.getFeatureFlag('${r}') === '${n}') {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`})})}function Re(t){let{flagKey:r,variant:n}=t;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(A.a,{language:A.b.PHP,wrap:!0,children:`if (PostHog::getFeatureFlag('${r}', 'user distinct id') == '${n}') {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`}),Object(e.jsx)(ve,{})]})}function $e(t){let{flagKey:r,variant:n}=t;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(A.a,{language:A.b.Go,wrap:!0,children:`experimentFlagValue, err := client.GetFeatureFlag(
                    FeatureFlagPayload{
                        Key:        '${r}',
                        DistinctId: "distinct-id",
                    })

if (experimentFlagValue == '${n}' ) {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`}),Object(e.jsx)(ve,{})]})}function Le(t){let{flagKey:r,variant:n}=t;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(A.a,{language:A.b.Ruby,wrap:!0,children:`experimentFlagValue = posthog.get_feature_flag('${r}', 'user distinct id')


if experimentFlagValue == '${n}'
    # Do something differently for this user
else
    # It's a good idea to let control variant always be the default behaviour,
    # so if something goes wrong with flag evaluation, you don't break your app.
end
`}),Object(e.jsx)(ve,{})]})}function Ae(t){let{flagKey:r,variant:n}=t;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(A.a,{language:A.b.Python,wrap:!0,children:`experiment_flag_value = posthog.get_feature_flag("${r}", "user_distinct_id"):

if experiment_flag_value == '${n}':
    # Do something differently for this user
else:
    # It's a good idea to let control variant always be the default behaviour,
    # so if something goes wrong with flag evaluation, you don't break your app.
`}),Object(e.jsx)(ve,{})]})}try{Te.displayName="NodeJSSnippet",Te.__docgenInfo={description:"",displayName:"NodeJSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#NodeJSSnippet"]={docgenInfo:Te.__docgenInfo,name:"NodeJSSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#NodeJSSnippet"})}catch(t){}try{Me.displayName="JSSnippet",Me.__docgenInfo={description:"",displayName:"JSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#JSSnippet"]={docgenInfo:Me.__docgenInfo,name:"JSSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#JSSnippet"})}catch(t){}try{ke.displayName="RNSnippet",ke.__docgenInfo={description:"",displayName:"RNSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RNSnippet"]={docgenInfo:ke.__docgenInfo,name:"RNSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RNSnippet"})}catch(t){}try{Re.displayName="PHPSnippet",Re.__docgenInfo={description:"",displayName:"PHPSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PHPSnippet"]={docgenInfo:Re.__docgenInfo,name:"PHPSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PHPSnippet"})}catch(t){}try{$e.displayName="GolangSnippet",$e.__docgenInfo={description:"",displayName:"GolangSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#GolangSnippet"]={docgenInfo:$e.__docgenInfo,name:"GolangSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#GolangSnippet"})}catch(t){}try{Le.displayName="RubySnippet",Le.__docgenInfo={description:"",displayName:"RubySnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RubySnippet"]={docgenInfo:Le.__docgenInfo,name:"RubySnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RubySnippet"})}catch(t){}try{Ae.displayName="PythonSnippet",Ae.__docgenInfo={description:"",displayName:"PythonSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PythonSnippet"]={docgenInfo:Ae.__docgenInfo,name:"PythonSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PythonSnippet"})}catch(t){}const ie="?utm_medium=in-product&utm_campaign=experiment",ae="https://posthog.com/docs/integrate/",se="#feature-flags",et=[{value:"JavaScript",documentationLink:`${ae}client/js${ie}${se}`,Icon:R.IconJavascript,Snippet:Me},{value:"ReactNative",documentationLink:`${ae}client/react-native${ie}${se}`,Icon:R.IconJavascript,Snippet:ke},{value:"Node.js",documentationLink:`${ae}server/node${ie}${se}`,Icon:R.IconNodeJS,Snippet:Te},{value:"PHP",documentationLink:`${ae}server/php${ie}${se}`,Icon:R.IconPHP,Snippet:Re},{value:"Ruby",documentationLink:`${ae}server/ruby${ie}${se}`,Icon:R.IconRuby,Snippet:Le},{value:"Golang",documentationLink:`${ae}server/go${ie}${se}`,Icon:R.IconGolang,Snippet:$e},{value:"Python",documentationLink:`${ae}server/python${ie}${se}`,Icon:R.IconPython,Snippet:Ae}];function Pe(t){let{selectedOptionValue:r,selectOption:n}=t;return Object(e.jsx)(Ce.a,{value:r,onChange:n,style:{minWidth:120},suffixIcon:Object(e.jsx)(_t.a,{}),children:et.map((a,s)=>{let{value:o,Icon:l}=a;return Object(e.jsx)(Ce.a.Option,{"data-attr":"experiment-instructions-select-option-"+o,value:o,children:Object(e.jsxs)("div",{className:"flex items-center",children:[Object(e.jsx)(l,{className:"mr-1"})," ",o]})},s)})})}function ye(t){var r,n,a,s,o,l,p;let{experiment:u}=t;const O=(r=u==null||(n=u.parameters)===null||n===void 0||(a=n.feature_flag_variants)===null||a===void 0||(s=a[1])===null||s===void 0?void 0:s.key)!==null&&r!==void 0?r:"test",[y,E]=Object(ce.useState)(O),[D]=et,[_,Y]=Object(ce.useState)(D),B=I=>{const i=et.find(c=>c.value===I);i&&Y(i)};return Object(e.jsxs)(ee.a,{title:Object(e.jsx)("span",{className:"card-secondary",children:"Feature flag usage and implementation"}),className:"experiment-implementation-details",children:[Object(e.jsxs)("div",{style:{justifyContent:"space-between"},className:"flex mb-2",children:[Object(e.jsxs)("div",{children:[Object(e.jsx)("span",{className:"mr-2",children:"Variant group"}),Object(e.jsx)(Ce.a,{onChange:E,value:y,style:{minWidth:80},suffixIcon:Object(e.jsx)(_t.a,{}),children:u==null||(o=u.parameters)===null||o===void 0||(l=o.feature_flag_variants)===null||l===void 0?void 0:l.map((I,i)=>Object(e.jsx)(Ce.a.Option,{value:I.key,children:I.key},i))})]}),Object(e.jsx)("div",{children:Object(e.jsx)(Pe,{selectOption:B,selectedOptionValue:_.value})})]}),Object(e.jsx)("b",{children:"Implement your experiment in code"}),Object(e.jsx)(_.Snippet,{variant:y,flagKey:(p=u==null?void 0:u.feature_flag_key)!==null&&p!==void 0?p:""}),Object(e.jsx)(L.Link,{to:_.documentationLink,target:"_blank",children:Object(e.jsxs)("div",{className:"flex items-center",children:["See the docs for more implementation information. ",Object(e.jsx)(R.IconOpenInNew,{className:"ml-1"})]})})]})}try{Pe.displayName="CodeLanguageSelect",Pe.__docgenInfo={description:"",displayName:"CodeLanguageSelect",props:{selectedOptionValue:{defaultValue:null,description:"",name:"selectedOptionValue",required:!0,type:{name:"string"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(selectedValue: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#CodeLanguageSelect"]={docgenInfo:Pe.__docgenInfo,name:"CodeLanguageSelect",path:"frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#CodeLanguageSelect"})}catch(t){}try{ye.displayName="ExperimentImplementationDetails",ye.__docgenInfo={description:"",displayName:"ExperimentImplementationDetails",props:{experiment:{defaultValue:null,description:"",name:"experiment",required:!0,type:{name:"Partial<Experiment> | null"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#ExperimentImplementationDetails"]={docgenInfo:ye.__docgenInfo,name:"ExperimentImplementationDetails",path:"frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#ExperimentImplementationDetails"})}catch(t){}var en=d("./frontend/src/lib/components/NotFound/index.tsx"),Ct=d("./frontend/src/lib/components/AlertMessage/index.ts");const tn={component:Tt,logic:ne,paramsToProps:t=>{let{params:{id:r}}=t;return{experimentId:r==="new"?"new":parseInt(r)}}};function Tt(){var t,r,n,a,s,o,l,p,u,O,y,E,D,_,Y,B;const{experimentId:I,experiment:i,experimentInsightId:c,minimumSampleSizePerVariant:ue,recommendedExposureForCountData:tt,variants:De,experimentResults:S,countDataForVariant:Ve,editingExistingExperiment:X,experimentInsightType:C,experimentResultsLoading:Oe,experimentLoading:H,areResultsSignificant:oe,conversionRateForVariant:Se,getIndexForVariant:Z,significanceBannerDetails:Ye,areTrendResultsConfusing:nt,taxonomicGroupTypesForSelection:q,groupTypes:T,aggregationLabel:U,secondaryMetricResults:V,secondaryMetricResultsLoading:le,experimentResultCalculationError:Mt,flagImplementationWarning:nn,flagAvailabilityWarning:rn,props:an,sortedExperimentResultVariants:rt}=Object(h.useValues)(ne),{launchExperiment:sn,setFilters:ze,setEditExperiment:it,endExperiment:kt,addExperimentGroup:on,updateExperiment:ln,removeExperimentGroup:dn,createNewExperimentInsight:cn,archiveExperiment:pn,resetRunningExperiment:mn,loadExperiment:Rt,setExposureAndSampleSize:un,setExperimentValue:Be}=Object(h.useActions)(ne),[at,st]=Object(ce.useState)(!0),{insightProps:ot}=Object(h.useValues)(Object(fe.c)({dashboardItemId:c})),{isStepsEmpty:xn,filterSteps:jn,filters:fn,results:lt,conversionMetrics:gn}=Object(h.useValues)(Object(Ee.a)(ot)),{filters:bn,results:hn}=Object(h.useValues)(Object(Ie.a)(ot)),dt=gn.totalRate*100,ct=ue(dt)*De.length,pt=(t=hn[0])===null||t===void 0?void 0:t.count,$t=lt==null||(r=lt[0])===null||r===void 0?void 0:r.count,mt=tt(pt),K=Math.floor(24/(De.length+2));Object(ce.useEffect)(()=>{un(mt,ct)},[mt,ct]);const Ke=C===x.F.FUNNELS&&S!==null&&S!==void 0&&S.insight?S.insight.reduce((j,g)=>{var z;return((z=g[0])===null||z===void 0?void 0:z.count)+j},0):0,vn=C===x.F.FUNNELS?(Ke||0)/((i==null||(n=i.parameters)===null||n===void 0?void 0:n.recommended_sample_size)||1)*100:Object(N.a)().diff(i==null?void 0:i.start_date,"day")/((i==null||(a=i.parameters)===null||a===void 0?void 0:a.recommended_running_time)||1)*100,yn={running:"green",draft:"default",complete:"purple"},Lt=()=>{if(i!=null&&i.start_date){if(!(i!=null&&i.end_date))return"running"}else return"draft";return"complete"},At=10,Pt=[{background:"#35416b",color:"#fff"},{background:"#C278CE66",color:"#35416B"},{background:"#FFE6AE",color:"#35416B"},{background:"#8DA9E74D",color:"#35416B"}];return H?Object(e.jsx)(J.a,{active:!0}):!i&&I!=="new"?Object(e.jsx)(en.a,{object:"experiment"}):Object(e.jsx)(e.Fragment,{children:I==="new"||X?Object(e.jsx)(e.Fragment,{children:Object(e.jsxs)(te.Form,{logic:ne,formKey:"experiment",props:an,id:"experiment-form",enableFormOnSubmit:!0,className:"space-y-4 experiment-form",children:[Object(e.jsx)(ft.a,{title:X?"Edit experiment":"New experiment",buttons:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)($.a,{"data-attr":"cancel-experiment",type:"secondary",onClick:()=>{X?(it(!1),Rt()):me.router.actions.push(Q.a.experiments())},disabled:H,children:"Cancel"}),Object(e.jsx)($.a,{type:"primary","data-attr":"save-experiment",htmlType:"submit",loading:H,disabled:H,children:"Save"})]})}),Object(e.jsx)(L.LemonDivider,{}),Object(e.jsx)(h.BindLogic,{logic:fe.c,props:ot,children:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"flex flex-col gap-2",style:{maxWidth:"50%"},children:[Object(e.jsx)(re.a,{name:"name",label:"Name",children:Object(e.jsx)(L.LemonInput,{"data-attr":"experiment-name"})}),Object(e.jsx)(re.a,{name:"feature_flag_key",label:"Feature flag key",children:Object(e.jsx)(L.LemonInput,{"data-attr":"experiment-feature-flag-key",disabled:X})}),Object(e.jsx)(re.a,{name:"description",label:Object(e.jsxs)("div",{children:["Description ",Object(e.jsx)("span",{className:"text-muted",children:"(optional)"})]}),children:Object(e.jsx)(L.LemonTextArea,{"data-attr":"experiment-description",className:"ph-ignore-input",placeholder:"Adding a helpful description can ensure others know what this experiment is about."})}),i.parameters.feature_flag_variants&&Object(e.jsxs)(m.a,{children:[Object(e.jsx)("label",{children:Object(e.jsx)("b",{children:"Experiment variants"})}),Object(e.jsx)("div",{className:"text-muted",children:"Participants are divided into variant groups evenly. All experiments must consist of a control group and at least one test group. Experiments may have at most 3 test groups. Variant names can only contain letters, numbers, hyphens, and underscores."}),Object(e.jsxs)(m.a,{className:"variants",children:[(s=i.parameters.feature_flag_variants)===null||s===void 0?void 0:s.map((j,g)=>Object(e.jsx)(te.Group,{name:["parameters","feature_flag_variants",g],children:Object(e.jsxs)(b.a,{className:`feature-flag-variant ${g===0?"border-t":g>=At?"border-b":""}`,children:[Object(e.jsx)("div",{className:"variant-label",style:g===0?f({},Pt[g]):f({},Pt[g%3+1]),children:g===0?"Control":"Test"}),Object(e.jsx)(re.a,{name:"key",className:"extend-variant-fully",children:Object(e.jsx)(L.LemonInput,{disabled:g===0||I!=="new","data-attr":"experiment-variant-key","data-key-index":g.toString(),className:"ph-ignore-input",fullWidth:!0,placeholder:`example-variant-${g+1}`,autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})}),Object(e.jsx)("div",{className:"float-right",children:I==="new"&&!(g===0||g===1)&&Object(e.jsx)(xe.a,{title:"Delete this variant",placement:"bottomLeft",children:Object(e.jsx)($.a,{status:"primary-alt",size:"small",icon:Object(e.jsx)(R.IconDelete,{}),onClick:()=>dn(g)})})})]},`${j}-${g}`)},g)),((o=i.parameters.feature_flag_variants.length)!==null&&o!==void 0?o:0)<At&&I==="new"&&Object(e.jsx)("div",{className:"feature-flag-variant border-b",children:Object(e.jsx)($.a,{onClick:()=>on(),icon:Object(e.jsx)(R.IconPlusMini,{}),children:"Add test variant"})})]})]})]}),Object(e.jsx)(b.a,{className:"person-selection",children:Object(e.jsxs)(m.a,{span:12,children:[Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)("strong",{children:"Select participants"})}),Object(e.jsx)("div",{className:"text-muted",children:"Select the entities who will participate in this experiment. If no filters are set, 100% of participants will be targeted."}),Object(e.jsx)("div",{className:"mt-4 mb-2",children:Object(e.jsx)("strong",{children:"Participant type"})}),Object(e.jsx)(L.LemonSelect,{value:i.filters.aggregation_group_type_index!=null?i.filters.aggregation_group_type_index:-1,"data-attr":"participant-aggregation-filter",dropdownMatchSelectWidth:!1,onChange:j=>{const g=j!==-1?j:void 0;ze({properties:[],aggregation_group_type_index:g!=null?g:void 0}),Be("filters",M(f({},i.filters),{aggregation_group_type_index:g,properties:[]}))},options:[{value:-1,label:"Persons"},...T.map(j=>({value:j.group_type_index,label:Object(k.i)(U(j.group_type_index).plural)}))]}),Object(e.jsx)("div",{className:"mt-4 mb-2",children:Object(e.jsx)("strong",{children:"Filters"})}),Object(e.jsx)("div",{className:"mb-4",children:Object(e.jsx)(Yt.a,{pageKey:`experiment-participants-property-${JSON.stringify(i.filters)}`,propertyFilters:Object(k.r)(i.filters.properties),onChange:j=>{ze({properties:j.filter(gt.g)}),Be("filters",M(f({},i.filters),{properties:j.filter(gt.g)}))},taxonomicGroupTypes:q})}),rn&&Object(e.jsxs)(Ct.a,{type:"info",className:"mt-3 mb-3",children:["These properties aren't immediately available on first page load for unidentified persons. This experiment requires that at least one event is sent prior to becoming available to your product or website."," ",Object(e.jsxs)("a",{href:"https://posthog.com/docs/integrate/client/js#bootstrapping-flags",target:"_blank",children:[" ","Learn more about how to make feature flags available instantly."]})]}),Object(e.jsx)("div",{className:"mt-4 mb-2",children:Object(e.jsx)("strong",{children:"Advanced Options"})}),Object(e.jsxs)("div",{className:"mb-4",children:["For more advanced options like changing the rollout percentage and persisting feature flags, you can"," ",I==="new"?"change settings on the feature flag after creation.":Object(e.jsx)(It.a,{to:i.feature_flag?Q.a.featureFlag(i.feature_flag):void 0,children:"change settings on the feature flag."})]})]})}),Object(e.jsxs)(b.a,{className:"metrics-selection",children:[Object(e.jsxs)(m.a,{span:12,children:[Object(e.jsxs)("div",{className:"mb-2","data-attr":"experiment-goal-type",children:[Object(e.jsx)("b",{children:"Goal type"}),Object(e.jsx)("div",{className:"text-muted",children:C===x.F.TRENDS?"Track counts of a specific event or action":"Track how many persons complete a sequence of actions and or events"})]}),Object(e.jsx)(L.LemonSelect,{value:C,onChange:j=>{var g;j&&cn({insight:j,properties:i==null||(g=i.filters)===null||g===void 0?void 0:g.properties})},dropdownMatchSelectWidth:!1,options:[{value:x.F.TRENDS,label:"Trend"},{value:x.F.FUNNELS,label:"Conversion funnel"}]}),Object(e.jsxs)("div",{className:"my-4",children:[Object(e.jsx)("b",{children:"Experiment goal"}),C===x.F.TRENDS&&Object(e.jsx)("div",{className:"text-muted",children:"Trend-based experiments can have at most one graph series. This metric is used to track the progress of your experiment."})]}),nn&&Object(e.jsxs)(Ct.a,{type:"info",className:"mt-3 mb-3",children:["We can't detect any feature flag information for this target metric. Ensure that you're using the latest PostHog client libraries, and make sure you manually send feature flag information for server-side libraries if necessary."," ",Object(e.jsxs)("a",{href:"https://posthog.com/docs/integrate/server/python#capture",target:"_blank",children:[" ","Read the docs for how to do this for server-side libraries."]})]}),C===x.F.FUNNELS&&Object(e.jsx)(pe.a,{bordered:!0,filters:fn,setFilters:j=>{ze(j),Be("filters",f(f({},i.filters),j))},typeKey:`experiment-funnel-goal-${JSON.stringify(i.filters)}`,mathAvailability:Ze.b.None,hideDeleteBtn:jn.length===1,buttonCopy:"Add funnel step",showSeriesIndicator:!xn,seriesIndicatorType:"numeric",sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[v.a.EventProperties,v.a.PersonProperties,v.a.EventFeatureFlags,v.a.Cohorts,v.a.Elements]}),C===x.F.TRENDS&&Object(e.jsx)(pe.a,{bordered:!0,filters:bn,setFilters:j=>{ze(j),Be("filters",f(f({},i.filters),j))},typeKey:`experiment-trends-goal-${JSON.stringify(i.filters)}`,buttonCopy:"Add graph series",showSeriesIndicator:!0,entitiesLimit:1,hideDeleteBtn:!0,propertiesTaxonomicGroupTypes:[v.a.EventProperties,v.a.PersonProperties,v.a.EventFeatureFlags,v.a.Cohorts,v.a.Elements]})]}),Object(e.jsxs)(m.a,{span:12,className:"pl-4",children:[Object(e.jsx)("div",{className:"card-secondary mb-4","data-attr":"experiment-preview",children:"Goal preview"}),Object(e.jsx)(Qe.a,{disableHeader:C===x.F.TRENDS,disableTable:!0,disableCorrelationTable:!0})]})]}),Object(e.jsx)(re.a,{name:"secondary_metrics",children:j=>{let{value:g,onChange:z}=j;return Object(e.jsx)(b.a,{className:"secondary-metrics",children:Object(e.jsxs)("div",{className:"flex flex-col",children:[Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:"Secondary metrics"}),Object(e.jsx)("span",{className:"text-muted ml-2",children:"(optional)"})]}),Object(e.jsxs)("div",{className:"text-muted",style:{marginTop:4},children:["Use secondary metrics to monitor metrics related to your experiment goal. You can add up to three secondary metrics."," "]}),Object(e.jsx)(_e,{onMetricsChange:z,initialMetrics:g})]})})}}),Object(e.jsx)(ee.a,{className:"experiment-preview",children:Object(e.jsx)(he,{experimentId:i.id,trendCount:pt,trendExposure:mt,funnelSampleSize:ct,funnelEntrants:$t,funnelConversionRate:dt})}),Object(e.jsx)(b.a,{})]})}),Object(e.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[Object(e.jsx)($.a,{"data-attr":"cancel-experiment",type:"secondary",onClick:()=>{X?(it(!1),Rt()):me.router.actions.push(Q.a.experiments())},disabled:H,children:"Cancel"}),Object(e.jsx)($.a,{type:"primary","data-attr":"save-experiment",htmlType:"submit",loading:H,disabled:H,children:"Save"})]})]})}):i?Object(e.jsxs)("div",{className:"view-experiment",children:[Object(e.jsx)(b.a,{className:"draft-header",children:Object(e.jsxs)(b.a,{justify:"space-between",align:"middle",className:"w-full pb-4",children:[Object(e.jsxs)(m.a,{children:[Object(e.jsx)(b.a,{children:Object(e.jsx)(ft.a,{style:{paddingRight:8},title:`${i==null?void 0:i.name}`,buttons:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Ut.a,{explicitValue:i.feature_flag_key,iconStyle:{color:"var(--muted-alt)"},children:Object(e.jsx)("span",{className:"text-muted",children:i.feature_flag_key})}),Object(e.jsx)(G.a,{style:{alignSelf:"center"},color:yn[Lt()],children:Object(e.jsx)("b",{className:"uppercase",children:Lt()})}),S&&i.end_date&&Object(e.jsx)(G.a,{style:{alignSelf:"center"},color:oe?"green":"geekblue",children:Object(e.jsx)("b",{className:"uppercase",children:oe?"Significant Results":"Results not significant"})})]})})}),Object(e.jsx)("span",{className:"exp-description",children:i.start_date?Object(e.jsx)(Jt.a,{multiline:!0,name:"description",value:i.description||"",placeholder:"Description (optional)",onSave:j=>ln({description:j}),maxLength:400,"data-attr":"experiment-description",compactButtons:!0}):Object(e.jsx)(e.Fragment,{children:i.description||"There is no description for this experiment."})})]}),i&&!i.start_date&&Object(e.jsxs)("div",{className:"flex items-center",children:[Object(e.jsx)($.a,{type:"secondary",className:"mr-2",onClick:()=>it(!0),children:"Edit"}),Object(e.jsx)($.a,{type:"primary",onClick:()=>sn(),children:"Launch"})]}),i&&i.start_date&&!i.end_date&&Object(e.jsxs)("div",{className:"flex flex-row gap-2",children:[Object(e.jsx)(je.a,{placement:"topLeft",title:Object(e.jsxs)("div",{children:["Reset this experiment and go back to draft mode?",Object(e.jsx)("div",{className:"text-sm text-muted",children:"All collected data so far will be discarded."})]}),onConfirm:()=>mn(),children:Object(e.jsx)($.a,{type:"secondary",status:"primary",children:"Reset"})}),Object(e.jsx)($.a,{type:"secondary",status:"danger",onClick:()=>kt(),children:"Stop"})]}),(i==null?void 0:i.end_date)&&Object(N.a)().isSameOrAfter(Object(N.a)(i.end_date),"day")&&!i.archived&&Object(e.jsx)($.a,{type:"secondary",status:"danger",onClick:()=>pn(),children:Object(e.jsx)("b",{children:"Archive"})})]})}),Object(e.jsxs)(b.a,{children:[at&&S&&oe&&!i.end_date&&Object(e.jsxs)(b.a,{align:"middle",className:"significant-results",children:[Object(e.jsx)(m.a,{span:20,style:{fontWeight:500,color:"#497342"},children:Object(e.jsxs)("div",{children:["Experiment results are significant."," ",i.end_date?"":"You can end your experiment now or let it run until complete."]})}),Object(e.jsx)(m.a,{span:4,children:i.end_date?Object(e.jsx)(Xe.a,{className:"close-button",onClick:()=>st(!1)}):Object(e.jsx)($.a,{type:"primary",onClick:()=>kt(),children:"End experiment"})})]}),at&&S&&!oe&&!i.end_date&&Object(e.jsxs)(b.a,{align:"top",className:"not-significant-results",children:[Object(e.jsxs)(m.a,{span:23,style:{fontWeight:500,color:"#2D2D2D"},children:[Object(e.jsx)("strong",{children:"Your results are not statistically significant"}),"."," ",Ye," ",i!=null&&i.end_date?"":"We don't recommend ending this experiment yet."," See our"," ",Object(e.jsxs)("a",{href:"https://posthog.com/docs/user-guides/experimentation#funnel-experiment-calculations",children:[" ","experimentation guide"," "]}),"for more information."," "]}),Object(e.jsx)(m.a,{span:1,children:Object(e.jsx)(Xe.a,{className:"close-button",onClick:()=>st(!1)})})]}),at&&i.end_date&&Object(e.jsxs)(b.a,{align:"top",className:"feature-flag-mods",children:[Object(e.jsxs)(m.a,{span:23,style:{fontWeight:500},children:[Object(e.jsx)("strong",{children:"Your experiment is complete, but the feature flag is still enabled."})," ","We recommend removing the feature flag from your code completely, instead of relying on this distribution."," ",Object(e.jsx)(It.a,{to:i.feature_flag?Q.a.featureFlag(i.feature_flag):void 0,children:Object(e.jsx)("b",{children:"Adjust feature flag distribution"})})]}),Object(e.jsx)(m.a,{span:1,children:Object(e.jsx)(Xe.a,{className:"close-button",onClick:()=>st(!1)})})]})]}),Object(e.jsxs)(b.a,{children:[Object(e.jsx)(xt.a,{className:"w-full",defaultActiveKey:"experiment-details",children:Object(e.jsx)(xt.a.Panel,{header:Object(e.jsx)("b",{children:"Experiment details"}),children:Object(e.jsxs)(b.a,{children:[Object(e.jsx)(m.a,{span:i!=null&&i.start_date?12:24,children:Object(e.jsx)(he,{experimentId:i.id,trendCount:pt,trendExposure:i==null?void 0:i.parameters.recommended_running_time,funnelSampleSize:i==null?void 0:i.parameters.recommended_sample_size,funnelConversionRate:dt,funnelEntrants:i!=null&&i.start_date?Ke:$t})}),!Oe&&!S&&i.start_date&&Object(e.jsx)(m.a,{span:12,children:Object(e.jsx)(ye,{experiment:i})}),S&&Object(e.jsxs)(m.a,{span:12,className:"mt-4",children:[Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)("b",{children:"Experiment progress"})}),Object(e.jsx)(jt.a,{strokeWidth:20,showInfo:!1,percent:vn,strokeColor:"var(--success)"}),C===x.F.TRENDS&&i.start_date&&Object(e.jsxs)(b.a,{justify:"space-between",className:"mt-2",children:[i.end_date?Object(e.jsxs)("div",{children:["Ran for"," ",Object(e.jsx)("b",{children:Object(N.a)(i.end_date).diff(i.start_date,"day")})," ","days"]}):Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:Object(N.a)().diff(i.start_date,"day")})," days running"]}),Object(e.jsxs)("div",{children:["Goal:"," ",Object(e.jsx)("b",{children:(l=i==null||(p=i.parameters)===null||p===void 0?void 0:p.recommended_running_time)!==null&&l!==void 0?l:"Unknown"})," ","days"]})]}),C===x.F.FUNNELS&&Object(e.jsxs)(b.a,{justify:"space-between",className:"mt-2",children:[i.end_date?Object(e.jsxs)("div",{children:["Saw ",Object(e.jsx)("b",{children:Object(k.Q)(Ke)})," ","participants"]}):Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:Object(k.Q)(Ke)})," ","participants seen"]}),Object(e.jsxs)("div",{children:["Goal:"," ",Object(e.jsx)("b",{children:Object(k.Q)((i==null||(u=i.parameters)===null||u===void 0?void 0:u.recommended_sample_size)||0)})," ","participants"]})]})]}),((O=i.secondary_metrics)===null||O===void 0?void 0:O.length)>0&&Object(e.jsx)(m.a,{className:"secondary-progress",span:i!=null&&i.start_date&&((i==null||(y=i.parameters)===null||y===void 0||(E=y.feature_flag_variants)===null||E===void 0?void 0:E.length)||0)<=5?12:24,children:!!(i!=null&&i.secondary_metrics.length)&&Object(e.jsxs)(m.a,{className:"border-b",children:[Object(e.jsxs)(b.a,{align:"middle",justify:"space-between",className:"mb-2",children:[Object(e.jsx)(m.a,{className:"card-secondary",span:2*K,children:"Secondary metrics"}),i==null||(D=i.parameters)===null||D===void 0||(_=D.feature_flag_variants)===null||_===void 0?void 0:_.map((j,g)=>Object(e.jsx)(m.a,{span:K,style:{color:Object(qe.d)(Z(j.key,C))},children:Object(e.jsx)("span",{className:"text-sm",children:Object(k.i)(j.key)})},g))]}),i.start_date?le?Object(e.jsx)(J.a,{active:!0,paragraph:!1}):Object(e.jsx)(e.Fragment,{children:i.secondary_metrics.map((j,g)=>{var z,de;return Object(e.jsxs)(b.a,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[Object(e.jsx)(m.a,{span:2*K,children:Object(k.i)(j.name)}),i==null||(z=i.parameters)===null||z===void 0||(de=z.feature_flag_variants)===null||de===void 0?void 0:de.map((Ge,ut)=>Object(e.jsx)(m.a,{span:K,children:V!=null&&V[g][Ge.key]?j.filters.insight===x.F.FUNNELS?Object(e.jsxs)(e.Fragment,{children:[((V==null?void 0:V[g][Ge.key])*100).toFixed(1),"%"]}):Object(e.jsx)(e.Fragment,{children:Object(k.Q)(V==null?void 0:V[g][Ge.key])}):Object(e.jsx)(e.Fragment,{children:"--"})},ut))]},g)})}):Object(e.jsx)(e.Fragment,{children:i.secondary_metrics.map((j,g)=>{var z,de;return Object(e.jsxs)(b.a,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[Object(e.jsx)(m.a,{span:2*K,children:Object(k.i)(j.name)}),i==null||(z=i.parameters)===null||z===void 0||(de=z.feature_flag_variants)===null||de===void 0?void 0:de.map((Ge,ut)=>Object(e.jsx)(m.a,{span:K,children:"--"},ut))]},g)})})]})})]})},"experiment-details")}),!(i!=null&&i.start_date)&&Object(e.jsx)("div",{className:"mt-4 w-full",children:Object(e.jsx)(ye,{experiment:i})})]}),Object(e.jsxs)("div",{className:"experiment-result",children:[S?((i==null||(Y=i.parameters)===null||Y===void 0||(B=Y.feature_flag_variants)===null||B===void 0?void 0:B.length)||0)>4?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)(b.a,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[Object(e.jsx)(m.a,{span:2*K,children:"Variant"}),rt.map((j,g)=>Object(e.jsx)(m.a,{span:K,style:{color:Object(qe.d)(Z(j,C))},children:Object(e.jsx)("b",{children:Object(k.i)(j)})},g))]}),Object(e.jsxs)(b.a,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[Object(e.jsx)(m.a,{span:2*K,children:C===x.F.TRENDS?"Count":"Conversion Rate"}),rt.map((j,g)=>Object(e.jsx)(m.a,{span:K,children:C===x.F.TRENDS?Ve(j):`${Se(j)}%`},g))]}),Object(e.jsxs)(b.a,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[Object(e.jsx)(m.a,{span:2*K,children:"Probability to be the best"}),rt.map((j,g)=>Object(e.jsx)(m.a,{span:K,children:Object(e.jsx)("b",{children:S.probability[j]?`${(S.probability[j]*100).toFixed(1)}%`:"--"})},g))]})]}):Object(e.jsx)(b.a,{justify:"space-around",style:{flexFlow:"nowrap"},children:Object.keys(S.probability).sort((j,g)=>S.probability[g]-S.probability[j]).map((j,g)=>Object(e.jsxs)(m.a,{className:"pr-4",children:[Object(e.jsx)("div",{children:Object(e.jsx)("b",{children:Object(k.i)(j)})}),C===x.F.TRENDS?Object(e.jsxs)(b.a,{children:[Object(e.jsx)("b",{style:{paddingRight:4},children:Object(e.jsxs)(b.a,{children:["action"in S.insight[0]&&Object(e.jsx)(Ht.a,{filter:S.insight[0].action}),Object(e.jsx)("span",{style:{paddingLeft:4},children:"count:"})]})})," ",Ve(j)," ",nt&&g===0&&Object(e.jsx)(xe.a,{placement:"right",title:"It might seem confusing that the best variant has lower absolute count, but this can happen when fewer people are exposed to this variant, so its relative count is higher.",children:Object(e.jsx)(Fe.a,{style:{padding:"4px 2px"}})})]}):Object(e.jsxs)(b.a,{children:[Object(e.jsx)("b",{style:{paddingRight:4},children:"Conversion rate:"})," ",Se(j),"%"]}),Object(e.jsx)(jt.a,{percent:Number((S.probability[j]*100).toFixed(1)),size:"small",showInfo:!1,strokeColor:Object(qe.d)(Z(j,C))}),Object(e.jsxs)("div",{children:["Probability that this variant is the best:"," ",Object(e.jsxs)("b",{children:[(S.probability[j]*100).toFixed(1),"%"]})]})]},g))}):Oe&&Object(e.jsx)("div",{className:"text-center",children:Object(e.jsx)(J.a,{active:!0})}),S?Object(e.jsx)(h.BindLogic,{logic:fe.c,props:{dashboardItemId:S.itemID,cachedInsight:{short_id:S.itemID,filters:f(f(M(f({},S.filters),{insight:C}),C===x.F.FUNNELS&&{layout:we.k.vertical,funnel_viz_type:x.B.Steps}),C===x.F.TRENDS&&{display:x.k.ActionsLineGraphCumulative}),result:S.insight,disable_baseline:!0},doNotLoad:!0},children:Object(e.jsx)("div",{className:"mt-4",children:Object(e.jsx)(Qe.a,{disableHeader:!0,disableCorrelationTable:C===x.F.FUNNELS,disableLastComputation:!0})})}):i.start_date&&Object(e.jsx)(e.Fragment,{children:Object(e.jsx)("div",{className:"no-experiment-results",children:!Oe&&Object(e.jsxs)("div",{className:"text-center",children:[Object(e.jsx)("b",{children:"There are no results for this experiment yet."}),Object(e.jsxs)("div",{className:"text-sm ",children:[!!Mt&&`${Mt}. `," ","Wait a bit longer for your users to be exposed to the experiment. Double check your feature flag implementation if you're still not seeing results."]})]})})})]})]}):Object(e.jsx)(J.a,{active:!0})})}},"./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/experiments/Experiment.scss":function(P,F,d){var J=d("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/runtime/api.js");F=J(!1),F.push([P.i,'.experiment-form .metrics-selection,.experiment-form .person-selection{border-top:1px solid var(--border);padding-top:1rem;width:100%}.experiment-form .person-selection{align-items:center;justify-content:space-between}.experiment-form .insights-graph-container{margin-bottom:1rem;background-color:#fff}.experiment-form .insights-graph-container .ant-card-head{border-bottom:1px solid var(--border);min-height:unset;background-color:var(--bg-light);padding-left:1rem;padding-right:1rem}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title{padding:.5rem 0}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter{font-size:14px}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter:not(:last-child),.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter span.head-title-item{margin-right:.5rem}.experiment-form .insights-graph-container .display-config-inner{display:flex;align-items:center;justify-content:space-between;overflow-x:auto}.experiment-form .insights-graph-container .ant-card-body{padding:0}.experiment-form .insights-graph-container .insights-graph-container-row .insights-graph-container-row-left{width:100%}.experiment-form .insights-graph-container .insights-graph-container-row .insights-graph-container-row-right{width:100%;height:min(90vh - 16rem,36rem);max-width:300px;padding:0 1rem 1rem 0;display:flex;align-items:center}.experiment-form .insights-graph-container .LineGraph{width:calc(100% - 2rem);height:calc(100% - 3rem)}.experiment-form .insights-graph-header{margin-top:0!important;margin-bottom:0!important;padding-left:1rem;padding-right:1rem;min-height:48px}.experiment-form .experiment-preview{margin-bottom:1rem;border-bottom:1px solid var(--border)}.experiment-form .experiment-preview .mde-slider .ant-slider-handle{border:none}.experiment-form .experiment-preview .mde-slider .ant-slider-rail{background-color:#e5ebff}.experiment-form .variants{margin-top:.5rem;padding-bottom:1rem}.experiment-form .variants .ant-form-horizontal{min-height:32px}.experiment-form .variants .border-top{border-top-left-radius:4px;border-top-right-radius:4px}.experiment-form .variants .border-bottom{border-bottom-left-radius:4px;border-bottom-right-radius:4px}.experiment-form .variants .feature-flag-variant{display:flex;align-items:center;padding:.5rem;background:#fff;border-bottom-width:1px;border-bottom-color:var(--border);border-top:1px solid var(--border);border-left:1px solid var(--border);border-right:1px solid var(--border)}.experiment-form .variants .feature-flag-variant .extend-variant-fully{flex:1}.experiment-form .variants .variant-label{display:flex;flex-direction:row;justify-content:center;align-items:center;border-radius:4px;color:#fff;min-width:52px;padding:2px 6px;margin-right:8px;font-size:12px;font-weight:500;letter-spacing:.01em}.experiment-form .secondary-metrics{margin-top:1rem;padding-top:1rem;border-top:1px solid var(--border);margin-bottom:1rem;width:100%}.experiment-form .ant-input-number-disabled,.experiment-form .ant-input[disabled]{color:#000}.view-experiment .draft-header{margin-bottom:1rem;border-bottom:1px solid var(--border)}.view-experiment .exp-description{font-style:italic;color:var(--muted)}.view-experiment .participants{background-color:#fff}.view-experiment .participants .ant-collapse-header{padding-top:.5rem;padding-bottom:.5rem;padding-left:.75rem}.view-experiment .variants-list li{display:inline}.view-experiment .variants-list li:after{content:", "}.view-experiment .variants-list li:last-child:after{content:""}.view-experiment .experiment-result{padding-top:1rem}.view-experiment .significant-results{padding:.5rem;width:100%;background:rgba(119,185,108,.1);border-radius:4px;text-align:center;margin-bottom:1rem}.view-experiment .not-significant-results{padding:.5rem;width:100%;background:rgba(83,117,255,.1);border-radius:4px;margin-bottom:1rem}.view-experiment .feature-flag-mods{padding:.5rem;width:100%;background:#f6ebf8;border-radius:4px;margin-bottom:1rem}.view-experiment .ant-collapse-content-box{display:flex;flex-flow:column}.view-experiment .secondary-progress{margin-top:.5rem}.view-experiment .secondary-progress li:before{content:"\u2022";display:inline-block;font-weight:900;margin-right:4px}.view-experiment .secondary-progress .ant-progress-inner,.view-experiment .secondary-progress .ant-progress-inner .ant-progress-bg{border-radius:4px}.view-experiment .no-experiment-results{display:flex;justify-content:center;align-items:center;margin-top:1rem;background-color:var(--side);border:1px solid var(--border);width:100%;min-height:320px;font-size:24px}.preview-conversion-goal-num{height:24px;width:24px;text-align:center;background-color:var(--side);color:var(--primary-alt);font-weight:700;margin-right:.5rem}.experiment-preview-row{border-bottom:1px solid var(--border);padding-bottom:1rem;margin-bottom:1rem}.experiment-preview-row:last-child{border-bottom:none;padding-bottom:0;margin-bottom:0}.metric-name{border:1px solid var(--border);border-radius:4px;padding:8px 8px 8px 16px;margin-left:.5rem;flex:1}.experiment-implementation-details,.experiment-workflow{border-color:var(--dark-grey)}.experiment-implementation-details .ant-card-head,.experiment-workflow .ant-card-head{padding-left:1rem;padding-right:1rem;border:none}.experiment-implementation-details .ant-card-head-title,.experiment-workflow .ant-card-head-title{border-bottom:1px solid var(--border)}.experiment-implementation-details .exp-workflow-step,.experiment-workflow .exp-workflow-step{margin-bottom:.5rem;padding:.5rem;border-radius:4px}.experiment-implementation-details .exp-workflow-step:hover,.experiment-workflow .exp-workflow-step:hover{cursor:pointer}.experiment-implementation-details .step-completed,.experiment-workflow .step-completed{background-color:#e5ebff}',""]),P.exports=F}}]);
