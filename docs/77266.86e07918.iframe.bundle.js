"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[77266],{"../../frontend/src/scenes/data-pipelines/DataPipelinesNewScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DataPipelinesNewScene:()=>DataPipelinesNewScene,dataPipelinesNewSceneLogic:()=>dataPipelinesNewSceneLogic,scene:()=>scene});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib_components_FlaggedFeature__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/src/lib/components/FlaggedFeature.tsx"),lib_components_NotFound__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/components/NotFound/index.tsx"),lib_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/utils.tsx"),scenes_data_warehouse_new_NewSourceWizard__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/scenes/data-warehouse/new/NewSourceWizard.tsx"),scenes_hog_functions_list_HogFunctionTemplateList__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/scenes/hog-functions/list/HogFunctionTemplateList.tsx"),scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/scenes/urls.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let dataPipelinesNewSceneLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(()=>["scenes","data-pipelines","dataPipelinesNewSceneLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({logicProps:[()=>[(_,props)=>props],props=>props],breadcrumbs:[()=>[(_,props)=>props],_ref=>{let{kind}=_ref;return[{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_6__.x.DataPipelines,name:"Data pipelines",path:scenes_urls__WEBPACK_IMPORTED_MODULE_7__.j.dataPipelines("overview")},{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_6__.x.DataPipelines,name:(0,lib_utils__WEBPACK_IMPORTED_MODULE_3__.fm)(kind)+"s",path:scenes_urls__WEBPACK_IMPORTED_MODULE_7__.j.dataPipelines(kind+"s")},{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_6__.x.DataPipelinesNew,name:"New"}]}]})]),scene={component:DataPipelinesNewScene,logic:dataPipelinesNewSceneLogic,paramsToProps:_ref2=>{let{params:{kind}}=_ref2;return{kind}}};function DataPipelinesNewScene(){let{logicProps}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(dataPipelinesNewSceneLogic),{kind}=logicProps;return"transformation"===kind?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(scenes_hog_functions_list_HogFunctionTemplateList__WEBPACK_IMPORTED_MODULE_5__.a,{defaultFilters:{},type:"transformation"}):"destination"===kind?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(scenes_hog_functions_list_HogFunctionTemplateList__WEBPACK_IMPORTED_MODULE_5__.a,{defaultFilters:{},type:"destination"}):"site_app"===kind?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(scenes_hog_functions_list_HogFunctionTemplateList__WEBPACK_IMPORTED_MODULE_5__.a,{defaultFilters:{},type:"site_app"}):"source"===kind?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(lib_components_FlaggedFeature__WEBPACK_IMPORTED_MODULE_1__.P,{flag:"cdp-hog-sources",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("h2",{children:"Event sources"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(scenes_hog_functions_list_HogFunctionTemplateList__WEBPACK_IMPORTED_MODULE_5__.a,{defaultFilters:{},type:"source_webhook"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(scenes_data_warehouse_new_NewSourceWizard__WEBPACK_IMPORTED_MODULE_4__.k,{})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(lib_components_NotFound__WEBPACK_IMPORTED_MODULE_2__.T,{object:"Data pipeline new options"})}},"../../frontend/src/scenes/hog-functions/integrations/IntegrationChoice.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{a:()=>IntegrationChoice});var posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.21.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),api=__webpack_require__("../../frontend/src/lib/api.ts"),integrationsLogic=__webpack_require__("../../frontend/src/lib/integrations/integrationsLogic.ts"),IntegrationView=__webpack_require__("../../frontend/src/lib/integrations/IntegrationView.tsx"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),LemonField=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonField/index.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let INTEGRATION_CREDENTIALS={email:{fields:[{key:"apiKey",label:"API key",type:"text",required:!0},{key:"secretKey",label:"Secret key",type:"password",required:!0}],helpText:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Log in or sign up for Mailjet and get your API key and secret key on the"," ",(0,jsx_runtime.jsx)(src.rU,{to:"https://app.mailjet.com/account/apikeys",target:"_blank",children:"API Key Management"})," ","page"]}),createFn:(credentials,callback)=>integrationsLogic.a.actions.newMailjetKey(credentials.apiKey,credentials.secretKey,callback)}},getIntegrationSetupModalProps=_ref=>{let{integration,integrationName,onComplete}=_ref,integrationConfig=INTEGRATION_CREDENTIALS[integration];return integrationConfig?{title:`Configure ${integrationName} integration`,description:integrationConfig.helpText,width:"30rem",initialValues:integrationConfig.fields.reduce((acc,field)=>({...acc,[field.key]:""}),{}),errors:integrationConfig.fields.reduce((acc,field)=>({...acc,[field.key]:value=>{if(field.required&&!value)return`${field.label} is required`}}),{}),content:isLoading=>(0,jsx_runtime.jsx)("div",{className:"space-y-4",children:integrationConfig.fields.map(field=>(0,jsx_runtime.jsx)(LemonField.D,{name:field.key,label:field.label,children:(0,jsx_runtime.jsx)(src.DF,{type:field.type,disabled:isLoading})},field.key))}),onSubmit:values=>{integrationConfig.createFn(values,integration=>{onComplete?.(integration.id)})}}:null};function IntegrationChoice(_ref){let{onChange,value,schema,integration,redirectUrl,beforeRedirect}=_ref,{integrationsLoading,integrations}=(0,index_esm.useValues)(integrationsLogic.a),{newGoogleCloudKey}=(0,index_esm.useActions)(integrationsLogic.a),integrationsOfKind=integrations?.filter(x=>x.kind===integration),integrationKind=integrationsOfKind?.find(integration=>integration.id===value);if(!integration)return null;if(integrationsLoading)return(0,jsx_runtime.jsx)(src.yW,{className:"h-10"});let kindName="google-pubsub"==integration?"Google Cloud Pub/Sub":"google-cloud-storage"==integration?"Google Cloud Storage":"google-ads"==integration?"Google Ads":"linkedin-ads"==integration?"LinkedIn Ads":"email"==integration?"Mailjet":(0,utils.fm)(integration);function uploadKey(kind){let input=document.createElement("input");input.type="file",input.accept=".json",input.onchange=async e=>{let file=e.target.files?.[0];file&&newGoogleCloudKey(kind,file,integration=>onChange?.(integration.id))},input.click()}function showIntegrationSetupModal(){if(!integration)return;let modalProps=getIntegrationSetupModalProps({integration:integration,integrationName:kindName,onComplete:onChange});modalProps&&src.dn.openForm(modalProps)}let button=(0,jsx_runtime.jsx)(src.d6,{items:[integrationsOfKind?.length?{items:[...integrationsOfKind?.map(integration=>({icon:jsx_runtime.jsx("img",{src:integration.icon_url,className:"w-6 h-6 rounded"}),onClick:()=>onChange?.(integration.id),active:integration.id===value,label:integration.display_name}))||[]]}:null,["google-pubsub","google-cloud-storage"].includes(integration)?{items:[{onClick:()=>uploadKey(integration),label:"Upload Google Cloud .json key file"}]}:["email"].includes(integration)?{items:[{onClick:showIntegrationSetupModal,label:"Configure Mailjet API key"}]}:{items:[{to:api.ZP.integrations.authorizeUrl({kind:integration,next:redirectUrl}),disableClientSideRouting:!0,onClick:beforeRedirect,label:integrationsOfKind?.length?`Connect to a different integration for ${kindName}`:`Connect to ${kindName}`}]},{items:[{to:urls.j.settings("project-integrations"),label:"Manage integrations",sideIcon:(0,jsx_runtime.jsx)(posthog_icons_es.IconExternal,{})},value?{onClick:()=>onChange?.(null),label:"Clear",sideIcon:(0,jsx_runtime.jsx)(posthog_icons_es.IconX,{})}:null]}],children:integrationKind?(0,jsx_runtime.jsx)(src.Jp,{type:"secondary",children:"Change"}):(0,jsx_runtime.jsxs)(src.Jp,{type:"secondary",children:["Choose ",kindName," connection"]})});return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:integrationKind?(0,jsx_runtime.jsx)(IntegrationView.K,{schema:schema,integration:integrationKind,suffix:button}):button})}}}]);