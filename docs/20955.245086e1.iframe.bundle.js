(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[20955],{"../../frontend/src/lib/components/AppMetrics/AppMetricSummary.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{p:()=>AppMetricSummary});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),lib_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/utils.tsx"),_queries_nodes_DataVisualization_Components_Charts_LineGraph__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/queries/nodes/DataVisualization/Components/Charts/LineGraph.tsx"),_types__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/types.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function AppMetricSummary(_ref){let{name,timeSeries,previousPeriodTimeSeries,description,color,colorIfZero,loading}=_ref,total=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>timeSeries?timeSeries.series.reduce((acc,curr)=>acc+curr.values.reduce((acc,curr)=>acc+curr,0),0):0,[timeSeries]),totalPreviousPeriod=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>previousPeriodTimeSeries?previousPeriodTimeSeries.series.reduce((acc,curr)=>acc+curr.values.reduce((acc,curr)=>acc+curr,0),0):0,[previousPeriodTimeSeries]),diff=(total-totalPreviousPeriod)/totalPreviousPeriod;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)("div",{className:"flex flex-1 flex-col relative border rounded p-3 bg-surface-primary min-w-[16rem]",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.HQ,{info:description,children:name}),loading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.yW,{className:"w-20 h-6 mb-2"}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:"text-right text-2xl text-muted-foreground",children:(0,lib_utils__WEBPACK_IMPORTED_MODULE_2__.Lc)(total)})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:"flex flex-row justify-end items-center gap-2 text-xs text-muted",children:loading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.yW,{className:"w-10 h-4"}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment,{children:diff>0?` (+${(100*diff).toFixed(1)}%)`:` (-${(-(100*diff)).toFixed(1)}%)`})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:"flex-1 mt-2",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:"h-[10rem]",children:loading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.t2,{}):timeSeries?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_queries_nodes_DataVisualization_Components_Charts_LineGraph__WEBPACK_IMPORTED_MODULE_3__.x,{xData:{column:{name:"date",type:{name:"DATE",isNumerical:!1},label:"Date",dataIndex:0},data:timeSeries.labels},yData:timeSeries.series.map(x=>({column:{name:x.name,type:{name:"INTEGER",isNumerical:!0},label:x.name,dataIndex:0},data:x.values,settings:{display:{color:0===total?colorIfZero:color}}})),visualizationType:_types__WEBPACK_IMPORTED_MODULE_4__.Qb.ActionsLineGraph,chartSettings:{showLegend:!1,showTotalRow:!1,showXAxisBorder:!1,showYAxisBorder:!1,showXAxisTicks:!1,leftYAxisSettings:{showTicks:!1,showGridLines:!1}}}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.HQ,{children:"No data"})})})})]})}},"../../frontend/src/lib/components/AppMetrics/AppMetricsFilters.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{f:()=>AppMetricsFilters});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),_posthog_icons__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.30.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),_DateFilter_DateFilter__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/components/DateFilter/DateFilter.tsx"),_appMetricsLogic__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/components/AppMetrics/appMetricsLogic.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function AppMetricsFilters(_ref){let{logicKey}=_ref,logic=(0,_appMetricsLogic__WEBPACK_IMPORTED_MODULE_4__.t)({logicKey}),{params,availableIntervals}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(logic),{setParams}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(logic);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)("div",{className:"flex flex-row gap-2 flex-wrap",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.Yv,{options:[{label:"Hourly",value:"hour",disabledReason:availableIntervals.includes("hour")?void 0:"Please select a smaller date range"},{label:"Daily",value:"day",disabledReason:availableIntervals.includes("day")?void 0:"Please select a smaller date range"}],size:"small",value:params.interval,onChange:value=>setParams({interval:value})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_DateFilter_DateFilter__WEBPACK_IMPORTED_MODULE_3__.f,{dateTo:params.dateTo,dateFrom:params.dateFrom,onChange:(from,to)=>setParams({dateFrom:from||void 0,dateTo:to||void 0}),allowedRollingDateOptions:["days","weeks","months","years"],makeLabel:key=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_1__.IconCalendar,{})," ",key]})})]})}},"../../frontend/src/lib/components/AppMetrics/AppMetricsTrends.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{f:()=>AppMetricsTrends});var _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),_queries_nodes_DataVisualization_Components_Charts_LineGraph__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/src/queries/nodes/DataVisualization/Components/Charts/LineGraph.tsx"),_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/types.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function AppMetricsTrends(_ref){let{appMetricsTrends,loading}=_ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"relative border rounded min-h-[20rem] h-[70vh] bg-white",children:loading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.t2,{}):appMetricsTrends?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_queries_nodes_DataVisualization_Components_Charts_LineGraph__WEBPACK_IMPORTED_MODULE_1__.x,{className:"p-2",xData:{column:{name:"date",type:{name:"DATE",isNumerical:!1},label:"Date",dataIndex:0},data:appMetricsTrends.labels},yData:appMetricsTrends.series.map(x=>({column:{name:x.name,type:{name:"INTEGER",isNumerical:!0},label:x.name,dataIndex:0},data:x.values})),visualizationType:_types__WEBPACK_IMPORTED_MODULE_2__.Qb.ActionsLineGraph,chartSettings:{showLegend:!0,showTotalRow:!1}}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"flex-1 flex items-center justify-center",children:"Missing"})})}},"../../products/messaging/frontend/Campaigns/CampaignScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CampaignScene:()=>CampaignScene,scene:()=>scene});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),NotFound=__webpack_require__("../../frontend/src/lib/components/NotFound/index.tsx"),LemonTabs=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTabs/index.ts"),LogsViewer=__webpack_require__("../../frontend/src/scenes/hog-functions/logs/LogsViewer.tsx"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),SceneContent=__webpack_require__("../../frontend/src/layout/scenes/components/SceneContent.tsx"),SceneDivider=__webpack_require__("../../frontend/src/layout/scenes/components/SceneDivider.tsx"),react=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),colors=__webpack_require__("../../frontend/src/lib/colors.ts"),AppMetricSummary=__webpack_require__("../../frontend/src/lib/components/AppMetrics/AppMetricSummary.tsx"),AppMetricsFilters=__webpack_require__("../../frontend/src/lib/components/AppMetrics/AppMetricsFilters.tsx"),AppMetricsTrends=__webpack_require__("../../frontend/src/lib/components/AppMetrics/AppMetricsTrends.tsx"),appMetricsLogic=__webpack_require__("../../frontend/src/lib/components/AppMetrics/appMetricsLogic.ts"),campaignLogic=__webpack_require__("../../products/messaging/frontend/Campaigns/campaignLogic.ts"),HogFlowSteps=__webpack_require__("../../products/messaging/frontend/Campaigns/hogflows/steps/HogFlowSteps.tsx"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let CAMPAIGN_METRICS_INFO={succeeded:{name:"Success",description:"Total number of events processed successfully",color:(0,colors.cM)("success")},failed:{name:"Failure",description:"Total number of events that had errors during processing",color:(0,colors.cM)("danger")},filtered:{name:"Filtered",description:"Total number of events that were filtered out",color:(0,colors.cM)("muted")},disabled_permanently:{name:"Disabled",description:"Total number of events that were skipped due to the destination being permanently disabled (due to prolonged issues with the destination)",color:(0,colors.cM)("danger")},rate_limited:{name:"Rate Limited",description:"Total number of events that were rate limited",color:(0,colors.cM)("danger")},triggered:{name:"Triggered",description:"Total number of events that were triggered",color:(0,colors.cM)("success")}};function CampaignMetrics(_ref){var _params$instanceId;let{id}=_ref,logicKey=`hog-flow-metrics-${id}`,logic=(0,appMetricsLogic.t)({logicKey,loadOnChanges:!0,forceParams:{appSource:"hog_flow",appSourceId:id,breakdownBy:"metric_name"}}),{campaign,hogFunctionTemplatesById}=(0,index_esm.useValues)((0,campaignLogic.yt)({id})),{appMetricsTrendsLoading,getSingleTrendSeries,appMetricsTrends,params}=(0,index_esm.useValues)(logic),{setParams}=(0,index_esm.useActions)(logic),modifiedAppMetricsTrends=(0,react.useMemo)(()=>appMetricsTrends?{...appMetricsTrends,series:appMetricsTrends.series.map(series=>({...series,color:CAMPAIGN_METRICS_INFO[series.name]?.color}))}:null,[appMetricsTrends]);return(0,jsx_runtime.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-row gap-2 flex-wrap justify-between",children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(src.Yv,{size:"small",options:[{title:"Workflow",options:[{label:"Overview",value:null}]},{title:"Workflow steps",options:campaign.actions.map(action=>{let Step=(0,HogFlowSteps.d)(action,hogFunctionTemplatesById);return{label:(0,jsx_runtime.jsxs)("span",{className:"flex items-center gap-1",children:[Step?.icon," ",action.name]}),value:action.id}})}],value:null!==(_params$instanceId=params.instanceId)&&void 0!==_params$instanceId?_params$instanceId:null,onChange:value=>setParams({...params,instanceId:null!=value?value:void 0})})}),(0,jsx_runtime.jsx)(AppMetricsFilters.f,{logicKey:logicKey})]}),(0,jsx_runtime.jsx)("div",{className:"flex flex-row gap-2 flex-wrap justify-center",children:["succeeded","failed","filtered","disabled_permanently"].map(key=>(0,jsx_runtime.jsx)(AppMetricSummary.p,{name:CAMPAIGN_METRICS_INFO[key].name,description:CAMPAIGN_METRICS_INFO[key].description,loading:appMetricsTrendsLoading,timeSeries:getSingleTrendSeries(key),previousPeriodTimeSeries:getSingleTrendSeries(key,!0),color:CAMPAIGN_METRICS_INFO[key].color,colorIfZero:(0,colors.cM)("muted")},key))}),(0,jsx_runtime.jsx)(AppMetricsTrends.f,{appMetricsTrends:modifiedAppMetricsTrends,loading:appMetricsTrendsLoading})]})}var SceneTitleSection=__webpack_require__("../../frontend/src/layout/scenes/components/SceneTitleSection.tsx");let CampaignSceneHeader=function(){let props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},logic=(0,campaignLogic.yt)(props),{campaign,campaignChanged,isCampaignSubmitting,campaignLoading,campaignHasErrors}=(0,index_esm.useValues)(logic),{saveCampaignPartial,submitCampaign,discardChanges,setCampaignValue}=(0,index_esm.useActions)(logic),isSavedCampaign=props.id&&"new"!==props.id;return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(SceneTitleSection.s,{name:campaign?.name,description:campaign?.description,resourceType:{type:"messaging"},canEdit:!0,onNameChange:name=>setCampaignValue("name",name),onDescriptionChange:description=>setCampaignValue("description",description),isLoading:campaignLoading,renameDebounceMs:200,actions:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[isSavedCampaign&&(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(src.Jp,{type:"primary",onClick:()=>saveCampaignPartial({status:campaign?.status==="draft"?"active":"draft"}),size:"small",loading:campaignLoading,disabledReason:campaignChanged?"Save changes first":void 0,children:campaign?.status==="draft"?"Enable":"Disable"})}),isSavedCampaign&&campaignChanged&&(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(src.Jp,{"data-attr":"discard-campaign-changes",type:"secondary",onClick:()=>discardChanges(),size:"small",children:"Discard changes"})}),(0,jsx_runtime.jsx)(src.Jp,{type:"primary",size:"small",htmlType:"submit",form:"campaign",onClick:submitCampaign,loading:isCampaignSubmitting,disabledReason:campaignHasErrors?"Some fields still need work":campaignChanged?void 0:"No changes to save",children:"new"===props.id?"Create":"Save"})]})})})};__webpack_require__("../../node_modules/.pnpm/@xyflow+react@12.6.0_@types+react@17.0.52_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@xyflow/react/dist/style.css");var esm=__webpack_require__("../../node_modules/.pnpm/@xyflow+react@12.6.0_@types+react@17.0.52_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@xyflow/react/dist/esm/index.js"),themeLogic=__webpack_require__("../../frontend/src/layout/navigation-3000/themeLogic.ts"),hogFlowEditorLogic=__webpack_require__("../../products/messaging/frontend/Campaigns/hogflows/hogFlowEditorLogic.tsx"),clsx_m=__webpack_require__("../../node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.30.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),hogFunctionTemplateListLogic=__webpack_require__("../../frontend/src/scenes/hog-functions/list/hogFunctionTemplateListLogic.tsx"),HogFunctionStatusTag=__webpack_require__("../../frontend/src/scenes/hog-functions/misc/HogFunctionStatusTag.tsx");let ACTION_NODES_TO_SHOW=[{type:"function_email",name:"Email",description:"Send an email to the user.",config:{template_id:"template-email",inputs:{}}},{type:"function_sms",name:"SMS",description:"Send an SMS to the user.",config:{template_id:"template-twilio",inputs:{}}},{type:"function",name:"Slack",description:"Send a Slack message to the user.",config:{template_id:"template-slack",inputs:{}}},{type:"function",name:"Webhook",description:"Send a Webhook to the user.",config:{template_id:"template-webhook",inputs:{}}}],DELAY_NODES_TO_SHOW=[{type:"delay",name:"Delay",description:"Wait for a specified duration.",config:{delay_duration:"10m"}},{type:"wait_until_time_window",name:"Wait until window",description:"Wait until a specified time window.",config:{timezone:null,day:"any",time:"any"}},{type:"wait_until_condition",name:"Wait until condition",description:"Wait until a condition is met or a duration has passed.",branchEdges:1,config:{condition:{filters:null},max_wait_duration:"5m"}}],LOGIC_NODES_TO_SHOW=[{type:"conditional_branch",name:"Conditional branch",description:"Branch using conditions on event or person properties.",branchEdges:1,config:{conditions:[{filters:{events:[{id:"$pageview",name:"$pageview",type:"events"}]}}]}},{type:"random_cohort_branch",name:"Cohort branch",description:"Randomly branch off based on cohort percentages.",branchEdges:1,config:{cohorts:[{percentage:50}]}}],POSTHOG_NODES_TO_SHOW=[{type:"function",name:"Capture event",description:"Capture an event to PostHog.",config:{template_id:"template-posthog-capture",inputs:{}}},{type:"function",name:"Update person property",description:"Set properties of a person in PostHog.",config:{template_id:"template-posthog-update-person-properties",inputs:{}}},{type:"function",name:"Set group property",description:"Set properties of a group in PostHog.",config:{template_id:"template-posthog-group-identify",inputs:{}}}],TEMPLATE_IDS_AT_TOP_LEVEL=[...ACTION_NODES_TO_SHOW.map(action=>action.config.template_id),...DELAY_NODES_TO_SHOW.map(action=>action.config.template_id),...LOGIC_NODES_TO_SHOW.map(action=>action.config.template_id),...POSTHOG_NODES_TO_SHOW.map(action=>action.config.template_id)].filter(t=>!!t);function HogFlowEditorToolbarNode(_ref){let{action,onDragStart:onDragStartProp,children}=_ref,{setNewDraggingNode}=(0,index_esm.useActions)(hogFlowEditorLogic.s),step=(0,HogFlowSteps.i)(action);return step?(0,jsx_runtime.jsx)("div",{draggable:!0,onDragStart:event=>{setNewDraggingNode(action),event.dataTransfer.setData("application/reactflow",action.type),event.dataTransfer.effectAllowed="move",onDragStartProp?.(event)},children:(0,jsx_runtime.jsx)(src.Jp,{icon:(0,jsx_runtime.jsx)("span",{style:{color:step.color},children:step.icon}),sideIcon:(0,jsx_runtime.jsx)(posthog_icons_es.IconDrag,{}),fullWidth:!0,children:null!=children?children:action.name})}):null}let customFilterFunction=template=>!("destination"!==template.type||TEMPLATE_IDS_AT_TOP_LEVEL.includes(template.id)||"destination"===template.type&&template.inputs_schema?.some(input=>input.secret))&&"coming_soon"!==template.status;function HogFunctionTemplatesChooser(){var _filters$search;let logic=(0,hogFunctionTemplateListLogic.T)({type:"destination",customFilterFunction}),{loading,filteredTemplates,filters}=(0,index_esm.useValues)(logic),{loadHogFunctionTemplates,setFilters}=(0,index_esm.useActions)(logic),[popoverOpen,setPopoverOpen]=(0,react.useState)(!1);return(0,react.useEffect)(()=>{loadHogFunctionTemplates()},[loadHogFunctionTemplates]),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(src.Qw,{closeOnClickInside:!1,visible:popoverOpen,onClickOutside:()=>setPopoverOpen(!1),placement:"bottom-end",overlay:(0,jsx_runtime.jsxs)("div",{className:"flex flex-col w-100 h-120 flex-1 overflow-hidden gap-1",children:[(0,jsx_runtime.jsx)(src.DF,{placeholder:"Search...",value:null!==(_filters$search=filters.search)&&void 0!==_filters$search?_filters$search:"",onChange:e=>setFilters({...filters,search:e}),autoFocus:!0}),loading?(0,jsx_runtime.jsx)(src.t2,{}):(0,jsx_runtime.jsx)("ul",{className:"overflow-y-auto flex-1",children:filteredTemplates.map(template=>(0,jsx_runtime.jsx)("li",{children:(0,jsx_runtime.jsx)(HogFlowEditorToolbarNode,{action:{type:"function",name:template.name,description:"string"==typeof template.description?template.description:"",config:{template_id:template.id,inputs:{}}},children:(0,jsx_runtime.jsxs)("div",{className:"py-1 flex items-center gap-1 flex-1",children:[(0,jsx_runtime.jsxs)("div",{className:"flex-1",children:[(0,jsx_runtime.jsx)("div",{children:template.name}),(0,jsx_runtime.jsx)("div",{className:"text-xs text-muted",children:template.description})]}),template.status&&(0,jsx_runtime.jsx)(HogFunctionStatusTag.B,{status:template.status})]})})},template.type))})]}),children:(0,jsx_runtime.jsx)(src.Jp,{fullWidth:!0,onClick:()=>setPopoverOpen(!popoverOpen),children:"More"})})})}function HogFlowEditorPanelBuild(){return(0,jsx_runtime.jsxs)("div",{className:"flex overflow-y-auto flex-col gap-px p-2",children:[(0,jsx_runtime.jsxs)("span",{className:"flex gap-2 text-sm font-semibold mt-2 items-center",children:["Dispatch ",(0,jsx_runtime.jsx)(src.p2,{className:"flex-1"})]}),ACTION_NODES_TO_SHOW.map((node,index)=>(0,jsx_runtime.jsx)(HogFlowEditorToolbarNode,{action:node},`${node.type}-${index}`)),(0,jsx_runtime.jsx)(HogFunctionTemplatesChooser,{}),(0,jsx_runtime.jsxs)("span",{className:"flex gap-2 text-sm font-semibold mt-2 items-center",children:["Delays ",(0,jsx_runtime.jsx)(src.p2,{className:"flex-1"})]}),DELAY_NODES_TO_SHOW.map((action,index)=>(0,jsx_runtime.jsx)(HogFlowEditorToolbarNode,{action:action},`${action.type}-${index}`)),(0,jsx_runtime.jsxs)("span",{className:"flex gap-2 text-sm font-semibold mt-2 items-center",children:["Audience split ",(0,jsx_runtime.jsx)(src.p2,{className:"flex-1"})]}),LOGIC_NODES_TO_SHOW.map((action,index)=>(0,jsx_runtime.jsx)(HogFlowEditorToolbarNode,{action:action},`${action.type}-${index}`)),(0,jsx_runtime.jsxs)("span",{className:"flex gap-2 text-sm font-semibold mt-2 items-center",children:["PostHog actions ",(0,jsx_runtime.jsx)(src.p2,{className:"flex-1"})]}),POSTHOG_NODES_TO_SHOW.map((action,index)=>(0,jsx_runtime.jsx)(HogFlowEditorToolbarNode,{action:action},`${action.type}-${index}`))]})}var ScrollableShadows=__webpack_require__("../../frontend/src/lib/components/ScrollableShadows/ScrollableShadows.tsx"),optOutCategoriesLogic=__webpack_require__("../../products/messaging/frontend/OptOuts/optOutCategoriesLogic.ts");let CategorySelect=_ref=>{let{onChange,value}=_ref,{categories,categoriesLoading}=(0,index_esm.useValues)((0,optOutCategoriesLogic.O)());return(0,jsx_runtime.jsx)(src.Yv,{size:"small",type:"tertiary",onChange:onChange,value:value,loading:categoriesLoading,disabledReason:!categoriesLoading&&!categories.length&&"Configure message categories in the opt-outs section",options:[{title:"Marketing",options:categories.filter(category=>"marketing"===category.category_type).map(category=>({label:category.name,value:category.id}))},{title:"Transactional",options:categories.filter(category=>"transactional"===category.category_type).map(category=>({label:category.name,value:category.id}))}],placeholder:"Select message type"})};var HogFlowFilters=__webpack_require__("../../products/messaging/frontend/Campaigns/hogflows/filters/HogFlowFilters.tsx"),types=__webpack_require__("../../products/messaging/frontend/Campaigns/hogflows/steps/types.ts");function HogFlowEditorPanelBuildDetail(){var _action$filters,_actionFilters$events,_actionFilters$proper,_actionFilters$action,_action$filters2;let{selectedNode,categories,categoriesLoading}=(0,index_esm.useValues)(hogFlowEditorLogic.s),{setCampaignAction}=(0,index_esm.useActions)(hogFlowEditorLogic.s),Step=(0,HogFlowSteps.i)(selectedNode?.data);if(!selectedNode)return null;let action=selectedNode.data,actionFilters=null!==(_action$filters=action.filters)&&void 0!==_action$filters?_action$filters:{},numberOfActionFilters=(null!==(_actionFilters$events=actionFilters.events?.length)&&void 0!==_actionFilters$events?_actionFilters$events:0)+(null!==(_actionFilters$proper=actionFilters.properties?.length)&&void 0!==_actionFilters$proper?_actionFilters$proper:0)+(null!==(_actionFilters$action=actionFilters.actions?.length)&&void 0!==_actionFilters$action?_actionFilters$action:0);return(0,jsx_runtime.jsxs)("div",{className:"flex flex-col h-full overflow-hidden",children:[(0,jsx_runtime.jsx)(ScrollableShadows.D,{direction:"vertical",className:"flex-1 min-h-0",innerClassName:"flex flex-col gap-2 p-3",styledScrollbars:!0,children:Step?.renderConfiguration(selectedNode)}),(0,types.Os)(action)&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(src.p2,{className:"my-0"}),(0,jsx_runtime.jsx)("div",{className:"flex flex-col px-2 py-1",children:(0,jsx_runtime.jsxs)(src.HQ,{htmlFor:"Message category",className:"flex gap-2 justify-between items-center",children:[(0,jsx_runtime.jsx)("span",{children:"Message category"}),(0,jsx_runtime.jsxs)("div",{className:"flex gap-2",children:[!categoriesLoading&&!categories.length&&(0,jsx_runtime.jsx)(src.Jp,{to:urls.j.messaging("opt-outs"),targetBlank:!0,type:"secondary",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconExternal,{}),children:"Configure"}),(0,jsx_runtime.jsx)(CategorySelect,{onChange:categoryId=>{setCampaignAction(action.id,{...action,config:{...action.config,message_category_id:categoryId}})},value:action.config.message_category_id})]})]})})]}),!["trigger","exit"].includes(action.type)&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(src.p2,{className:"my-0"}),(0,jsx_runtime.jsx)("div",{className:"flex-0",children:(0,jsx_runtime.jsx)(src.JL,{embedded:!0,panels:[{key:"filters",header:{children:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("span",{className:"flex-1",children:"Conditions"}),(0,jsx_runtime.jsx)(src.Mo.Number,{count:numberOfActionFilters,showZero:!1})]})},content:(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("p",{className:"mb-0",children:"Add conditions to the step. If these conditions aren't met, the user will skip this step and continue to the next one."}),(0,jsx_runtime.jsx)(HogFlowFilters.M,{actionId:action.id,filters:null!==(_action$filters2=action.filters)&&void 0!==_action$filters2?_action$filters2:{},setFilters:filters=>setCampaignAction(action.id,{...action,filters}),buttonCopy:"Add filter conditions"})]})})},{key:"on_error",header:{children:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)("span",{className:"flex-1",children:"Error handling"})})},content:(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("p",{children:"What to do if this step fails (e.g. message could not be sent). By default, the user will continue to the next step."}),(0,jsx_runtime.jsx)(src.Yv,{options:[{value:"continue",label:"Continue to next step"},{value:"abort",label:"Exit the campaign"}],value:action.on_error||"continue",onChange:value=>setCampaignAction(action.id,{...action,on_error:value})})]})})}]})})]})]})}var icons=__webpack_require__("../../frontend/src/lib/lemon-ui/icons/index.ts");let ACTION_REGEX=/\[Action:([a-zA-Z0-9_-]+)\]/g,renderWorkflowLogMessage=(campaign,message)=>{let parts=message.split(ACTION_REGEX),elements=[];for(let i=0;i<parts.length;i++)if(i%2==0)parts[i]&&elements.push(parts[i]);else{let actionId=parts[i],action=campaign.actions.find(action=>action.id===actionId),step=action?(0,HogFlowSteps.d)(action,{}):void 0,stepName=action?.name;actionId&&elements.push((0,jsx_runtime.jsxs)(src.rU,{className:"rounded p-1 -m-1 bg-border text-bg-primary",to:urls.j.messagingCampaign(campaign.id,"workflow")+`?node=${actionId}&mode=logs`,children:[step?.icon&&(0,jsx_runtime.jsx)("span",{className:"mr-1",children:step.icon}),stepName]}))}return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:elements})};function HogFlowEditorPanelLogs(){let{campaign,selectedNode}=(0,index_esm.useValues)(hogFlowEditorLogic.s),actionId=selectedNode?.data.id;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"border-b",children:(0,jsx_runtime.jsx)(src.Jp,{to:urls.j.messagingCampaign(campaign.id,"logs"),size:"xsmall",sideIcon:(0,jsx_runtime.jsx)(icons.UE,{}),children:"Click here to open in full log viewer"})}),(0,jsx_runtime.jsx)("div",{className:"p-2 flex flex-col gap-2 overflow-y-auto",children:(0,jsx_runtime.jsx)(LogsViewer.FW,{logicKey:`hog-flow-editor-panel-${actionId||"all"}`,instanceLabel:"workflow run",sourceType:"hog_flow",sourceId:campaign.id,groupByInstanceId:!selectedNode,searchGroups:actionId?[`[Action:${actionId}]`]:void 0,renderMessage:m=>renderWorkflowLogMessage(campaign,m)})})]})}var LineGraph=__webpack_require__("../../frontend/src/queries/nodes/DataVisualization/Components/Charts/LineGraph.tsx"),src_types=__webpack_require__("../../frontend/src/types.ts");function HogFlowEditorPanelMetrics(){let{selectedNode,campaign}=(0,index_esm.useValues)(hogFlowEditorLogic.s),{loadActionMetricsById}=(0,index_esm.useActions)(hogFlowEditorLogic.s),actionId=selectedNode?.data.id,id=(0,react.useMemo)(()=>actionId?[campaignLogic.mg,campaignLogic.fq].includes(actionId)?"":actionId:void 0,[actionId]),logicKey=`hog-flow-metrics-${campaign.id}`,metricName=(0,react.useMemo)(()=>actionId===campaignLogic.mg?["triggered","rate_limited","disabled_permanently","filtered"]:actionId===campaignLogic.fq?["succeeded","failed"]:void 0,[actionId]),logic=(0,appMetricsLogic.t)({logicKey,loadOnChanges:!0,forceParams:{appSource:"hog_flow",appSourceId:campaign.id,instanceId:id,breakdownBy:"metric_name",metricName}}),{appMetricsTrendsLoading,appMetricsTrends,params,currentTeam,getDateRangeAbsolute}=(0,index_esm.useValues)(logic);return(0,react.useEffect)(()=>{var _currentTeam$timezone;loadActionMetricsById({appSource:params.appSource,appSourceId:params.appSourceId,dateFrom:getDateRangeAbsolute().dateFrom.toISOString(),dateTo:getDateRangeAbsolute().dateTo.toISOString()},null!==(_currentTeam$timezone=currentTeam?.timezone)&&void 0!==_currentTeam$timezone?_currentTeam$timezone:"UTC")},[params.appSource,params.appSourceId,params.dateFrom,params.dateTo,currentTeam?.timezone,loadActionMetricsById,getDateRangeAbsolute]),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"border-b",children:(0,jsx_runtime.jsx)(src.Jp,{to:urls.j.messagingCampaign(campaign.id,"metrics"),size:"xsmall",sideIcon:(0,jsx_runtime.jsx)(icons.UE,{}),children:"Click here to open in full metrics viewer"})}),(0,jsx_runtime.jsxs)("div",{className:"p-2 flex flex-col gap-2 overflow-y-auto",children:[(0,jsx_runtime.jsx)("div",{className:"flex flex-row gap-2 flex-wrap justify-end",children:(0,jsx_runtime.jsx)(AppMetricsFilters.f,{logicKey:logicKey})}),(0,jsx_runtime.jsx)("div",{className:"relative border rounded min-h-[20rem] bg-white flex flex-1 flex-col",children:appMetricsTrendsLoading?(0,jsx_runtime.jsx)("div",{className:"flex-1 flex items-center justify-center p-8",children:(0,jsx_runtime.jsx)(src.t2,{})}):appMetricsTrends?(0,jsx_runtime.jsx)(LineGraph.x,{className:"p-2",xData:{column:{name:"date",type:{name:"DATE",isNumerical:!1},label:"Date",dataIndex:0},data:appMetricsTrends.labels},yData:appMetricsTrends.series.map(x=>({column:{name:x.name,type:{name:"INTEGER",isNumerical:!0},label:x.name,dataIndex:0},settings:{display:{color:CAMPAIGN_METRICS_INFO[x.name]?.color}},data:x.values})),visualizationType:src_types.Qb.ActionsLineGraph,chartSettings:{showLegend:!0,showTotalRow:!1}}):(0,jsx_runtime.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,jsx_runtime.jsx)("div",{className:"text-muted",children:"No data"})})})]})]})}var kea_forms_lib=__webpack_require__("../../node_modules/.pnpm/kea-forms@3.2.0_kea@3.1.7_react@18.2.0_/node_modules/kea-forms/lib/index.js"),TZLabel=__webpack_require__("../../frontend/src/lib/components/TZLabel/index.tsx"),LemonField=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonField/index.ts"),person_utils=__webpack_require__("../../frontend/src/scenes/persons/person-utils.ts"),fast_deep_equal=__webpack_require__("../../node_modules/.pnpm/fast-deep-equal@3.1.3/node_modules/fast-deep-equal/index.js"),fast_deep_equal_default=__webpack_require__.n(fast_deep_equal),kea_loaders_lib=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.7_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),api=__webpack_require__("../../frontend/src/lib/api.ts"),dayjs=__webpack_require__("../../frontend/src/lib/dayjs.ts"),queries_query=__webpack_require__("../../frontend/src/queries/query.ts"),schema_general=__webpack_require__("../../frontend/src/queries/schema/schema-general.ts"),queries_utils=__webpack_require__("../../frontend/src/queries/utils.ts");let hogFlowEditorTestLogic=(0,index_esm.kea)([(0,index_esm.path)(key=>["products","messaging","frontend","Campaigns","hogflows","actions","workflowTestLogic",key]),(0,index_esm.props)({}),(0,index_esm.key)(props=>`${props.id}`),(0,index_esm.connect)(props=>({values:[(0,campaignLogic.yt)(props),["campaign","campaignSanitized","triggerAction"],hogFlowEditorLogic.s,["selectedNodeId"]],actions:[hogFlowEditorLogic.s,["setSelectedNodeId"]]})),(0,index_esm.actions)({setTestResult:testResult=>({testResult}),setTestResultMode:mode=>({mode}),loadSampleGlobals:payload=>({eventId:payload?.eventId}),setSampleGlobalsError:error=>({error}),cancelSampleGlobalsLoading:!0,receiveExampleGlobals:globals=>({globals}),setNextActionId:nextActionId=>({nextActionId})}),(0,index_esm.reducers)({testResult:[null,{setTestResult:(_,_ref)=>{let{testResult}=_ref;return testResult}}],testResultMode:["raw",{setTestResultMode:(_,_ref2)=>{let{mode}=_ref2;return mode}}],sampleGlobalsError:[null,{loadSampleGlobals:()=>null,setSampleGlobalsError:(_,_ref3)=>{let{error}=_ref3;return error}}],fetchCancelled:[!1,{loadSampleGlobals:()=>!1,cancelSampleGlobalsLoading:()=>!0}],nextActionId:[null,{setNextActionId:(_,_ref4)=>{let{nextActionId}=_ref4;return nextActionId}}]}),(0,kea_loaders_lib.loaders)(_ref5=>{let{actions,values}=_ref5;return{sampleGlobals:[null,{loadSampleGlobals:async()=>{var _values$campaign$name,_e$message;if(!values.shouldLoadSampleGlobals)return null;let errorMessage="No events match these filters in the last 30 days. Showing an example $pageview event instead.";try{let query={kind:schema_general.OH.EventsQuery,fixedProperties:[values.matchingFilters],select:["*","person"],after:"-7d",limit:1,orderBy:["timestamp DESC"],modifiers:{personsOnEventsMode:"person_id_no_override_properties_on_events"}},response=await (0,queries_query.jr)(query);if(!response?.results?.[0])throw Error(errorMessage);let event=response.results[0][0],person=response.results[0][1];return{event:{uuid:event.uuid,distinct_id:event.distinct_id,timestamp:event.timestamp,elements_chain:event.elements_chain||"",url:event.url||"",event:event.event,properties:event.properties},person:person?{id:person.id,properties:person.properties,name:person.name||"Unknown person",url:`${window.location.origin}/person/${person.id}`}:void 0,groups:{},project:{id:values.campaign.team_id,name:"Default project",url:`${window.location.origin}/project/${values.campaign.team_id}`},source:{name:null!==(_values$campaign$name=values.campaign.name)&&void 0!==_values$campaign$name?_values$campaign$name:"Unnamed",url:window.location.href.split("#")[0]}}}catch(e){return e.message?.includes("breakpoint")||actions.setSampleGlobalsError(null!==(_e$message=e.message)&&void 0!==_e$message?_e$message:errorMessage),null}}}]}}),(0,index_esm.selectors)(()=>({shouldLoadSampleGlobals:[s=>[s.triggerAction],triggerAction=>!!(triggerAction&&"event"===triggerAction.config.type)],matchingFilters:[s=>[s.triggerAction],triggerAction=>{var _triggerActionConfig$,_triggerActionConfig$2,_triggerActionConfig$3,_event$properties,_action$properties,_triggerActionConfig$4;if(!triggerAction||"event"!==triggerAction.config.type)return{type:src_types.J2.And,values:[]};let triggerActionConfig=triggerAction.config,seriesProperties={type:src_types.J2.Or,values:[]},properties={type:src_types.J2.And,values:[seriesProperties]},allPossibleEventFilters=null!==(_triggerActionConfig$=triggerActionConfig.filters?.events)&&void 0!==_triggerActionConfig$?_triggerActionConfig$:[],allPossibleActionFilters=null!==(_triggerActionConfig$2=triggerActionConfig.filters?.actions)&&void 0!==_triggerActionConfig$2?_triggerActionConfig$2:[];for(let event of allPossibleEventFilters){let eventProperties=[...null!==(_event$properties=event.properties)&&void 0!==_event$properties?_event$properties:[]];event.id&&eventProperties.push({type:src_types.FT.HogQL,key:(0,queries_utils.zP)`event = ${event.id}`}),0===eventProperties.length&&eventProperties.push({type:src_types.FT.HogQL,key:"true"}),seriesProperties.values.push({type:src_types.J2.And,values:eventProperties})}for(let action of allPossibleActionFilters){let actionProperties=[...null!==(_action$properties=action.properties)&&void 0!==_action$properties?_action$properties:[]];action.id&&actionProperties.push({type:src_types.FT.HogQL,key:(0,queries_utils.zP)`matchesAction(${parseInt(action.id)})`}),seriesProperties.values.push({type:src_types.J2.And,values:actionProperties})}if((null!==(_triggerActionConfig$3=triggerActionConfig.filters?.properties?.length)&&void 0!==_triggerActionConfig$3?_triggerActionConfig$3:0)>0){let globalProperties={type:src_types.J2.And,values:[]};for(let property of null!==(_triggerActionConfig$4=triggerActionConfig.filters?.properties)&&void 0!==_triggerActionConfig$4?_triggerActionConfig$4:[])globalProperties.values.push(property);properties.values.push(globalProperties)}return properties},{resultEqualityCheck:fast_deep_equal_default()}]})),(0,kea_forms_lib.forms)(_ref6=>{let{actions,values}=_ref6;return{testInvocation:{defaults:{mock_async_functions:!0},errors:data=>{let errors={};try{JSON.parse(JSON.stringify(data.globals))}catch{errors.globals="Invalid JSON"}return errors},submit:async testInvocation=>{try{var _values$selectedNodeI;let apiResponse=await api.ZP.hogFlows.createTestInvocation(values.campaign.id,{configuration:values.campaignSanitized,globals:JSON.parse(testInvocation.globals),mock_async_functions:testInvocation.mock_async_functions,current_action_id:null!==(_values$selectedNodeI=values.selectedNodeId)&&void 0!==_values$selectedNodeI?_values$selectedNodeI:void 0}),result={...apiResponse,logs:apiResponse.logs?.map(log=>({...log,instanceId:"test",timestamp:dayjs.Bv(log.timestamp)}))};actions.setTestResult(result);let nextActionId=result.nextActionId;return nextActionId&&nextActionId!==values.selectedNodeId&&actions.setNextActionId(nextActionId),values.testInvocation}catch(error){throw console.error("Workflow test error:",error),src.UJ.error("Error testing workflow"),error}}}}}),(0,index_esm.listeners)(_ref7=>{let{values,actions}=_ref7;return{loadSampleGlobalsSuccess:()=>{actions.setTestInvocationValue("globals",JSON.stringify(values.sampleGlobals,null,2))},cancelSampleGlobalsLoading:()=>{}}}),(0,index_esm.afterMount)(_ref8=>{var _values$campaign$name2;let{actions,values}=_ref8;actions.loadSampleGlobalsSuccess({event:{uuid:(0,utils.Vj)(),distinct_id:(0,utils.Vj)(),timestamp:(0,dayjs.Bv)().toISOString(),elements_chain:"",url:`${window.location.origin}/project/1/events/`,event:"$pageview",properties:{$current_url:window.location.href.split("#")[0],$browser:"Chrome",this_is_an_example_event:!0}},person:{id:(0,utils.Vj)(),properties:{email:"example@posthog.com"},name:"Example person",url:`${window.location.origin}/person/${(0,utils.Vj)()}`},groups:{},project:{id:1,name:"Default project",url:`${window.location.origin}/project/1`},source:{name:null!==(_values$campaign$name2=values.campaign.name)&&void 0!==_values$campaign$name2?_values$campaign$name2:"Unnamed",url:window.location.href.split("#")[0]}})})]);function HogFlowEditorPanelTest(){var _testResult$logs;let{campaign,selectedNode}=(0,index_esm.useValues)(hogFlowEditorLogic.s),{setSelectedNodeId}=(0,index_esm.useActions)(hogFlowEditorLogic.s),{logicProps}=(0,index_esm.useValues)(campaignLogic.yt),{sampleGlobals,sampleGlobalsLoading,isTestInvocationSubmitting,testResult,shouldLoadSampleGlobals,nextActionId}=(0,index_esm.useValues)(hogFlowEditorTestLogic(logicProps)),{submitTestInvocation,setTestResult,loadSampleGlobals}=(0,index_esm.useActions)(hogFlowEditorTestLogic(logicProps)),display=(0,person_utils.y)(sampleGlobals?.person),url=urls.j.personByDistinctId(sampleGlobals?.event?.distinct_id||"");return((0,react.useEffect)(()=>{setTestResult(null)},[selectedNode?.id,setTestResult]),selectedNode)?(0,jsx_runtime.jsxs)(kea_forms_lib.Form,{logic:hogFlowEditorTestLogic,props:logicProps,formKey:"testInvocation",enableFormOnSubmit:!0,className:"flex overflow-hidden flex-col flex-1",children:[(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 items-center p-2",children:[(0,jsx_runtime.jsx)(LemonField.D,{name:"mock_async_functions",className:"flex-1",children:_ref=>{let{value,onChange}=_ref;return(0,jsx_runtime.jsx)(src.f4,{onChange:v=>onChange(!v),checked:!value,"data-attr":"toggle-workflow-test-panel-new-mocking",className:"whitespace-nowrap",size:"small",bordered:!0,label:(0,jsx_runtime.jsx)(src.u,{title:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"When disabled, message deliveries and other async actions will not be called. Instead they will be mocked out and logged."}),children:(0,jsx_runtime.jsxs)("span",{className:"flex gap-2",children:["Make real HTTP requests",(0,jsx_runtime.jsx)(posthog_icons_es.IconInfo,{className:"text-lg"})]})})})}}),testResult?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"flex-1"}),(0,jsx_runtime.jsx)(src.Jp,{type:"secondary",onClick:()=>setTestResult(null),loading:isTestInvocationSubmitting,size:"small","data-attr":"clear-workflow-test-panel-new-result",children:"Clear test result"}),nextActionId&&(0,jsx_runtime.jsx)(src.Jp,{type:"primary",onClick:()=>setSelectedNodeId(nextActionId),icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconPlayFilled,{}),loading:isTestInvocationSubmitting,size:"small","data-attr":"continue-workflow-test-panel-new",children:"Go to next step"})]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"flex-1"}),(0,jsx_runtime.jsx)(src.Jp,{type:"primary","data-attr":"test-workflow-panel-new",onClick:()=>submitTestInvocation(),icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconPlay,{}),loading:isTestInvocationSubmitting,disabledReason:sampleGlobals?void 0:"Must load event to run test",size:"small",children:"Run test"})]})]}),(0,jsx_runtime.jsx)(src.p2,{className:"my-0"}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-col flex-1 overflow-y-auto",children:[(0,jsx_runtime.jsx)("div",{className:"flex-0",children:(0,jsx_runtime.jsx)(src.JL,{embedded:!0,panels:[{key:"event",header:{children:sampleGlobalsLoading?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Loading test event... ",(0,jsx_runtime.jsx)(src.$j,{})]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Test event: ",sampleGlobals?.event?.event," "]})},className:"bg-surface-secondary",content:(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsxs)("div",{className:"bg-surface-secondary",children:[(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,jsx_runtime.jsx)(src.YY,{name:display}),(0,jsx_runtime.jsxs)("div",{className:"flex-1",children:[sampleGlobals?.person?(0,jsx_runtime.jsx)(src.rU,{to:url,className:"flex gap-2 items-center",children:(0,jsx_runtime.jsx)("span",{className:"font-semibold",children:display})}):(0,jsx_runtime.jsx)("span",{className:"text-muted",children:"Loading..."})," ",(0,jsx_runtime.jsx)("span",{className:"text-muted",children:"performed"})," ",(0,jsx_runtime.jsx)("span",{className:"space-y-1 font-semibold text-md",children:sampleGlobals?.event.event})," ",sampleGlobals?.event.timestamp&&(0,jsx_runtime.jsx)(TZLabel.w,{time:sampleGlobals.event.timestamp})]}),(0,jsx_runtime.jsx)(src.Jp,{type:"secondary",onClick:()=>loadSampleGlobals(),tooltip:"Find the last event matching the trigger event filters, and use it to populate the globals for a test run.",disabledReason:shouldLoadSampleGlobals?void 0:"Must configure trigger event",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconRedo,{}),size:"small",children:"Load new event"})]}),sampleGlobals?.event.properties&&Object.keys(sampleGlobals.event.properties).length>0&&(0,jsx_runtime.jsxs)("div",{className:"mt-3",children:[(0,jsx_runtime.jsx)("div",{className:"mb-2 text-sm",children:"Event properties"}),(0,jsx_runtime.jsx)("div",{className:"overflow-auto max-h-32 rounded border bg-surface-primary",children:(0,jsx_runtime.jsx)("pre",{className:"p-2 text-xs whitespace-pre-wrap text-muted",children:JSON.stringify(sampleGlobals.event.properties,null,2)})})]})]})})}]})}),(0,jsx_runtime.jsx)(src.p2,{className:"my-0"}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-col flex-1 gap-2 p-2",children:[(0,jsx_runtime.jsx)("h3",{className:"mb-0",children:"Test results"}),testResult?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(src.Vp,{type:"success"===testResult.status?"success":"skipped"===testResult.status?"warning":"error",children:"success"===testResult.status?"Success":"skipped"===testResult.status?"Workflow was skipped because the event did not match the filter criteria":"Error: "+testResult.errors?.join(", ")}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,jsx_runtime.jsx)(src.HQ,{children:"Logs"}),(0,jsx_runtime.jsx)(LogsViewer.rM,{instanceLabel:"workflow run",renderMessage:m=>renderWorkflowLogMessage(campaign,m),dataSource:null!==(_testResult$logs=testResult.logs)&&void 0!==_testResult$logs?_testResult$logs:[],renderColumns:columns=>columns.filter(column=>"instanceId"!==column.key)})]})]}):(0,jsx_runtime.jsx)("div",{className:"text-muted text-sm",children:"No tests run yet"})]})]})]}):(0,jsx_runtime.jsxs)("div",{className:"m-8 text-center flex flex-col gap-2 items-center",children:[(0,jsx_runtime.jsxs)("h1",{children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconTestTube,{className:"mr-2"}),"Test your workflow"]}),(0,jsx_runtime.jsx)("p",{children:"Step through each action in your workflow and see how it behaves."}),(0,jsx_runtime.jsx)(src.Jp,{type:"primary",onClick:()=>setSelectedNodeId(campaignLogic.mg),icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconPlay,{}),children:"Start testing"})]})}function HogFlowEditorPanel(){var _selectedNode$id;let{selectedNode,mode,selectedNodeCanBeDeleted}=(0,index_esm.useValues)(hogFlowEditorLogic.s),{setMode,setSelectedNodeId}=(0,index_esm.useActions)(hogFlowEditorLogic.s),{deleteElements}=(0,esm._K)(),tabs=hogFlowEditorLogic.O.map(mode=>({label:(0,utils.fm)(mode),key:mode})),width="build"!==mode?"36rem":selectedNode?"36rem":"22rem",Step=(0,HogFlowSteps.i)(selectedNode?.data),{actionValidationErrorsById}=(0,index_esm.useValues)(campaignLogic.yt),validationResult=actionValidationErrorsById[null!==(_selectedNode$id=selectedNode?.id)&&void 0!==_selectedNode$id?_selectedNode$id:""];return(0,jsx_runtime.jsx)("div",{className:"absolute flex flex-col m-0 p-2 overflow-hidden transition-[width] max-h-full right-0 justify-end",style:{width},children:(0,jsx_runtime.jsxs)("div",{className:"relative flex flex-col rounded-md overflow-hidden bg-surface-primary max-h-full z-10",style:{border:"1px solid var(--border)",boxShadow:"0 3px 0 var(--border)"},children:[(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 border-b items-center",children:[(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.default)("transition-all overflow-hidden flex p-1",selectedNode?"w-10 opacity-100":"w-2 opacity-0"),children:(0,jsx_runtime.jsx)(src.Jp,{size:"small",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconArrowLeft,{}),onClick:()=>setSelectedNodeId(null),disabled:!selectedNode})}),(0,jsx_runtime.jsx)("div",{className:"flex-1",children:(0,jsx_runtime.jsx)(src.TP,{activeKey:mode,onChange:key=>setMode(key),tabs:tabs,barClassName:"-mb-px "})}),selectedNode&&(0,jsx_runtime.jsxs)("span",{className:"flex gap-1 items-center font-medium rounded-md mr-3",children:[(0,jsx_runtime.jsx)("span",{className:"text-lg",children:Step?.icon}),(0,jsx_runtime.jsx)("span",{className:"font-semibold whitespace-nowrap",children:selectedNode.data.name}),"step",validationResult?.valid===!1&&(0,jsx_runtime.jsx)(src.u,{title:"Some fields need attention",children:(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(src.Mo,{status:"warning",size:"small",content:"!"})})}),selectedNode.deletable&&(0,jsx_runtime.jsx)(src.Jp,{size:"xsmall",status:"danger",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconTrash,{}),onClick:()=>{deleteElements({nodes:[selectedNode]}),setSelectedNodeId(null)},disabledReason:selectedNodeCanBeDeleted?void 0:"Clean up branching steps first"})]})]}),"build"===mode&&(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:selectedNode?(0,jsx_runtime.jsx)(HogFlowEditorPanelBuildDetail,{}):(0,jsx_runtime.jsx)(HogFlowEditorPanelBuild,{})}),"test"===mode&&(0,jsx_runtime.jsx)(HogFlowEditorPanelTest,{}),"metrics"===mode&&(0,jsx_runtime.jsx)(HogFlowEditorPanelMetrics,{}),"logs"===mode&&(0,jsx_runtime.jsx)(HogFlowEditorPanelLogs,{})]})})}var constants=__webpack_require__("../../products/messaging/frontend/Campaigns/hogflows/constants.ts"),LemonBadge=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonBadge/index.ts");function StepViewMetrics(_ref){var _actionMetricsById$ac;let{action}=_ref,{actionMetricsById,actionMetricsByIdLoading}=(0,index_esm.useValues)(hogFlowEditorLogic.s),metrics=null!==(_actionMetricsById$ac=actionMetricsById?.[action.id])&&void 0!==_actionMetricsById$ac?_actionMetricsById$ac:{actionId:action.id,succeeded:0,failed:0,filtered:0};return actionMetricsByIdLoading?(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1 h-2 px-1",children:[(0,jsx_runtime.jsx)(src.yW,{className:"w-full h-[6px]"}),(0,jsx_runtime.jsx)(src.yW,{className:"w-full h-[6px]"}),(0,jsx_runtime.jsx)(src.yW,{className:"w-full h-[6px]"})]}):(0,jsx_runtime.jsxs)("div",{className:"flex flex-row items-center font-mono",style:{fontSize:6},children:[(0,jsx_runtime.jsx)(src.u,{title:"Successful runs of this action",children:(0,jsx_runtime.jsxs)("div",{className:"flex-1 px-1 text-success",children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconCheck,{})," ",(0,utils.d$)(metrics.succeeded)]})}),(0,jsx_runtime.jsx)(src.u,{title:"Failed runs of this action",children:(0,jsx_runtime.jsxs)("div",{className:"flex-1 px-1 text-error",children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconX,{})," ",(0,utils.d$)(metrics.failed)]})}),(0,jsx_runtime.jsx)(src.u,{title:"Filtered runs of this action",children:(0,jsx_runtime.jsxs)("div",{className:"flex-1 px-1 text-muted",children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconFilter,{})," ",(0,utils.d$)(metrics.filtered)]})})]})}function StepView(_ref){let{action}=_ref,{selectedNode,mode}=(0,index_esm.useValues)(hogFlowEditorLogic.s),{actionValidationErrorsById}=(0,index_esm.useValues)(campaignLogic.yt),isSelected=selectedNode?.id===action.id,height="metrics"===mode?constants.M8+10:constants.M8,Step=(0,HogFlowSteps.i)(action),{selectedColor,colorLight,color,icon}=(0,react.useMemo)(()=>({selectedColor:Step?.color?isSelected?`${Step?.color}`:`${Step?.color}20`:isSelected?"var(--border-primary)":"var(--border)",colorLight:Step?.color?`${Step?.color}20`:"var(--border)",color:Step?.color||"var(--text-secondary)",icon:Step?.icon}),[action,isSelected,Step]),hasValidationError=actionValidationErrorsById[action.id]?.valid===!1;return(0,jsx_runtime.jsxs)("div",{className:"relative flex flex-col cursor-pointer rounded user-select-none bg-surface-primary",style:{width:constants.nK,height,borderWidth:1,borderColor:selectedColor,boxShadow:`0px 2px 0px 0px ${colorLight}`,zIndex:0},children:[(0,jsx_runtime.jsxs)("div",{className:"relative z-10 flex gap-1 p-1 items-start w-full",children:[(0,jsx_runtime.jsx)("div",{className:"flex justify-center h-6 items-center aspect-square rounded",style:{backgroundColor:colorLight,color},children:icon}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{className:"flex justify-between items-center gap-1",children:(0,jsx_runtime.jsx)("div",{className:"text-[0.45rem] font-sans font-medium",children:action.name})}),(0,jsx_runtime.jsx)("div",{className:"max-w-full text-[0.3rem]/1.5 text-muted text-ellipsis",children:action.description})]})]}),hasValidationError&&(0,jsx_runtime.jsx)("div",{className:"absolute top-0 right-0 scale-75",children:(0,jsx_runtime.jsx)(LemonBadge.M,{status:"warning",size:"small",content:"!",position:"top-right"})}),"metrics"===mode&&(0,jsx_runtime.jsx)("div",{style:{borderTopColor:colorLight,borderTopWidth:1},children:(0,jsx_runtime.jsx)(StepViewMetrics,{action:action})})]})}let REACT_FLOW_NODE_TYPES={dropzone:DropzoneNode,action:HogFlowActionNode};function DropzoneNode(_ref){let{id}=_ref,[isHighlighted,setIsHighlighted]=(0,react.useState)(!1),{setHighlightedDropzoneNodeId}=(0,index_esm.useActions)(hogFlowEditorLogic.s);return(0,react.useEffect)(()=>{setHighlightedDropzoneNodeId(isHighlighted?id:null)},[id,isHighlighted,setHighlightedDropzoneNodeId]),(0,jsx_runtime.jsx)("div",{onDragOver:()=>setIsHighlighted(!0),onDragLeave:()=>setIsHighlighted(!1),className:(0,clsx_m.default)("flex justify-center items-center p-2 rounded border border-dashed transition-all cursor-pointer",isHighlighted?"border-primary bg-surface-primary":"border-transparent"),style:{width:constants.nK,height:constants.M8},children:(0,jsx_runtime.jsx)("div",{className:"flex flex-col justify-center items-center w-4 h-4 rounded-full border bg-surface-primary",children:(0,jsx_runtime.jsx)(posthog_icons_es.IconPlus,{className:"text-sm text-primary"})})})}function HogFlowActionNode(props){let updateNodeInternals=(0,esm.Bn)(),{nodesById}=(0,index_esm.useValues)(hogFlowEditorLogic.s);(0,react.useEffect)(()=>{updateNodeInternals(props.id)},[props.id,updateNodeInternals]);let node=nodesById[props.id];return(0,jsx_runtime.jsxs)("div",{className:"transition-all hover:translate-y-[-2px]",children:[node?.handles?.map(handle=>jsx_runtime.jsx(esm.HH,{className:"opacity-0",...handle,isConnectable:!1},handle.id)),(0,jsx_runtime.jsx)(StepView,{action:props.data})]})}var SmartEdge=__webpack_require__("../../products/messaging/frontend/Campaigns/hogflows/steps/SmartEdge.tsx");function HogFlowEditorContent(){let{isDarkModeOn}=(0,index_esm.useValues)(themeLogic.b),{nodes,edges,dropzoneNodes}=(0,index_esm.useValues)(hogFlowEditorLogic.s),{onEdgesChange,onNodesChange,setSelectedNodeId,setReactFlowInstance,onNodesDelete,onDragStart,onDragOver,onDrop,setReactFlowWrapper}=(0,index_esm.useActions)(hogFlowEditorLogic.s),reactFlowWrapper=(0,react.useRef)(null),reactFlowInstance=(0,esm._K)();return(0,react.useEffect)(()=>{setReactFlowInstance(reactFlowInstance)},[reactFlowInstance,setReactFlowInstance]),(0,react.useEffect)(()=>{setReactFlowWrapper(reactFlowWrapper)},[setReactFlowWrapper]),(0,jsx_runtime.jsx)("div",{ref:reactFlowWrapper,className:"w-full h-full",children:(0,jsx_runtime.jsxs)(esm.x$,{fitView:!0,nodes:[...nodes,...dropzoneNodes],edges:edges,onNodesChange:onNodesChange,onEdgesChange:onEdgesChange,onNodesDelete:onNodesDelete,onDragStart:onDragStart,onDragOver:onDragOver,onDrop:onDrop,onNodeClick:(_,node)=>node.selectable&&setSelectedNodeId(node.id),nodeTypes:REACT_FLOW_NODE_TYPES,edgeTypes:SmartEdge.No,nodesDraggable:!1,colorMode:isDarkModeOn?"dark":"light",onPaneClick:()=>setSelectedNodeId(null),children:[(0,jsx_runtime.jsx)(esm.Aq,{gap:36,variant:esm.T7.Dots}),(0,jsx_runtime.jsx)(esm.ZX,{showInteractive:!1}),(0,jsx_runtime.jsx)(HogFlowEditorPanel,{})]})})}function HogFlowEditor(){let{logicProps}=(0,index_esm.useValues)(campaignLogic.yt);return(0,jsx_runtime.jsx)(esm.tV,{children:(0,jsx_runtime.jsx)(index_esm.BindLogic,{logic:hogFlowEditorLogic.s,props:logicProps,children:(0,jsx_runtime.jsx)(HogFlowEditorContent,{})})})}function CampaignWorkflow(props){let{originalCampaign,campaignLoading}=(0,index_esm.useValues)((0,campaignLogic.yt)(props));return(0,jsx_runtime.jsx)("div",{className:"relative border rounded-md h-[calc(100vh-280px)]",children:(0,jsx_runtime.jsx)(index_esm.BindLogic,{logic:campaignLogic.yt,props:props,children:!originalCampaign&&campaignLoading?(0,jsx_runtime.jsx)(src.t2,{}):(0,jsx_runtime.jsx)(HogFlowEditor,{})})})}var campaignSceneLogic=__webpack_require__("../../products/messaging/frontend/Campaigns/campaignSceneLogic.ts");let scene={component:CampaignScene,logic:campaignSceneLogic.c,paramsToProps:_ref=>{let{params:{id,tab}}=_ref;return{id:id||"new",tab:tab||"workflow"}}};function CampaignScene(props){let{currentTab}=(0,index_esm.useValues)(campaignSceneLogic.c),logic=(0,campaignLogic.yt)(props),{campaignLoading,campaign,originalCampaign}=(0,index_esm.useValues)(logic);if(!originalCampaign&&campaignLoading)return(0,jsx_runtime.jsx)(src.t2,{sceneLevel:!0});if(!originalCampaign)return(0,jsx_runtime.jsx)(NotFound.T,{object:"campaign"});let tabs=[{label:"Workflow",key:"workflow",content:(0,jsx_runtime.jsx)(CampaignWorkflow,{...props})},{label:"Logs",key:"logs",content:(0,jsx_runtime.jsx)(LogsViewer.FW,{sourceType:"hog_flow",sourceId:props.id,instanceLabel:"workflow run",renderMessage:m=>renderWorkflowLogMessage(campaign,m)})},{label:"Metrics",key:"metrics",content:(0,jsx_runtime.jsx)(CampaignMetrics,{id:props.id})}];return(0,jsx_runtime.jsxs)(SceneContent._,{className:"flex flex-col",children:[(0,jsx_runtime.jsx)(CampaignSceneHeader,{...props}),(0,jsx_runtime.jsx)(SceneDivider.V,{}),props.id&&"new"!==props.id?(0,jsx_runtime.jsx)(LemonTabs.T,{activeKey:currentTab,onChange:tab=>{var _props$id;return lib.router.actions.push(urls.j.messagingCampaign(null!==(_props$id=props.id)&&void 0!==_props$id?_props$id:"new",tab))},tabs:tabs,sceneInset:!0}):(0,jsx_runtime.jsx)(CampaignWorkflow,{...props})]})}},"../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!../../node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.5.6_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!../../node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!../../node_modules/.pnpm/@xyflow+react@12.6.0_@types+react@17.0.52_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@xyflow/react/dist/style.css":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".react-flow{direction:ltr;--xy-edge-stroke-default:#b1b1b7;--xy-edge-stroke-width-default:1;--xy-edge-stroke-selected-default:#555;--xy-connectionline-stroke-default:#b1b1b7;--xy-connectionline-stroke-width-default:1;--xy-attribution-background-color-default:hsla(0,0%,100%,.5);--xy-minimap-background-color-default:#fff;--xy-minimap-mask-background-color-default:hsla(0,0%,94%,.6);--xy-minimap-mask-stroke-color-default:transparent;--xy-minimap-mask-stroke-width-default:1;--xy-minimap-node-background-color-default:#e2e2e2;--xy-minimap-node-stroke-color-default:transparent;--xy-minimap-node-stroke-width-default:2;--xy-background-color-default:transparent;--xy-background-pattern-dots-color-default:#91919a;--xy-background-pattern-lines-color-default:#eee;--xy-background-pattern-cross-color-default:#e2e2e2;background-color:var(--xy-background-color,var(--xy-background-color-default));--xy-node-color-default:inherit;--xy-node-border-default:1px solid #1a192b;--xy-node-background-color-default:#fff;--xy-node-group-background-color-default:hsla(0,0%,94%,.25);--xy-node-boxshadow-hover-default:0 1px 4px 1px rgba(0,0,0,.08);--xy-node-boxshadow-selected-default:0 0 0 0.5px #1a192b;--xy-node-border-radius-default:3px;--xy-handle-background-color-default:#1a192b;--xy-handle-border-color-default:#fff;--xy-selection-background-color-default:rgba(0,89,220,.08);--xy-selection-border-default:1px dotted rgba(0,89,220,.8);--xy-controls-button-background-color-default:#fefefe;--xy-controls-button-background-color-hover-default:#f4f4f4;--xy-controls-button-color-default:inherit;--xy-controls-button-color-hover-default:inherit;--xy-controls-button-border-color-default:#eee;--xy-controls-box-shadow-default:0 0 2px 1px rgba(0,0,0,.08);--xy-edge-label-background-color-default:#fff;--xy-edge-label-color-default:inherit;--xy-resize-background-color-default:#3367d9}.react-flow.dark{--xy-edge-stroke-default:#3e3e3e;--xy-edge-stroke-width-default:1;--xy-edge-stroke-selected-default:#727272;--xy-connectionline-stroke-default:#b1b1b7;--xy-connectionline-stroke-width-default:1;--xy-attribution-background-color-default:hsla(0,0%,59%,.25);--xy-minimap-background-color-default:#141414;--xy-minimap-mask-background-color-default:rgba(60,60,60,.6);--xy-minimap-mask-stroke-color-default:transparent;--xy-minimap-mask-stroke-width-default:1;--xy-minimap-node-background-color-default:#2b2b2b;--xy-minimap-node-stroke-color-default:transparent;--xy-minimap-node-stroke-width-default:2;--xy-background-color-default:#141414;--xy-background-pattern-dots-color-default:#777;--xy-background-pattern-lines-color-default:#777;--xy-background-pattern-cross-color-default:#777;--xy-node-color-default:#f8f8f8;--xy-node-border-default:1px solid #3c3c3c;--xy-node-background-color-default:#1e1e1e;--xy-node-group-background-color-default:hsla(0,0%,94%,.25);--xy-node-boxshadow-hover-default:0 1px 4px 1px hsla(0,0%,100%,.08);--xy-node-boxshadow-selected-default:0 0 0 0.5px #999;--xy-handle-background-color-default:#bebebe;--xy-handle-border-color-default:#1e1e1e;--xy-selection-background-color-default:rgba(200,200,220,.08);--xy-selection-border-default:1px dotted rgba(200,200,220,.8);--xy-controls-button-background-color-default:#2b2b2b;--xy-controls-button-background-color-hover-default:#3e3e3e;--xy-controls-button-color-default:#f8f8f8;--xy-controls-button-color-hover-default:#fff;--xy-controls-button-border-color-default:#5b5b5b;--xy-controls-box-shadow-default:0 0 2px 1px rgba(0,0,0,.08);--xy-edge-label-background-color-default:#141414;--xy-edge-label-color-default:#f8f8f8}.react-flow__background{background-color:var(--xy-background-color,var(--xy-background-color-props,var(--xy-background-color-default)));pointer-events:none;z-index:-1}.react-flow__container{height:100%;left:0;position:absolute;top:0;width:100%}.react-flow__pane{z-index:1}.react-flow__pane.draggable{cursor:grab}.react-flow__pane.dragging{cursor:grabbing}.react-flow__pane.selection{cursor:pointer}.react-flow__viewport{pointer-events:none;transform-origin:0 0;z-index:2}.react-flow__renderer{z-index:4}.react-flow__selection{z-index:6}.react-flow__nodesselection-rect:focus,.react-flow__nodesselection-rect:focus-visible{outline:none}.react-flow__edge-path{stroke:var(--xy-edge-stroke,var(--xy-edge-stroke-default));stroke-width:var(--xy-edge-stroke-width,var(--xy-edge-stroke-width-default));fill:none}.react-flow__connection-path{stroke:var(--xy-connectionline-stroke,var(--xy-connectionline-stroke-default));stroke-width:var(--xy-connectionline-stroke-width,var(--xy-connectionline-stroke-width-default));fill:none}.react-flow .react-flow__edges{position:absolute}.react-flow .react-flow__edges svg{overflow:visible;pointer-events:none;position:absolute}.react-flow__edge{pointer-events:visibleStroke}.react-flow__edge.selectable{cursor:pointer}.react-flow__edge.animated path{stroke-dasharray:5;animation:dashdraw .5s linear infinite}.react-flow__edge.animated path.react-flow__edge-interaction{stroke-dasharray:none;animation:none}.react-flow__edge.inactive{pointer-events:none}.react-flow__edge.selected,.react-flow__edge:focus,.react-flow__edge:focus-visible{outline:none}.react-flow__edge.selectable:focus .react-flow__edge-path,.react-flow__edge.selectable:focus-visible .react-flow__edge-path,.react-flow__edge.selected .react-flow__edge-path{stroke:var(--xy-edge-stroke-selected,var(--xy-edge-stroke-selected-default))}.react-flow__edge-textwrapper{pointer-events:all}.react-flow__edge .react-flow__edge-text{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.react-flow__connection{pointer-events:none}.react-flow__connection .animated{stroke-dasharray:5;animation:dashdraw .5s linear infinite}svg.react-flow__connectionline{overflow:visible;position:absolute;z-index:1001}.react-flow__nodes{pointer-events:none;transform-origin:0 0}.react-flow__node{box-sizing:border-box;cursor:default;pointer-events:all;position:absolute;transform-origin:0 0;-webkit-user-select:none;-moz-user-select:none;user-select:none}.react-flow__node.selectable{cursor:pointer}.react-flow__node.draggable{cursor:grab;pointer-events:all}.react-flow__node.draggable.dragging{cursor:grabbing}.react-flow__nodesselection{pointer-events:none;transform-origin:left top;z-index:3}.react-flow__nodesselection-rect{cursor:grab;pointer-events:all;position:absolute}.react-flow__handle{background-color:var(--xy-handle-background-color,var(--xy-handle-background-color-default));border:1px solid var(--xy-handle-border-color,var(--xy-handle-border-color-default));border-radius:100%;height:6px;min-height:5px;min-width:5px;pointer-events:none;position:absolute;width:6px}.react-flow__handle.connectingfrom{pointer-events:all}.react-flow__handle.connectionindicator{cursor:crosshair;pointer-events:all}.react-flow__handle-bottom{bottom:0;left:50%;top:auto;transform:translate(-50%,50%)}.react-flow__handle-top{left:50%;top:0;transform:translate(-50%,-50%)}.react-flow__handle-left{left:0;top:50%;transform:translate(-50%,-50%)}.react-flow__handle-right{right:0;top:50%;transform:translate(50%,-50%)}.react-flow__edgeupdater{cursor:move;pointer-events:all}.react-flow__panel{margin:15px;position:absolute;z-index:5}.react-flow__panel.top{top:0}.react-flow__panel.bottom{bottom:0}.react-flow__panel.bottom.center,.react-flow__panel.top.center{left:50%;transform:translateX(-50%)}.react-flow__panel.left{left:0}.react-flow__panel.right{right:0}.react-flow__panel.left.center,.react-flow__panel.right.center{top:50%;transform:translateY(-50%)}.react-flow__attribution{background:var(--xy-attribution-background-color,var(--xy-attribution-background-color-default));font-size:10px;margin:0;padding:2px 3px}.react-flow__attribution a{color:#999;-webkit-text-decoration:none;text-decoration:none}@keyframes dashdraw{0%{stroke-dashoffset:10}}.react-flow__edgelabel-renderer{pointer-events:none}.react-flow__edgelabel-renderer,.react-flow__viewport-portal{height:100%;left:0;position:absolute;top:0;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:100%}.react-flow__minimap{background:var(--xy-minimap-background-color-props,var(--xy-minimap-background-color,var(--xy-minimap-background-color-default)))}.react-flow__minimap-svg{display:block}.react-flow__minimap-mask{fill:var(--xy-minimap-mask-background-color-props,var(--xy-minimap-mask-background-color,var(--xy-minimap-mask-background-color-default)));stroke:var(--xy-minimap-mask-stroke-color-props,var(--xy-minimap-mask-stroke-color,var(--xy-minimap-mask-stroke-color-default)));stroke-width:var(--xy-minimap-mask-stroke-width-props,var(--xy-minimap-mask-stroke-width,var(--xy-minimap-mask-stroke-width-default)))}.react-flow__minimap-node{fill:var(--xy-minimap-node-background-color-props,var(--xy-minimap-node-background-color,var(--xy-minimap-node-background-color-default)));stroke:var(--xy-minimap-node-stroke-color-props,var(--xy-minimap-node-stroke-color,var(--xy-minimap-node-stroke-color-default)));stroke-width:var(--xy-minimap-node-stroke-width-props,var(--xy-minimap-node-stroke-width,var(--xy-minimap-node-stroke-width-default)))}.react-flow__background-pattern.dots{fill:var(--xy-background-pattern-color-props,var(--xy-background-pattern-color,var(--xy-background-pattern-dots-color-default)))}.react-flow__background-pattern.lines{stroke:var(--xy-background-pattern-color-props,var(--xy-background-pattern-color,var(--xy-background-pattern-lines-color-default)))}.react-flow__background-pattern.cross{stroke:var(--xy-background-pattern-color-props,var(--xy-background-pattern-color,var(--xy-background-pattern-cross-color-default)))}.react-flow__controls{box-shadow:var(--xy-controls-box-shadow,var(--xy-controls-box-shadow-default));display:flex;flex-direction:column}.react-flow__controls.horizontal{flex-direction:row}.react-flow__controls-button{align-items:center;background:var(--xy-controls-button-background-color,var(--xy-controls-button-background-color-default));border:none;border-bottom:1px solid var(--xy-controls-button-border-color-props,var(--xy-controls-button-border-color,var(--xy-controls-button-border-color-default)));color:var(--xy-controls-button-color-props,var(--xy-controls-button-color,var(--xy-controls-button-color-default)));cursor:pointer;display:flex;height:26px;justify-content:center;padding:4px;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:26px}.react-flow__controls-button svg{max-height:12px;max-width:12px;width:100%;fill:currentColor}.react-flow__edge.updating .react-flow__edge-path{stroke:#777}.react-flow__edge-text{font-size:10px}.react-flow__node.selectable:focus,.react-flow__node.selectable:focus-visible{outline:none}.react-flow__node-default,.react-flow__node-group,.react-flow__node-input,.react-flow__node-output{background-color:var(--xy-node-background-color,var(--xy-node-background-color-default));border:var(--xy-node-border,var(--xy-node-border-default));border-radius:var(--xy-node-border-radius,var(--xy-node-border-radius-default));color:var(--xy-node-color,var(--xy-node-color-default));font-size:12px;padding:10px;text-align:center;width:150px}.react-flow__node-default.selectable:hover,.react-flow__node-group.selectable:hover,.react-flow__node-input.selectable:hover,.react-flow__node-output.selectable:hover{box-shadow:var(--xy-node-boxshadow-hover,var(--xy-node-boxshadow-hover-default))}.react-flow__node-default.selectable.selected,.react-flow__node-default.selectable:focus,.react-flow__node-default.selectable:focus-visible,.react-flow__node-group.selectable.selected,.react-flow__node-group.selectable:focus,.react-flow__node-group.selectable:focus-visible,.react-flow__node-input.selectable.selected,.react-flow__node-input.selectable:focus,.react-flow__node-input.selectable:focus-visible,.react-flow__node-output.selectable.selected,.react-flow__node-output.selectable:focus,.react-flow__node-output.selectable:focus-visible{box-shadow:var(--xy-node-boxshadow-selected,var(--xy-node-boxshadow-selected-default))}.react-flow__node-group{background-color:var(--xy-node-group-background-color,var(--xy-node-group-background-color-default))}.react-flow__nodesselection-rect,.react-flow__selection{background:var(--xy-selection-background-color,var(--xy-selection-background-color-default));border:var(--xy-selection-border,var(--xy-selection-border-default))}.react-flow__nodesselection-rect:focus,.react-flow__nodesselection-rect:focus-visible,.react-flow__selection:focus,.react-flow__selection:focus-visible{outline:none}.react-flow__controls-button:hover{background:var(--xy-controls-button-background-color-hover-props,var(--xy-controls-button-background-color-hover,var(--xy-controls-button-background-color-hover-default)));color:var(--xy-controls-button-color-hover-props,var(--xy-controls-button-color-hover,var(--xy-controls-button-color-hover-default)))}.react-flow__controls-button:disabled{pointer-events:none}.react-flow__controls-button:disabled svg{fill-opacity:.4}.react-flow__controls-button:last-child{border-bottom:none}.react-flow__controls.horizontal .react-flow__controls-button{border-bottom:none;border-right:1px solid var(--xy-controls-button-border-color-props,var(--xy-controls-button-border-color,var(--xy-controls-button-border-color-default)))}.react-flow__controls.horizontal .react-flow__controls-button:last-child{border-right:none}.react-flow__resize-control{position:absolute}.react-flow__resize-control.left,.react-flow__resize-control.right{cursor:ew-resize}.react-flow__resize-control.bottom,.react-flow__resize-control.top{cursor:ns-resize}.react-flow__resize-control.bottom.right,.react-flow__resize-control.top.left{cursor:nwse-resize}.react-flow__resize-control.bottom.left,.react-flow__resize-control.top.right{cursor:nesw-resize}.react-flow__resize-control.handle{background-color:var(--xy-resize-background-color,var(--xy-resize-background-color-default));border:1px solid #fff;border-radius:1px;height:4px;transform:translate(-50%,-50%);width:4px}.react-flow__resize-control.handle.left{left:0;top:50%}.react-flow__resize-control.handle.right{left:100%;top:50%}.react-flow__resize-control.handle.top{left:50%;top:0}.react-flow__resize-control.handle.bottom{left:50%;top:100%}.react-flow__resize-control.handle.bottom.left,.react-flow__resize-control.handle.top.left{left:0}.react-flow__resize-control.handle.bottom.right,.react-flow__resize-control.handle.top.right{left:100%}.react-flow__resize-control.line{border-color:var(--xy-resize-background-color,var(--xy-resize-background-color-default));border-style:solid;border-width:0}.react-flow__resize-control.line.left,.react-flow__resize-control.line.right{height:100%;top:0;transform:translate(-50%);width:1px}.react-flow__resize-control.line.left{border-left-width:1px;left:0}.react-flow__resize-control.line.right{border-right-width:1px;left:100%}.react-flow__resize-control.line.bottom,.react-flow__resize-control.line.top{height:1px;left:0;transform:translateY(-50%);width:100%}.react-flow__resize-control.line.top{border-top-width:1px;top:0}.react-flow__resize-control.line.bottom{border-bottom-width:1px;top:100%}.react-flow__edge-textbg{fill:var(--xy-edge-label-background-color,var(--xy-edge-label-background-color-default))}.react-flow__edge-text{fill:var(--xy-edge-label-color,var(--xy-edge-label-color-default))}",""]),module.exports=exports},"../../node_modules/.pnpm/@xyflow+react@12.6.0_@types+react@17.0.52_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@xyflow/react/dist/style.css":(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{"use strict";var _style_loader_2_0_0_webpack_5_88_2_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/style-loader@2.0.0_webpack@5.88.2/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),_style_loader_2_0_0_webpack_5_88_2_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_style_loader_2_0_0_webpack_5_88_2_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__),_css_loader_3_6_0_webpack_5_88_2_node_modules_css_loader_dist_cjs_js_postcss_loader_4_3_0_postcss_8_5_6_webpack_5_88_2_node_modules_postcss_loader_dist_cjs_js_sass_loader_10_3_1_sass_1_56_0_webpack_5_88_2_node_modules_sass_loader_dist_cjs_js_ruleSet_1_rules_2_use_3_style_css__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!../../node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.5.6_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!../../node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!../../node_modules/.pnpm/@xyflow+react@12.6.0_@types+react@17.0.52_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@xyflow/react/dist/style.css"),_css_loader_3_6_0_webpack_5_88_2_node_modules_css_loader_dist_cjs_js_postcss_loader_4_3_0_postcss_8_5_6_webpack_5_88_2_node_modules_postcss_loader_dist_cjs_js_sass_loader_10_3_1_sass_1_56_0_webpack_5_88_2_node_modules_sass_loader_dist_cjs_js_ruleSet_1_rules_2_use_3_style_css__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_css_loader_3_6_0_webpack_5_88_2_node_modules_css_loader_dist_cjs_js_postcss_loader_4_3_0_postcss_8_5_6_webpack_5_88_2_node_modules_postcss_loader_dist_cjs_js_sass_loader_10_3_1_sass_1_56_0_webpack_5_88_2_node_modules_sass_loader_dist_cjs_js_ruleSet_1_rules_2_use_3_style_css__WEBPACK_IMPORTED_MODULE_1__),options={};options.insert="head",options.singleton=!1,_style_loader_2_0_0_webpack_5_88_2_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default()(_css_loader_3_6_0_webpack_5_88_2_node_modules_css_loader_dist_cjs_js_postcss_loader_4_3_0_postcss_8_5_6_webpack_5_88_2_node_modules_postcss_loader_dist_cjs_js_sass_loader_10_3_1_sass_1_56_0_webpack_5_88_2_node_modules_sass_loader_dist_cjs_js_ruleSet_1_rules_2_use_3_style_css__WEBPACK_IMPORTED_MODULE_1___default(),options),_css_loader_3_6_0_webpack_5_88_2_node_modules_css_loader_dist_cjs_js_postcss_loader_4_3_0_postcss_8_5_6_webpack_5_88_2_node_modules_postcss_loader_dist_cjs_js_sass_loader_10_3_1_sass_1_56_0_webpack_5_88_2_node_modules_sass_loader_dist_cjs_js_ruleSet_1_rules_2_use_3_style_css__WEBPACK_IMPORTED_MODULE_1___default().locals}}]);