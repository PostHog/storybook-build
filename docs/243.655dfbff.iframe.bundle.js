(window.webpackJsonp=window.webpackJsonp||[]).push([[243],{"./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx":function(p,d,e){"use strict";e.d(d,"a",function(){return x});var M=e("./node_modules/core-js/modules/es.array.index-of.js"),ne=e("./node_modules/core-js/modules/es.regexp.exec.js"),J=e("./node_modules/core-js/modules/es.string.match.js"),Q=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),R=e.n(Q),l=e("./node_modules/react/index.js"),s=e.n(l),X=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),B=e.n(X),W=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.scss"),j=e.n(W),z={};z.insert="head",z.singleton=!1;var re=B()(j.a,z),se=j.a.locals||{},N=e("./node_modules/clsx/dist/clsx.m.js"),F=e("./node_modules/kea/lib/index.esm.js"),D=e("./frontend/src/lib/components/LemonTable/index.ts"),Z=e("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),H=e("./node_modules/@ant-design/icons/es/icons/CheckCircleFilled.js"),U=e("./frontend/src/lib/components/LemonButton/index.ts"),K=e("./node_modules/antd/es/input/index.js"),w=e("./node_modules/antd/es/button/index.js"),A=e("./frontend/src/scenes/toolbar-launch/authorizedUrlsLogic.ts"),g=e("./frontend/src/lib/utils.tsx"),O=e("./frontend/src/lib/components/LemonButton/More.tsx");function x(I){var ae=I.pageKey,oe=I.actionId,le=Object(A.c)({actionId:oe}),y=Object(F.useValues)(le),pe=y.appUrlsKeyed,ue=y.suggestionsLoading,de=y.searchTerm,ie=y.launchUrl,L=y.appUrls,ce=y.editUrlIndex,_=Object(F.useActions)(le),me=_.addUrl,_e=_.removeUrl,fe=_.setSearchTerm,$=_.updateUrl,he=_.newUrl,S=_.setEditUrlIndex,Ee=[{title:"URLs",dataIndex:"url",key:"url",render:function(C,o){var G=Object(l.useState)(o.url),b=R()(G,2),h=b[0],ve=b[1],q=Object(l.useState)(""),V=R()(q,2),Y=V[0],T=V[1];Object(l.useEffect)(function(){return ve(o.url)},[o]);var ee=function(){if(T(""),h===A.a&&_e(o.originalIndex),h.indexOf("*")>-1&&!h.match(/^(.*)\*[^\*]*\.[^\*]+\.[^\*]+$/)){T("You can only wildcard subdomains. If you wildcard the domain or TLD, people might be able to gain access to your PostHog data.");return}if(!Object(g.db)(h)){T("Please type a valid URL or domain.");return}if(L.indexOf(h)>-1&&L.indexOf(h,o.originalIndex)!==o.originalIndex&&L.indexOf(h,o.originalIndex+1)!==o.originalIndex){T("This URL is already registered.");return}$(o.originalIndex,h)};return o.type==="suggestion"||C!==A.a&&ce!==o.originalIndex?s.a.createElement("div",{className:Object(N.a)("authorized-url-col",o.type)},o.type==="authorized"&&s.a.createElement(H.a,{style:{marginRight:4}}),C,o.type==="suggestion"&&s.a.createElement(Z.a,null,"Suggestion")):s.a.createElement("div",null,s.a.createElement("div",{style:{display:"flex"}},s.a.createElement(K.a,{value:h,onChange:function(r){return ve(r.target.value)},onPressEnter:ee,autoFocus:!0,placeholder:"Enter a URL or wildcard subdomain (e.g. https://*.posthog.com)"}),s.a.createElement(w.a,{type:"primary",onClick:ee},"Save")),Y&&s.a.createElement("span",{className:"text-small text-danger"},Y))}},{title:"",key:"actions",render:function(C,o,G){return s.a.createElement("div",{className:"actions-col"},o.type==="suggestion"?s.a.createElement(U.a,{type:"secondary",onClick:function(){return me(o.url)}},"Apply suggestion"):s.a.createElement(s.a.Fragment,null,s.a.createElement(U.a,{type:"highlighted",href:ie(o.url),className:"mr"},"Open with Toolbar"),s.a.createElement(O.a,{overlay:s.a.createElement(s.a.Fragment,null,s.a.createElement(U.a,{fullWidth:!0,type:"stealth",onClick:function(){return S(o.originalIndex)}},"Edit authorized URL"),s.a.createElement(U.a,{fullWidth:!0,style:{color:"var(--danger)"},type:"stealth",onClick:function(){return _e(G)}},"Remove authorized URL"))})))}}];return s.a.createElement("div",null,s.a.createElement("div",{className:"flex-center mb"},s.a.createElement("div",{style:{flexGrow:1}},s.a.createElement(K.a.Search,{allowClear:!0,enterButton:!0,placeholder:"Search for authorized URLs",style:{maxWidth:480},value:de,onChange:function(C){fe(C.target.value)},autoFocus:ae==="toolbar-launch"&&!Object(g.W)()})),s.a.createElement(U.a,{type:"primary",onClick:he},"Add",ae==="toolbar-launch"&&" authorized domain")),s.a.createElement(D.a,{className:"authorized-urls-table",columns:Ee,dataSource:pe,emptyState:de?"There are no authorized URLs that match your search.":"There are no authorized URLs or domains. Add one to get started.",loading:ue}))}try{x.displayName="AuthorizedUrlsTable",x.__docgenInfo={description:"",displayName:"AuthorizedUrlsTable",props:{pageKey:{defaultValue:null,description:"",name:"pageKey",required:!1,type:{name:"string"}},actionId:{defaultValue:null,description:"",name:"actionId",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx#AuthorizedUrlsTable"]={docgenInfo:x.__docgenInfo,name:"AuthorizedUrlsTable",path:"frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx#AuthorizedUrlsTable"})}catch(I){}},"./frontend/src/scenes/toolbar-launch/ToolbarLaunch.tsx":function(p,d,e){"use strict";e.r(d),e.d(d,"scene",function(){return K});var M=e("./node_modules/core-js/modules/es.array.map.js"),ne=e("./node_modules/@babel/runtime/helpers/extends.js"),J=e.n(ne),Q=e("./frontend/src/lib/components/PageHeader.tsx"),R=e("./node_modules/react/index.js"),l=e.n(R),s=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),X=e.n(s),B=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/ToolbarLaunch.scss"),W=e.n(B),j={};j.insert="head",j.singleton=!1;var z=X()(W.a,j),re=W.a.locals||{},se=e("./node_modules/@ant-design/icons/es/icons/SearchOutlined.js"),N=e("./frontend/src/lib/components/Link.tsx"),F=e("./frontend/src/scenes/urls.ts"),D=e("./frontend/src/lib/components/icons.tsx"),Z=e("./node_modules/antd/es/row/index.js"),H=e("./node_modules/antd/es/col/index.js"),U=e("./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx"),K={component:w};function w(){var g=[{title:"Heatmaps",caption:"Understand where your users interact the most.",icon:l.a.createElement(D.IconHeatmap,null)},{title:"Actions",caption:"Create actions visually from elements in your website.",icon:l.a.createElement(D.IconGroupedEvents,null)},{title:"Feature Flags",caption:"Toggle feature flags on/off right on your app.",icon:l.a.createElement(D.IconFlag,null)},{title:"Inspect",caption:"Inspect clickable elements on your website.",icon:l.a.createElement(se.a,null)}];return l.a.createElement("div",{className:"toolbar-launch-page"},l.a.createElement(Q.a,{title:"Toolbar",caption:"The toolbar launches PostHog right in your app or website."}),l.a.createElement(U.a,{pageKey:"toolbar-launch"}),l.a.createElement("div",{className:"footer-caption"},"Make sure you're using the ",l.a.createElement(N.a,{to:"".concat(F.a.projectSettings(),"#snippet")},"HTML snippet")," or the latest ",l.a.createElement("code",null,"posthog-js")," version."),l.a.createElement(Z.a,{className:"feature-highlight-list"},g.map(function(O){return l.a.createElement(A,J()({key:O.title},O))})))}function A(g){var O=g.title,x=g.caption,I=g.icon;return l.a.createElement(H.a,{sm:12,className:"fh-item"},l.a.createElement("div",{className:"fh-icon"},I),l.a.createElement("div",null,l.a.createElement("h4",null,O),l.a.createElement("div",{className:"caption"},x)))}},"./frontend/src/scenes/toolbar-launch/authorizedUrlsLogic.ts":function(p,d,e){"use strict";e.d(d,"b",function(){return Y}),e.d(d,"a",function(){return T}),e.d(d,"c",function(){return ee});var M=e("./node_modules/core-js/modules/es.array.concat.js"),ne=e.n(M),J=e("./node_modules/core-js/modules/es.array.filter.js"),Q=e.n(J),R=e("./node_modules/core-js/modules/es.array.includes.js"),l=e.n(R),s=e("./node_modules/core-js/modules/es.array.index-of.js"),X=e.n(s),B=e("./node_modules/core-js/modules/es.array.iterator.js"),W=e.n(B),j=e("./node_modules/core-js/modules/es.array.map.js"),z=e.n(j),re=e("./node_modules/core-js/modules/es.array.slice.js"),se=e.n(re),N=e("./node_modules/core-js/modules/es.array.splice.js"),F=e.n(N),D=e("./node_modules/core-js/modules/es.object.assign.js"),Z=e.n(D),H=e("./node_modules/core-js/modules/es.object.to-string.js"),U=e.n(H),K=e("./node_modules/core-js/modules/es.regexp.exec.js"),w=e.n(K),A=e("./node_modules/core-js/modules/es.regexp.to-string.js"),g=e.n(A),O=e("./node_modules/core-js/modules/es.string.includes.js"),x=e.n(O),I=e("./node_modules/core-js/modules/es.string.iterator.js"),ae=e.n(I),oe=e("./node_modules/core-js/modules/es.string.search.js"),le=e.n(oe),y=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),pe=e.n(y),ue=e("./node_modules/core-js/modules/web.url.js"),de=e.n(ue),ie=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),L=e.n(ie),ce=e("./node_modules/@babel/runtime/regenerator/index.js"),_=e.n(ce),me=e("./node_modules/regenerator-runtime/runtime.js"),_e=e.n(me),fe=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),$=e.n(fe),he=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),S=e.n(he),Ee=e("./node_modules/kea/lib/index.esm.js"),k=e("./frontend/src/lib/api.ts"),C=e("./frontend/src/lib/utils.tsx"),o=e("./frontend/src/scenes/teamLogic.ts"),G=e("./frontend/src/lib/dayjs.ts"),b=e("./node_modules/fuse.js/dist/fuse.esm.js"),h=e("./node_modules/kea-router/lib/index.js"),ve=e.n(h);function q(u,r){var t=Object.keys(u);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(u);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(u,a).enumerable})),t.push.apply(t,n)}return t}function V(u){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?q(Object(t),!0).forEach(function(n){S()(u,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(t)):q(Object(t)).forEach(function(n){Object.defineProperty(u,n,Object.getOwnPropertyDescriptor(t,n))})}return u}function Y(u,r,t){var n=V(V({userIntent:t?void 0:r?"edit-action":"add-action"},r?{actionId:r}:{}),u?{appUrl:u}:{});return"/api/user/redirect_to_site/"+Object(h.encodeParams)(n,"?")}var T="https://",ee=Object(Ee.kea)({path:function(r){return["lib","components","AppEditorLink","appUrlsLogic",r]},key:function(r){return"".concat(r.pageKey).concat(r.actionId)||"global"},props:{},connect:{values:[o.a,["currentTeam","currentTeamId"]],actions:[o.a,["updateCurrentTeam"]]},actions:function(){return{setAppUrls:function(t){return{appUrls:t}},addUrl:function(t,n){return{url:t,launch:n}},newUrl:!0,removeUrl:function(t){return{index:t}},updateUrl:function(t,n){return{index:t,url:n}},launchAtUrl:function(t){return{url:t}},setSearchTerm:function(t){return{term:t}},setEditUrlIndex:function(t){return{originalIndex:t}}}},loaders:function(r){var t=r.values;return{suggestions:{__default:[],loadSuggestions:function(){var n=$()(_.a.mark(function c(){var E,i,m,v;return _.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return i={events:[{id:"$pageview",name:"$pageview",type:"events"}],breakdown:"$current_url",date_from:Object(G.a)().subtract(3,"days").toISOString()},f.next=3,k.b.get("api/projects/".concat(t.currentTeamId,"/insights/trend/?").concat(Object(C.xb)(i)));case 3:if(m=f.sent.result,!(m&&((E=m[0])===null||E===void 0?void 0:E.count)===0)){f.next=6;break}return f.abrupt("return",[]);case 6:return v=[],f.abrupt("return",(m||[]).filter(function(P){if(!P.breakdown_value)return!1;try{var ge=new URL(P.breakdown_value.toString()).hostname;return v.indexOf(ge)>-1||t.appUrls.filter(function(je){return je.indexOf(ge)>-1}).length>0?void 0:(v.push(ge),!0)}catch(je){return!1}}).map(function(P){return P.breakdown_value}).slice(0,20));case 8:case"end":return f.stop()}},c)}));function a(){return n.apply(this,arguments)}return a}()}}},events:function(r){var t=r.actions,n=r.values;return{afterMount:function(){t.loadSuggestions(),n.currentTeam&&t.setAppUrls(n.currentTeam.app_urls)}}},reducers:function(){return{appUrls:[[],{setAppUrls:function(t,n){var a=n.appUrls;return a},addUrl:function(t,n){var a=n.url;return t.concat([a])},newUrl:function(t){return t.includes(T)?t:[T].concat(t)},updateUrl:function(t,n){var a=n.index,c=n.url;return Object.assign(L()(t),S()({},a,c))},removeUrl:function(t,n){var a=n.index,c=L()(t);return c.splice(a,1),c}}],suggestions:[[],{addUrl:function(t,n){var a=n.url;return L()(t).filter(function(c){return a!==c})}}],searchTerm:["",{setSearchTerm:function(t,n){var a=n.term;return a}}],editUrlIndex:[null,{setEditUrlIndex:function(t,n){var a=n.originalIndex;return a},removeUrl:function(t,n){var a=n.index;return t&&a<t?t-1:a===t?null:t}}]}},listeners:function(r){var t,n=r.sharedListeners,a=r.values,c=r.actions;return t={addUrl:[n.saveAppUrls,function(){var E=$()(_.a.mark(function i(m){var v,te;return _.a.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:v=m.url,te=m.launch,te&&c.launchAtUrl(v);case 2:case"end":return P.stop()}},i)}));return function(i){return E.apply(this,arguments)}}()],removeUrl:n.saveAppUrls,updateUrl:[n.saveAppUrls,function(){return c.setEditUrlIndex(null)}]},S()(t,o.a.actionTypes.loadCurrentTeamSuccess,function(){var E=$()(_.a.mark(function i(m){var v;return _.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:v=m.currentTeam,v&&c.setAppUrls(v.app_urls);case 2:case"end":return f.stop()}},i)}));return function(i){return E.apply(this,arguments)}}()),S()(t,"launchAtUrl",function(i){var m=i.url;window.location.href=a.launchUrl(m)}),t},sharedListeners:function(r){var t=r.values;return{saveAppUrls:function(){o.a.actions.updateCurrentTeam({app_urls:t.appUrls})}}},selectors:function(r){var t=r.props;return{appUrlsKeyed:[function(n){return[n.appUrls,n.suggestions,n.searchTerm]},function(n,a,c){var E=n.map(function(i,m){return{url:i,type:"authorized",originalIndex:m}}).concat(a.map(function(i,m){return{url:i,type:"suggestion",originalIndex:m}}));return c?new b.a(E,{keys:["url"],threshold:.3}).search(c).map(function(i){return i.item}):E}],launchUrl:[function(){return[]},function(){return function(n){return Y(n,t.actionId,!t.actionId)}}]}}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.scss":function(p,d,e){var M=e("./node_modules/css-loader/dist/runtime/api.js");d=M(!1),d.push([p.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.authorized-urls-table .authorized-url-col{display:flex;align-items:center}.authorized-urls-table .authorized-url-col .lemon-tag{margin-left:6px}.authorized-urls-table .authorized-url-col.suggestion{color:#747ea1}.authorized-urls-table .authorized-url-col.authorized{color:var(--success)}.authorized-urls-table .actions-col{display:flex;align-items:center;justify-content:flex-end}",""]),p.exports=d},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/ToolbarLaunch.scss":function(p,d,e){var M=e("./node_modules/css-loader/dist/runtime/api.js");d=M(!1),d.push([p.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.toolbar-launch-page{margin-bottom:48px}.toolbar-launch-page .footer-caption{text-align:center;color:var(--muted);margin-top:1rem}.toolbar-launch-page .feature-highlight-list{max-width:800px;margin:2rem auto 0}.toolbar-launch-page .feature-highlight-list .fh-item{display:flex;align-items:center;margin-top:1rem}.toolbar-launch-page .feature-highlight-list .fh-item .fh-icon{color:#747ea1;margin-right:8px;font-size:1.6em}.toolbar-launch-page .feature-highlight-list .fh-item h4{color:#747ea1;margin-bottom:0;font-size:1.2em}",""]),p.exports=d}}]);
