(window.webpackJsonp=window.webpackJsonp||[]).push([[9,10],{"./frontend/src/scenes/apps/appMetricsSceneLogic.ts":function(h,m,r){"use strict";r.r(m),r.d(m,"AppMetricsTab",function(){return c}),r.d(m,"appMetricsSceneLogic",function(){return z});var j=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),f=r.n(j),v=r("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),u=r.n(v),P=r("./node_modules/@babel/runtime/regenerator/index.js"),E=r.n(P),K=r("./node_modules/core-js/modules/es.array.iterator.js"),Q=r.n(K),W=r("./node_modules/core-js/modules/es.object.to-string.js"),V=r.n(W),F=r("./node_modules/core-js/modules/web.dom-collections.iterator.js"),X=r.n(F),x=r("./node_modules/core-js/modules/es.array.concat.js"),Y=r.n(x),H=r("./node_modules/core-js/modules/es.function.name.js"),Z=r.n(H),S=r("./node_modules/core-js/modules/es.array.includes.js"),w=r.n(S),J=r("./node_modules/core-js/modules/es.string.includes.js"),k=r.n(J),$=r("./node_modules/core-js/modules/es.array.filter.js"),q=r.n($),G=r("./node_modules/core-js/modules/es.number.constructor.js"),ee=r.n(G),p=r("./node_modules/kea/lib/index.esm.js"),b=r("./node_modules/kea-loaders/lib/index.js"),re=r.n(b),D=r("./frontend/src/scenes/urls.ts"),O=r("./frontend/src/lib/api.ts"),g=r("./frontend/src/scenes/teamLogic.tsx"),T=r("./node_modules/kea-router/lib/index.js"),se=r.n(T),I=r("./frontend/src/lib/utils.tsx"),A=r("./frontend/src/scenes/plugins/edit/interface-jobs/PluginJobConfiguration.tsx"),N=r("./frontend/src/scenes/plugins/edit/interface-jobs/interfaceJobsLogic.ts"),c;(function(s){s.ProcessEvent="processEvent",s.OnEvent="onEvent",s.ExportEvents="exportEvents",s.ScheduledTask="scheduledTask",s.HistoricalExports="historical_exports"})(c||(c={}));var C="-30d",L=[c.ProcessEvent,c.OnEvent,c.ExportEvents,c.ScheduledTask],z=Object(p.kea)([Object(p.path)(function(s){return["scenes","apps","appMetricsSceneLogic",s]}),Object(p.props)({}),Object(p.key)(function(s){return s.pluginConfigId}),Object(p.actions)({setActiveTab:function(n){return{tab:n}},setDateFrom:function(n){return{dateFrom:n}},openErrorDetailsModal:function(n,t,e){return{errorType:n,category:t,jobId:e}},closeErrorDetailsModal:!0,openHistoricalExportModal:!0}),Object(p.reducers)({activeTab:[null,{setActiveTab:function(n,t){var e=t.tab;return e}}],dateFrom:[C,{setDateFrom:function(n,t){var e=t.dateFrom;return e}}],errorDetailsModalError:[null,{openErrorDetailsModal:function(n,t){var e=t.errorType;return e},closeErrorDetailsModal:function(){return null}}]}),Object(b.loaders)(function(s){var n=s.values,t=s.props;return{pluginConfig:[null,{loadPluginConfig:function(){var e=u()(E.a.mark(function o(){return E.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,O.b.get("api/projects/".concat(g.a.values.currentTeamId,"/plugin_configs/").concat(t.pluginConfigId));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},o)}));function i(){return e.apply(this,arguments)}return i}()}],appMetricsResponse:[null,{loadMetrics:function(){var e=u()(E.a.mark(function o(){var a;return E.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return a=Object(I.Eb)({category:n.activeTab,date_from:n.dateFrom}),_.next=3,O.b.get("api/projects/".concat(g.a.values.currentTeamId,"/app_metrics/").concat(t.pluginConfigId,"?").concat(a));case 3:return _.abrupt("return",_.sent);case 4:case"end":return _.stop()}},o)}));function i(){return e.apply(this,arguments)}return i}()}],historicalExports:[[],{loadHistoricalExports:function(){var e=u()(E.a.mark(function o(){var a,l;return E.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,O.b.get("api/projects/".concat(g.a.values.currentTeamId,"/app_metrics/").concat(t.pluginConfigId,"/historical_exports"));case 2:return a=d.sent,l=a.results,d.abrupt("return",l);case 5:case"end":return d.stop()}},o)}));function i(){return e.apply(this,arguments)}return i}()}],errorDetails:[[],{openErrorDetailsModal:function(){var e=u()(E.a.mark(function o(a){var l,_,d,U,R,B;return E.a.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return l=a.category,_=a.jobId,d=a.errorType,U=Object(I.Eb)({category:l,job_id:_,error_type:d}),M.next=4,O.b.get("api/projects/".concat(g.a.values.currentTeamId,"/app_metrics/").concat(t.pluginConfigId,"/error_details?").concat(U));case 4:return R=M.sent,B=R.result,M.abrupt("return",B);case 7:case"end":return M.stop()}},o)}));function i(o){return e.apply(this,arguments)}return i}()}]}}),Object(p.selectors)(function(s){var n=s.values,t=s.actions;return{breadcrumbs:[function(e){return[e.pluginConfig,function(i,o){return o.pluginConfigId}]},function(e,i){var o;return[{name:"Apps",path:D.a.projectApps()},{name:e==null||(o=e.plugin_info)===null||o===void 0?void 0:o.name,path:D.a.appMetrics(i)}]}],showTab:[function(){return[]},function(){return function(e){if(n.pluginConfigLoading||!n.pluginConfig||!n.pluginConfig.plugin_info.capabilities)return!1;var i=n.pluginConfig.plugin_info.capabilities,o=i.methods.includes("exportEvents");return e===c.HistoricalExports?o:e===c.OnEvent&&o?!1:e===c.ScheduledTask?!o&&["runEveryMinute","runEveryHour","runEveryDay"].some(function(a){return i.scheduled_tasks.includes(a)}):i.methods.includes(e)}}],interfaceJobsProps:[function(e){return[e.pluginConfig]},function(e){return!e||!e.plugin_info.public_jobs||!(e!=null&&e.enabled)?null:{jobName:A.b,jobSpec:e.plugin_info.public_jobs[A.b],pluginConfigId:e.id,pluginId:e.plugin,onSubmit:t.loadHistoricalExports}}]}}),Object(p.listeners)(function(s){var n=s.values,t=s.actions;return{loadPluginConfigSuccess:function(){if(!n.activeTab){var i=L.filter(function(l){return n.showTab(l)}),o=f()(i,1),a=o[0];t.setActiveTab(a)}},setActiveTab:function(i){var o=i.tab;o===c.HistoricalExports?t.loadHistoricalExports():t.loadMetrics()},setDateFrom:function(){t.loadMetrics()},openHistoricalExportModal:function(){n.interfaceJobsProps&&Object(N.a)(n.interfaceJobsProps).actions.setIsJobModalOpen(!0)}}}),Object(T.actionToUrl)(function(s){var n=s.values,t=s.props;return{setActiveTab:function(){return y(n,t)},setDateFrom:function(){return y(n,t)}}}),Object(T.urlToAction)(function(s){var n=s.values,t=s.actions,e=s.props;return{"/app/:pluginConfigId/:page":function(o,a){e.pluginConfigId===Number(o.pluginConfigId)&&(n.pluginConfig||t.loadPluginConfig(),o.page===c.HistoricalExports?t.setActiveTab(c.HistoricalExports):(a.tab&&L.includes(a.tab)&&t.setActiveTab(a.tab),a.from&&t.setDateFrom(a.from)))}}})]);function y(s,n){if(s.activeTab===c.HistoricalExports)return D.a.appHistoricalExports(n.pluginConfigId);var t={};return s.activeTab&&(t.tab=s.activeTab),s.dateFrom!==C&&(t.from=s.dateFrom),D.a.appMetrics(n.pluginConfigId,t)}},"./frontend/src/scenes/apps/constants.tsx":function(h,m,r){"use strict";r.r(m),r.d(m,"DescriptionColumns",function(){return P});var j=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),f=r.n(j),v=r("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),u,P=(u={},f()(u,v.AppMetricsTab.ProcessEvent,{successes:"Events processed",failures:"Failed events"}),f()(u,v.AppMetricsTab.OnEvent,{successes:"Events processed",successes_on_retry:"Events processed on retry",failures:"Failed events"}),f()(u,v.AppMetricsTab.ExportEvents,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),f()(u,v.AppMetricsTab.HistoricalExports,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),f()(u,v.AppMetricsTab.ScheduledTask,{successes:"Successes",failures:"Failures"}),u)}}]);
