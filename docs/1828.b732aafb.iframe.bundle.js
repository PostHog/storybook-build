(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[1828],{"./frontend/src/lib/components/EditableField/EditableField.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{f:function(){return EditableField_EditableField_EditableField}});var react=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/.pnpm/style-loader@2.0.0_webpack@5.88.2/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),EditableField=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/lib/components/EditableField/EditableField.scss"),EditableField_default=__webpack_require__.n(EditableField),options={insert:"head",singleton:!1},icons=(injectStylesIntoStyleTag_default()(EditableField_default(),options),EditableField_default().locals,__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts")),LemonButton=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/index.ts"),react_textarea_autosize_browser_esm=__webpack_require__("./node_modules/.pnpm/react-textarea-autosize@8.3.4_@types+react@16.14.34_react@16.14.0/node_modules/react-textarea-autosize/dist/react-textarea-autosize.browser.esm.js"),clsx_m=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),utils=__webpack_require__("./frontend/src/lib/utils.tsx"),Tooltip=__webpack_require__("./frontend/src/lib/lemon-ui/Tooltip.tsx"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function EditableField_EditableField_EditableField(_ref){let{name:name,value:value,onChange:onChange,onSave:onSave,saveOnBlur:saveOnBlur=!1,placeholder:placeholder,minLength:minLength,maxLength:maxLength,autoFocus:autoFocus=!0,multiline:multiline=!1,compactButtons:compactButtons=!1,paywall:paywall=!1,mode:mode,className:className,style:style,"data-attr":dataAttr,saveButtonText:saveButtonText="Save",notice:notice}=_ref;const[localIsEditing,setLocalIsEditing]=(0,react.useState)(!1),[tentativeValue,setTentativeValue]=(0,react.useState)(value);(0,react.useEffect)((()=>{setTentativeValue(value)}),[value]);const isSaveable=!minLength||tentativeValue.length>=minLength,cancel=()=>{setLocalIsEditing(!1),setTentativeValue(value)},save=()=>{onSave?.(tentativeValue),setLocalIsEditing(!1)},isEditing=!paywall&&("edit"===mode||localIsEditing),handleKeyDown=e=>{isEditing&&(isSaveable&&"Enter"===e.key&&(!multiline||e.metaKey||e.ctrlKey)?(save(),e.stopPropagation(),e.preventDefault()):"Escape"===e.key&&(cancel(),e.stopPropagation(),e.preventDefault()))};return(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.default)("EditableField",multiline&&"EditableField--multiline",isEditing&&"EditableField--editing",className),"data-attr":dataAttr,style:style,children:[(0,jsx_runtime.jsx)(Tooltip.u,{placement:"right",title:paywall?"This field is part of PostHog's collaboration feature set and requires a premium plan.":void 0,children:(0,jsx_runtime.jsx)("div",{className:"EditableField--highlight",children:isEditing?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[multiline?(0,jsx_runtime.jsx)(react_textarea_autosize_browser_esm.Z,{name:name,value:tentativeValue,onChange:e=>{onChange?.(e.target.value),setTentativeValue(e.target.value)},onBlur:saveOnBlur?tentativeValue!==value?save:cancel:void 0,onKeyDown:handleKeyDown,placeholder:placeholder,minLength:minLength,maxLength:maxLength,autoFocus:autoFocus}):(0,jsx_runtime.jsx)(AutosizeInput,{name:name,value:tentativeValue,onChange:e=>{onChange?.(e.target.value),setTentativeValue(e.target.value)},onBlur:saveOnBlur?tentativeValue!==value?save:cancel:void 0,onKeyDown:handleKeyDown,placeholder:placeholder,minLength:minLength,maxLength:maxLength,autoFocus:autoFocus}),!mode&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(LemonButton.Jp,{title:"Cancel editing",size:"small",onClick:cancel,type:"secondary",onMouseDown:e=>{e.preventDefault()},children:"Cancel"}),(0,jsx_runtime.jsx)(LemonButton.Jp,{title:minLength?`Save (at least ${(0,utils._6)(minLength,"character","characters")} required)`:"Save",size:"small",disabled:!isSaveable,onClick:save,type:"primary",children:saveButtonText})]})]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[tentativeValue||(0,jsx_runtime.jsx)("i",{children:placeholder}),!mode&&(0,jsx_runtime.jsx)(LemonButton.Jp,{title:"Edit",icon:(0,jsx_runtime.jsx)(icons.yl5,{}),size:compactButtons?"small":void 0,onClick:()=>setLocalIsEditing(!0),"data-attr":`edit-prop-${name}`,disabled:paywall,noPadding:!0})]})})}),!isEditing&&notice&&(0,jsx_runtime.jsx)(Tooltip.u,{title:notice.tooltip,placement:"right",children:react.cloneElement(notice.icon,{...notice.icon.props,className:(0,clsx_m.default)(notice.icon.props.className,"EditableField__notice")})})]})}const AutosizeInput=_ref2=>{let{name:name,value:value,onChange:onChange,placeholder:placeholder,onBlur:onBlur,onKeyDown:onKeyDown,minLength:minLength,maxLength:maxLength,autoFocus:autoFocus}=_ref2;const[inputWidth,setInputWidth]=(0,react.useState)(1),inputRef=(0,react.useRef)(null),sizerRef=(0,react.useRef)(null),placeHolderSizerRef=(0,react.useRef)(null),copyStyles=(styles,node)=>{node.style.fontSize=styles.fontSize,node.style.fontFamily=styles.fontFamily,node.style.fontWeight=styles.fontWeight,node.style.fontStyle=styles.fontStyle,node.style.letterSpacing=styles.letterSpacing,node.style.textTransform=styles.textTransform},inputStyles=(0,react.useMemo)((()=>inputRef.current?window.getComputedStyle(inputRef.current):null),[inputRef.current]);return(0,react.useLayoutEffect)((()=>{inputStyles&&placeHolderSizerRef.current&&copyStyles(inputStyles,placeHolderSizerRef.current)}),[placeHolderSizerRef,placeHolderSizerRef]),(0,react.useLayoutEffect)((()=>{inputStyles&&sizerRef.current&&copyStyles(inputStyles,sizerRef.current)}),[inputStyles,sizerRef]),(0,react.useLayoutEffect)((()=>{if(!sizerRef.current||!placeHolderSizerRef.current)return;let newInputWidth;newInputWidth=placeholder&&!value?Math.max(sizerRef.current.scrollWidth,placeHolderSizerRef.current.scrollWidth)+2:sizerRef.current.scrollWidth+2,newInputWidth!==inputWidth&&setInputWidth(newInputWidth)}),[sizerRef.current,placeHolderSizerRef.current,placeholder,value]),(0,jsx_runtime.jsxs)("div",{className:"EditableField__autosize",children:[(0,jsx_runtime.jsx)("input",{name:name,value:value,placeholder:placeholder,onChange:onChange,onKeyDown:onKeyDown,onBlur:onBlur,minLength:minLength,maxLength:maxLength,autoFocus:autoFocus,ref:inputRef,style:{boxSizing:"content-box",width:`${inputWidth}px`}}),(0,jsx_runtime.jsx)("div",{ref:sizerRef,className:"EditableField__autosize__sizer",children:value}),(0,jsx_runtime.jsx)("div",{ref:placeHolderSizerRef,className:"EditableField__autosize__sizer",children:placeholder})]})};try{EditableField_EditableField_EditableField.displayName="EditableField",EditableField_EditableField_EditableField.__docgenInfo={description:"",displayName:"EditableField",props:{name:{defaultValue:null,description:"What this field stands for.",name:"name",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((value: string) => void)"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!1,type:{name:"((value: string) => void)"}},saveOnBlur:{defaultValue:{value:"false"},description:"",name:"saveOnBlur",required:!1,type:{name:"boolean"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},minLength:{defaultValue:null,description:"",name:"minLength",required:!1,type:{name:"number"}},maxLength:{defaultValue:null,description:"",name:"maxLength",required:!1,type:{name:"number"}},autoFocus:{defaultValue:{value:"true"},description:"",name:"autoFocus",required:!1,type:{name:"boolean"}},multiline:{defaultValue:{value:"false"},description:"",name:"multiline",required:!1,type:{name:"boolean"}},compactButtons:{defaultValue:{value:"false"},description:"",name:"compactButtons",required:!1,type:{name:"boolean"}},paywall:{defaultValue:{value:"false"},description:'Whether this field should be gated behind a "paywall".',name:"paywall",required:!1,type:{name:"boolean"}},mode:{defaultValue:null,description:"Controlled mode.",name:"mode",required:!1,type:{name:"enum",value:[{value:'"view"'},{value:'"edit"'}]}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},"data-attr":{defaultValue:null,description:"",name:"data-attr",required:!1,type:{name:"string"}},saveButtonText:{defaultValue:{value:"Save"},description:"",name:"saveButtonText",required:!1,type:{name:"string"}},notice:{defaultValue:null,description:"Extra information shown next to the field.",name:"notice",required:!1,type:{name:"{ icon: ReactElement<any, string | JSXElementConstructor<any>>; tooltip: string; }"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/EditableField/EditableField.tsx#EditableField"]={docgenInfo:EditableField_EditableField_EditableField.__docgenInfo,name:"EditableField",path:"frontend/src/lib/components/EditableField/EditableField.tsx#EditableField"})}catch(__react_docgen_typescript_loader_error){}},"./frontend/src/scenes/experiments/Experiment.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Experiment:function(){return Experiment_Experiment},scene:function(){return scene}});var skeleton=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/skeleton/index.js"),col=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/col/index.js"),row=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/row/index.js"),tooltip=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/tooltip/index.js"),card=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/card/index.js"),tag=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/tag/index.js"),popconfirm=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/popconfirm/index.js"),progress=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/progress/index.js"),index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),PageHeader=__webpack_require__("./frontend/src/lib/components/PageHeader.tsx"),react=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),insightLogic=__webpack_require__("./frontend/src/scenes/insights/insightLogic.ts"),types=__webpack_require__("./frontend/src/types.ts"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/.pnpm/style-loader@2.0.0_webpack@5.88.2/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),Experiment=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/scenes/experiments/Experiment.scss"),Experiment_default=__webpack_require__.n(Experiment),options={insert:"head",singleton:!1},api=(injectStylesIntoStyleTag_default()(Experiment_default(),options),Experiment_default().locals,__webpack_require__("./frontend/src/lib/api.ts")),dayjs=__webpack_require__("./frontend/src/lib/dayjs.ts"),cleanFilters=__webpack_require__("./frontend/src/scenes/insights/utils/cleanFilters.ts"),teamLogic=__webpack_require__("./frontend/src/scenes/teamLogic.tsx"),urls=__webpack_require__("./frontend/src/scenes/urls.ts"),lib=__webpack_require__("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.5/node_modules/kea-router/lib/index.js"),experimentsLogic=__webpack_require__("./frontend/src/scenes/experiments/experimentsLogic.ts"),constants=__webpack_require__("./frontend/src/lib/constants.tsx"),eventUsageLogic=__webpack_require__("./frontend/src/lib/utils/eventUsageLogic.ts"),Tooltip=__webpack_require__("./frontend/src/lib/lemon-ui/Tooltip.tsx"),lemonToast=__webpack_require__("./frontend/src/lib/lemon-ui/lemonToast.tsx"),utils=__webpack_require__("./frontend/src/lib/utils.tsx"),kea_forms_lib=__webpack_require__("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.5/node_modules/kea-forms/lib/index.js"),kea_loaders_lib=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),icons=__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts"),featureFlagLogic=__webpack_require__("./frontend/src/scenes/feature-flags/featureFlagLogic.ts");const EXPERIMENT_INSIGHT_ID="new-experiment-insight",EXPERIMENT_EXPOSURE_INSIGHT_ID="new-experiment-exposure-insight",SECONDARY_METRIC_INSIGHT_ID="new-secondary-metric-insight";var insightVizDataLogic=__webpack_require__("./frontend/src/scenes/insights/insightVizDataLogic.ts"),filtersToQueryNode=__webpack_require__("./frontend/src/queries/nodes/InsightQuery/utils/filtersToQueryNode.ts"),insightDataLogic=__webpack_require__("./frontend/src/scenes/insights/insightDataLogic.ts"),queryNodeToFilter=__webpack_require__("./frontend/src/queries/nodes/InsightQuery/utils/queryNodeToFilter.ts"),groupsModel=__webpack_require__("./frontend/src/models/groupsModel.ts"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");const DEFAULT_DURATION=14,NEW_EXPERIMENT={id:"new",name:"",feature_flag_key:"",filters:{},parameters:{feature_flag_variants:[{key:"control",rollout_percentage:50},{key:"test",rollout_percentage:50}]},secondary_metrics:[],created_at:null,created_by:null,updated_at:null},experimentLogic=(0,index_esm.kea)([(0,index_esm.props)({}),(0,index_esm.key)((props=>props.experimentId||"new")),(0,index_esm.path)((key=>["scenes","experiment","experimentLogic",key])),(0,index_esm.connect)((()=>({values:[teamLogic.teamLogic,["currentTeamId"],groupsModel.$,["aggregationLabel","groupTypes"]],actions:[experimentsLogic.O,["updateExperiments","addToExperiments"],eventUsageLogic.vx,["reportExperimentCreated","reportExperimentViewed","reportExperimentLaunched","reportExperimentCompleted","reportExperimentArchived","reportExperimentReset"],(0,insightDataLogic.S)({dashboardItemId:EXPERIMENT_INSIGHT_ID}),["setQuery"],(0,insightVizDataLogic.Z)({dashboardItemId:EXPERIMENT_INSIGHT_ID}),["updateQuerySource"],(0,insightDataLogic.S)({dashboardItemId:EXPERIMENT_EXPOSURE_INSIGHT_ID}),["setQuery as setExposureQuery"],(0,insightVizDataLogic.Z)({dashboardItemId:EXPERIMENT_EXPOSURE_INSIGHT_ID}),["updateQuerySource as updateExposureQuerySource"]]}))),(0,index_esm.actions)({setExperiment:experiment=>({experiment:experiment}),createExperiment:(draft,runningTime,sampleSize)=>({draft:draft,runningTime:runningTime,sampleSize:sampleSize}),setNewExperimentInsight:filters=>({filters:filters}),setExperimentExposureInsight:filters=>({filters:filters}),removeExperimentGroup:idx=>({idx:idx}),setEditExperiment:editing=>({editing:editing}),setExperimentResultCalculationError:error=>({error:error}),setFlagImplementationWarning:warning=>({warning:warning}),setExposureAndSampleSize:(exposure,sampleSize)=>({exposure:exposure,sampleSize:sampleSize}),updateExperimentGoal:filters=>({filters:filters}),updateExperimentExposure:filters=>({filters:filters}),updateExperimentSecondaryMetrics:metrics=>({metrics:metrics}),launchExperiment:!0,endExperiment:!0,addExperimentGroup:!0,archiveExperiment:!0,resetRunningExperiment:!0,checkFlagImplementationWarning:!0,openExperimentGoalModal:!0,closeExperimentGoalModal:!0,openExperimentExposureModal:!0,closeExperimentExposureModal:!0}),(0,index_esm.reducers)({experiment:[{...NEW_EXPERIMENT},{setExperiment:(state,_ref)=>{let{experiment:experiment}=_ref;if(experiment.filters)return{...state,...experiment,filters:experiment.filters};if(experiment.parameters){const newParameters={...state?.parameters,...experiment.parameters};return{...state,...experiment,parameters:newParameters}}return{...state,...experiment}},addExperimentGroup:state=>{if(state?.parameters?.feature_flag_variants){const newRolloutPercentages=percentageDistribution(state.parameters.feature_flag_variants.length+1),updatedRolloutPercentageVariants=state.parameters.feature_flag_variants.map(((variant,i)=>({...variant,rollout_percentage:newRolloutPercentages[i]})));return{...state,parameters:{...state.parameters,feature_flag_variants:[...updatedRolloutPercentageVariants,{key:`test_group_${state.parameters.feature_flag_variants.length}`,rollout_percentage:newRolloutPercentages[newRolloutPercentages.length-1]}]}}}return state},removeExperimentGroup:(state,_ref2)=>{let{idx:idx}=_ref2;if(!state)return state;const variants=[...state.parameters?.feature_flag_variants||[]];variants.splice(idx,1);const newRolloutPercentages=percentageDistribution((state?.parameters?.feature_flag_variants||[]).length-1),updatedVariants=variants.map(((variant,i)=>({...variant,rollout_percentage:newRolloutPercentages[i]})));return{...state,parameters:{...state.parameters,feature_flag_variants:updatedVariants}}}}],editingExistingExperiment:[!1,{setEditExperiment:(_,_ref3)=>{let{editing:editing}=_ref3;return editing}}],changingGoalMetric:[!1,{updateExperimentGoal:()=>!0,updateExperimentExposure:()=>!0,loadExperimentResults:()=>!1}],changingSecondaryMetrics:[!1,{updateExperimentSecondaryMetrics:()=>!0,loadSecondaryMetricResults:()=>!1}],experimentResultCalculationError:[null,{setExperimentResultCalculationError:(_,_ref4)=>{let{error:error}=_ref4;return error}}],flagImplementationWarning:[!1,{setFlagImplementationWarning:(_,_ref5)=>{let{warning:warning}=_ref5;return warning}}],exposureAndSampleSize:[{exposure:0,sampleSize:0},{setExposureAndSampleSize:(_,_ref6)=>{let{exposure:exposure,sampleSize:sampleSize}=_ref6;return{exposure:exposure,sampleSize:sampleSize}}}],isExperimentGoalModalOpen:[!1,{openExperimentGoalModal:()=>!0,closeExperimentGoalModal:()=>!1}],isExperimentExposureModalOpen:[!1,{openExperimentExposureModal:()=>!0,closeExperimentExposureModal:()=>!1}],experimentValuesChangedLocally:[!1,{setExperiment:()=>!0,loadExperiment:()=>!1,updateExperiment:()=>!1}]}),(0,index_esm.listeners)((_ref7=>{let{values:values,actions:actions}=_ref7;return{createExperiment:async _ref8=>{let{draft:draft,runningTime:runningTime,sampleSize:sampleSize}=_ref8,response=null;const isUpdate=!!values.experimentId&&"new"!==values.experimentId;try{if(isUpdate){if(response=await api.ZP.update(`api/projects/${values.currentTeamId}/experiments/${values.experimentId}`,{...values.experiment,parameters:{...values.experiment?.parameters,recommended_running_time:runningTime,recommended_sample_size:sampleSize},...!draft&&{start_date:(0,dayjs.Bv)()},filters:{events:[],actions:[],...values.experiment.filters,properties:[]}}),response?.id)return actions.updateExperiments(response),actions.setEditExperiment(!1),void actions.setExperiment(response)}else response=await api.ZP.create(`api/projects/${values.currentTeamId}/experiments`,{...values.experiment,parameters:{...values.experiment?.parameters,recommended_running_time:runningTime,recommended_sample_size:sampleSize},...!draft&&{start_date:(0,dayjs.Bv)()}}),response&&actions.reportExperimentCreated(response)}catch(error){return void lemonToast.UJ.error(error.detail||"Failed to create experiment")}if(response?.id){const experimentId=response.id;lib.router.actions.push(urls.j.experiment(experimentId)),actions.addToExperiments(response),lemonToast.UJ.success("Experiment "+(isUpdate?"updated":"created"),{button:{label:"View it",action:()=>{lib.router.actions.push(urls.j.experiment(experimentId))}}})}},setNewExperimentInsight:async _ref9=>{let newInsightFilters,{filters:filters}=_ref9;const aggregationGroupTypeIndex=values.experiment.parameters?.aggregation_group_type_index;if(filters?.insight===types.dw.FUNNELS)newInsightFilters=(0,cleanFilters.Ow)({insight:types.dw.FUNNELS,funnel_viz_type:types.Ui.Steps,date_from:(0,dayjs.Bv)().subtract(DEFAULT_DURATION,"day").format("YYYY-MM-DDTHH:mm"),date_to:(0,dayjs.Bv)().endOf("d").format("YYYY-MM-DDTHH:mm"),layout:constants.xp.horizontal,aggregation_group_type_index:aggregationGroupTypeIndex,...filters});else{const groupAggregation=void 0!==aggregationGroupTypeIndex?{math:"unique_group",math_group_type_index:aggregationGroupTypeIndex}:{},eventAddition=filters?.actions||filters?.events?{}:{events:[{...(0,cleanFilters.ie)(),...groupAggregation}]};newInsightFilters=(0,cleanFilters.Ow)({insight:types.dw.TRENDS,date_from:(0,dayjs.Bv)().subtract(DEFAULT_DURATION,"day").format("YYYY-MM-DDTHH:mm"),date_to:(0,dayjs.Bv)().endOf("d").format("YYYY-MM-DDTHH:mm"),...eventAddition,...filters})}actions.updateQuerySource((0,filtersToQueryNode.wK)(newInsightFilters))},setQuery:_ref10=>{let{query:query}=_ref10;actions.setExperiment({filters:(0,queryNodeToFilter.ce)(query.source)})},setExperimentExposureInsight:async _ref11=>{let{filters:filters}=_ref11;const newInsightFilters=(0,cleanFilters.Ow)({insight:types.dw.TRENDS,date_from:(0,dayjs.Bv)().subtract(DEFAULT_DURATION,"day").format("YYYY-MM-DDTHH:mm"),date_to:(0,dayjs.Bv)().endOf("d").format("YYYY-MM-DDTHH:mm"),...filters});actions.updateExposureQuerySource((0,filtersToQueryNode.wK)(newInsightFilters))},setExposureQuery:_ref12=>{let{query:query}=_ref12;actions.setExperiment({parameters:{custom_exposure_filter:(0,queryNodeToFilter.ce)(query.source),feature_flag_variants:values.experiment?.parameters?.feature_flag_variants}})},loadExperimentSuccess:async _ref13=>{let{experiment:experiment}=_ref13;experiment&&actions.reportExperimentViewed(experiment),experiment?.start_date?(actions.loadExperimentResults(),actions.loadSecondaryMetricResults()):actions.setNewExperimentInsight(experiment?.filters)},launchExperiment:async()=>{const startDate=(0,dayjs.Bv)();actions.updateExperiment({start_date:startDate.toISOString()}),values.experiment&&eventUsageLogic.vx.actions.reportExperimentLaunched(values.experiment,startDate)},endExperiment:async()=>{const endDate=(0,dayjs.Bv)();actions.updateExperiment({end_date:endDate.toISOString()});const duration=endDate.diff(values.experiment?.start_date,"second");values.experiment&&actions.reportExperimentCompleted(values.experiment,endDate,duration,values.areResultsSignificant)},archiveExperiment:async()=>{actions.updateExperiment({archived:!0}),values.experiment&&actions.reportExperimentArchived(values.experiment)},updateExperimentGoal:async _ref14=>{let{filters:filters}=_ref14;const filtersToUpdate={...filters};delete filtersToUpdate.properties,actions.updateExperiment({filters:filtersToUpdate}),actions.closeExperimentGoalModal()},updateExperimentExposure:async _ref15=>{let{filters:filters}=_ref15;actions.updateExperiment({parameters:{custom_exposure_filter:null!=filters?filters:void 0,feature_flag_variants:values.experiment?.parameters?.feature_flag_variants}}),actions.closeExperimentExposureModal()},updateExperimentSecondaryMetrics:async _ref16=>{let{metrics:metrics}=_ref16;actions.updateExperiment({secondary_metrics:metrics})},closeExperimentGoalModal:()=>{values.experimentValuesChangedLocally&&actions.loadExperiment()},closeExperimentExposureModal:()=>{values.experimentValuesChangedLocally&&actions.loadExperiment()},resetRunningExperiment:async()=>{actions.updateExperiment({start_date:null,end_date:null,archived:!1}),values.experiment&&actions.reportExperimentReset(values.experiment),actions.loadExperimentResultsSuccess(null),actions.loadSecondaryMetricResultsSuccess([])},updateExperimentSuccess:async _ref17=>{let{experiment:experiment}=_ref17;actions.updateExperiments(experiment),values.changingGoalMetric&&actions.loadExperimentResults(),values.changingSecondaryMetrics&&actions.loadSecondaryMetricResults()},setExperiment:async _ref18=>{let{experiment:experiment}=_ref18;const experimentEntitiesChanged=experiment.filters?.events&&experiment.filters.events.length>0||experiment.filters?.actions&&experiment.filters.actions.length>0;experiment.filters&&0!==Object.keys(experiment.filters).length&&experimentEntitiesChanged&&actions.checkFlagImplementationWarning()},setExperimentValue:async(_ref19,breakpoint)=>{let{name:name,value:value}=_ref19;if(await breakpoint(100),"filters"===name){const experimentEntitiesChanged=value?.events&&value.events.length>0||value?.actions&&value.actions.length>0;if(!value||0===Object.keys(value).length)return;experimentEntitiesChanged&&actions.checkFlagImplementationWarning()}},setExperimentValues:async(_ref20,breakpoint)=>{let{values:values}=_ref20;await breakpoint(100);const experiment=values,experimentEntitiesChanged=experiment.filters?.events&&experiment.filters.events.length>0||experiment.filters?.actions&&experiment.filters.actions.length>0;experiment.filters&&0!==Object.keys(experiment.filters).length&&experimentEntitiesChanged&&actions.checkFlagImplementationWarning()},checkFlagImplementationWarning:async(_,breakpoint)=>{const experiment=values.experiment,experimentEntitiesChanged=experiment.filters?.events&&experiment.filters.events.length>0||experiment.filters?.actions&&experiment.filters.actions.length>0;if(experiment.filters&&0!==Object.keys(experiment.filters).length&&experimentEntitiesChanged){const url=`/api/projects/${values.currentTeamId}/experiments/requires_flag_implementation?${(0,utils.oZ)(experiment.filters||{})}`;await breakpoint(100);try{const response=await api.ZP.get(url);actions.setFlagImplementationWarning(response.result)}catch(e){actions.setFlagImplementationWarning(!1)}}},openExperimentGoalModal:async()=>{actions.setNewExperimentInsight(values.experiment?.filters)},openExperimentExposureModal:async()=>{actions.setExperimentExposureInsight(values.experiment?.parameters?.custom_exposure_filter)}}})),(0,kea_loaders_lib.loaders)((_ref21=>{let{actions:actions,props:props,values:values}=_ref21;return{experiment:{loadExperiment:async()=>{if(props.experimentId&&"new"!==props.experimentId)try{return await api.ZP.get(`api/projects/${values.currentTeamId}/experiments/${props.experimentId}`)}catch(error){throw 404===error.status?error:(lemonToast.UJ.error(`Failed to load experiment ${props.experimentId}`),new Error(`Failed to load experiment ${props.experimentId}`))}return NEW_EXPERIMENT},updateExperiment:async update=>await api.ZP.update(`api/projects/${values.currentTeamId}/experiments/${values.experimentId}`,update)},experimentResults:[null,{loadExperimentResults:async refresh=>{try{const refreshParam=refresh?"?refresh=true":"",response=await api.ZP.get(`api/projects/${values.currentTeamId}/experiments/${values.experimentId}/results${refreshParam}`);return{...response.result,fakeInsightId:Math.random().toString(36).substring(2,15),last_refresh:response.last_refresh}}catch(error){return actions.setExperimentResultCalculationError(error.detail),null}}}],secondaryMetricResults:[null,{loadSecondaryMetricResults:async()=>await Promise.all((values.experiment?.secondary_metrics||[]).map((async(_,index)=>{try{return(await api.ZP.get(`api/projects/${values.currentTeamId}/experiments/${values.experimentId}/secondary_results?id=${index}`)).result}catch(error){return{}}})))}]}})),(0,index_esm.selectors)({props:[()=>[(_,props)=>props],props=>props],experimentId:[()=>[(_,props)=>{var _props$experimentId;return null!==(_props$experimentId=props.experimentId)&&void 0!==_props$experimentId?_props$experimentId:"new"}],experimentId=>experimentId],experimentInsightType:[s=>[s.experiment],experiment=>experiment?.filters?.insight||types.dw.TRENDS],isExperimentRunning:[s=>[s.experiment],experiment=>!!experiment?.start_date],breadcrumbs:[s=>[s.experiment,s.experimentId],(experiment,experimentId)=>[{name:"Experiments",path:urls.j.experiments()},{name:experiment?.name||"New",path:urls.j.experiment(experimentId||"new")}]],variants:[s=>[s.experiment],experiment=>experiment?.parameters?.feature_flag_variants||[]],experimentCountPerUserMath:[s=>[s.experiment],experiment=>{const mathValue=[...experiment?.filters?.events||[],...experiment?.filters?.actions||[]].filter((entity=>Object.values(types.D7).includes(entity?.math)))[0]?.math;return mathValue}],minimumDetectableChange:[s=>[s.experiment],newexperiment=>newexperiment?.parameters?.minimum_detectable_effect||5],minimumSampleSizePerVariant:[s=>[s.minimumDetectableChange],mde=>conversionRate=>Math.ceil(1600*conversionRate*(1-conversionRate/100)/(mde*mde))],areResultsSignificant:[s=>[s.experimentResults],experimentResults=>experimentResults?.significant||!1],significanceBannerDetails:[s=>[s.experimentResults],experimentResults=>experimentResults?.significance_code===types.u7.HighLoss?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["This is because the expected loss in conversion is greater than 1%",(0,jsx_runtime.jsx)(Tooltip.u,{placement:"right",title:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Current value is ",(100*(experimentResults?.expected_loss||0))?.toFixed(2),"%"]}),children:(0,jsx_runtime.jsx)(icons.aUG,{className:"ml-1 text-muted text-xl"})}),"."]}):experimentResults?.significance_code===types.u7.HighPValue?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["This is because the p value is greater than 0.05",(0,jsx_runtime.jsx)(Tooltip.u,{placement:"right",title:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Current value is ",experimentResults?.p_value?.toFixed(3)||1,"."]}),children:(0,jsx_runtime.jsx)(icons.aUG,{className:"ml-1 text-muted text-xl"})}),"."]}):experimentResults?.significance_code===types.u7.LowWinProbability?"This is because the win probability of all test variants combined is less than 90%.":experimentResults?.significance_code===types.u7.NotEnoughExposure?"This is because we need at least 100 people per variant to declare significance.":""],recommendedExposureForCountData:[s=>[s.minimumDetectableChange],mde=>baseCountData=>{const lambda1=baseCountData,lambda2=baseCountData*mde/100+baseCountData;return parseFloat((4/Math.pow(Math.sqrt(lambda1/DEFAULT_DURATION)-Math.sqrt(lambda2/DEFAULT_DURATION),2)).toFixed(1))}],expectedRunningTime:[()=>[],()=>function(entrants,sampleSize){return parseFloat((sampleSize/(entrants/(arguments.length>2&&void 0!==arguments[2]?arguments[2]:DEFAULT_DURATION))).toFixed(1))}],conversionRateForVariant:[s=>[s.experimentResults],experimentResults=>variant=>{if(!experimentResults)return"--";const variantResults=(experimentResults?.insight).find((variantFunnel=>variantFunnel[0]?.breakdown_value?.[0]===variant));return variantResults?(variantResults[variantResults.length-1].count/variantResults[0].count*100).toFixed(1):"--"}],getIndexForVariant:[s=>[s.experimentResults],experimentResults=>(variant,insightType)=>{let result;if(experimentResults){let index=-1;index=insightType===types.dw.FUNNELS?[...experimentResults?.insight].sort(((a,b)=>b[0]?.count-a[0]?.count)).findIndex((variantFunnel=>variantFunnel[0]?.breakdown_value?.[0]===variant)):(experimentResults?.insight).findIndex((variantTrend=>variantTrend.breakdown_value===variant)),result=-1===index?0:index}else result=0;return insightType===types.dw.FUNNELS&&result++,result}],countDataForVariant:[s=>[s.experimentResults,s.experimentCountPerUserMath],(experimentResults,experimentCountPerUserMath)=>variant=>{if(!experimentResults)return"--";const variantResults=experimentResults.insight.find((variantTrend=>variantTrend.breakdown_value===variant));if(!variantResults)return"--";let result=variantResults.count;return experimentCountPerUserMath&&(result=variantResults.count/variantResults.data.length),result%1!=0?result.toFixed(2):result.toString()}],exposureCountDataForVariant:[s=>[s.experimentResults],experimentResults=>variant=>{if(!experimentResults)return"--";const variantResults=experimentResults.variants.find((variantTrend=>variantTrend.key===variant));if(!variantResults||!variantResults.absolute_exposure)return"--";const result=variantResults.absolute_exposure;return result%1!=0?result.toFixed(2):result.toString()}],highestProbabilityVariant:[s=>[s.experimentResults],experimentResults=>{if(experimentResults){const maxValue=Math.max(...Object.values(experimentResults.probability));return Object.keys(experimentResults.probability).find((key=>Math.abs(experimentResults.probability[key]-maxValue)<Number.EPSILON))}}],areTrendResultsConfusing:[s=>[s.experimentResults,s.highestProbabilityVariant],(experimentResults,highestProbabilityVariant)=>{if(!experimentResults)return!1;const variantResults=(experimentResults?.insight).reduce(((bestVariant,currentVariant)=>currentVariant.count>bestVariant.count?currentVariant:bestVariant),{count:0,breakdown_value:""});return!!variantResults.count&&variantResults.breakdown_value!==highestProbabilityVariant}],sortedExperimentResultVariants:[s=>[s.experimentResults,s.experiment],(experimentResults,experiment)=>{if(experimentResults){const sortedResults=Object.keys(experimentResults.probability).sort(((a,b)=>experimentResults.probability[b]-experimentResults.probability[a]));return experiment?.parameters?.feature_flag_variants?.forEach((variant=>{sortedResults.includes(variant.key)||sortedResults.push(variant.key)})),sortedResults}return[]}],tabularSecondaryMetricResults:[s=>[s.experiment,s.secondaryMetricResults],(experiment,secondaryMetricResults)=>{const variantsWithResults=[];return experiment?.parameters?.feature_flag_variants?.forEach((variant=>{const metricResults=[];experiment?.secondary_metrics?.forEach(((metric,idx)=>{metricResults.push({insightType:metric.filters.insight||types.dw.TRENDS,result:secondaryMetricResults?.[idx]?.[variant.key]})})),variantsWithResults.push({variant:variant.key,results:metricResults})})),variantsWithResults}]}),(0,kea_forms_lib.forms)((_ref22=>{let{actions:actions,values:values}=_ref22;return{experiment:{defaults:{...NEW_EXPERIMENT},errors:_ref23=>{let{name:name,feature_flag_key:feature_flag_key,parameters:parameters}=_ref23;return{name:!name&&"You have to enter a name.",feature_flag_key:(0,featureFlagLogic.Q)(feature_flag_key),parameters:{feature_flag_variants:parameters.feature_flag_variants?.map((_ref24=>{let{key:key}=_ref24;return{key:key.match?.(/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed."}}))}}},submit:()=>{const{exposure:exposure,sampleSize:sampleSize}=values.exposureAndSampleSize;actions.createExperiment(!0,exposure,sampleSize)}}}})),(0,lib.urlToAction)((_ref25=>{let{actions:actions,values:values}=_ref25;return{"/experiments/:id":(_ref26,_,__,currentLocation,previousLocation)=>{let{id:id}=_ref26;const didPathChange=currentLocation.initial||currentLocation.pathname!==previousLocation?.pathname;if(actions.setEditExperiment(!1),id&&didPathChange){const parsedId="new"===id?"new":parseInt(id);"new"===parsedId&&(actions.resetExperiment(),actions.setNewExperimentInsight()),"new"!==parsedId&&parsedId===values.experimentId&&actions.loadExperiment()}}}}))]);function percentageDistribution(variantCount){const percentageRounded=Math.round(100/variantCount),delta=percentageRounded*variantCount-100,percentages=new Array(variantCount).fill(percentageRounded);return percentages[variantCount-1]=percentageRounded-delta,percentages}var CloseOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),InfoCircleOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),CopyToClipboard=__webpack_require__("./frontend/src/lib/components/CopyToClipboard.tsx"),TaxonomicFilter_types=__webpack_require__("./frontend/src/lib/components/TaxonomicFilter/types.ts"),ActionFilter=__webpack_require__("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilter.tsx");const defaultFormValuesGenerator=(aggregationType,disableAddEventToDefault)=>{const groupAggregation=void 0!==aggregationType?{math:"unique_group",math_group_type_index:aggregationType}:{},eventAddition=disableAddEventToDefault?{}:{events:[{...(0,cleanFilters.ie)(),...groupAggregation}]};return{name:"",filters:{insight:types.dw.TRENDS,...eventAddition}}},secondaryMetricsLogic=(0,index_esm.kea)([(0,index_esm.props)({}),(0,index_esm.key)((props=>`${props.experimentId}-${props.defaultAggregationType}`||`new-${props.defaultAggregationType}`)),(0,index_esm.path)((key=>["scenes","experiment","secondaryMetricsLogic",key])),(0,index_esm.connect)({logic:[(0,insightLogic.zm)({dashboardItemId:SECONDARY_METRIC_INSIGHT_ID,syncWithUrl:!1})],values:[teamLogic.teamLogic,["currentTeamId"]],actions:[(0,insightDataLogic.S)({dashboardItemId:SECONDARY_METRIC_INSIGHT_ID}),["setQuery"],(0,insightVizDataLogic.Z)({dashboardItemId:SECONDARY_METRIC_INSIGHT_ID}),["updateQuerySource"]]}),(0,index_esm.actions)({openModalToCreateSecondaryMetric:!0,openModalToEditSecondaryMetric:(metric,metricIdx)=>({metric:metric,metricIdx:metricIdx}),saveSecondaryMetric:!0,closeModal:!0,setMetricId:metricIdx=>({metricIdx:metricIdx}),addNewMetric:metric=>({metric:metric}),updateMetric:(metric,metricIdx)=>({metric:metric,metricIdx:metricIdx}),deleteMetric:metricIdx=>({metricIdx:metricIdx}),setPreviewInsight:filters=>({filters:filters})}),(0,index_esm.reducers)((_ref=>{let{props:props}=_ref;return{isModalOpen:[!1,{openModalToCreateSecondaryMetric:()=>!0,openModalToEditSecondaryMetric:()=>!0,closeModal:()=>!1}],existingModalSecondaryMetric:[null,{openModalToCreateSecondaryMetric:()=>null,openModalToEditSecondaryMetric:(_,_ref2)=>{let{metric:metric}=_ref2;return metric}}],metrics:[props.initialMetrics,{addNewMetric:(metrics,_ref3)=>{let{metric:metric}=_ref3;return[...metrics,{...metric}]},updateMetric:(metrics,_ref4)=>{let{metric:metric,metricIdx:metricIdx}=_ref4;const metricsCopy=[...metrics];return metricsCopy[metricIdx]=metric,metricsCopy},deleteMetric:(metrics,_ref5)=>{let{metricIdx:metricIdx}=_ref5;return metrics.filter(((_,idx)=>idx!==metricIdx))}}],metricIdx:[0,{setMetricId:(_,_ref6)=>{let{metricIdx:metricIdx}=_ref6;return metricIdx}}]}})),(0,kea_forms_lib.forms)((_ref7=>{let{props:props}=_ref7;return{secondaryMetricModal:{defaults:defaultFormValuesGenerator(props.defaultAggregationType),errors:()=>({}),submit:async()=>{}}}})),(0,index_esm.listeners)((_ref8=>{let{props:props,actions:actions,values:values}=_ref8;return{openModalToCreateSecondaryMetric:()=>{actions.resetSecondaryMetricModal(),actions.setPreviewInsight(defaultFormValuesGenerator(props.defaultAggregationType).filters)},openModalToEditSecondaryMetric:_ref9=>{let{metric:{name:name,filters:filters},metricIdx:metricIdx}=_ref9;actions.setSecondaryMetricModalValue("name",name),actions.setPreviewInsight(filters),actions.setMetricId(metricIdx)},setPreviewInsight:async _ref10=>{let newInsightFilters,{filters:filters}=_ref10;newInsightFilters=filters?.insight===types.dw.FUNNELS?(0,cleanFilters.Ow)({insight:types.dw.FUNNELS,funnel_viz_type:types.Ui.Steps,date_from:(0,dayjs.Bv)().subtract(14,"day").format("YYYY-MM-DD"),date_to:(0,dayjs.Bv)().endOf("d").format("YYYY-MM-DDTHH:mm"),layout:constants.xp.horizontal,aggregation_group_type_index:props.defaultAggregationType,...filters}):(0,cleanFilters.Ow)({insight:types.dw.TRENDS,date_from:(0,dayjs.Bv)().subtract(14,"day").format("YYYY-MM-DD"),date_to:(0,dayjs.Bv)().endOf("d").format("YYYY-MM-DDTHH:mm"),...defaultFormValuesGenerator(props.defaultAggregationType,(filters?.actions?.length||0)+(filters?.events?.length||0)>0).filters,...filters}),actions.updateQuerySource((0,filtersToQueryNode.wK)(newInsightFilters))},setQuery:_ref11=>{let{query:query}=_ref11;actions.setSecondaryMetricModalValue("filters",(0,queryNodeToFilter.ce)(query.source))},saveSecondaryMetric:()=>{values.existingModalSecondaryMetric?actions.updateMetric(values.secondaryMetricModal,values.metricIdx):actions.addNewMetric(values.secondaryMetricModal),props.onMetricsChange(values.metrics),actions.closeModal()},deleteMetric:()=>{props.onMetricsChange(values.metrics)}}}))]);var LemonButton=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/index.ts"),ActionFilterRow=__webpack_require__("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilterRow/ActionFilterRow.tsx"),src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),Field=__webpack_require__("./frontend/src/lib/forms/Field.tsx"),SamplingFilter=__webpack_require__("./frontend/src/scenes/insights/EditorFilters/SamplingFilter.tsx"),Query=__webpack_require__("./frontend/src/queries/Query/Query.tsx"),AggregationSelect=__webpack_require__("./frontend/src/scenes/insights/filters/AggregationSelect.tsx"),FunnelConversionWindowFilter=__webpack_require__("./frontend/src/scenes/insights/views/Funnels/FunnelConversionWindowFilter.tsx"),AttributionFilter=__webpack_require__("./frontend/src/scenes/insights/EditorFilters/AttributionFilter.tsx"),TestAccountFilter=__webpack_require__("./frontend/src/queries/nodes/InsightViz/filters/TestAccountFilter.tsx"),LemonBanner=__webpack_require__("./frontend/src/lib/lemon-ui/LemonBanner/index.ts");function MetricSelector(_ref){let{dashboardItemId:dashboardItemId,setPreviewInsight:setPreviewInsight,showDateRangeBanner:showDateRangeBanner}=_ref;const logic=(0,insightLogic.zm)({dashboardItemId:dashboardItemId,syncWithUrl:!1}),{insightProps:insightProps}=(0,index_esm.useValues)(logic),{query:query}=(0,index_esm.useValues)((0,insightDataLogic.S)(insightProps)),{isTrends:isTrends}=(0,index_esm.useValues)((0,insightVizDataLogic.Z)(insightProps));return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center w-full gap-2 mb-4",children:[(0,jsx_runtime.jsx)("span",{children:"Insight Type"}),(0,jsx_runtime.jsx)(src.LemonSelect,{value:isTrends?types.dw.TRENDS:types.dw.FUNNELS,onChange:val=>{val&&setPreviewInsight({insight:val})},options:[{value:types.dw.TRENDS,label:(0,jsx_runtime.jsx)("b",{children:"Trends"})},{value:types.dw.FUNNELS,label:(0,jsx_runtime.jsx)("b",{children:"Funnels"})}]})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(SamplingFilter.V,{insightProps:insightProps,infoTooltipContent:"Sampling on experiment goals is an Alpha feature to enable faster computation of experiment results."}),(0,jsx_runtime.jsx)("br",{})]}),(0,jsx_runtime.jsx)(ExperimentInsightCreator,{insightProps:insightProps}),showDateRangeBanner&&(0,jsx_runtime.jsxs)(LemonBanner.V,{type:"info",className:"mt-3 mb-3",children:["Preview insights are generated based on ",DEFAULT_DURATION," days of data. This can cause a mismatch between the preview and the actual results."]}),(0,jsx_runtime.jsx)("div",{className:"mt-4",children:(0,jsx_runtime.jsx)(index_esm.BindLogic,{logic:insightLogic.zm,props:insightProps,children:(0,jsx_runtime.jsx)(Query.A,{query:query,context:{insightProps:insightProps},readOnly:!0})})})]})}function ExperimentInsightCreator(_ref2){let{insightProps:insightProps}=_ref2;const{isTrends:isTrends,series:series,querySource:querySource}=(0,index_esm.useValues)((0,insightVizDataLogic.Z)(insightProps)),{updateQuerySource:updateQuerySource}=(0,index_esm.useActions)((0,insightVizDataLogic.Z)(insightProps)),filterSteps=series||[],isStepsEmpty=0===filterSteps.length;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(ActionFilter.T,{bordered:!0,filters:(0,queryNodeToFilter.ce)(querySource),setFilters:payload=>{updateQuerySource({series:(0,filtersToQueryNode.NG)(payload)})},typeKey:`experiment-${isTrends?types.dw.TRENDS:types.dw.FUNNELS}-secondary-metric`,mathAvailability:isTrends?void 0:ActionFilterRow.Qq.None,hideDeleteBtn:isTrends||1===filterSteps.length,buttonCopy:isTrends?"Add graph series":"Add funnel step",showSeriesIndicator:isTrends||!isStepsEmpty,entitiesLimit:isTrends?1:void 0,seriesIndicatorType:isTrends?void 0:"numeric",sortable:!isTrends||void 0,showNestedArrow:!isTrends||void 0,propertiesTaxonomicGroupTypes:[TaxonomicFilter_types.t.EventProperties,TaxonomicFilter_types.t.PersonProperties,TaxonomicFilter_types.t.EventFeatureFlags,TaxonomicFilter_types.t.Cohorts,TaxonomicFilter_types.t.Elements,TaxonomicFilter_types.t.HogQLExpression]}),(0,jsx_runtime.jsxs)("div",{className:"mt-4 space-y-4",children:[!isTrends&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center w-full gap-2",children:[(0,jsx_runtime.jsx)("span",{children:"Aggregating by"}),(0,jsx_runtime.jsx)(AggregationSelect.C,{insightProps:insightProps,hogqlAvailable:!0})]}),(0,jsx_runtime.jsx)(FunnelConversionWindowFilter.I,{insightProps:insightProps}),(0,jsx_runtime.jsx)(AttributionSelect,{insightProps:insightProps,query:querySource,setQuery:updateQuerySource})]}),(0,jsx_runtime.jsx)(TestAccountFilter.z,{query:querySource,setQuery:updateQuerySource})]})]})}function AttributionSelect(_ref3){let{insightProps:insightProps,query:query,setQuery:setQuery}=_ref3;return(0,jsx_runtime.jsxs)("div",{className:"flex items-center w-full gap-2",children:[(0,jsx_runtime.jsxs)("span",{children:["Attribution type",(0,jsx_runtime.jsx)(Tooltip.u,{title:(0,jsx_runtime.jsxs)("div",{children:["When breaking funnels down by a property, you can choose how to assign users to the various property values. This is useful because property values can change for a user/group as someone travels through the funnel.",(0,jsx_runtime.jsxs)("ul",{className:"list-disc pl-4 pt-4",children:[(0,jsx_runtime.jsx)("li",{children:"First step: the first property value seen from all steps is chosen."}),(0,jsx_runtime.jsx)("li",{children:"Last step: last property value seen from all steps is chosen."}),(0,jsx_runtime.jsx)("li",{children:"Specific step: the property value seen at that specific step is chosen."}),(0,jsx_runtime.jsx)("li",{children:"All steps: the property value must be seen in all steps."}),(0,jsx_runtime.jsx)("li",{children:"Any step: the property value must be seen on at least one step of the funnel."})]})]}),children:(0,jsx_runtime.jsx)(InfoCircleOutlined.Z,{className:"info-indicator"})})]}),(0,jsx_runtime.jsx)(AttributionFilter.x,{insightProps:insightProps,query:query,setQuery:setQuery})]})}try{MetricSelector.displayName="MetricSelector",MetricSelector.__docgenInfo={description:"",displayName:"MetricSelector",props:{dashboardItemId:{defaultValue:null,description:"",name:"dashboardItemId",required:!0,type:{name:"InsightShortId"}},setPreviewInsight:{defaultValue:null,description:"",name:"setPreviewInsight",required:!0,type:{name:"(filters?: Partial<FilterType> | undefined) => void"}},showDateRangeBanner:{defaultValue:null,description:"",name:"showDateRangeBanner",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/MetricSelector.tsx#MetricSelector"]={docgenInfo:MetricSelector.__docgenInfo,name:"MetricSelector",path:"frontend/src/scenes/experiments/MetricSelector.tsx#MetricSelector"})}catch(__react_docgen_typescript_loader_error){}try{ExperimentInsightCreator.displayName="ExperimentInsightCreator",ExperimentInsightCreator.__docgenInfo={description:"",displayName:"ExperimentInsightCreator",props:{insightProps:{defaultValue:null,description:"",name:"insightProps",required:!0,type:{name:"InsightLogicProps"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/MetricSelector.tsx#ExperimentInsightCreator"]={docgenInfo:ExperimentInsightCreator.__docgenInfo,name:"ExperimentInsightCreator",path:"frontend/src/scenes/experiments/MetricSelector.tsx#ExperimentInsightCreator"})}catch(__react_docgen_typescript_loader_error){}try{AttributionSelect.displayName="AttributionSelect",AttributionSelect.__docgenInfo={description:"",displayName:"AttributionSelect",props:{query:{defaultValue:null,description:"",name:"query",required:!0,type:{name:"InsightQueryNode"}},setQuery:{defaultValue:null,description:"",name:"setQuery",required:!0,type:{name:"(node: InsightQueryNode) => void"}},insightProps:{defaultValue:null,description:"",name:"insightProps",required:!0,type:{name:"InsightLogicProps"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/MetricSelector.tsx#AttributionSelect"]={docgenInfo:AttributionSelect.__docgenInfo,name:"AttributionSelect",path:"frontend/src/scenes/experiments/MetricSelector.tsx#AttributionSelect"})}catch(__react_docgen_typescript_loader_error){}var colors=__webpack_require__("./frontend/src/lib/colors.ts");function SecondaryMetrics(_ref){let{onMetricsChange:onMetricsChange,initialMetrics:initialMetrics,experimentId:experimentId,defaultAggregationType:defaultAggregationType}=_ref;const logic=secondaryMetricsLogic({onMetricsChange:onMetricsChange,initialMetrics:initialMetrics,experimentId:experimentId,defaultAggregationType:defaultAggregationType}),{metrics:metrics,isModalOpen:isModalOpen,isSecondaryMetricModalSubmitting:isSecondaryMetricModalSubmitting,existingModalSecondaryMetric:existingModalSecondaryMetric,metricIdx:metricIdx}=(0,index_esm.useValues)(logic),{deleteMetric:deleteMetric,openModalToCreateSecondaryMetric:openModalToCreateSecondaryMetric,openModalToEditSecondaryMetric:openModalToEditSecondaryMetric,closeModal:closeModal,saveSecondaryMetric:saveSecondaryMetric,setPreviewInsight:setPreviewInsight}=(0,index_esm.useActions)(logic),{secondaryMetricResultsLoading:secondaryMetricResultsLoading,isExperimentRunning:isExperimentRunning,getIndexForVariant:getIndexForVariant,experiment:experiment,editingExistingExperiment:editingExistingExperiment,tabularSecondaryMetricResults:tabularSecondaryMetricResults}=(0,index_esm.useValues)(experimentLogic({experimentId:experimentId})),columns=[{key:"variant",title:"Variant",render:function Key(_,item){return(0,jsx_runtime.jsx)("div",{style:{color:(0,colors._r)(getIndexForVariant(item.variant,experiment.filters?.insight||types.dw.TRENDS))},children:(0,jsx_runtime.jsx)("span",{className:"text-sm",children:(0,utils.fm)(item.variant)})})},sorter:(a,b)=>String(a.variant).localeCompare(String(b.variant))}];return experiment.secondary_metrics?.forEach(((metric,idx)=>{columns.push({key:`results_${idx}`,title:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)("b",{children:(0,utils.fm)(metric.name)})}),(0,jsx_runtime.jsx)("div",{className:"flex",onClick:event=>event.stopPropagation(),children:(0,jsx_runtime.jsx)(LemonButton.Jp,{icon:(0,jsx_runtime.jsx)(icons.yl5,{}),size:"small",status:"muted",onClick:()=>openModalToEditSecondaryMetric(metric,idx)})})]}),align:"right",render:function Key(_,item){return(0,jsx_runtime.jsx)("div",{children:item.results?.[idx].result?item.results[idx].insightType===types.dw.FUNNELS?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(100*item.results[idx].result).toFixed(1),"%"]}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,utils.Lc)(item.results[idx].result)}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"--"})})},sorter:(a,b)=>{var _a$results$idx$result,_b$results$idx$result;return(null!==(_a$results$idx$result=a.results?.[idx].result)&&void 0!==_a$results$idx$result?_a$results$idx$result:0)-(null!==(_b$results$idx$result=b.results?.[idx].result)&&void 0!==_b$results$idx$result?_b$results$idx$result:0)}})})),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(src.LemonModal,{isOpen:isModalOpen,onClose:closeModal,width:1e3,title:existingModalSecondaryMetric?"Edit secondary metric":"New secondary metric",footer:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[existingModalSecondaryMetric&&(0,jsx_runtime.jsx)(LemonButton.Jp,{className:"mr-auto",form:"secondary-metric-modal-form",type:"secondary",status:"danger",onClick:()=>deleteMetric(metricIdx),children:"Delete"}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(LemonButton.Jp,{form:"secondary-metric-modal-form",type:"secondary",onClick:closeModal,children:"Cancel"}),(0,jsx_runtime.jsx)(LemonButton.Jp,{form:"secondary-metric-modal-form",onClick:saveSecondaryMetric,type:"primary",loading:isSecondaryMetricModalSubmitting,"data-attr":"create-annotation-submit",children:existingModalSecondaryMetric?"Save":"Create"})]})]}),children:(0,jsx_runtime.jsxs)(kea_forms_lib.Form,{logic:secondaryMetricsLogic,props:{onMetricsChange:onMetricsChange,initialMetrics:initialMetrics,experimentId:experimentId},formKey:"secondaryMetricModal",id:"secondary-metric-modal-form",className:"space-y-4",children:[(0,jsx_runtime.jsx)(Field.g,{name:"name",label:"Name",children:(0,jsx_runtime.jsx)(src.LemonInput,{})}),(0,jsx_runtime.jsx)(Field.g,{name:"filters",label:"Query",children:(0,jsx_runtime.jsx)(MetricSelector,{dashboardItemId:SECONDARY_METRIC_INSIGHT_ID,setPreviewInsight:setPreviewInsight,showDateRangeBanner:isExperimentRunning})})]})}),"new"==experimentId||editingExistingExperiment?(0,jsx_runtime.jsx)(row.Z,{children:(0,jsx_runtime.jsxs)(col.Z,{children:[metrics.map(((metric,idx)=>(0,jsx_runtime.jsxs)(row.Z,{className:"mt-4 border rounded p-4",children:[(0,jsx_runtime.jsxs)(row.Z,{align:"middle",justify:"space-between",className:"w-full mb-3 pb-2 border-b",children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)("b",{children:metric.name})}),(0,jsx_runtime.jsxs)("div",{className:"flex",children:[(0,jsx_runtime.jsx)(LemonButton.Jp,{icon:(0,jsx_runtime.jsx)(icons.yl5,{}),size:"small",status:"muted",onClick:()=>openModalToEditSecondaryMetric(metric,idx)}),(0,jsx_runtime.jsx)(LemonButton.Jp,{icon:(0,jsx_runtime.jsx)(icons.Fzz,{}),size:"small",status:"muted",onClick:()=>deleteMetric(idx)})]})]}),metric.filters.insight===types.dw.FUNNELS&&(0,jsx_runtime.jsx)(ActionFilter.T,{bordered:!0,filters:metric.filters,setFilters:()=>{},typeKey:`funnel-preview-${idx}`,mathAvailability:ActionFilterRow.Qq.None,buttonCopy:"Add funnel step",seriesIndicatorType:"numeric",sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[TaxonomicFilter_types.t.EventProperties,TaxonomicFilter_types.t.PersonProperties,TaxonomicFilter_types.t.EventFeatureFlags,TaxonomicFilter_types.t.Cohorts,TaxonomicFilter_types.t.Elements],readOnly:!0}),metric.filters.insight===types.dw.TRENDS&&(0,jsx_runtime.jsx)(ActionFilter.T,{bordered:!0,filters:metric.filters,setFilters:()=>{},typeKey:`trend-preview-${idx}`,buttonCopy:"Add graph series",showSeriesIndicator:!0,entitiesLimit:1,propertiesTaxonomicGroupTypes:[TaxonomicFilter_types.t.EventProperties,TaxonomicFilter_types.t.PersonProperties,TaxonomicFilter_types.t.EventFeatureFlags,TaxonomicFilter_types.t.Cohorts,TaxonomicFilter_types.t.Elements],readOnly:!0})]},idx))),metrics&&!(metrics.length>2)&&(0,jsx_runtime.jsx)(col.Z,{children:(0,jsx_runtime.jsx)("div",{className:"mb-2 mt-4",children:(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"secondary",onClick:openModalToCreateSecondaryMetric,children:"Add metric"})})})]})}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary mt-4 mb-1",children:"Secondary metrics"}),metrics&&metrics.length>0?(0,jsx_runtime.jsx)(src.LemonTable,{loading:secondaryMetricResultsLoading,columns:columns,dataSource:tabularSecondaryMetricResults}):isExperimentRunning?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"--"}),metrics&&!(metrics.length>2)&&isExperimentRunning&&(0,jsx_runtime.jsx)("div",{className:"mb-2 mt-4 justify-end",children:(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"secondary",size:"small",onClick:openModalToCreateSecondaryMetric,children:"Add metric"})})]})]})}try{SecondaryMetrics.displayName="SecondaryMetrics",SecondaryMetrics.__docgenInfo={description:"",displayName:"SecondaryMetrics",props:{onMetricsChange:{defaultValue:null,description:"",name:"onMetricsChange",required:!0,type:{name:"(metrics: SecondaryExperimentMetric[]) => void"}},initialMetrics:{defaultValue:null,description:"",name:"initialMetrics",required:!0,type:{name:"SecondaryExperimentMetric[]"}},experimentId:{defaultValue:null,description:"",name:"experimentId",required:!0,type:{name:'number | "new"'}},defaultAggregationType:{defaultValue:null,description:"",name:"defaultAggregationType",required:!1,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/SecondaryMetrics.tsx#SecondaryMetrics"]={docgenInfo:SecondaryMetrics.__docgenInfo,name:"SecondaryMetrics",path:"frontend/src/scenes/experiments/SecondaryMetrics.tsx#SecondaryMetrics"})}catch(__react_docgen_typescript_loader_error){}var EntityFilterInfo=__webpack_require__("./frontend/src/lib/components/EntityFilterInfo.tsx"),EditableField=__webpack_require__("./frontend/src/lib/components/EditableField/EditableField.tsx"),Link=__webpack_require__("./frontend/src/lib/lemon-ui/Link/index.ts"),slider=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/slider/index.js"),input_number=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/input-number/index.js"),InsightLabel=__webpack_require__("./frontend/src/lib/components/InsightLabel/index.tsx"),PropertyFilterButton=__webpack_require__("./frontend/src/lib/components/PropertyFilters/components/PropertyFilterButton.tsx");function ExperimentWorkflow(){const[workflowValidateStepCompleted,setWorkflowValidateStepCompleted]=(0,react.useState)(!1),[workflowLaunchStepCompleted,setWorkflowLaunchStepCompleted]=(0,react.useState)(!1);return(0,jsx_runtime.jsxs)(card.Z,{className:"experiment-workflow",title:(0,jsx_runtime.jsx)("span",{className:"card-secondary",children:"Experiment workflow"}),children:[(0,jsx_runtime.jsx)(row.Z,{children:(0,jsx_runtime.jsxs)(col.Z,{className:"exp-workflow-step step-completed w-full",children:[(0,jsx_runtime.jsxs)(row.Z,{align:"middle",children:[(0,jsx_runtime.jsx)(icons.DLh,{style:{color:"var(--primary)",fontSize:24}}),(0,jsx_runtime.jsx)("b",{className:"ml-2",children:"Create experiment"})]}),(0,jsx_runtime.jsx)("div",{className:"ml-8",children:"Set variants, select participants, and add secondary metrics"})]})}),(0,jsx_runtime.jsx)(row.Z,{children:(0,jsx_runtime.jsxs)(col.Z,{className:"w-full exp-workflow-step "+(workflowValidateStepCompleted?"step-completed":""),onClick:()=>setWorkflowValidateStepCompleted(!workflowValidateStepCompleted),children:[(0,jsx_runtime.jsxs)(row.Z,{align:"middle",children:[workflowValidateStepCompleted?(0,jsx_runtime.jsx)(icons.DLh,{style:{color:"var(--primary)",fontSize:24}}):(0,jsx_runtime.jsx)(icons.i4j,{}),(0,jsx_runtime.jsx)("b",{className:"ml-2",children:"Validate experiment"})]}),(0,jsx_runtime.jsx)("div",{className:"ml-8",children:"Once you've written your code, it's a good idea to test that each variant behaves as you'd expect."})]})}),(0,jsx_runtime.jsx)(row.Z,{children:(0,jsx_runtime.jsxs)(col.Z,{className:"w-full exp-workflow-step "+(workflowLaunchStepCompleted?"step-completed":""),onClick:()=>setWorkflowLaunchStepCompleted(!workflowLaunchStepCompleted),children:[(0,jsx_runtime.jsxs)(row.Z,{align:"middle",children:[workflowLaunchStepCompleted?(0,jsx_runtime.jsx)(icons.DLh,{style:{color:"var(--primary)",fontSize:24}}):(0,jsx_runtime.jsx)(icons.i4j,{}),(0,jsx_runtime.jsx)("b",{className:"ml-2",children:"Launch experiment"})]}),(0,jsx_runtime.jsx)("div",{className:"ml-8",children:"Run your experiment, monitor results, and decide when to terminate your experiment."})]})})]})}var TZLabel=__webpack_require__("./frontend/src/lib/components/TZLabel/index.tsx"),FeatureFlags=__webpack_require__("./frontend/src/scenes/feature-flags/FeatureFlags.tsx");function ExperimentPreview(_ref){let{experimentId:experimentId,trendCount:trendCount,funnelConversionRate:funnelConversionRate,trendExposure:trendExposure,funnelSampleSize:funnelSampleSize,funnelEntrants:funnelEntrants}=_ref;const{experimentInsightType:experimentInsightType,editingExistingExperiment:editingExistingExperiment,minimumDetectableChange:minimumDetectableChange,expectedRunningTime:expectedRunningTime,aggregationLabel:aggregationLabel,experiment:experiment,isExperimentGoalModalOpen:isExperimentGoalModalOpen,isExperimentExposureModalOpen:isExperimentExposureModalOpen,experimentLoading:experimentLoading,experimentCountPerUserMath:experimentCountPerUserMath}=(0,index_esm.useValues)(experimentLogic({experimentId:experimentId})),{setExperiment:setExperiment,openExperimentGoalModal:openExperimentGoalModal,closeExperimentGoalModal:closeExperimentGoalModal,updateExperimentGoal:updateExperimentGoal,openExperimentExposureModal:openExperimentExposureModal,closeExperimentExposureModal:closeExperimentExposureModal,updateExperimentExposure:updateExperimentExposure,setNewExperimentInsight:setNewExperimentInsight,setExperimentExposureInsight:setExperimentExposureInsight}=(0,index_esm.useActions)(experimentLogic({experimentId:experimentId})),sliderMaxValue=experimentInsightType===types.dw.FUNNELS&&100-funnelConversionRate<50?100-funnelConversionRate:50,currentDuration=(0,dayjs.Bv)().diff((0,dayjs.Bv)(experiment?.start_date),"hour");let runningTime=0;runningTime=experiment?.start_date?expectedRunningTime(funnelEntrants||1,funnelSampleSize||0,currentDuration):expectedRunningTime(funnelEntrants||1,funnelSampleSize||0);const expectedEndDate=(0,dayjs.Bv)(experiment?.start_date).add(runningTime,"hour"),showEndDate=!experiment?.end_date&&currentDuration>=24&&funnelEntrants&&funnelSampleSize,targetingProperties=experiment.feature_flag?.filters;return(0,jsx_runtime.jsxs)(row.Z,{children:[(0,jsx_runtime.jsxs)(col.Z,{span:experiment?.start_date||"new"===experimentId||editingExistingExperiment?24:12,children:["new"===experimentId&&(0,jsx_runtime.jsx)(row.Z,{className:"experiment-preview-row",children:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)("b",{children:"Experiment preview"})}),(0,jsx_runtime.jsxs)("div",{className:"text-muted",children:["Here are the baseline metrics for your experiment. Adjust your minimum detectible threshold to adjust for the smallest conversion value you'll accept, and the experiment duration."," "]})]})}),("new"===experimentId||editingExistingExperiment)&&(0,jsx_runtime.jsx)(row.Z,{className:"mb-4",children:(0,jsx_runtime.jsxs)(col.Z,{span:24,children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("b",{children:"Minimum acceptable improvement"}),(0,jsx_runtime.jsx)(tooltip.Z,{title:"Minimum acceptable improvement is a calculation that estimates the smallest significant improvement you are willing to accept.",children:(0,jsx_runtime.jsx)(icons.aUG,{className:"ml-1 text-muted text-xl"})})]}),(0,jsx_runtime.jsxs)(row.Z,{className:"mde-slider",children:[(0,jsx_runtime.jsx)(col.Z,{span:8,children:(0,jsx_runtime.jsx)(slider.Z,{defaultValue:5,value:minimumDetectableChange,min:1,max:sliderMaxValue,trackStyle:{background:"var(--primary)"},handleStyle:{background:"var(--primary)"},onChange:value=>{setExperiment({parameters:{...experiment.parameters,minimum_detectable_effect:value}})},tipFormatter:value=>`${value}%`})}),(0,jsx_runtime.jsx)(input_number.Z,{min:1,max:sliderMaxValue,defaultValue:5,formatter:value=>`${value}%`,style:{margin:"0 16px"},value:minimumDetectableChange,onChange:value=>{setExperiment({parameters:{...experiment.parameters,minimum_detectable_effect:value}})}})]})]})}),(0,jsx_runtime.jsxs)(row.Z,{className:"experiment-preview-row "+(experiment?.start_date?"mr":""),children:[experimentInsightType===types.dw.TRENDS?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[!experiment?.start_date&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(col.Z,{span:6,children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary",children:"Baseline Count"}),(0,jsx_runtime.jsx)("div",{className:"l4",children:(0,utils.Lc)(trendCount||0)})]}),(0,jsx_runtime.jsxs)(col.Z,{span:6,children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary",children:"Minimum Acceptable Count"}),(0,jsx_runtime.jsx)("div",{className:"l4",children:(0,utils.Lc)(trendCount+Math.ceil(trendCount*(minimumDetectableChange/100))||0)})]})]}),(0,jsx_runtime.jsxs)(col.Z,{span:12,children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary",children:"Recommended running time"}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("span",{className:"l4",children:["~",(0,utils.Lc)(trendExposure||0)]})," days"]})]})]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[!experiment?.start_date&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(col.Z,{span:12,children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary",children:"Baseline Conversion Rate"}),(0,jsx_runtime.jsxs)("div",{className:"l4",children:[funnelConversionRate.toFixed(1),"%"]})]}),(0,jsx_runtime.jsxs)(col.Z,{span:12,children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary",children:"Minimum Acceptable Conversion Rate"}),(0,jsx_runtime.jsxs)("div",{className:"l4",children:[(funnelConversionRate+minimumDetectableChange).toFixed(1),"%"]})]})]}),(0,jsx_runtime.jsxs)(col.Z,{span:12,children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary",children:"Recommended Sample Size"}),(0,jsx_runtime.jsxs)("div",{className:"pb-4",children:[(0,jsx_runtime.jsxs)("span",{className:"l4",children:["~",(0,utils.Lc)(funnelSampleSize||0)]})," persons"]})]}),!experiment?.start_date&&(0,jsx_runtime.jsxs)(col.Z,{span:12,children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary",children:"Recommended running time"}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("span",{className:"l4",children:["~",(0,utils.Lc)(runningTime||0)]})," days"]})]})]}),(0,jsx_runtime.jsxs)(row.Z,{className:"w-full mt-4",children:[(0,jsx_runtime.jsxs)(col.Z,{span:12,children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary",children:"Experiment variants"}),(0,jsx_runtime.jsx)("ul",{className:"variants-list",children:experiment?.parameters?.feature_flag_variants?.map(((variant,idx)=>(0,jsx_runtime.jsx)("li",{children:variant.key},idx)))})]}),(0,jsx_runtime.jsxs)(col.Z,{span:12,children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary",children:"Participants"}),(0,jsx_runtime.jsx)("div",{style:{display:"inline-block"},children:targetingProperties?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,FeatureFlags.groupFilters)(targetingProperties,void 0,aggregationLabel),(0,jsx_runtime.jsx)(src.LemonButton,{to:experiment.feature_flag?urls.j.featureFlag(experiment.feature_flag.id):void 0,size:"small",className:"mt-0.5",type:"secondary",center:!0,children:"Check flag release conditions"})]}):"100% of all users"})]})]}),(0,jsx_runtime.jsxs)(row.Z,{className:"w-full",children:["new"!==experimentId&&!editingExistingExperiment&&(0,jsx_runtime.jsxs)(col.Z,{span:12,children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary mt-4",children:"Start date"}),experiment?.start_date?(0,jsx_runtime.jsx)(TZLabel.w,{time:experiment?.start_date}):(0,jsx_runtime.jsx)("span",{className:"description",children:"Not started yet"})]}),experimentInsightType===types.dw.FUNNELS&&showEndDate?(0,jsx_runtime.jsxs)(col.Z,{span:12,children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary mt-4",children:"Expected end date"}),(0,jsx_runtime.jsx)("span",{children:expectedEndDate.isAfter((0,dayjs.Bv)())?expectedEndDate.format("D MMM YYYY"):(0,dayjs.Bv)().format("D MMM YYYY")})]}):null,experiment?.end_date&&(0,jsx_runtime.jsxs)(col.Z,{span:12,children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary mt-4",children:"Completed date"}),(0,jsx_runtime.jsx)(TZLabel.w,{time:experiment?.end_date})]})]})]}),"new"!==experimentId&&!editingExistingExperiment&&(0,jsx_runtime.jsx)(row.Z,{className:"experiment-preview-row",children:(0,jsx_runtime.jsxs)(col.Z,{children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary mb-2",children:experimentInsightType===types.dw.FUNNELS?"Conversion goal steps":"Trend goal"}),(0,jsx_runtime.jsx)(MetricDisplay,{filters:experiment.filters}),experiment?.start_date&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"mb-2 mt-4",children:(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",onClick:openExperimentGoalModal,children:"Change experiment goal"})}),experimentInsightType===types.dw.TRENDS&&!experimentCountPerUserMath&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"card-secondary mb-2 mt-4",children:["Exposure metric",(0,jsx_runtime.jsx)(tooltip.Z,{title:`This metric determines how we calculate exposure for the experiment. Only users who have this event alongside the property '$feature/${experiment.feature_flag_key}' are included in exposure calculations.`,children:(0,jsx_runtime.jsx)(icons.aUG,{className:"ml-1 text-muted text-sm"})})]}),experiment.parameters?.custom_exposure_filter?(0,jsx_runtime.jsx)(MetricDisplay,{filters:experiment.parameters.custom_exposure_filter}):(0,jsx_runtime.jsx)("span",{className:"description",children:"Default via $feature_flag_called events"}),(0,jsx_runtime.jsx)("div",{className:"mb-2 mt-2",children:(0,jsx_runtime.jsxs)("span",{className:"flex",children:[(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",size:"small",onClick:openExperimentExposureModal,className:"mr-2",children:"Change exposure metric"}),experiment.parameters?.custom_exposure_filter&&(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",size:"small",status:"danger",className:"mr-2",onClick:()=>updateExperimentExposure(null),children:"Reset exposure"})]})})]})]})]})})]}),"new"!==experimentId&&!editingExistingExperiment&&!experiment?.start_date&&(0,jsx_runtime.jsx)(col.Z,{span:12,className:"pl-4",children:(0,jsx_runtime.jsx)(ExperimentWorkflow,{})}),(0,jsx_runtime.jsx)(src.LemonModal,{isOpen:isExperimentGoalModalOpen,onClose:closeExperimentGoalModal,width:1e3,title:"Change experiment goal",footer:(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(src.LemonButton,{form:"edit-experiment-goal-form",type:"secondary",onClick:closeExperimentGoalModal,children:"Cancel"}),(0,jsx_runtime.jsx)(src.LemonButton,{form:"edit-experiment-goal-form",onClick:()=>{updateExperimentGoal(experiment.filters)},type:"primary",loading:experimentLoading,"data-attr":"create-annotation-submit",children:"Save"})]}),children:(0,jsx_runtime.jsx)(kea_forms_lib.Form,{logic:experimentLogic,props:{experimentId:experimentId},formKey:"experiment",id:"edit-experiment-goal-form",className:"space-y-4",children:(0,jsx_runtime.jsx)(kea_forms_lib.Field,{name:"filters",children:(0,jsx_runtime.jsx)(MetricSelector,{dashboardItemId:EXPERIMENT_INSIGHT_ID,setPreviewInsight:setNewExperimentInsight,showDateRangeBanner:!0})})})}),(0,jsx_runtime.jsx)(src.LemonModal,{isOpen:isExperimentExposureModalOpen,onClose:closeExperimentExposureModal,width:1e3,title:"Change experiment exposure",footer:(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(src.LemonButton,{form:"edit-experiment-exposure-form",type:"secondary",onClick:closeExperimentExposureModal,children:"Cancel"}),(0,jsx_runtime.jsx)(src.LemonButton,{form:"edit-experiment-exposure-form",onClick:()=>{experiment.parameters.custom_exposure_filter&&updateExperimentExposure(experiment.parameters.custom_exposure_filter)},type:"primary",loading:experimentLoading,"data-attr":"create-annotation-submit",children:"Save"})]}),children:(0,jsx_runtime.jsx)(kea_forms_lib.Form,{logic:experimentLogic,props:{experimentId:experimentId},formKey:"experiment",id:"edit-experiment-exposure-form",className:"space-y-4",children:(0,jsx_runtime.jsx)(kea_forms_lib.Field,{name:"filters",children:(0,jsx_runtime.jsx)(MetricSelector,{dashboardItemId:EXPERIMENT_EXPOSURE_INSIGHT_ID,setPreviewInsight:setExperimentExposureInsight})})})})]})}function MetricDisplay(_ref2){let{filters:filters}=_ref2;const experimentInsightType=filters?.insight||types.dw.TRENDS;return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:[...filters?.events||[],...filters?.actions||[]].sort(((a,b)=>(a.order||0)-(b.order||0))).map(((event,idx)=>(0,jsx_runtime.jsxs)(col.Z,{className:"mb-2",children:[(0,jsx_runtime.jsxs)(row.Z,{style:{marginBottom:4},children:[(0,jsx_runtime.jsx)("div",{className:"preview-conversion-goal-num",children:experimentInsightType===types.dw.FUNNELS?(event.order||0)+1:idx+1}),(0,jsx_runtime.jsx)("b",{children:(0,jsx_runtime.jsx)(InsightLabel.q,{action:event,showCountedByTag:experimentInsightType===types.dw.TRENDS,hideIcon:!0,showEventName:!0})})]}),event.properties?.map((prop=>(0,jsx_runtime.jsx)(PropertyFilterButton.C,{item:prop},prop.key)))]},idx)))})}try{ExperimentPreview.displayName="ExperimentPreview",ExperimentPreview.__docgenInfo={description:"",displayName:"ExperimentPreview",props:{experimentId:{defaultValue:null,description:"",name:"experimentId",required:!0,type:{name:'number | "new"'}},trendCount:{defaultValue:null,description:"",name:"trendCount",required:!0,type:{name:"number"}},trendExposure:{defaultValue:null,description:"",name:"trendExposure",required:!1,type:{name:"number"}},funnelSampleSize:{defaultValue:null,description:"",name:"funnelSampleSize",required:!1,type:{name:"number"}},funnelConversionRate:{defaultValue:null,description:"",name:"funnelConversionRate",required:!0,type:{name:"number"}},funnelEntrants:{defaultValue:null,description:"",name:"funnelEntrants",required:!1,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentPreview.tsx#ExperimentPreview"]={docgenInfo:ExperimentPreview.__docgenInfo,name:"ExperimentPreview",path:"frontend/src/scenes/experiments/ExperimentPreview.tsx#ExperimentPreview"})}catch(__react_docgen_typescript_loader_error){}try{MetricDisplay.displayName="MetricDisplay",MetricDisplay.__docgenInfo={description:"",displayName:"MetricDisplay",props:{filters:{defaultValue:null,description:"",name:"filters",required:!1,type:{name:"FilterType"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentPreview.tsx#MetricDisplay"]={docgenInfo:MetricDisplay.__docgenInfo,name:"MetricDisplay",path:"frontend/src/scenes/experiments/ExperimentPreview.tsx#MetricDisplay"})}catch(__react_docgen_typescript_loader_error){}var es_select=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/select/index.js"),CaretDownOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/CaretDownOutlined.js"),CodeSnippet=__webpack_require__("./frontend/src/lib/components/CodeSnippet/index.ts");function ServerSideWarning(){return(0,jsx_runtime.jsx)("div",{className:"warning",children:(0,jsx_runtime.jsxs)("p",{children:[(0,jsx_runtime.jsx)("b",{children:"Warning:"})," Server side experiment metrics require you to manually send the feature flag information."," ",(0,jsx_runtime.jsx)(src.Link,{to:"https://posthog.com/tutorials/experiments#step-2-sending-the-right-events",target:"_blank",children:"See this tutorial for more information."})]})})}function NodeJSSnippet(_ref){let{flagKey:flagKey,variant:variant}=_ref;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(CodeSnippet.O,{language:CodeSnippet.S.JavaScript,wrap:!0,children:`const experimentFlagValue = await client.getFeatureFlag('${flagKey}', 'user distinct id')\n\nif (experimentFlagValue === '${variant}' ) {\n    // Do something differently for this user\n} else {\n    // It's a good idea to let control variant always be the default behaviour,\n    // so if something goes wrong with flag evaluation, you don't break your app.\n}`}),(0,jsx_runtime.jsx)(ServerSideWarning,{})]})}function JSSnippet(_ref2){let{flagKey:flagKey,variant:variant}=_ref2;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(CodeSnippet.O,{language:CodeSnippet.S.JavaScript,wrap:!0,children:`if (posthog.getFeatureFlag('${flagKey}') === '${variant}') {\n    // Do something differently for this user\n} else {\n    // It's a good idea to let control variant always be the default behaviour,\n    // so if something goes wrong with flag evaluation, you don't break your app.\n}`}),(0,jsx_runtime.jsx)("b",{children:"Test that it works"}),(0,jsx_runtime.jsx)(CodeSnippet.O,{language:CodeSnippet.S.JavaScript,wrap:!0,children:`posthog.feature_flags.override({'${flagKey}': '${variant}'})`})]})}function RNSnippet(_ref3){let{flagKey:flagKey,variant:variant}=_ref3;return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(CodeSnippet.O,{language:CodeSnippet.S.JavaScript,wrap:!0,children:`if (posthog.getFeatureFlag('${flagKey}') === '${variant}') {\n    // Do something differently for this user\n} else {\n    // It's a good idea to let control variant always be the default behaviour,\n    // so if something goes wrong with flag evaluation, you don't break your app.\n}`})})}function PHPSnippet(_ref4){let{flagKey:flagKey,variant:variant}=_ref4;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(CodeSnippet.O,{language:CodeSnippet.S.PHP,wrap:!0,children:`if (PostHog::getFeatureFlag('${flagKey}', 'user distinct id') == '${variant}') {\n    // Do something differently for this user\n} else {\n    // It's a good idea to let control variant always be the default behaviour,\n    // so if something goes wrong with flag evaluation, you don't break your app.\n}`}),(0,jsx_runtime.jsx)(ServerSideWarning,{})]})}function GolangSnippet(_ref5){let{flagKey:flagKey,variant:variant}=_ref5;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(CodeSnippet.O,{language:CodeSnippet.S.Go,wrap:!0,children:`experimentFlagValue, err := client.GetFeatureFlag(\n                    FeatureFlagPayload{\n                        Key:        '${flagKey}',\n                        DistinctId: "distinct-id",\n                    })\n\nif (experimentFlagValue == '${variant}' ) {\n    // Do something differently for this user\n} else {\n    // It's a good idea to let control variant always be the default behaviour,\n    // so if something goes wrong with flag evaluation, you don't break your app.\n}`}),(0,jsx_runtime.jsx)(ServerSideWarning,{})]})}function RubySnippet(_ref6){let{flagKey:flagKey,variant:variant}=_ref6;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(CodeSnippet.O,{language:CodeSnippet.S.Ruby,wrap:!0,children:`experimentFlagValue = posthog.get_feature_flag('${flagKey}', 'user distinct id')\n\n\nif experimentFlagValue == '${variant}'\n    # Do something differently for this user\nelse\n    # It's a good idea to let control variant always be the default behaviour,\n    # so if something goes wrong with flag evaluation, you don't break your app.\nend\n`}),(0,jsx_runtime.jsx)(ServerSideWarning,{})]})}function PythonSnippet(_ref7){let{flagKey:flagKey,variant:variant}=_ref7;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(CodeSnippet.O,{language:CodeSnippet.S.Python,wrap:!0,children:`experiment_flag_value = posthog.get_feature_flag("${flagKey}", "user_distinct_id"):\n\nif experiment_flag_value == '${variant}':\n    # Do something differently for this user\nelse:\n    # It's a good idea to let control variant always be the default behaviour,\n    # so if something goes wrong with flag evaluation, you don't break your app.\n`}),(0,jsx_runtime.jsx)(ServerSideWarning,{})]})}try{NodeJSSnippet.displayName="NodeJSSnippet",NodeJSSnippet.__docgenInfo={description:"",displayName:"NodeJSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#NodeJSSnippet"]={docgenInfo:NodeJSSnippet.__docgenInfo,name:"NodeJSSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#NodeJSSnippet"})}catch(__react_docgen_typescript_loader_error){}try{JSSnippet.displayName="JSSnippet",JSSnippet.__docgenInfo={description:"",displayName:"JSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#JSSnippet"]={docgenInfo:JSSnippet.__docgenInfo,name:"JSSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#JSSnippet"})}catch(__react_docgen_typescript_loader_error){}try{RNSnippet.displayName="RNSnippet",RNSnippet.__docgenInfo={description:"",displayName:"RNSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RNSnippet"]={docgenInfo:RNSnippet.__docgenInfo,name:"RNSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RNSnippet"})}catch(__react_docgen_typescript_loader_error){}try{PHPSnippet.displayName="PHPSnippet",PHPSnippet.__docgenInfo={description:"",displayName:"PHPSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PHPSnippet"]={docgenInfo:PHPSnippet.__docgenInfo,name:"PHPSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PHPSnippet"})}catch(__react_docgen_typescript_loader_error){}try{GolangSnippet.displayName="GolangSnippet",GolangSnippet.__docgenInfo={description:"",displayName:"GolangSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#GolangSnippet"]={docgenInfo:GolangSnippet.__docgenInfo,name:"GolangSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#GolangSnippet"})}catch(__react_docgen_typescript_loader_error){}try{RubySnippet.displayName="RubySnippet",RubySnippet.__docgenInfo={description:"",displayName:"RubySnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RubySnippet"]={docgenInfo:RubySnippet.__docgenInfo,name:"RubySnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RubySnippet"})}catch(__react_docgen_typescript_loader_error){}try{PythonSnippet.displayName="PythonSnippet",PythonSnippet.__docgenInfo={description:"",displayName:"PythonSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PythonSnippet"]={docgenInfo:PythonSnippet.__docgenInfo,name:"PythonSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PythonSnippet"})}catch(__react_docgen_typescript_loader_error){}const UTM_TAGS="?utm_medium=in-product&utm_campaign=experiment",DOC_BASE_URL="https://posthog.com/docs/integrate/",FF_ANCHOR="#feature-flags",OPTIONS=[{value:"JavaScript",documentationLink:`${DOC_BASE_URL}client/js${UTM_TAGS}${FF_ANCHOR}`,Icon:icons.RQU,Snippet:JSSnippet},{value:"ReactNative",documentationLink:`${DOC_BASE_URL}client/react-native${UTM_TAGS}${FF_ANCHOR}`,Icon:icons.RQU,Snippet:RNSnippet},{value:"Node.js",documentationLink:`${DOC_BASE_URL}server/node${UTM_TAGS}${FF_ANCHOR}`,Icon:icons.fSG,Snippet:NodeJSSnippet},{value:"PHP",documentationLink:`${DOC_BASE_URL}server/php${UTM_TAGS}${FF_ANCHOR}`,Icon:icons.W7e,Snippet:PHPSnippet},{value:"Ruby",documentationLink:`${DOC_BASE_URL}server/ruby${UTM_TAGS}${FF_ANCHOR}`,Icon:icons.gz4,Snippet:RubySnippet},{value:"Golang",documentationLink:`${DOC_BASE_URL}server/go${UTM_TAGS}${FF_ANCHOR}`,Icon:icons.GHI,Snippet:GolangSnippet},{value:"Python",documentationLink:`${DOC_BASE_URL}server/python${UTM_TAGS}${FF_ANCHOR}`,Icon:icons.Bmf,Snippet:PythonSnippet}];function CodeLanguageSelect(_ref){let{selectedOptionValue:selectedOptionValue,selectOption:selectOption}=_ref;return(0,jsx_runtime.jsx)(es_select.Z,{value:selectedOptionValue,onChange:selectOption,style:{minWidth:120},suffixIcon:(0,jsx_runtime.jsx)(CaretDownOutlined.Z,{}),children:OPTIONS.map(((_ref2,index)=>{let{value:value,Icon:Icon}=_ref2;return(0,jsx_runtime.jsx)(es_select.Z.Option,{"data-attr":"experiment-instructions-select-option-"+value,value:value,children:(0,jsx_runtime.jsxs)("div",{className:"flex items-center",children:[(0,jsx_runtime.jsx)(Icon,{className:"mr-1"})," ",value]})},index)}))})}function ExperimentImplementationDetails(_ref3){var _experiment$parameter,_experiment$feature_f;let{experiment:experiment}=_ref3;const defaultVariant=null!==(_experiment$parameter=experiment?.parameters?.feature_flag_variants?.[1]?.key)&&void 0!==_experiment$parameter?_experiment$parameter:"test",[currentVariant,setCurrentVariant]=(0,react.useState)(defaultVariant),[defaultSelectedOption]=OPTIONS,[selectedOption,setSelectedOption]=(0,react.useState)(defaultSelectedOption);return(0,jsx_runtime.jsxs)(card.Z,{title:(0,jsx_runtime.jsx)("span",{className:"card-secondary",children:"Feature flag usage and implementation"}),className:"experiment-implementation-details",children:[(0,jsx_runtime.jsxs)("div",{style:{justifyContent:"space-between"},className:"flex mb-2",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("span",{className:"mr-2",children:"Variant group"}),(0,jsx_runtime.jsx)(es_select.Z,{onChange:setCurrentVariant,value:currentVariant,style:{minWidth:80},suffixIcon:(0,jsx_runtime.jsx)(CaretDownOutlined.Z,{}),children:experiment?.parameters?.feature_flag_variants?.map(((variant,idx)=>(0,jsx_runtime.jsx)(es_select.Z.Option,{value:variant.key,children:variant.key},idx)))})]}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(CodeLanguageSelect,{selectOption:selectedValue=>{const option=OPTIONS.find((option=>option.value===selectedValue));option&&setSelectedOption(option)},selectedOptionValue:selectedOption.value})})]}),(0,jsx_runtime.jsx)("b",{children:"Implement your experiment in code"}),(0,jsx_runtime.jsx)(selectedOption.Snippet,{variant:currentVariant,flagKey:null!==(_experiment$feature_f=experiment?.feature_flag?.key)&&void 0!==_experiment$feature_f?_experiment$feature_f:""}),(0,jsx_runtime.jsx)(src.Link,{to:selectedOption.documentationLink,target:"_blank",children:"See the docs for more implementation information."})]})}try{CodeLanguageSelect.displayName="CodeLanguageSelect",CodeLanguageSelect.__docgenInfo={description:"",displayName:"CodeLanguageSelect",props:{selectedOptionValue:{defaultValue:null,description:"",name:"selectedOptionValue",required:!0,type:{name:"string"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(selectedValue: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#CodeLanguageSelect"]={docgenInfo:CodeLanguageSelect.__docgenInfo,name:"CodeLanguageSelect",path:"frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#CodeLanguageSelect"})}catch(__react_docgen_typescript_loader_error){}try{ExperimentImplementationDetails.displayName="ExperimentImplementationDetails",ExperimentImplementationDetails.__docgenInfo={description:"",displayName:"ExperimentImplementationDetails",props:{experiment:{defaultValue:null,description:"",name:"experiment",required:!0,type:{name:"Partial<Experiment> | null"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#ExperimentImplementationDetails"]={docgenInfo:ExperimentImplementationDetails.__docgenInfo,name:"ExperimentImplementationDetails",path:"frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#ExperimentImplementationDetails"})}catch(__react_docgen_typescript_loader_error){}var NotFound=__webpack_require__("./frontend/src/lib/components/NotFound/index.tsx"),userLogic=__webpack_require__("./frontend/src/scenes/userLogic.ts"),ExperimentsPayGate=__webpack_require__("./frontend/src/scenes/experiments/ExperimentsPayGate.tsx"),LemonCollapse=__webpack_require__("./frontend/src/lib/lemon-ui/LemonCollapse/index.ts"),schema=__webpack_require__("./frontend/src/queries/schema.ts"),funnelDataLogic=__webpack_require__("./frontend/src/scenes/funnels/funnelDataLogic.ts"),trendsDataLogic=__webpack_require__("./frontend/src/scenes/trends/trendsDataLogic.ts"),More=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/More.tsx");const scene={component:Experiment_Experiment,logic:experimentLogic,paramsToProps:_ref=>{let{params:{id:id}}=_ref;return{experimentId:"new"===id?"new":parseInt(id)}}};function Experiment_Experiment(){var _experiment$parameter,_experiment$parameter2;const{experimentId:experimentId,experiment:experiment,minimumSampleSizePerVariant:minimumSampleSizePerVariant,recommendedExposureForCountData:recommendedExposureForCountData,variants:variants,experimentResults:experimentResults,countDataForVariant:countDataForVariant,exposureCountDataForVariant:exposureCountDataForVariant,editingExistingExperiment:editingExistingExperiment,experimentInsightType:experimentInsightType,experimentResultsLoading:experimentResultsLoading,experimentLoading:experimentLoading,areResultsSignificant:areResultsSignificant,conversionRateForVariant:conversionRateForVariant,getIndexForVariant:getIndexForVariant,significanceBannerDetails:significanceBannerDetails,areTrendResultsConfusing:areTrendResultsConfusing,isExperimentRunning:isExperimentRunning,experimentResultCalculationError:experimentResultCalculationError,flagImplementationWarning:flagImplementationWarning,props:props,sortedExperimentResultVariants:sortedExperimentResultVariants,aggregationLabel:aggregationLabel,groupTypes:groupTypes,experimentCountPerUserMath:experimentCountPerUserMath}=(0,index_esm.useValues)(experimentLogic),{launchExperiment:launchExperiment,setEditExperiment:setEditExperiment,endExperiment:endExperiment,addExperimentGroup:addExperimentGroup,updateExperiment:updateExperiment,removeExperimentGroup:removeExperimentGroup,setNewExperimentInsight:setNewExperimentInsight,archiveExperiment:archiveExperiment,resetRunningExperiment:resetRunningExperiment,loadExperiment:loadExperiment,loadExperimentResults:loadExperimentResults,setExposureAndSampleSize:setExposureAndSampleSize,updateExperimentSecondaryMetrics:updateExperimentSecondaryMetrics,setExperiment:setExperiment}=(0,index_esm.useActions)(experimentLogic),{hasAvailableFeature:hasAvailableFeature}=(0,index_esm.useValues)(userLogic.userLogic),[showWarning,setShowWarning]=(0,react.useState)(!0),logic=(0,insightLogic.zm)({dashboardItemId:EXPERIMENT_INSIGHT_ID}),{insightProps:insightProps}=(0,index_esm.useValues)(logic),{query:query}=(0,index_esm.useValues)((0,insightDataLogic.S)(insightProps)),{conversionMetrics:conversionMetrics,results:results}=(0,index_esm.useValues)((0,funnelDataLogic.l)(insightProps)),{results:trendResults}=(0,index_esm.useValues)((0,trendsDataLogic.i)(insightProps)),conversionRate=100*conversionMetrics.totalRate,sampleSize=minimumSampleSizePerVariant(conversionRate)*variants.length,trendCount=trendResults[0]?.count,entrants=results?.[0]?.count,exposure=recommendedExposureForCountData(trendCount),secondaryColumnSpan=Math.floor(24/(variants.length+2));(0,react.useEffect)((()=>{setExposureAndSampleSize(exposure,sampleSize)}),[exposure,sampleSize]);const funnelResultsPersonsTotal=experimentInsightType===types.dw.FUNNELS&&experimentResults?.insight?experimentResults.insight.reduce(((sum,variantResult)=>variantResult[0]?.count+sum),0):0,experimentProgressPercent=experimentInsightType===types.dw.FUNNELS?(funnelResultsPersonsTotal||0)/(experiment?.parameters?.recommended_sample_size||1)*100:(0,dayjs.Bv)().diff(experiment?.start_date,"day")/(experiment?.parameters?.recommended_running_time||1)*100,status=()=>isExperimentRunning?experiment?.end_date?"complete":"running":"draft",variantLabelColors=[{background:"#35416b",color:"#fff"},{background:"#C278CE66",color:"#35416B"},{background:"#FFE6AE",color:"#35416B"},{background:"#8DA9E74D",color:"#35416B"}];return hasAvailableFeature(types.P$.EXPERIMENTATION)?experimentLoading?(0,jsx_runtime.jsx)(skeleton.Z,{active:!0}):experiment||"new"===experimentId?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"new"===experimentId||editingExistingExperiment?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)(kea_forms_lib.Form,{logic:experimentLogic,formKey:"experiment",props:props,id:"experiment-form",enableFormOnSubmit:!0,className:"space-y-4 experiment-form",children:[(0,jsx_runtime.jsx)(PageHeader.m,{title:editingExistingExperiment?"Edit experiment":"New experiment",buttons:(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(LemonButton.Jp,{"data-attr":"cancel-experiment",type:"secondary",onClick:()=>{editingExistingExperiment?(setEditExperiment(!1),loadExperiment()):lib.router.actions.push(urls.j.experiments())},disabled:experimentLoading,children:"Cancel"}),(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"primary","data-attr":"save-experiment",htmlType:"submit",loading:experimentLoading,disabled:experimentLoading,children:editingExistingExperiment?"Save":"Save as draft"})]})}),(0,jsx_runtime.jsx)(src.LemonDivider,{}),(0,jsx_runtime.jsx)(index_esm.BindLogic,{logic:insightLogic.zm,props:insightProps,children:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-col gap-2",style:{maxWidth:"50%"},children:[(0,jsx_runtime.jsx)(Field.g,{name:"name",label:"Name",children:(0,jsx_runtime.jsx)(src.LemonInput,{"data-attr":"experiment-name"})}),(0,jsx_runtime.jsx)(Field.g,{name:"feature_flag_key",label:"Feature flag key",children:(0,jsx_runtime.jsx)(src.LemonInput,{"data-attr":"experiment-feature-flag-key",disabled:editingExistingExperiment})}),(0,jsx_runtime.jsx)(Field.g,{name:"description",label:(0,jsx_runtime.jsxs)("div",{children:["Description ",(0,jsx_runtime.jsx)("span",{className:"text-muted",children:"(optional)"})]}),children:(0,jsx_runtime.jsx)(src.LemonTextArea,{"data-attr":"experiment-description",className:"ph-ignore-input",placeholder:"Adding a helpful description can ensure others know what this experiment is about."})}),experiment.parameters.feature_flag_variants&&(0,jsx_runtime.jsxs)(col.Z,{children:[(0,jsx_runtime.jsx)("label",{children:(0,jsx_runtime.jsx)("b",{children:"Experiment variants"})}),(0,jsx_runtime.jsx)("div",{className:"text-muted",children:"Participants are divided into variant groups evenly. All experiments must consist of a control group and at least one test group. Experiments may have at most 9 test groups. Variant names can only contain letters, numbers, hyphens, and underscores."}),(0,jsx_runtime.jsxs)(col.Z,{className:"variants",children:[experiment.parameters.feature_flag_variants?.map(((variant,index)=>(0,jsx_runtime.jsx)(kea_forms_lib.Group,{name:["parameters","feature_flag_variants",index],children:(0,jsx_runtime.jsxs)(row.Z,{className:"feature-flag-variant "+(0===index?"border-t":index>=10?"border-b":""),children:[(0,jsx_runtime.jsx)("div",{className:"variant-label",style:0===index?{...variantLabelColors[index]}:{...variantLabelColors[index%3+1]},children:0===index?"Control":"Test"}),(0,jsx_runtime.jsx)(Field.g,{name:"key",className:"extend-variant-fully",children:(0,jsx_runtime.jsx)(src.LemonInput,{disabled:0===index||"new"!==experimentId,"data-attr":"experiment-variant-key","data-key-index":index.toString(),className:"ph-ignore-input",fullWidth:!0,placeholder:`example-variant-${index+1}`,autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})}),(0,jsx_runtime.jsx)("div",{className:"float-right",children:"new"===experimentId&&!(0===index||1===index)&&(0,jsx_runtime.jsx)(tooltip.Z,{title:"Delete this variant",placement:"bottomLeft",children:(0,jsx_runtime.jsx)(LemonButton.Jp,{status:"primary-alt",size:"small",icon:(0,jsx_runtime.jsx)(icons.Fzz,{}),onClick:()=>removeExperimentGroup(index)})})})]},`${variant}-${index}`)},index))),(null!==(_experiment$parameter=experiment.parameters.feature_flag_variants.length)&&void 0!==_experiment$parameter?_experiment$parameter:0)<10&&"new"===experimentId&&(0,jsx_runtime.jsx)("div",{className:"feature-flag-variant border-b",children:(0,jsx_runtime.jsx)(LemonButton.Jp,{onClick:()=>addExperimentGroup(),icon:(0,jsx_runtime.jsx)(icons.yZf,{}),children:"Add test variant"})})]})]})]}),(0,jsx_runtime.jsx)(row.Z,{className:"person-selection",children:(0,jsx_runtime.jsxs)(col.Z,{span:12,children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)("strong",{children:"Select participants"})}),(0,jsx_runtime.jsxs)("div",{className:"text-muted mb-4",children:["Experiments use feature flags to target users. By default, 100% of participants will be targeted. For any advanced options like changing the rollout percentage, and targeting by groups, you can"," ","new"===experimentId?"change settings on the feature flag after saving this experiment.":(0,jsx_runtime.jsx)(Link.r,{to:experiment.feature_flag?urls.j.featureFlag(experiment.feature_flag.id):void 0,children:"change settings on the feature flag."})]}),"new"===experimentId&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"mt-4",children:(0,jsx_runtime.jsx)("strong",{children:"Default participant type"})}),(0,jsx_runtime.jsx)("div",{className:"text-muted mb-4",children:"This sets default aggregation type for all metrics and feature flags. You can change this at any time by updating the metric or feature flag."}),(0,jsx_runtime.jsx)(src.LemonSelect,{value:null!=experiment.parameters.aggregation_group_type_index?experiment.parameters.aggregation_group_type_index:-1,"data-attr":"participant-aggregation-filter",dropdownMatchSelectWidth:!1,onChange:rawGroupTypeIndex=>{const groupTypeIndex=-1!==rawGroupTypeIndex?rawGroupTypeIndex:void 0;setExperiment({parameters:{...experiment.parameters,aggregation_group_type_index:null!=groupTypeIndex?groupTypeIndex:void 0}}),setNewExperimentInsight()},options:[{value:-1,label:"Persons"},...groupTypes.map((groupType=>({value:groupType.group_type_index,label:(0,utils.fm)(aggregationLabel(groupType.group_type_index).plural)})))]})]})]})}),(0,jsx_runtime.jsxs)(row.Z,{className:"metrics-selection",children:[(0,jsx_runtime.jsxs)(col.Z,{span:12,children:[(0,jsx_runtime.jsxs)("div",{className:"mb-2","data-attr":"experiment-goal-type",children:[(0,jsx_runtime.jsx)("b",{children:"Goal type"}),(0,jsx_runtime.jsx)("div",{className:"text-muted",children:experimentInsightType===types.dw.TRENDS?"Track counts of a specific event or action":"Track how many persons complete a sequence of actions and or events"})]}),(0,jsx_runtime.jsx)(src.LemonSelect,{value:experimentInsightType,onChange:val=>{val&&setNewExperimentInsight({insight:val,properties:experiment?.filters?.properties})},dropdownMatchSelectWidth:!1,options:[{value:types.dw.TRENDS,label:"Trend"},{value:types.dw.FUNNELS,label:"Conversion funnel"}]}),(0,jsx_runtime.jsxs)("div",{className:"my-4",children:[(0,jsx_runtime.jsx)("b",{children:"Experiment goal"}),experimentInsightType===types.dw.TRENDS&&(0,jsx_runtime.jsx)("div",{className:"text-muted",children:"Trend-based experiments can have at most one graph series. This metric is used to track the progress of your experiment."})]}),flagImplementationWarning&&(0,jsx_runtime.jsxs)(LemonBanner.V,{type:"info",className:"mt-3 mb-3",children:["We can't detect any feature flag information for this target metric. Ensure that you're using the latest PostHog client libraries, and make sure you manually send feature flag information for server-side libraries if necessary."," ",(0,jsx_runtime.jsxs)("a",{href:"https://posthog.com/docs/integrate/server/python#capture",target:"_blank",children:[" ","Read the docs for how to do this for server-side libraries."]})]}),(0,jsx_runtime.jsx)(ExperimentInsightCreator,{insightProps:insightProps})]}),(0,jsx_runtime.jsxs)(col.Z,{span:12,className:"pl-4",children:[(0,jsx_runtime.jsx)("div",{className:"card-secondary mb-4","data-attr":"experiment-preview",children:"Goal preview"}),(0,jsx_runtime.jsx)(index_esm.BindLogic,{logic:insightLogic.zm,props:insightProps,children:(0,jsx_runtime.jsx)(Query.A,{query:query,context:{insightProps:insightProps},readOnly:!0})})]})]}),(0,jsx_runtime.jsx)(Field.g,{name:"secondary_metrics",children:_ref2=>{let{value:value,onChange:onChange}=_ref2;return(0,jsx_runtime.jsx)(row.Z,{className:"secondary-metrics",children:(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("b",{children:"Secondary metrics"}),(0,jsx_runtime.jsx)("span",{className:"text-muted ml-2",children:"(optional)"})]}),(0,jsx_runtime.jsxs)("div",{className:"text-muted mt-1",children:["Use secondary metrics to monitor metrics related to your experiment goal. You can add up to three secondary metrics."," "]}),(0,jsx_runtime.jsx)(SecondaryMetrics,{onMetricsChange:onChange,initialMetrics:value,experimentId:experiment.id,defaultAggregationType:experiment.parameters?.aggregation_group_type_index})]})})}}),(0,jsx_runtime.jsx)(card.Z,{className:"experiment-preview",children:(0,jsx_runtime.jsx)(ExperimentPreview,{experimentId:experiment.id,trendCount:trendCount,trendExposure:exposure,funnelSampleSize:sampleSize,funnelEntrants:entrants,funnelConversionRate:conversionRate})}),(0,jsx_runtime.jsx)(row.Z,{})]})}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[(0,jsx_runtime.jsx)(LemonButton.Jp,{"data-attr":"cancel-experiment",type:"secondary",onClick:()=>{editingExistingExperiment?(setEditExperiment(!1),loadExperiment()):lib.router.actions.push(urls.j.experiments())},disabled:experimentLoading,children:"Cancel"}),(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"primary","data-attr":"save-experiment",htmlType:"submit",loading:experimentLoading,disabled:experimentLoading,children:editingExistingExperiment?"Save":"Save as draft"})]})]})}):experiment?(0,jsx_runtime.jsxs)("div",{className:"view-experiment",children:[(0,jsx_runtime.jsxs)(row.Z,{className:"draft-header",children:[(0,jsx_runtime.jsxs)(row.Z,{justify:"space-between",align:"middle",className:"w-full",wrap:!1,children:[(0,jsx_runtime.jsx)(col.Z,{children:(0,jsx_runtime.jsx)(PageHeader.m,{style:{paddingRight:8},title:`${experiment?.name}`,buttons:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(CopyToClipboard.D,{explicitValue:experiment.feature_flag?.key,iconStyle:{color:"var(--muted-alt)"},children:(0,jsx_runtime.jsx)("span",{className:"text-muted",children:experiment.feature_flag?.key})}),(0,jsx_runtime.jsx)(tag.Z,{style:{alignSelf:"center"},color:{running:"green",draft:"default",complete:"purple"}[status()],children:(0,jsx_runtime.jsx)("b",{className:"uppercase",children:status()})}),experimentResults&&experiment.end_date&&(0,jsx_runtime.jsx)(tag.Z,{style:{alignSelf:"center"},color:areResultsSignificant?"green":"geekblue",children:(0,jsx_runtime.jsx)("b",{className:"uppercase",children:areResultsSignificant?"Significant Results":"Results not significant"})})]})})}),(0,jsx_runtime.jsxs)(col.Z,{className:"page-title-row",children:[experiment&&!isExperimentRunning&&(0,jsx_runtime.jsxs)("div",{className:"flex items-center",children:[(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"secondary",className:"mr-2",onClick:()=>setEditExperiment(!0),children:"Edit"}),(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"primary",onClick:()=>launchExperiment(),children:"Launch"})]}),experiment&&isExperimentRunning&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(More.T,{overlay:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(LemonButton.Jp,{status:"stealth",onClick:()=>loadExperimentResults(!0),fullWidth:!0,"data-attr":"refresh-experiment",children:"Refresh experiment results"})})}),(0,jsx_runtime.jsx)(src.LemonDivider,{vertical:!0})]}),(0,jsx_runtime.jsx)(popconfirm.Z,{placement:"bottomLeft",title:(0,jsx_runtime.jsxs)("div",{children:["Reset this experiment and go back to draft mode?",(0,jsx_runtime.jsx)("div",{className:"text-sm text-muted",children:"All collected data so far will be discarded."}),experiment.archived&&(0,jsx_runtime.jsx)("div",{className:"text-sm text-muted",children:"Resetting will also unarchive the experiment."})]}),onConfirm:()=>resetRunningExperiment(),children:(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"secondary",status:"primary",children:"Reset"})}),!experiment.end_date&&(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"secondary",status:"danger",onClick:()=>endExperiment(),children:"Stop"}),experiment?.end_date&&(0,dayjs.Bv)().isSameOrAfter((0,dayjs.Bv)(experiment.end_date),"day")&&!experiment.archived&&(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"secondary",status:"danger",onClick:()=>archiveExperiment(),children:(0,jsx_runtime.jsx)("b",{children:"Archive"})})]})]})]}),(0,jsx_runtime.jsx)(row.Z,{className:"w-full pb-4",children:(0,jsx_runtime.jsx)("span",{className:"exp-description",children:isExperimentRunning?(0,jsx_runtime.jsx)(EditableField.f,{multiline:!0,name:"description",value:experiment.description||"",placeholder:"Description (optional)",onSave:value=>updateExperiment({description:value}),maxLength:400,"data-attr":"experiment-description",compactButtons:!0}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:experiment.description||"There is no description for this experiment."})})})]}),(0,jsx_runtime.jsxs)(row.Z,{children:[showWarning&&experimentResults&&areResultsSignificant&&!experiment.end_date&&(0,jsx_runtime.jsxs)(row.Z,{align:"middle",className:"significant-results",children:[(0,jsx_runtime.jsx)(col.Z,{span:20,style:{fontWeight:500,color:"#497342"},children:(0,jsx_runtime.jsxs)("div",{children:["Experiment results are significant."," ",experiment.end_date?"":"You can end your experiment now or let it run until complete."]})}),(0,jsx_runtime.jsx)(col.Z,{span:4,children:experiment.end_date?(0,jsx_runtime.jsx)(CloseOutlined.Z,{className:"close-button",onClick:()=>setShowWarning(!1)}):(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"primary",onClick:()=>endExperiment(),children:"End experiment"})})]}),showWarning&&experimentResults&&!areResultsSignificant&&!experiment.end_date&&(0,jsx_runtime.jsxs)(row.Z,{align:"top",className:"not-significant-results",children:[(0,jsx_runtime.jsxs)(col.Z,{span:23,style:{fontWeight:500,color:"var(--bg-charcoal)"},children:[(0,jsx_runtime.jsx)("strong",{children:"Your results are not statistically significant"}),"."," ",significanceBannerDetails," ",experiment?.end_date?"":"We don't recommend ending this experiment yet."," See our"," ",(0,jsx_runtime.jsxs)("a",{href:"https://posthog.com/docs/user-guides/experimentation#funnel-experiment-calculations",children:[" ","experimentation guide"," "]}),"for more information."," "]}),(0,jsx_runtime.jsx)(col.Z,{span:1,children:(0,jsx_runtime.jsx)(CloseOutlined.Z,{className:"close-button",onClick:()=>setShowWarning(!1)})})]}),showWarning&&experiment.end_date&&(0,jsx_runtime.jsxs)(row.Z,{align:"top",className:"feature-flag-mods",children:[(0,jsx_runtime.jsxs)(col.Z,{span:23,style:{fontWeight:500},children:[(0,jsx_runtime.jsx)("strong",{children:"Your experiment is complete, but the feature flag is still enabled."})," ","We recommend removing the feature flag from your code completely, instead of relying on this distribution."," ",(0,jsx_runtime.jsx)(Link.r,{to:experiment.feature_flag?urls.j.featureFlag(experiment.feature_flag.id):void 0,children:(0,jsx_runtime.jsx)("b",{children:"Adjust feature flag distribution"})})]}),(0,jsx_runtime.jsx)(col.Z,{span:1,children:(0,jsx_runtime.jsx)(CloseOutlined.Z,{className:"close-button",onClick:()=>setShowWarning(!1)})})]})]}),(0,jsx_runtime.jsxs)(row.Z,{children:[(0,jsx_runtime.jsx)(LemonCollapse.J,{className:"w-full",defaultActiveKey:"experiment-details",panels:[{key:"experiment-details",header:"Experiment details",content:(0,jsx_runtime.jsxs)(row.Z,{children:[(0,jsx_runtime.jsx)(col.Z,{span:isExperimentRunning?12:24,children:(0,jsx_runtime.jsx)(ExperimentPreview,{experimentId:experiment.id,trendCount:trendCount,trendExposure:experiment?.parameters.recommended_running_time,funnelSampleSize:experiment?.parameters.recommended_sample_size,funnelConversionRate:conversionRate,funnelEntrants:isExperimentRunning?funnelResultsPersonsTotal:entrants})}),!experimentResultsLoading&&!experimentResults&&isExperimentRunning&&(0,jsx_runtime.jsx)(col.Z,{span:12,children:(0,jsx_runtime.jsx)(ExperimentImplementationDetails,{experiment:experiment})}),experimentResults&&(0,jsx_runtime.jsxs)(col.Z,{span:12,className:"mt-4",children:[(0,jsx_runtime.jsx)("div",{className:"mb-2",children:(0,jsx_runtime.jsx)("b",{children:"Experiment progress"})}),(0,jsx_runtime.jsx)(progress.Z,{strokeWidth:20,showInfo:!1,percent:experimentProgressPercent,strokeColor:"var(--success)"}),experimentInsightType===types.dw.TRENDS&&experiment.start_date&&(0,jsx_runtime.jsxs)(row.Z,{justify:"space-between",className:"mt-2",children:[experiment.end_date?(0,jsx_runtime.jsxs)("div",{children:["Ran for"," ",(0,jsx_runtime.jsx)("b",{children:(0,dayjs.Bv)(experiment.end_date).diff(experiment.start_date,"day")})," ","days"]}):(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("b",{children:(0,dayjs.Bv)().diff(experiment.start_date,"day")})," ","days running"]}),(0,jsx_runtime.jsxs)("div",{children:["Goal:"," ",(0,jsx_runtime.jsx)("b",{children:null!==(_experiment$parameter2=experiment?.parameters?.recommended_running_time)&&void 0!==_experiment$parameter2?_experiment$parameter2:"Unknown"})," ","days"]})]}),experimentInsightType===types.dw.FUNNELS&&(0,jsx_runtime.jsxs)(row.Z,{justify:"space-between",className:"mt-2",children:[experiment.end_date?(0,jsx_runtime.jsxs)("div",{children:["Saw"," ",(0,jsx_runtime.jsx)("b",{children:(0,utils.Lc)(funnelResultsPersonsTotal)})," ","participants"]}):(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("b",{children:(0,utils.Lc)(funnelResultsPersonsTotal)})," ","participants seen"]}),(0,jsx_runtime.jsxs)("div",{children:["Goal:"," ",(0,jsx_runtime.jsx)("b",{children:(0,utils.Lc)(experiment?.parameters?.recommended_sample_size||0)})," ","participants"]})]})]}),(0,jsx_runtime.jsx)(col.Z,{children:(0,jsx_runtime.jsx)(SecondaryMetrics,{experimentId:experiment.id,onMetricsChange:metrics=>updateExperimentSecondaryMetrics(metrics),initialMetrics:experiment.secondary_metrics,defaultAggregationType:experiment.parameters?.aggregation_group_type_index})})]})}]}),!experiment?.start_date&&(0,jsx_runtime.jsx)("div",{className:"mt-4 w-full",children:(0,jsx_runtime.jsx)(ExperimentImplementationDetails,{experiment:experiment})})]}),(0,jsx_runtime.jsxs)("div",{className:"experiment-result",children:[experimentResults?(experiment?.parameters?.feature_flag_variants?.length||0)>4?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(row.Z,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[(0,jsx_runtime.jsx)(col.Z,{span:2*secondaryColumnSpan,children:"Variant"}),sortedExperimentResultVariants.map(((variant,idx)=>(0,jsx_runtime.jsx)(col.Z,{span:secondaryColumnSpan,style:{color:(0,colors._r)(getIndexForVariant(variant,experimentInsightType))},children:(0,jsx_runtime.jsx)("b",{children:(0,utils.fm)(variant)})},idx)))]}),(0,jsx_runtime.jsxs)(row.Z,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[(0,jsx_runtime.jsx)(col.Z,{span:2*secondaryColumnSpan,children:experimentInsightType===types.dw.TRENDS?"Count":"Conversion Rate"}),sortedExperimentResultVariants.map(((variant,idx)=>(0,jsx_runtime.jsx)(col.Z,{span:secondaryColumnSpan,children:experimentInsightType===types.dw.TRENDS?countDataForVariant(variant):`${conversionRateForVariant(variant)}%`},idx)))]}),(0,jsx_runtime.jsxs)(row.Z,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[(0,jsx_runtime.jsx)(col.Z,{span:2*secondaryColumnSpan,children:"Probability to be the best"}),sortedExperimentResultVariants.map(((variant,idx)=>(0,jsx_runtime.jsx)(col.Z,{span:secondaryColumnSpan,children:(0,jsx_runtime.jsx)("b",{children:experimentResults.probability[variant]?`${(100*experimentResults.probability[variant]).toFixed(1)}%`:"--"})},idx)))]})]}):(0,jsx_runtime.jsx)(row.Z,{justify:"space-around",style:{flexFlow:"nowrap"},children:Object.keys(experimentResults.probability).sort(((a,b)=>experimentResults.probability[b]-experimentResults.probability[a])).map(((variant,idx)=>(0,jsx_runtime.jsxs)(col.Z,{className:"pr-4",children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)("b",{children:(0,utils.fm)(variant)})}),experimentInsightType===types.dw.TRENDS?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(row.Z,{children:[(0,jsx_runtime.jsx)("b",{className:"pr-1",children:(0,jsx_runtime.jsxs)(row.Z,{children:["action"in experimentResults.insight[0]&&(0,jsx_runtime.jsx)(EntityFilterInfo.c,{filter:experimentResults.insight[0].action}),(0,jsx_runtime.jsxs)("span",{className:"pl-1",children:[experimentCountPerUserMath?"metric":"count",":"]})]})})," ",countDataForVariant(variant)," ",areTrendResultsConfusing&&0===idx&&(0,jsx_runtime.jsx)(tooltip.Z,{placement:"right",title:"It might seem confusing that the best variant has lower absolute count, but this can happen when fewer people are exposed to this variant, so its relative count is higher.",children:(0,jsx_runtime.jsx)(InfoCircleOutlined.Z,{className:"py-1 px-0.5"})})]}),(0,jsx_runtime.jsxs)("div",{className:"flex",children:[(0,jsx_runtime.jsx)("b",{className:"pr-1",children:"Exposure:"})," ",exposureCountDataForVariant(variant)]})]}):(0,jsx_runtime.jsxs)(row.Z,{children:[(0,jsx_runtime.jsx)("b",{className:"pr-1",children:"Conversion rate:"})," ",conversionRateForVariant(variant),"%"]}),(0,jsx_runtime.jsx)(progress.Z,{percent:Number((100*experimentResults.probability[variant]).toFixed(1)),size:"small",showInfo:!1,strokeColor:(0,colors._r)(getIndexForVariant(variant,experimentInsightType))}),(0,jsx_runtime.jsxs)("div",{children:["Probability that this variant is the best:"," ",(0,jsx_runtime.jsxs)("b",{children:[(100*experimentResults.probability[variant]).toFixed(1),"%"]})]})]},idx)))}):experimentResultsLoading&&(0,jsx_runtime.jsx)("div",{className:"text-center",children:(0,jsx_runtime.jsx)(skeleton.Z,{active:!0})}),experimentResults?(0,jsx_runtime.jsx)("div",{className:"mt-4 insights-page",children:(0,jsx_runtime.jsx)(Query.A,{query:{kind:schema.O.InsightVizNode,source:(0,filtersToQueryNode.wK)(transformResultFilters(experimentResults.filters)),showTable:!0,showLastComputation:!0,showLastComputationRefresh:!1},context:{insightProps:{dashboardItemId:experimentResults.fakeInsightId,cachedInsight:{short_id:experimentResults.fakeInsightId,filters:transformResultFilters(experimentResults.filters),result:experimentResults.insight,disable_baseline:!0,last_refresh:experimentResults.last_refresh},doNotLoad:!0}},readOnly:!0})}):experiment.start_date&&(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)("div",{className:"no-experiment-results",children:!experimentResultsLoading&&(0,jsx_runtime.jsxs)("div",{className:"text-center",children:[(0,jsx_runtime.jsx)("b",{children:"There are no results for this experiment yet."}),(0,jsx_runtime.jsxs)("div",{className:"text-sm ",children:[!!experimentResultCalculationError&&`${experimentResultCalculationError}. `," ","Wait a bit longer for your users to be exposed to the experiment. Double check your feature flag implementation if you're still not seeing results."]})]})})})]})]}):(0,jsx_runtime.jsx)(skeleton.Z,{active:!0})}):(0,jsx_runtime.jsx)(NotFound.T,{object:"experiment"}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(PageHeader.m,{title:"Experiments"}),(0,jsx_runtime.jsx)(ExperimentsPayGate.p,{})]})}const transformResultFilters=filters=>({...filters,...filters.insight===types.dw.FUNNELS&&{layout:constants.xp.vertical,funnel_viz_type:types.Ui.Steps},...filters.insight===types.dw.TRENDS&&{display:types.Qb.ActionsLineGraphCumulative}})},"./frontend/src/scenes/experiments/ExperimentsPayGate.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{p:function(){return ExperimentsPayGate}});var lib_components_PayGatePage_PayGatePage__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./frontend/src/lib/components/PayGatePage/PayGatePage.tsx"),_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./frontend/src/types.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function ExperimentsPayGate(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(lib_components_PayGatePage_PayGatePage__WEBPACK_IMPORTED_MODULE_0__.s,{featureKey:_types__WEBPACK_IMPORTED_MODULE_1__.P$.EXPERIMENTATION,header:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:["Introducing ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{className:"highlight",children:"Experimentation"}),"!"]}),caption:"Improve your product by A/B testing new features to discover what works best for your users.",docsLink:"https://posthog.com/docs/user-guides/experimentation"})}},"./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/lib/components/EditableField/EditableField.scss":function(module,exports,__webpack_require__){(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".EditableField{display:flex;align-items:center;max-width:100%}.EditableField:not(.EditableField--multiline){line-height:2rem}.EditableField i{color:var(--muted)}.EditableField .EditableField__notice{font-size:1.5rem;color:var(--muted);margin-left:.5rem}.EditableField .EditableField--highlight{display:flex;flex-direction:row;align-items:center;width:-moz-fit-content;width:fit-content;max-width:calc(100% + .5rem);min-height:2rem;padding:.25rem;margin:-.25rem;white-space:pre-wrap;overflow:auto}.EditableField--editing .EditableField--highlight{flex-grow:1;align-items:flex-end;width:auto;max-width:calc(100% + .5rem);outline:1px solid var(--border);border-radius:var(--radius)}.EditableField .EditableField__autosize{align-self:center;min-width:0}.EditableField .EditableField__autosize__sizer{position:absolute;top:0;left:0;visibility:hidden;height:0;overflow:scroll;white-space:pre}.EditableField input,.EditableField textarea{max-width:100%;border:none;background:transparent;font:inherit;color:var(--default);outline:none;padding:0}.EditableField textarea{align-self:center;width:100%}.EditableField button{margin-left:.5rem}.EditableField button:first-of-type{margin-left:.75rem}",""]),module.exports=exports},"./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/scenes/experiments/Experiment.scss":function(module,exports,__webpack_require__){(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,'.experiment-form .metrics-selection,.experiment-form .person-selection{border-top:1px solid var(--border);padding-top:1rem;width:100%}.experiment-form .person-selection{align-items:center;justify-content:space-between}.experiment-form .insights-graph-container{margin-bottom:1rem}.experiment-form .insights-graph-container .ant-card-head{border-bottom:1px solid var(--border);min-height:unset;background-color:var(--bg-light);padding-left:1rem;padding-right:1rem}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title{padding:.5rem 0}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter{font-size:14px}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter:not(:last-child),.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter span.head-title-item{margin-right:.5rem}.experiment-form .insights-graph-container .display-config-inner{display:flex;align-items:center;justify-content:space-between;overflow-x:auto}.experiment-form .insights-graph-container .ant-card-body{padding:0}.experiment-form .insights-graph-container .insights-graph-container-row .insights-graph-container-row-left{width:100%}.experiment-form .insights-graph-container .insights-graph-container-row .insights-graph-container-row-right{width:100%;height:min(90vh - 16rem,36rem);max-width:300px;padding:0 1rem 1rem 0;display:flex;align-items:center}.experiment-form .insights-graph-container .LineGraph{width:calc(100% - 2rem);height:calc(100% - 2rem)!important;margin-top:1rem}.experiment-form .insights-graph-header{margin-top:0!important;padding-left:1rem;padding-right:1rem;min-height:48px}.experiment-form .experiment-preview{margin-bottom:1rem;border-bottom:1px solid var(--border)}.experiment-form .experiment-preview .mde-slider .ant-slider-handle{border:none}.experiment-form .experiment-preview .mde-slider .ant-slider-rail{background-color:#e5ebff}.experiment-form .variants{margin-top:.5rem;padding-bottom:1rem}.experiment-form .variants .ant-form-horizontal{min-height:32px}.experiment-form .variants .border-top{border-top-left-radius:4px;border-top-right-radius:4px}.experiment-form .variants .border-bottom{border-bottom-left-radius:4px;border-bottom-right-radius:4px}.experiment-form .variants .feature-flag-variant{display:flex;align-items:center;padding:.5rem;background:var(--bg-light);border-bottom-width:1px;border-bottom-color:var(--border);border-top:1px solid var(--border);border-left:1px solid var(--border);border-right:1px solid var(--border)}.experiment-form .variants .feature-flag-variant .extend-variant-fully{flex:1}.experiment-form .variants .variant-label{display:flex;flex-direction:row;justify-content:center;align-items:center;border-radius:4px;color:#fff;min-width:52px;padding:2px 6px;margin-right:8px;font-size:12px;font-weight:500;letter-spacing:.01em}.experiment-form .secondary-metrics{margin-top:1rem;padding-top:1rem;border-top:1px solid var(--border);margin-bottom:1rem;width:100%}.experiment-form .ant-input-number-disabled,.experiment-form .ant-input[disabled]{color:#000}.view-experiment .draft-header{margin-bottom:1rem;border-bottom:1px solid var(--border)}.view-experiment .exp-description{font-style:italic;color:var(--muted)}.view-experiment .participants{background-color:#fff}.view-experiment .participants .ant-collapse-header{padding-top:.5rem;padding-bottom:.5rem;padding-left:.75rem}.view-experiment .variants-list li{display:inline}.view-experiment .variants-list li:after{content:", "}.view-experiment .variants-list li:last-child:after{content:""}.view-experiment .experiment-result{padding-top:1rem}.view-experiment .significant-results{padding:.5rem;width:100%;background:rgba(119,185,108,.1);border-radius:4px;text-align:center;margin-bottom:1rem}.view-experiment .not-significant-results{padding:.5rem;width:100%;background:rgba(83,117,255,.1);border-radius:4px;margin-bottom:1rem}.view-experiment .feature-flag-mods{padding:.5rem;width:100%;background:#f6ebf8;color:var(--bg-charcoal);border-radius:4px;margin-bottom:1rem}.view-experiment .ant-collapse-content-box{display:flex;flex-flow:column}.view-experiment .secondary-progress{margin-top:.5rem}.view-experiment .secondary-progress li:before{content:"•";display:inline-block;font-weight:900;margin-right:4px}.view-experiment .secondary-progress .ant-progress-inner,.view-experiment .secondary-progress .ant-progress-inner .ant-progress-bg{border-radius:4px}.view-experiment .no-experiment-results{display:flex;justify-content:center;align-items:center;margin-top:1rem;background-color:var(--side);border:1px solid var(--border);width:100%;min-height:320px;font-size:24px}.view-experiment .computation-time-and-sampling-notice{margin-top:8px}.preview-conversion-goal-num{height:24px;width:24px;text-align:center;background-color:var(--side);color:var(--primary-alt);font-weight:700;margin-right:.5rem}.experiment-preview-row{border-bottom:1px solid var(--border);padding-bottom:1rem;margin-bottom:1rem}.experiment-preview-row:last-child{border-bottom:none;padding-bottom:0;margin-bottom:0}.metric-name{border:1px solid var(--border);border-radius:4px;padding:8px 8px 8px 16px;margin-left:.5rem;flex:1}.experiment-implementation-details .ant-card-head,.experiment-workflow .ant-card-head{padding-left:1rem;padding-right:1rem;border:none}.experiment-implementation-details .ant-card-head-title,.experiment-workflow .ant-card-head-title{border-bottom:1px solid var(--border)}.experiment-implementation-details .exp-workflow-step,.experiment-workflow .exp-workflow-step{margin-bottom:.5rem;padding:.5rem;border-radius:4px}.experiment-implementation-details .exp-workflow-step:hover,.experiment-workflow .exp-workflow-step:hover{cursor:pointer}.experiment-implementation-details .step-completed,.experiment-workflow .step-completed{background-color:#e5ebff}',""]),module.exports=exports}}]);