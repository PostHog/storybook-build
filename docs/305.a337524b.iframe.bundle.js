(window.webpackJsonp=window.webpackJsonp||[]).push([[305],{"./frontend/src/scenes/experiments/Experiment.tsx":function(We,ae,l){"use strict";l.r(ae),l.d(ae,"scene",function(){return fn}),l.d(ae,"Experiment",function(){return Ct});var mt=l("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Wn=l("./node_modules/core-js/modules/web.dom-collections.for-each.js"),zn=l("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Bt=l("./node_modules/@babel/runtime/helpers/defineProperty.js"),Ie=l.n(Bt),_t=l("./node_modules/@babel/runtime/helpers/slicedToArray.js"),ce=l.n(_t),Hn=l("./node_modules/core-js/modules/es.object.to-string.js"),Jn=l("./node_modules/core-js/modules/es.function.name.js"),Qn=l("./node_modules/core-js/modules/es.symbol.js"),Xn=l("./node_modules/core-js/modules/es.symbol.description.js"),Zn=l("./node_modules/core-js/modules/es.array.map.js"),qn=l("./node_modules/core-js/modules/es.array.concat.js"),er=l("./node_modules/core-js/modules/es.regexp.to-string.js"),tr=l("./node_modules/core-js/modules/es.array.filter.js"),nr=l("./node_modules/core-js/modules/es.number.to-fixed.js"),rr=l("./node_modules/core-js/modules/es.array.sort.js"),ar=l("./node_modules/core-js/modules/es.object.keys.js"),ir=l("./node_modules/core-js/modules/es.number.constructor.js"),J=l("./node_modules/antd/es/form/index.js"),Fe=l("./node_modules/antd/es/skeleton/index.js"),h=l("./node_modules/antd/es/row/index.js"),f=l("./node_modules/antd/es/col/index.js"),Ce=l("./node_modules/antd/es/input/index.js"),Te=l("./node_modules/antd/es/tooltip/index.js"),W=l("./node_modules/antd/es/select/index.js"),ze=l("./node_modules/antd/es/card/index.js"),ft=l("./node_modules/antd/es/tag/index.js"),jt=l("./node_modules/antd/es/collapse/index.js"),vt=l("./node_modules/antd/es/progress/index.js"),V=l("./node_modules/kea/lib/index.esm.js"),ht=l("./frontend/src/lib/components/PageHeader.tsx"),Gt=l("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),Ut=l("./frontend/src/lib/components/PropertyFilters/utils.ts"),I=l("./frontend/src/lib/components/TaxonomicFilter/types.ts"),fe=l("./node_modules/react/index.js"),De=l("./frontend/src/scenes/funnels/funnelLogic.ts"),de=l("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilter.tsx"),je=l("./frontend/src/scenes/insights/insightLogic.ts"),m=l("./frontend/src/types.ts"),Wt=l("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),zt=l.n(Wt),Ht=l("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/experiments/Experiment.scss"),gt=l.n(Ht),He={};He.insert="head",He.singleton=!1;var sr=zt()(gt.a,He),or=gt.a.locals||{},Jt=l("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),B=l.n(Jt),Qt=l("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),ne=l.n(Qt),Xt=l("./node_modules/@babel/runtime/regenerator/index.js"),T=l.n(Xt),lr=l("./node_modules/core-js/modules/es.array.splice.js"),cr=l("./node_modules/core-js/modules/es.array.iterator.js"),dr=l("./node_modules/core-js/modules/web.dom-collections.iterator.js"),pr=l("./node_modules/core-js/modules/es.array.find.js"),ur=l("./node_modules/core-js/modules/es.array.includes.js"),mr=l("./node_modules/core-js/modules/es.string.includes.js"),fr=l("./node_modules/core-js/modules/es.promise.js"),jr=l("./node_modules/core-js/modules/es.string.iterator.js"),vr=l("./node_modules/core-js/modules/es.array.find-index.js"),hr=l("./node_modules/core-js/modules/es.object.values.js"),gr=l("./node_modules/core-js/modules/es.number.epsilon.js"),xr=l("./node_modules/core-js/modules/es.array.fill.js"),q=l("./frontend/src/lib/api.ts"),M=l("./frontend/src/lib/dayjs.ts"),Me=l("./frontend/src/scenes/insights/utils/cleanFilters.ts"),Je=l("./frontend/src/scenes/teamLogic.tsx"),ee=l("./frontend/src/scenes/urls.ts"),pe=l("./node_modules/kea-router/lib/index.js"),Zt=l("./frontend/src/scenes/experiments/experimentsLogic.ts"),ve=l("./frontend/src/lib/constants.tsx"),Qe=l("./frontend/src/scenes/trends/trendsLogic.ts"),he=l("./frontend/src/lib/utils/eventUsageLogic.ts"),qt=l("./frontend/src/scenes/userLogic.ts"),xt=l("./frontend/src/lib/components/Tooltip.tsx"),ge=l("./node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),en=l("./frontend/src/models/groupsModel.ts"),Xe=l("./frontend/src/lib/components/lemonToast.tsx"),P=l("./frontend/src/lib/utils.tsx"),e=l("./node_modules/react/jsx-runtime.js");function bt(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);n&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,a)}return r}function y(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?bt(Object(r),!0).forEach(function(a){Ie()(t,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bt(Object(r)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(r,a))})}return t}var xe=14,be=Object(V.kea)({props:{},key:function(n){return n.experimentId||"new"},path:function(n){return["scenes","experiment","experimentLogic",n]},connect:{values:[Je.a,["currentTeamId"],qt.a,["hasAvailableFeature"],en.a,["groupTypes","groupsTaxonomicTypes","aggregationLabel"]],actions:[Zt.a,["updateExperiments","addToExperiments"]]},actions:{setExperiment:function(n){return{experiment:n}},createExperiment:function(n,r,a){return{draft:n,runningTime:r,sampleSize:a}},setExperimentInsightId:function(n){return{shortId:n}},createNewExperimentInsight:function(n){return{filters:n}},setFilters:function(n){return{filters:n}},setNewExperimentData:function(n){return{experimentData:n}},updateExperimentGroup:function(n,r){return{variant:n,idx:r}},removeExperimentGroup:function(n){return{idx:n}},setExperimentInsightType:function(n){return{insightType:n}},setEditExperiment:function(n){return{editing:n}},setSecondaryMetrics:function(n){return{secondaryMetrics:n}},setExperimentResultCalculationError:function(n){return{error:n}},setFlagImplementationWarning:function(n){return{warning:n}},setFlagAvailabilityWarning:function(n){return{warning:n}},resetNewExperiment:!0,launchExperiment:!0,endExperiment:!0,addExperimentGroup:!0,archiveExperiment:!0},reducers:{newExperimentData:[null,{setNewExperimentData:function(n,r){var a=r.experimentData;if(a.filters){var o=y(y({},n==null?void 0:n.filters),a.filters);return y(y(y({},n),a),{},{filters:o})}if(a.parameters){var c=y(y({},n==null?void 0:n.parameters),a.parameters);return y(y(y({},n),a),{},{parameters:c})}return y(y({},n),a)},updateExperimentGroup:function(n,r){var a,o=r.variant,c=r.idx,p=ne()((n==null||(a=n.parameters)===null||a===void 0?void 0:a.feature_flag_variants)||[]);return p[c]=y(y({},p[c]),o),y(y({},n),{},{parameters:y(y({},n==null?void 0:n.parameters),{},{feature_flag_variants:p})})},addExperimentGroup:function(n){var r;if(n!=null&&(r=n.parameters)!==null&&r!==void 0&&r.feature_flag_variants){var a=yt(n.parameters.feature_flag_variants.length+1),o=n.parameters.feature_flag_variants.map(function(c,p){return y(y({},c),{},{rollout_percentage:a[p]})});return y(y({},n),{},{parameters:y(y({},n.parameters),{},{feature_flag_variants:[].concat(ne()(o),[{key:"test_group_".concat(n.parameters.feature_flag_variants.length),rollout_percentage:a[a.length-1]}])})})}return n},removeExperimentGroup:function(n,r){var a,o,c=r.idx;if(!n)return n;var p=ne()(((a=n.parameters)===null||a===void 0?void 0:a.feature_flag_variants)||[]);p.splice(c,1);var i=yt(((n==null||(o=n.parameters)===null||o===void 0?void 0:o.feature_flag_variants)||[]).length-1),d=p.map(function(u,g){return y(y({},u),{},{rollout_percentage:i[g]})});return y(y({},n),{},{parameters:y(y({},n.parameters),{},{feature_flag_variants:d})})},setSecondaryMetrics:function(n,r){var a=r.secondaryMetrics,o=a.map(function(c){return c});return y(y({},n),{},{secondary_metrics:o})},resetNewExperiment:function(){return{parameters:{feature_flag_variants:[{key:"control",rollout_percentage:50},{key:"test",rollout_percentage:50}]}}}}],experimentInsightType:[m.F.TRENDS,{setExperimentInsightType:function(n,r){var a=r.insightType;return a}}],experimentInsightId:[null,{setExperimentInsightId:function(n,r){var a=r.shortId;return a}}],editingExistingExperiment:[!1,{setEditExperiment:function(n,r){var a=r.editing;return a}}],experimentResultCalculationError:[null,{setExperimentResultCalculationError:function(n,r){var a=r.error;return a}}],flagImplementationWarning:[!1,{setFlagImplementationWarning:function(n,r){var a=r.warning;return a}}],flagAvailabilityWarning:[!1,{setFlagAvailabilityWarning:function(n,r){var a=r.warning;return a}}]},listeners:function(n){var r=n.values,a=n.actions;return{createExperiment:function(){var o=B()(T.a.mark(function p(i){var d,u,g,w,x,F,C,b,N,O;return T.a.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(u=i.draft,g=i.runningTime,w=i.sampleSize,x=null,F=!!r.experimentId&&r.experimentId!=="new",S.prev=3,!F){S.next=14;break}return S.next=7,q.b.update("api/projects/".concat(r.currentTeamId,"/experiments/").concat(r.experimentId),y(y({},r.newExperimentData),{},{parameters:y(y({},(C=r.newExperimentData)===null||C===void 0?void 0:C.parameters),{},{recommended_running_time:g,recommended_sample_size:w})},!u&&{start_date:Object(M.a)()}));case 7:if(x=S.sent,!((b=x)!==null&&b!==void 0&&b.id)){S.next=12;break}return a.updateExperiments(x),pe.router.actions.push(ee.a.experiment(x.id)),S.abrupt("return");case 12:S.next=18;break;case 14:return S.next=16,q.b.create("api/projects/".concat(r.currentTeamId,"/experiments"),y(y({},r.newExperimentData),{},{parameters:y(y({},(N=r.newExperimentData)===null||N===void 0?void 0:N.parameters),{},{recommended_running_time:g,recommended_sample_size:w})},!u&&{start_date:Object(M.a)()}));case 16:x=S.sent,x&&he.e.actions.reportExperimentCreated(x);case 18:S.next=24;break;case 20:return S.prev=20,S.t0=S.catch(3),Xe.d.error(S.t0.detail||"Failed to create experiment"),S.abrupt("return");case 24:(d=x)!==null&&d!==void 0&&d.id&&(O=x.id,pe.router.actions.push(ee.a.experiment(O)),a.addToExperiments(x),Xe.d.success("Experiment ".concat(F?"updated":"created"),{button:{label:"View it",action:function(){pe.router.actions.push(ee.a.experiment(O))}}}));case 25:case"end":return S.stop()}},p,null,[[3,20]])}));function c(p){return o.apply(this,arguments)}return c}(),createNewExperimentInsight:function(){var o=B()(T.a.mark(function p(i){var d,u,g,w;return T.a.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return d=i.filters,r.experimentInsightType===m.F.FUNNELS?u=Object(Me.a)(y({insight:m.F.FUNNELS,funnel_viz_type:m.B.Steps,date_from:Object(M.a)().subtract(xe,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(M.a)().endOf("d").format("YYYY-MM-DDTHH:mm"),layout:ve.k.horizontal},d)):u=Object(Me.a)(y({insight:m.F.TRENDS,date_from:Object(M.a)().subtract(xe,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(M.a)().endOf("d").format("YYYY-MM-DDTHH:mm")},d)),g={name:"",description:"",tags:[],filters:u,result:null},F.next=5,q.b.create("api/projects/".concat(r.currentTeamId,"/insights"),g);case 5:w=F.sent,a.setExperimentInsightId(w.short_id),a.setNewExperimentData({filters:y({},g.filters)});case 8:case"end":return F.stop()}},p)}));function c(p){return o.apply(this,arguments)}return c}(),setFilters:function(c){var p=c.filters;if(r.experimentInsightType===m.F.FUNNELS){var i;(i=De.a.findMounted({dashboardItemId:r.experimentInsightId}))===null||i===void 0||i.actions.setFilters(p)}else{var d;(d=Qe.a.findMounted({dashboardItemId:r.experimentInsightId}))===null||d===void 0||d.actions.setFilters(p)}},loadExperimentSuccess:function(){var o=B()(T.a.mark(function p(i){var d;return T.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:d=i.experimentData,d&&he.e.actions.reportExperimentViewed(d),a.setExperimentInsightType((d==null?void 0:d.filters.insight)||m.F.FUNNELS),d!=null&&d.start_date?(a.resetNewExperiment(),a.loadExperimentResults(),a.loadSecondaryMetricResults()):(a.setNewExperimentData(y({},d)),a.createNewExperimentInsight(d==null?void 0:d.filters));case 4:case"end":return g.stop()}},p)}));function c(p){return o.apply(this,arguments)}return c}(),launchExperiment:function(){var o=B()(T.a.mark(function p(){var i;return T.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:i=Object(M.a)(),a.updateExperiment({start_date:i.toISOString()}),r.experimentData&&he.e.actions.reportExperimentLaunched(r.experimentData,i);case 3:case"end":return u.stop()}},p)}));function c(){return o.apply(this,arguments)}return c}(),endExperiment:function(){var o=B()(T.a.mark(function p(){var i,d,u;return T.a.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:d=Object(M.a)(),a.updateExperiment({end_date:d.toISOString()}),u=d.diff((i=r.experimentData)===null||i===void 0?void 0:i.start_date,"second"),r.experimentData&&he.e.actions.reportExperimentCompleted(r.experimentData,d,u,r.areResultsSignificant);case 4:case"end":return w.stop()}},p)}));function c(){return o.apply(this,arguments)}return c}(),archiveExperiment:function(){var o=B()(T.a.mark(function p(){return T.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:a.updateExperiment({archived:!0}),r.experimentData&&he.e.actions.reportExperimentArchived(r.experimentData);case 2:case"end":return d.stop()}},p)}));function c(){return o.apply(this,arguments)}return c}(),setExperimentInsightType:function(){if(r.experimentId==="new"||r.editingExistingExperiment)a.createNewExperimentInsight();else{var c;a.createNewExperimentInsight((c=r.experimentData)===null||c===void 0?void 0:c.filters)}},updateExperimentSuccess:function(){var o=B()(T.a.mark(function p(i){var d;return T.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:d=i.experimentData,a.updateExperiments(d);case 2:case"end":return g.stop()}},p)}));function c(p){return o.apply(this,arguments)}return c}(),setNewExperimentData:function(){var o=B()(T.a.mark(function p(i,d){var u,g,w,x,F,C,b,N,O;return T.a.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(x=i.experimentData,F=((u=x.filters)===null||u===void 0?void 0:u.events)&&x.filters.events.length>0||((g=x.filters)===null||g===void 0?void 0:g.actions)&&x.filters.actions.length>0,!(!x.filters||Object.keys(x.filters).length===0)){S.next=4;break}return S.abrupt("return");case 4:if(!F){S.next=18;break}return C="/api/projects/".concat(r.currentTeamId,"/experiments/requires_flag_implementation?").concat(Object(P.Fb)(x.filters||{})),S.next=8,d(100);case 8:return S.prev=8,S.next=11,q.b.get(C);case 11:b=S.sent,a.setFlagImplementationWarning(b.result),S.next=18;break;case 15:S.prev=15,S.t0=S.catch(8),a.setFlagImplementationWarning(!1);case 18:(w=x.filters)!==null&&w!==void 0&&w.properties&&(N=Object(P.r)(x.filters.properties)||[],N.length>0?(O=!!N.find(function(U){return U.type==="cohort"||!ve.l.includes(U.key||"")}),a.setFlagAvailabilityWarning(O)):a.setFlagAvailabilityWarning(!1));case 19:case"end":return S.stop()}},p,null,[[8,15]])}));function c(p,i){return o.apply(this,arguments)}return c}()}},loaders:function(n){var r=n.actions,a=n.values;return{experimentData:[null,{loadExperiment:function(){var o=B()(T.a.mark(function p(){var i;return T.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(a.experimentId&&a.experimentId!=="new")){u.next=16;break}return u.prev=1,u.next=4,q.b.get("api/projects/".concat(a.currentTeamId,"/experiments/").concat(a.experimentId));case 4:return i=u.sent,u.abrupt("return",i);case 8:if(u.prev=8,u.t0=u.catch(1),u.t0.status!==404){u.next=14;break}throw u.t0;case 14:throw Xe.d.error("Failed to load experiment ".concat(a.experimentId)),new Error("Failed to load experiment ".concat(a.experimentId));case 16:return u.abrupt("return",null);case 17:case"end":return u.stop()}},p,null,[[1,8]])}));function c(){return o.apply(this,arguments)}return c}(),updateExperiment:function(){var o=B()(T.a.mark(function p(i){var d;return T.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,q.b.update("api/projects/".concat(a.currentTeamId,"/experiments/").concat(a.experimentId),i);case 2:return d=g.sent,g.abrupt("return",d);case 4:case"end":return g.stop()}},p)}));function c(p){return o.apply(this,arguments)}return c}()}],experimentResults:[null,{loadExperimentResults:function(){var o=B()(T.a.mark(function p(){var i;return T.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,q.b.get("api/projects/".concat(a.currentTeamId,"/experiments/").concat(a.experimentId,"/results"));case 3:return i=u.sent,u.abrupt("return",y(y({},i),{},{itemID:Math.random().toString(36).substring(2,15)}));case 7:return u.prev=7,u.t0=u.catch(0),r.setExperimentResultCalculationError(u.t0.detail),u.abrupt("return",null);case 11:case"end":return u.stop()}},p,null,[[0,7]])}));function c(){return o.apply(this,arguments)}return c}()}],secondaryMetricResults:[null,{loadSecondaryMetricResults:function(){var o=B()(T.a.mark(function p(){var i;return T.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all((((i=a.experimentData)===null||i===void 0?void 0:i.secondary_metrics)||[]).map(function(){var g=B()(T.a.mark(function w(x,F){var C;return T.a.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.prev=0,N.next=3,q.b.get("api/projects/".concat(a.currentTeamId,"/experiments/").concat(a.experimentId,"/secondary_results?id=").concat(F));case 3:return C=N.sent,N.abrupt("return",C.result);case 7:return N.prev=7,N.t0=N.catch(0),N.abrupt("return",{});case 10:case"end":return N.stop()}},w,null,[[0,7]])}));return function(w,x){return g.apply(this,arguments)}}()));case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},p)}));function c(){return o.apply(this,arguments)}return c}()}]}},selectors:{experimentId:[function(){return[function(t,n){var r;return(r=n.experimentId)!==null&&r!==void 0?r:"new"}]},function(t){return t}],breadcrumbs:[function(t){return[t.experimentData,t.experimentId]},function(t,n){return[{name:"Experiments",path:ee.a.experiments()},{name:(t==null?void 0:t.name)||"New",path:ee.a.experiment(n||"new")}]}],variants:[function(t){return[t.newExperimentData,t.experimentData]},function(t,n){var r,a;if(n!=null&&n.start_date){var o;return(n==null||(o=n.parameters)===null||o===void 0?void 0:o.feature_flag_variants)||[]}return(t==null||(r=t.parameters)===null||r===void 0?void 0:r.feature_flag_variants)||(n==null||(a=n.parameters)===null||a===void 0?void 0:a.feature_flag_variants)||[]}],taxonomicGroupTypesForSelection:[function(t){return[t.newExperimentData,t.groupsTaxonomicTypes]},function(t,n){var r;return(t==null||(r=t.filters)===null||r===void 0?void 0:r.aggregation_group_type_index)!=null&&n.length>0?[n[t.filters.aggregation_group_type_index]]:[I.a.PersonProperties,I.a.Cohorts]}],parsedSecondaryMetrics:[function(t){return[t.newExperimentData,t.experimentData]},function(t,n){var r=(t==null?void 0:t.secondary_metrics)||(n==null?void 0:n.secondary_metrics)||[];return r}],minimumDetectableChange:[function(t){return[t.newExperimentData]},function(t){var n;return(t==null||(n=t.parameters)===null||n===void 0?void 0:n.minimum_detectable_effect)||5}],minimumSampleSizePerVariant:[function(t){return[t.minimumDetectableChange]},function(t){return function(n){return Math.ceil(1600*n*(1-n/100)/(t*t))}}],areResultsSignificant:[function(t){return[t.experimentResults]},function(t){return(t==null?void 0:t.significant)||!1}],significanceBannerDetails:[function(t){return[t.experimentResults]},function(t){if((t==null?void 0:t.significance_code)===m.bb.HighLoss){var n;return Object(e.jsxs)(e.Fragment,{children:["This is because the expected loss in conversion is greater than 1%",Object(e.jsx)(xt.a,{placement:"right",title:Object(e.jsxs)(e.Fragment,{children:["Current value is ",(n=((t==null?void 0:t.expected_loss)||0)*100)===null||n===void 0?void 0:n.toFixed(2),"%"]}),children:Object(e.jsx)(ge.a,{style:{padding:"4px 2px"}})}),"."]})}if((t==null?void 0:t.significance_code)===m.bb.HighPValue){var r;return Object(e.jsxs)(e.Fragment,{children:["This is because the p value is greater than 0.05",Object(e.jsx)(xt.a,{placement:"right",title:Object(e.jsxs)(e.Fragment,{children:["Current value is ",(t==null||(r=t.p_value)===null||r===void 0?void 0:r.toFixed(3))||1,"."]}),children:Object(e.jsx)(ge.a,{style:{padding:"4px 2px"}})}),"."]})}return(t==null?void 0:t.significance_code)===m.bb.LowWinProbability?"This is because the win probability of all test variants combined is less than 90%.":(t==null?void 0:t.significance_code)===m.bb.NotEnoughExposure?"This is because we need at least 100 people per variant to declare significance.":""}],recommendedExposureForCountData:[function(t){return[t.minimumDetectableChange]},function(t){return function(n){var r=n*t/100,a=n,o=r+n;return parseFloat((4/Math.pow(Math.sqrt(a/xe)-Math.sqrt(o/xe),2)).toFixed(1))}}],expectedRunningTime:[function(){return[]},function(){return function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xe;return parseFloat((n/(t/r)).toFixed(1))}}],conversionRateForVariant:[function(t){return[t.experimentResults]},function(t){return function(n){var r="--";if(!t)return r;var a=(t==null?void 0:t.insight).find(function(o){var c,p;return((c=o[0])===null||c===void 0||(p=c.breakdown_value)===null||p===void 0?void 0:p[0])===n});return a?(a[a.length-1].count/a[0].count*100).toFixed(1):r}}],getIndexForVariant:[function(t){return[t.experimentResults]},function(t){return function(n,r){var a;if(!t)a=0;else{var o=-1;r===m.F.FUNNELS?o=ne()(t==null?void 0:t.insight).sort(function(c,p){var i,d;return((i=p[0])===null||i===void 0?void 0:i.count)-((d=c[0])===null||d===void 0?void 0:d.count)}).findIndex(function(c){var p,i;return((p=c[0])===null||p===void 0||(i=p.breakdown_value)===null||i===void 0?void 0:i[0])===n}):o=(t==null?void 0:t.insight).findIndex(function(c){return c.breakdown_value===n}),a=o===-1?0:o}return r===m.F.FUNNELS&&a++,a}}],countDataForVariant:[function(t){return[t.experimentResults]},function(t){return function(n){var r="--";if(!t)return r;var a=(t==null?void 0:t.insight).find(function(o){return o.breakdown_value===n});return a?a.count.toString():r}}],highestProbabilityVariant:[function(t){return[t.experimentResults]},function(t){if(t){var n=Math.max.apply(Math,ne()(Object.values(t.probability)));return Object.keys(t.probability).find(function(r){return Math.abs(t.probability[r]-n)<Number.EPSILON})}}],areTrendResultsConfusing:[function(t){return[t.experimentResults,t.highestProbabilityVariant]},function(t,n){if(!t)return!1;var r=(t==null?void 0:t.insight).reduce(function(a,o){return o.count>a.count?o:a},{count:0,breakdown_value:""});return r.count?r.breakdown_value!==n:!1}],sortedExperimentResultVariants:[function(t){return[t.experimentResults,t.experimentData]},function(t,n){if(t){var r,a,o=Object.keys(t.probability).sort(function(c,p){return t.probability[p]-t.probability[c]});return n==null||(r=n.parameters)===null||r===void 0||(a=r.feature_flag_variants)===null||a===void 0||a.forEach(function(c){o.includes(c.key)||o.push(c.key)}),o}return[]}]},urlToAction:function(n){var r=n.actions,a=n.values;return{"/experiments/:id":function(c,p,i,d,u){var g=c.id;if(!a.hasAvailableFeature(m.e.EXPERIMENTATION)){pe.router.actions.push("/experiments");return}var w=d.initial||d.pathname!==(u==null?void 0:u.pathname);if(r.setEditExperiment(!1),g&&w){var x=g==="new"?"new":parseInt(g);x==="new"&&(r.createNewExperimentInsight(),r.resetNewExperiment(),r.setSecondaryMetrics([])),x!=="new"&&x===a.experimentId&&r.loadExperiment()}}}}});function yt(t){var n=Math.round(100/t),r=n*t,a=r-100,o=new Array(t).fill(n);return o[t-1]=n-a,o}var Ze=l("./frontend/src/scenes/insights/InsightContainer.tsx"),k=l("./frontend/src/lib/components/icons.tsx"),tn=l("./node_modules/@ant-design/icons/es/icons/ExclamationCircleFilled.js"),Pe=l("./node_modules/@ant-design/icons/es/icons/CaretDownOutlined.js"),qe=l("./node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),nn=l("./frontend/src/lib/components/CopyToClipboard.tsx"),rn=l("./node_modules/antd/es/modal/index.js");function Ot(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);n&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,a)}return r}function ie(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Ot(Object(r),!0).forEach(function(a){Ie()(t,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ot(Object(r)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(r,a))})}return t}var Et=14,et={name:"",filters:{insight:m.F.TRENDS,events:[{id:"$pageview",name:"$pageview",type:"events",order:0}]}},an={name:"",filters:{insight:m.F.FUNNELS,events:[{id:"$pageview",name:"$pageview",type:"events",order:0}],layout:ve.k.horizontal}},sn=Object(V.kea)({props:{},path:["scenes","experiment","secondaryMetricsLogic"],connect:{values:[Je.a,["currentTeamId"]]},actions:{setSecondaryMetrics:function(n){return{secondaryMetrics:n}},createNewMetric:!0,addNewMetric:function(n){return{metric:n}},updateMetricFilters:function(n){return{filters:n}},setFilters:function(n){return{filters:n}},setPreviewInsightId:function(n){return{shortId:n}},createPreviewInsight:function(n){return{filters:n}},showModal:!0,hideModal:!0,changeInsightType:function(n){return{type:n}},setCurrentMetricName:function(n){return{name:n}},deleteMetric:function(n){return{metricId:n}}},loaders:function(n){var r=n.values;return{experiments:[[],{loadExperiments:function(){var a=B()(T.a.mark(function c(){var p;return T.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,q.b.get("api/projects/".concat(r.currentTeamId,"/experiments"));case 2:return p=d.sent,d.abrupt("return",p.results);case 4:case"end":return d.stop()}},c)}));function o(){return a.apply(this,arguments)}return o}()}]}},reducers:function(n){var r=n.props;return{previewInsightId:[null,{setPreviewInsightId:function(o,c){var p=c.shortId;return p}}],metrics:[r.initialMetrics,{addNewMetric:function(o,c){var p=c.metric;return[].concat(ne()(o),[ie({},p)])},deleteMetric:function(o,c){var p=c.metricId;return o.filter(function(i,d){return d!==p})}}],modalVisible:[!1,{showModal:function(){return!0},hideModal:function(){return!1}}],currentMetricName:["",{setCurrentMetricName:function(o,c){var p=c.name;return p}}],currentMetric:[et,{changeInsightType:function(o,c){var p=c.type;return p===m.F.TRENDS?et:o.filters.insight===m.F.TRENDS?an:et},updateMetricFilters:function(o,c){var p=c.filters;return ie(ie({},o),{},{filters:p})}}]}},listeners:function(n){var r=n.actions,a=n.values,o=n.props;return{createPreviewInsight:function(){var c=B()(T.a.mark(function i(d){var u,g,w,x;return T.a.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return u=d.filters,(u==null?void 0:u.insight)===m.F.FUNNELS?g=Object(Me.a)(ie({insight:m.F.FUNNELS,funnel_viz_type:m.B.Steps,date_from:Object(M.a)().subtract(Et,"day").format("YYYY-MM-DD"),date_to:Object(M.a)().endOf("d").format("YYYY-MM-DDTHH:mm"),layout:ve.k.horizontal},u)):g=Object(Me.a)(ie({insight:m.F.TRENDS,date_from:Object(M.a)().subtract(Et,"day").format("YYYY-MM-DD"),date_to:Object(M.a)().endOf("d").format("YYYY-MM-DDTHH:mm")},u)),w={description:"",tags:[],filters:g,result:null},C.next=5,q.b.create("api/projects/".concat(Je.a.values.currentTeamId,"/insights"),w);case 5:x=C.sent,r.setPreviewInsightId(x.short_id);case 7:case"end":return C.stop()}},i)}));function p(i){return c.apply(this,arguments)}return p}(),setFilters:function(p){var i=p.filters;if(i.insight===m.F.FUNNELS){var d;(d=De.a.findMounted({dashboardItemId:a.previewInsightId}))===null||d===void 0||d.actions.setFilters(i)}else{var u;(u=Qe.a.findMounted({dashboardItemId:a.previewInsightId}))===null||u===void 0||u.actions.setFilters(i)}},createNewMetric:function(){r.addNewMetric(ie(ie({},a.currentMetric),{},{name:a.currentMetricName})),o.onMetricsChange(a.metrics),r.changeInsightType(m.F.TRENDS),r.setCurrentMetricName("")},deleteMetric:function(){o.onMetricsChange(a.metrics)},changeInsightType:function(){return r.createPreviewInsight(a.currentMetric.filters)}}},events:function(n){var r=n.actions;return{afterMount:function(){r.createPreviewInsight()}}}}),G=l("./frontend/src/lib/components/LemonButton/index.ts"),tt=l("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilterRow/ActionFilterRow.tsx");function St(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);n&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,a)}return r}function re(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?St(Object(r),!0).forEach(function(a){Ie()(t,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):St(Object(r)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(r,a))})}return t}function Re(t){var n=t.onMetricsChange,r=t.initialMetrics,a=sn({onMetricsChange:n,initialMetrics:r}),o=Object(V.useValues)(a),c=o.previewInsightId,p=o.metrics,i=o.modalVisible,d=o.currentMetric,u=Object(V.useActions)(a),g=u.createNewMetric,w=u.updateMetricFilters,x=u.setFilters,F=u.showModal,C=u.hideModal,b=u.changeInsightType,N=u.setCurrentMetricName,O=u.deleteMetric,s=Object(V.useValues)(Object(je.c)({dashboardItemId:c,syncWithUrl:!1})),S=s.insightProps,U=Object(V.useValues)(Object(De.a)(S)),X=U.isStepsEmpty,Z=U.filterSteps;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(rn.a,{title:"Add secondary metric",visible:i,destroyOnClose:!0,onCancel:C,footer:null,style:{minWidth:600},children:Object(e.jsxs)(J.a,{layout:"vertical",initialValues:{type:m.F.TRENDS},onValuesChange:function(R){R.name&&N(R.name)},onFinish:function(){g(),C()},scrollToFirstError:!0,requiredMark:!1,children:[Object(e.jsx)(J.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"You have to enter a name."}],children:Object(e.jsx)(Ce.a,{})}),Object(e.jsx)(J.a.Item,{name:"type",label:"Type",children:Object(e.jsxs)(W.a,{style:{display:"flex"},value:d.filters.insight,onChange:function(){b()},suffixIcon:Object(e.jsx)(Pe.a,{}),dropdownMatchSelectWidth:!1,children:[Object(e.jsx)(W.a.Option,{value:m.F.TRENDS,children:Object(e.jsx)(f.a,{children:Object(e.jsx)("span",{children:Object(e.jsx)("b",{children:"Trend"})})})}),Object(e.jsx)(W.a.Option,{value:m.F.FUNNELS,children:Object(e.jsx)(f.a,{children:Object(e.jsx)("span",{children:Object(e.jsx)("b",{children:"Conversion funnel"})})})})]})}),Object(e.jsxs)(J.a.Item,{name:"query",label:"Query",children:[d.filters.insight===m.F.FUNNELS&&Object(e.jsx)(de.a,{bordered:!0,filters:d.filters,setFilters:function(R){var _=re(re({},d.filters),{},{insight:m.F.FUNNELS},R);w(_),x(_)},typeKey:"funnel-preview-metric",mathAvailability:tt.b.None,hideDeleteBtn:Z.length===1,buttonCopy:"Add funnel step",showSeriesIndicator:!X,seriesIndicatorType:"numeric",sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[I.a.EventProperties,I.a.PersonProperties,I.a.EventFeatureFlags,I.a.Cohorts,I.a.Elements]}),d.filters.insight===m.F.TRENDS&&Object(e.jsx)(de.a,{bordered:!0,entitiesLimit:1,filters:d.filters,setFilters:function(R){var _=re(re({},d.filters),{},{insight:m.F.TRENDS},R);w(_),x(_)},typeKey:"trend-preview-metric",buttonCopy:"Add graph series",showSeriesIndicator:!0,propertiesTaxonomicGroupTypes:[I.a.EventProperties,I.a.PersonProperties,I.a.EventFeatureFlags,I.a.Cohorts,I.a.Elements]})]}),Object(e.jsx)(J.a.Item,{name:"metric-preview",label:"Metric preview",children:Object(e.jsx)(V.BindLogic,{logic:je.c,props:S,children:Object(e.jsx)(Ze.a,{disableHeader:!0,disableTable:!0,disableCorrelationTable:!0})})}),Object(e.jsxs)(h.a,{justify:"end",children:[Object(e.jsx)(G.a,{type:"secondary",className:"mr-2",onClick:function(){return C()},children:"Cancel"}),Object(e.jsx)(G.a,{type:"primary",htmlType:"submit",children:"Save"})]})]})}),Object(e.jsx)(h.a,{children:Object(e.jsxs)(f.a,{children:[p.map(function(E,R){return Object(e.jsxs)(h.a,{className:"mt-4 border rounded p-4",children:[Object(e.jsxs)(h.a,{align:"middle",justify:"space-between",className:"w-full mb-3 pb-2 border-b",children:[Object(e.jsx)("div",{children:Object(e.jsx)("b",{children:E.name})}),Object(e.jsx)(G.a,{icon:Object(e.jsx)(k.IconDelete,{}),size:"small",status:"muted",onClick:function(){return O(R)}})]}),E.filters.insight===m.F.FUNNELS&&Object(e.jsx)(de.a,{bordered:!0,filters:E.filters,setFilters:function(D){var K=re(re({},E.filters),{},{insight:m.F.FUNNELS},D);w(K),x(K)},typeKey:"funnel-preview-".concat(R),mathAvailability:tt.b.None,hideDeleteBtn:Z.length===1,buttonCopy:"Add funnel step",showSeriesIndicator:!X,seriesIndicatorType:"numeric",sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[I.a.EventProperties,I.a.PersonProperties,I.a.EventFeatureFlags,I.a.Cohorts,I.a.Elements],readOnly:!0}),E.filters.insight===m.F.TRENDS&&Object(e.jsx)(de.a,{bordered:!0,filters:E.filters,setFilters:function(D){var K=re(re({},E.filters),{},{insight:m.F.TRENDS},D);w(K),x(K)},typeKey:"trend-preview-".concat(R),buttonCopy:"Add graph series",showSeriesIndicator:!0,entitiesLimit:1,propertiesTaxonomicGroupTypes:[I.a.EventProperties,I.a.PersonProperties,I.a.EventFeatureFlags,I.a.Cohorts,I.a.Elements],readOnly:!0})]},R)}),p&&!(p.length>2)&&Object(e.jsx)(f.a,{children:Object(e.jsx)("div",{className:"mb-2 mt-4",children:Object(e.jsx)(G.a,{type:"secondary",onClick:F,children:"Add metric"})})})]})})]})}try{Re.displayName="SecondaryMetrics",Re.__docgenInfo={description:"",displayName:"SecondaryMetrics",props:{onMetricsChange:{defaultValue:null,description:"",name:"onMetricsChange",required:!0,type:{name:"(metrics: SecondaryExperimentMetric[]) => void"}},initialMetrics:{defaultValue:null,description:"",name:"initialMetrics",required:!0,type:{name:"SecondaryExperimentMetric[]"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/SecondaryMetrics.tsx#SecondaryMetrics"]={docgenInfo:Re.__docgenInfo,name:"SecondaryMetrics",path:"frontend/src/scenes/experiments/SecondaryMetrics.tsx#SecondaryMetrics"})}catch(t){}var nt=l("./frontend/src/lib/colors.ts"),on=l("./frontend/src/lib/components/EntityFilterInfo.tsx"),ln=l("./frontend/src/lib/components/EditableField/EditableField.tsx"),wt=l("./frontend/src/lib/components/Link.tsx"),cn=l("./node_modules/antd/es/slider/index.js"),dn=l("./node_modules/antd/es/input-number/index.js"),pn=l("./frontend/src/lib/components/InsightLabel/index.tsx"),Nt=l("./frontend/src/lib/components/PropertyFilters/components/PropertyFilterButton.tsx");function un(){var t=Object(fe.useState)(!1),n=ce()(t,2),r=n[0],a=n[1],o=Object(fe.useState)(!1),c=ce()(o,2),p=c[0],i=c[1];return Object(e.jsxs)(ze.a,{className:"experiment-workflow",title:Object(e.jsx)("span",{className:"card-secondary",children:"Experiment workflow"}),children:[Object(e.jsx)(h.a,{children:Object(e.jsxs)(f.a,{className:"exp-workflow-step step-completed w-full",children:[Object(e.jsxs)(h.a,{align:"middle",children:[Object(e.jsx)(k.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}),Object(e.jsx)("b",{className:"ml-2",children:"Create experiment"})]}),Object(e.jsx)("div",{className:"ml-8",children:"Set variants, select participants, and add secondary metrics"})]})}),Object(e.jsx)(h.a,{children:Object(e.jsxs)(f.a,{className:"w-full exp-workflow-step ".concat(r?"step-completed":""),onClick:function(){return a(!r)},children:[Object(e.jsxs)(h.a,{align:"middle",children:[r?Object(e.jsx)(k.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}):Object(e.jsx)(k.IconRadioButtonUnchecked,{}),Object(e.jsx)("b",{className:"ml-2",children:"Validate experiment"})]}),Object(e.jsx)("div",{className:"ml-8",children:"Once you've written your code, it's a good idea to test that each variant behaves as you'd expect."})]})}),Object(e.jsx)(h.a,{children:Object(e.jsxs)(f.a,{className:"w-full exp-workflow-step ".concat(p?"step-completed":""),onClick:function(){return i(!p)},children:[Object(e.jsxs)(h.a,{align:"middle",children:[p?Object(e.jsx)(k.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}):Object(e.jsx)(k.IconRadioButtonUnchecked,{}),Object(e.jsx)("b",{className:"ml-2",children:"Launch experiment"})]}),Object(e.jsx)("div",{className:"ml-8",children:"Run your experiment, monitor results, and decide when to terminate your experiment."})]})})]})}function ye(t){var n,r,a,o,c,p,i=t.experiment,d=t.trendCount,u=t.funnelConversionRate,g=t.trendExposure,w=t.funnelSampleSize,x=t.funnelEntrants,F=(i==null?void 0:i.id)||"new",C=Object(V.useValues)(be({experimentId:F})),b=C.experimentInsightType,N=C.editingExistingExperiment,O=C.minimumDetectableChange,s=C.expectedRunningTime,S=C.aggregationLabel,U=Object(V.useActions)(be({experimentId:F})),X=U.setNewExperimentData,Z=b===m.F.FUNNELS&&100-u<50?100-u:50,E=Object(M.a)().diff(Object(M.a)(i==null?void 0:i.start_date),"hour"),R=0;i!=null&&i.start_date?R=s(x||1,w||0,E):R=s(x||1,w||0);var _=Object(M.a)(i==null?void 0:i.start_date).add(R,"hour"),D=!(i!=null&&i.end_date)&&E>=24&&x&&w,K=Object(P.r)(i==null||(n=i.filters)===null||n===void 0?void 0:n.properties);return Object(e.jsxs)(h.a,{children:[Object(e.jsxs)(f.a,{span:!(i!=null&&i.start_date)&&F!=="new"&&!N?12:24,children:[F==="new"&&Object(e.jsx)(h.a,{className:"experiment-preview-row",children:Object(e.jsxs)("div",{children:[Object(e.jsx)("div",{children:Object(e.jsx)("b",{children:"Experiment preview"})}),Object(e.jsxs)("div",{className:"text-muted",children:["Here are the baseline metrics for your experiment. Adjust your minimum detectible threshold to adjust for the smallest conversion value you\u2019ll accept, and the experiment duration."," "]})]})}),(F==="new"||N)&&Object(e.jsx)(h.a,{className:"mb-4",children:Object(e.jsxs)(f.a,{span:24,children:[Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:"Minimum acceptable improvement"}),Object(e.jsx)(Te.a,{title:"Minimum acceptable improvement is a calculation that estimates the smallest significant improvement you are willing to accept.",children:Object(e.jsx)(ge.a,{style:{marginLeft:4}})})]}),Object(e.jsxs)(h.a,{className:"mde-slider",children:[Object(e.jsx)(f.a,{span:8,children:Object(e.jsx)(cn.a,{defaultValue:5,value:O,min:1,max:Z,trackStyle:{background:"var(--primary)"},handleStyle:{background:"var(--primary)"},onChange:function(A){X({parameters:{minimum_detectable_effect:A}})},tipFormatter:function(A){return"".concat(A,"%")}})}),Object(e.jsx)(dn.a,{min:1,max:Z,defaultValue:5,formatter:function(A){return"".concat(A,"%")},style:{margin:"0 16px"},value:O,onChange:function(A){X({parameters:{minimum_detectable_effect:A}})}})]})]})}),Object(e.jsxs)(h.a,{className:"experiment-preview-row ".concat(i!=null&&i.start_date?"mr":""),children:[b===m.F.TRENDS?Object(e.jsxs)(e.Fragment,{children:[!(i!=null&&i.start_date)&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)(f.a,{span:6,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Baseline Count"}),Object(e.jsx)("div",{className:"l4",children:Object(P.P)(d||0)})]}),Object(e.jsxs)(f.a,{span:6,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Minimum Acceptable Count"}),Object(e.jsx)("div",{className:"l4",children:Object(P.P)(d+Math.ceil(d*(O/100))||0)})]})]}),Object(e.jsxs)(f.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Recommended running time"}),Object(e.jsxs)("div",{children:[Object(e.jsxs)("span",{className:"l4",children:["~",Object(P.P)(g||0)]})," days"]})]})]}):Object(e.jsxs)(e.Fragment,{children:[!(i!=null&&i.start_date)&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)(f.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Baseline Conversion Rate"}),Object(e.jsxs)("div",{className:"l4",children:[u.toFixed(1),"%"]})]}),Object(e.jsxs)(f.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Minimum Acceptable Conversion Rate"}),Object(e.jsxs)("div",{className:"l4",children:[(u+O).toFixed(1),"%"]})]})]}),Object(e.jsxs)(f.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Recommended Sample Size"}),Object(e.jsxs)("div",{className:"pb-4",children:[Object(e.jsxs)("span",{className:"l4",children:["~",Object(P.P)(w||0)]})," persons"]})]}),!(i!=null&&i.start_date)&&Object(e.jsxs)(f.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Recommended running time"}),Object(e.jsxs)("div",{children:[Object(e.jsxs)("span",{className:"l4",children:["~",Object(P.P)(R||0)]})," days"]})]})]}),Object(e.jsxs)(h.a,{className:"w-full mt-4",children:[Object(e.jsxs)(f.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Experiment variants"}),Object(e.jsx)("ul",{className:"variants-list",children:i==null||(r=i.parameters)===null||r===void 0||(a=r.feature_flag_variants)===null||a===void 0?void 0:a.map(function($,A){return Object(e.jsx)("li",{children:$.key},A)})})]}),Object(e.jsxs)(f.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Participants"}),Object(e.jsx)("div",{children:K!=null&&K.length?Object(e.jsx)("div",{children:K==null?void 0:K.map(function($){return Object(e.jsx)(Nt.a,{item:$,style:{margin:2,cursor:"default"}},$.key)})}):Object(e.jsxs)(e.Fragment,{children:["100% of"," ",(i==null||(o=i.filters)===null||o===void 0?void 0:o.aggregation_group_type_index)!=null?Object(P.i)(S(i.filters.aggregation_group_type_index).plural):"users"]})})]})]}),Object(e.jsxs)(h.a,{className:"w-full",children:[F!=="new"&&!N&&Object(e.jsxs)(f.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary mt-4",children:"Start date"}),i!=null&&i.start_date?Object(e.jsx)("span",{children:Object(M.a)(i==null?void 0:i.start_date).format("D MMM YYYY")}):Object(e.jsx)("span",{className:"description",children:"Not started yet"})]}),b===m.F.FUNNELS&&D?Object(e.jsxs)(f.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary mt-4",children:"Expected end date"}),Object(e.jsx)("span",{children:_.isAfter(Object(M.a)())?_.format("D MMM YYYY"):Object(M.a)().format("D MMM YYYY")})]}):null,(i==null?void 0:i.end_date)&&Object(e.jsxs)(f.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary mt-4",children:"Completed date"}),Object(e.jsx)("span",{children:Object(M.a)(i==null?void 0:i.end_date).format("D MMM YYYY")})]})]})]}),F!=="new"&&!N&&Object(e.jsx)(h.a,{className:"experiment-preview-row",children:Object(e.jsxs)(f.a,{children:[Object(e.jsx)("div",{className:"card-secondary mb-2",children:b===m.F.FUNNELS?"Conversion goal steps":"Trend goal"}),[].concat(ne()((i==null||(c=i.filters)===null||c===void 0?void 0:c.events)||[]),ne()((i==null||(p=i.filters)===null||p===void 0?void 0:p.actions)||[])).sort(function($,A){return($.order||0)-(A.order||0)}).map(function($,A){var ue;return Object(e.jsxs)(f.a,{className:"mb-2",children:[Object(e.jsxs)(h.a,{style:{marginBottom:4},children:[Object(e.jsx)("div",{className:"preview-conversion-goal-num",children:b===m.F.FUNNELS?($.order||0)+1:A+1}),Object(e.jsx)("b",{children:Object(e.jsx)(pn.a,{action:$,showCountedByTag:b===m.F.TRENDS,hideIcon:!0})})]}),(ue=$.properties)===null||ue===void 0?void 0:ue.map(function(me){return Object(e.jsx)(Nt.a,{item:me},me.key)})]},A)})]})})]}),F!=="new"&&!N&&!(i!=null&&i.start_date)&&Object(e.jsx)(f.a,{span:12,className:"pl-4",children:Object(e.jsx)(un,{})})]})}try{ye.displayName="ExperimentPreview",ye.__docgenInfo={description:"",displayName:"ExperimentPreview",props:{experiment:{defaultValue:null,description:"",name:"experiment",required:!0,type:{name:"Partial<Experiment> | null"}},trendCount:{defaultValue:null,description:"",name:"trendCount",required:!0,type:{name:"number"}},trendExposure:{defaultValue:null,description:"",name:"trendExposure",required:!1,type:{name:"number"}},funnelSampleSize:{defaultValue:null,description:"",name:"funnelSampleSize",required:!1,type:{name:"number"}},funnelConversionRate:{defaultValue:null,description:"",name:"funnelConversionRate",required:!0,type:{name:"number"}},funnelEntrants:{defaultValue:null,description:"",name:"funnelEntrants",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentPreview.tsx#ExperimentPreview"]={docgenInfo:ye.__docgenInfo,name:"ExperimentPreview",path:"frontend/src/scenes/experiments/ExperimentPreview.tsx#ExperimentPreview"})}catch(t){}var rt=l("./frontend/@posthog/lemon-ui/src/index.ts"),Y=l("./frontend/src/lib/components/CodeSnippet/index.tsx");function Oe(){return Object(e.jsx)("div",{className:"warning",children:Object(e.jsxs)("p",{children:[Object(e.jsx)("b",{children:"Warning:"})," Server side experiment metrics require you to manually send the feature flag information."," ",Object(e.jsx)(rt.Link,{to:"https://posthog.com/tutorials/experiments#step-2-sending-the-right-events",target:"_blank",children:"See this tutorial for more information."})]})})}function Ae(t){var n=t.flagKey,r=t.variant;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Y.a,{language:Y.b.JavaScript,wrap:!0,children:"const experimentFlagValue = await client.getFeatureFlag('".concat(n,`', 'user distinct id')

if (experimentFlagValue === '`).concat(r,`' ) {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`)}),Object(e.jsx)(Oe,{})]})}function Le(t){var n=t.flagKey,r=t.variant;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Y.a,{language:Y.b.JavaScript,wrap:!0,children:"if (posthog.getFeatureFlag('".concat(n,"') === '").concat(r,`') {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`)}),Object(e.jsx)("b",{children:"Test that it works"}),Object(e.jsx)(Y.a,{language:Y.b.JavaScript,wrap:!0,children:"posthog.feature_flags.override({'".concat(n,"': '").concat(r,"'})")})]})}function Ve(t){var n=t.flagKey,r=t.variant;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(Y.a,{language:Y.b.JavaScript,wrap:!0,children:"if (posthog.getFeatureFlag('".concat(n,"') === '").concat(r,`') {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`)})})}function ke(t){var n=t.flagKey,r=t.variant;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Y.a,{language:Y.b.PHP,wrap:!0,children:"if (PostHog::getFeatureFlag('".concat(n,"', 'user distinct id') == '").concat(r,`') {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`)}),Object(e.jsx)(Oe,{})]})}function Ye(t){var n=t.flagKey,r=t.variant;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Y.a,{language:Y.b.Go,wrap:!0,children:`experimentFlagValue, err := client.GetFeatureFlag(
                    FeatureFlagPayload{
                        Key:        '`.concat(n,`',
                        DistinctId: "distinct-id",
                    })

if (experimentFlagValue == '`).concat(r,`' ) {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`)}),Object(e.jsx)(Oe,{})]})}function Ke(t){var n=t.flagKey,r=t.variant;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Y.a,{language:Y.b.Ruby,wrap:!0,children:"experimentFlagValue = posthog.get_feature_flag('".concat(n,`', 'user distinct id')


if experimentFlagValue == '`).concat(r,`'
    # Do something differently for this user
else
    # It's a good idea to let control variant always be the default behaviour,
    # so if something goes wrong with flag evaluation, you don't break your app.
end
`)}),Object(e.jsx)(Oe,{})]})}function $e(t){var n=t.flagKey,r=t.variant;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Y.a,{language:Y.b.Python,wrap:!0,children:'experiment_flag_value = posthog.get_feature_flag("'.concat(n,`", "user_distinct_id"):

if experiment_flag_value == '`).concat(r,`':
    # Do something differently for this user
else:
    # It's a good idea to let control variant always be the default behaviour,
    # so if something goes wrong with flag evaluation, you don't break your app.
`)}),Object(e.jsx)(Oe,{})]})}try{Ae.displayName="NodeJSSnippet",Ae.__docgenInfo={description:"",displayName:"NodeJSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#NodeJSSnippet"]={docgenInfo:Ae.__docgenInfo,name:"NodeJSSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#NodeJSSnippet"})}catch(t){}try{Le.displayName="JSSnippet",Le.__docgenInfo={description:"",displayName:"JSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#JSSnippet"]={docgenInfo:Le.__docgenInfo,name:"JSSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#JSSnippet"})}catch(t){}try{Ve.displayName="RNSnippet",Ve.__docgenInfo={description:"",displayName:"RNSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RNSnippet"]={docgenInfo:Ve.__docgenInfo,name:"RNSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RNSnippet"})}catch(t){}try{ke.displayName="PHPSnippet",ke.__docgenInfo={description:"",displayName:"PHPSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PHPSnippet"]={docgenInfo:ke.__docgenInfo,name:"PHPSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PHPSnippet"})}catch(t){}try{Ye.displayName="GolangSnippet",Ye.__docgenInfo={description:"",displayName:"GolangSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#GolangSnippet"]={docgenInfo:Ye.__docgenInfo,name:"GolangSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#GolangSnippet"})}catch(t){}try{Ke.displayName="RubySnippet",Ke.__docgenInfo={description:"",displayName:"RubySnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RubySnippet"]={docgenInfo:Ke.__docgenInfo,name:"RubySnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RubySnippet"})}catch(t){}try{$e.displayName="PythonSnippet",$e.__docgenInfo={description:"",displayName:"PythonSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PythonSnippet"]={docgenInfo:$e.__docgenInfo,name:"PythonSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PythonSnippet"})}catch(t){}var se="?utm_medium=in-product&utm_campaign=experiment",oe="https://posthog.com/docs/integrate/",le="#feature-flags",at=[{value:"JavaScript",documentationLink:"".concat(oe,"client/js").concat(se).concat(le),Icon:k.IconJavascript,Snippet:Le},{value:"ReactNative",documentationLink:"".concat(oe,"client/react-native").concat(se).concat(le),Icon:k.IconJavascript,Snippet:Ve},{value:"Node.js",documentationLink:"".concat(oe,"server/node").concat(se).concat(le),Icon:k.IconNodeJS,Snippet:Ae},{value:"PHP",documentationLink:"".concat(oe,"server/php").concat(se).concat(le),Icon:k.IconPHP,Snippet:ke},{value:"Ruby",documentationLink:"".concat(oe,"server/ruby").concat(se).concat(le),Icon:k.IconRuby,Snippet:Ke},{value:"Golang",documentationLink:"".concat(oe,"server/go").concat(se).concat(le),Icon:k.IconGolang,Snippet:Ye},{value:"Python",documentationLink:"".concat(oe,"server/python").concat(se).concat(le),Icon:k.IconPython,Snippet:$e}];function Be(t){var n=t.selectedOptionValue,r=t.selectOption;return Object(e.jsx)(W.a,{value:n,onChange:r,style:{minWidth:120},suffixIcon:Object(e.jsx)(Pe.a,{}),children:at.map(function(a,o){var c=a.value,p=a.Icon;return Object(e.jsx)(W.a.Option,{"data-attr":"experiment-instructions-select-option-"+c,value:c,children:Object(e.jsxs)("div",{className:"flex items-center",children:[Object(e.jsx)(p,{className:"mr-1"})," ",c]})},o)})})}function Ee(t){var n,r,a,o,c,p,i,d=t.experiment,u=(n=d==null||(r=d.parameters)===null||r===void 0||(a=r.feature_flag_variants)===null||a===void 0||(o=a[1])===null||o===void 0?void 0:o.key)!==null&&n!==void 0?n:"test",g=Object(fe.useState)(u),w=ce()(g,2),x=w[0],F=w[1],C=at[0],b=Object(fe.useState)(C),N=ce()(b,2),O=N[0],s=N[1],S=function(X){var Z=at.find(function(E){return E.value===X});Z&&s(Z)};return Object(e.jsxs)(ze.a,{title:Object(e.jsx)("span",{className:"card-secondary",children:"Feature flag usage and implementation"}),className:"experiment-implementation-details",children:[Object(e.jsxs)("div",{style:{justifyContent:"space-between"},className:"flex mb-2",children:[Object(e.jsxs)("div",{children:[Object(e.jsx)("span",{className:"mr-2",children:"Variant group"}),Object(e.jsx)(W.a,{onChange:F,value:x,style:{minWidth:80},suffixIcon:Object(e.jsx)(Pe.a,{}),children:d==null||(c=d.parameters)===null||c===void 0||(p=c.feature_flag_variants)===null||p===void 0?void 0:p.map(function(U,X){return Object(e.jsx)(W.a.Option,{value:U.key,children:U.key},X)})})]}),Object(e.jsx)("div",{children:Object(e.jsx)(Be,{selectOption:S,selectedOptionValue:O.value})})]}),Object(e.jsx)("b",{children:"Implement your experiment in code"}),Object(e.jsx)(O.Snippet,{variant:x,flagKey:(i=d==null?void 0:d.feature_flag_key)!==null&&i!==void 0?i:""}),Object(e.jsx)(rt.Link,{to:O.documentationLink,target:"_blank",children:Object(e.jsxs)("div",{className:"flex items-center",children:["See the docs for more implementation information. ",Object(e.jsx)(k.IconOpenInNew,{className:"ml-1"})]})})]})}try{Be.displayName="CodeLanguageSelect",Be.__docgenInfo={description:"",displayName:"CodeLanguageSelect",props:{selectedOptionValue:{defaultValue:null,description:"",name:"selectedOptionValue",required:!0,type:{name:"string"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(selectedValue: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#CodeLanguageSelect"]={docgenInfo:Be.__docgenInfo,name:"CodeLanguageSelect",path:"frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#CodeLanguageSelect"})}catch(t){}try{Ee.displayName="ExperimentImplementationDetails",Ee.__docgenInfo={description:"",displayName:"ExperimentImplementationDetails",props:{experiment:{defaultValue:null,description:"",name:"experiment",required:!0,type:{name:"Partial<Experiment> | null"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#ExperimentImplementationDetails"]={docgenInfo:Ee.__docgenInfo,name:"ExperimentImplementationDetails",path:"frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#ExperimentImplementationDetails"})}catch(t){}var mn=l("./frontend/src/lib/components/NotFound/index.tsx"),It=l("./frontend/src/lib/components/AlertMessage/index.ts");function Ft(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);n&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,a)}return r}function Se(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Ft(Object(r),!0).forEach(function(a){Ie()(t,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ft(Object(r)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(r,a))})}return t}var fn={component:Ct,logic:be,paramsToProps:function(n){var r=n.params.id;return{experimentId:r==="new"?"new":parseInt(r)}}};function Ct(){var t,n,r,a,o,c,p,i,d,u,g,w,x,F,C,b=Object(V.useValues)(be),N=b.experimentId,O=b.newExperimentData,s=b.experimentData,S=b.experimentInsightId,U=b.minimumSampleSizePerVariant,X=b.recommendedExposureForCountData,Z=b.variants,E=b.experimentResults,R=b.countDataForVariant,_=b.editingExistingExperiment,D=b.experimentInsightType,K=b.experimentResultsLoading,$=b.parsedSecondaryMetrics,A=b.areResultsSignificant,ue=b.conversionRateForVariant,me=b.getIndexForVariant,jn=b.significanceBannerDetails,vn=b.areTrendResultsConfusing,hn=b.taxonomicGroupTypesForSelection,gn=b.groupTypes,xn=b.aggregationLabel,te=b.secondaryMetricResults,bn=b.experimentDataLoading,yn=b.secondaryMetricResultsLoading,Tt=b.experimentResultCalculationError,On=b.flagImplementationWarning,En=b.flagAvailabilityWarning,it=b.sortedExperimentResultVariants,z=Object(V.useActions)(be),we=z.setNewExperimentData,Sn=z.createExperiment,wn=z.launchExperiment,_e=z.setFilters,Nn=z.setEditExperiment,Dt=z.endExperiment,In=z.addExperimentGroup,Fn=z.updateExperiment,Cn=z.updateExperimentGroup,Tn=z.removeExperimentGroup,Dn=z.setSecondaryMetrics,Mn=z.setExperimentInsightType,Pn=z.archiveExperiment,Rn=J.a.useForm(),An=ce()(Rn,1),Ln=An[0],Vn=Object(fe.useState)(!0),Mt=ce()(Vn,2),st=Mt[0],ot=Mt[1],kn=Object(V.useValues)(Object(je.c)({dashboardItemId:S})),lt=kn.insightProps,Ne=Object(V.useValues)(Object(De.a)(lt)),Yn=Ne.isStepsEmpty,Kn=Ne.filterSteps,Pt=Ne.filters,ct=Ne.results,$n=Ne.conversionMetrics,Rt=Object(V.useValues)(Object(Qe.a)(lt)),At=Rt.filters,Bn=Rt.results,dt=$n.totalRate*100,_n=U(dt),Lt=_n*Z.length,pt=(t=Bn[0])===null||t===void 0?void 0:t.count,Vt=ct==null||(n=ct[0])===null||n===void 0?void 0:n.count,kt=X(pt),Q=Math.floor(24/(Z.length+2)),Ge=D===m.F.FUNNELS&&E!==null&&E!==void 0&&E.insight?E.insight.reduce(function(v,j){var L;return((L=j[0])===null||L===void 0?void 0:L.count)+v},0):0,Gn=D===m.F.FUNNELS?(Ge||0)/((s==null||(r=s.parameters)===null||r===void 0?void 0:r.recommended_sample_size)||1)*100:Object(M.a)().diff(s==null?void 0:s.start_date,"day")/((s==null||(a=s.parameters)===null||a===void 0?void 0:a.recommended_running_time)||1)*100,Un={running:"green",draft:"default",complete:"purple"},Yt=function(){if(s!=null&&s.start_date){if(!(s!=null&&s.end_date))return"running"}else return"draft";return"complete"},Kt=10,$t=[{background:"#35416b",color:"#fff"},{background:"#C278CE66",color:"#35416B"},{background:"#FFE6AE",color:"#35416B"},{background:"#8DA9E74D",color:"#35416B"}];return bn?Object(e.jsx)(Fe.a,{active:!0}):!s&&N!=="new"?Object(e.jsx)(mn.a,{object:"experiment"}):Object(e.jsx)(e.Fragment,{children:N==="new"||_?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)(h.a,{align:"middle",justify:"space-between",style:{borderBottom:"1px solid var(--border)",marginBottom:"1rem",paddingBottom:8},children:[Object(e.jsx)(ht.a,{title:_?"Edit experiment":"New experiment"}),Object(e.jsxs)(h.a,{children:[Object(e.jsx)(G.a,{type:"secondary",className:"mr-2",onClick:s?function(){return pe.router.actions.push(ee.a.experiment(s.id))}:function(){return pe.router.actions.push(ee.a.experiments())},children:"Cancel"}),Object(e.jsx)(G.a,{type:"primary",htmlType:"submit",form:"new-experiment",children:"Save"})]})]}),Object(e.jsxs)(J.a,{name:"new-experiment",layout:"vertical",className:"experiment-form",form:Ln,onValuesChange:function(j){return we(j)},initialValues:{name:O==null?void 0:O.name,feature_flag_key:O==null?void 0:O.feature_flag_key,description:O==null?void 0:O.description},onFinish:function(){return Sn(!0,kt,Lt)},requiredMark:!1,scrollToFirstError:!0,children:[Object(e.jsx)("div",{children:Object(e.jsxs)(V.BindLogic,{logic:je.c,props:lt,children:[Object(e.jsxs)(h.a,{children:[Object(e.jsxs)(f.a,{span:12,style:{paddingRight:24},children:[Object(e.jsxs)(h.a,{className:"w-full",children:[Object(e.jsx)(J.a.Item,{style:{marginRight:16},label:"Name",name:"name",rules:[{required:!0,message:"You have to enter a name."}],children:Object(e.jsx)(Ce.a,{"data-attr":"experiment-name",className:"ph-ignore-input"})}),Object(e.jsx)(J.a.Item,{style:{marginBottom:"1rem"},label:Object(e.jsxs)("div",{children:["Feature flag key"," ",Object(e.jsx)(Te.a,{title:"Enter a unique key. This will create a new feature flag which will be associated with this experiment.",children:Object(e.jsx)(ge.a,{})})]}),name:"feature_flag_key",rules:[{required:!0,message:"You have to enter a feature flag key name."}],children:Object(e.jsx)(Ce.a,{"data-attr":"experiment-feature-flag-key",disabled:_})})]}),Object(e.jsx)(J.a.Item,{label:Object(e.jsxs)("div",{children:["Description ",Object(e.jsx)("span",{className:"text-muted",children:"(optional)"})]}),name:"description",children:Object(e.jsx)(rt.LemonTextArea,{"data-attr":"experiment-description",className:"ph-ignore-input",placeholder:"Adding a helpful description can ensure others know what this experiment is about."})}),(O==null||(o=O.parameters)===null||o===void 0?void 0:o.feature_flag_variants)&&Object(e.jsxs)(f.a,{children:[Object(e.jsx)("label",{children:Object(e.jsx)("b",{children:"Experiment variants"})}),Object(e.jsx)("div",{className:"text-muted",children:"Participants are divided into variant groups evenly. All experiments must consist of a control group and at least one test group. Experiments may have at most 3 test groups. Variant names can only contain letters, numbers, hyphens, and underscores."}),Object(e.jsxs)(f.a,{className:"variants",children:[O.parameters.feature_flag_variants.map(function(v,j){return Object(e.jsx)(J.a,{initialValues:{key:v.key},onValuesChange:function(H){Cn(H,j)},children:Object(e.jsxs)(h.a,{className:"feature-flag-variant ".concat(j===0?"border-t":j>=Kt?"border-b":""),children:[Object(e.jsx)("div",{className:"variant-label",style:j===0?Se({},$t[j]):Se({},$t[j%3+1]),children:j===0?"Control":"Test"}),Object(e.jsx)(J.a.Item,{name:"key",rules:[{required:!0,message:"Key should not be empty."},{required:!0,pattern:/^([A-z]|[a-z]|[0-9]|-|_)+$/,message:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(tn.a,{style:{color:"#F96132"}})," ","Variant names can only contain letters, numbers, hyphens, and underscores."]})}],style:{display:"contents"},children:Object(e.jsx)(Ce.a,{disabled:j===0,"data-attr":"feature-flag-variant-key","data-key-index":j.toString(),className:"ph-ignore-input",placeholder:"example-variant-".concat(j+1),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})}),Object(e.jsx)("div",{className:"float-right",children:!(j===0||j===1)&&Object(e.jsx)(Te.a,{title:"Delete this variant",placement:"bottomLeft",children:Object(e.jsx)(G.a,{status:"primary-alt",size:"small",icon:Object(e.jsx)(k.IconDelete,{}),onClick:function(){return Tn(j)}})})})]},"".concat(v,"-").concat(j))},"".concat(v,"-").concat(j))}),O.parameters.feature_flag_variants.length<Kt&&Object(e.jsx)("div",{className:"feature-flag-variant border-b",children:Object(e.jsx)(G.a,{onClick:function(){return In()},fullWidth:!0,icon:Object(e.jsx)(k.IconPlusMini,{}),children:"Add test variant"})})]})]}),Object(e.jsxs)(h.a,{className:"person-selection",children:[Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)("strong",{children:"Select participants"})}),Object(e.jsxs)(f.a,{children:[Object(e.jsx)("div",{className:"text-muted",children:"Select the entities who will participate in this experiment. If no filters are set, 100% of participants will be targeted."}),Object(e.jsx)("div",{className:"mt-4 mb-2",children:Object(e.jsx)("strong",{children:"Participant type"})}),Object(e.jsxs)(W.a,{value:(O==null||(c=O.filters)===null||c===void 0?void 0:c.aggregation_group_type_index)!=null?O.filters.aggregation_group_type_index:-1,onChange:function(j){var L,H=j!==-1?j:void 0;H!=(O==null||(L=O.filters)===null||L===void 0?void 0:L.aggregation_group_type_index)&&(_e({properties:[],aggregation_group_type_index:H}),we({filters:{aggregation_group_type_index:H,properties:[]}}))},"data-attr":"participant-aggregation-filter",dropdownMatchSelectWidth:!1,children:[Object(e.jsx)(W.a.Option,{value:-1,children:"Persons"},-1),gn.map(function(v){return Object(e.jsx)(W.a.Option,{value:v.group_type_index,children:Object(P.i)(xn(v.group_type_index).plural)},v.group_type_index)})]}),Object(e.jsx)("div",{className:"mt-4 mb-2",children:Object(e.jsx)("strong",{children:"Filters"})}),Object(e.jsx)("div",{className:"mb-4",children:Object(e.jsx)(Gt.a,{pageKey:"experiment-participants-property",propertyFilters:D===m.F.FUNNELS?Object(P.r)(Pt.properties):Object(P.r)(At.properties),onChange:function(j){we({filters:{properties:j}}),_e({properties:j.filter(Ut.g)})},taxonomicGroupTypes:hn})}),En&&Object(e.jsxs)(It.a,{type:"info",className:"mt-3 mb-3",children:["These properties aren't immediately available on first page load for unidentified persons. This experiment requires that at least one event is sent prior to becoming available to your product or website."," ",Object(e.jsxs)("a",{href:"https://posthog.com/docs/integrate/client/js#bootstrapping-flags",target:"_blank",children:[" ","Learn more about how to make feature flags available instantly."]})]}),Object(e.jsx)("div",{className:"mt-4 mb-2",children:Object(e.jsx)("strong",{children:"Advanced Options"})}),Object(e.jsxs)("div",{className:"mb-4",children:["For more advanced options like changing the rollout percentage and persisting feature flags, you can"," ",N==="new"?"change settings on the feature flag after creation.":Object(e.jsx)(wt.a,{to:O!=null&&O.feature_flag?ee.a.featureFlag(O.feature_flag):void 0,children:"change settings on the feature flag."})]})]})]})]}),Object(e.jsxs)(h.a,{className:"metrics-selection",children:[Object(e.jsxs)(f.a,{span:12,children:[Object(e.jsxs)("div",{className:"mb-2","data-attr":"experiment-goal-type",children:[Object(e.jsx)("b",{children:"Goal type"}),Object(e.jsx)("div",{className:"text-muted",children:D===m.F.TRENDS?"Track counts of a specific event or action":"Track how many persons complete a sequence of actions and or events"})]}),Object(e.jsxs)(W.a,{style:{display:"flex"},value:D,onChange:Mn,suffixIcon:Object(e.jsx)(Pe.a,{}),dropdownMatchSelectWidth:!1,children:[Object(e.jsx)(W.a.Option,{value:m.F.TRENDS,children:Object(e.jsx)(f.a,{children:Object(e.jsx)("span",{children:Object(e.jsx)("b",{children:"Trend"})})})}),Object(e.jsx)(W.a.Option,{value:m.F.FUNNELS,children:Object(e.jsx)(f.a,{children:Object(e.jsx)("span",{children:Object(e.jsx)("b",{children:"Conversion funnel"})})})})]}),Object(e.jsxs)("div",{className:"my-4",children:[Object(e.jsx)("b",{children:"Experiment goal"}),D===m.F.TRENDS&&Object(e.jsx)("div",{className:"text-muted",children:"Trend-based experiments can have at most one graph series. This metric is used to track the progress of your experiment."})]}),On&&Object(e.jsxs)(It.a,{type:"info",className:"mt-3 mb-3",children:["We can't detect any feature flag information for this target metric. Ensure that you're using the latest PostHog client libraries, and make sure you manually send feature flag information for server-side libraries if necessary."," ",Object(e.jsxs)("a",{href:"https://posthog.com/docs/integrate/server/python#capture",target:"_blank",children:[" ","Read the docs for how to do this for server-side libraries."]})]}),D===m.F.FUNNELS&&Object(e.jsx)(de.a,{bordered:!0,filters:Pt,setFilters:function(j){we({filters:j}),_e(j)},typeKey:"experiment-funnel-goal",mathAvailability:tt.b.None,hideDeleteBtn:Kn.length===1,buttonCopy:"Add funnel step",showSeriesIndicator:!Yn,seriesIndicatorType:"numeric",sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[I.a.EventProperties,I.a.PersonProperties,I.a.EventFeatureFlags,I.a.Cohorts,I.a.Elements]}),D===m.F.TRENDS&&Object(e.jsx)(de.a,{bordered:!0,filters:At,setFilters:function(j){we({filters:j}),_e(j)},typeKey:"experiment-trends",buttonCopy:"Add graph series",showSeriesIndicator:!0,entitiesLimit:1,hideDeleteBtn:!0,propertiesTaxonomicGroupTypes:[I.a.EventProperties,I.a.PersonProperties,I.a.EventFeatureFlags,I.a.Cohorts,I.a.Elements]}),Object(e.jsx)(h.a,{className:"secondary-metrics",children:Object(e.jsxs)("div",{className:"flex flex-col",children:[Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:"Secondary metrics"}),Object(e.jsx)("span",{className:"text-muted ml-2",children:"(optional)"})]}),Object(e.jsxs)("div",{className:"text-muted",style:{marginTop:4},children:["Use secondary metrics to monitor metrics related to your experiment goal. You can add up to three secondary metrics."," "]}),Object(e.jsx)(Re,{onMetricsChange:function(j){return Dn(j)},initialMetrics:$})]})})]}),Object(e.jsxs)(f.a,{span:12,className:"pl-4",children:[Object(e.jsx)("div",{className:"card-secondary mb-4","data-attr":"experiment-preview",children:"Goal preview"}),Object(e.jsx)(Ze.a,{disableHeader:D===m.F.TRENDS,disableTable:!0,disableCorrelationTable:!0})]})]})]}),Object(e.jsx)(h.a,{children:Object(e.jsx)(ze.a,{className:"experiment-preview",children:Object(e.jsx)(ye,{experiment:O,trendCount:pt,trendExposure:kt,funnelSampleSize:Lt,funnelEntrants:Vt,funnelConversionRate:dt})})})]})}),Object(e.jsx)(G.a,{className:"float-right",type:"primary",htmlType:"submit",children:"Save"})]})]}):s?Object(e.jsxs)("div",{className:"view-experiment",children:[Object(e.jsx)(h.a,{className:"draft-header",children:Object(e.jsxs)(h.a,{justify:"space-between",align:"middle",className:"w-full pb-4",children:[Object(e.jsxs)(f.a,{children:[Object(e.jsx)(h.a,{children:Object(e.jsx)(ht.a,{style:{paddingRight:8},title:"".concat(s==null?void 0:s.name),buttons:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(nn.a,{explicitValue:s.feature_flag_key,iconStyle:{color:"var(--muted-alt)"},children:Object(e.jsx)("span",{className:"text-muted",children:s.feature_flag_key})}),Object(e.jsx)(ft.a,{style:{alignSelf:"center"},color:Un[Yt()],children:Object(e.jsx)("b",{className:"uppercase",children:Yt()})}),E&&s.end_date&&Object(e.jsx)(ft.a,{style:{alignSelf:"center"},color:A?"green":"geekblue",children:Object(e.jsx)("b",{className:"uppercase",children:A?"Significant Results":"Results not significant"})})]})})}),Object(e.jsx)("span",{className:"exp-description",children:s.start_date?Object(e.jsx)(ln.a,{multiline:!0,name:"description",value:s.description||"",placeholder:"Description (optional)",onSave:function(j){return Fn({description:j})},maxLength:400,"data-attr":"experiment-description",compactButtons:!0}):Object(e.jsx)(e.Fragment,{children:s.description||"There is no description for this experiment."})})]}),s&&!s.start_date&&Object(e.jsxs)("div",{className:"flex items-center",children:[Object(e.jsx)(G.a,{type:"secondary",className:"mr-2",onClick:function(){return Nn(!0)},children:"Edit"}),Object(e.jsx)(G.a,{type:"primary",onClick:function(){return wn()},children:"Launch"})]}),s&&s.start_date&&!s.end_date&&Object(e.jsx)(G.a,{type:"secondary",status:"danger",onClick:function(){return Dt()},children:"Stop"}),(s==null?void 0:s.end_date)&&Object(M.a)().isSameOrAfter(Object(M.a)(s.end_date),"day")&&!s.archived&&Object(e.jsx)(G.a,{type:"secondary",status:"danger",onClick:function(){return Pn()},children:Object(e.jsx)("b",{children:"Archive"})})]})}),Object(e.jsxs)(h.a,{children:[st&&E&&A&&!s.end_date&&Object(e.jsxs)(h.a,{align:"middle",className:"significant-results",children:[Object(e.jsx)(f.a,{span:20,style:{fontWeight:500,color:"#497342"},children:Object(e.jsxs)("div",{children:["Experiment results are significant."," ",s.end_date?"":"You can end your experiment now or let it run until complete."]})}),Object(e.jsx)(f.a,{span:4,children:s.end_date?Object(e.jsx)(qe.a,{className:"close-button",onClick:function(){return ot(!1)}}):Object(e.jsx)(G.a,{type:"primary",onClick:function(){return Dt()},children:"End experiment"})})]}),st&&E&&!A&&!s.end_date&&Object(e.jsxs)(h.a,{align:"top",className:"not-significant-results",children:[Object(e.jsxs)(f.a,{span:23,style:{fontWeight:500,color:"#2D2D2D"},children:[Object(e.jsx)("strong",{children:"Your results are not statistically significant"}),"."," ",jn," ",s!=null&&s.end_date?"":"We don't recommend ending this experiment yet."," ","See our"," ",Object(e.jsxs)("a",{href:"https://posthog.com/docs/user-guides/experimentation#funnel-experiment-calculations",children:[" ","experimentation guide"," "]}),"for more information."," "]}),Object(e.jsx)(f.a,{span:1,children:Object(e.jsx)(qe.a,{className:"close-button",onClick:function(){return ot(!1)}})})]}),st&&s.end_date&&Object(e.jsxs)(h.a,{align:"top",className:"feature-flag-mods",children:[Object(e.jsxs)(f.a,{span:23,style:{fontWeight:500},children:[Object(e.jsx)("strong",{children:"Your experiment is complete, but the feature flag is still enabled."})," ","We recommend removing the feature flag from your code completely, instead of relying on this distribution."," ",Object(e.jsx)(wt.a,{to:s.feature_flag?ee.a.featureFlag(s.feature_flag):void 0,children:Object(e.jsx)("b",{children:"Adjust feature flag distribution"})})]}),Object(e.jsx)(f.a,{span:1,children:Object(e.jsx)(qe.a,{className:"close-button",onClick:function(){return ot(!1)}})})]})]}),Object(e.jsxs)(h.a,{children:[Object(e.jsx)(jt.a,{className:"w-full",defaultActiveKey:"experiment-details",children:Object(e.jsx)(jt.a.Panel,{header:Object(e.jsx)("b",{children:"Experiment details"}),children:Object(e.jsxs)(h.a,{children:[Object(e.jsx)(f.a,{span:s!=null&&s.start_date?12:24,children:Object(e.jsx)(ye,{experiment:s,trendCount:pt,trendExposure:s==null?void 0:s.parameters.recommended_running_time,funnelSampleSize:s==null?void 0:s.parameters.recommended_sample_size,funnelConversionRate:dt,funnelEntrants:s!=null&&s.start_date?Ge:Vt})}),!K&&!E&&s.start_date&&Object(e.jsx)(f.a,{span:12,children:Object(e.jsx)(Ee,{experiment:s})}),E&&Object(e.jsxs)(f.a,{span:12,className:"mt-4",children:[Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)("b",{children:"Experiment progress"})}),Object(e.jsx)(vt.a,{strokeWidth:20,showInfo:!1,percent:Gn,strokeColor:"var(--success)"}),D===m.F.TRENDS&&s.start_date&&Object(e.jsxs)(h.a,{justify:"space-between",className:"mt-2",children:[s.end_date?Object(e.jsxs)("div",{children:["Ran for"," ",Object(e.jsx)("b",{children:Object(M.a)(s.end_date).diff(s.start_date,"day")})," ","days"]}):Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:Object(M.a)().diff(s.start_date,"day")})," days running"]}),Object(e.jsxs)("div",{children:["Goal:"," ",Object(e.jsx)("b",{children:s==null||(p=s.parameters)===null||p===void 0?void 0:p.recommended_running_time})," ","days"]})]}),D===m.F.FUNNELS&&Object(e.jsxs)(h.a,{justify:"space-between",className:"mt-2",children:[s.end_date?Object(e.jsxs)("div",{children:["Saw ",Object(e.jsx)("b",{children:Object(P.P)(Ge)})," ","participants"]}):Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:Object(P.P)(Ge)})," ","participants seen"]}),Object(e.jsxs)("div",{children:["Goal:"," ",Object(e.jsx)("b",{children:Object(P.P)((s==null||(i=s.parameters)===null||i===void 0?void 0:i.recommended_sample_size)||0)})," ","participants"]})]})]}),((d=s.secondary_metrics)===null||d===void 0?void 0:d.length)>0&&Object(e.jsx)(f.a,{className:"secondary-progress",span:s!=null&&s.start_date&&((s==null||(u=s.parameters)===null||u===void 0||(g=u.feature_flag_variants)===null||g===void 0?void 0:g.length)||0)<=5?12:24,children:!!(s!=null&&s.secondary_metrics.length)&&Object(e.jsxs)(f.a,{className:"border-b",children:[Object(e.jsxs)(h.a,{align:"middle",justify:"space-between",className:"mb-2",children:[Object(e.jsx)(f.a,{className:"card-secondary",span:2*Q,children:"Secondary metrics"}),s==null||(w=s.parameters)===null||w===void 0||(x=w.feature_flag_variants)===null||x===void 0?void 0:x.map(function(v,j){return Object(e.jsx)(f.a,{span:Q,style:{color:Object(nt.d)(me(v.key,D))},children:Object(e.jsx)("span",{className:"text-sm",children:Object(P.i)(v.key)})},j)})]}),s.start_date?yn?Object(e.jsx)(Fe.a,{active:!0,paragraph:!1}):Object(e.jsx)(e.Fragment,{children:s.secondary_metrics.map(function(v,j){var L,H;return Object(e.jsxs)(h.a,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[Object(e.jsx)(f.a,{span:2*Q,children:Object(P.i)(v.name)}),s==null||(L=s.parameters)===null||L===void 0||(H=L.feature_flag_variants)===null||H===void 0?void 0:H.map(function(Ue,ut){return Object(e.jsx)(f.a,{span:Q,children:te!=null&&te[j][Ue.key]?v.filters.insight===m.F.FUNNELS?Object(e.jsxs)(e.Fragment,{children:[((te==null?void 0:te[j][Ue.key])*100).toFixed(1),"%"]}):Object(e.jsx)(e.Fragment,{children:Object(P.P)(te==null?void 0:te[j][Ue.key])}):Object(e.jsx)(e.Fragment,{children:"--"})},ut)})]},j)})}):Object(e.jsx)(e.Fragment,{children:s.secondary_metrics.map(function(v,j){var L,H;return Object(e.jsxs)(h.a,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[Object(e.jsx)(f.a,{span:2*Q,children:Object(P.i)(v.name)}),s==null||(L=s.parameters)===null||L===void 0||(H=L.feature_flag_variants)===null||H===void 0?void 0:H.map(function(Ue,ut){return Object(e.jsx)(f.a,{span:Q,children:"--"},ut)})]},j)})})]})})]})},"experiment-details")}),!(s!=null&&s.start_date)&&Object(e.jsx)("div",{className:"mt-4 w-full",children:Object(e.jsx)(Ee,{experiment:s})})]}),Object(e.jsxs)("div",{className:"experiment-result",children:[E?((s==null||(F=s.parameters)===null||F===void 0||(C=F.feature_flag_variants)===null||C===void 0?void 0:C.length)||0)>4?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)(h.a,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[Object(e.jsx)(f.a,{span:2*Q,children:"Variant"}),it.map(function(v,j){return Object(e.jsx)(f.a,{span:Q,style:{color:Object(nt.d)(me(v,D))},children:Object(e.jsx)("b",{children:Object(P.i)(v)})},j)})]}),Object(e.jsxs)(h.a,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[Object(e.jsx)(f.a,{span:2*Q,children:D===m.F.TRENDS?"Count":"Conversion Rate"}),it.map(function(v,j){return Object(e.jsx)(f.a,{span:Q,children:D===m.F.TRENDS?R(v):"".concat(ue(v),"%")},j)})]}),Object(e.jsxs)(h.a,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[Object(e.jsx)(f.a,{span:2*Q,children:"Probability to be the best"}),it.map(function(v,j){return Object(e.jsx)(f.a,{span:Q,children:Object(e.jsx)("b",{children:E.probability[v]?"".concat((E.probability[v]*100).toFixed(1),"%"):"--"})},j)})]})]}):Object(e.jsx)(h.a,{justify:"space-around",style:{flexFlow:"nowrap"},children:Object.keys(E.probability).sort(function(v,j){return E.probability[j]-E.probability[v]}).map(function(v,j){return Object(e.jsxs)(f.a,{className:"pr-4",children:[Object(e.jsx)("div",{children:Object(e.jsx)("b",{children:Object(P.i)(v)})}),D===m.F.TRENDS?Object(e.jsxs)(h.a,{children:[Object(e.jsx)("b",{style:{paddingRight:4},children:Object(e.jsxs)(h.a,{children:["action"in E.insight[0]&&Object(e.jsx)(on.a,{filter:E.insight[0].action}),Object(e.jsx)("span",{style:{paddingLeft:4},children:"count:"})]})})," ",R(v)," ",vn&&j===0&&Object(e.jsx)(Te.a,{placement:"right",title:"It might seem confusing that the best variant has lower absolute count, but this can happen when fewer people are exposed to this variant, so its relative count is higher.",children:Object(e.jsx)(ge.a,{style:{padding:"4px 2px"}})})]}):Object(e.jsxs)(h.a,{children:[Object(e.jsx)("b",{style:{paddingRight:4},children:"Conversion rate:"})," ",ue(v),"%"]}),Object(e.jsx)(vt.a,{percent:Number((E.probability[v]*100).toFixed(1)),size:"small",showInfo:!1,strokeColor:Object(nt.d)(me(v,D))}),Object(e.jsxs)("div",{children:["Probability that this variant is the best:"," ",Object(e.jsxs)("b",{children:[(E.probability[v]*100).toFixed(1),"%"]})]})]},j)})}):K&&Object(e.jsx)("div",{className:"text-center",children:Object(e.jsx)(Fe.a,{active:!0})}),E?Object(e.jsx)(V.BindLogic,{logic:je.c,props:{dashboardItemId:E.itemID,cachedInsight:{short_id:E.itemID,filters:Se(Se(Se({},E.filters),{},{insight:D},D===m.F.FUNNELS&&{layout:ve.k.vertical,funnel_viz_type:m.B.Steps}),D===m.F.TRENDS&&{display:m.k.ActionsLineGraphCumulative}),result:E.insight,disable_baseline:!0},doNotLoad:!0},children:Object(e.jsx)("div",{className:"mt-4",children:Object(e.jsx)(Ze.a,{disableHeader:!0,disableCorrelationTable:D===m.F.FUNNELS,disableLastComputation:!0})})}):s.start_date&&Object(e.jsx)(e.Fragment,{children:Object(e.jsx)("div",{className:"no-experiment-results",children:!K&&Object(e.jsxs)("div",{className:"text-center",children:[Object(e.jsx)("b",{children:"There are no results for this experiment yet."}),Object(e.jsxs)("div",{className:"text-sm ",children:[!!Tt&&"".concat(Tt,". ")," ","Wait a bit longer for your users to be exposed to the experiment. Double check your feature flag implementation if you're still not seeing results."]})]})})})]})]}):Object(e.jsx)(Fe.a,{active:!0})})}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/experiments/Experiment.scss":function(We,ae,l){var mt=l("./node_modules/css-loader/dist/runtime/api.js");ae=mt(!1),ae.push([We.i,'.experiment-form .metrics-selection,.experiment-form .person-selection{border-top:1px solid var(--border);padding-top:1rem;width:100%}.experiment-form .person-selection{align-items:center;justify-content:space-between}.experiment-form .insights-graph-container{margin-bottom:1rem;background-color:#fff}.experiment-form .insights-graph-container .ant-card-head{border-bottom:1px solid var(--border);min-height:unset;background-color:var(--bg-light);padding-left:1rem;padding-right:1rem}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title{padding:.5rem 0}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter{font-size:14px}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter:not(:last-child),.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter span.head-title-item{margin-right:.5rem}.experiment-form .insights-graph-container .display-config-inner{display:flex;align-items:center;justify-content:space-between;overflow-x:auto}.experiment-form .insights-graph-container .ant-card-body{padding:0}.experiment-form .insights-graph-container .insights-graph-container-row .insights-graph-container-row-left{width:100%}.experiment-form .insights-graph-container .insights-graph-container-row .insights-graph-container-row-right{width:100%;height:min(calc(90vh - 16rem),36rem);max-width:300px;padding:0 1rem 1rem 0;display:flex;align-items:center}.experiment-form .insights-graph-container .LineGraph{width:calc(100% - 2rem);height:calc(100% - 3rem)}.experiment-form .insights-graph-header{margin-top:0!important;margin-bottom:0!important;padding-left:1rem;padding-right:1rem;min-height:48px}.experiment-form .experiment-preview{margin-bottom:1rem;border-bottom:1px solid var(--border)}.experiment-form .experiment-preview .mde-slider .ant-slider-handle{border:none}.experiment-form .experiment-preview .mde-slider .ant-slider-rail{background-color:#e5ebff}.experiment-form .variants{margin-top:.5rem;padding-bottom:1rem}.experiment-form .variants .ant-form-horizontal{min-height:32px}.experiment-form .variants .border-top{border-top-left-radius:4px;border-top-right-radius:4px}.experiment-form .variants .border-bottom{border-bottom-left-radius:4px;border-bottom-right-radius:4px}.experiment-form .variants .feature-flag-variant{display:flex;align-items:center;height:3.5rem;padding:0 .5rem;background:#fff;border-bottom-width:1px;border-bottom-color:var(--border);border-top:1px solid var(--border);border-left:1px solid var(--border);border-right:1px solid var(--border)}.experiment-form .variants .feature-flag-variant .ant-form-item-explain-error{margin-top:.5rem;color:var(--danger)}.experiment-form .variants .feature-flag-variant .ant-form-item-label{padding:0}.experiment-form .variants .variant-label{display:flex;flex-direction:row;justify-content:center;align-items:center;border-radius:4px;color:#fff;min-width:52px;padding:2px 6px;margin-right:8px;font-size:12px;font-weight:500;letter-spacing:.01em}.experiment-form .secondary-metrics{margin-top:1rem;padding-top:1rem;border-top:1px solid var(--border);margin-bottom:1rem;width:100%}.experiment-form .ant-input-number-disabled,.experiment-form .ant-input[disabled]{color:#000}.view-experiment .draft-header{margin-bottom:1rem;border-bottom:1px solid var(--border)}.view-experiment .exp-description{font-style:italic;color:var(--muted)}.view-experiment .participants{background-color:#fff}.view-experiment .participants .ant-collapse-header{padding-top:.5rem;padding-bottom:.5rem;padding-left:.75rem}.view-experiment .variants-list li{display:inline}.view-experiment .variants-list li:after{content:", "}.view-experiment .variants-list li:last-child:after{content:""}.view-experiment .experiment-result{padding-top:1rem}.view-experiment .significant-results{padding:.5rem;width:100%;background:rgba(119,185,108,.1);border-radius:4px;text-align:center;margin-bottom:1rem}.view-experiment .not-significant-results{padding:.5rem;width:100%;background:rgba(83,117,255,.1);border-radius:4px;margin-bottom:1rem}.view-experiment .feature-flag-mods{padding:.5rem;width:100%;background:#f6ebf8;border-radius:4px;margin-bottom:1rem}.view-experiment .ant-collapse-content-box{display:flex;flex-flow:column}.view-experiment .secondary-progress{margin-top:.5rem}.view-experiment .secondary-progress li:before{content:"\u2022";display:inline-block;font-weight:900;margin-right:4px}.view-experiment .secondary-progress .ant-progress-inner,.view-experiment .secondary-progress .ant-progress-inner .ant-progress-bg{border-radius:4px}.view-experiment .no-experiment-results{display:flex;justify-content:center;align-items:center;margin-top:1rem;background-color:var(--side);border:1px solid var(--border);width:100%;min-height:320px;font-size:24px}.preview-conversion-goal-num{height:24px;width:24px;text-align:center;background-color:var(--side);color:var(--primary-alt);font-weight:700;margin-right:.5rem}.experiment-preview-row{border-bottom:1px solid var(--border);padding-bottom:1rem;margin-bottom:1rem}.experiment-preview-row:last-child{border-bottom:none;padding-bottom:0;margin-bottom:0}.metric-name{border:1px solid var(--border);border-radius:4px;padding:8px 8px 8px 16px;margin-left:.5rem;flex:1}.experiment-implementation-details,.experiment-workflow{border-color:var(--dark-grey)}.experiment-implementation-details .ant-card-head,.experiment-workflow .ant-card-head{padding-left:1rem;padding-right:1rem;border:none}.experiment-implementation-details .ant-card-head-title,.experiment-workflow .ant-card-head-title{border-bottom:1px solid var(--border)}.experiment-implementation-details .exp-workflow-step,.experiment-workflow .exp-workflow-step{margin-bottom:.5rem;padding:.5rem;border-radius:4px}.experiment-implementation-details .exp-workflow-step:hover,.experiment-workflow .exp-workflow-step:hover{cursor:pointer}.experiment-implementation-details .step-completed,.experiment-workflow .step-completed{background-color:#e5ebff}',""]),We.exports=ae}}]);
