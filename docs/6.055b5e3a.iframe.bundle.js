(window.webpackJsonp=window.webpackJsonp||[]).push([[6,8,12],{"./frontend/src/scenes/apps/HistoricalExport.tsx":function(K,i,e){"use strict";e.r(i),e.d(i,"HistoricalExport",function(){return d});var u=e("./node_modules/antd/es/card/index.js"),L=e("./node_modules/kea/lib/index.esm.js"),x=e("./frontend/src/scenes/apps/AppMetricsGraph.tsx"),j=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),T=e("./frontend/src/scenes/apps/historicalExportLogic.ts"),C=e("./frontend/src/scenes/apps/MetricsTab.tsx"),r=e("./node_modules/react/jsx-runtime.js"),h=e.n(r);function d(R){var m,b,_,O,M,I=Object(L.useValues)(Object(T.historicalExportLogic)(R)),s=I.data,P=I.dataLoading;return Object(r.jsxs)("div",{className:"mt-4 mb-4 mr-8",children:[Object(r.jsx)(u.a,{title:"Overview",children:Object(r.jsx)(C.MetricsOverview,{tab:j.AppMetricsTab.HistoricalExports,metrics:(m=s==null?void 0:s.metrics)!==null&&m!==void 0?m:null,metricsLoading:P,exportDuration:s==null||(b=s.summary)===null||b===void 0?void 0:b.duration,exportFailureReason:s==null||(_=s.summary)===null||_===void 0?void 0:_.failure_reason})}),Object(r.jsx)(u.a,{title:"Delivery trends",className:"mt-4",children:Object(r.jsx)(x.AppMetricsGraph,{tab:j.AppMetricsTab.HistoricalExports,metrics:(O=s==null?void 0:s.metrics)!==null&&O!==void 0?O:null,metricsLoading:P})}),Object(r.jsx)(u.a,{title:"Errors",className:"mt-4",children:Object(r.jsx)(C.ErrorsOverview,{errors:(s==null?void 0:s.errors)||[],loading:P,category:"exportEvents",jobId:s==null||(M=s.summary)===null||M===void 0?void 0:M.job_id})})]})}try{d.displayName="HistoricalExport",d.__docgenInfo={description:"",displayName:"HistoricalExport",props:{pluginConfigId:{defaultValue:null,description:"",name:"pluginConfigId",required:!0,type:{name:"number"}},jobId:{defaultValue:null,description:"",name:"jobId",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/apps/HistoricalExport.tsx#HistoricalExport"]={docgenInfo:d.__docgenInfo,name:"HistoricalExport",path:"frontend/src/scenes/apps/HistoricalExport.tsx#HistoricalExport"})}catch(R){}},"./frontend/src/scenes/apps/HistoricalExportsTab.tsx":function(K,i,e){"use strict";e.r(i),e.d(i,"HistoricalExportsTab",function(){return Z});var u=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),L=e.n(u),x=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),j=e.n(x),T=e("./node_modules/core-js/modules/es.array.concat.js"),C=e.n(T),r=e("./node_modules/core-js/modules/es.object.keys.js"),h=e.n(r),d=e("./node_modules/core-js/modules/es.symbol.js"),R=e.n(d),m=e("./node_modules/core-js/modules/es.array.filter.js"),b=e.n(m),_=e("./node_modules/core-js/modules/es.object.to-string.js"),O=e.n(_),M=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),I=e.n(M),s=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),P=e.n(s),E=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),p=e.n(E),D=e("./node_modules/kea/lib/index.esm.js"),A=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),U=e("./frontend/src/lib/components/LemonTable/index.ts"),W=e("./frontend/src/scenes/apps/HistoricalExport.tsx"),c=e("./frontend/src/lib/components/LemonTable/columnUtils.tsx"),S=e("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),F=e("./node_modules/antd/es/progress/index.js"),Y=e("./frontend/src/lib/components/LemonButton/index.ts"),Q=e("./frontend/src/scenes/plugins/edit/interface-jobs/PluginJobConfiguration.tsx"),H=e("./node_modules/react/index.js"),q=e.n(H),t=e("./node_modules/react/jsx-runtime.js"),ee=e.n(t);function N(o,l){var a=Object.keys(o);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(o);l&&(n=n.filter(function(f){return Object.getOwnPropertyDescriptor(o,f).enumerable})),a.push.apply(a,n)}return a}function X(o){for(var l=1;l<arguments.length;l++){var a=arguments[l]!=null?arguments[l]:{};l%2?N(Object(a),!0).forEach(function(n){L()(o,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach(function(n){Object.defineProperty(o,n,Object.getOwnPropertyDescriptor(a,n))})}return o}var z=2e4;function Z(){var o=Object(D.useValues)(A.appMetricsSceneLogic),l=o.historicalExports,a=o.historicalExportsLoading,n=o.pluginConfig,f=o.interfaceJobsProps,$=o.hasRunningExports,G=Object(D.useActions)(A.appMetricsSceneLogic),w=G.openHistoricalExportModal,k=G.loadHistoricalExports;return Object(H.useEffect)(function(){var v;function g(){$&&(v=setTimeout(function(){k(),g()},z))}return g(),function(){return v&&clearTimeout(v)}},[$]),Object(t.jsxs)("div",{className:"space-y-2",children:[Object(t.jsx)("div",{className:"flex items-center justify-end",children:Object(t.jsx)(Y.a,{type:"primary",onClick:w,disabled:!f,children:"Start new export"})}),Object(t.jsx)(U.a,{dataSource:l,loading:a,columns:[{title:"Dates exported",render:function(g,y){var J=j()(y.payload.dateRange,2),B=J[0],V=J[1];return B===V?B:"".concat(B," - ").concat(V)}},{title:"Progress",width:130,render:function(g,y){switch(y.status){case"success":return Object(t.jsx)(S.a,{type:"success",className:"uppercase",children:"Success"});case"fail":return Object(t.jsx)(S.a,{type:"danger",className:"uppercase",children:"Failed"});case"not_finished":return Object(t.jsx)(F.a,{percent:Math.floor((y.progress||0)*100)})}},align:"right"},Object(c.b)(),Object(c.a)()],expandable:{expandedRowRender:function(g){if(!!n)return Object(t.jsx)(W.HistoricalExport,{pluginConfigId:n.id,jobId:g.job_id})}},useURLForSorting:!1,noSortingCancellation:!0,emptyState:Object(t.jsxs)("div",{className:"",children:[Object(t.jsx)("b",{children:"Nothing has been exported yet!"}),f&&Object(t.jsx)("p",{className:"m-0",children:'Use "Start new export" button above to export historical data in a given time range.'})]})}),f&&Object(t.jsx)(Q.d,X({},f))]})}},"./frontend/src/scenes/apps/historicalExportLogic.ts":function(K,i,e){"use strict";e.r(i),e.d(i,"historicalExportLogic",function(){return P});var u=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),L=e.n(u),x=e("./node_modules/@babel/runtime/regenerator/index.js"),j=e.n(x),T=e("./node_modules/core-js/modules/es.array.concat.js"),C=e.n(T),r=e("./node_modules/core-js/modules/es.array.iterator.js"),h=e.n(r),d=e("./node_modules/core-js/modules/es.object.to-string.js"),R=e.n(d),m=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),b=e.n(m),_=e("./node_modules/kea/lib/index.esm.js"),O=e("./node_modules/kea-loaders/lib/index.js"),M=e.n(O),I=e("./frontend/src/lib/api.ts"),s=e("./frontend/src/scenes/teamLogic.tsx"),P=Object(_.kea)([Object(_.path)(["scenes","apps","historicalExportLogic"]),Object(_.props)({}),Object(_.key)(function(E){var p=E.pluginConfigId,D=E.jobId;return"".concat(p,"_").concat(D)}),Object(O.loaders)(function(E){var p=E.props;return{data:[null,{loadExportData:function(){var D=L()(j.a.mark(function U(){return j.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,I.b.get("api/projects/".concat(s.a.values.currentTeamId,"/app_metrics/").concat(p.pluginConfigId,"/historical_exports/").concat(p.jobId));case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},U)}));function A(){return D.apply(this,arguments)}return A}()}]}}),Object(_.events)(function(E){var p=E.actions;return{afterMount:p.loadExportData}})])}}]);
