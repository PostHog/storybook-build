(window.webpackJsonp=window.webpackJsonp||[]).push([[240],{"./frontend/src/scenes/feature-flags/FeatureFlag.tsx":function(P,E,n){"use strict";n.r(E),n.d(E,"scene",function(){return bt}),n.d(E,"FeatureFlag",function(){return w});var M=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),ae=n.n(M),Dt=n("./node_modules/core-js/modules/es.array.map.js"),Jt=n("./node_modules/core-js/modules/es.object.to-string.js"),Yt=n("./node_modules/core-js/modules/es.regexp.to-string.js"),Ut=n("./node_modules/core-js/modules/es.array.concat.js"),R=n("./node_modules/react/index.js"),e=n.n(R),ne=n("./node_modules/kea-forms/lib/index.js"),V=n("./node_modules/antd/es/row/index.js"),S=n("./node_modules/antd/es/col/index.js"),Be=n("./node_modules/antd/es/popconfirm/index.js"),we=n("./node_modules/antd/es/radio/index.js"),ve=n("./node_modules/antd/es/button/index.js"),$e=n("./node_modules/antd/es/slider/index.js"),ye=n("./node_modules/antd/es/input-number/index.js"),G=n("./node_modules/antd/es/select/index.js"),re=n("./node_modules/antd/es/card/index.js"),y=n("./node_modules/kea/lib/index.esm.js"),H=n("./frontend/src/lib/utils.tsx"),De=n("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),Je=n("./node_modules/@ant-design/icons/es/icons/LockOutlined.js"),he=n("./node_modules/@ant-design/icons/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),Ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482.2 508.4L331.3 389c-3-2.4-7.3-.2-7.3 3.6V478H184V184h204v128c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V144c0-15.5-12.5-28-28-28H144c-15.5 0-28 12.5-28 28v736c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v128H184V546h140v85.4c0 3.8 4.4 6 7.3 3.6l150.9-119.4a4.5 4.5 0 000-7.2zM880 116H596c-15.5 0-28 12.5-28 28v168c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V184h204v294H700v-85.4c0-3.8-4.3-6-7.3-3.6l-151 119.4a4.52 4.52 0 000 7.1l151 119.5c2.9 2.3 7.3.2 7.3-3.6V546h140v294H636V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v168c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V144c0-15.5-12.5-28-28-28z"}}]},name:"merge-cells",theme:"outlined"},Ue=Ye,ke=n("./node_modules/@ant-design/icons/es/components/AntdIcon.js"),Fe=function(t,o){return R.createElement(ke.a,Object(he.a)(Object(he.a)({},t),{},{ref:o,icon:Ue}))};Fe.displayName="MergeCellsOutlined";var ze=R.forwardRef(Fe),We=n("./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js"),kt=n("./node_modules/core-js/modules/es.object.keys.js"),zt=n("./node_modules/core-js/modules/es.symbol.js"),Wt=n("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Xt=n("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Xe=n("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),Qe=n.n(Xe),Ze=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),J=n.n(Ze),_e=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),O=n.n(_e),qe=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),Ee=n.n(qe),et=n("./node_modules/@babel/runtime/regenerator/index.js"),C=n.n(et),Qt=n("./node_modules/core-js/modules/es.regexp.exec.js"),Zt=n("./node_modules/core-js/modules/es.string.match.js"),_t=n("./node_modules/core-js/modules/es.array.splice.js"),qt=n("./node_modules/core-js/modules/web.dom-collections.for-each.js"),ea=n("./node_modules/core-js/modules/es.array.iterator.js"),ta=n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),aa=n("./node_modules/core-js/modules/es.string.replace.js"),na=n("./node_modules/core-js/modules/es.function.name.js"),ra=n("./node_modules/core-js/modules/es.array.filter.js"),oa=n("./node_modules/core-js/modules/es.array.find.js"),oe=n("./frontend/src/lib/api.ts"),le=n("./node_modules/kea-router/lib/index.js"),B=n("./frontend/src/scenes/urls.ts"),Se=n("./frontend/src/scenes/teamLogic.tsx"),Y=n("./frontend/src/scenes/feature-flags/featureFlagsLogic.ts"),be=n("./frontend/src/models/groupsModel.ts"),je=n("./frontend/src/lib/components/TaxonomicFilter/types.ts"),tt=n("./frontend/src/lib/components/lemonToast.tsx"),at=n("./frontend/src/lib/utils/eventUsageLogic.ts"),nt=n("./node_modules/kea-loaders/lib/index.js"),rt=["created_at","id"];function Oe(a,t){var o=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);t&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(a,u).enumerable})),o.push.apply(o,r)}return o}function l(a){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?Oe(Object(o),!0).forEach(function(r){Ee()(a,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):Oe(Object(o)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(o,r))})}return a}var se={id:null,created_at:null,key:"",name:"",filters:{groups:[{properties:[],rollout_percentage:null}],multivariate:null},deleted:!1,active:!0,created_by:null,is_simple_flag:!1,rollout_percentage:null,ensure_experience_continuity:!1,experiment_set:null},ot={key:"",name:"",rollout_percentage:0},lt={variants:[{key:"",name:"",rollout_percentage:100}]},U=Object(y.kea)([Object(y.path)(["scenes","feature-flags","featureFlagLogic"]),Object(y.props)({}),Object(y.key)(function(a){var t=a.id;return t!=null?t:"new"}),Object(y.connect)({values:[Se.a,["currentTeamId"],be.a,["groupTypes","groupsTaxonomicTypes","aggregationLabel"]]}),Object(y.actions)({setFeatureFlag:function(t){return{featureFlag:t}},addConditionSet:!0,setAggregationGroupTypeIndex:function(t){return{value:t}},removeConditionSet:function(t){return{index:t}},duplicateConditionSet:function(t){return{index:t}},updateConditionSet:function(t,o,r){return{index:t,newRolloutPercentage:o,newProperties:r}},deleteFeatureFlag:function(t){return{featureFlag:t}},setMultivariateEnabled:function(t){return{enabled:t}},setMultivariateOptions:function(t){return{multivariateOptions:t}},addVariant:!0,removeVariant:function(t){return{index:t}},distributeVariantsEqually:!0}),Object(ne.forms)(function(a){var t=a.actions;return{featureFlag:{defaults:l({},se),errors:function(r){var u,s,d,i=r.key,v=r.filters;return{key:i?(u=i.match)!==null&&u!==void 0&&u.call(i,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key",filters:{multivariate:{variants:v==null||(s=v.multivariate)===null||s===void 0||(d=s.variants)===null||d===void 0?void 0:d.map(function(g){var b,c=g.key;return{key:c?(b=c.match)!==null&&b!==void 0&&b.call(c,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key"}})}}}},submit:function(r){t.saveFeatureFlag(r)}}}}),Object(y.reducers)({featureFlag:[l({},se),{setFeatureFlag:function(t,o){var r=o.featureFlag;if(r.filters.groups){var u=r.filters.groups.map(function(s){return s.properties?l(l({},s),{},{properties:Object(H.s)(s.properties)}):s});return l(l({},r),{},{filters:l(l({},r==null?void 0:r.filters),{},{groups:u})})}return r},addConditionSet:function(t){if(!t)return t;var o=[].concat(O()(t==null?void 0:t.filters.groups),[{properties:[],rollout_percentage:null}]);return l(l({},t),{},{filters:l(l({},t.filters),{},{groups:o})})},updateConditionSet:function(t,o){var r=o.index,u=o.newRolloutPercentage,s=o.newProperties;if(!t)return t;var d=O()(t==null?void 0:t.filters.groups);return u!==void 0&&(d[r]=l(l({},d[r]),{},{rollout_percentage:u})),s!==void 0&&(d[r]=l(l({},d[r]),{},{properties:s})),l(l({},t),{},{filters:l(l({},t.filters),{},{groups:d})})},removeConditionSet:function(t,o){var r=o.index;if(!t)return t;var u=O()(t.filters.groups);return u.splice(r,1),l(l({},t),{},{filters:l(l({},t.filters),{},{groups:u})})},duplicateConditionSet:function(t,o){var r=o.index;if(!t)return t;var u=t.filters.groups.concat([t.filters.groups[r]]);return l(l({},t),{},{filters:l(l({},t.filters),{},{groups:u})})},setMultivariateOptions:function(t,o){var r=o.multivariateOptions;return t&&l(l({},t),{},{filters:l(l({},t.filters),{},{multivariate:r})})},addVariant:function(t){var o;if(!t)return t;var r=O()(((o=t.filters.multivariate)===null||o===void 0?void 0:o.variants)||[]);return l(l({},t),{},{filters:l(l({},t.filters),{},{multivariate:l(l({},t.filters.multivariate||{}),{},{variants:[].concat(O()(r),[ot])})})})},removeVariant:function(t,o){var r,u=o.index;if(!t)return t;var s=O()(((r=t.filters.multivariate)===null||r===void 0?void 0:r.variants)||[]);return s.splice(u,1),l(l({},t),{},{filters:l(l({},t.filters),{},{multivariate:l(l({},t.filters.multivariate),{},{variants:s})})})},distributeVariantsEqually:function(t){var o;if(!t)return t;var r=O()(((o=t.filters.multivariate)===null||o===void 0?void 0:o.variants)||[]),u=r.length;if(u>0&&u<=100){var s=Math.round(100/u),d=s*u,i=d-100;r.forEach(function(v,g){r[g]=l(l({},v),{},{rollout_percentage:s})}),r[u-1]=l(l({},r[u-1]),{},{rollout_percentage:s-i})}return l(l({},t),{},{filters:l(l({},t.filters),{},{multivariate:l(l({},t.filters.multivariate),{},{variants:r})})})},setAggregationGroupTypeIndex:function(t,o){var r=o.value;return!t||t.filters.aggregation_group_type_index==r?t:l(l({},t),{},{filters:l(l({},t.filters),{},{aggregation_group_type_index:r,groups:[{properties:[],rollout_percentage:null}]})})}}]}),Object(nt.loaders)(function(a){var t=a.values,o=a.props;return{featureFlag:{loadFeatureFlag:function(){var r=J()(C.a.mark(function s(){return C.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(o.id&&o.id!=="new")){i.next=4;break}return i.next=3,oe.b.get("api/projects/".concat(t.currentTeamId,"/feature_flags/").concat(o.id));case 3:return i.abrupt("return",i.sent);case 4:return i.abrupt("return",se);case 5:case"end":return i.stop()}},s)}));function u(){return r.apply(this,arguments)}return u}(),saveFeatureFlag:function(){var r=J()(C.a.mark(function s(d){var i,v,g;return C.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(i=d.created_at,v=d.id,g=Qe()(d,rt),c.prev=1,d.id){c.next=8;break}return c.next=5,oe.b.create("api/projects/".concat(t.currentTeamId,"/feature_flags"),g);case 5:return c.abrupt("return",c.sent);case 8:return c.next=10,oe.b.update("api/projects/".concat(t.currentTeamId,"/feature_flags/").concat(d.id),g);case 10:return c.abrupt("return",c.sent);case 11:c.next=17;break;case 13:throw c.prev=13,c.t0=c.catch(1),(c.t0.code==="behavioral_cohort_found"||c.t0.code==="cohort_does_not_exist")&&at.f.actions.reportFailedToCreateFeatureFlagWithCohort(c.t0.code,c.t0.detail),c.t0;case 17:case"end":return c.stop()}},s,null,[[1,13]])}));function u(s){return r.apply(this,arguments)}return u}()}}}),Object(y.listeners)(function(a){var t=a.actions,o=a.values;return{saveFeatureFlagSuccess:function(u){var s,d=u.featureFlag;tt.d.success("Feature flag saved"),(s=Y.a.findMounted())===null||s===void 0||s.actions.updateFlag(d),le.router.actions.replace(B.a.featureFlag(d.id))},deleteFeatureFlag:function(){var r=J()(C.a.mark(function s(d){var i;return C.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:i=d.featureFlag,Object(H.x)({endpoint:"projects/".concat(o.currentTeamId,"/feature_flags"),object:{name:i.name,id:i.id},callback:function(){var c,$;i.id&&((c=Y.a.findMounted())===null||c===void 0||c.actions.deleteFlag(i.id)),($=Y.a.findMounted())===null||$===void 0||$.actions.loadFeatureFlags(),le.router.actions.push(B.a.featureFlags())}});case 2:case"end":return g.stop()}},s)}));function u(s){return r.apply(this,arguments)}return u}(),setMultivariateEnabled:function(){var r=J()(C.a.mark(function s(d){var i;return C.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:i=d.enabled,i?t.setMultivariateOptions(lt):t.setMultivariateOptions(null);case 2:case"end":return g.stop()}},s)}));function u(s){return r.apply(this,arguments)}return u}()}}),Object(y.selectors)({props:[function(){return[function(a,t){return t}]},function(a){return a}],multivariateEnabled:[function(a){return[a.featureFlag]},function(a){return!!(a!=null&&a.filters.multivariate)}],variants:[function(a){return[a.featureFlag]},function(a){var t;return(a==null||(t=a.filters.multivariate)===null||t===void 0?void 0:t.variants)||[]}],nonEmptyVariants:[function(a){return[a.variants]},function(a){return a.filter(function(t){var o=t.key;return!!o})}],variantRolloutSum:[function(a){return[a.variants]},function(a){return a.reduce(function(t,o){var r=o.rollout_percentage;return t+r},0)}],areVariantRolloutsValid:[function(a){return[a.variants,a.variantRolloutSum]},function(a,t){return a.every(function(o){var r=o.rollout_percentage;return r>=0&&r<=100})&&t===100}],aggregationTargetName:[function(a){return[a.featureFlag,a.groupTypes,a.aggregationLabel]},function(a,t,o){return a&&a.filters.aggregation_group_type_index!=null&&t.length>0?o(a.filters.aggregation_group_type_index).plural:"users"}],taxonomicGroupTypes:[function(a){return[a.featureFlag,a.groupsTaxonomicTypes]},function(a,t){return a&&a.filters.aggregation_group_type_index!=null&&t.length>0?[t[a.filters.aggregation_group_type_index]]:[je.a.PersonProperties,je.a.Cohorts]}],breadcrumbs:[function(a){return[a.featureFlag]},function(a){return[{name:"Feature Flags",path:B.a.featureFlags()}].concat(O()(a?[{name:a.key||"Unnamed"}]:[]))}]}),Object(le.urlToAction)(function(a){var t,o=a.actions,r=a.props;return Ee()({},B.a.featureFlag((t=r.id)!==null&&t!==void 0?t:"new"),function(u,s,d,i){var v=i.method;v==="PUSH"&&(r.id?o.loadFeatureFlag():o.resetFeatureFlag())})}),Object(y.afterMount)(function(a){var t,o=a.props,r=a.actions,u=(t=Y.a.findMounted())===null||t===void 0?void 0:t.values.featureFlags.find(function(s){return s.id===o.id});u?r.setFeatureFlag(u):o.id!=="new"&&r.loadFeatureFlag()})]),F=n("./frontend/src/lib/components/icons.tsx"),k=n("./frontend/src/lib/components/LemonDivider/index.ts"),h=n("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),st="?utm_medium=in-product&utm_campaign=feature-flag";function z(a){var t=a.flagKey;return e.a.createElement(e.a.Fragment,null,e.a.createElement(h.a,{language:h.b.JavaScript,wrap:!0},"const isMyFlagEnabledForUser = await client.isFeatureEnabled('".concat(t,`', 'user distinct id')

if (isMyFlagEnabledForUser) {
    // Do something differently for this user
}`)))}function W(a){var t=a.flagKey;return e.a.createElement(e.a.Fragment,null,e.a.createElement(h.a,{language:h.b.JavaScript,wrap:!0},"if\xA0(posthog.isFeatureEnabled('".concat(t!=null?t:"",`')) {
    // run your activation code here
}`)))}function X(a){var t=a.flagKey;return e.a.createElement(e.a.Fragment,null,e.a.createElement(h.a,{language:h.b.PHP,wrap:!0},"if (PostHog::isFeatureEnabled('".concat(t,`', 'some distinct id')) {
    // do something here
}`)))}function Q(a){var t=a.flagKey;return e.a.createElement(e.a.Fragment,null,e.a.createElement(h.a,{language:h.b.Go,wrap:!0},"isFlagEnabledForUser, err := client.IsFeatureEnabled('".concat(t,`', 'user distinct id', false)

if (isFlagEnabledForUser) {
  // Do something differently for this user
}`)))}function Z(a){var t=a.flagKey;return e.a.createElement(e.a.Fragment,null,e.a.createElement(h.a,{language:h.b.Ruby,wrap:!0},"is_my_flag_enabled = posthog.is_feature_enabled('".concat(t,`', 'user distinct id')

if is_my_flag_enabled
  # Do something differently for this user
end`)))}function _(a){var t=a.flagKey;return e.a.createElement(e.a.Fragment,null,e.a.createElement(h.a,{language:h.b.Python,wrap:!0},'if\xA0posthog.feature_enabled("'.concat(t,`", "user_distinct_id"):
    runAwesomeFeature()
`)))}function it(){var a=Object(y.useValues)(Se.a),t=a.currentTeam;return e.a.createElement(e.a.Fragment,null,e.a.createElement(h.a,{language:h.b.Bash,wrap:!0},"curl ".concat(window.location.origin,`/decide/ \\
-X POST -H 'Content-Type: application/json' \\
-d '{
    "api_key": "`).concat(t?t.api_token:"[project_api_key]",`",
    "distinct_id": "[user distinct id]"
}'
                `)))}try{z.displayName="NodeJSSnippet",z.__docgenInfo={description:"",displayName:"NodeJSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#NodeJSSnippet"]={docgenInfo:z.__docgenInfo,name:"NodeJSSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#NodeJSSnippet"})}catch(a){}try{W.displayName="JSSnippet",W.__docgenInfo={description:"",displayName:"JSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"]={docgenInfo:W.__docgenInfo,name:"JSSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"})}catch(a){}try{X.displayName="PHPSnippet",X.__docgenInfo={description:"",displayName:"PHPSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PHPSnippet"]={docgenInfo:X.__docgenInfo,name:"PHPSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PHPSnippet"})}catch(a){}try{Q.displayName="GolangSnippet",Q.__docgenInfo={description:"",displayName:"GolangSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#GolangSnippet"]={docgenInfo:Q.__docgenInfo,name:"GolangSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#GolangSnippet"})}catch(a){}try{Z.displayName="RubySnippet",Z.__docgenInfo={description:"",displayName:"RubySnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#RubySnippet"]={docgenInfo:Z.__docgenInfo,name:"RubySnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#RubySnippet"})}catch(a){}try{_.displayName="PythonSnippet",_.__docgenInfo={description:"",displayName:"PythonSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"]={docgenInfo:_.__docgenInfo,name:"PythonSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"})}catch(a){}var ut=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),Ce=n.n(ut),ct=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlagInstructions.scss"),Ie=n.n(ct),ie={};ie.insert="head",ie.singleton=!1;var la=Ce()(Ie.a,ie),sa=Ie.a.locals||{},T="?utm_medium=in-product&utm_campaign=feature-flag",A="https://posthog.com/docs/",K="#feature-flags",ue=[{value:"JavaScript",documentationLink:"".concat(A,"integrations/js-integration").concat(T).concat(K),Icon:F.IconJavascript,Snippet:W},{value:"Node.js",documentationLink:"".concat(A,"integrations/node-integration").concat(T).concat(K),Icon:F.IconNodeJS,Snippet:z},{value:"PHP",documentationLink:"".concat(A,"integrations/php-integration").concat(T).concat(K),Icon:F.IconPHP,Snippet:X},{value:"Ruby",documentationLink:"".concat(A,"integrations/ruby-integration").concat(T).concat(K),Icon:F.IconRuby,Snippet:Z},{value:"Golang",documentationLink:"".concat(A,"integrations/go-integration").concat(T).concat(K),Icon:F.IconGolang,Snippet:Q},{value:"Python",documentationLink:"".concat(A,"integrations/python-integration").concat(T).concat(K),Icon:F.IconPython,Snippet:_},{value:"API",documentationLink:"".concat(A,"api/feature-flags").concat(T),Icon:F.IconOpenInNew,Snippet:it}];function dt(a){var t=a.selectedOptionValue,o=a.selectOption;return e.a.createElement(V.a,{className:"FeatureFlagInstructionsHeader",justify:"space-between",align:"middle"},e.a.createElement("div",{className:"FeatureFlagInstructionsHeader__header-title"},e.a.createElement(F.IconFlag,{className:"FeatureFlagInstructionsHeader__header-title__icon"}),e.a.createElement("b",null,"Learn how to use feature flags in your code")),e.a.createElement(G.a,{"data-attr":"feature-flag-instructions-select",value:t,style:{width:140},onChange:o},ue.map(function(r,u){var s=r.value,d=r.Icon;return e.a.createElement(G.a.Option,{"data-attr":"feature-flag-instructions-select-option-"+s,key:u,value:s},e.a.createElement("div",{className:"FeatureFlagInstructionsHeader__option"},e.a.createElement("div",{className:"FeatureFlagInstructionsHeader__option__icon"},e.a.createElement(d,null)),e.a.createElement("div",null,s)))})))}function ft(a){var t=a.documenrationLink;return e.a.createElement("div",{className:"mt-4"},"Need more information?"," ",e.a.createElement("a",{"data-attr":"feature-flag-doc-link",target:"_blank",rel:"noopener",href:t},"Check the docs ",e.a.createElement(F.IconOpenInNew,null)))}function q(a){var t=a.featureFlagKey,o=ue[0],r=Object(R.useState)(o),u=ae()(r,2),s=u[0],d=u[1],i=function(g){var b=ue.find(function(c){return c.value===g});b&&d(b)};return e.a.createElement(re.a,{size:"small"},e.a.createElement(dt,{selectedOptionValue:s.value,selectOption:i}),e.a.createElement(k.a,null),e.a.createElement("div",{className:"mt mb"},e.a.createElement(s.Snippet,{"data-attr":"feature-flag-instructions-snippet",flagKey:t})),e.a.createElement(k.a,null),e.a.createElement(ft,{documenrationLink:s.documentationLink}))}try{q.displayName="FeatureFlagInstructions",q.__docgenInfo={description:"",displayName:"FeatureFlagInstructions",props:{featureFlagKey:{defaultValue:null,description:"",name:"featureFlagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagInstructions.tsx#FeatureFlagInstructions"]={docgenInfo:q.__docgenInfo,name:"FeatureFlagInstructions",path:"frontend/src/scenes/feature-flags/FeatureFlagInstructions.tsx#FeatureFlagInstructions"})}catch(a){}var mt=n("./frontend/src/lib/components/PageHeader.tsx"),gt=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss"),xe=n.n(gt),ce={};ce.insert="head",ce.singleton=!1;var ia=Ce()(xe.a,ce),ua=xe.a.locals||{},ee=n("./frontend/src/lib/components/Tooltip.tsx"),pt=n("./frontend/src/lib/introductions/GroupsIntroductionOption.tsx"),Te=n("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),vt=n("./frontend/src/scenes/userLogic.ts"),de=n("./frontend/src/types.ts"),Ae=n("./frontend/src/lib/components/Link.tsx"),L=n("./frontend/src/lib/components/LemonButton/index.ts"),yt=n("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),I=n("./frontend/src/lib/forms/Field.tsx"),ht=n("./frontend/src/lib/components/LemonTextArea/LemonTextArea.tsx"),fe=n("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),Ft=n("./frontend/src/lib/components/LemonCheckbox/index.ts"),Et=n("./frontend/src/scenes/events/EventBufferNotice.tsx"),St=n("./frontend/src/lib/components/AlertMessage/index.ts"),bt={component:w,logic:U,paramsToProps:function(t){var o=t.params.id;return{id:o&&o!=="new"?parseInt(o):"new"}}};function Le(a){setTimeout(function(){var t;return(t=document.querySelector('.variant-form-list input[data-key-index="'.concat(a,'"]')))===null||t===void 0?void 0:t.focus()},50)}function w(){var a,t,o,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=r.id,s=Object(y.useValues)(U),d=s.props,i=s.featureFlag,v=s.multivariateEnabled,g=s.variants,b=s.nonEmptyVariants,c=s.areVariantRolloutsValid,$=s.variantRolloutSum,jt=s.groupTypes,D=s.aggregationTargetName,Ot=s.taxonomicGroupTypes,Ne=s.featureFlagLoading,j=Object(y.useActions)(U),Ct=j.addConditionSet,Pe=j.updateConditionSet,It=j.removeConditionSet,xt=j.duplicateConditionSet,Tt=j.deleteFeatureFlag,Re=j.setMultivariateEnabled,At=j.addVariant,Lt=j.removeVariant,Nt=j.distributeVariantsEqually,Pt=j.setAggregationGroupTypeIndex,Ve=Object(y.useValues)(be.a),Rt=Ve.showGroupsOptions,Vt=Ve.aggregationLabel,Ke=Object(y.useValues)(vt.a),me=Ke.hasAvailableFeature,Kt=Ke.upgradeLink,Mt=Object(R.useState)(!1),Me=ae()(Mt,2),Gt=Me[0],Ht=Me[1],Bt=Object(R.useState)(!1),Ge=ae()(Bt,2),wt=Ge[0],ge=Ge[1],$t=Object(pt.a)({value:-2});return e.a.createElement("div",{className:"feature-flag"},i?e.a.createElement(ne.Form,{logic:U,props:d,formKey:"featureFlag",enableFormOnSubmit:!0,className:"space-y-4"},e.a.createElement(mt.a,{title:"Feature Flag",buttons:e.a.createElement("div",{className:"flex items-center gap-2"},e.a.createElement(I.a,{name:"active"},function(m){var f=m.value,p=m.onChange;return e.a.createElement(yt.a,{"data-tooltip":"feature-flag-enabled-toggle",checked:f,onChange:p,label:f?e.a.createElement("span",{className:"text-success"},"Enabled"):e.a.createElement("span",{className:"text-danger"},"Disabled")})}),(i==null?void 0:i.id)&&e.a.createElement(L.a,{"data-attr":"delete-flag",status:"danger",type:"secondary",onClick:function(){Tt(i)}},"Delete"),e.a.createElement(L.a,{type:"primary","data-attr":"feature-flag-submit",loading:Ne,htmlType:"submit"},"Save changes"))}),i.experiment_set&&((a=i.experiment_set)===null||a===void 0?void 0:a.length)>0&&e.a.createElement(St.a,{type:"warning"},"This feature flag is linked to an experiment. It's recommended to only make changes to this flag"," ",e.a.createElement(Ae.a,{to:B.a.experiment(i.experiment_set[0])},"using the experiment creation screen.")),e.a.createElement(Et.a,{additionalInfo:", meaning it can take around 60 seconds for some flags to update for recently-identified persons"}),e.a.createElement("h3",{className:"l3 mt-4"},"General configuration"),e.a.createElement("div",{className:"text-muted mb-4"},"General settings for your feature flag and integration instructions."),e.a.createElement(V.a,{gutter:16,style:{marginBottom:32}},e.a.createElement(S.a,{span:12,className:"space-y-4"},e.a.createElement(I.a,{name:"key",label:"Key (must be unique)",help:Gt&&u!=="new"?e.a.createElement("span",{className:"text-warning"},e.a.createElement("b",null,"Warning! "),"Changing this key will",e.a.createElement("a",{href:"https://posthog.com/docs/features/feature-flags".concat(st,"#feature-flag-persistence"),target:"_blank",rel:"noopener"}," ","affect the persistence of your flag ",e.a.createElement(F.IconOpenInNew,null))):void 0},function(m){var f=m.value,p=m.onChange;return e.a.createElement(fe.a,{value:f,onChange:function(x){x!==f&&Ht(!0),p(x)},"data-attr":"feature-flag-key",className:"ph-ignore-input",autoFocus:!0,placeholder:"examples: new-landing-page, betaFeature, ab_test_1",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})}),e.a.createElement(I.a,{name:"name",label:"Description"},e.a.createElement(ht.a,{className:"ph-ignore-input","data-attr":"feature-flag-description",placeholder:"Adding a helpful description can ensure others know what this feature is for."})),e.a.createElement(I.a,{name:"ensure_experience_continuity"},function(m){var f=m.value,p=m.onChange;return e.a.createElement("div",{className:"border rounded p-4"},e.a.createElement(Ft.a,{id:"continuity-checkbox",label:e.a.createElement("div",null,"Persist flag across authentication steps"," ",e.a.createElement(Te.a,{type:"warning"},"Beta")),onChange:function(){return p(!f)},fullWidth:!0,checked:f}),e.a.createElement("div",{className:"text-muted text-sm pl-7"},"If your feature flag is applied prior to an identify or authentication event, use this to ensure that feature flags are not reset after a person is identified. This ensures the experience for the anonymous person is carried forward to the authenticated person. Currently supported for posthog-js only."))})),e.a.createElement(S.a,{span:12},e.a.createElement(q,{featureFlagKey:i.key||"my-flag"}))),e.a.createElement("div",{className:"mb-8"},e.a.createElement("h3",{className:"l3"},"Served value"),e.a.createElement("div",{className:"mb-2"},e.a.createElement(Be.a,{placement:"top",title:"Change value type? The variants below will be lost.",visible:wt,onConfirm:function(){Re(!1),ge(!1)},onCancel:function(){return ge(!1)},okText:"OK",cancelText:"Cancel"},e.a.createElement(we.a.Group,{options:[{label:"Boolean value (A/B test)",value:!1},{label:e.a.createElement(ee.a,{title:me(de.d.MULTIVARIATE_FLAGS)?"":"This feature is not available on your current plan."},e.a.createElement("div",null,!me(de.d.MULTIVARIATE_FLAGS)&&e.a.createElement(Ae.a,{to:Kt,target:"_blank"},e.a.createElement(Je.a,{style:{marginRight:4,color:"var(--warning)"}})),"String value (Multivariate test)"," ",e.a.createElement(Te.a,{type:"warning"},"Beta"))),value:!0,disabled:!me(de.d.MULTIVARIATE_FLAGS)}],onChange:function(f){var p=f.target.value;p===!1&&b.length?ge(!0):(Re(p),Le(0))},value:v,optionType:"button"}))),e.a.createElement("div",{className:"text-muted mb-4"},Object(H.j)(D)," will be served"," ",v?e.a.createElement(e.a.Fragment,null,e.a.createElement("strong",null,"a variant key")," according to the below distribution"):e.a.createElement("strong",null,e.a.createElement("code",null,"true"))," ","if they match one or more release condition groups."),v&&e.a.createElement("div",{className:"variant-form-list space-y-2"},e.a.createElement(V.a,{gutter:8,className:"label-row"},e.a.createElement(S.a,{span:7},"Variant key"),e.a.createElement(S.a,{span:7},"Description"),e.a.createElement(S.a,{span:9},e.a.createElement("span",null,"Rollout percentage"),e.a.createElement(ve.a,{type:"link",onClick:Nt,icon:e.a.createElement(ze,null),style:{padding:"0 0 0 0.5em"},title:"Distribute variants equally"},"Distribute"))),g.map(function(m,f){return e.a.createElement(ne.Group,{key:f,name:["filters","multivariate","variants",f]},e.a.createElement(V.a,{gutter:8},e.a.createElement(S.a,{span:7},e.a.createElement(I.a,{name:"key"},e.a.createElement(fe.a,{"data-attr":"feature-flag-variant-key","data-key-index":f.toString(),className:"ph-ignore-input",placeholder:"example-variant-".concat(f+1),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}))),e.a.createElement(S.a,{span:7},e.a.createElement(I.a,{name:"name"},e.a.createElement(fe.a,{"data-attr":"feature-flag-variant-name",className:"ph-ignore-input",placeholder:"Description"}))),e.a.createElement(S.a,{span:7},e.a.createElement(I.a,{name:"rollout_percentage"},e.a.createElement($e.a,{tooltipPlacement:"top"}))),e.a.createElement(S.a,{span:2},e.a.createElement(I.a,{name:"rollout_percentage"},function(p){var N=p.value,x=p.onChange;return e.a.createElement(ye.a,{min:0,max:100,value:N,onChange:function(pe){if(pe!=null){var He=parseInt(pe.toString());isNaN(He)||x(He)}},style:{width:"100%",borderColor:c?void 0:"var(--danger)"}})})),g.length>1&&e.a.createElement(S.a,{span:1},e.a.createElement(ee.a,{title:"Delete this variant",placement:"bottomLeft"},e.a.createElement(ve.a,{type:"link",icon:e.a.createElement(We.a,null),onClick:function(){return Lt(f)},style:{color:"var(--danger)"}})))))}),g.length>0&&!c&&e.a.createElement("p",{className:"text-danger"},"Percentage rollouts for variants must sum to 100 (currently ",$,")."),e.a.createElement(L.a,{type:"secondary",onClick:function(){var f=g.length;At(),Le(f)},fullWidth:!0,center:!0},"Add variant"))),e.a.createElement("div",{className:"feature-flag-form-row"},e.a.createElement("div",{"data-tooltip":"feature-flag-release-conditions"},e.a.createElement("h3",{className:"l3"},"Release conditions"),e.a.createElement("div",{className:"text-muted mb-4"},"Specify the ",D," to which you want to release this flag. Note that condition sets are rolled out independently of each other.")),Rt&&e.a.createElement("div",{className:"centered"},"Match by",e.a.createElement(G.a,{value:((t=i.filters)===null||t===void 0?void 0:t.aggregation_group_type_index)!=null?(o=i.filters)===null||o===void 0?void 0:o.aggregation_group_type_index:-1,onChange:function(f){var p=f!==-1?f:null;Pt(p)},style:{marginLeft:8},"data-attr":"feature-flag-aggregation-filter",dropdownMatchSelectWidth:!1,dropdownAlign:{points:["tr","br"]}},e.a.createElement(G.a.Option,{key:-1,value:-1},"Users"),jt.map(function(m){return e.a.createElement(G.a.Option,{key:m.group_type_index,value:m.group_type_index},Object(H.j)(Vt(m.group_type_index).plural))}),$t))),e.a.createElement(V.a,{gutter:16},i.filters.groups.map(function(m,f){var p,N;return e.a.createElement(S.a,{span:24,md:24,key:"".concat(f,"-").concat(i.filters.groups.length)},f>0&&e.a.createElement("div",{style:{display:"flex",marginLeft:16}},e.a.createElement("div",{className:"stateful-badge or-light-grey mb-4"},"OR")),e.a.createElement(re.a,{style:{marginBottom:16}},e.a.createElement("div",{className:"feature-flag-form-row",style:{height:24}},e.a.createElement("div",null,e.a.createElement("span",{className:"simple-tag tag-light-blue",style:{marginRight:8}},"Set ",f+1),(p=m.properties)!==null&&p!==void 0&&p.length?e.a.createElement(e.a.Fragment,null,"Matching ",e.a.createElement("b",null,D)," with filters"):e.a.createElement(e.a.Fragment,null,"Condition set will match ",e.a.createElement("b",null,"all ",D))),e.a.createElement(V.a,{align:"middle"},e.a.createElement(ee.a,{title:"Duplicate this condition set",placement:"bottomLeft"},e.a.createElement(L.a,{icon:e.a.createElement(F.IconCopy,null),size:"small",onClick:function(){return xt(f)}})),i.filters.groups.length>1&&e.a.createElement(ee.a,{title:"Delete this condition set",placement:"bottomLeft"},e.a.createElement(L.a,{icon:e.a.createElement(F.IconDelete,null),size:"small",onClick:function(){return It(f)}})))),e.a.createElement(k.a,{large:!0}),e.a.createElement("div",{className:"ml-4"},e.a.createElement(De.a,{pageKey:"feature-flag-".concat(i.id,"-").concat(f,"-").concat(i.filters.groups.length,"-").concat((N=i.filters.aggregation_group_type_index)!==null&&N!==void 0?N:""),propertyFilters:m==null?void 0:m.properties,onChange:function(te){return Pe(f,void 0,te)},taxonomicGroupTypes:Ot,showConditionBadge:!0})),e.a.createElement(k.a,{large:!0}),e.a.createElement("div",{className:"feature-flag-form-row"},e.a.createElement("div",{className:"centered"},"Roll out to"," ",e.a.createElement(ye.a,{style:{width:100,marginLeft:8,marginRight:8},onChange:function(te){Pe(f,te)},value:m.rollout_percentage!=null?m.rollout_percentage:100,min:0,max:100,addonAfter:"%"})," ","of ",e.a.createElement("b",null,D)," in this set"))))})),e.a.createElement(re.a,{size:"small",style:{marginBottom:16}},e.a.createElement(L.a,{onClick:Ct,fullWidth:!0},"Add condition set")),e.a.createElement("div",{className:"text-right"},e.a.createElement(L.a,{htmlType:"submit",loading:Ne,type:"primary","data-attr":"feature-flag-submit-bottom"},"Save changes"))):e.a.createElement(H.b,null))}try{w.displayName="FeatureFlag",w.__docgenInfo={description:"",displayName:"FeatureFlag",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"]={docgenInfo:w.__docgenInfo,name:"FeatureFlag",path:"frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"})}catch(a){}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss":function(P,E,n){var M=n("./node_modules/css-loader/dist/runtime/api.js");E=M(!1),E.push([P.i,".variant-form-list .ant-form-item{min-height:32px}.variant-form-list .label-row{font-weight:700}.variant-form-list .label-row .ant-col{min-height:32px;display:flex;justify-content:space-between;align-items:center}.feature-flag-form-row{display:flex;justify-content:space-between;align-items:center;width:100%}.feature-flag-form-row .centered{display:flex;align-items:center;white-space:pre-wrap}",""]),P.exports=E},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlagInstructions.scss":function(P,E,n){var M=n("./node_modules/css-loader/dist/runtime/api.js");E=M(!1),E.push([P.i,".FeatureFlagInstructionsHeader{flex-wrap:nowrap}.FeatureFlagInstructionsHeader .FeatureFlagInstructionsHeader__header-title{display:flex;justify-items:center}.FeatureFlagInstructionsHeader .FeatureFlagInstructionsHeader__header-title .FeatureFlagInstructionsHeader__header-title__icon{color:var(--text-muted-alt);margin-right:12px;font-size:1.6em}.FeatureFlagInstructionsHeader__option{display:flex;justify-items:center}.FeatureFlagInstructionsHeader__option .FeatureFlagInstructionsHeader__option__icon{margin-top:2px;margin-right:8px}",""]),P.exports=E}}]);
