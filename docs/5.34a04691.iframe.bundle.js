(window.webpackJsonp=window.webpackJsonp||[]).push([[5,9,10,309],{"./frontend/src/scenes/apps/AppMetricsGraph.scss":function(y,u,e){"use strict";e.r(u);var O=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),m=e.n(O),f=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/apps/AppMetricsGraph.scss"),i=e.n(f),D={};D.insert="head",D.singleton=!1;var j=m()(i.a,D);u.default=i.a.locals||{}},"./frontend/src/scenes/apps/AppMetricsGraph.tsx":function(y,u,e){"use strict";e.r(u),e.d(u,"AppMetricsGraph",function(){return A});var O=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),m=e.n(O),f=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),i=e.n(f),D=e("./node_modules/core-js/modules/es.array.concat.js"),j=e.n(D),W=e("./node_modules/core-js/modules/es.object.keys.js"),z=e.n(W),x=e("./node_modules/core-js/modules/es.symbol.js"),Q=e.n(x),S=e("./node_modules/core-js/modules/es.array.filter.js"),X=e.n(S),F=e("./node_modules/core-js/modules/es.object.to-string.js"),w=e.n(F),G=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),k=e.n(G),H=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),q=e.n(H),J=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),ee=e.n(J),R=e("./node_modules/react/index.js"),se=e.n(R),N=e("./frontend/src/lib/colors.ts"),$=e("./node_modules/chart.js/dist/chart.mjs"),M=e("./frontend/src/scenes/apps/constants.tsx"),K=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),re=e("./frontend/src/scenes/apps/AppMetricsGraph.scss"),T=e("./frontend/src/lib/utils.tsx"),P=e("./node_modules/react/jsx-runtime.js"),B=e.n(P);function I(d,n){var _=Object.keys(d);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(d);n&&(p=p.filter(function(b){return Object.getOwnPropertyDescriptor(d,b).enumerable})),_.push.apply(_,p)}return _}function U(d){for(var n=1;n<arguments.length;n++){var _=arguments[n]!=null?arguments[n]:{};n%2?I(Object(_),!0).forEach(function(p){m()(d,p,_[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(_)):I(Object(_)).forEach(function(p){Object.defineProperty(d,p,Object.getOwnPropertyDescriptor(_,p))})}return d}function A(d){var n=d.tab,_=d.metrics,p=d.metricsLoading,b=Object(R.useRef)(null),C=M.DescriptionColumns[n];return Object(R.useEffect)(function(){var r;if(b.current&&_){var o;r=new $.a((o=b.current)===null||o===void 0?void 0:o.getContext("2d"),{type:"line",data:{labels:_.dates,datasets:[U({label:C.successes,data:_.successes,borderColor:""},L("data-brand-blue"))].concat(i()(C.successes_on_retry?[U({label:C.successes_on_retry,data:_.successes_on_retry},L("data-yellow"))]:[]),[U({label:C.failures,data:_.failures},L("data-vermilion"))])},options:{scales:{x:{ticks:{maxRotation:0},grid:{display:!1}},y:{beginAtZero:!0}},plugins:{crosshair:!1,legend:{display:!1}},maintainAspectRatio:!1,interaction:{mode:"index",axis:"x",intersect:!1}}})}return function(){var t;(t=r)===null||t===void 0||t.destroy()}},[_]),p||!_?Object(P.jsx)(K.a,{className:"AppMetricsGraph border rounded p-6"}):Object(P.jsx)("div",{className:"AppMetricsGraph border rounded p-6",children:Object(P.jsx)("canvas",{ref:b})})}function L(d){var n=Object(N.b)(d);return{borderColor:n,hoverBorderColor:Object(T.lb)(n,-20),hoverBackgroundColor:Object(T.lb)(n,-20),backgroundColor:n,fill:!1,borderWidth:2,pointRadius:0}}try{A.displayName="AppMetricsGraph",A.__docgenInfo={description:"",displayName:"AppMetricsGraph",props:{tab:{defaultValue:null,description:"",name:"tab",required:!0,type:{name:"enum",value:[{value:'"processEvent"'},{value:'"onEvent"'},{value:'"exportEvents"'},{value:'"scheduledTask"'},{value:'"historical_exports"'}]}},metrics:{defaultValue:null,description:"",name:"metrics",required:!1,type:{name:"AppMetrics | null"}},metricsLoading:{defaultValue:null,description:"",name:"metricsLoading",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/apps/AppMetricsGraph.tsx#AppMetricsGraph"]={docgenInfo:A.__docgenInfo,name:"AppMetricsGraph",path:"frontend/src/scenes/apps/AppMetricsGraph.tsx#AppMetricsGraph"})}catch(d){}},"./frontend/src/scenes/apps/appMetricsSceneLogic.ts":function(y,u,e){"use strict";e.r(u),e.d(u,"AppMetricsTab",function(){return n}),e.d(u,"appMetricsSceneLogic",function(){return b});var O=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),m=e.n(O),f=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),i=e.n(f),D=e("./node_modules/@babel/runtime/regenerator/index.js"),j=e.n(D),W=e("./node_modules/core-js/modules/es.array.iterator.js"),z=e.n(W),x=e("./node_modules/core-js/modules/es.object.to-string.js"),Q=e.n(x),S=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),X=e.n(S),F=e("./node_modules/core-js/modules/es.array.concat.js"),w=e.n(F),G=e("./node_modules/core-js/modules/es.function.name.js"),k=e.n(G),H=e("./node_modules/core-js/modules/es.array.includes.js"),q=e.n(H),J=e("./node_modules/core-js/modules/es.string.includes.js"),ee=e.n(J),R=e("./node_modules/core-js/modules/es.array.filter.js"),se=e.n(R),N=e("./node_modules/core-js/modules/es.number.constructor.js"),$=e.n(N),M=e("./node_modules/kea/lib/index.esm.js"),K=e("./node_modules/kea-loaders/lib/index.js"),re=e.n(K),T=e("./frontend/src/scenes/urls.ts"),P=e("./frontend/src/lib/api.ts"),B=e("./frontend/src/scenes/teamLogic.tsx"),I=e("./node_modules/kea-router/lib/index.js"),U=e.n(I),A=e("./frontend/src/lib/utils.tsx"),L=e("./frontend/src/scenes/plugins/edit/interface-jobs/PluginJobConfiguration.tsx"),d=e("./frontend/src/scenes/plugins/edit/interface-jobs/interfaceJobsLogic.ts"),n;(function(r){r.ProcessEvent="processEvent",r.OnEvent="onEvent",r.ExportEvents="exportEvents",r.ScheduledTask="scheduledTask",r.HistoricalExports="historical_exports"})(n||(n={}));var _="-30d",p=[n.ProcessEvent,n.OnEvent,n.ExportEvents,n.ScheduledTask],b=Object(M.kea)([Object(M.path)(function(r){return["scenes","apps","appMetricsSceneLogic",r]}),Object(M.props)({}),Object(M.key)(function(r){return r.pluginConfigId}),Object(M.actions)({setActiveTab:function(o){return{tab:o}},setDateFrom:function(o){return{dateFrom:o}},openErrorDetailsModal:function(o,t,s){return{errorType:o,category:t,jobId:s}},closeErrorDetailsModal:!0,openHistoricalExportModal:!0}),Object(M.reducers)({activeTab:[null,{setActiveTab:function(o,t){var s=t.tab;return s}}],dateFrom:[_,{setDateFrom:function(o,t){var s=t.dateFrom;return s}}],errorDetailsModalError:[null,{openErrorDetailsModal:function(o,t){var s=t.errorType;return s},closeErrorDetailsModal:function(){return null}}]}),Object(K.loaders)(function(r){var o=r.values,t=r.props;return{pluginConfig:[null,{loadPluginConfig:function(){var s=i()(j.a.mark(function a(){return j.a.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,P.b.get("api/projects/".concat(B.a.values.currentTeamId,"/plugin_configs/").concat(t.pluginConfigId));case 2:return E.abrupt("return",E.sent);case 3:case"end":return E.stop()}},a)}));function c(){return s.apply(this,arguments)}return c}()}],appMetricsResponse:[null,{loadMetrics:function(){var s=i()(j.a.mark(function a(){var l;return j.a.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return l=Object(A.Eb)({category:o.activeTab,date_from:o.dateFrom}),v.next=3,P.b.get("api/projects/".concat(B.a.values.currentTeamId,"/app_metrics/").concat(t.pluginConfigId,"?").concat(l));case 3:return v.abrupt("return",v.sent);case 4:case"end":return v.stop()}},a)}));function c(){return s.apply(this,arguments)}return c}()}],historicalExports:[[],{loadHistoricalExports:function(){var s=i()(j.a.mark(function a(){var l,E;return j.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,P.b.get("api/projects/".concat(B.a.values.currentTeamId,"/app_metrics/").concat(t.pluginConfigId,"/historical_exports"));case 2:return l=g.sent,E=l.results,g.abrupt("return",E);case 5:case"end":return g.stop()}},a)}));function c(){return s.apply(this,arguments)}return c}()}],errorDetails:[[],{openErrorDetailsModal:function(){var s=i()(j.a.mark(function a(l){var E,v,g,V,Y,Z;return j.a.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return E=l.category,v=l.jobId,g=l.errorType,V=Object(A.Eb)({category:E,job_id:v,error_type:g}),h.next=4,P.b.get("api/projects/".concat(B.a.values.currentTeamId,"/app_metrics/").concat(t.pluginConfigId,"/error_details?").concat(V));case 4:return Y=h.sent,Z=Y.result,h.abrupt("return",Z);case 7:case"end":return h.stop()}},a)}));function c(a){return s.apply(this,arguments)}return c}()}]}}),Object(M.selectors)(function(r){var o=r.values,t=r.actions;return{breadcrumbs:[function(s){return[s.pluginConfig,function(c,a){return a.pluginConfigId}]},function(s,c){var a;return[{name:"Apps",path:T.a.projectApps()},{name:s==null||(a=s.plugin_info)===null||a===void 0?void 0:a.name,path:T.a.appMetrics(c)}]}],showTab:[function(){return[]},function(){return function(s){if(o.pluginConfigLoading||!o.pluginConfig||!o.pluginConfig.plugin_info.capabilities)return!1;var c=o.pluginConfig.plugin_info.capabilities,a=c.methods.includes("exportEvents");return s===n.HistoricalExports?a:s===n.OnEvent&&a?!1:s===n.ScheduledTask?!a&&["runEveryMinute","runEveryHour","runEveryDay"].some(function(l){return c.scheduled_tasks.includes(l)}):c.methods.includes(s)}}],interfaceJobsProps:[function(s){return[s.pluginConfig]},function(s){return!s||!s.plugin_info.public_jobs||!(s!=null&&s.enabled)?null:{jobName:L.b,jobSpec:s.plugin_info.public_jobs[L.b],pluginConfigId:s.id,pluginId:s.plugin,onSubmit:t.loadHistoricalExports}}]}}),Object(M.listeners)(function(r){var o=r.values,t=r.actions;return{loadPluginConfigSuccess:function(){if(!o.activeTab){var c=p.filter(function(E){return o.showTab(E)}),a=m()(c,1),l=a[0];t.setActiveTab(l)}},setActiveTab:function(c){var a=c.tab;a===n.HistoricalExports?t.loadHistoricalExports():t.loadMetrics()},setDateFrom:function(){t.loadMetrics()},openHistoricalExportModal:function(){o.interfaceJobsProps&&Object(d.a)(o.interfaceJobsProps).actions.setIsJobModalOpen(!0)}}}),Object(I.actionToUrl)(function(r){var o=r.values,t=r.props;return{setActiveTab:function(){return C(o,t)},setDateFrom:function(){return C(o,t)}}}),Object(I.urlToAction)(function(r){var o=r.values,t=r.actions,s=r.props;return{"/app/:pluginConfigId/:page":function(a,l){s.pluginConfigId===Number(a.pluginConfigId)&&(o.pluginConfig||t.loadPluginConfig(),a.page===n.HistoricalExports?t.setActiveTab(n.HistoricalExports):(l.tab&&p.includes(l.tab)&&t.setActiveTab(l.tab),l.from&&t.setDateFrom(l.from)))}}})]);function C(r,o){if(r.activeTab===n.HistoricalExports)return T.a.appHistoricalExports(o.pluginConfigId);var t={};return r.activeTab&&(t.tab=r.activeTab),r.dateFrom!==_&&(t.from=r.dateFrom),T.a.appMetrics(o.pluginConfigId,t)}},"./frontend/src/scenes/apps/constants.tsx":function(y,u,e){"use strict";e.r(u),e.d(u,"DescriptionColumns",function(){return D});var O=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),m=e.n(O),f=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),i,D=(i={},m()(i,f.AppMetricsTab.ProcessEvent,{successes:"Events processed",failures:"Failed events"}),m()(i,f.AppMetricsTab.OnEvent,{successes:"Events processed",successes_on_retry:"Events processed on retry",failures:"Failed events"}),m()(i,f.AppMetricsTab.ExportEvents,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),m()(i,f.AppMetricsTab.HistoricalExports,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),m()(i,f.AppMetricsTab.ScheduledTask,{successes:"Successes",failures:"Failures"}),i)},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/apps/AppMetricsGraph.scss":function(y,u,e){var O=e("./node_modules/css-loader/dist/runtime/api.js");u=O(!1),u.push([y.i,".AppMetricsGraph{height:300px}",""]),y.exports=u}}]);
