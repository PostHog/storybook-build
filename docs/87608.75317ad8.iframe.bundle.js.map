{"version":3,"file":"87608.75317ad8.iframe.bundle.js","mappings":";;;;AAwBA","sources":["webpack://posthog/./frontend/src/scenes/error-tracking/errorTrackingSceneLogic.ts"],"sourcesContent":["import { afterMount, kea, path } from 'kea'\nimport { loaders } from 'kea-loaders'\nimport api from 'lib/api'\n\nimport { HogQLQuery, NodeKind } from '~/queries/schema'\nimport { hogql } from '~/queries/utils'\nimport { ErrorTrackingGroup } from '~/types'\n\nimport type { errorTrackingSceneLogicType } from './errorTrackingSceneLogicType'\n\nexport const errorTrackingSceneLogic = kea<errorTrackingSceneLogicType>([\n    path(['scenes', 'error-tracking', 'errorTrackingSceneLogic']),\n\n    loaders(() => ({\n        errorGroups: [\n            [] as ErrorTrackingGroup[],\n            {\n                loadErrorGroups: async () => {\n                    const query: HogQLQuery = {\n                        kind: NodeKind.HogQLQuery,\n                        query: hogql`SELECT first_value(properties), count(), count(distinct properties.$session_id)\n                                FROM events e\n                                WHERE event = '$exception'\n                                -- grouping by message for now, will eventually be predefined $exception_group_id\n                                GROUP BY properties.$exception_message`,\n                    }\n\n                    const res = await api.query(query)\n\n                    return res.results.map((r) => {\n                        const eventProperties = JSON.parse(r[0])\n                        return {\n                            title: eventProperties['$exception_message'] || 'No message',\n                            sampleEventProperties: eventProperties,\n                            occurrences: r[2],\n                            uniqueSessions: r[3],\n                        }\n                    })\n                },\n            },\n        ],\n    })),\n\n    afterMount(({ actions }) => {\n        actions.loadErrorGroups()\n    }),\n])\n"],"names":[],"sourceRoot":""}