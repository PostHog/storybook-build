(window.webpackJsonp=window.webpackJsonp||[]).push([[231],{"./frontend/src/lib/components/ChartFilter/chartFilterLogic.ts":function(me,L,t){"use strict";t.d(L,"a",function(){return Ge});var X=t("./node_modules/core-js/modules/es.array.includes.js"),q=t.n(X),we=t("./node_modules/core-js/modules/es.array.iterator.js"),Ce=t.n(we),Se=t("./node_modules/core-js/modules/es.object.to-string.js"),He=t.n(Se),Xe=t("./node_modules/core-js/modules/es.object.values.js"),he=t.n(Xe),e=t("./node_modules/core-js/modules/es.string.includes.js"),l=t.n(e),Ye=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Ee=t.n(Ye),O=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),$e=t.n(O),Q=t("./node_modules/kea/lib/index.esm.js"),R=t("./frontend/src/lib/utils.tsx"),F=t("./frontend/src/types.ts"),y=t("./frontend/src/scenes/insights/sharedUtils.ts"),E=t("./frontend/src/scenes/insights/insightLogic.ts");function re(w,H){var ae=Object.keys(w);if(Object.getOwnPropertySymbols){var ye=Object.getOwnPropertySymbols(w);H&&(ye=ye.filter(function(Fe){return Object.getOwnPropertyDescriptor(w,Fe).enumerable})),ae.push.apply(ae,ye)}return ae}function _e(w){for(var H=1;H<arguments.length;H++){var ae=arguments[H]!=null?arguments[H]:{};H%2?re(Object(ae),!0).forEach(function(ye){$e()(w,ye,ae[ye])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(ae)):re(Object(ae)).forEach(function(ye){Object.defineProperty(w,ye,Object.getOwnPropertyDescriptor(ae,ye))})}return w}function pe(w){return Object.values(F.o).includes(w)}var Ge=Object(Q.kea)({props:{},key:Object(y.c)("new"),path:function(H){return["lib","components","ChartFilter","chartFilterLogic",H]},connect:function(H){return{actions:[Object(E.c)(H),["setFilters"]],values:[Object(E.c)(H),["filters"]]}},actions:function(){return{setChartFilter:function(ae){return{chartFilter:ae}}}},selectors:{chartFilter:[function(w){return[w.filters]},function(w){var H=w.display,ae=w.funnel_viz_type;return(H===F.d.FunnelViz?ae:H)||null}]},listeners:function(H){var ae=H.actions,ye=H.values;return{setChartFilter:function(ft){var Je=ft.chartFilter,tt=ye.filters,s=tt.display,G=tt.funnel_viz_type;pe(Je)?(G!==Je||s!==F.d.FunnelViz)&&ae.setFilters(_e(_e({},ye.filters),{},{display:F.d.FunnelViz,funnel_viz_type:Je})):Object(R.mb)(s,Je)||ae.setFilters(_e(_e({},ye.filters),{},{display:Je}))}}}})},"./frontend/src/lib/components/CompareFilter/compareFilterLogic.ts":function(me,L,t){"use strict";t.d(L,"a",function(){return R});var X=t("./node_modules/core-js/modules/es.array.iterator.js"),q=t.n(X),we=t("./node_modules/core-js/modules/es.object.to-string.js"),Ce=t.n(we),Se=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),He=t.n(Se),Xe=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),he=t.n(Xe),e=t("./node_modules/kea/lib/index.esm.js"),l=t("./frontend/src/lib/utils.tsx"),Ye=t("./frontend/src/types.ts"),Ee=t("./frontend/src/scenes/insights/sharedUtils.ts"),O=t("./frontend/src/scenes/insights/insightLogic.ts");function $e(F,y){var E=Object.keys(F);if(Object.getOwnPropertySymbols){var re=Object.getOwnPropertySymbols(F);y&&(re=re.filter(function(_e){return Object.getOwnPropertyDescriptor(F,_e).enumerable})),E.push.apply(E,re)}return E}function Q(F){for(var y=1;y<arguments.length;y++){var E=arguments[y]!=null?arguments[y]:{};y%2?$e(Object(E),!0).forEach(function(re){he()(F,re,E[re])}):Object.getOwnPropertyDescriptors?Object.defineProperties(F,Object.getOwnPropertyDescriptors(E)):$e(Object(E)).forEach(function(re){Object.defineProperty(F,re,Object.getOwnPropertyDescriptor(E,re))})}return F}var R=Object(e.kea)({props:{},key:Object(Ee.c)("new"),path:function(y){return["lib","components","CompareFilter","compareFilterLogic",y]},connect:function(y){return{actions:[Object(O.c)(y),["setFilters"]],values:[Object(O.c)(y),["filters","canEditInsight"]]}},actions:function(){return{setCompare:function(E){return{compare:E}},toggleCompare:!0}},selectors:{compare:[function(F){return[F.filters]},function(F){return!!(F!=null&&F.compare)}],disabled:[function(F){return[F.filters,F.canEditInsight]},function(F,y){var E=F.insight,re=F.date_from,_e=F.display;return!y||E===Ye.s.LIFECYCLE||_e===Ye.d.WorldMap||re==="all"}]},listeners:function(y){var E=y.values,re=y.actions;return{setCompare:function(pe){var Ge=pe.compare;Object(l.mb)(Ge,E.compare)||re.setFilters(Q(Q({},E.filters),{},{compare:Ge}))},toggleCompare:function(){re.setCompare(!E.compare)}}}})},"./frontend/src/lib/components/CopyToClipboard.tsx":function(me,L,t){"use strict";t.d(L,"a",function(){return Ge});var X=t("./node_modules/core-js/modules/es.symbol.js"),q=t.n(X),we=t("./node_modules/core-js/modules/es.symbol.description.js"),Ce=t.n(we),Se=t("./node_modules/core-js/modules/es.object.to-string.js"),He=t.n(Se),Xe=t("./node_modules/core-js/modules/es.regexp.to-string.js"),he=t.n(Xe),e=t("./node_modules/@babel/runtime/helpers/extends.js"),l=t.n(e),Ye=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),Ee=t.n(Ye),O=t("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),$e=t.n(O),Q=t("./node_modules/react/index.js"),R=t.n(Q),F=t("./frontend/src/lib/utils.tsx"),y=t("./frontend/src/lib/components/Tooltip.tsx"),E=t("./frontend/src/lib/components/icons.tsx"),re=t("./frontend/src/lib/components/LemonButton/index.ts");function _e(w,H){var ae=Object.keys(w);if(Object.getOwnPropertySymbols){var ye=Object.getOwnPropertySymbols(w);H&&(ye=ye.filter(function(Fe){return Object.getOwnPropertyDescriptor(w,Fe).enumerable})),ae.push.apply(ae,ye)}return ae}function pe(w){for(var H=1;H<arguments.length;H++){var ae=arguments[H]!=null?arguments[H]:{};H%2?_e(Object(ae),!0).forEach(function(ye){Ee()(w,ye,ae[ye])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(ae)):_e(Object(ae)).forEach(function(ye){Object.defineProperty(w,ye,Object.getOwnPropertyDescriptor(ae,ye))})}return w}function Ge(w){var H=w.children,ae=w.explicitValue,ye=w.description,Fe=w.selectable,ft=Fe===void 0?!1:Fe,Je=w.isValueSensitive,tt=Je===void 0?!1:Je,s=w.tooltipMessage,G=s===void 0?null:s,n=w.iconStyle,Le=n===void 0?{}:n,le=w.iconPosition,Ke=le===void 0?"end":le,x=w.style,Ze=$e()(w,["children","explicitValue","description","selectable","isValueSensitive","tooltipMessage","iconStyle","iconPosition","style"]),jt=function(){return Object(F.t)(ae!=null?ae:H?H.toString():"",ye)},Ht=R.a.createElement("span",l()({className:tt?"ph-no-capture":"",style:pe({cursor:ft?"text":"pointer",display:"inline-flex",alignItems:"center",flexDirection:Ke==="end"?"row":"row-reverse",flexWrap:"nowrap",width:"fit-content",wordBreak:"break-all"},x),onClick:ft?void 0:jt},Ze),R.a.createElement("span",{style:Ke==="start"?{flexGrow:1}:{}},H),R.a.createElement(re.a,{compact:!0,icon:R.a.createElement(E.IconCopy,null),className:"copy-icon",onClick:ft?jt:void 0,style:pe(Ee()({},Ke==="end"?"marginLeft":"marginRight",4),Le)}));return!ft||G!==null?R.a.createElement(y.a,{title:G||"Click to copy"},Ht):R.a.createElement(R.a.Fragment,null,Ht)}try{Ge.displayName="CopyToClipboardInline",Ge.__docgenInfo={description:"",displayName:"CopyToClipboardInline",props:{explicitValue:{defaultValue:null,description:"",name:"explicitValue",required:!1,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string"}},selectable:{defaultValue:{value:"false"},description:"Makes text selectable instead of copying on click anywhere",name:"selectable",required:!1,type:{name:"boolean"}},isValueSensitive:{defaultValue:{value:"false"},description:"",name:"isValueSensitive",required:!1,type:{name:"boolean"}},tooltipMessage:{defaultValue:{value:"null"},description:"",name:"tooltipMessage",required:!1,type:{name:"string | null"}},iconStyle:{defaultValue:{value:"{}"},description:"",name:"iconStyle",required:!1,type:{name:"Record<string, string | number>"}},iconPosition:{defaultValue:{value:"end"},description:"",name:"iconPosition",required:!1,type:{name:"enum",value:[{value:'"start"'},{value:'"end"'}]}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/CopyToClipboard.tsx#CopyToClipboardInline"]={docgenInfo:Ge.__docgenInfo,name:"CopyToClipboardInline",path:"frontend/src/lib/components/CopyToClipboard.tsx#CopyToClipboardInline"})}catch(w){}},"./frontend/src/lib/components/PropertiesTable.tsx":function(me,L,t){"use strict";t.d(L,"a",function(){return dt});var X=t("./node_modules/core-js/modules/es.array.filter.js"),q=t("./node_modules/core-js/modules/es.array.includes.js"),we=t("./node_modules/core-js/modules/es.array.map.js"),Ce=t("./node_modules/core-js/modules/es.array.some.js"),Se=t("./node_modules/core-js/modules/es.object.entries.js"),He=t("./node_modules/core-js/modules/es.string.includes.js"),Xe=t("./node_modules/core-js/modules/es.string.starts-with.js"),he=t("./node_modules/@babel/runtime/helpers/typeof.js"),e=t.n(he),l=t("./node_modules/@babel/runtime/helpers/slicedToArray.js"),Ye=t.n(l),Ee=t("./node_modules/react/index.js"),O=t.n(Ee),$e=t("./frontend/src/lib/components/PropertyKeyInfo.tsx"),Q=t("./node_modules/antd/es/input/index.js"),R=t("./node_modules/antd/es/dropdown/index.js"),F=t("./node_modules/antd/es/menu/index.js"),y=t("./node_modules/antd/es/popconfirm/index.js"),E=t("./frontend/src/lib/utils.tsx"),re=t("./frontend/src/lib/components/icons.tsx"),_e=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),pe=t.n(_e),Ge=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/lib/components/PropertiesTable.scss"),w=t.n(Ge),H={};H.insert="head",H.singleton=!1;var ae=pe()(w.a,H),ye=w.a.locals||{},Fe=t("./frontend/src/lib/components/LemonTable/index.ts"),ft=t("./frontend/src/lib/components/CopyToClipboard.tsx"),Je=t("./node_modules/kea/lib/index.esm.js"),tt=t("./frontend/src/models/propertyDefinitionsModel.ts"),s=t("./frontend/src/lib/components/LemonButton/index.ts"),G=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=t.n(G),Le=t("./node_modules/antd/es/radio/index.js"),le=t("./node_modules/@ant-design/icons/es/icons/SaveOutlined.js"),Ke=t("./node_modules/@ant-design/icons/es/icons/CheckOutlined.js"),x=t("./node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),Ze=t("./node_modules/@ant-design/icons/es/icons/StopOutlined.js"),jt=t("./node_modules/antd/lib/modal/Modal.js"),Ht=t.n(jt);function Qt(Z,fe){var je=Object.keys(Z);if(Object.getOwnPropertySymbols){var Ae=Object.getOwnPropertySymbols(Z);fe&&(Ae=Ae.filter(function(nt){return Object.getOwnPropertyDescriptor(Z,nt).enumerable})),je.push.apply(je,Ae)}return je}function mt(Z){for(var fe=1;fe<arguments.length;fe++){var je=arguments[fe]!=null?arguments[fe]:{};fe%2?Qt(Object(je),!0).forEach(function(Ae){n()(Z,Ae,je[Ae])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Z,Object.getOwnPropertyDescriptors(je)):Qt(Object(je)).forEach(function(Ae){Object.defineProperty(Z,Ae,Object.getOwnPropertyDescriptor(je,Ae))})}return Z}function wt(Z){var fe=Z.editProperty,je={creating:!1,propertyType:"string"},Ae=Object(Ee.useState)(je),nt=Ye()(Ae,2),Ue=nt[0],st=nt[1],Nt=function(){Ue.key&&Ue.value!==void 0&&(fe(Ue.key,Ue.value),st(je))};return O.a.createElement(O.a.Fragment,null,O.a.createElement("div",{className:"mb"},O.a.createElement("div",{className:"text-right"},O.a.createElement(s.a,{"data-attr":"add-prop-button",onClick:function(){return st(mt(mt({},Ue),{},{creating:!0}))},type:"primary"},"New property"))),O.a.createElement(Ht.a,{visible:Ue.creating,destroyOnClose:!0,onCancel:function(){return st(je)},title:"Adding new property",okText:O.a.createElement(O.a.Fragment,null,O.a.createElement(le.a,{style:{marginRight:4}}),"Save Property"),okButtonProps:{disabled:!Ue.key||Ue.value===void 0},onOk:Nt},O.a.createElement("div",{className:"input-set"},O.a.createElement("label",{htmlFor:"propertyKey"},"Key"),O.a.createElement(Q.a,{id:"propertyKey",autoFocus:!0,placeholder:"try email, first_name, is_verified, membership_level, total_revenue",onChange:function(K){return st(mt(mt({},Ue),{},{key:K.target.value}))}})),O.a.createElement("div",{className:"input-set"},O.a.createElement("label",{htmlFor:"propertyType"},"Type of Property"),O.a.createElement("div",null,O.a.createElement(Le.a.Group,{value:Ue.propertyType,onChange:function(K){return st(mt(mt({},Ue),{},{propertyType:K.target.value,value:K.target.value==="string"?void 0:"true"}))},id:"propertyType",buttonStyle:"solid"},O.a.createElement(Le.a.Button,{value:"string"},"Text or Number"),O.a.createElement(Le.a.Button,{value:"boolean"},"Boolean or Null")))),O.a.createElement("div",{className:"input-set"},O.a.createElement("label",{htmlFor:"propertyValue"},"Value"),Ue.propertyType==="boolean"?O.a.createElement("div",null,O.a.createElement(Le.a.Group,{value:Ue.value,onChange:function(K){return st(mt(mt({},Ue),{},{value:K.target.value}))},id:"propertyValue",buttonStyle:"solid"},O.a.createElement(Le.a.Button,{value:"true",defaultChecked:!0},O.a.createElement(Ke.a,null)," True"),O.a.createElement(Le.a.Button,{value:"false"},O.a.createElement(x.a,null)," False"),O.a.createElement(Le.a.Button,{value:"null"},O.a.createElement(Ze.a,null)," Null"))):O.a.createElement(Q.a,{placeholder:"try email@example.com, gold, 1",onChange:function(K){return st(mt(mt({},Ue),{},{value:K.target.value}))},id:"propertyValue",onKeyDown:function(K){return K.key==="Enter"&&Nt()}}))))}try{wt.displayName="NewPropertyComponent",wt.__docgenInfo={description:"",displayName:"NewPropertyComponent",props:{editProperty:{defaultValue:null,description:"",name:"editProperty",required:!0,type:{name:"(key: string, newValue?: string | number | boolean | null | undefined) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/NewPropertyComponent.tsx#NewPropertyComponent"]={docgenInfo:wt.__docgenInfo,name:"NewPropertyComponent",path:"frontend/src/scenes/persons/NewPropertyComponent.tsx#NewPropertyComponent"})}catch(Z){}function rn(Z){var fe=Z.value,je=Z.onChange;return O.a.createElement(Q.a,{defaultValue:fe,autoFocus:!0,onBlur:function(){return je(null,!1)},onPressEnter:function(nt){return je(nt.target.value,!0)}})}function sn(Z){var fe=Z.value,je=Z.rootKey,Ae=Z.onEdit,nt=Z.nestingLevel,Ue=Z.useDetectedPropertyType,st=Object(Je.useValues)(tt.a),Nt=st.describeProperty,We=Object(Ee.useState)(!1),K=Ye()(We,2),Ut=K[0],At=K[1],oe=je&&!$e.e.includes(je)&&(!nt||nt<=1)&&Ae,bt=["string","number","bigint"],P=["boolean","null"],ut;je&&Ue&&(ut=Nt(je));var Oe=fe===null?"null":e()(fe),lt=fe===null?"null":String(fe),Ft=function(qe,ve){At(!1),je!==void 0&&ve&&Ae&&qe!=fe&&Ae(je,qe,fe)},De=O.a.createElement("span",{className:oe?"editable ph-no-capture":"ph-no-capture",onClick:function(){return oe&&bt.includes(Oe)&&At(!0)}},Object(E.eb)(fe)?O.a.createElement("a",{href:fe,target:"_blank",rel:"noopener noreferrer",className:"value-link"},O.a.createElement("span",null,lt),O.a.createElement(re.IconOpenInNew,null)):lt);return O.a.createElement("div",{className:"properties-table-value"},Ut?O.a.createElement(rn,{value:fe,onChange:Ft}):O.a.createElement(O.a.Fragment,null,oe&&P.includes(Oe)?O.a.createElement(R.a,{overlay:O.a.createElement(F.a,{onClick:function(qe){var ve=qe.key,Pe=null;ve==="t"?Pe=!0:ve==="f"&&(Pe=!1),Ft(Pe,!0)}},O.a.createElement(F.a.Item,{key:"t"},"true"),O.a.createElement(F.a.Item,{key:"f"},"false"),O.a.createElement(F.a.Item,{key:"n",danger:!0},"null"))},De):O.a.createElement(ft.a,{description:"property value",explicitValue:lt,selectable:!0,isValueSensitive:!0},De),O.a.createElement("div",{className:"property-value-type"},ut||Oe)))}function dt(Z){var fe=Z.properties,je=Z.rootKey,Ae=Z.onEdit,nt=Z.sortProperties,Ue=nt===void 0?!1:nt,st=Z.searchable,Nt=st===void 0?!1:st,We=Z.embedded,K=We===void 0?!0:We,Ut=Z.nestingLevel,At=Ut===void 0?0:Ut,oe=Z.onDelete,bt=Z.className,P=Z.useDetectedPropertyType,ut=Object(Ee.useState)(""),Oe=Ye()(ut,2),lt=Oe[0],Ft=Oe[1],De=Object(Ee.useMemo)(function(){if(!(fe instanceof Object))return[];var qe=Object.entries(fe);if(lt){var ve=lt.toLowerCase();qe=qe.filter(function(Pe){var gt=Ye()(Pe,2),Rt=gt[0],Ve=gt[1];return Rt.toLowerCase().includes(ve)||JSON.stringify(Ve).toLowerCase().includes(ve)})}return Ue&&qe.sort(function(Pe,gt){var Rt=Ye()(Pe,1),Ve=Rt[0],Wt=Ye()(gt,1),_t=Wt[0];return Ve[0]==="$"&&_t[0]!=="$"?1:Ve[0]!=="$"&&_t[0]==="$"||Ve.toLowerCase()<_t.toLowerCase()?-1:1}),qe},[fe,Ue,lt]);if(Array.isArray(fe))return O.a.createElement("div",null,fe.length?fe.map(function(qe,ve){return O.a.createElement(dt,{key:ve,properties:qe,nestingLevel:At+1,useDetectedPropertyType:["$set","$set_once"].some(function(Pe){return Pe===je})?!1:P})}):O.a.createElement("div",{className:"property-value-type"},"ARRAY (EMPTY)"));var vt=[{key:"key",title:"Key",width:"20rem",render:function(ve,Pe){return O.a.createElement("div",{className:"properties-table-key"},O.a.createElement($e.a,{value:Pe[0]}))},sorter:function(ve,Pe){return String(ve[0]).localeCompare(String(Pe[0]))}},{key:"value",title:"Value",render:function(ve,Pe){return O.a.createElement(dt,{properties:Pe[1],rootKey:Pe[0],onEdit:Ae,nestingLevel:At+1,useDetectedPropertyType:["$set","$set_once"].some(function(gt){return gt===je})?!1:P})}}];return oe&&At===0&&vt.push({key:"delete",title:"",width:0,render:function(ve,Pe){return!$e.e.includes(Pe[0])&&!String(Pe[0]).startsWith("$initial_")&&O.a.createElement(y.a,{onConfirm:function(){return oe(Pe[0])},okButtonProps:{danger:!0},okText:"Delete",title:O.a.createElement(O.a.Fragment,null,"Are you sure you want to delete property ",O.a.createElement("code",null,Pe[0]),"?"," ",O.a.createElement("b",null,"This cannot be undone.")),placement:"left"},O.a.createElement(s.a,{icon:O.a.createElement(re.IconDeleteForever,null),status:"danger",compact:!0}))}}),fe instanceof Object?O.a.createElement(O.a.Fragment,null,Nt&&O.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",gap:"1rem"}},O.a.createElement(Q.a.Search,{placeholder:"Search for property keys and values",className:"mb",allowClear:!0,enterButton:!0,style:{maxWidth:400,width:"initial",flexGrow:1},value:lt,onChange:function(ve){Ft(ve.target.value)}}),Ae&&O.a.createElement(wt,{editProperty:Ae})),O.a.createElement(Fe.a,{columns:vt,showHeader:!K,size:"small",rowKey:"0",embedded:K,dataSource:De,className:bt,emptyState:"This property value is an empty object."})):O.a.createElement(sn,{value:fe,rootKey:je,onEdit:Ae,nestingLevel:At,useDetectedPropertyType:P})}try{dt.displayName="PropertiesTable",dt.__docgenInfo={description:"",displayName:"PropertiesTable",props:{properties:{defaultValue:null,description:"",name:"properties",required:!0,type:{name:"any"}},sortProperties:{defaultValue:{value:"false"},description:"",name:"sortProperties",required:!1,type:{name:"boolean"}},searchable:{defaultValue:{value:"false"},description:"",name:"searchable",required:!1,type:{name:"boolean"}},embedded:{defaultValue:{value:"true"},description:"Whether this table should be style for being embedded. Default: true.",name:"embedded",required:!1,type:{name:"boolean"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!1,type:{name:"((key: string) => void)"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},useDetectedPropertyType:{defaultValue:null,description:"",name:"useDetectedPropertyType",required:!1,type:{name:"boolean"}},rootKey:{defaultValue:null,description:"",name:"rootKey",required:!1,type:{name:"string"}},onEdit:{defaultValue:null,description:"",name:"onEdit",required:!1,type:{name:"((key: string, newValue: any, oldValue?: any) => void)"}},nestingLevel:{defaultValue:{value:"0"},description:"",name:"nestingLevel",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/PropertiesTable.tsx#PropertiesTable"]={docgenInfo:dt.__docgenInfo,name:"PropertiesTable",path:"frontend/src/lib/components/PropertiesTable.tsx#PropertiesTable"})}catch(Z){}},"./frontend/src/scenes/experiments/Experiment.tsx":function(me,L,t){"use strict";t.r(L),t.d(L,"scene",function(){return ea}),t.d(L,"Experiment_",function(){return On}),t.d(L,"CodeLanguageSelect",function(){return ta});var X=t("./node_modules/core-js/modules/es.symbol.js"),q=t("./node_modules/core-js/modules/es.symbol.description.js"),we=t("./node_modules/core-js/modules/es.array.concat.js"),Ce=t("./node_modules/core-js/modules/es.array.filter.js"),Se=t("./node_modules/core-js/modules/es.array.map.js"),He=t("./node_modules/core-js/modules/es.array.reduce.js"),Xe=t("./node_modules/core-js/modules/es.function.name.js"),he=t("./node_modules/core-js/modules/es.number.constructor.js"),e=t("./node_modules/core-js/modules/es.number.to-fixed.js"),l=t("./node_modules/core-js/modules/es.object.keys.js"),Ye=t("./node_modules/core-js/modules/es.object.to-string.js"),Ee=t("./node_modules/core-js/modules/es.regexp.to-string.js"),O=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),$e=t.n(O),Q=t("./node_modules/@babel/runtime/helpers/slicedToArray.js"),R=t.n(Q),F=t("./node_modules/antd/es/form/index.js"),y=t("./node_modules/antd/es/row/index.js"),E=t("./node_modules/antd/es/col/index.js"),re=t("./node_modules/antd/es/input/index.js"),_e=t("./node_modules/antd/es/tooltip/index.js"),pe=t("./node_modules/antd/es/select/index.js"),Ge=t("./node_modules/antd/es/card/index.js"),w=t("./node_modules/antd/es/tag/index.js"),H=t("./node_modules/antd/es/collapse/index.js"),ae=t("./node_modules/antd/es/skeleton/index.js"),ye=t("./node_modules/antd/es/progress/index.js"),Fe=t("./node_modules/kea/lib/index.esm.js"),ft=t("./frontend/src/lib/components/PageHeader.tsx"),Je=t("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),tt=t("./frontend/src/lib/components/PropertyFilters/utils.ts"),s=t("./frontend/src/lib/components/TaxonomicFilter/types.ts"),G=t("./node_modules/react/index.js"),n=t.n(G),Le=t("./frontend/src/scenes/funnels/funnelLogic.ts"),le=t("./frontend/src/scenes/insights/ActionFilter/ActionFilter.tsx"),Ke=t("./frontend/src/scenes/insights/insightLogic.ts"),x=t("./frontend/src/types.ts"),Ze=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),jt=t.n(Ze),Ht=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/experiments/Experiment.scss"),Qt=t.n(Ht),mt={};mt.insert="head",mt.singleton=!1;var wt=jt()(Qt.a,mt),rn=Qt.a.locals||{},sn=t("./node_modules/core-js/modules/es.array.fill.js"),dt=t("./node_modules/core-js/modules/es.array.find.js"),Z=t("./node_modules/core-js/modules/es.array.find-index.js"),fe=t("./node_modules/core-js/modules/es.array.iterator.js"),je=t("./node_modules/core-js/modules/es.array.splice.js"),Ae=t("./node_modules/core-js/modules/es.number.epsilon.js"),nt=t("./node_modules/core-js/modules/es.object.values.js"),Ue=t("./node_modules/core-js/modules/es.promise.js"),st=t("./node_modules/core-js/modules/es.string.iterator.js"),Nt=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),We=t("./node_modules/@babel/runtime/regenerator/index.js"),K=t.n(We),Ut=t("./node_modules/regenerator-runtime/runtime.js"),At=t("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),oe=t.n(At),bt=t("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),P=t.n(bt),ut=t("./frontend/src/lib/api.ts"),Oe=t("./frontend/src/lib/dayjs.ts"),lt=t("./frontend/src/scenes/insights/utils/cleanFilters.ts"),Ft=t("./frontend/src/scenes/teamLogic.ts"),De=t("./frontend/src/scenes/urls.ts"),vt=t("./node_modules/kea-router/lib/index.js"),qe=t("./frontend/src/scenes/experiments/experimentsLogic.ts"),ve=t("./frontend/src/lib/constants.tsx"),Pe=t("./frontend/src/scenes/trends/trendsLogic.ts"),gt=t("./frontend/src/lib/utils/eventUsageLogic.ts"),Rt=t("./frontend/src/scenes/userLogic.ts"),Ve=t("./frontend/src/lib/components/Tooltip.tsx"),Wt=t("./node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),_t=t("./frontend/src/models/groupsModel.ts"),hn=t("./frontend/src/lib/components/lemonToast.tsx");function wn(a,r){var o=Object.keys(a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);r&&(i=i.filter(function(g){return Object.getOwnPropertyDescriptor(a,g).enumerable})),o.push.apply(o,i)}return o}function k(a){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?wn(Object(o),!0).forEach(function(i){$e()(a,i,o[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):wn(Object(o)).forEach(function(i){Object.defineProperty(a,i,Object.getOwnPropertyDescriptor(o,i))})}return a}var Zt=14,qt=Object(Fe.kea)({props:{},key:function(r){return r.experimentId||"new"},path:function(r){return["scenes","experiment","experimentLogic",r]},connect:{values:[Ft.a,["currentTeamId"],Rt.a,["hasAvailableFeature"],_t.a,["groupTypes","groupsTaxonomicTypes","aggregationLabel"]],actions:[qe.a,["updateExperiments","addToExperiments"]]},actions:{setExperiment:function(r){return{experiment:r}},createExperiment:function(r,o,i){return{draft:r,runningTime:o,sampleSize:i}},setExperimentInsightId:function(r){return{shortId:r}},createNewExperimentInsight:function(r){return{filters:r}},setFilters:function(r){return{filters:r}},setNewExperimentData:function(r){return{experimentData:r}},updateExperimentGroup:function(r,o){return{variant:r,idx:o}},removeExperimentGroup:function(r){return{idx:r}},setExperimentInsightType:function(r){return{insightType:r}},setEditExperiment:function(r){return{editing:r}},setSecondaryMetrics:function(r){return{secondaryMetrics:r}},resetNewExperiment:!0,launchExperiment:!0,endExperiment:!0,addExperimentGroup:!0,archiveExperiment:!0},reducers:{newExperimentData:[null,{setNewExperimentData:function(r,o){var i=o.experimentData;if(i.filters){var g=k(k({},r==null?void 0:r.filters),i.filters);return k(k(k({},r),i),{},{filters:g})}if(i.parameters){var C=k(k({},r==null?void 0:r.parameters),i.parameters);return k(k(k({},r),i),{},{parameters:C})}return k(k({},r),i)},updateExperimentGroup:function(r,o){var i,g=o.variant,C=o.idx,b=P()((r==null||(i=r.parameters)===null||i===void 0?void 0:i.feature_flag_variants)||[]);return b[C]=k(k({},b[C]),g),k(k({},r),{},{parameters:k(k({},r==null?void 0:r.parameters),{},{feature_flag_variants:b})})},addExperimentGroup:function(r){var o;if(!(r==null||(o=r.parameters)===null||o===void 0)&&o.feature_flag_variants){var i=ln(r.parameters.feature_flag_variants.length+1),g=r.parameters.feature_flag_variants.map(function(C,b){return k(k({},C),{},{rollout_percentage:i[b]})});return k(k({},r),{},{parameters:k(k({},r.parameters),{},{feature_flag_variants:[].concat(P()(g),[{key:"test_group_".concat(r.parameters.feature_flag_variants.length),rollout_percentage:i[i.length-1]}])})})}return r},removeExperimentGroup:function(r,o){var i,g,C=o.idx;if(!r)return r;var b=P()(((i=r.parameters)===null||i===void 0?void 0:i.feature_flag_variants)||[]);b.splice(C,1);var d=ln(((r==null||(g=r.parameters)===null||g===void 0?void 0:g.feature_flag_variants)||[]).length-1),T=b.map(function(f,te){return k(k({},f),{},{rollout_percentage:d[te]})});return k(k({},r),{},{parameters:k(k({},r.parameters),{},{feature_flag_variants:T})})},setSecondaryMetrics:function(r,o){var i=o.secondaryMetrics,g=i.map(function(C){return C});return k(k({},r),{},{secondary_metrics:g})},resetNewExperiment:function(){return{parameters:{feature_flag_variants:[{key:"control",rollout_percentage:50},{key:"test",rollout_percentage:50}]}}}}],experimentInsightType:[x.s.TRENDS,{setExperimentInsightType:function(r,o){var i=o.insightType;return i}}],experimentInsightId:[null,{setExperimentInsightId:function(r,o){var i=o.shortId;return i}}],editingExistingExperiment:[!1,{setEditExperiment:function(r,o){var i=o.editing;return i}}]},listeners:function(r){var o=r.values,i=r.props,g=r.actions;return{createExperiment:function(){var C=oe()(K.a.mark(function d(T){var f,te,se,Re,B,V,v,Me,Mt,Bt;return K.a.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(te=T.draft,se=T.runningTime,Re=T.sampleSize,B=null,V=!!i.experimentId&&i.experimentId!=="new",z.prev=3,!V){z.next=14;break}return z.next=7,ut.b.update("api/projects/".concat(o.currentTeamId,"/experiments/").concat(i.experimentId),k(k({},o.newExperimentData),{},{parameters:k(k({},(v=o.newExperimentData)===null||v===void 0?void 0:v.parameters),{},{recommended_running_time:se,recommended_sample_size:Re})},!te&&{start_date:Object(Oe.a)()}));case 7:if(B=z.sent,!(!((Me=B)===null||Me===void 0)&&Me.id)){z.next=12;break}return g.updateExperiments(B),vt.router.actions.push(De.a.experiment(B.id)),z.abrupt("return");case 12:z.next=18;break;case 14:return z.next=16,ut.b.create("api/projects/".concat(o.currentTeamId,"/experiments"),k(k({},o.newExperimentData),{},{parameters:k(k({},(Mt=o.newExperimentData)===null||Mt===void 0?void 0:Mt.parameters),{},{recommended_running_time:se,recommended_sample_size:Re})},!te&&{start_date:Object(Oe.a)()}));case 16:B=z.sent,B&&gt.f.actions.reportExperimentCreated(B);case 18:z.next=24;break;case 20:return z.prev=20,z.t0=z.catch(3),hn.a.error(z.t0.detail||"Failed to create experiment"),z.abrupt("return");case 24:!((f=B)===null||f===void 0)&&f.id&&(Bt=B.id,vt.router.actions.push(De.a.experiment(Bt)),g.addToExperiments(B),hn.a.success("Experiment ".concat(V?"updated":"created"),{button:{label:"View it",action:function(){vt.router.actions.push(De.a.experiment(Bt))}}}));case 25:case"end":return z.stop()}},d,null,[[3,20]])}));function b(d){return C.apply(this,arguments)}return b}(),createNewExperimentInsight:function(){var C=oe()(K.a.mark(function d(T){var f,te,se,Re;return K.a.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return f=T.filters,o.experimentInsightType===x.s.FUNNELS?te=Object(lt.a)(k({insight:x.s.FUNNELS,funnel_viz_type:x.o.Steps,display:x.d.FunnelViz,date_from:Object(Oe.a)().subtract(Zt,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(Oe.a)().endOf("d").format("YYYY-MM-DDTHH:mm"),layout:ve.k.horizontal},f)):te=Object(lt.a)(k({insight:x.s.TRENDS,date_from:Object(Oe.a)().subtract(Zt,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(Oe.a)().endOf("d").format("YYYY-MM-DDTHH:mm")},f)),se={name:"",description:"",tags:[],filters:te,result:null},V.next=5,ut.b.create("api/projects/".concat(o.currentTeamId,"/insights"),se);case 5:Re=V.sent,g.setExperimentInsightId(Re.short_id),g.setNewExperimentData({filters:k({},se.filters)});case 8:case"end":return V.stop()}},d)}));function b(d){return C.apply(this,arguments)}return b}(),setFilters:function(b){var d=b.filters;if(o.experimentInsightType===x.s.FUNNELS){var T;(T=Le.a.findMounted({dashboardItemId:o.experimentInsightId}))===null||T===void 0||T.actions.setFilters(d)}else{var f;(f=Pe.a.findMounted({dashboardItemId:o.experimentInsightId}))===null||f===void 0||f.actions.setFilters(d)}},loadExperimentSuccess:function(){var C=oe()(K.a.mark(function d(T){var f;return K.a.wrap(function(se){for(;;)switch(se.prev=se.next){case 0:f=T.experimentData,f&&gt.f.actions.reportExperimentViewed(f),g.setExperimentInsightType((f==null?void 0:f.filters.insight)||x.s.FUNNELS),f!=null&&f.start_date?(g.resetNewExperiment(),g.loadExperimentResults(),g.loadSecondaryMetricResults()):(g.setNewExperimentData(k({},f)),g.createNewExperimentInsight(f==null?void 0:f.filters));case 4:case"end":return se.stop()}},d)}));function b(d){return C.apply(this,arguments)}return b}(),launchExperiment:function(){var C=oe()(K.a.mark(function d(){var T;return K.a.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:T=Object(Oe.a)(),g.updateExperiment({start_date:T.format("YYYY-MM-DDTHH:mm")}),o.experimentData&&gt.f.actions.reportExperimentLaunched(o.experimentData,T);case 3:case"end":return te.stop()}},d)}));function b(){return C.apply(this,arguments)}return b}(),endExperiment:function(){var C=oe()(K.a.mark(function d(){var T,f,te;return K.a.wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:f=Object(Oe.a)(),g.updateExperiment({end_date:f.format("YYYY-MM-DDTHH:mm")}),te=f.diff((T=o.experimentData)===null||T===void 0?void 0:T.start_date,"second"),o.experimentData&&gt.f.actions.reportExperimentCompleted(o.experimentData,f,te,o.areResultsSignificant);case 4:case"end":return Re.stop()}},d)}));function b(){return C.apply(this,arguments)}return b}(),archiveExperiment:function(){var C=oe()(K.a.mark(function d(){return K.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:g.updateExperiment({archived:!0}),o.experimentData&&gt.f.actions.reportExperimentArchived(o.experimentData);case 2:case"end":return f.stop()}},d)}));function b(){return C.apply(this,arguments)}return b}(),setExperimentInsightType:function(){if(i.experimentId==="new"||o.editingExistingExperiment)g.createNewExperimentInsight();else{var b;g.createNewExperimentInsight((b=o.experimentData)===null||b===void 0?void 0:b.filters)}},updateExperimentSuccess:function(){var C=oe()(K.a.mark(function d(T){var f;return K.a.wrap(function(se){for(;;)switch(se.prev=se.next){case 0:f=T.experimentData,g.updateExperiments(f);case 2:case"end":return se.stop()}},d)}));function b(d){return C.apply(this,arguments)}return b}()}},loaders:function(r){var o=r.values,i=r.props;return{experimentData:[null,{loadExperiment:function(){var g=oe()(K.a.mark(function b(){var d;return K.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(i.experimentId&&i.experimentId!=="new")){f.next=16;break}return f.prev=1,f.next=4,ut.b.get("api/projects/".concat(o.currentTeamId,"/experiments/").concat(i.experimentId));case 4:return d=f.sent,f.abrupt("return",d);case 8:if(f.prev=8,f.t0=f.catch(1),f.t0.status!==404){f.next=14;break}vt.router.actions.push(De.a.experiments()),f.next=16;break;case 14:throw hn.a.error("Failed to load experiment ".concat(i.experimentId)),new Error("Failed to load experiment ".concat(i.experimentId));case 16:return f.abrupt("return",null);case 17:case"end":return f.stop()}},b,null,[[1,8]])}));function C(){return g.apply(this,arguments)}return C}(),updateExperiment:function(){var g=oe()(K.a.mark(function b(d){var T;return K.a.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.next=2,ut.b.update("api/projects/".concat(o.currentTeamId,"/experiments/").concat(i.experimentId),d);case 2:return T=te.sent,te.abrupt("return",T);case 4:case"end":return te.stop()}},b)}));function C(b){return g.apply(this,arguments)}return C}()}],experimentResults:[null,{loadExperimentResults:function(){var g=oe()(K.a.mark(function b(){var d;return K.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.next=3,ut.b.get("api/projects/".concat(o.currentTeamId,"/experiments/").concat(i.experimentId,"/results"));case 3:return d=f.sent,f.abrupt("return",k(k({},d),{},{itemID:Math.random().toString(36).substring(2,15)}));case 7:if(f.prev=7,f.t0=f.catch(0),f.t0.code!=="no_data"){f.next=11;break}return f.abrupt("return",null);case 11:return hn.a.error(f.t0.detail||"Failed to load experiment results"),f.abrupt("return",null);case 13:case"end":return f.stop()}},b,null,[[0,7]])}));function C(){return g.apply(this,arguments)}return C}()}],secondaryMetricResults:[null,{loadSecondaryMetricResults:function(){var g=oe()(K.a.mark(function b(){var d;return K.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,Promise.all((((d=o.experimentData)===null||d===void 0?void 0:d.secondary_metrics)||[]).map(function(){var te=oe()(K.a.mark(function se(Re,B){var V;return K.a.wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:return Me.prev=0,Me.next=3,ut.b.get("api/projects/".concat(o.currentTeamId,"/experiments/").concat(i.experimentId,"/secondary_results?id=").concat(B));case 3:return V=Me.sent,Me.abrupt("return",V.result);case 7:return Me.prev=7,Me.t0=Me.catch(0),Me.abrupt("return",{});case 10:case"end":return Me.stop()}},se,null,[[0,7]])}));return function(se,Re){return te.apply(this,arguments)}}()));case 2:return f.abrupt("return",f.sent);case 3:case"end":return f.stop()}},b)}));function C(){return g.apply(this,arguments)}return C}()}]}},selectors:{breadcrumbs:[function(a){return[a.experimentData,function(r,o){return o.experimentId}]},function(a,r){return[{name:"Experiments",path:De.a.experiments()},{name:(a==null?void 0:a.name)||"New",path:De.a.experiment(r||"new")}]}],variants:[function(a){return[a.newExperimentData,a.experimentData]},function(a,r){var o,i;if(r!=null&&r.start_date){var g;return(r==null||(g=r.parameters)===null||g===void 0?void 0:g.feature_flag_variants)||[]}return(a==null||(o=a.parameters)===null||o===void 0?void 0:o.feature_flag_variants)||(r==null||(i=r.parameters)===null||i===void 0?void 0:i.feature_flag_variants)||[]}],taxonomicGroupTypesForSelection:[function(a){return[a.newExperimentData,a.groupsTaxonomicTypes]},function(a,r){var o;return(a==null||(o=a.filters)===null||o===void 0?void 0:o.aggregation_group_type_index)!=null&&r.length>0?[r[a.filters.aggregation_group_type_index]]:[s.a.PersonProperties,s.a.Cohorts]}],parsedSecondaryMetrics:[function(a){return[a.newExperimentData,a.experimentData]},function(a,r){var o=(a==null?void 0:a.secondary_metrics)||(r==null?void 0:r.secondary_metrics)||[];return o}],minimumDetectableChange:[function(a){return[a.newExperimentData]},function(a){var r;return(a==null||(r=a.parameters)===null||r===void 0?void 0:r.minimum_detectable_effect)||5}],minimumSampleSizePerVariant:[function(a){return[a.minimumDetectableChange]},function(a){return function(r){return Math.ceil(1600*r*(1-r/100)/(a*a))}}],areResultsSignificant:[function(a){return[a.experimentResults]},function(a){return(a==null?void 0:a.significant)||!1}],significanceBannerDetails:[function(a){return[a.experimentResults]},function(a){if((a==null?void 0:a.significance_code)===x.E.HighLoss){var r;return n.a.createElement(n.a.Fragment,null,"This is because the expected loss in conversion is greater than 1%",n.a.createElement(Ve.a,{placement:"right",title:n.a.createElement(n.a.Fragment,null,"Current value is ",(r=((a==null?void 0:a.expected_loss)||0)*100)===null||r===void 0?void 0:r.toFixed(2),"%")},n.a.createElement(Wt.a,{style:{padding:"4px 2px"}})),".")}if((a==null?void 0:a.significance_code)===x.E.HighPValue){var o;return n.a.createElement(n.a.Fragment,null,"This is because the p value is greater than 0.05",n.a.createElement(Ve.a,{placement:"right",title:n.a.createElement(n.a.Fragment,null,"Current value is ",(a==null||(o=a.p_value)===null||o===void 0?void 0:o.toFixed(3))||1,".")},n.a.createElement(Wt.a,{style:{padding:"4px 2px"}})),".")}return(a==null?void 0:a.significance_code)===x.E.LowWinProbability?"This is because the win probability of all test variants combined is less than 90%.":(a==null?void 0:a.significance_code)===x.E.NotEnoughExposure?"This is because we need at least 100 people per variant to declare significance.":""}],recommendedExposureForCountData:[function(a){return[a.minimumDetectableChange]},function(a){return function(r){var o=r*a/100,i=r,g=o+r;return parseFloat((4/Math.pow(Math.sqrt(i/Zt)-Math.sqrt(g/Zt),2)).toFixed(1))}}],expectedRunningTime:[function(){return[]},function(){return function(a,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zt;return parseFloat((r/(a/o)).toFixed(1))}}],conversionRateForVariant:[function(a){return[a.experimentResults]},function(a){return function(r){var o="Can't find variant";if(!a)return o;var i=(a==null?void 0:a.insight).find(function(g){var C,b;return((C=g[0])===null||C===void 0||(b=C.breakdown_value)===null||b===void 0?void 0:b[0])===r});return i?(i[i.length-1].count/i[0].count*100).toFixed(1):o}}],getIndexForVariant:[function(a){return[a.experimentResults]},function(a){return function(r,o){if(!a)return 0;var i=-1;return o===x.s.FUNNELS?i=P()(a==null?void 0:a.insight).sort(function(g,C){var b,d;return((b=C[0])===null||b===void 0?void 0:b.count)-((d=g[0])===null||d===void 0?void 0:d.count)}).findIndex(function(g){var C,b;return((C=g[0])===null||C===void 0||(b=C.breakdown_value)===null||b===void 0?void 0:b[0])===r}):i=(a==null?void 0:a.insight).findIndex(function(g){return g.breakdown_value===r}),i===-1?0:i}}],countDataForVariant:[function(a){return[a.experimentResults]},function(a){return function(r){var o="Can't find variant";if(!a)return o;var i=(a==null?void 0:a.insight).find(function(g){return g.breakdown_value===r});return i?i.count.toString():o}}],highestProbabilityVariant:[function(a){return[a.experimentResults]},function(a){if(a){var r=Math.max.apply(Math,P()(Object.values(a.probability)));return Object.keys(a.probability).find(function(o){return Math.abs(a.probability[o]-r)<Number.EPSILON})}}],areTrendResultsConfusing:[function(a){return[a.experimentResults,a.highestProbabilityVariant]},function(a,r){if(!a)return!1;var o=(a==null?void 0:a.insight).reduce(function(i,g){return g.count>i.count?g:i},{count:0,breakdown_value:""});return o.count?o.breakdown_value!==r:!1}]},urlToAction:function(r){var o=r.actions,i=r.values,g=r.props;return{"/experiments/:id":function(b){var d=b.id;if(!i.hasAvailableFeature(x.c.EXPERIMENTATION)){vt.router.actions.push("/experiments");return}if(d){var T=d==="new"?"new":parseInt(d);T==="new"&&(o.createNewExperimentInsight(),o.resetNewExperiment(),o.setSecondaryMetrics([])),o.setEditExperiment(!1),T!=="new"&&T===g.experimentId&&o.loadExperiment()}}}}});function ln(a){var r=Math.round(100/a),o=r*a,i=o-100,g=new Array(a).fill(r);return g[a-1]=r-i,g}var on=t("./frontend/src/scenes/insights/InsightContainer.tsx"),ht=t("./frontend/src/lib/components/icons.tsx"),Sn=t("./node_modules/@ant-design/icons/es/icons/ExclamationCircleFilled.js"),kt=t("./node_modules/@ant-design/icons/es/icons/CaretDownOutlined.js"),cn=t("./node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),Te=t("./frontend/src/lib/components/CopyToClipboard.tsx"),J=t("./frontend/src/lib/utils.tsx"),ot=t("./frontend/src/scenes/funnels/funnelUtils.ts"),En=t("./node_modules/antd/es/modal/index.js"),Dt=t("./node_modules/antd/es/button/index.js"),Zn=t("./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js");function dn(a,r){var o=Object.keys(a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);r&&(i=i.filter(function(g){return Object.getOwnPropertyDescriptor(a,g).enumerable})),o.push.apply(o,i)}return o}function en(a){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?dn(Object(o),!0).forEach(function(i){$e()(a,i,o[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):dn(Object(o)).forEach(function(i){Object.defineProperty(a,i,Object.getOwnPropertyDescriptor(o,i))})}return a}var _n=14,Vn={name:"",filters:{insight:x.s.TRENDS,events:[{id:"$pageview",name:"$pageview",type:"events",order:0}]}},Ea={name:"",filters:{insight:x.s.FUNNELS,events:[{id:"$pageview",name:"$pageview",type:"events",order:0}],layout:ve.k.horizontal}},Pn=Object(Fe.kea)({props:{},path:["scenes","experiment","secondaryMetricsLogic"],connect:{values:[Ft.a,["currentTeamId"]]},actions:{setSecondaryMetrics:function(r){return{secondaryMetrics:r}},createNewMetric:!0,addNewMetric:function(r){return{metric:r}},updateMetricFilters:function(r){return{filters:r}},setFilters:function(r){return{filters:r}},setPreviewInsightId:function(r){return{shortId:r}},createPreviewInsight:function(r){return{filters:r}},showModal:!0,hideModal:!1,changeInsightType:function(r){return{type:r}},setCurrentMetricName:function(r){return{name:r}},deleteMetric:function(r){return{metricId:r}}},loaders:function(r){var o=r.values;return{experiments:[[],{loadExperiments:function(){var i=oe()(K.a.mark(function C(){var b;return K.a.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,ut.b.get("api/projects/".concat(o.currentTeamId,"/experiments"));case 2:return b=T.sent,T.abrupt("return",b.results);case 4:case"end":return T.stop()}},C)}));function g(){return i.apply(this,arguments)}return g}()}]}},reducers:function(r){var o=r.props;return{previewInsightId:[null,{setPreviewInsightId:function(g,C){var b=C.shortId;return b}}],metrics:[o.initialMetrics,{addNewMetric:function(g,C){var b=C.metric;return[].concat(P()(g),[en({},b)])},deleteMetric:function(g,C){var b=C.metricId;return g.filter(function(d,T){return T!==b})}}],modalVisible:[!1,{showModal:function(){return!0},hideModal:function(){return!1}}],currentMetricName:["",{setCurrentMetricName:function(g,C){var b=C.name;return b}}],currentMetric:[Vn,{changeInsightType:function(g,C){var b=C.type;return b===x.s.TRENDS?Vn:g.filters.insight===x.s.TRENDS?Ea:Vn},updateMetricFilters:function(g,C){var b=C.filters;return en(en({},g),{},{filters:b})}}]}},listeners:function(r){var o=r.actions,i=r.values,g=r.props;return{createPreviewInsight:function(){var C=oe()(K.a.mark(function d(T){var f,te,se,Re;return K.a.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return f=T.filters,(f==null?void 0:f.insight)===x.s.FUNNELS?te=Object(lt.a)(en({insight:x.s.FUNNELS,funnel_viz_type:x.o.Steps,display:x.d.FunnelViz,date_from:Object(Oe.a)().subtract(_n,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(Oe.a)().endOf("d").format("YYYY-MM-DDTHH:mm"),layout:ve.k.horizontal},f)):te=Object(lt.a)(en({insight:x.s.TRENDS,date_from:Object(Oe.a)().subtract(_n,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(Oe.a)().endOf("d").format("YYYY-MM-DDTHH:mm")},f)),se={description:"",tags:[],filters:te,result:null},V.next=5,ut.b.create("api/projects/".concat(Ft.a.values.currentTeamId,"/insights"),se);case 5:Re=V.sent,o.setPreviewInsightId(Re.short_id);case 7:case"end":return V.stop()}},d)}));function b(d){return C.apply(this,arguments)}return b}(),setFilters:function(b){var d=b.filters;if(d.insight===x.s.FUNNELS){var T;(T=Le.a.findMounted({dashboardItemId:i.previewInsightId}))===null||T===void 0||T.actions.setFilters(d)}else{var f;(f=Pe.a.findMounted({dashboardItemId:i.previewInsightId}))===null||f===void 0||f.actions.setFilters(d)}},createNewMetric:function(){o.addNewMetric(en(en({},i.currentMetric),{},{name:i.currentMetricName})),g.onMetricsChange(i.metrics),o.changeInsightType(x.s.TRENDS),o.setCurrentMetricName("")},deleteMetric:function(){g.onMetricsChange(i.metrics)},changeInsightType:function(){return o.createPreviewInsight(i.currentMetric.filters)}}},events:function(r){var o=r.actions;return{afterMount:function(){o.createPreviewInsight()}}}}),Ot=t("./frontend/src/lib/components/LemonButton/index.ts"),Vt=t("./frontend/src/scenes/insights/ActionFilter/ActionFilterRow/ActionFilterRow.tsx");function zt(a,r){var o=Object.keys(a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);r&&(i=i.filter(function(g){return Object.getOwnPropertyDescriptor(a,g).enumerable})),o.push.apply(o,i)}return o}function Gt(a){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?zt(Object(o),!0).forEach(function(i){$e()(a,i,o[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):zt(Object(o)).forEach(function(i){Object.defineProperty(a,i,Object.getOwnPropertyDescriptor(o,i))})}return a}function Tn(a){var r=a.onMetricsChange,o=a.initialMetrics,i=Pn({onMetricsChange:r,initialMetrics:o}),g=Object(Fe.useValues)(i),C=g.previewInsightId,b=g.metrics,d=g.modalVisible,T=g.currentMetric,f=Object(Fe.useActions)(i),te=f.createNewMetric,se=f.updateMetricFilters,Re=f.setFilters,B=f.showModal,V=f.hideModal,v=f.changeInsightType,Me=f.setCurrentMetricName,Mt=f.deleteMetric,Bt=Object(Fe.useValues)(Object(Ke.c)({dashboardItemId:C,syncWithUrl:!1})),Jt=Bt.insightProps,z=Object(Fe.useValues)(Object(Le.a)(Jt)),Xt=z.isStepsEmpty,Yt=z.filterSteps;return n.a.createElement(n.a.Fragment,null,n.a.createElement(En.a,{title:"Add secondary metric",visible:d,destroyOnClose:!0,onCancel:V,footer:null,style:{minWidth:600}},n.a.createElement(F.a,{layout:"vertical",initialValues:{type:x.s.TRENDS},onValuesChange:function(at){at.name&&Me(at.name)},onFinish:function(){te(),V()},scrollToFirstError:!0,requiredMark:!1},n.a.createElement(F.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"You have to enter a name."}]},n.a.createElement(re.a,null)),n.a.createElement(F.a.Item,{name:"type",label:"Type"},n.a.createElement(pe.a,{style:{display:"flex"},value:T.filters.insight,onChange:function(){v()},suffixIcon:n.a.createElement(kt.a,null),dropdownMatchSelectWidth:!1},n.a.createElement(pe.a.Option,{value:x.s.TRENDS},n.a.createElement(E.a,null,n.a.createElement("span",null,n.a.createElement("b",null,"Trend")))),n.a.createElement(pe.a.Option,{value:x.s.FUNNELS},n.a.createElement(E.a,null,n.a.createElement("span",null,n.a.createElement("b",null,"Conversion funnel")))))),n.a.createElement(F.a.Item,{name:"query",label:"Query"},n.a.createElement(Ge.a,{className:"action-filters-bordered",style:{width:"100%",marginRight:8},bodyStyle:{padding:0}},T.filters.insight===x.s.FUNNELS&&n.a.createElement(le.a,{filters:T.filters,setFilters:function(at){var Lt=Gt(Gt({},T.filters),{},{insight:x.s.FUNNELS},at);se(Lt),Re(Lt)},typeKey:"funnel-preview-metric",mathAvailability:Vt.b.None,hideDeleteBtn:Yt.length===1,buttonCopy:"Add funnel step",showSeriesIndicator:!Xt,seriesIndicatorType:"numeric",fullWidth:!0,sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[s.a.EventProperties,s.a.PersonProperties,s.a.Cohorts,s.a.Elements],rowClassName:"action-filters-bordered"}),T.filters.insight===x.s.TRENDS&&n.a.createElement(le.a,{entitiesLimit:1,horizontalUI:!0,filters:T.filters,setFilters:function(at){var Lt=Gt(Gt({},T.filters),{},{insight:x.s.TRENDS},at);se(Lt),Re(Lt)},typeKey:"trend-preview-metric",buttonCopy:"Add graph series",showSeriesIndicator:!0,propertiesTaxonomicGroupTypes:[s.a.EventProperties,s.a.PersonProperties,s.a.Cohorts,s.a.Elements]}))),n.a.createElement(F.a.Item,{name:"metric-preview",label:"Metric preview"},n.a.createElement(Fe.BindLogic,{logic:Ke.c,props:Jt},n.a.createElement(on.a,{disableHeader:!0,disableTable:!0}))),n.a.createElement(y.a,{justify:"end"},n.a.createElement(Ot.a,{type:"secondary",className:"mr-05",onClick:function(){return V()}},"Cancel"),n.a.createElement(Ot.a,{type:"primary",htmlType:"submit"},"Save")))),n.a.createElement(y.a,null,n.a.createElement(E.a,null,b.map(function(ie,at){return n.a.createElement(y.a,{key:at,className:"mt"},n.a.createElement(y.a,{align:"middle",className:"full-width border-all",style:{padding:8}},n.a.createElement("div",{style:{fontWeight:500}},"Name")," ",n.a.createElement("div",{className:"metric-name"},ie.name),n.a.createElement(Zn.a,{className:"text-danger",style:{padding:8},onClick:function(){return Mt(at)}})),n.a.createElement(Ge.a,{className:"full-width",style:{borderTop:"none"},bodyStyle:{padding:0}},ie.filters.insight===x.s.FUNNELS&&n.a.createElement(le.a,{filters:ie.filters,setFilters:function($t){var St=Gt(Gt({},ie.filters),{},{insight:x.s.FUNNELS},$t);se(St),Re(St)},typeKey:"funnel-preview-".concat(at),mathAvailability:Vt.b.None,hideDeleteBtn:Yt.length===1,buttonCopy:"Add funnel step",showSeriesIndicator:!Xt,seriesIndicatorType:"numeric",fullWidth:!0,sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[s.a.EventProperties,s.a.PersonProperties,s.a.Cohorts,s.a.Elements],rowClassName:"action-filters-bordered",readOnly:!0}),ie.filters.insight===x.s.TRENDS&&n.a.createElement(le.a,{horizontalUI:!0,filters:ie.filters,setFilters:function($t){var St=Gt(Gt({},ie.filters),{},{insight:x.s.TRENDS},$t);se(St),Re(St)},typeKey:"trend-preview-".concat(at),buttonCopy:"Add graph series",showSeriesIndicator:!0,entitiesLimit:1,propertiesTaxonomicGroupTypes:[s.a.EventProperties,s.a.PersonProperties,s.a.Cohorts,s.a.Elements],readOnly:!0})))}),b&&!(b.length>2)&&n.a.createElement(E.a,null,n.a.createElement("div",{className:"mb-05 mt"},n.a.createElement(Dt.a,{style:{color:"var(--primary)",minWidth:240},onClick:B},"Add metric"))))))}try{Tn.displayName="SecondaryMetrics",Tn.__docgenInfo={description:"",displayName:"SecondaryMetrics",props:{onMetricsChange:{defaultValue:null,description:"",name:"onMetricsChange",required:!0,type:{name:"(metrics: SecondaryExperimentMetric[]) => void"}},initialMetrics:{defaultValue:null,description:"",name:"initialMetrics",required:!0,type:{name:"SecondaryExperimentMetric[]"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/SecondaryMetrics.tsx#SecondaryMetrics"]={docgenInfo:Tn.__docgenInfo,name:"SecondaryMetrics",path:"frontend/src/scenes/experiments/SecondaryMetrics.tsx#SecondaryMetrics"})}catch(a){}var qn=t("./frontend/src/lib/colors.ts"),ya=t("./frontend/src/lib/components/EntityFilterInfo.tsx"),ba=t("./frontend/src/lib/components/EditableField/EditableField.tsx"),In=t("./frontend/src/lib/components/Link.tsx"),tn=t("./frontend/src/lib/logic/featureFlagLogic.ts"),Oa=t("./node_modules/antd/es/slider/index.js"),yn=t("./node_modules/antd/es/input-number/index.js"),xa=t("./frontend/src/lib/components/InsightLabel/index.tsx"),Bn=t("./frontend/src/lib/components/PropertyFilters/components/PropertyFilterButton.tsx");function Kn(){var a=Object(G.useState)(!1),r=R()(a,2),o=r[0],i=r[1],g=Object(G.useState)(!1),C=R()(g,2),b=C[0],d=C[1];return n.a.createElement(Ge.a,{className:"experiment-workflow",title:n.a.createElement("span",{className:"card-secondary"},"Experiment workflow")},n.a.createElement(y.a,null,n.a.createElement(E.a,{className:"exp-workflow-step step-completed full-width"},n.a.createElement(y.a,{align:"middle"},n.a.createElement(ht.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}),n.a.createElement("b",{className:"ml-05"},"Create experiment")),n.a.createElement("div",{className:"ml-2"},"Set variants, select participants, and add secondary metrics"))),n.a.createElement(y.a,null,n.a.createElement(E.a,{className:"full-width exp-workflow-step ".concat(o?"step-completed":""),onClick:function(){return i(!o)}},n.a.createElement(y.a,{align:"middle"},o?n.a.createElement(ht.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}):n.a.createElement(ht.IconRadioButtonUnchecked,null),n.a.createElement("b",{className:"ml-05"},"Validate experiment")),n.a.createElement("div",{className:"ml-2"},"Once you've written your code, it's a good idea to test that each variant behaves as you'd expect."))),n.a.createElement(y.a,null,n.a.createElement(E.a,{className:"full-width exp-workflow-step ".concat(b?"step-completed":""),onClick:function(){return d(!b)}},n.a.createElement(y.a,{align:"middle"},b?n.a.createElement(ht.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}):n.a.createElement(ht.IconRadioButtonUnchecked,null),n.a.createElement("b",{className:"ml-05"},"Launch experiment")),n.a.createElement("div",{className:"ml-2"},"Run your experiment, monitor results, and decide when to terminate your experiment."))))}function Nn(a){var r,o,i,g,C,b,d=a.experiment,T=a.trendCount,f=a.funnelConversionRate,te=a.trendExposure,se=a.funnelSampleSize,Re=a.funnelEntrants,B=(d==null?void 0:d.id)||"new",V=Object(Fe.useValues)(qt({experimentId:B})),v=V.experimentInsightType,Me=V.editingExistingExperiment,Mt=V.minimumDetectableChange,Bt=V.expectedRunningTime,Jt=V.aggregationLabel,z=Object(Fe.useActions)(qt({experimentId:B})),Xt=z.setNewExperimentData,Yt=v===x.s.FUNNELS&&100-f<50?100-f:50,ie=Object(Oe.a)().diff(Object(Oe.a)(d==null?void 0:d.start_date),"hour"),at=0;d!=null&&d.start_date?at=Bt(Re||1,se||0,ie):at=Bt(Re||1,se||0);var Lt=Object(Oe.a)(d==null?void 0:d.start_date).add(at,"hour"),$t=!(d!=null&&d.end_date)&&ie>=24&&Re&&se,St=Object(J.s)(d==null||(r=d.filters)===null||r===void 0?void 0:r.properties);return n.a.createElement(y.a,null,n.a.createElement(E.a,{span:!(d!=null&&d.start_date)&&B!=="new"&&!Me?12:24},B==="new"&&n.a.createElement(y.a,{className:"experiment-preview-row"},n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("b",null,"Experiment preview")),n.a.createElement("div",{className:"text-muted"},"Here are the baseline metrics for your experiment. Adjust your minimum detectible threshold to adjust for the smallest conversion value you\u2019ll accept, and the experiment duration."," "))),(B==="new"||Me)&&n.a.createElement(y.a,{className:"mb"},n.a.createElement(E.a,{span:24},n.a.createElement("div",null,n.a.createElement("b",null,"Minimum acceptable improvement"),n.a.createElement(_e.a,{title:"Minimum acceptable improvement is a calculation that estimates the smallest significant improvement you are willing to accept."},n.a.createElement(Wt.a,{style:{marginLeft:4}}))),n.a.createElement(y.a,{className:"mde-slider"},n.a.createElement(E.a,{span:8},n.a.createElement(Oa.a,{defaultValue:5,value:Mt,min:1,max:Yt,trackStyle:{background:"var(--primary)"},handleStyle:{background:"var(--primary)"},onChange:function(Et){Xt({parameters:{minimum_detectable_effect:Et}})},tipFormatter:function(Et){return"".concat(Et,"%")}})),n.a.createElement(yn.a,{min:1,max:Yt,defaultValue:5,formatter:function(Et){return"".concat(Et,"%")},style:{margin:"0 16px"},value:Mt,onChange:function(Et){Xt({parameters:{minimum_detectable_effect:Et}})}})))),n.a.createElement(y.a,{className:"experiment-preview-row ".concat(d!=null&&d.start_date?"mr":"")},v===x.s.TRENDS?n.a.createElement(n.a.Fragment,null,!(d!=null&&d.start_date)&&n.a.createElement(n.a.Fragment,null,n.a.createElement(E.a,{span:6},n.a.createElement("div",{className:"card-secondary"},"Baseline Count"),n.a.createElement("div",{className:"l4"},Object(J.O)(T||0))),n.a.createElement(E.a,{span:6},n.a.createElement("div",{className:"card-secondary"},"Minimum Acceptable Count"),n.a.createElement("div",{className:"l4"},Object(J.O)(T+Math.ceil(T*(Mt/100))||0)))),n.a.createElement(E.a,{span:12},n.a.createElement("div",{className:"card-secondary"},"Recommended running time"),n.a.createElement("div",null,n.a.createElement("span",{className:"l4"},"~",Object(J.O)(te||0))," days"))):n.a.createElement(n.a.Fragment,null,!(d!=null&&d.start_date)&&n.a.createElement(n.a.Fragment,null,n.a.createElement(E.a,{span:12},n.a.createElement("div",{className:"card-secondary"},"Baseline Conversion Rate"),n.a.createElement("div",{className:"l4"},f.toFixed(1),"%")),n.a.createElement(E.a,{span:12},n.a.createElement("div",{className:"card-secondary"},"Minimum Acceptable Conversion Rate"),n.a.createElement("div",{className:"l4"},(f+Mt).toFixed(1),"%"))),n.a.createElement(E.a,{span:12},n.a.createElement("div",{className:"card-secondary"},"Recommended Sample Size"),n.a.createElement("div",{className:"pb"},n.a.createElement("span",{className:"l4"},"~",Object(J.O)(se||0))," persons")),!(d!=null&&d.start_date)&&n.a.createElement(E.a,{span:12},n.a.createElement("div",{className:"card-secondary"},"Recommended running time"),n.a.createElement("div",null,n.a.createElement("span",{className:"l4"},"~",Object(J.O)(at||0))," days"))),n.a.createElement(y.a,{className:"full-width mt"},n.a.createElement(E.a,{span:12},n.a.createElement("div",{className:"card-secondary"},"Experiment variants"),n.a.createElement("ul",{className:"variants-list"},d==null||(o=d.parameters)===null||o===void 0||(i=o.feature_flag_variants)===null||i===void 0?void 0:i.map(function(it,Et){return n.a.createElement("li",{key:Et},it.key)}))),n.a.createElement(E.a,{span:12},n.a.createElement("div",{className:"card-secondary"},"Participants"),n.a.createElement("div",null,St!=null&&St.length?n.a.createElement("div",null,St==null?void 0:St.map(function(it){return n.a.createElement(Bn.c,{key:it.key,item:it,style:{margin:2,cursor:"default"}})})):n.a.createElement(n.a.Fragment,null,"100% of"," ",(d==null||(g=d.filters)===null||g===void 0?void 0:g.aggregation_group_type_index)!=null?Object(J.j)(Jt(d.filters.aggregation_group_type_index).plural):"users")))),n.a.createElement(y.a,{className:"full-width"},B!=="new"&&!Me&&n.a.createElement(E.a,{span:12},n.a.createElement("div",{className:"card-secondary mt"},"Start date"),d!=null&&d.start_date?n.a.createElement("span",null,Object(Oe.a)(d==null?void 0:d.start_date).format("D MMM YYYY")):n.a.createElement("span",{className:"description"},"Not started yet")),v===x.s.FUNNELS&&$t?n.a.createElement(E.a,{span:12},n.a.createElement("div",{className:"card-secondary mt"},"Expected end date"),n.a.createElement("span",null,Lt.isAfter(Object(Oe.a)())?Lt.format("D MMM YYYY"):Object(Oe.a)().format("D MMM YYYY"))):null,(d==null?void 0:d.end_date)&&n.a.createElement(E.a,{span:12},n.a.createElement("div",{className:"card-secondary mt"},"Completed date"),n.a.createElement("span",null,Object(Oe.a)(d==null?void 0:d.end_date).format("D MMM YYYY"))))),B!=="new"&&!Me&&n.a.createElement(y.a,{className:"experiment-preview-row"},n.a.createElement(E.a,null,n.a.createElement("div",{className:"card-secondary mb-05"},v===x.s.FUNNELS?"Conversion goal steps":"Trend goal"),[].concat(P()((d==null||(C=d.filters)===null||C===void 0?void 0:C.events)||[]),P()((d==null||(b=d.filters)===null||b===void 0?void 0:b.actions)||[])).sort(function(it,Et){return(it.order||0)-(Et.order||0)}).map(function(it,Et){var Fn;return n.a.createElement(E.a,{key:Et,className:"mb-05"},n.a.createElement(y.a,{style:{marginBottom:4}},n.a.createElement("div",{className:"preview-conversion-goal-num"},v===x.s.FUNNELS?(it.order||0)+1:Et+1),n.a.createElement("b",null,n.a.createElement(xa.b,{action:it,showCountedByTag:v===x.s.TRENDS,hideIcon:!0}))),(Fn=it.properties)===null||Fn===void 0?void 0:Fn.map(function(Dn){return n.a.createElement(Bn.c,{key:Dn.key,item:Dn})}))})))),B!=="new"&&!Me&&!(d!=null&&d.start_date)&&n.a.createElement(E.a,{span:12,className:"pl"},n.a.createElement(Kn,null)))}try{Nn.displayName="ExperimentPreview",Nn.__docgenInfo={description:"",displayName:"ExperimentPreview",props:{experiment:{defaultValue:null,description:"",name:"experiment",required:!0,type:{name:"Partial<Experiment> | null"}},trendCount:{defaultValue:null,description:"",name:"trendCount",required:!0,type:{name:"number"}},trendExposure:{defaultValue:null,description:"",name:"trendExposure",required:!1,type:{name:"number"}},funnelSampleSize:{defaultValue:null,description:"",name:"funnelSampleSize",required:!1,type:{name:"number"}},funnelConversionRate:{defaultValue:null,description:"",name:"funnelConversionRate",required:!0,type:{name:"number"}},funnelEntrants:{defaultValue:null,description:"",name:"funnelEntrants",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentPreview.tsx#ExperimentPreview"]={docgenInfo:Nn.__docgenInfo,name:"ExperimentPreview",path:"frontend/src/scenes/experiments/ExperimentPreview.tsx#ExperimentPreview"})}catch(a){}var Un=t("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx");function Ct(a){var r,o,i,g=a.experiment,C=Object(G.useState)("control"),b=R()(C,2),d=b[0],T=b[1];return n.a.createElement(Ge.a,{title:n.a.createElement("span",{className:"card-secondary"},"Feature flag usage and implementation"),className:"experiment-implementation-details"},n.a.createElement(y.a,{justify:"space-between",className:"mb-05"},n.a.createElement("div",null,n.a.createElement("span",{className:"mr-05"},"Variant group"),n.a.createElement(pe.a,{onChange:T,defaultValue:"control",suffixIcon:n.a.createElement(kt.a,null)},g==null||(r=g.parameters)===null||r===void 0||(o=r.feature_flag_variants)===null||o===void 0?void 0:o.map(function(f,te){return n.a.createElement(pe.a.Option,{key:te,value:f.key},f.key)}))),n.a.createElement("div",null,n.a.createElement(ta,null))),n.a.createElement("b",null,"Implement your experiment in code"),n.a.createElement(Un.a,{language:Un.b.JavaScript,wrap:!0},"if (posthog.getFeatureFlag('".concat((i=g==null?void 0:g.feature_flag_key)!==null&&i!==void 0?i:"","') === '").concat(d,`') {
    // where '`).concat(d,`' is the variant, run your code here
}`)),n.a.createElement("b",null,"Test that it works"),n.a.createElement(Un.a,{language:Un.b.JavaScript},"posthog.feature_flags.override({'".concat(g==null?void 0:g.feature_flag_key,"': '").concat(d,"'})")),n.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://posthog.com/docs/user-guides/feature-flags"},n.a.createElement(y.a,{align:"middle"},"Experiment implementation guide",n.a.createElement(ht.IconOpenInNew,{className:"ml-05"}))))}try{Ct.displayName="ExperimentImplementationDetails",Ct.__docgenInfo={description:"",displayName:"ExperimentImplementationDetails",props:{experiment:{defaultValue:null,description:"",name:"experiment",required:!0,type:{name:"Partial<Experiment> | null"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#ExperimentImplementationDetails"]={docgenInfo:Ct.__docgenInfo,name:"ExperimentImplementationDetails",path:"frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#ExperimentImplementationDetails"})}catch(a){}function ja(a,r){var o=Object.keys(a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);r&&(i=i.filter(function(g){return Object.getOwnPropertyDescriptor(a,g).enumerable})),o.push.apply(o,i)}return o}function bn(a){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?ja(Object(o),!0).forEach(function(i){$e()(a,i,o[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):ja(Object(o)).forEach(function(i){Object.defineProperty(a,i,Object.getOwnPropertyDescriptor(o,i))})}return a}var ea={component:On,logic:qt,paramsToProps:function(r){var o=r.params.id;return{experimentId:o==="new"?"new":parseInt(o)}}};function On(){var a,r,o,i,g,C,b,d,T,f,te,se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Re=se.id,B=Object(Fe.useValues)(qt({experimentId:Re})),V=B.newExperimentData,v=B.experimentData,Me=B.experimentInsightId,Mt=B.minimumSampleSizePerVariant,Bt=B.recommendedExposureForCountData,Jt=B.variants,z=B.experimentResults,Xt=B.countDataForVariant,Yt=B.editingExistingExperiment,ie=B.experimentInsightType,at=B.experimentResultsLoading,Lt=B.parsedSecondaryMetrics,$t=B.areResultsSignificant,St=B.conversionRateForVariant,it=B.getIndexForVariant,Et=B.significanceBannerDetails,Fn=B.areTrendResultsConfusing,Dn=B.taxonomicGroupTypesForSelection,Wn=B.groupTypes,Ca=B.aggregationLabel,et=B.secondaryMetricResults,na=B.experimentDataLoading,Sa=B.secondaryMetricResultsLoading,Pt=Object(Fe.useActions)(qt({experimentId:Re})),un=Pt.setNewExperimentData,aa=Pt.createExperiment,ra=Pt.launchExperiment,Kt=Pt.setFilters,Pa=Pt.setEditExperiment,xn=Pt.endExperiment,mn=Pt.addExperimentGroup,pn=Pt.updateExperiment,Ta=Pt.updateExperimentGroup,sa=Pt.removeExperimentGroup,kn=Pt.setSecondaryMetrics,wa=Pt.setExperimentInsightType,_a=Pt.archiveExperiment,Ia=Object(Fe.useValues)(tn.a),nn=Ia.featureFlags,an=F.a.useForm(),la=R()(an,1),Na=la[0],Fa=Object(G.useState)(!0),oa=R()(Fa,2),zn=oa[0],Yn=oa[1],ia=Object(Fe.useValues)(Object(Ke.c)({dashboardItemId:Me})),jn=ia.insightProps,Mn=Object(Fe.useValues)(Object(Le.a)(jn)),Va=Mn.isStepsEmpty,Da=Mn.filterSteps,$n=Mn.filters,Hn=Mn.results,Ma=Mn.conversionMetrics,ca=Object(Fe.useValues)(Object(Pe.a)(jn)),Ln=ca.filters,La=ca.results,Gn=Ma.totalRate*100,Aa=Mt(Gn),Jn=Aa*Jt.length,Xn=(a=La[0])===null||a===void 0?void 0:a.count,da=Hn==null||(r=Hn[0])===null||r===void 0?void 0:r.count,ua=Bt(Xn),Cn=Math.floor(24/(Jt.length+2)),An=ie===x.s.FUNNELS&&(z==null?void 0:z.insight)?z.insight.reduce(function(Y,$){var rt;return((rt=$[0])===null||rt===void 0?void 0:rt.count)+Y},0):0,ma=ie===x.s.FUNNELS?(An||0)/((v==null||(o=v.parameters)===null||o===void 0?void 0:o.recommended_sample_size)||1)*100:Object(Oe.a)().diff(v==null?void 0:v.start_date,"day")/((v==null||(i=v.parameters)===null||i===void 0?void 0:i.recommended_running_time)||1)*100,Qn={running:"green",draft:"default",complete:"purple"},Ra=function(){if(v!=null&&v.start_date){if(!(v!=null&&v.end_date))return"running"}else return"draft";return"complete"},Ba=[{background:"#35416b",color:"#fff"},{background:"#C278CE66",color:"#35416B"},{background:"#FFE6AE",color:"#35416B"},{background:"#8DA9E74D",color:"#35416B"}];return n.a.createElement(n.a.Fragment,null,Re==="new"||Yt?n.a.createElement(n.a.Fragment,null,n.a.createElement(y.a,{align:"middle",justify:"space-between",style:{borderBottom:"1px solid var(--border)",marginBottom:"1rem",paddingBottom:8}},n.a.createElement(ft.a,{title:"New experiment"}),n.a.createElement(y.a,null,n.a.createElement(Ot.a,{type:"secondary",className:"mr-05",onClick:function(){return vt.router.actions.push(De.a.experiments())}},"Cancel"),n.a.createElement(Ot.a,{type:"primary",htmlType:"submit",form:"new-experiment"},"Save"))),n.a.createElement(F.a,{name:"new-experiment",layout:"vertical",className:"experiment-form",form:Na,onValuesChange:function($){return un($)},initialValues:{name:V==null?void 0:V.name,feature_flag_key:V==null?void 0:V.feature_flag_key,description:V==null?void 0:V.description},onFinish:function(){return aa(!0,ua,Jn)},requiredMark:!1,scrollToFirstError:!0},n.a.createElement("div",null,n.a.createElement(Fe.BindLogic,{logic:Ke.c,props:jn},n.a.createElement(y.a,null,n.a.createElement(E.a,{span:12,style:{paddingRight:24}},n.a.createElement(y.a,{className:"full-width"},n.a.createElement(F.a.Item,{style:{marginRight:16},label:"Name",name:"name",rules:[{required:!0,message:"You have to enter a name."}]},n.a.createElement(re.a,{"data-attr":"experiment-name",className:"ph-ignore-input"})),n.a.createElement(F.a.Item,{style:{marginBottom:"1rem"},label:n.a.createElement("div",null,"Feature flag key"," ",n.a.createElement(_e.a,{title:"Enter a unique key. This will create a new feature flag which will be associated with this experiment."},n.a.createElement(Wt.a,null))),name:"feature_flag_key",rules:[{required:!0,message:"You have to enter a feature flag key name."}]},n.a.createElement(re.a,{"data-attr":"experiment-feature-flag-key",disabled:Yt}))),n.a.createElement(F.a.Item,{label:n.a.createElement("div",null,"Description ",n.a.createElement("span",{className:"text-muted"},"(optional)")),name:"description"},n.a.createElement(re.a.TextArea,{"data-attr":"experiment-description",className:"ph-ignore-input",placeholder:"Adding a helpful description can ensure others know what this experiment is about."})),(V==null||(g=V.parameters)===null||g===void 0?void 0:g.feature_flag_variants)&&n.a.createElement(E.a,null,n.a.createElement("label",null,n.a.createElement("b",null,"Experiment variants")),n.a.createElement("div",{className:"text-muted"},"Participants are divided into variant groups evenly. All experiments must consist of a control group and at least one test group. Experiments may have at most 3 test groups. Variant names can only contain letters, numbers, hyphens, and underscores."),n.a.createElement(E.a,{className:"variants"},V.parameters.feature_flag_variants.map(function(Y,$){return n.a.createElement(F.a,{key:"".concat(Y,"-").concat($),initialValues:{key:Y.key},onValuesChange:function(Tt){Ta(Tt,$)}},n.a.createElement(y.a,{key:"".concat(Y,"-").concat($),className:"feature-flag-variant ".concat($===0?"border-top":$>=3?"border-bottom":"")},n.a.createElement("div",{className:"variant-label",style:bn({},Ba[$])},$===0?"Control":"Test"),n.a.createElement(F.a.Item,{name:"key",rules:[{required:!0,message:"Key should not be empty."},{required:!0,pattern:/^([A-z]|[a-z]|[0-9]|-|_)+$/,message:n.a.createElement(n.a.Fragment,null,n.a.createElement(Sn.a,{style:{color:"#F96132"}})," ","Variant names can only contain letters, numbers, hyphens, and underscores.")}],style:{display:"contents"}},n.a.createElement(re.a,{disabled:$===0,"data-attr":"feature-flag-variant-key","data-key-index":$.toString(),className:"ph-ignore-input",placeholder:"example-variant-".concat($+1),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})),n.a.createElement("div",{className:"float-right"},!($===0||$===1)&&n.a.createElement(_e.a,{title:"Delete this variant",placement:"bottomLeft"},n.a.createElement(Ot.a,{type:"primary-alt",compact:!0,icon:n.a.createElement(ht.IconDelete,null),onClick:function(){return sa($)}})))))}),V.parameters.feature_flag_variants.length<4&&n.a.createElement("div",{className:"feature-flag-variant border-bottom"},n.a.createElement(Ot.a,{onClick:function(){return mn()},fullWidth:!0,icon:n.a.createElement(ht.IconPlusMini,null)},"Add test variant")))),n.a.createElement(y.a,{className:"person-selection"},n.a.createElement("div",{className:"mb-05"},n.a.createElement("strong",null,"Select participants")),n.a.createElement(E.a,null,n.a.createElement("div",{className:"text-muted"},"Select the entities who will participate in this experiment. If no filters are set, 100% of participants will be targeted."),n.a.createElement("div",{className:"mt mb-05"},n.a.createElement("strong",null,"Participant type")),n.a.createElement(pe.a,{value:(V==null||(C=V.filters)===null||C===void 0?void 0:C.aggregation_group_type_index)!=null?V.filters.aggregation_group_type_index:-1,onChange:function($){var rt,Tt=$!==-1?$:void 0;Tt!=(V==null||(rt=V.filters)===null||rt===void 0?void 0:rt.aggregation_group_type_index)&&(Kt({properties:[],aggregation_group_type_index:Tt}),un({filters:{aggregation_group_type_index:Tt,properties:[]}}))},"data-attr":"participant-aggregation-filter",dropdownMatchSelectWidth:!1},n.a.createElement(pe.a.Option,{key:-1,value:-1},"Persons"),Wn.map(function(Y){return n.a.createElement(pe.a.Option,{key:Y.group_type_index,value:Y.group_type_index},Object(J.j)(Ca(Y.group_type_index).plural))})),n.a.createElement("div",{className:"mt"},n.a.createElement("strong",null,"Filters")),n.a.createElement(Je.a,{pageKey:"experiment-participants-property",propertyFilters:ie===x.s.FUNNELS?Object(J.s)($n.properties):Object(J.s)(Ln.properties),onChange:function($){un({filters:{properties:$}}),Kt({properties:$.filter(tt.b)})},taxonomicGroupTypes:Dn})))),n.a.createElement(y.a,{className:"metrics-selection"},n.a.createElement(E.a,{span:12},n.a.createElement("div",{className:"mb-05"},n.a.createElement("b",null,"Goal type"),n.a.createElement("div",{className:"text-muted"},ie===x.s.TRENDS?"Track counts of a specific event or action":"Track how many persons complete a sequence of actions and or events")),n.a.createElement(pe.a,{style:{display:"flex"},value:ie,onChange:wa,suffixIcon:n.a.createElement(kt.a,null),dropdownMatchSelectWidth:!1},n.a.createElement(pe.a.Option,{value:x.s.TRENDS},n.a.createElement(E.a,null,n.a.createElement("span",null,n.a.createElement("b",null,"Trend")))),n.a.createElement(pe.a.Option,{value:x.s.FUNNELS},n.a.createElement(E.a,null,n.a.createElement("span",null,n.a.createElement("b",null,"Conversion funnel"))))),n.a.createElement("div",{className:"mb mt"},n.a.createElement("b",null,"Experiment goal"),ie===x.s.TRENDS&&n.a.createElement("div",{className:"text-muted"},"Trend-based experiments can have at most one graph series. This metric is used to track the progress of your experiment.")),n.a.createElement(y.a,null,n.a.createElement(Ge.a,{className:"action-filters-bordered",style:{width:"100%",marginRight:8},bodyStyle:{padding:0}},ie===x.s.FUNNELS&&n.a.createElement(le.a,{filters:$n,setFilters:function($){un({filters:$}),Kt($)},typeKey:"EditFunnel-action",mathAvailability:Vt.b.None,hideDeleteBtn:Da.length===1,buttonCopy:"Add funnel step",buttonType:"link",showSeriesIndicator:!Va,seriesIndicatorType:"numeric",fullWidth:!0,sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[s.a.EventProperties,s.a.PersonProperties,s.a.Cohorts,s.a.Elements],rowClassName:"action-filters-bordered"}),ie===x.s.TRENDS&&n.a.createElement(le.a,{horizontalUI:!0,filters:Ln,setFilters:function($){un({filters:$}),Kt($)},typeKey:"experiment-trends",buttonCopy:"Add graph series",showSeriesIndicator:!0,entitiesLimit:1,propertiesTaxonomicGroupTypes:[s.a.EventProperties,s.a.PersonProperties,s.a.Cohorts,s.a.Elements],customRowPrefix:Ln.insight===x.s.LIFECYCLE?n.a.createElement(n.a.Fragment,null,"Showing ",n.a.createElement("b",null,"Unique users")," who did"):void 0}))),nn[ve.i.EXPERIMENTS_SECONDARY_METRICS]&&n.a.createElement(E.a,{className:"secondary-metrics"},n.a.createElement("div",null,n.a.createElement("b",null,"Secondary metrics"),n.a.createElement("span",{className:"text-muted ml-05"},"(optional)")),n.a.createElement("div",{className:"text-muted",style:{marginTop:4}},"Use secondary metrics to monitor metrics related to your experiment goal. You can add up to three secondary metrics."," "),n.a.createElement(Tn,{onMetricsChange:function($){return kn($)},initialMetrics:Lt}))),n.a.createElement(E.a,{span:12,className:"pl"},n.a.createElement("div",{className:"card-secondary mb"},"Goal preview"),n.a.createElement(on.a,{disableHeader:ie===x.s.TRENDS,disableTable:!0})))),n.a.createElement(y.a,null,n.a.createElement(Ge.a,{className:"experiment-preview"},n.a.createElement(Nn,{experiment:V,trendCount:Xn,trendExposure:ua,funnelSampleSize:Jn,funnelEntrants:da,funnelConversionRate:Gn}))))),n.a.createElement(Ot.a,{className:"float-right",type:"primary",htmlType:"submit"},"Save"))):!na&&v?n.a.createElement("div",{className:"view-experiment"},n.a.createElement(y.a,{className:"draft-header"},n.a.createElement(y.a,{justify:"space-between",align:"middle",className:"full-width pb"},n.a.createElement(E.a,null,n.a.createElement(y.a,null,n.a.createElement(ft.a,{style:{paddingRight:8},title:"".concat(v==null?void 0:v.name),buttons:n.a.createElement(n.a.Fragment,null,n.a.createElement(Te.a,{explicitValue:v.feature_flag_key,iconStyle:{color:"var(--text-muted-alt)"}},n.a.createElement("span",{className:"text-muted"},v.feature_flag_key)),n.a.createElement(w.a,{style:{alignSelf:"center"},color:Qn[Ra()]},n.a.createElement("b",{className:"uppercase"},Ra())),z&&v.end_date&&n.a.createElement(w.a,{style:{alignSelf:"center"},color:$t?"green":"geekblue"},n.a.createElement("b",{className:"uppercase"},$t?"Significant Results":"Results not significant")))})),n.a.createElement("span",{className:"exp-description"},v.start_date?n.a.createElement(ba.a,{multiline:!0,name:"description",value:v.description||"",placeholder:"Description (optional)",onSave:function($){return pn({description:$})},maxLength:400,"data-attr":"experiment-description",compactButtons:!0}):n.a.createElement(n.a.Fragment,null,v.description||"There is no description for this experiment."))),v&&!v.start_date&&n.a.createElement("div",{className:"flex-center"},n.a.createElement(Ot.a,{type:"secondary",className:"mr-05",onClick:function(){return Pa(!0)}},"Edit"),n.a.createElement(Ot.a,{type:"primary",onClick:function(){return ra()}},"Launch")),v&&v.start_date&&!v.end_date&&n.a.createElement(Ot.a,{type:"secondary",status:"danger",onClick:function(){return xn()}},"Stop"),(v==null?void 0:v.end_date)&&Object(Oe.a)().isSameOrAfter(Object(Oe.a)(v.end_date),"day")&&!v.archived&&n.a.createElement(Ot.a,{type:"secondary",status:"danger",onClick:function(){return _a()}},n.a.createElement("b",null,"Archive")))),n.a.createElement(y.a,null,zn&&z&&$t&&!v.end_date&&n.a.createElement(y.a,{align:"middle",className:"significant-results"},n.a.createElement(E.a,{span:20,style:{fontWeight:500,color:"#497342"}},n.a.createElement("div",null,"Experiment results are significant."," ",v.end_date?"":"You can end your experiment now or let it run until complete.")),n.a.createElement(E.a,{span:4},v.end_date?n.a.createElement(cn.a,{className:"close-button",onClick:function(){return Yn(!1)}}):n.a.createElement(Ot.a,{type:"highlighted",className:"end-experiment-btn",onClick:function(){return xn()}},"End experiment"))),zn&&z&&!$t&&!v.end_date&&n.a.createElement(y.a,{align:"top",className:"not-significant-results"},n.a.createElement(E.a,{span:23,style:{fontWeight:500,color:"#2D2D2D"}},n.a.createElement("strong",null,"Your results are not statistically significant"),"."," ",Et," ",v!=null&&v.end_date?"":"We don't recommend ending this experiment yet."," ","See our"," ",n.a.createElement("a",{href:"https://posthog.com/docs/user-guides/experimentation#funnel-experiment-calculations"}," ","experimentation guide"," "),"for more information."," "),n.a.createElement(E.a,{span:1},n.a.createElement(cn.a,{className:"close-button",onClick:function(){return Yn(!1)}}))),zn&&v.end_date&&n.a.createElement(y.a,{align:"top",className:"feature-flag-mods"},n.a.createElement(E.a,{span:23,style:{fontWeight:500}},n.a.createElement("strong",null,"Your experiment is complete.")," We recommend removing the feature flag from your code completely, instead of relying on this distribution."," ",n.a.createElement(In.a,{to:v.feature_flag?De.a.featureFlag(v.feature_flag):void 0},n.a.createElement("b",null,"Adjust feature flag distribution"))),n.a.createElement(E.a,{span:1},n.a.createElement(cn.a,{className:"close-button",onClick:function(){return Yn(!1)}})))),n.a.createElement(y.a,null,n.a.createElement(H.a,{className:"full-width",defaultActiveKey:"experiment-details"},n.a.createElement(H.a.Panel,{header:n.a.createElement("b",null,"Experiment details"),key:"experiment-details"},n.a.createElement(y.a,null,n.a.createElement(E.a,{span:v!=null&&v.start_date?12:24},n.a.createElement(Nn,{experiment:v,trendCount:Xn,trendExposure:v==null?void 0:v.parameters.recommended_running_time,funnelSampleSize:v==null?void 0:v.parameters.recommended_sample_size,funnelConversionRate:Gn,funnelEntrants:v!=null&&v.start_date?An:da})),!at&&!z&&v.start_date&&n.a.createElement(E.a,{span:12},n.a.createElement(Ct,{experiment:v})),(z||((b=v.secondary_metrics)===null||b===void 0?void 0:b.length)>0)&&n.a.createElement(E.a,{className:"secondary-progress",span:v!=null&&v.start_date?12:24},nn[ve.i.EXPERIMENTS_SECONDARY_METRICS]&&!!(v!=null&&v.secondary_metrics.length)&&n.a.createElement(E.a,{className:"border-bottom"},n.a.createElement(y.a,{align:"middle",justify:"space-between",className:"mb-05"},n.a.createElement(E.a,{className:"card-secondary",span:2*Cn},"Secondary metrics"),v==null||(d=v.parameters)===null||d===void 0||(T=d.feature_flag_variants)===null||T===void 0?void 0:T.map(function(Y,$){return n.a.createElement(E.a,{key:$,span:Cn,style:{color:"".concat(ie===x.s.FUNNELS?Object(ot.k)(it(Y.key,x.s.FUNNELS)+1):Object(qn.c)("white")[it(Y.key,x.s.TRENDS)])}},n.a.createElement("span",{className:"text-default"},Object(J.j)(Y.key)))})),nn[ve.i.EXPERIMENTS_SECONDARY_METRICS]&&(v.start_date?Sa?n.a.createElement(ae.a,{active:!0,paragraph:!1}):n.a.createElement(n.a.Fragment,null,v.secondary_metrics.map(function(Y,$){var rt,Tt;return n.a.createElement(y.a,{className:"border-top",key:$,justify:"space-between",style:{paddingTop:8,paddingBottom:8}},n.a.createElement(E.a,{span:2*Cn},Object(J.j)(Y.name)),v==null||(rt=v.parameters)===null||rt===void 0||(Tt=rt.feature_flag_variants)===null||Tt===void 0?void 0:Tt.map(function(Rn,pa){return n.a.createElement(E.a,{key:pa,span:Cn},et!=null&&et[$][Rn.key]?Y.filters.insight===x.s.FUNNELS?n.a.createElement(n.a.Fragment,null,((et==null?void 0:et[$][Rn.key])*100).toFixed(1),"%"):n.a.createElement(n.a.Fragment,null,Object(J.O)(et==null?void 0:et[$][Rn.key])):n.a.createElement(n.a.Fragment,null,"--"))}))})):n.a.createElement(n.a.Fragment,null,v.secondary_metrics.map(function(Y,$){var rt,Tt;return n.a.createElement(y.a,{className:"border-top",key:$,justify:"space-between",style:{paddingTop:8,paddingBottom:8}},n.a.createElement(E.a,{span:2*Cn},Object(J.j)(Y.name)),v==null||(rt=v.parameters)===null||rt===void 0||(Tt=rt.feature_flag_variants)===null||Tt===void 0?void 0:Tt.map(function(Rn,pa){return n.a.createElement(E.a,{key:pa,span:Cn},"--")}))})))),z&&n.a.createElement(E.a,{className:"mt"},n.a.createElement("div",{className:"mb-05"},n.a.createElement("b",null,"Experiment progress")),n.a.createElement(ye.a,{strokeWidth:20,showInfo:!1,percent:ma,strokeColor:"var(--success)"}),ie===x.s.TRENDS&&v.start_date&&n.a.createElement(y.a,{justify:"space-between",className:"mt-05"},v.end_date?n.a.createElement("div",null,"Ran for"," ",n.a.createElement("b",null,Object(Oe.a)(v.end_date).diff(v.start_date,"day"))," ","days"):n.a.createElement("div",null,n.a.createElement("b",null,Object(Oe.a)().diff(v.start_date,"day"))," ","days running"),n.a.createElement("div",null,"Goal:"," ",n.a.createElement("b",null,v==null||(f=v.parameters)===null||f===void 0?void 0:f.recommended_running_time)," ","days")),ie===x.s.FUNNELS&&n.a.createElement(y.a,{justify:"space-between",className:"mt-05"},v.end_date?n.a.createElement("div",null,"Saw"," ",n.a.createElement("b",null,Object(J.O)(An))," ","participants"):n.a.createElement("div",null,n.a.createElement("b",null,Object(J.O)(An))," ","participants seen"),n.a.createElement("div",null,"Goal:"," ",n.a.createElement("b",null,Object(J.O)((v==null||(te=v.parameters)===null||te===void 0?void 0:te.recommended_sample_size)||0))," ","participants"))))))),!(v!=null&&v.start_date)&&n.a.createElement("div",{className:"mt full-width"},n.a.createElement(Ct,{experiment:v}))),n.a.createElement("div",{className:"experiment-result"},z?n.a.createElement(n.a.Fragment,null,n.a.createElement(y.a,{justify:"space-around",style:{flexFlow:"nowrap"}},Object.keys(z.probability).sort(function(Y,$){return z.probability[$]-z.probability[Y]}).map(function(Y,$){return n.a.createElement(E.a,{key:$,className:"pr"},n.a.createElement("div",null,n.a.createElement("b",null,Object(J.j)(Y))),ie===x.s.TRENDS?n.a.createElement(y.a,null,n.a.createElement("b",{style:{paddingRight:4}},n.a.createElement(y.a,null,"action"in z.insight[0]&&n.a.createElement(ya.a,{filter:z.insight[0].action}),n.a.createElement("span",{style:{paddingLeft:4}},"count:")))," ",Xt(Y)," ",Fn&&$===0&&n.a.createElement(_e.a,{placement:"right",title:"It might seem confusing that the best variant has lower absolute count, but this can happen when fewer people are exposed to this variant, so its relative count is higher."},n.a.createElement(Wt.a,{style:{padding:"4px 2px"}}))):n.a.createElement(y.a,null,n.a.createElement("b",{style:{paddingRight:4}},"Conversion rate:")," ",St(Y),"%"),n.a.createElement(ye.a,{percent:Number((z.probability[Y]*100).toFixed(1)),size:"small",showInfo:!1,strokeColor:ie===x.s.FUNNELS?Object(ot.k)(it(Y,x.s.FUNNELS)+1):Object(qn.c)("white")[it(Y,x.s.TRENDS)]}),n.a.createElement("div",null,"Probability that this variant is the best:"," ",n.a.createElement("b",null,(z.probability[Y]*100).toFixed(1),"%")))}))):at&&n.a.createElement("div",{className:"text-center"},n.a.createElement(ae.a,{active:!0})),z?n.a.createElement(Fe.BindLogic,{logic:Ke.c,props:{dashboardItemId:z.itemID,cachedInsight:{short_id:z.itemID,filters:bn(bn(bn({},z.filters),{},{insight:ie,display:v.filters.display},ie===x.s.FUNNELS&&{layout:ve.k.vertical,funnel_viz_type:x.o.Steps}),ie===x.s.TRENDS&&{display:x.d.ActionsLineGraphCumulative}),result:z.insight},doNotLoad:!0}},n.a.createElement("div",{className:"mt"},n.a.createElement(on.a,{disableHeader:ie===x.s.TRENDS,disableTable:ie===x.s.FUNNELS}))):v.start_date&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"no-experiment-results"},!at&&n.a.createElement("div",{className:"text-center"},n.a.createElement("b",null,"There are no results for this experiment yet."),n.a.createElement("div",{className:"text-default"},"Double check your feature flag implementation if you're still not seeing results.")))))):n.a.createElement(ae.a,{active:!0}))}function ta(){return n.a.createElement(pe.a,{defaultValue:"JavaScript",suffixIcon:n.a.createElement(kt.a,null)},n.a.createElement(pe.a.Option,{value:"JavaScript"},n.a.createElement(y.a,{align:"middle"},n.a.createElement(ht.IconJavascript,{style:{marginRight:6}})," JavaScript")))}try{On.displayName="Experiment_",On.__docgenInfo={description:"",displayName:"Experiment_",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:'number | "new"'}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/Experiment.tsx#Experiment_"]={docgenInfo:On.__docgenInfo,name:"Experiment_",path:"frontend/src/scenes/experiments/Experiment.tsx#Experiment_"})}catch(a){}},"./frontend/src/scenes/experiments/experimentsLogic.ts":function(me,L,t){"use strict";t.d(L,"a",function(){return Fe});var X=t("./node_modules/core-js/modules/es.array.concat.js"),q=t.n(X),we=t("./node_modules/core-js/modules/es.array.filter.js"),Ce=t.n(we),Se=t("./node_modules/core-js/modules/es.array.iterator.js"),He=t.n(Se),Xe=t("./node_modules/core-js/modules/es.array.map.js"),he=t.n(Xe),e=t("./node_modules/core-js/modules/es.object.to-string.js"),l=t.n(e),Ye=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Ee=t.n(Ye),O=t("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),$e=t.n(O),Q=t("./node_modules/@babel/runtime/regenerator/index.js"),R=t.n(Q),F=t("./node_modules/regenerator-runtime/runtime.js"),y=t.n(F),E=t("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),re=t.n(E),_e=t("./node_modules/kea/lib/index.esm.js"),pe=t("./frontend/src/lib/api.ts"),Ge=t("./frontend/src/scenes/teamLogic.ts"),w=t("./frontend/src/types.ts"),H=t("./frontend/src/lib/utils.tsx"),ae=t("./frontend/src/scenes/userLogic.ts"),ye=t("./frontend/src/lib/components/lemonToast.tsx"),Fe=Object(_e.kea)({path:["scenes","experiments","experimentsLogic"],connect:{values:[Ge.a,["currentTeamId"],ae.a,["hasAvailableFeature"]]},actions:{},loaders:function(Je){var tt=Je.values,s=Je.actions;return{experiments:[[],{loadExperiments:function(){var G=re()(R.a.mark(function Le(le){var Ke;return R.a.wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:if(tt.hasAvailableFeature(w.c.EXPERIMENTATION)){Ze.next=2;break}return Ze.abrupt("return",[]);case 2:return Ze.next=4,pe.b.get("api/projects/".concat(tt.currentTeamId,"/experiments?").concat(le||""));case 4:return Ke=Ze.sent,Ze.abrupt("return",Ke.results);case 6:case"end":return Ze.stop()}},Le)}));function n(Le){return G.apply(this,arguments)}return n}(),deleteExperiment:function(){var G=re()(R.a.mark(function Le(le){return R.a.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,pe.b.delete("api/projects/".concat(tt.currentTeamId,"/experiments/").concat(le));case 2:return ye.a.info("Experiment removed"),x.abrupt("return",tt.experiments.filter(function(Ze){return Ze.id!==le}));case 4:case"end":return x.stop()}},Le)}));function n(Le){return G.apply(this,arguments)}return n}(),addToExperiments:function(n){return[].concat($e()(tt.experiments),[n])},updateExperiments:function(n){return tt.experiments.map(function(Le){return Le.id===n.id?n:Le})}}],tab:[w.h.All,{setExperimentsFilters:function(){var G=re()(R.a.mark(function Le(le){var Ke,x;return R.a.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return Ke=le.tab,x=Ke===w.h.Yours?Object(H.yb)({user:!0}):Object(H.yb)({archived:!0}),Ke===w.h.All?s.loadExperiments(Object(H.yb)({all:!0})):s.loadExperiments(x),jt.abrupt("return",Ke);case 4:case"end":return jt.stop()}},Le)}));function n(Le){return G.apply(this,arguments)}return n}()}]}},events:function(Je){var tt=Je.actions;return{afterMount:function(){tt.loadExperiments(Object(H.yb)({all:!0}))}}}})},"./frontend/src/scenes/insights/InsightContainer.tsx":function(me,L,t){"use strict";t.d(L,"a",function(){return fa});var X=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),q=t.n(X),we=t("./node_modules/antd/es/card/index.js"),Ce=t("./node_modules/antd/es/row/index.js"),Se=t("./node_modules/antd/es/col/index.js"),He=t("./node_modules/core-js/modules/es.array.includes.js"),Xe=t("./node_modules/core-js/modules/es.string.includes.js"),he=t("./node_modules/react/index.js"),e=t.n(he),l=t("./node_modules/kea/lib/index.esm.js"),Ye=t("./node_modules/antd/es/tag/index.js"),Ee=t("./node_modules/antd/es/select/index.js"),O=t("./frontend/src/lib/components/ChartFilter/chartFilterLogic.ts"),$e=t("./node_modules/@ant-design/icons/es/icons/OrderedListOutlined.js"),Q=t("./node_modules/@ant-design/icons/es/icons/LineChartOutlined.js"),R=t("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),F={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm-616-64h536c4.4 0 8-3.6 8-8V284c0-7.2-8.7-10.7-13.7-5.7L592 488.6l-125.4-124a8.03 8.03 0 00-11.3 0l-189 189.6a7.87 7.87 0 00-2.3 5.6V720c0 4.4 3.6 8 8 8z"}}]},name:"area-chart",theme:"outlined"},y=F,E=t("./node_modules/@ant-design/icons/es/components/AntdIcon.js"),re=function(c,u){return he.createElement(E.a,Object(R.a)(Object(R.a)({},c),{},{ref:u,icon:y}))};re.displayName="AreaChartOutlined";var _e=he.forwardRef(re),pe=t("./node_modules/@ant-design/icons/es/icons/BarChartOutlined.js"),Ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 208H676V232h212v136zm0 224H676V432h212v160zM412 432h200v160H412V432zm200-64H412V232h200v136zm-476 64h212v160H136V432zm0-200h212v136H136V232zm0 424h212v136H136V656zm276 0h200v136H412V656zm476 136H676V656h212v136z"}}]},name:"table",theme:"outlined"},w=Ge,H=function(c,u){return he.createElement(E.a,Object(R.a)(Object(R.a)({},c),{},{ref:u,icon:w}))};H.displayName="TableOutlined";var ae=he.forwardRef(H),ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 518H506V160c0-4.4-3.6-8-8-8h-26a398.46 398.46 0 00-282.8 117.1 398.19 398.19 0 00-85.7 127.1A397.61 397.61 0 0072 552a398.46 398.46 0 00117.1 282.8c36.7 36.7 79.5 65.6 127.1 85.7A397.61 397.61 0 00472 952a398.46 398.46 0 00282.8-117.1c36.7-36.7 65.6-79.5 85.7-127.1A397.61 397.61 0 00872 552v-26c0-4.4-3.6-8-8-8zM705.7 787.8A331.59 331.59 0 01470.4 884c-88.1-.4-170.9-34.9-233.2-97.2C174.5 724.1 140 640.7 140 552c0-88.7 34.5-172.1 97.2-234.8 54.6-54.6 124.9-87.9 200.8-95.5V586h364.3c-7.7 76.3-41.3 147-96.6 201.8zM952 462.4l-2.6-28.2c-8.5-92.1-49.4-179-115.2-244.6A399.4 399.4 0 00589 74.6L560.7 72c-4.7-.4-8.7 3.2-8.7 7.9V464c0 4.4 3.6 8 8 8l384-1c4.7 0 8.4-4 8-8.6zm-332.2-58.2V147.6a332.24 332.24 0 01166.4 89.8c45.7 45.6 77 103.6 90 166.1l-256.4.7z"}}]},name:"pie-chart",theme:"outlined"},Fe=ye,ft=function(c,u){return he.createElement(E.a,Object(R.a)(Object(R.a)({},c),{},{ref:u,icon:Fe}))};ft.displayName="PieChartOutlined";var Je=he.forwardRef(ft),tt=t("./node_modules/@ant-design/icons/es/icons/GlobalOutlined.js"),s=t("./frontend/src/types.ts"),G=t("./frontend/src/lib/utils.tsx"),n=t("./frontend/src/scenes/insights/insightLogic.ts"),Le=t("./frontend/src/scenes/insights/ActionFilter/entityFilterLogic.ts"),le=t("./frontend/src/lib/components/Tooltip.tsx");function Ke(m){var c=m.filters,u=m.onChange,p=m.disabled,S=Object(l.useValues)(n.c),h=S.insightProps,j=Object(l.useValues)(Object(O.a)(h)),D=j.chartFilter,M=Object(l.useActions)(Object(O.a)(h)),A=M.setChartFilter,I=c.insight===s.s.STICKINESS||c.insight===s.s.RETENTION,N=c.insight===s.s.RETENTION||c.insight===s.s.STICKINESS,U=c.insight===s.s.RETENTION||c.insight===s.s.STICKINESS||!!c.breakdown&&c.breakdown!=="$geoip_country_code"&&c.breakdown!=="$geoip_country_name"||Object(Le.c)(c).length>1,_=c.insight===s.s.RETENTION,ee=_||c.insight===s.s.STICKINESS||c.insight===s.s.RETENTION,ce=c.insight===s.s.RETENTION?s.d.ActionsTable:c.insight===s.s.FUNNELS?s.d.FunnelViz:s.d.ActionsLineGraph;function W(ne){var de=ne.icon,xe=ne.tooltip,ue=ne.children,be=ue===void 0?null:ue;return e.a.createElement(le.a,{title:xe,placement:"left"},e.a.createElement("div",{style:{width:"100%"}},de," ",be))}function Be(ne){var de=ne.children,xe=de===void 0?null:de;return e.a.createElement(Ye.a,{color:"orange",style:{marginLeft:8,fontSize:10}},xe)}var ge=c.insight===s.s.FUNNELS?[{value:s.o.Steps,label:e.a.createElement(W,{icon:e.a.createElement($e.a,null)},"Steps")},{value:s.o.Trends,label:e.a.createElement(W,{icon:e.a.createElement(Q.a,null)},"Trends",e.a.createElement(Be,null,"BETA"))}]:[{label:"Line Chart",options:[{value:s.d.ActionsLineGraph,label:e.a.createElement(W,{icon:e.a.createElement(Q.a,null)},"Linear")},{value:s.d.ActionsLineGraphCumulative,label:e.a.createElement(W,{icon:e.a.createElement(_e,null)},"Cumulative"),disabled:I}]},{label:"Bar Chart",options:[{value:s.d.ActionsBar,label:e.a.createElement(W,{icon:e.a.createElement(pe.a,null)},"Time"),disabled:_},{value:s.d.ActionsBarValue,label:e.a.createElement(W,{icon:e.a.createElement(pe.a,null)},"Value"),disabled:ee}]},{value:s.d.ActionsTable,label:e.a.createElement(W,{icon:e.a.createElement(ae,null)},"Table")},{value:s.d.ActionsPie,label:e.a.createElement(W,{icon:e.a.createElement(Je,null)},"Pie"),disabled:N},{value:s.d.WorldMap,label:e.a.createElement(W,{icon:e.a.createElement(tt.a,null),tooltip:"Visualize data by country. Only works with one series at a time."},"World Map"),disabled:U}];return e.a.createElement(Ee.a,{key:"2",defaultValue:c.display||ce,value:D||ce,onChange:function(de){A(de),u==null||u(de)},bordered:!0,dropdownAlign:G.a.bottomRight,dropdownMatchSelectWidth:!1,listHeight:288,"data-attr":"chart-filter",disabled:p,options:ge})}try{Ke.displayName="ChartFilter",Ke.__docgenInfo={description:"",displayName:"ChartFilter",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((chartFilter: ChartDisplayType | FunnelVizType) => void)"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/ChartFilter/ChartFilter.tsx#ChartFilter"]={docgenInfo:Ke.__docgenInfo,name:"ChartFilter",path:"frontend/src/lib/components/ChartFilter/ChartFilter.tsx#ChartFilter"})}catch(m){}var x=t("./node_modules/antd/es/checkbox/index.js"),Ze=t("./frontend/src/lib/components/CompareFilter/compareFilterLogic.ts");function jt(){var m=Object(l.useValues)(n.c),c=m.insightProps,u=Object(l.useValues)(Object(Ze.a)(c)),p=u.compare,S=u.disabled,h=Object(l.useActions)(Object(Ze.a)(c)),j=h.setCompare;return S?null:e.a.createElement(x.a,{onChange:function(M){j(M.target.checked)},checked:p,style:{marginLeft:8,marginRight:6},disabled:S},"Compare",e.a.createElement("span",{className:"hide-lte-md"}," to previous"))}var Ht=t("./node_modules/core-js/modules/es.array.map.js"),Qt=t("./node_modules/core-js/modules/es.object.entries.js"),mt=t("./node_modules/@babel/runtime/helpers/slicedToArray.js"),wt=t.n(mt),rn=t("./node_modules/core-js/modules/es.array.iterator.js"),sn=t("./node_modules/core-js/modules/es.object.to-string.js"),dt=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Z=t("./frontend/src/scenes/insights/sharedUtils.ts");function fe(m,c){var u=Object.keys(m);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(m);c&&(p=p.filter(function(S){return Object.getOwnPropertyDescriptor(m,S).enumerable})),u.push.apply(u,p)}return u}function je(m){for(var c=1;c<arguments.length;c++){var u=arguments[c]!=null?arguments[c]:{};c%2?fe(Object(u),!0).forEach(function(p){q()(m,p,u[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(u)):fe(Object(u)).forEach(function(p){Object.defineProperty(m,p,Object.getOwnPropertyDescriptor(u,p))})}return m}var Ae=Object(l.kea)({props:{},key:Object(Z.c)("new"),path:function(c){return["lib","components","IntervalFilter","intervalFilterLogic",c]},connect:function(c){return{actions:[Object(n.c)(c),["setFilters"]],values:[Object(n.c)(c),["filters"]]}},actions:function(){return{setInterval:function(u){return{interval:u}}}},listeners:function(c){var u=c.values,p=c.actions;return{setInterval:function(h){var j=h.interval;Object(G.mb)(j,u.filters.interval)||p.setFilters(je(je({},u.filters),{},{interval:j}))}}},selectors:{interval:[function(m){return[m.filters]},function(m){return m==null?void 0:m.interval}]}}),nt=t("./node_modules/@ant-design/icons/es/icons/CalendarOutlined.js"),Ue={hour:{label:"Hour",newDateFrom:"dStart"},day:{label:"Day",newDateFrom:void 0},week:{label:"Week",newDateFrom:"-30d"},month:{label:"Month",newDateFrom:"-90d"}};function st(m){var c=m.disabled,u=Object(l.useValues)(n.c),p=u.insightProps,S=Object(l.useValues)(Ae(p)),h=S.interval,j=Object(l.useActions)(Ae(p)),D=j.setInterval,M=Object.entries(Ue).map(function(A){var I=wt()(A,2),N=I[0],U=I[1].label;return{key:N,value:N,label:N===h?e.a.createElement(e.a.Fragment,null,e.a.createElement(nt.a,null)," ",U):U}});return e.a.createElement(Ee.a,{bordered:!0,disabled:c,defaultValue:h||"day",value:h||void 0,dropdownMatchSelectWidth:!1,onChange:D,"data-attr":"interval-filter",options:M})}try{st.displayName="IntervalFilter",st.__docgenInfo={description:"",displayName:"IntervalFilter",props:{view:{defaultValue:null,description:"",name:"view",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/IntervalFilter/IntervalFilter.tsx#IntervalFilter"]={docgenInfo:st.__docgenInfo,name:"IntervalFilter",path:"frontend/src/lib/components/IntervalFilter/IntervalFilter.tsx#IntervalFilter"})}catch(m){}var Nt=t("./node_modules/@ant-design/icons/es/icons/FundOutlined.js"),We=t("./frontend/src/lib/components/SmoothingFilter/smoothings.ts");function K(m,c){var u=Object.keys(m);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(m);c&&(p=p.filter(function(S){return Object.getOwnPropertyDescriptor(m,S).enumerable})),u.push.apply(u,p)}return u}function Ut(m){for(var c=1;c<arguments.length;c++){var u=arguments[c]!=null?arguments[c]:{};c%2?K(Object(u),!0).forEach(function(p){q()(m,p,u[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(u)):K(Object(u)).forEach(function(p){Object.defineProperty(m,p,Object.getOwnPropertyDescriptor(u,p))})}return m}function At(){var m=Object(l.useValues)(n.c),c=m.filters,u=Object(l.useActions)(n.c),p=u.setFilters,S=c.interval,h=c.smoothing_intervals;if(!S)return null;var j=We.a[S].map(function(D){var M=D.value,A=D.label;return{value:M,label:M===h?e.a.createElement(e.a.Fragment,null,e.a.createElement(Nt.a,null)," ",A):A}});return j.length?e.a.createElement(Ee.a,{key:S,bordered:!0,value:h||1,dropdownMatchSelectWidth:!1,onChange:function(M){p(Ut(Ut({},c),{},{smoothing_intervals:M}))},"data-attr":"smoothing-filter",options:j}):e.a.createElement(e.a.Fragment,null)}var oe=t("./frontend/src/lib/constants.tsx"),bt=t("./node_modules/@babel/runtime/helpers/extends.js"),P=t.n(bt),ut=t("./frontend/src/scenes/insights/InsightDateFilter/insightDateFilterLogic.ts"),Oe=t("./frontend/src/lib/components/DateFilter/DateFilter.tsx");function lt(m){var c=Object(l.useValues)(n.c),u=c.insightProps,p=Object(l.useValues)(Object(ut.a)(u)),S=p.dates,h=S.dateFrom,j=S.dateTo,D=Object(l.useActions)(Object(ut.a)(u)),M=D.setDates;return e.a.createElement(Oe.a,P()({},m,{dateFrom:h!=null?h:void 0,dateTo:j!=null?j:void 0,onChange:function(I,N){var U;M(I,N),(U=m.onChange)===null||U===void 0||U.call(m,I,N)}}))}try{lt.displayName="InsightDateFilter",lt.__docgenInfo={description:"",displayName:"InsightDateFilter",props:{defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!0,type:{name:"string"}},showCustom:{defaultValue:null,description:"",name:"showCustom",required:!1,type:{name:"boolean"}},bordered:{defaultValue:null,description:"",name:"bordered",required:!1,type:{name:"boolean"}},makeLabel:{defaultValue:null,description:"",name:"makeLabel",required:!1,type:{name:"((key: ReactNode) => ReactNode)"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((fromDate: string, toDate: string) => void)"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},getPopupContainer:{defaultValue:null,description:"",name:"getPopupContainer",required:!1,type:{name:"((props: any) => HTMLElement)"}},dateOptions:{defaultValue:null,description:"",name:"dateOptions",required:!1,type:{name:"Record<string, dateMappingOption>"}},isDateFormatted:{defaultValue:null,description:"",name:"isDateFormatted",required:!1,type:{name:"boolean"}},selectProps:{defaultValue:null,description:"",name:"selectProps",required:!1,type:{name:"SelectProps<any>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightDateFilter/InsightDateFilter.tsx#InsightDateFilter"]={docgenInfo:lt.__docgenInfo,name:"InsightDateFilter",path:"frontend/src/scenes/insights/InsightDateFilter/InsightDateFilter.tsx#InsightDateFilter"})}catch(m){}var Ft=t("./node_modules/rc-picker/lib/generate/dayjs.js"),De=t.n(Ft),vt=t("./node_modules/antd/lib/date-picker/generatePicker/index.js"),qe=t.n(vt),ve=t("./frontend/src/scenes/retention/retentionTableLogic.ts"),Pe=t("./frontend/src/lib/dayjs.ts"),gt=qe()(De.a);function Rt(m){var c=m.disabled,u=Object(l.useValues)(n.c),p=u.insightProps,S=Object(l.useValues)(Object(ve.e)(p)),h=S.filters,j=Object(l.useActions)(Object(ve.e)(p)),D=j.setFilters,M=h.date_to&&Object(Pe.a)(h.date_to).year()!==Object(Pe.a)().year()?", YYYY":"";return e.a.createElement(e.a.Fragment,null,e.a.createElement(le.a,{title:"Cohorts up to this end date"},e.a.createElement("span",{style:{maxWidth:100,display:"inline-flex",alignItems:"center"}},e.a.createElement(nt.a,null),e.a.createElement(gt,{showTime:h.period==="Hour",use12Hours:!0,format:h.period==="Hour"?"MMM D".concat(M,", h a"):"MMM D".concat(M),value:h.date_to?Object(Pe.a)(h.date_to):void 0,onChange:function(I){return D({date_to:I&&Object(Pe.a)(I).toISOString()})},allowClear:!0,placeholder:"Today",className:"retention-date-picker",suffixIcon:null,disabled:c}))))}try{Rt.displayName="RetentionDatePicker",Rt.__docgenInfo={description:"",displayName:"RetentionDatePicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/RetentionDatePicker.tsx#RetentionDatePicker"]={docgenInfo:Rt.__docgenInfo,name:"RetentionDatePicker",path:"frontend/src/scenes/insights/RetentionDatePicker.tsx#RetentionDatePicker"})}catch(m){}var Ve=t("./frontend/src/scenes/funnels/funnelLogic.ts"),Wt=t("./node_modules/@ant-design/icons/es/icons/FunnelPlotOutlined.js");function _t(m){var c=m.disabled,u=Object(l.useValues)(n.c),p=u.insightProps,S=Object(l.useValues)(Object(Ve.a)(p)),h=S.barGraphLayout,j=Object(l.useActions)(Object(Ve.a)(p)),D=j.setFilters,M=[{value:oe.k.vertical,icon:e.a.createElement(pe.a,null),label:"Left to right"},{value:oe.k.horizontal,icon:e.a.createElement(Wt.a,null),label:"Top to bottom"}];return e.a.createElement(Ee.a,{defaultValue:oe.k.vertical,value:h||oe.k.vertical,onChange:function(I){return D({layout:I})},bordered:!0,dropdownMatchSelectWidth:!1,"data-attr":"funnel-bar-layout-selector",optionLabelProp:"label",disabled:c},e.a.createElement(Ee.a.OptGroup,{label:"Graph display options"},M.map(function(A){return e.a.createElement(Ee.a.Option,{key:A.value,value:A.value,label:e.a.createElement(e.a.Fragment,null,A.icon," ",A.label)},A.label)})))}try{_t.displayName="FunnelDisplayLayoutPicker",_t.__docgenInfo={description:"",displayName:"FunnelDisplayLayoutPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightTabs/FunnelTab/FunnelDisplayLayoutPicker.tsx#FunnelDisplayLayoutPicker"]={docgenInfo:_t.__docgenInfo,name:"FunnelDisplayLayoutPicker",path:"frontend/src/scenes/insights/InsightTabs/FunnelTab/FunnelDisplayLayoutPicker.tsx#FunnelDisplayLayoutPicker"})}catch(m){}var hn=t("./node_modules/core-js/modules/es.array.filter.js"),wn=t("./node_modules/core-js/modules/es.array.from.js"),k=t("./node_modules/core-js/modules/es.array.slice.js"),Zt=t("./node_modules/core-js/modules/es.string.iterator.js"),qt=t("./node_modules/@ant-design/icons/es/icons/BarsOutlined.js"),ln=t("./frontend/src/scenes/paths/pathsLogic.ts"),on=t("./frontend/src/scenes/userLogic.ts");function ht(m){var c,u=m.disabled,p=Object(l.useValues)(n.c),S=p.insightProps,h=Object(l.useValues)(Object(ln.b)(S)),j=h.filter,D=Object(l.useActions)(Object(ln.b)(S)),M=D.setFilter,A=Object(l.useValues)(on.a),I=A.user,N=2,U=!(I==null||(c=I.organization)===null||c===void 0)&&c.available_features.includes(s.c.PATHS_ADVANCED)?20:5,_=Array.from(Array.from(Array.from(Array(U+1).keys()).slice(N)),function(ee){return{label:"".concat(ee," Steps"),value:ee}});return e.a.createElement(Ee.a,{id:"path-step-filter","data-attr":"path-step-filter",defaultValue:5,value:j.step_limit||ln.a,onSelect:function(ce){return M({step_limit:ce})},listHeight:440,bordered:!1,dropdownMatchSelectWidth:!0,dropdownAlign:G.a.bottomRight,optionLabelProp:"label",disabled:u},_.map(function(ee){return e.a.createElement(Ee.a.Option,{key:ee.value,value:ee.value,label:e.a.createElement(e.a.Fragment,null,e.a.createElement(qt.a,null)," ",ee.label)},ee.label)}))}try{ht.displayName="PathStepPicker",ht.__docgenInfo={description:"",displayName:"PathStepPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightTabs/PathTab/PathStepPicker.tsx#PathStepPicker"]={docgenInfo:ht.__docgenInfo,name:"PathStepPicker",path:"frontend/src/scenes/insights/InsightTabs/PathTab/PathStepPicker.tsx#PathStepPicker"})}catch(m){}var Sn=t("./node_modules/@ant-design/icons/es/icons/PercentageOutlined.js");function kt(m){var c=m.disabled,u=Object(l.useValues)(n.c),p=u.insightProps,S=Object(l.useValues)(Object(ve.e)(p)),h=S.retentionReference,j=Object(l.useActions)(Object(ve.e)(p)),D=j.setRetentionReference;return e.a.createElement(Ee.a,{value:h,onChange:D,bordered:!1,dropdownMatchSelectWidth:!1,"data-attr":"reference-selector",optionLabelProp:"label",disabled:c},[{value:"total",icon:e.a.createElement(Sn.a,null),label:"Overall cohort"},{value:"previous",icon:e.a.createElement(Sn.a,null),label:"Relative to previous period"}].map(function(M){return e.a.createElement(Ee.a.Option,{key:M.value,value:M.value,label:e.a.createElement(e.a.Fragment,null,M.icon," ",M.label)},M.label)}))}try{kt.displayName="ReferencePicker",kt.__docgenInfo={description:"",displayName:"ReferencePicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightTabs/RetentionTab/ReferencePicker.tsx#ReferencePicker"]={docgenInfo:kt.__docgenInfo,name:"ReferencePicker",path:"frontend/src/scenes/insights/InsightTabs/RetentionTab/ReferencePicker.tsx#ReferencePicker"})}catch(m){}var cn=t("./node_modules/antd/es/tooltip/index.js"),Te=t("./node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),J=t("./node_modules/core-js/modules/es.array.concat.js"),ot=t("./node_modules/core-js/modules/es.set.js"),En=t("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),Dt=t.n(En),Zn=t("./node_modules/antd/es/input-number/index.js"),dn=t("./node_modules/clsx/dist/clsx.m.js"),en=0,_n=90,Vn=new Set([5,15,25,50,90]),Ea=[{label:"Auto bins",value:oe.a,display:!0}].concat(Dt()(Array.from(Array.from(Array(_n+1).keys()),function(m){return{label:"".concat(m," bins"),value:m,display:Vn.has(m)}})),[{label:"Custom",value:"custom",display:!0}]);function Pn(m){var c=m.disabled,u=Object(l.useValues)(n.c),p=u.insightProps,S=Object(l.useValues)(Object(Ve.a)(p)),h=S.filters,j=S.numericBinCount,D=Object(l.useActions)(Object(Ve.a)(p)),M=D.setBinCount;return e.a.createElement(Ee.a,{id:"funnel-bin-filter",dropdownClassName:"funnel-bin-filter-dropdown","data-attr":"funnel-bin-filter",defaultValue:oe.a,value:h.bin_count||oe.a,onSelect:function(I){return M(I)},dropdownRender:function(I){return e.a.createElement(e.a.Fragment,null,I,e.a.createElement("div",null,e.a.createElement(Zn.a,{className:"funnel-bins-custom-picker",size:"middle",min:en,max:_n,value:j,onChange:function(U){var _=typeof U=="string"?parseInt(U):U;_&&M(_)}})," ","bins"))},listHeight:440,bordered:!1,dropdownMatchSelectWidth:!1,dropdownAlign:G.a.bottomRight,optionLabelProp:"label",disabled:c},e.a.createElement(Ee.a.OptGroup,{label:"Bin Count"},Ea.map(function(A){return A.value==="custom"?null:e.a.createElement(Ee.a.Option,{className:Object(dn.a)({"select-option-hidden":!A.display}),key:A.value,value:A.value,label:e.a.createElement(e.a.Fragment,null,e.a.createElement(pe.a,null)," ",A.label)},A.label)})))}try{Pn.displayName="FunnelBinsPicker",Pn.__docgenInfo={description:"",displayName:"FunnelBinsPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightTabs/FunnelTab/FunnelBinsPicker.tsx#FunnelBinsPicker"]={docgenInfo:Pn.__docgenInfo,name:"FunnelBinsPicker",path:"frontend/src/scenes/insights/InsightTabs/FunnelTab/FunnelBinsPicker.tsx#FunnelBinsPicker"})}catch(m){}var Ot=t("./frontend/src/lib/logic/featureFlagLogic.ts"),Vt,zt,Gt=function(c,u){switch(c){case s.s.FUNNELS:return u.funnel_viz_type===s.o.Trends;case s.s.RETENTION:case s.s.PATHS:return!1;case s.s.TRENDS:case s.s.STICKINESS:case s.s.LIFECYCLE:default:return!u.display||!oe.m.includes(u.display)}},Tn=function(c){switch(c){case s.s.TRENDS:case s.s.STICKINESS:return!0;case s.s.RETENTION:case s.s.FUNNELS:return!1;case s.s.LIFECYCLE:case s.s.PATHS:return!1;default:return!0}},qn=(Vt={},q()(Vt,"".concat(s.s.TRENDS),!0),q()(Vt,"".concat(s.s.STICKINESS),!0),q()(Vt,"".concat(s.s.LIFECYCLE),!0),q()(Vt,"".concat(s.s.FUNNELS),!0),q()(Vt,"".concat(s.s.RETENTION),!1),q()(Vt,"".concat(s.s.PATHS),!0),Vt),ya=(zt={},q()(zt,"".concat(s.s.TRENDS),!0),q()(zt,"".concat(s.s.STICKINESS),!0),q()(zt,"".concat(s.s.LIFECYCLE),!1),q()(zt,"".concat(s.s.FUNNELS),!1),q()(zt,"".concat(s.s.RETENTION),!1),q()(zt,"".concat(s.s.PATHS),!1),zt),ba=function(c){var u,p;return!c.actions&&!c.events||((u=c.actions)===null||u===void 0?void 0:u.length)===0&&((p=c.events)===null||p===void 0?void 0:p.length)===0};function In(m){var c=m.filters,u=m.activeView,p=m.disableTable,S=m.disabled,h=u===s.s.FUNNELS,j=u===s.s.PATHS,D=Object(l.useValues)(Ot.a),M=D.featureFlags;return e.a.createElement("div",{className:"display-config-inner"},e.a.createElement("div",{className:"display-config-inner-row"},qn[u]&&!p&&e.a.createElement("span",{className:"filter"},e.a.createElement("span",{className:"head-title-item"},"Date range"),e.a.createElement(lt,{defaultValue:"Last 7 days",disabled:S||h&&ba(c),bordered:!0,makeLabel:function(I){return e.a.createElement(e.a.Fragment,null,e.a.createElement(nt.a,null)," ",I,I=="All time"&&e.a.createElement(cn.a,{title:"Only events dated after 2015 will be shown"},e.a.createElement(Te.a,{className:"info-indicator"})))}})),Gt(u,c)&&e.a.createElement("span",{className:"filter"},e.a.createElement("span",{className:"head-title-item"},e.a.createElement("span",{className:"hide-lte-md"},"grouped "),"by"),e.a.createElement(st,{view:u,disabled:S})),u===s.s.TRENDS&&!c.breakdown_type&&!c.compare&&(!c.display||c.display===s.d.ActionsLineGraph)&&M[oe.i.SMOOTHING_INTERVAL]?e.a.createElement(At,null):null,u===s.s.RETENTION&&e.a.createElement(e.a.Fragment,null,e.a.createElement(Rt,{disabled:S}),e.a.createElement(kt,{disabled:S})),j&&e.a.createElement("span",{className:"filter"},e.a.createElement(ht,{disabled:S})),ya[u]&&e.a.createElement("span",{className:"filter"},e.a.createElement(jt,null))),e.a.createElement("div",{className:"display-config-inner-row"},Tn(u)&&e.a.createElement("span",{className:"filter"},e.a.createElement("span",{className:"head-title-item"},"Chart type"),e.a.createElement(Ke,{filters:c,disabled:S||c.insight===s.s.LIFECYCLE})),h&&c.funnel_viz_type===s.o.Steps&&e.a.createElement(e.a.Fragment,null,e.a.createElement("span",{className:"filter"},e.a.createElement(_t,{disabled:S}))),h&&c.funnel_viz_type===s.o.TimeToConvert&&e.a.createElement("span",{className:"filter"},e.a.createElement(Pn,{disabled:S}))))}try{In.displayName="InsightDisplayConfig",In.__docgenInfo={description:"",displayName:"InsightDisplayConfig",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},activeView:{defaultValue:null,description:"",name:"activeView",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}},insightMode:{defaultValue:null,description:"",name:"insightMode",required:!0,type:{name:"enum",value:[{value:'"edit"'},{value:'"view"'}]}},disableTable:{defaultValue:null,description:"",name:"disableTable",required:!0,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightTabs/InsightDisplayConfig.tsx#InsightDisplayConfig"]={docgenInfo:In.__docgenInfo,name:"InsightDisplayConfig",path:"frontend/src/scenes/insights/InsightTabs/InsightDisplayConfig.tsx#InsightDisplayConfig"})}catch(m){}var tn=t("./node_modules/antd/es/button/index.js"),Oa=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),yn=t.n(Oa),xa=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/funnels/FunnelCanvasLabel.scss"),Bn=t.n(xa),Kn={};Kn.insert="head",Kn.singleton=!1;var Nn=yn()(Bn.a,Kn),Un=Bn.a.locals||{},Ct=t("./frontend/src/scenes/funnels/funnelUtils.ts"),ja=t("./node_modules/core-js/modules/es.array.find.js"),bn=t("./frontend/src/lib/components/EntityFilterInfo.tsx");function ea(){var m,c=Object(l.useValues)(n.c),u=c.insightProps,p=Object(l.useValues)(Object(Ve.a)(u)),S=p.filters,h=p.numberOfSeries,j=p.areFiltersValid,D=p.filterSteps,M=Object(l.useActions)(Object(Ve.a)(u)),A=M.changeStepRange;if(S.funnel_viz_type===s.o.Steps)return null;var I=function(ce,W){A(ce,W)},N=j?Array.from(Array(Math.max(h)).keys()).slice(0,-1):[0],U=j?Array.from(Array(Math.max(h)).keys()).slice(((m=S.funnel_from_step)!==null&&m!==void 0?m:0)+1):[1],_=function(ce){return ce.map(function(W){var Be=D.find(function(ge){return ge.order===W});return Be?e.a.createElement(Ee.a.Option,{key:W,value:W,label:"Step ".concat(W+1)},e.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},e.a.createElement("span",{style:{marginRight:4}},"Step ",W+1,":"),e.a.createElement(bn.a,{filter:Be}))):null})};return e.a.createElement(Ce.a,{className:"funnel-options-inputs"},e.a.createElement("span",{className:"text-muted-alt"},"from"),e.a.createElement(Ee.a,{disabled:!j,dropdownMatchSelectWidth:!1,dropdownAlign:G.a.bottomLeft,"data-attr":"funnel-header-steps-funnel_from_step-selector",optionLabelProp:"label",value:S.funnel_from_step||0,onChange:function(ce){return I(ce,S.funnel_to_step)},style:{marginLeft:4,marginRight:4}},_(N)),e.a.createElement("span",{className:"text-muted-alt"},"to"),e.a.createElement(Ee.a,{disabled:!j,dropdownMatchSelectWidth:!1,dropdownAlign:G.a.bottomLeft,"data-attr":"funnel-header-steps-funnel_to_step-selector",optionLabelProp:"label",value:S.funnel_to_step||Math.max(h-1,1),onChange:function(ce){return I(S.funnel_from_step,ce)},style:{marginLeft:4,marginRight:4}},_(U)))}function On(){var m=Object(l.useValues)(n.c),c=m.insightProps,u=m.filters,p=m.activeView,S=Object(l.useValues)(Object(Ve.a)(c)),h=S.conversionMetrics,j=S.aggregationTargetLabel,D=Object(l.useActions)(Object(O.a)(c)),M=D.setChartFilter;if(p!==s.s.FUNNELS)return null;var A=[].concat(Dt()(u.funnel_viz_type===s.o.Steps?[e.a.createElement(e.a.Fragment,null,e.a.createElement("span",{className:"text-muted-alt"},e.a.createElement(le.a,{title:"Overall conversion rate for all ".concat(j.plural," on the entire funnel.")},e.a.createElement(Te.a,{className:"info-indicator left"})),"Total conversion rate"),e.a.createElement("span",{className:"text-muted-alt mr-025"},":"),e.a.createElement("span",{className:"l4"},Object(Ct.c)(h.totalRate),"%"))]:[]),Dt()(u.funnel_viz_type!==s.o.Trends?[e.a.createElement(e.a.Fragment,null,e.a.createElement("span",{className:"text-muted-alt"},e.a.createElement(le.a,{title:"Average (arithmetic mean) of the total time each ".concat(j.singular," spent in the entire funnel.")},e.a.createElement(Te.a,{className:"info-indicator left"})),"Average time to convert"," "),u.funnel_viz_type===s.o.TimeToConvert&&e.a.createElement(ea,null),e.a.createElement("span",{className:"text-muted-alt mr-025"},":"),e.a.createElement(tn.a,{type:"link",onClick:function(){return M(s.o.TimeToConvert)},disabled:u.funnel_viz_type===s.o.TimeToConvert},e.a.createElement("span",{className:"l4"},Object(G.N)(h.averageTime))))]:[]),Dt()(u.funnel_viz_type===s.o.Trends?[e.a.createElement(e.a.Fragment,null,e.a.createElement("span",{className:"text-muted-alt"},"Conversion rate "),e.a.createElement(ea,null))]:[]));return e.a.createElement(Ce.a,{className:"funnel-canvas-label",align:"middle"},A.map(function(I,N){return e.a.createElement(e.a.Fragment,{key:N},N>0&&e.a.createElement("span",{style:{margin:"2px 8px",borderLeft:"1px solid var(--border)",height:14}}),I)}))}var ta=t("./frontend/src/lib/hooks/usePeriodicRerender.ts"),a=3;function r(){var m=Object(l.useValues)(n.c),c=m.lastRefresh,u=Object(l.useActions)(n.c),p=u.loadResults;return Object(ta.a)(15e3),e.a.createElement("div",{className:"text-muted-alt",style:{height:32,display:"flex",alignItems:"center"}},"Computed ",c?Object(Pe.a)(c).fromNow():"a while ago",e.a.createElement("span",{style:{padding:"0 4px"}},"\u2022"),e.a.createElement(cn.a,{title:e.a.createElement(e.a.Fragment,null,"Insights can be refreshed",e.a.createElement("br",null),"every ",a," minutes.")},e.a.createElement(tn.a,{size:"small",type:"link",onClick:function(){return p(!0)},disabled:!!c&&Object(Pe.a)().subtract(a-.5,"minutes").isBefore(c),style:{padding:0}},e.a.createElement("span",{style:{fontSize:14}},"Refresh"))))}var o=t("./frontend/src/scenes/trends/PersonsModal.tsx"),i=t("./frontend/src/scenes/trends/viz/index.ts"),g=t("./frontend/src/scenes/trends/SaveCohortModal.tsx"),C=t("./frontend/src/scenes/trends/trendsLogic.ts"),b=t("./frontend/src/scenes/insights/InsightsTable/InsightsTable.tsx");try{InsightsTable.displayName="InsightsTable",InsightsTable.__docgenInfo={description:"",displayName:"InsightsTable",props:{isLegend:{defaultValue:{value:"false"},description:"Whether this is just a legend instead of standalone insight viz. Default: false.",name:"isLegend",required:!1,type:{name:"boolean"}},embedded:{defaultValue:{value:"false"},description:"Whether this is table is embedded in another card or whether it should be a card of its own. Default: false.",name:"embedded",required:!1,type:{name:"boolean"}},showTotalCount:{defaultValue:{value:"false"},description:"",name:"showTotalCount",required:!1,type:{name:"boolean"}},filterKey:{defaultValue:null,description:"Key for the entityFilterLogic",name:"filterKey",required:!0,type:{name:"string"}},canEditSeriesNameInline:{defaultValue:{value:"false"},description:"",name:"canEditSeriesNameInline",required:!1,type:{name:"boolean"}},canCheckUncheckSeries:{defaultValue:{value:"true"},description:"(Un)checking series updates the insight via the API, so it should be disabled if updates aren't desired.",name:"canCheckUncheckSeries",required:!1,type:{name:"boolean"}},isMainInsightView:{defaultValue:{value:"false"},description:"",name:"isMainInsightView",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightsTable/index.tsx#InsightsTable"]={docgenInfo:InsightsTable.__docgenInfo,name:"InsightsTable",path:"frontend/src/scenes/insights/InsightsTable/index.tsx#InsightsTable"})}catch(m){}var d=t("./frontend/src/scenes/trends/personsModalLogic.ts"),T=t("./frontend/src/lib/utils/eventUsageLogic.ts"),f=t("./frontend/src/scenes/insights/insightSceneLogic.tsx"),te=t("./frontend/src/scenes/insights/WorldMap/index.ts");function se(m){var c=m.view,u=Object(l.useValues)(f.a),p=u.insightMode,S=Object(l.useValues)(n.c),h=S.insightProps,j=Object(l.useValues)(d.b),D=j.cohortModalVisible,M=Object(l.useActions)(d.b),A=M.setCohortModalVisible,I=Object(l.useValues)(Object(C.a)(h)),N=I.filters,U=I.loadMoreBreakdownUrl,_=I.breakdownValuesLoading,ee=I.showModalActions,ce=I.aggregationTargetLabel,W=Object(l.useActions)(Object(C.a)(h)),Be=W.loadMoreBreakdownValues,ge=Object(l.useValues)(d.b),ne=ge.showingPeople,de=Object(l.useActions)(d.b),xe=de.saveCohortWithUrl,ue=Object(l.useActions)(T.f),be=ue.reportCohortCreatedFromPersonsModal,Ie=function(){if(!N.display||N.display===s.d.ActionsLineGraph||N.display===s.d.ActionsLineGraphCumulative||N.display===s.d.ActionsBar)return e.a.createElement(i.b,null);if(N.display===s.d.ActionsTable)return e.a.createElement(l.BindLogic,{logic:C.a,props:{dashboardItemId:null,view:c,filters:null}},e.a.createElement(b.b,{embedded:!0,showTotalCount:!0,filterKey:"trends_".concat(c),canEditSeriesNameInline:p===s.t.Edit,isMainInsightView:!0}));if(N.display===s.d.ActionsPie)return e.a.createElement(i.c,null);if(N.display===s.d.ActionsBarValue)return e.a.createElement(i.a,null);if(N.display===s.d.WorldMap)return e.a.createElement(te.a,null)};return e.a.createElement(e.a.Fragment,null,(N.actions||N.events)&&e.a.createElement("div",{className:N.display!==s.d.ActionsTable&&N.display!==s.d.WorldMap?"trends-insights-container":void 0},Ie()),N.breakdown&&U&&e.a.createElement("div",{className:"mt text-center"},e.a.createElement("div",{className:"text-muted mb"},"For readability, ",e.a.createElement("b",null,"not all breakdown values are displayed"),". Click below to load them."),e.a.createElement("div",null,e.a.createElement(tn.a,{style:{textAlign:"center",marginBottom:16},onClick:Be,loading:_},"Load more breakdown values"))),e.a.createElement(o.a,{visible:ne&&!D,view:c,filters:N,onSaveCohort:function(){A(!0)},showModalActions:ee,aggregationTargetLabel:ce}),e.a.createElement(g.a,{visible:D,onOk:function(vn){xe(vn),A(!1),be(N)},onCancel:function(){return A(!1)}}))}try{se.displayName="TrendInsight",se.__docgenInfo={description:"",displayName:"TrendInsight",props:{view:{defaultValue:null,description:"",name:"view",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/trends/Trends.tsx#TrendInsight"]={docgenInfo:se.__docgenInfo,name:"TrendInsight",path:"frontend/src/scenes/trends/Trends.tsx#TrendInsight"})}catch(m){}var Re=t("./frontend/src/scenes/funnels/Funnel.tsx");function B(){var m=Object(l.useValues)(n.c),c=m.insightProps,u=Object(l.useValues)(Object(Ve.a)(c)),p=u.isValidFunnel,S=u.insightLoading,h=u.filters,j=u.areFiltersValid,D=u.barGraphLayout,M=u.aggregationTargetLabel,A=Object(l.useValues)(d.b),I=A.showingPeople,N=A.cohortModalVisible,U=Object(l.useActions)(d.b),_=U.setCohortModalVisible;return e.a.createElement(e.a.Fragment,null,e.a.createElement(o.a,{visible:I&&!N,view:s.s.FUNNELS,filters:h,onSaveCohort:function(){_(!0)},showModalActions:h.aggregation_group_type_index==null,aggregationTargetLabel:M}),e.a.createElement("div",{className:Object(dn.a)("funnel-insights-container",{"non-empty-state":p&&j||S,"no-padding":h.funnel_viz_type==s.o.Steps&&D===oe.k.vertical})},e.a.createElement(Re.a,null)))}var V=t("./frontend/src/scenes/retention/RetentionContainer.tsx"),v=t("./frontend/src/scenes/paths/Paths.tsx"),Me=t("./frontend/src/scenes/insights/EmptyStates/index.ts");function Mt(){var m=Object(l.useValues)(n.c),c=m.activeView;return c!==s.s.PATHS?null:e.a.createElement(Ce.a,{className:"funnel-canvas-label",align:"middle"},e.a.createElement(e.a.Fragment,null,e.a.createElement("span",{className:"text-muted-alt"},"Large path items are shown by default. View smaller items by hovering over a node")))}var Bt=t("./node_modules/@ant-design/icons/es/icons/CommentOutlined.js"),Jt=t("./node_modules/antd/lib/input/TextArea.js"),z=t.n(Jt),Xt=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/FunnelCorrelation.scss"),Yt=t.n(Xt),ie={};ie.insert="head",ie.singleton=!1;var at=yn()(Yt.a,ie),Lt=Yt.a.locals||{},$t=t("./node_modules/core-js/modules/es.number.constructor.js"),St=t("./node_modules/core-js/modules/es.number.is-integer.js"),it=t("./node_modules/core-js/modules/es.number.to-fixed.js"),Et=t("./node_modules/core-js/modules/es.regexp.exec.js"),Fn=t("./node_modules/core-js/modules/es.string.split.js"),Dn=t("./node_modules/antd/es/spin/index.js"),Wn=t("./node_modules/antd/es/table/index.js"),Ca=t("./node_modules/antd/lib/table/Column.js"),et=t.n(Ca),na=t("./node_modules/@ant-design/icons/es/icons/RiseOutlined.js"),Sa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M925.9 804l-24-199.2c-.8-6.6-8.9-9.4-13.6-4.7L829 659.5 557.7 388.3c-6.3-6.2-16.4-6.2-22.6 0L433.3 490 156.6 213.3a8.03 8.03 0 00-11.3 0l-45 45.2a8.03 8.03 0 000 11.3L422 591.7c6.2 6.3 16.4 6.3 22.6 0L546.4 490l226.1 226-59.3 59.3a8.01 8.01 0 004.7 13.6l199.2 24c5.1.7 9.5-3.7 8.8-8.9z"}}]},name:"fall",theme:"outlined"},Pt=Sa,un=function(c,u){return he.createElement(E.a,Object(R.a)(Object(R.a)({},c),{},{ref:u,icon:Pt}))};un.displayName="FallOutlined";var aa=he.forwardRef(un),ra=t("./node_modules/@ant-design/icons/es/icons/EllipsisOutlined.js"),Kt=t("./frontend/src/lib/components/icons.tsx"),Pa=t("./node_modules/antd/lib/checkbox/Checkbox.js"),xn=t.n(Pa),mn=t("./frontend/src/scenes/funnels/FunnelBarGraph.tsx"),pn=t("./frontend/src/lib/components/PropertyKeyInfo.tsx"),Ta=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/InsightTabs/FunnelTab/FunnelCorrelationTable.scss"),sa=t.n(Ta),kn={};kn.insert="head",kn.singleton=!1;var wa=yn()(sa.a,kn),_a=sa.a.locals||{},Ia=t("./frontend/src/lib/components/VisibilitySensor/visibilitySensorLogic.tsx");function nn(m){var c=m.id,u=m.offset,p=m.children,S=Object(l.useActions)(Object(Ia.a)({id:c,offset:u})),h=S.scrolling,j=Object(he.useRef)(null);return Object(he.useEffect)(function(){var D=j.current;return document.addEventListener("scroll",function(){return h(D)}),function(){return document.removeEventListener("scroll",function(){return h(D)})}},[j.current]),e.a.createElement("div",{ref:j},p)}try{nn.displayName="VisibilitySensor",nn.__docgenInfo={description:"",displayName:"VisibilitySensor",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},offset:{defaultValue:null,description:"",name:"offset",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/VisibilitySensor/VisibilitySensor.tsx#VisibilitySensor"]={docgenInfo:nn.__docgenInfo,name:"VisibilitySensor",path:"frontend/src/lib/components/VisibilitySensor/VisibilitySensor.tsx#VisibilitySensor"})}catch(m){}var an=t("./frontend/src/lib/components/LemonButton/index.ts"),la=t("./frontend/src/lib/components/Popup/Popup.tsx"),Na=t("./node_modules/antd/es/modal/index.js"),Fa=t("./node_modules/@ant-design/icons/es/icons/CheckCircleFilled.js"),oa=t("./node_modules/@ant-design/icons/es/icons/MinusCircleOutlined.js"),zn=t("./node_modules/@ant-design/icons/es/icons/CloseCircleOutlined.js"),Yn=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/InsightTabs/FunnelTab/CorrelationMatrix.scss"),ia=t.n(Yn),jn={};jn.insert="head",jn.singleton=!1;var Mn=yn()(ia.a,jn),Va=ia.a.locals||{},Da=t("./frontend/src/lib/components/Spinner/Spinner.tsx"),$n=t("./frontend/src/lib/components/Link.tsx"),Hn=t("./frontend/src/lib/components/InlineMessage/InlineMessage.tsx");function Ma(){var m=Object(l.useValues)(n.c),c=m.insightProps,u=Object(Ve.a)(c),p=Object(l.useValues)(u),S=p.correlationsLoading,h=p.funnelCorrelationDetails,j=p.parseDisplayNameForCorrelation,D=p.correlationMatrixAndScore,M=Object(l.useActions)(u),A=M.setFunnelCorrelationDetails,I=M.openCorrelationPersonsModal,N=(h==null?void 0:h.result_type)===s.k.Events?"event":"property",U=(h==null?void 0:h.result_type)===s.k.Events?"performed event":"have property",_=e.a.createElement(e.a.Fragment,null);if(h){var ee=j(h),ce=ee.first_value,W=ee.second_value;_=e.a.createElement(e.a.Fragment,null,e.a.createElement(pn.a,{value:ce}),W!==void 0&&e.a.createElement(e.a.Fragment,null," :: ",e.a.createElement(pn.a,{value:W,disablePopover:!0})))}var Be=D.correlationScore,ge=D.truePositive,ne=D.falsePositive,de=D.trueNegative,xe=D.falseNegative,ue=D.correlationScoreStrength,be=ue==="strong"?e.a.createElement(Fa.a,{style:{color:"var(--success)"}}):ue==="moderate"?e.a.createElement(oa.a,{style:{color:"var(--warning)"}}):e.a.createElement(zn.a,{style:{color:"var(--danger)"}}),Ie=function(){return A(null)};return e.a.createElement(Na.a,{className:"correlation-matrix",visible:!!h,onCancel:Ie,destroyOnClose:!0,footer:e.a.createElement(tn.a,{onClick:Ie},"Dismiss"),width:600,title:"Correlation details"},e.a.createElement("div",{className:"correlation-table-wrapper"},S?e.a.createElement("div",{className:"mt text-center"},e.a.createElement(Da.a,{size:"lg"})):h?e.a.createElement(e.a.Fragment,null,e.a.createElement("p",{className:"text-muted-alt mb"},"The table below displays the correlation details for users who ",U," ",e.a.createElement("b",null,_),"."),e.a.createElement("table",null,e.a.createElement("thead",null,e.a.createElement("tr",{className:"table-title"},e.a.createElement("td",{colSpan:3},"Results matrix")),e.a.createElement("tr",null,e.a.createElement("td",null,(h==null?void 0:h.result_type)===s.k.Events?"Performed event":"Has property"),e.a.createElement("td",null,"Success"),e.a.createElement("td",null,"Dropped off"))),e.a.createElement("tbody",null,e.a.createElement("tr",null,e.a.createElement("td",{className:"horizontal-header"},"Yes"),e.a.createElement("td",null,e.a.createElement(le.a,{title:"True positive (TP) - Percentage of users who ".concat(U," and completed the funnel.")},e.a.createElement("div",{className:"percentage"},ge?Object(G.ob)(ge/(ge+ne)):"0.00%")),ge===0?"0 users":e.a.createElement($n.a,{onClick:function(){I(h,!0)}},Object(G.qb)(ge,"user",void 0,!0,!0))),e.a.createElement("td",null,e.a.createElement("div",{className:"percentage"},e.a.createElement(le.a,{title:"False negative (FN) - Percentage of users who ".concat(U," and did not complete the funnel.")},xe?Object(G.ob)(xe/(xe+de)):"0.00%")),xe===0?"0 users":e.a.createElement($n.a,{onClick:function(){I(h,!1)}},Object(G.qb)(xe,"user",void 0,!0,!0)))),e.a.createElement("tr",null,e.a.createElement("td",{className:"horizontal-header"},"No"),e.a.createElement("td",null,e.a.createElement("div",{className:"percentage"},e.a.createElement(le.a,{title:"False positive (FP) - Percentage of users who did not ".concat(U," and completed the funnel.")},ne?Object(G.ob)(ne/(ge+ne)):"0.00%")),Object(G.qb)(ne,"user",void 0,!0,!0)),e.a.createElement("td",null,e.a.createElement("div",{className:"percentage"},e.a.createElement(le.a,{title:"True negative (TN) - Percentage of users who did not ".concat(U," and did not complete the funnel.")},de?Object(G.ob)(de/(xe+de)):"0.00%")),Object(G.qb)(de,"user",void 0,!0,!0))),e.a.createElement("tr",null,e.a.createElement("td",{className:"horizontal-header"}),e.a.createElement("td",null,e.a.createElement("b",null,"100%")),e.a.createElement("td",null,e.a.createElement("b",null,"100%"))))),e.a.createElement("div",{className:"mt text-center"},Object(G.j)((h==null?void 0:h.result_type)||"")," ",e.a.createElement("b",null,_)," ","has a"," ",(h==null?void 0:h.correlation_type)===s.l.Success?e.a.createElement("b",{className:"text-success"},"positive"," ",e.a.createElement(le.a,{title:"Positive correlation means this ".concat(N," is correlated with a successful conversion.")},e.a.createElement(Te.a,{className:"cursor-pointer"}))):e.a.createElement("b",{className:"text-danger"},"negative"," ",e.a.createElement(le.a,{title:"Negative correlation means this ".concat(N," is correlated with an unsuccessful conversion (user dropped off).")},e.a.createElement(Te.a,{className:"cursor-pointer"})))," ","correlation score of"," ",e.a.createElement("b",{style:{color:ue==="strong"?"var(--success)":ue==="moderate"?"var(--warning)":"var(--danger)"}},e.a.createElement(le.a,{title:"This ".concat(N," has ").concat(ue," correlation.")},e.a.createElement("span",{style:{cursor:"pointer"}},be," ",Be.toFixed(3)))))):e.a.createElement("div",null,e.a.createElement(Hn.a,{type:"danger"},"We could not load the details for this correlation value. Please recreate your funnel and try again."))))}function ca(){var m=Object(l.useValues)(n.c),c=m.insightProps,u=Object(Ve.a)(c),p=Object(l.useValues)(u),S=p.stepsWithCount,h=p.correlationValues,j=p.correlationTypes,D=p.eventHasPropertyCorrelations,M=p.eventWithPropertyCorrelationsValues,A=p.parseDisplayNameForCorrelation,I=p.correlationsLoading,N=p.eventWithPropertyCorrelationsLoading,U=p.nestedTableExpandedKeys,_=p.correlationPropKey,ee=p.filters,ce=p.aggregationTargetLabel,W=Object(l.useActions)(u),Be=W.setCorrelationTypes,ge=W.loadEventWithPropertyCorrelations,ne=W.addNestedTableExpandedKey,de=W.removeNestedTableExpandedKey,xe=W.openCorrelationPersonsModal,ue=W.loadCorrelations,be=Object(l.useActions)(T.f),Ie=be.reportCorrelationInteraction;Object(he.useEffect)(function(){ue({})},[ee]);var ke=function(Ne){j?j.includes(Ne)?Be(j.filter(function(Qe){return Qe!==Ne})):Be([].concat(Dt()(j),[Ne])):Be([Ne])},vn=function(Ne){var Qe=function(ha){return ha<10&&!Number.isInteger(ha)?ha.toFixed(1):ha.toFixed()},xt=Ne.correlation_type===s.l.Success,ct=A(Ne),gn=ct.first_value,va=ct.second_value;return e.a.createElement(e.a.Fragment,null,e.a.createElement("h4",null,xt?e.a.createElement(na.a,{style:{color:"green"}}):e.a.createElement(aa,{style:{color:"red"}})," ",e.a.createElement(pn.a,{value:gn}),va!==void 0&&e.a.createElement(e.a.Fragment,null," :: ",e.a.createElement(pn.a,{value:va,disablePopover:!0}))),e.a.createElement("div",null,Object(G.j)(ce.plural)," ",ee.aggregation_group_type_index!=null?"that":"who"," converted were"," ",e.a.createElement("mark",null,e.a.createElement("b",null,Qe(Ne.odds_ratio),"x ",xt?"more":"less"," likely"))," ","to"," ",Ne.result_type===s.k.EventWithProperties?"have this event property":"do this event"),e.a.createElement(Ma,null))},It=function(Ne){return e.a.createElement(mn.c,{onClick:function(){xe(Ne,!0)}},Ne.success_count)},ze=function(Ne){return e.a.createElement(mn.c,{onClick:function(){xe(Ne,!1)}},Ne.failure_count)},yt=function(Ne){return N?e.a.createElement("div",{className:"nested-properties-loading"},e.a.createElement(Dn.a,null),e.a.createElement("h3",null,"Loading correlation results"),e.a.createElement("p",null,"This process can take up to 20 seconds. ")):e.a.createElement("div",null,e.a.createElement("h4",{style:{paddingLeft:16}},"Correlated properties"),e.a.createElement(Wn.a,{dataSource:M[Ne],rowKey:function(xt){return xt.event.event},className:"nested-properties-table",scroll:{x:"max-content"},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(xt,ct){return Ie(s.k.EventWithProperties,"pagination change",{page:xt,page_size:ct})}}},e.a.createElement(et.a,{title:"Property",key:"eventName",render:function(xt,ct){return vn(ct)},align:"left"}),e.a.createElement(et.a,{title:"Completed",key:"success_count",render:function(xt,ct){return It(ct)},width:90,align:"center"}),e.a.createElement(et.a,{title:"Dropped off",key:"failure_count",render:function(xt,ct){return ze(ct)},width:120,align:"center"}),e.a.createElement(et.a,{title:"",key:"actions",render:function(xt,ct){return e.a.createElement(Ln,{record:ct})},align:"center",width:30})))};return S.length>1?e.a.createElement(nn,{id:_,offset:152},e.a.createElement("div",{className:"funnel-correlation-table"},e.a.createElement("span",{className:"funnel-correlation-header"},e.a.createElement("span",{className:"table-header"},e.a.createElement(Kt.IconSelectEvents,{style:{marginRight:4,fontSize:24,opacity:.5}}),"CORRELATED EVENTS"),e.a.createElement("span",{className:"table-options"},e.a.createElement("p",{className:"title"},"CORRELATION"),e.a.createElement("div",{className:"tab-btn ant-btn",style:{paddingTop:"1px",paddingBottom:"1px",borderTopRightRadius:0,borderBottomRightRadius:0},onClick:function(){return ke(s.l.Success)}},e.a.createElement(xn.a,{checked:j.includes(s.l.Success),style:{pointerEvents:"none"}},"Success")),e.a.createElement("div",{className:"tab-btn ant-btn",style:{marginRight:"8px",paddingTop:"1px",paddingBottom:"1px",borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:function(){return ke(s.l.Failure)}},e.a.createElement(xn.a,{checked:j.includes(s.l.Failure),style:{pointerEvents:"none"}},"Dropoff")))),e.a.createElement(Wn.a,{dataSource:h,loading:I,size:"small",scroll:{x:"max-content"},rowKey:function(Ne){return Ne.event.event},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(){return Ie(s.k.Events,"load more")}},expandable:{expandedRowRender:function(Ne){return yt(Ne.event.event)},expandedRowKeys:U,rowExpandable:function(){return ee.aggregation_group_type_index===void 0},expandIcon:function(Ne){var Qe=Ne.expanded,xt=Ne.onExpand,ct=Ne.record,gn=Ne.expandable;return gn?Qe?e.a.createElement(le.a,{title:"Collapse"},e.a.createElement("div",{style:{cursor:"pointer",opacity:.5,fontSize:24},onClick:function(ga){de(ct.event.event),xt(ct,ga)}},e.a.createElement(Kt.IconUnfoldLess,null))):e.a.createElement(le.a,{title:"Expand to see correlated properties for this event"},e.a.createElement("div",{style:{cursor:"pointer",opacity:.5,fontSize:24},onClick:function(ga){!D(ct.event.event)&&ge(ct.event.event),ne(ct.event.event),xt(ct,ga)}},e.a.createElement(Kt.IconUnfoldMore,null))):null}}},e.a.createElement(et.a,{title:"Event",key:"eventName",render:function(Ne,Qe){return vn(Qe)},align:"left",ellipsis:!0}),e.a.createElement(et.a,{title:e.a.createElement("div",{className:"flex-center"},"Completed",e.a.createElement(le.a,{title:"".concat(Object(G.j)(ce.plural)," ").concat(ee.aggregation_group_type_index!=null?"that":"who"," performed the event and completed the entire funnel.")},e.a.createElement(Te.a,{className:"column-info"}))),key:"success_count",render:function(Ne,Qe){return It(Qe)},width:90,align:"center"}),e.a.createElement(et.a,{title:e.a.createElement("div",{className:"flex-center"},"Dropped off",e.a.createElement(le.a,{title:e.a.createElement(e.a.Fragment,null,Object(G.j)(ce.plural)," ",ee.aggregation_group_type_index!=null?"that":"who"," ","performed the event and did ",e.a.createElement("b",null,"not complete")," the entire funnel.")},e.a.createElement(Te.a,{className:"column-info"}))),key:"failure_count",render:function(Ne,Qe){return ze(Qe)},width:120,align:"center"}),e.a.createElement(et.a,{title:"",key:"actions",render:function(Ne,Qe){return e.a.createElement(Ln,{record:Qe})},width:30})))):null}var Ln=function(c){var u=c.record,p=Object(l.useValues)(n.c),S=p.insightProps,h=Object(Ve.a)(S),j=Object(l.useActions)(h),D=j.excludeEventPropertyFromProject,M=j.excludeEventFromProject,A=j.setFunnelCorrelationDetails,I=Object(l.useValues)(h),N=I.isEventPropertyExcluded,U=I.isEventExcluded,_=u.event.event.split("::"),ee=Object(he.useState)(!1),ce=wt()(ee,2),W=ce[0],Be=ce[1];return e.a.createElement(Ce.a,{style:{justifyContent:"flex-end"}},e.a.createElement(la.a,{visible:W,actionable:!0,onClickOutside:function(){return Be(!1)},overlay:e.a.createElement(e.a.Fragment,null,u.result_type===s.k.Events&&e.a.createElement(an.a,{onClick:function(){return A(u)},fullWidth:!0,type:"stealth"},"View correlation details"),e.a.createElement(an.a,{disabled:u.result_type===s.k.EventWithProperties?N(_[1]):U(_[0]),onClick:function(){return u.result_type===s.k.EventWithProperties?D(_[0],_[1]):M(_[0])},fullWidth:!0,title:"Remove this event from any correlation analysis report in this project.",type:"stealth"},"Exclude event from project"))},e.a.createElement(an.a,{type:"stealth",onClick:function(){return Be(!W)}},e.a.createElement(ra.a,{style:{color:"var(--primary)",fontSize:24},className:"insight-dropdown-actions"}))))},La=t("./frontend/src/lib/components/PropertyNamesSelect/PropertyNamesSelect.tsx");function Gn(){var m=Object(l.useValues)(n.c),c=m.insightProps,u=Object(Ve.a)(c),p=Object(l.useValues)(u),S=p.stepsWithCount,h=p.propertyCorrelationValues,j=p.propertyCorrelationTypes,D=p.excludedPropertyNames,M=p.parseDisplayNameForCorrelation,A=p.propertyCorrelationsLoading,I=p.inversePropertyNames,N=p.propertyNames,U=p.correlationPropKey,_=p.allProperties,ee=p.filters,ce=p.aggregationTargetLabel,W=Object(l.useActions)(u),Be=W.setPropertyCorrelationTypes,ge=W.setPropertyNames,ne=W.openCorrelationPersonsModal,de=W.loadPropertyCorrelations,xe=Object(l.useActions)(T.f),ue=xe.reportCorrelationInteraction;Object(he.useEffect)(function(){N.length===0&&ge(_),de({})},[ee]);var be=function(ze){j?j.includes(ze)?Be(j.filter(function(yt){return yt!==ze})):Be([].concat(Dt()(j),[ze])):Be([ze])},Ie=function(ze){return e.a.createElement(mn.c,{onClick:function(){ne(ze,!0)}},ze.success_count)},ke=function(ze){return e.a.createElement(mn.c,{onClick:function(){ne(ze,!1)}},ze.failure_count)},vn=function(ze){var yt=function(gn){return gn<10&&!Number.isInteger(gn)?gn.toFixed(1):gn.toFixed()},pt=ze.correlation_type===s.l.Success,Ne=M(ze),Qe=Ne.first_value,xt=Ne.second_value;return e.a.createElement(e.a.Fragment,null,e.a.createElement("h4",null,pt?e.a.createElement(na.a,{style:{color:"green"}}):e.a.createElement(aa,{style:{color:"red"}})," ",e.a.createElement(pn.a,{value:Qe}),xt!==void 0&&e.a.createElement(e.a.Fragment,null," :: ",e.a.createElement(pn.a,{value:xt,disablePopover:!0}))),e.a.createElement("div",null,Object(G.j)(ce.plural)," ",ee.aggregation_group_type_index!=null?"that":"who"," converted were"," ",e.a.createElement("mark",null,e.a.createElement("b",null,yt(ze.odds_ratio),"x ",pt?"more":"less"," likely"))," ","to have this property value"))};return S.length>1?e.a.createElement(nn,{offset:150,id:"".concat(U,"-properties")},e.a.createElement("div",{className:"funnel-correlation-table"},e.a.createElement(Ce.a,{className:"funnel-correlation-header"},e.a.createElement(Se.a,{className:"table-header"},e.a.createElement(Kt.IconSelectProperties,{style:{marginRight:4,opacity:.5,fontSize:24}}),"CORRELATED PROPERTIES"),e.a.createElement(Se.a,{className:"table-options"},e.a.createElement(Ce.a,{style:{display:"contents"}},_.length>0&&e.a.createElement(e.a.Fragment,null,e.a.createElement("p",{className:"title"},"PROPERTIES "),e.a.createElement(La.a,{value:new Set(N),onChange:function(ze){return ge(ze)},allProperties:I(D||[])}))),e.a.createElement(Ce.a,{style:{display:"contents"}},e.a.createElement("p",{className:"title",style:{marginLeft:8}},"CORRELATION"),e.a.createElement("div",{className:"tab-btn ant-btn",style:{paddingTop:"1px",paddingBottom:"1px",borderTopRightRadius:0,borderBottomRightRadius:0},onClick:function(){return be(s.l.Success)}},e.a.createElement(xn.a,{checked:j.includes(s.l.Success),style:{pointerEvents:"none"}},"Success")),e.a.createElement("div",{className:"tab-btn ant-btn",style:{marginRight:"8px",paddingTop:"1px",paddingBottom:"1px",borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:function(){return be(s.l.Failure)}},e.a.createElement(xn.a,{checked:j.includes(s.l.Failure),style:{pointerEvents:"none"}},"Dropoff"))))),e.a.createElement(Wn.a,{dataSource:h,loading:A,scroll:{x:"max-content"},size:"small",rowKey:function(ze){return ze.event.event},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(ze,yt){return ue(s.k.Properties,"pagination change",{page:ze,page_size:yt})}}},e.a.createElement(et.a,{title:"".concat(Object(G.j)(ce.singular)," property"),key:"propertName",render:function(ze,yt){return vn(yt)},align:"left"}),e.a.createElement(et.a,{title:e.a.createElement("div",{className:"flex-center"},"Completed",e.a.createElement(le.a,{title:"".concat(Object(G.j)(ce.plural)," ").concat(ee.aggregation_group_type_index!=null?"that":"who"," have this property and completed the entire funnel.")},e.a.createElement(Te.a,{className:"column-info"}))),key:"success_count",render:function(ze,yt){return Ie(yt)},width:90,align:"center"}),e.a.createElement(et.a,{title:e.a.createElement("div",{className:"flex-center"},"Dropped off",e.a.createElement(le.a,{title:e.a.createElement(e.a.Fragment,null,Object(G.j)(ce.plural)," ",ee.aggregation_group_type_index!=null?"that":"who"," have this property and did ",e.a.createElement("b",null,"not complete")," the entire funnel.")},e.a.createElement(Te.a,{className:"column-info"}))),key:"failure_count",render:function(ze,yt){return ke(yt)},width:120,align:"center"}),e.a.createElement(et.a,{title:"",key:"actions",render:function(ze,yt){return e.a.createElement(Aa,{record:yt})},align:"center",width:30})))):null}var Aa=function(c){var u=c.record,p=Object(l.useValues)(n.c),S=p.insightProps,h=Object(Ve.a)(S),j=Object(l.useActions)(h),D=j.excludePropertyFromProject,M=j.setFunnelCorrelationDetails,A=Object(l.useValues)(h),I=A.isPropertyExcludedFromProject,N=(u.event.event||"").split("::")[0],U=Object(he.useState)(!1),_=wt()(U,2),ee=_[0],ce=_[1];return e.a.createElement(Ce.a,{style:{justifyContent:"flex-end"}},e.a.createElement(la.a,{visible:ee,actionable:!0,onClickOutside:function(){return ce(!1)},overlay:e.a.createElement(e.a.Fragment,null,e.a.createElement(an.a,{onClick:function(){return M(u)},fullWidth:!0,type:"stealth"},"View correlation details"),e.a.createElement(an.a,{disabled:I(N),onClick:function(){return D(N)},fullWidth:!0,title:"Remove this property from any correlation analysis report in this project.",type:"stealth"},"Exclude property from project"))},e.a.createElement(an.a,{type:"stealth",onClick:function(){return ce(!ee)}},e.a.createElement(ra.a,{style:{color:"var(--primary)",fontSize:24},className:"insight-dropdown-actions"}))))},Jn=t("./node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),Xn=t("./frontend/src/lib/components/PayCard/PayCard.tsx"),da=t("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),ua=function(){var c,u=Object(l.useValues)(n.c),p=u.insightProps,S=Object(l.useValues)(Object(Ve.a)(p)),h=S.isSkewed,j=S.stepsWithCount,D=S.correlationFeedbackHidden,M=S.correlationDetailedFeedbackVisible,A=S.correlationFeedbackRating,I=S.correlationAnalysisAvailable,N=S.aggregationTargetLabel,U=Object(l.useActions)(Object(Ve.a)(p)),_=U.sendCorrelationAnalysisFeedback,ee=U.hideSkewWarning,ce=U.hideCorrelationAnalysisFeedback,W=U.setCorrelationFeedbackRating,Be=U.setCorrelationDetailedFeedback,ge=Object(l.useValues)(da.a),ne=ge.preflight,de=Object(he.useRef)(null);return j.length<=1?null:!I&&!(!(ne==null||(c=ne.instance_preferences)===null||c===void 0)&&c.disable_paid_fs)?e.a.createElement(Xn.a,{identifier:s.c.CORRELATION_ANALYSIS,title:"Get a deeper understanding of why your ".concat(N.plural," are not converting"),caption:"Correlation analysis automatically finds signals for why ".concat(N.plural," are converting or dropping off.")}):e.a.createElement(e.a.Fragment,null,e.a.createElement("h2",{style:{margin:"1rem 0"}},"Correlation analysis"),e.a.createElement("div",{className:"funnel-correlation"},h&&e.a.createElement(we.a,{className:"skew-warning"},e.a.createElement("h4",null,e.a.createElement(Kt.IconFeedbackWarning,{style:{fontSize:24,marginRight:4,color:"var(--warning)"}})," ","Adjust your funnel definition to improve correlation analysis",e.a.createElement(Jn.a,{className:"close-button",onClick:ee})),e.a.createElement("div",null,e.a.createElement("b",null,"Tips for adjusting your funnel:"),e.a.createElement("ol",null,e.a.createElement("li",null,"Adjust your first funnel step to be more specific. For example, choose a page or an event that occurs less frequently."),e.a.createElement("li",null,"Choose an event that happens more frequently for subsequent funnels steps.")))),e.a.createElement(ca,null),!D&&e.a.createElement(we.a,{className:"correlation-feedback"},e.a.createElement(Ce.a,{className:"row-initial"},e.a.createElement(Se.a,{span:14},e.a.createElement("h4",null,e.a.createElement(Bt.a,{style:{marginRight:4}}),"Was this correlation analysis report useful?")),e.a.createElement(Se.a,{span:9,style:{alignContent:"right"}},!!A&&e.a.createElement("i",{style:{color:"var(--success)",marginRight:8}},"Thanks for your feedback!"),[[5,"\u{1F60D}"],[4,"\u{1F600}"],[3,"\u{1F634}"],[2,"\u{1F614}"],[1,"\u{1F44E}"]].map(function(xe,ue){return e.a.createElement(tn.a,{key:ue,className:"emoji-button",style:A===xe[0]?{background:"#5375FF"}:A?{display:"none"}:{},onClick:function(){A===xe[0]?W(0):(W(xe[0]),setTimeout(function(){var Ie;return(Ie=de.current)===null||Ie===void 0?void 0:Ie.focus()},100))}},xe[1])})),e.a.createElement(Se.a,{span:1},e.a.createElement(Jn.a,{className:"close-button",onClick:ce}))),e.a.createElement("div",{style:{display:M?void 0:"none"}},e.a.createElement("form",{onSubmit:_},e.a.createElement(z.a,{onBlur:function(ue){return Be(ue.target.value)},placeholder:"Optional. Help us by sharing details around your experience...",style:{marginTop:16},ref:de,onKeyDown:function(ue){if(ue.key==="Enter"&&ue.metaKey){var be;(be=de.current)===null||be===void 0||be.blur(),_()}}}),e.a.createElement("div",{className:"text-right"},e.a.createElement(tn.a,{className:"feedback-button","data-attr":"correlation-analysis-share-feedback",type:"primary",htmlType:"submit"},"Share feedback"))))),e.a.createElement(Gn,null)))},Cn=t("./node_modules/core-js/modules/es.regexp.to-string.js"),An=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/lib/components/InsightLegend/InsightLegend.scss"),ma=t.n(An),Qn={};Qn.insert="head",Qn.singleton=!1;var Ra=yn()(ma.a,Qn),Ba=ma.a.locals||{},Y=t("./frontend/src/lib/components/InsightLabel/index.tsx"),$=t("./frontend/src/lib/colors.ts"),rt=t("./frontend/src/lib/components/LemonCheckbox/index.ts");function Tt(){var m=Object(l.useValues)(n.c),c=m.filters,u=m.activeView,p=Object(l.useActions)(n.c),S=p.toggleInsightLegend,h=Object(l.useValues)(Ot.a),j=h.featureFlags;return(u===s.s.TRENDS&&c.display!==s.d.WorldMap&&c.display!==s.d.ActionsTable||u===s.s.STICKINESS)&&j[oe.i.INSIGHT_LEGENDS]?e.a.createElement(tn.a,{className:"insight-legend-button",onClick:S},e.a.createElement(Kt.IconLegend,null),e.a.createElement("span",{className:"insight-legend-button-title"},c.show_legend?"Hide":"Show"," legend")):null}function Rn(){var m=Object(l.useValues)(n.c),c=m.insightProps,u=m.filters,p=Object(C.a)(c),S=Object(l.useValues)(p),h=S.indexedResults,j=S.hiddenLegendKeys,D=Object(l.useActions)(p),M=D.toggleVisibility,A=Object($.c)("white",h.length,!!u.compare);return e.a.createElement("div",{className:"insight-legend-menu"},e.a.createElement("div",{className:"insight-legend-menu-scroll"},h&&h.map(function(I){var N,U;return e.a.createElement(Ce.a,{key:I.id,className:"insight-legend-menu-item",wrap:!1},e.a.createElement(rt.a,{className:"insight-legend-menu-item-inner",color:A[I.id],checked:!j[I.id],onChange:function(){return M(I.id)},rowProps:{fullWidth:!0},label:e.a.createElement(Y.b,{key:I.id,seriesColor:A[I.id],action:I.action,fallbackName:I.breakdown_value===""?"None":I.label,hasMultipleSeries:h.length>1,breakdownValue:I.breakdown_value===""?"None":(N=I.breakdown_value)===null||N===void 0?void 0:N.toString(),compareValue:u.compare?Object(b.d)(I):void 0,pillMidEllipsis:(I==null||(U=I.filter)===null||U===void 0?void 0:U.breakdown)==="$current_url",hideIcon:!0})}))})))}var pa=t("./node_modules/core-js/modules/es.array.every.js"),Ha=t("./node_modules/core-js/modules/es.array.flat-map.js"),Ga=t("./node_modules/core-js/modules/es.array.some.js"),Ja=t("./node_modules/core-js/modules/es.array.unscopables.flat-map.js"),Xa=t("./node_modules/core-js/modules/es.object.from-entries.js"),Wa=t("./frontend/src/lib/components/LemonTable/index.ts"),ka=t("./frontend/src/scenes/insights/InsightTabs/FunnelTab/funnelStepTableUtils.tsx"),za=t("./frontend/src/models/cohortsModel.ts"),Ka=t("./frontend/src/lib/components/Lettermark/Lettermark.tsx"),Ya=t("./frontend/src/lib/components/LemonRow/index.ts");function $a(){var m=Object(l.useValues)(n.c),c=m.insightProps,u=Object(Ve.a)(c),p=Object(l.useValues)(u),S=p.insightLoading,h=p.steps,j=p.flattenedBreakdowns,D=p.hiddenLegendKeys,M=p.visibleStepsWithConversionMetrics,A=Object(l.useActions)(u),I=A.setHiddenById,N=A.toggleVisibilityByBreakdown,U=A.openPersonsModalForStep,_=Object(l.useValues)(za.a),ee=_.cohorts,ce=j.length===1,W=j==null?void 0:j.every(function(ge){return!D[Object(Ct.m)(M==null?void 0:M[0],ge.breakdown_value)]}),Be=[{children:[{title:ce?"Breakdown":e.a.createElement(rt.a,{checked:W||(j!=null&&j.some(function(ge){return!D[Object(Ct.m)(M==null?void 0:M[0],ge.breakdown_value)]})?"indeterminate":!1),onChange:function(){I(Object.fromEntries(M.flatMap(function(ne){return j.map(function(de){return[Object(Ct.m)(ne,de.breakdown_value),W]})})))},label:"Breakdown",rowProps:{compact:!0,style:{padding:0,marginLeft:"-0.5rem",font:"inherit"}}}),dataIndex:"breakdown_value",render:function(ne){var de=Object(b.c)(ee,ne);return ce?e.a.createElement("span",{style:{fontWeight:500}},de):e.a.createElement(rt.a,{checked:!D[Object(Ct.m)(M==null?void 0:M[0],ne)],onChange:function(){return N(ne)},label:de,rowProps:{compact:!0,style:{padding:0,marginLeft:"-0.5rem"}}})}},{title:"Total conversion",render:function(ne,de){var xe,ue;return Object(Ct.c)((xe=de==null||(ue=de.conversionRates)===null||ue===void 0?void 0:ue.total)!==null&&xe!==void 0?xe:0,!0)},align:"right"}]}].concat(Dt()(h.map(function(ge,ne){return{title:e.a.createElement(Ya.a,{icon:e.a.createElement(Ka.a,{name:ne+1,color:Ka.b.Gray}),style:{font:"inherit",padding:0},compact:!0},e.a.createElement(bn.a,{filter:Object(ka.b)(ge)})),children:[{title:"Completed",render:function(xe,ue){var be,Ie,ke=(be=ue.steps)===null||be===void 0?void 0:be[ne];return ke&&e.a.createElement(mn.c,{onClick:function(){return U({step:ke,converted:!0})},style:{padding:0}},(Ie=ke.count)!==null&&Ie!==void 0?Ie:0)},align:"right"},{title:"Rate",render:function(xe,ue){var be,Ie,ke;return Object(Ct.c)((be=(Ie=ue.steps)===null||Ie===void 0||(ke=Ie[ne])===null||ke===void 0?void 0:ke.conversionRates.fromPrevious)!==null&&be!==void 0?be:0,!0)},align:"right"}].concat(Dt()(ne===0?[]:[{title:"Dropped",render:function(xe,ue){var be,Ie,ke=(be=ue.steps)===null||be===void 0?void 0:be[ne];return ke&&e.a.createElement(mn.c,{onClick:function(){return U({step:ke,converted:!1})},style:{padding:0}},(Ie=ke.droppedOffFromPrevious)!==null&&Ie!==void 0?Ie:0)},align:"right"},{title:"Rate",render:function(xe,ue){var be,Ie,ke;return Object(Ct.c)(1-((be=(Ie=ue.steps)===null||Ie===void 0||(ke=Ie[ne])===null||ke===void 0?void 0:ke.conversionRates.fromPrevious)!==null&&be!==void 0?be:0),!0)},align:"right"},{title:"Avg. time",render:function(xe,ue){var be,Ie;return((be=ue.steps)===null||be===void 0||(Ie=be[ge.order])===null||Ie===void 0?void 0:Ie.average_conversion_time)!=null?Object(G.N)(ue.steps[ge.order].average_conversion_time,3):"\u2013"},align:"right",className:"nowrap"}]))}})));return e.a.createElement(Wa.a,{dataSource:j,columns:Be,loading:S,rowRibbonColor:function(ne){return Object(Ct.k)(ne==null?void 0:ne.breakdownIndex,j.length===1)},rowKey:"breakdownIndex"})}var fn,Ua=(fn={},q()(fn,"".concat(s.s.TRENDS),e.a.createElement(se,{view:s.s.TRENDS})),q()(fn,"".concat(s.s.STICKINESS),e.a.createElement(se,{view:s.s.STICKINESS})),q()(fn,"".concat(s.s.LIFECYCLE),e.a.createElement(se,{view:s.s.LIFECYCLE})),q()(fn,"".concat(s.s.FUNNELS),e.a.createElement(B,null)),q()(fn,"".concat(s.s.RETENTION),e.a.createElement(V.a,null)),q()(fn,"".concat(s.s.PATHS),e.a.createElement(v.a,null)),fn);function fa(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{disableHeader:!1,disableTable:!1},c=m.disableHeader,u=m.disableTable,p=Object(l.useValues)(Ot.a),S=p.featureFlags,h=Object(l.useValues)(f.a),j=h.insightMode,D=Object(l.useValues)(n.c),M=D.insightProps,A=D.canEditInsight,I=D.insightLoading,N=D.activeView,U=D.loadedView,_=D.filters,ee=D.showTimeoutMessage,ce=D.showErrorMessage,W=D.csvExportUrl,Be=Object(l.useValues)(Object(Ve.a)(M)),ge=Be.areFiltersValid,ne=Be.isValidFunnel,de=Be.areExclusionFiltersValid,xe=Be.correlationAnalysisAvailable,ue=function(){if(N!==U||I&&!ee)return e.a.createElement(e.a.Fragment,null,_.display!==s.d.ActionsTable&&_.display!==s.d.WorldMap&&e.a.createElement("div",{className:"trends-insights-container"}),e.a.createElement(G.b,null));if(U===s.s.FUNNELS){if(!ge)return e.a.createElement(Me.b,{actionable:j===s.t.Edit||u});if(!de)return e.a.createElement(Me.a,null);if(!ne&&!I)return e.a.createElement(Me.c,null)}return ce?e.a.createElement(Me.d,null):ee?e.a.createElement(Me.e,{isLoading:I}):null}();function be(){return N===s.s.FUNNELS&&!ce&&!ee&&ge&&_.funnel_viz_type===s.o.Steps&&!u&&(_==null?void 0:_.layout)===oe.k.horizontal?e.a.createElement($a,null):(!_.display||(_==null?void 0:_.display)!==s.d.ActionsTable&&(_==null?void 0:_.display)!==s.d.ActionsBarValue)&&N===s.s.TRENDS&&!u?e.a.createElement(e.a.Fragment,null,W&&e.a.createElement("div",{className:"flex-center space-between-items",style:{margin:"1rem 0"}},e.a.createElement("h2",null,"Trend results"),e.a.createElement(le.a,{title:"Export this table in CSV format",placement:"left"},e.a.createElement(an.a,{type:"secondary",icon:e.a.createElement(Kt.IconExport,{style:{color:"var(--primary)"}}),href:W},"Export"))),e.a.createElement(l.BindLogic,{logic:C.a,props:M},e.a.createElement(b.b,{isLegend:!0,showTotalCount:!0,filterKey:N===s.s.TRENDS?"trends_".concat(N):"",canEditSeriesNameInline:N===s.s.TRENDS&&j===s.t.Edit,canCheckUncheckSeries:A}))):null}return e.a.createElement(e.a.Fragment,null,e.a.createElement(we.a,{title:c?null:e.a.createElement(In,{activeView:N,insightMode:j,filters:_,disableTable:!!u,disabled:!A}),"data-attr":"insights-graph",className:"insights-graph-container"},e.a.createElement("div",null,e.a.createElement(Ce.a,{className:Object(dn.a)("insights-graph-header",{funnels:N===s.s.FUNNELS}),align:"middle",justify:"space-between"},e.a.createElement(Se.a,null,e.a.createElement(r,null)),e.a.createElement(Se.a,null,N===s.s.FUNNELS?e.a.createElement(On,null):null,N===s.s.PATHS?e.a.createElement(Mt,null):null,e.a.createElement(Tt,null))),ue||(S[oe.i.INSIGHT_LEGENDS]&&(N===s.s.TRENDS||N===s.s.STICKINESS)&&_.show_legend?e.a.createElement(Ce.a,{className:"insights-graph-container-row",wrap:!1},e.a.createElement(Se.a,{className:"insights-graph-container-row-left"},Ua[N]),e.a.createElement(Se.a,{className:"insights-graph-container-row-right"},e.a.createElement(Rn,null))):Ua[N]))),be(),!u&&xe&&N===s.s.FUNNELS&&e.a.createElement(ua,null))}try{fa.displayName="InsightContainer",fa.__docgenInfo={description:"",displayName:"InsightContainer",props:{disableHeader:{defaultValue:null,description:"",name:"disableHeader",required:!1,type:{name:"boolean"}},disableTable:{defaultValue:null,description:"",name:"disableTable",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightContainer.tsx#InsightContainer"]={docgenInfo:fa.__docgenInfo,name:"InsightContainer",path:"frontend/src/scenes/insights/InsightContainer.tsx#InsightContainer"})}catch(m){}},"./frontend/src/scenes/insights/InsightDateFilter/insightDateFilterLogic.ts":function(me,L,t){"use strict";t.d(L,"a",function(){return $e});var X=t("./node_modules/core-js/modules/es.array.iterator.js"),q=t.n(X),we=t("./node_modules/core-js/modules/es.object.to-string.js"),Ce=t.n(we),Se=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),He=t.n(Se),Xe=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),he=t.n(Xe),e=t("./node_modules/kea/lib/index.esm.js"),l=t("./frontend/src/scenes/insights/insightLogic.ts"),Ye=t("./frontend/src/scenes/insights/sharedUtils.ts");function Ee(Q,R){var F=Object.keys(Q);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(Q);R&&(y=y.filter(function(E){return Object.getOwnPropertyDescriptor(Q,E).enumerable})),F.push.apply(F,y)}return F}function O(Q){for(var R=1;R<arguments.length;R++){var F=arguments[R]!=null?arguments[R]:{};R%2?Ee(Object(F),!0).forEach(function(y){he()(Q,y,F[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Q,Object.getOwnPropertyDescriptors(F)):Ee(Object(F)).forEach(function(y){Object.defineProperty(Q,y,Object.getOwnPropertyDescriptor(F,y))})}return Q}var $e=Object(e.kea)({props:{},key:Object(Ye.c)("new"),path:function(R){return["scenes","insights","InsightDateFilter","insightDateFilterLogic",R]},connect:function(R){return{actions:[Object(l.c)(R),["setFilters"]],values:[Object(l.c)(R),["filters"]]}},actions:function(){return{setDates:function(F,y){return{dateFrom:F,dateTo:y}}}},selectors:{dates:[function(Q){return[Q.filters]},function(Q){return{dateFrom:(Q==null?void 0:Q.date_from)||null,dateTo:(Q==null?void 0:Q.date_to)||null}}]},listeners:function(R){var F=R.actions,y=R.values;return{setDates:function(re){var _e=re.dateFrom,pe=re.dateTo;F.setFilters(O(O({},y.filters),{},{date_from:_e||null,date_to:pe||null}))}}}})},"./frontend/src/scenes/trends/PersonsModal.tsx":function(me,L,t){"use strict";t.d(L,"a",function(){return rn});var X=t("./node_modules/core-js/modules/es.array.concat.js"),q=t("./node_modules/core-js/modules/es.array.find.js"),we=t("./node_modules/core-js/modules/es.array.map.js"),Ce=t("./node_modules/core-js/modules/es.object.keys.js"),Se=t("./node_modules/core-js/modules/es.object.to-string.js"),He=t("./node_modules/core-js/modules/es.regexp.exec.js"),Xe=t("./node_modules/core-js/modules/es.regexp.to-string.js"),he=t("./node_modules/core-js/modules/es.string.replace.js"),e=t("./node_modules/react/index.js"),l=t.n(e),Ye=t("./node_modules/kea/lib/index.esm.js"),Ee=t("./node_modules/@ant-design/icons/es/icons/DownloadOutlined.js"),O=t("./node_modules/@ant-design/icons/es/icons/UsergroupAddOutlined.js"),$e=t("./node_modules/antd/es/modal/index.js"),Q=t("./node_modules/antd/es/button/index.js"),R=t("./node_modules/antd/es/skeleton/index.js"),F=t("./node_modules/antd/es/input/index.js"),y=t("./node_modules/antd/es/select/index.js"),E=t("./frontend/src/types.ts"),re=t("./frontend/src/scenes/trends/personsModalLogic.ts"),_e=t("./frontend/src/lib/components/CopyToClipboard.tsx"),pe=t("./frontend/src/lib/utils.tsx"),Ge=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),w=t.n(Ge),H=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/trends/PersonsModal.scss"),ae=t.n(H),ye={};ye.insert="head",ye.singleton=!1;var Fe=w()(ae.a,ye),ft=ae.a.locals||{},Je=t("./frontend/src/lib/components/PropertyKeyInfo.tsx"),tt=t("./frontend/src/lib/components/PropertiesTable.tsx"),s=t("./frontend/src/lib/components/DateDisplay/index.tsx"),G=t("./frontend/src/scenes/persons/PersonHeader.tsx"),n=t("./frontend/src/lib/api.ts"),Le=t("./frontend/src/lib/components/LemonTable/index.ts"),le=t("./frontend/src/scenes/persons/GroupActorHeader.tsx"),Ke=t("./frontend/src/lib/components/icons.tsx"),x=t("./frontend/src/lib/components/InsightLabel/index.tsx"),Ze=t("./frontend/src/lib/colors.ts"),jt=t("./frontend/src/lib/logic/featureFlagLogic.ts"),Ht=t("./frontend/src/lib/constants.tsx"),Qt=t("./frontend/src/scenes/session-recordings/SessionPlayerDrawer.tsx"),mt=t("./frontend/src/scenes/session-recordings/multiRecordingButton/multiRecordingButton.tsx"),wt=t("./frontend/src/scenes/insights/WorldMap/countryCodes.ts");function rn(dt){var Z,fe,je,Ae,nt,Ue,st=dt.visible,Nt=dt.view,We=dt.filters,K=dt.onSaveCohort,Ut=dt.showModalActions,At=Ut===void 0?!0:Ut,oe=dt.aggregationTargetLabel,bt=Object(Ye.useValues)(re.b),P=bt.people,ut=bt.loadingMorePeople,Oe=bt.firstLoadedPeople,lt=bt.searchTerm,Ft=bt.isInitialLoad,De=bt.peopleParams,vt=bt.actorLabel,qe=bt.sessionRecordingId,ve=Object(Ye.useActions)(re.b),Pe=ve.hidePeople,gt=ve.loadMorePeople,Rt=ve.setFirstLoadedActors,Ve=ve.setPersonsModalFilters,Wt=ve.setSearchTerm,_t=ve.switchToDataPoint,hn=ve.openRecordingModal,wn=ve.closeRecordingModal,k=Object(Ye.useValues)(jt.a),Zt=k.featureFlags,qt=Object(e.useMemo)(function(){var Te,J,ot;return Ft?"Loading ".concat(oe.plural,"\u2026"):We.shown_as==="Stickiness"?l.a.createElement(l.a.Fragment,null,l.a.createElement(Je.a,{value:(P==null?void 0:P.label)||"",disablePopover:!0})," stickiness on day ",P==null?void 0:P.day):We.display==="ActionsBarValue"||We.display==="ActionsPie"?l.a.createElement(Je.a,{value:(P==null?void 0:P.label)||"",disablePopover:!0}):We.insight===E.s.FUNNELS?l.a.createElement(l.a.Fragment,null,((Te=P==null?void 0:P.funnelStep)!==null&&Te!==void 0?Te:0)>=0?"Completed":"Dropped off at"," step"," ",Math.abs((J=P==null?void 0:P.funnelStep)!==null&&J!==void 0?J:0)," \u2022 ",l.a.createElement(Je.a,{value:(P==null?void 0:P.label)||"",disablePopover:!0})," ",P!=null&&P.breakdown_value?"\u2022 ".concat(P.breakdown_value):""):We.insight===E.s.PATHS?l.a.createElement(l.a.Fragment,null,P!=null&&P.pathsDropoff?"Dropped off after":"Completed"," step"," ",l.a.createElement(Je.a,{value:(P==null?void 0:P.label.replace(/(^[0-9]+_)/,""))||"",disablePopover:!0})):We.display===E.d.WorldMap?l.a.createElement(l.a.Fragment,null,Object(pe.j)(vt),De!=null&&De.breakdown_value?" in ".concat(Object(wt.a)(De==null?void 0:De.breakdown_value)," ").concat(wt.b[De==null?void 0:De.breakdown_value]):""):l.a.createElement(l.a.Fragment,null,Object(pe.j)(vt)," on"," ",l.a.createElement(s.a,{interval:We.interval||"day",date:(P==null||(ot=P.day)===null||ot===void 0?void 0:ot.toString())||""}))},[We,P,Ft]),ln=Zt[Ht.i.NEW_INSIGHT_COHORTS],on=!1,ht=(Nt===E.s.TRENDS||Nt===E.s.STICKINESS||!!ln&&(Nt===E.s.FUNNELS||Nt===E.s.PATHS))&&At,Sn=Object(Ze.c)("white",P==null||(Z=P.crossDataset)===null||Z===void 0?void 0:Z.length),kt=!!(!(P==null||(fe=P.crossDataset)===null||fe===void 0)&&fe.find(function(Te){var J=Te.action;return(J==null?void 0:J.math)&&J.math!=="total"})),cn=!!(!(P==null||(je=P.crossDataset)===null||je===void 0)&&je.find(function(Te){var J=Te.action;return J==null?void 0:J.order}));return l.a.createElement(l.a.Fragment,null,!!qe&&l.a.createElement(Qt.a,{onClose:wn}),l.a.createElement($e.a,{title:qt,visible:st,onCancel:Pe,footer:P&&P.count>0&&(on||ht)&&l.a.createElement(l.a.Fragment,null,on&&l.a.createElement(Q.a,{icon:l.a.createElement(Ee.a,null),href:n.b.actions.determinePeopleCsvUrl({label:P.label,action:P.action,date_from:P.day,date_to:P.day,breakdown_value:P.breakdown_value},We),style:{marginRight:8},"data-attr":"person-modal-download-csv"},"Download CSV"),ht&&l.a.createElement(Q.a,{onClick:K,icon:l.a.createElement(O.a,null),"data-attr":"person-modal-save-as-cohort"},"Save as cohort")),width:600,className:"person-modal"},Ft?l.a.createElement("div",{style:{padding:16}},l.a.createElement(R.a,{active:!0})):P&&l.a.createElement(l.a.Fragment,null,l.a.createElement(F.a.Search,{allowClear:!0,enterButton:!0,placeholder:"Search for persons by email, name, or ID",onChange:function(J){Wt(J.target.value),J.target.value||Rt(Oe)},value:lt,onSearch:function(J){return J?Ve(J,P,We):Rt(Oe)}}),Zt[Ht.i.MULTI_POINT_PERSON_MODAL]&&!!(!((Ae=P.crossDataset)===null||Ae===void 0)&&Ae.length)&&P.seriesId!==void 0&&l.a.createElement("div",{className:"data-point-selector"},l.a.createElement(y.a,{value:P.seriesId,onChange:function(J){return _t(J)}},P.crossDataset.map(function(Te){var J,ot;return l.a.createElement(y.a.Option,{value:Te.id,key:"".concat((J=Te.action)===null||J===void 0?void 0:J.id).concat(Te.breakdown_value)},l.a.createElement(x.b,{seriesColor:Sn[Te.id],action:Te.action,breakdownValue:Te.breakdown_value===""?"None":(ot=Te.breakdown_value)===null||ot===void 0?void 0:ot.toString(),showCountedByTag:kt,hasMultipleSeries:cn}))}))),l.a.createElement("div",{className:"user-count-subheader"},l.a.createElement(Ke.IconPersonFilled,{style:{fontSize:"1.125rem",marginRight:"0.5rem"}}),l.a.createElement("span",null,"This list contains"," ",l.a.createElement("b",null,P.count," unique ",oe.plural),(De==null?void 0:De.pointValue)!==void 0&&(!(!((nt=De.action)===null||nt===void 0)&&nt.math)||((Ue=De.action)===null||Ue===void 0?void 0:Ue.math)==="total")&&l.a.createElement(l.a.Fragment,null," ","who performed the event"," ",l.a.createElement("b",null,De.pointValue," total"," ",Object(pe.qb)(De.pointValue,"time",void 0,!1))),".")),P.count>0?l.a.createElement(Le.a,{columns:[{title:"Person",key:"person",render:function(J,ot){return l.a.createElement(sn,{actor:ot})}},{width:0,title:"Recordings",key:"recordings",render:function(J,ot){var En,Dt;if(((En=ot.matched_recordings)===null||En===void 0?void 0:En.length)&&((Dt=ot.matched_recordings)===null||Dt===void 0?void 0:Dt.length)>0)return l.a.createElement(mt.a,{sessionRecordings:ot.matched_recordings,onOpenRecording:function(dn){hn(dn.session_id)}})}}],className:"persons-table",rowKey:"id",expandable:{expandedRowRender:function(J){var ot=J.properties;return Object.keys(ot).length?l.a.createElement(tt.a,{properties:ot}):"This person has no properties."}},embedded:!0,showHeader:!1,dataSource:P.people,nouns:["person","persons"]}):l.a.createElement("div",{className:"person-row-container person-row"},"We couldn't find any matching ",oe.plural," for this data point."),(P==null?void 0:P.next)&&l.a.createElement("div",{style:{margin:"1rem",textAlign:"center"}},l.a.createElement(Q.a,{type:"primary",style:{color:"white"},onClick:gt,loading:ut},"Load more ",oe.plural)))))}function sn(dt){var Z=dt.actor;return Object(pe.W)(Z)?l.a.createElement("div",{key:Z.id,className:"person-row"},l.a.createElement("div",{className:"person-ids"},l.a.createElement("strong",null,l.a.createElement(le.a,{actor:Z})))):l.a.createElement("div",{key:Z.id,className:"person-ids"},l.a.createElement("strong",null,l.a.createElement(G.a,{person:Z,withIcon:!1})),l.a.createElement(_e.a,{explicitValue:Z.distinct_ids[0],iconStyle:{color:"var(--primary)"},iconPosition:"end",className:"text-small text-muted-alt"},Object(pe.kb)(Z.distinct_ids[0],32)))}try{rn.displayName="PersonsModal",rn.__docgenInfo={description:"",displayName:"PersonsModal",props:{visible:{defaultValue:null,description:"",name:"visible",required:!0,type:{name:"boolean"}},view:{defaultValue:null,description:"",name:"view",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"Partial<FilterType>"}},onSaveCohort:{defaultValue:null,description:"",name:"onSaveCohort",required:!0,type:{name:"() => void"}},showModalActions:{defaultValue:{value:"true"},description:"",name:"showModalActions",required:!1,type:{name:"boolean"}},aggregationTargetLabel:{defaultValue:null,description:"",name:"aggregationTargetLabel",required:!0,type:{name:"{ singular: string; plural: string; }"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/trends/PersonsModal.tsx#PersonsModal"]={docgenInfo:rn.__docgenInfo,name:"PersonsModal",path:"frontend/src/scenes/trends/PersonsModal.tsx#PersonsModal"})}catch(dt){}try{sn.displayName="ActorRow",sn.__docgenInfo={description:"",displayName:"ActorRow",props:{actor:{defaultValue:null,description:"",name:"actor",required:!0,type:{name:"ActorType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/trends/PersonsModal.tsx#ActorRow"]={docgenInfo:sn.__docgenInfo,name:"ActorRow",path:"frontend/src/scenes/trends/PersonsModal.tsx#ActorRow"})}catch(dt){}},"./frontend/src/scenes/trends/SaveCohortModal.tsx":function(me,L,t){"use strict";t.d(L,"a",function(){return Xe});var X=t("./node_modules/@babel/runtime/helpers/slicedToArray.js"),q=t.n(X),we=t("./node_modules/react/index.js"),Ce=t.n(we),Se=t("./node_modules/antd/es/modal/index.js"),He=t("./node_modules/antd/es/input/index.js");function Xe(he){var e=he.onOk,l=he.onCancel,Ye=he.visible,Ee=Object(we.useState)(""),O=q()(Ee,2),$e=O[0],Q=O[1];return Ce.a.createElement(Se.a,{title:"New Cohort",okText:"Save",cancelText:"Cancel",onOk:function(){e($e),Q("")},onCancel:l,visible:Ye},Ce.a.createElement("div",{className:"mb"},Ce.a.createElement(He.a,{required:!0,autoFocus:!0,placeholder:"Cohort name...",value:$e,"data-attr":"cohort-name",onChange:function(F){return Q(F.target.value)}})))}try{Xe.displayName="SaveCohortModal",Xe.__docgenInfo={description:"",displayName:"SaveCohortModal",props:{onOk:{defaultValue:null,description:"",name:"onOk",required:!0,type:{name:"(title: string) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}},visible:{defaultValue:null,description:"",name:"visible",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/trends/SaveCohortModal.tsx#SaveCohortModal"]={docgenInfo:Xe.__docgenInfo,name:"SaveCohortModal",path:"frontend/src/scenes/trends/SaveCohortModal.tsx#SaveCohortModal"})}catch(he){}},"./node_modules/@ant-design/icons/es/icons/BarChartOutlined.js":function(me,L,t){"use strict";var X=t("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),q=t("./node_modules/react/index.js"),we={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm-600-80h56c4.4 0 8-3.6 8-8V560c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v144c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V384c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v320c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V462c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v242c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V304c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v400c0 4.4 3.6 8 8 8z"}}]},name:"bar-chart",theme:"outlined"},Ce=we,Se=t("./node_modules/@ant-design/icons/es/components/AntdIcon.js"),He=function(e,l){return q.createElement(Se.a,Object(X.a)(Object(X.a)({},e),{},{ref:l,icon:Ce}))};He.displayName="BarChartOutlined";var Xe=L.a=q.forwardRef(He)},"./node_modules/@ant-design/icons/es/icons/DownloadOutlined.js":function(me,L,t){"use strict";var X=t("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),q=t("./node_modules/react/index.js"),we={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},Ce=we,Se=t("./node_modules/@ant-design/icons/es/components/AntdIcon.js"),He=function(e,l){return q.createElement(Se.a,Object(X.a)(Object(X.a)({},e),{},{ref:l,icon:Ce}))};He.displayName="DownloadOutlined";var Xe=L.a=q.forwardRef(He)},"./node_modules/@ant-design/icons/es/icons/OrderedListOutlined.js":function(me,L,t){"use strict";var X=t("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),q=t("./node_modules/react/index.js"),we={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M920 760H336c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0-568H336c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H336c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM216 712H100c-2.2 0-4 1.8-4 4v34c0 2.2 1.8 4 4 4h72.4v20.5h-35.7c-2.2 0-4 1.8-4 4v34c0 2.2 1.8 4 4 4h35.7V838H100c-2.2 0-4 1.8-4 4v34c0 2.2 1.8 4 4 4h116c2.2 0 4-1.8 4-4V716c0-2.2-1.8-4-4-4zM100 188h38v120c0 2.2 1.8 4 4 4h40c2.2 0 4-1.8 4-4V152c0-4.4-3.6-8-8-8h-78c-2.2 0-4 1.8-4 4v36c0 2.2 1.8 4 4 4zm116 240H100c-2.2 0-4 1.8-4 4v36c0 2.2 1.8 4 4 4h68.4l-70.3 77.7a8.3 8.3 0 00-2.1 5.4V592c0 2.2 1.8 4 4 4h116c2.2 0 4-1.8 4-4v-36c0-2.2-1.8-4-4-4h-68.4l70.3-77.7a8.3 8.3 0 002.1-5.4V432c0-2.2-1.8-4-4-4z"}}]},name:"ordered-list",theme:"outlined"},Ce=we,Se=t("./node_modules/@ant-design/icons/es/components/AntdIcon.js"),He=function(e,l){return q.createElement(Se.a,Object(X.a)(Object(X.a)({},e),{},{ref:l,icon:Ce}))};He.displayName="OrderedListOutlined";var Xe=L.a=q.forwardRef(He)},"./node_modules/@ant-design/icons/es/icons/PercentageOutlined.js":function(me,L,t){"use strict";var X=t("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),q=t("./node_modules/react/index.js"),we={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M855.7 210.8l-42.4-42.4a8.03 8.03 0 00-11.3 0L168.3 801.9a8.03 8.03 0 000 11.3l42.4 42.4c3.1 3.1 8.2 3.1 11.3 0L855.6 222c3.2-3 3.2-8.1.1-11.2zM304 448c79.4 0 144-64.6 144-144s-64.6-144-144-144-144 64.6-144 144 64.6 144 144 144zm0-216c39.7 0 72 32.3 72 72s-32.3 72-72 72-72-32.3-72-72 32.3-72 72-72zm416 344c-79.4 0-144 64.6-144 144s64.6 144 144 144 144-64.6 144-144-64.6-144-144-144zm0 216c-39.7 0-72-32.3-72-72s32.3-72 72-72 72 32.3 72 72-32.3 72-72 72z"}}]},name:"percentage",theme:"outlined"},Ce=we,Se=t("./node_modules/@ant-design/icons/es/components/AntdIcon.js"),He=function(e,l){return q.createElement(Se.a,Object(X.a)(Object(X.a)({},e),{},{ref:l,icon:Ce}))};He.displayName="PercentageOutlined";var Xe=L.a=q.forwardRef(He)},"./node_modules/@ant-design/icons/es/icons/SaveOutlined.js":function(me,L,t){"use strict";var X=t("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),q=t("./node_modules/react/index.js"),we={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},Ce=we,Se=t("./node_modules/@ant-design/icons/es/components/AntdIcon.js"),He=function(e,l){return q.createElement(Se.a,Object(X.a)(Object(X.a)({},e),{},{ref:l,icon:Ce}))};He.displayName="SaveOutlined";var Xe=L.a=q.forwardRef(He)},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/lib/components/InsightLegend/InsightLegend.scss":function(me,L,t){var X=t("./node_modules/css-loader/dist/runtime/api.js");L=X(!1),L.push([me.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.insight-legend-button{display:flex;align-items:center}.insight-legend-button .insight-legend-button-title{margin-left:.5rem;font-size:14px;font-weight:500}.insight-legend-menu{box-shadow:none!important;border:1px solid rgba(0,0,0,.15);background-color:#fff;border-radius:4px;max-width:300px;width:100%;max-height:100%;overflow-y:auto;overflow-x:auto;display:flex;flex-direction:column}.insight-legend-menu .insight-legend-menu-scroll .insight-legend-menu-item{width:100%}.insight-legend-menu .insight-legend-menu-scroll .insight-legend-menu-item .insight-legend-menu-item-inner{cursor:pointer;display:flex;align-items:center}.insight-legend-menu .insight-legend-menu-scroll .insight-legend-menu-item .insight-legend-menu-item-inner .insights-label{width:100%;font-size:.75rem}",""]),me.exports=L},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/lib/components/PropertiesTable.scss":function(me,L,t){var X=t("./node_modules/css-loader/dist/runtime/api.js");L=X(!1),L.push([me.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.properties-table-key{min-width:12rem;display:flex;align-items:center;justify-content:space-between}.property-value-type{display:flex;align-items:center;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;height:1.25rem;padding:.125rem .25rem;letter-spacing:.25px;border-radius:var(--radius);border:1px solid var(--border-light);background:var(--bg-mid);color:var(--muted-alt);font-size:.625rem;font-weight:500;text-transform:uppercase;cursor:default}.property-value-type:not(:first-child){margin-left:.25rem}.properties-table-value{min-width:12rem;max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content;display:flex;align-items:center}.properties-table-value .value-link>*{vertical-align:middle}.properties-table-value .value-link>svg{margin-left:.25rem;font-size:1rem}.properties-table-value .editable{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;-webkit-text-decoration-color:#5375ff;text-decoration-color:#5375ff;cursor:pointer}",""]),me.exports=L},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/experiments/Experiment.scss":function(me,L,t){var X=t("./node_modules/css-loader/dist/runtime/api.js");L=X(!1),L.push([me.i,'.text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.experiment-form .metrics-selection{border-top:1px solid rgba(0,0,0,.15);padding-top:1rem;width:100%}.experiment-form .metrics-selection .action-filters-bordered .draggable-action-filter{border-bottom:1px solid rgba(0,0,0,.15);padding:1rem .25rem;margin-top:0}.experiment-form .metrics-selection .action-filters-bordered .row-action-btn{color:#35416b}.experiment-form .person-selection{width:100%;border-top:1px solid rgba(0,0,0,.15);padding-top:1rem;align-items:center;justify-content:space-between}.experiment-form .insights-graph-container{margin-bottom:1rem;background-color:#fff}.experiment-form .insights-graph-container .ant-card-head{border-bottom:1px solid rgba(0,0,0,.15);min-height:unset;background-color:#fff;padding-left:1rem;padding-right:1rem}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title{padding:.5rem 0}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter{font-size:14px}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter:not(:last-child),.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter span.head-title-item{margin-right:.5rem}.experiment-form .insights-graph-container .display-config-inner{display:flex;align-items:center;justify-content:space-between;overflow-x:auto}.experiment-form .insights-graph-container .ant-card-body{padding:0}.experiment-form .insights-graph-container .insights-graph-container-row .insights-graph-container-row-left{width:100%}.experiment-form .insights-graph-container .insights-graph-container-row .insights-graph-container-row-right{width:100%;height:min(calc(90vh - 16rem),36rem);max-width:300px;padding:0 1rem 1rem 0;display:flex;align-items:center}.experiment-form .insights-graph-container .graph-container{width:calc(100% - 2rem);height:calc(100% - 3rem)}.experiment-form .insights-graph-header{margin-top:0!important;margin-bottom:0!important;padding-left:1rem;padding-right:1rem;min-height:48px}.experiment-form .experiment-preview{margin-bottom:1rem;border-bottom:1px solid rgba(0,0,0,.15)}.experiment-form .experiment-preview .mde-slider .ant-slider-handle{border:none}.experiment-form .experiment-preview .mde-slider .ant-slider-rail{background-color:#e5ebff}.experiment-form .variants{margin-top:.5rem;padding-bottom:1rem}.experiment-form .variants .ant-form-horizontal{min-height:32px}.experiment-form .variants .border-top{border-top-left-radius:4px;border-top-right-radius:4px}.experiment-form .variants .border-bottom{border-bottom-left-radius:4px;border-bottom-right-radius:4px}.experiment-form .variants .feature-flag-variant{display:flex;align-items:center;height:3.5rem;padding:0 .5rem;background:#fff;border-bottom-width:1px;border-bottom-color:rgba(0,0,0,.15);border-top:1px solid rgba(0,0,0,.15);border-left:1px solid rgba(0,0,0,.15);border-right:1px solid rgba(0,0,0,.15)}.experiment-form .variants .feature-flag-variant .ant-form-item-explain-error{margin-top:.5rem;color:#bf411a}.experiment-form .variants .feature-flag-variant .ant-form-item-label{padding:0}.experiment-form .variants .variant-label{display:flex;flex-direction:row;justify-content:center;align-items:center;border-radius:4px;color:#fff;min-width:52px;padding:2px 6px;margin-right:8px;font-size:12px;font-weight:500;letter-spacing:.01em}.experiment-form .secondary-metrics{margin-top:1rem;padding-top:1rem;border-top:1px solid rgba(0,0,0,.15);margin-bottom:1rem}.experiment-form .ant-input-number-disabled,.experiment-form .ant-input[disabled]{color:#000}.view-experiment .draft-header{margin-bottom:1rem;border-bottom:1px solid rgba(0,0,0,.15)}.view-experiment .exp-description{font-style:italic;color:rgba(0,0,0,.5)}.view-experiment .participants{background-color:#fff}.view-experiment .participants .ant-collapse-header{padding-top:.5rem;padding-bottom:.5rem;padding-left:.75rem}.view-experiment .variants-list{list-style:none;margin:0;padding:0}.view-experiment .variants-list li{display:inline}.view-experiment .variants-list li:after{content:", "}.view-experiment .variants-list li:last-child:after{content:""}.view-experiment .experiment-result{padding-top:1rem}.view-experiment .significant-results{padding:.5rem;width:100%;background:rgba(119,185,108,.1);border-radius:4px;text-align:center;margin-bottom:1rem}.view-experiment .not-significant-results{padding:.5rem;width:100%;background:rgba(83,117,255,.1);border-radius:4px;margin-bottom:1rem}.view-experiment .feature-flag-mods{padding:.5rem;width:100%;background:#f6ebf8;border-radius:4px;margin-bottom:1rem}.view-experiment .ant-collapse-content-box{display:flex;flex-flow:column}.view-experiment .secondary-progress{margin-top:.5rem}.view-experiment .secondary-progress li:before{content:"\u2022";display:inline-block;font-weight:900;margin-right:4px}.view-experiment .secondary-progress .ant-progress-inner,.view-experiment .secondary-progress .ant-progress-inner .ant-progress-bg{border-radius:4px}.view-experiment .no-experiment-results{display:flex;justify-content:center;align-items:center;margin-top:1rem;background-color:#fafaf9;border:1px solid rgba(0,0,0,.15);width:100%;min-height:320px;font-size:24px}.view-experiment .end-experiment-btn{background:#77b96c;color:#fff}.view-experiment .end-experiment-btn:hover{color:#000}.preview-conversion-goal-num{height:24px;width:24px;text-align:center;background-color:#fafaf9;color:#35416b;font-weight:700;margin-right:.5rem}.experiment-preview-row{border-bottom:1px solid rgba(0,0,0,.15);padding-bottom:1rem;margin-bottom:1rem}.experiment-preview-row:last-child{border-bottom:none;padding-bottom:0;margin-bottom:0}.metric-name{border:1px solid rgba(0,0,0,.15);border-radius:4px;padding:8px 8px 8px 16px;margin-left:.5rem;flex:1}.experiment-implementation-details,.experiment-workflow{border-color:#d9d9d9}.experiment-implementation-details .ant-card-head,.experiment-workflow .ant-card-head{padding-left:1rem;padding-right:1rem;border:none}.experiment-implementation-details .ant-card-head-title,.experiment-workflow .ant-card-head-title{border-bottom:1px solid rgba(0,0,0,.15)}.experiment-implementation-details .exp-workflow-step,.experiment-workflow .exp-workflow-step{margin-bottom:.5rem;padding:.5rem;border-radius:4px}.experiment-implementation-details .exp-workflow-step:hover,.experiment-workflow .exp-workflow-step:hover{cursor:pointer}.experiment-implementation-details .step-completed,.experiment-workflow .step-completed{background-color:#e5ebff}',""]),me.exports=L},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/funnels/FunnelCanvasLabel.scss":function(me,L,t){var X=t("./node_modules/css-loader/dist/runtime/api.js");L=X(!1),L.push([me.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.insights-graph-header.funnels{border-bottom:1px solid rgba(0,0,0,.15)}.insights-graph-header.funnels .funnel-canvas-label .ant-btn-link{padding:0}.insights-graph-header.funnels .funnel-canvas-label .ant-btn-link:disabled{cursor:default;color:#2d2d2d}.insights-graph-header.funnels .funnel-canvas-label .funnel-options-label{padding:4px}.insights-graph-header.funnels .funnel-canvas-label .funnel-options-inputs{align-items:center;padding:4px}",""]),me.exports=L},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/FunnelCorrelation.scss":function(me,L,t){var X=t("./node_modules/css-loader/dist/runtime/api.js");L=X(!1),L.push([me.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.funnel-correlation{margin-bottom:3rem}.funnel-correlation .skew-warning{margin-top:1rem;line-height:2em;border:1px solid #f7a501}.funnel-correlation .skew-warning .ant-card-body{padding:.5rem 1rem}.funnel-correlation .skew-warning h4{font-size:1.1em;display:flex;align-items:center;border-bottom:1px solid rgba(0,0,0,.15);padding:.5rem 1rem;margin-left:-1rem;margin-right:-1rem;position:relative}.funnel-correlation .skew-warning h4 .close-button{position:absolute;right:16px;color:rgba(0,0,0,.5)!important;cursor:pointer}.funnel-correlation .skew-warning b{padding-bottom:.5rem;font-weight:500}.funnel-correlation .correlation-feedback{margin-top:1rem}.funnel-correlation .correlation-feedback .ant-card-body{padding:.5rem 1rem}.funnel-correlation .correlation-feedback h4{padding:0;margin:0;font-weight:700;color:#747ea1}.funnel-correlation .correlation-feedback .emoji-button{margin-right:4px}.funnel-correlation .correlation-feedback .emoji-button:last-of-type{margin-right:0}.funnel-correlation .correlation-feedback .row-initial{display:flex;align-items:center}.funnel-correlation .correlation-feedback .row-initial .ant-col{text-align:right}.funnel-correlation .correlation-feedback .row-initial .ant-col:first-of-type{text-align:left}.funnel-correlation .correlation-feedback .close-button{color:rgba(0,0,0,.5)!important;cursor:pointer;z-index:5}.funnel-correlation .correlation-feedback .feedback-button{margin:1rem 0}",""]),me.exports=L},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/InsightTabs/FunnelTab/CorrelationMatrix.scss":function(me,L,t){var X=t("./node_modules/css-loader/dist/runtime/api.js");L=X(!1),L.push([me.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.correlation-matrix .ant-modal-body{display:flex;justify-content:center}.correlation-matrix .correlation-table-wrapper table{border-radius:4px;border:1px solid rgba(0,0,0,.15);border-collapse:separate;border-spacing:0;margin:0 auto}.correlation-matrix .correlation-table-wrapper table td{padding:.5rem 1rem;border-left:1px solid rgba(0,0,0,.15);border-top:1px solid rgba(0,0,0,.15);text-align:center}.correlation-matrix .correlation-table-wrapper table td .percentage{font-weight:700;padding-bottom:.25rem}.correlation-matrix .correlation-table-wrapper table td:first-child{border-left:none}.correlation-matrix .correlation-table-wrapper table .table-title{color:#747ea1}.correlation-matrix .correlation-table-wrapper table .table-title td{border-top:none}.correlation-matrix .correlation-table-wrapper table .horizontal-header,.correlation-matrix .correlation-table-wrapper table thead{font-weight:700;background-color:#fafafa;text-transform:uppercase;color:rgba(0,0,0,.5)}.correlation-matrix .correlation-table-wrapper table tbody td:not(.horizontal-header){text-align:right}",""]),me.exports=L},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/InsightTabs/FunnelTab/FunnelCorrelationTable.scss":function(me,L,t){var X=t("./node_modules/css-loader/dist/runtime/api.js");L=X(!1),L.push([me.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.funnel-correlation-table{margin-top:1rem;border:1px solid rgba(0,0,0,.15);border-radius:4px}.funnel-correlation-table .ant-table thead th{border-bottom:1px solid rgba(0,0,0,.15)}.funnel-correlation-table .funnel-correlation-header{background:#f2f2f2;display:flex;align-self:stretch;justify-content:space-between;align-content:space-between;border-top-left-radius:4px;border-top-right-radius:4px;padding-bottom:5px}.funnel-correlation-table .funnel-correlation-header .table-header{font-style:normal;font-weight:700;font-size:11px;line-height:16px;padding-bottom:4px;display:flex;align-items:center;letter-spacing:.02em;text-transform:uppercase;color:#2d2d2d;margin-left:1rem;margin-top:.5rem}.funnel-correlation-table .funnel-correlation-header .table-options{display:flex;flex-grow:1;justify-content:flex-end;align-items:center;margin-top:5px}.funnel-correlation-table .funnel-correlation-header .table-options .title{font-family:Inter;font-style:normal;font-weight:600;font-size:11px;line-height:16px;display:flex;align-items:center;letter-spacing:.02em;text-transform:uppercase;margin:5px;color:rgba(0,0,0,.5)}.funnel-correlation-table .column-info{color:#747ea1;cursor:pointer;padding-left:4px}.funnel-correlation-table .nested-properties-table{margin:1rem;border:1px solid rgba(0,0,0,.15);border-radius:4px}.funnel-correlation-table .nested-properties-table thead th{border-bottom:1px solid rgba(0,0,0,.15)}.funnel-correlation-table .nested-properties-loading{text-align:center;padding:2rem 0}.funnel-correlation-table .nested-properties-loading h3{font-size:1rem;font-weight:700;margin-bottom:0}.funnel-correlation-table .nested-properties-loading h3 p{color:#747ea1}",""]),me.exports=L},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/trends/PersonsModal.scss":function(me,L,t){var X=t("./node_modules/css-loader/dist/runtime/api.js");L=X(!1),L.push([me.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.person-modal .ant-modal-header{padding:1rem}.person-modal .ant-modal-title{overflow:hidden;text-overflow:ellipsis}.person-modal .ant-modal-content{overflow:hidden}.person-modal .ant-modal-body{padding:0;max-height:60vh;overflow-y:auto}.person-modal .ant-modal-footer .ant-btn{color:#5375ff}.person-modal .ant-input-search{padding:1rem}.person-modal .persons-table{border-top:1px solid var(--border);border-bottom:1px solid var(--border)}.person-modal .person-ids{display:flex;flex-direction:column}.person-modal .user-count-subheader{padding:.5rem 1rem;color:var(--muted-alt)}.person-modal .user-count-subheader>*{vertical-align:middle}.person-modal .person-row-container{padding:.5rem 1rem}.person-modal .data-point-selector{padding:.5rem 1rem;border-bottom:1px solid var(--border)}.person-modal .data-point-selector .ant-select{display:block;width:100%}",""]),me.exports=L}}]);
