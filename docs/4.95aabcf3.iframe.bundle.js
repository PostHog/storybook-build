(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"./frontend/src/lib/components/ExportButton/ExportButton.tsx":function(J,p,e){"use strict";e.d(p,"a",function(){return s});var F=e("./node_modules/@babel/runtime/helpers/extends.js"),ye=e.n(F),R=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),t=e.n(R),i=e("./node_modules/core-js/modules/es.array.map.js"),O=e.n(i),q=e("./node_modules/core-js/modules/es.regexp.exec.js"),fe=e.n(q),ne=e("./node_modules/core-js/modules/es.string.split.js"),Be=e.n(ne),ee=e("./node_modules/react/index.js"),N=e.n(ee),X=e("./frontend/src/lib/components/LemonButton/index.ts"),H=e("./node_modules/kea/lib/index.esm.js"),B=e("./frontend/src/lib/components/ExportButton/exporterLogic.ts"),de=e("./frontend/src/lib/components/LemonDivider/index.ts"),G=e("./frontend/src/scenes/insights/insightLogic.ts"),U=["dashboardId","insightShortId"];function s(_){var P=_.dashboardId,Y=_.insightShortId,A=t()(_,U),te={dashboardItemId:Y,doNotLoad:!0},l=Object(H.useValues)(Object(G.c)(te)),v=l.supportsCsvExport,T=l.csvExportUrl,m=l.insight,ae=Object(H.useActions)(Object(B.b)({dashboardId:P,insightId:m==null?void 0:m.id})),pe=ae.exportItem,le=Object(H.useValues)(Object(B.b)({dashboardId:P,insightId:m==null?void 0:m.id})),Se=le.exportInProgress,E=[];(P||Y)&&E.push(B.a.PNG),v&&E.push(B.a.CSV);var ie=function(Q){if(Q===B.a.CSV){window.open(T,"_blank");return}pe(Q)};return N.a.createElement(X.b,ye()({type:"stealth",loading:Se,"data-attr":"export-button"},A,{popup:{actionable:!0,placement:"right-start",overlay:N.a.createElement(N.a.Fragment,null,N.a.createElement("h5",null,"File type"),N.a.createElement(de.a,null),E.map(function(ce){return N.a.createElement(X.a,{key:ce,fullWidth:!0,type:"stealth",onClick:function(){return ie(ce)},"data-attr":"export-button-".concat(ce.split("/").pop())},".",ce.split("/").pop())}))}}),"Export")}try{s.displayName="ExportButton",s.__docgenInfo={description:"",displayName:"ExportButton",props:{dashboardId:{defaultValue:null,description:"",name:"dashboardId",required:!1,type:{name:"number"}},insightShortId:{defaultValue:null,description:"",name:"insightShortId",required:!1,type:{name:"InsightShortId"}},icon:{defaultValue:null,description:"",name:"icon",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>> | null"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"alt"'},{value:'"default"'},{value:'"highlighted"'},{value:'"primary"'},{value:'"secondary"'},{value:'"tertiary"'},{value:'"stealth"'}]}},fullWidth:{defaultValue:null,description:"Whether the row should take up the parent's full width.",name:"fullWidth",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/ExportButton/ExportButton.tsx#ExportButton"]={docgenInfo:s.__docgenInfo,name:"ExportButton",path:"frontend/src/lib/components/ExportButton/ExportButton.tsx#ExportButton"})}catch(_){}},"./frontend/src/lib/components/ExportButton/exporterLogic.ts":function(J,p,e){"use strict";e.d(p,"a",function(){return W}),e.d(p,"b",function(){return Ge});var F=e("./node_modules/core-js/modules/es.object.keys.js"),ye=e.n(F),R=e("./node_modules/core-js/modules/es.symbol.js"),t=e.n(R),i=e("./node_modules/core-js/modules/es.array.filter.js"),O=e.n(i),q=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),fe=e.n(q),ne=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Be=e.n(ne),ee=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),N=e.n(ee),X=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),H=e.n(X),B=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),de=e.n(B),G=e("./node_modules/@babel/runtime/regenerator/index.js"),U=e.n(G),s=e("./node_modules/core-js/modules/es.array.concat.js"),_=e.n(s),P=e("./node_modules/core-js/modules/es.array.iterator.js"),Y=e.n(P),A=e("./node_modules/core-js/modules/es.object.to-string.js"),te=e.n(A),l=e("./node_modules/core-js/modules/es.string.iterator.js"),v=e.n(l),T=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),m=e.n(T),ae=e("./node_modules/core-js/modules/web.url.js"),pe=e.n(ae),le=e("./node_modules/core-js/modules/web.url-search-params.js"),Se=e.n(le),E=e("./node_modules/kea/lib/index.esm.js"),ie=e("./frontend/src/lib/api.ts"),ce=e("./frontend/src/lib/utils.tsx"),Q=e("./node_modules/posthog-js/dist/es.js"),ue=e("./frontend/src/lib/components/lemonToast.tsx");function $(c,f){var h=Object.keys(c);if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(c);f&&(M=M.filter(function(Z){return Object.getOwnPropertyDescriptor(c,Z).enumerable})),h.push.apply(h,M)}return h}function S(c){for(var f=1;f<arguments.length;f++){var h=arguments[f]!=null?arguments[f]:{};f%2?$(Object(h),!0).forEach(function(M){H()(c,M,h[M])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(h)):$(Object(h)).forEach(function(M){Object.defineProperty(c,M,Object.getOwnPropertyDescriptor(h,M))})}return c}var We=1e3,me=10,W;(function(c){c.PNG="image/png",c.CSV="text/csv",c.PDF="application/pdf"})(W||(W={}));function Ue(c){return Ce.apply(this,arguments)}function Ce(){return Ce=de()(U.a.mark(function c(f){var h,M,Z,_e,z;return U.a.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return h=ie.b.exports.determineExportUrl(f.id),K.next=3,ie.b.getRaw(h);case 3:return M=K.sent,K.next=6,M.blob();case 6:Z=K.sent,_e=window.URL.createObjectURL(Z),z=document.createElement("a"),z.style.display="none",z.href=_e,z.download=f.filename,document.body.appendChild(z),z.click(),window.URL.revokeObjectURL(_e);case 15:case"end":return K.stop()}},c)})),Ce.apply(this,arguments)}var Ge=Object(E.kea)([Object(E.path)(["lib","components","ExportButton","ExporterLogic"]),Object(E.props)({}),Object(E.key)(function(c){var f=c.dashboardId,h=c.insightId;return"dash:".concat(f,"::insight:").concat(h)}),Object(E.actions)({exportItem:function(f,h,M,Z){return{exportFormat:f,exportContext:h,exportParams:M,successCallback:Z}},exportItemSuccess:!0,exportItemFailure:!0}),Object(E.reducers)({exportInProgress:[!1,{exportItem:function(){return!0},exportItemSuccess:function(){return!1},exportItemFailure:function(){return!1}}]}),Object(E.listeners)(function(c){var f=c.actions,h=c.props;return{exportItem:function(){var M=de()(U.a.mark(function _e(z){var xe,K,Ke,ve,be,Ie,he,Le;return U.a.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return xe=z.exportFormat,K=z.exportContext,Ke=z.exportParams,ve=z.successCallback,ue.d.info("Export started..."),be={export_format:xe,dashboard:h.dashboardId,insight:h.insightId,total_time_ms:0},Ie=performance.now(),b.prev=4,b.next=7,ie.b.exports.create(S({export_format:xe,dashboard:h.dashboardId,insight:h.insightId},K||{}),Ke);case 7:if(he=b.sent,he.id){b.next=10;break}throw new Error("Missing export_id from response");case 10:Le=0;case 11:if(!(Le<me)){b.next=29;break}if(Le++,!he.has_content){b.next=22;break}return f.exportItemSuccess(),ue.d.success("Export complete."),ve==null||ve(),b.next=19,Ue(he);case 19:return be.total_time_ms=performance.now()-Ie,Q.a.capture("export succeeded",be),b.abrupt("return");case 22:return b.next=24,Object(ce.w)(We);case 24:return b.next=26,ie.b.exports.get(he.id);case 26:he=b.sent,b.next=11;break;case 29:throw new Error("Content not loaded in time...");case 32:b.prev=32,b.t0=b.catch(4),f.exportItemFailure(),be.total_time_ms=performance.now()-Ie,Q.a.capture("export failed",be),ue.d.error("Export failed: ".concat(JSON.stringify(b.t0)));case 38:case"end":return b.stop()}},_e,null,[[4,32]])}));function Z(_e){return M.apply(this,arguments)}return Z}()}})])},"./frontend/src/lib/hooks/useKeyboardHotkeys.tsx":function(J,p,e){"use strict";e.d(p,"a",function(){return de});var F=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),ye=e.n(F),R=e("./node_modules/core-js/modules/es.array.includes.js"),t=e.n(R),i=e("./node_modules/core-js/modules/es.string.includes.js"),O=e.n(i),q=e("./node_modules/core-js/modules/es.object.to-string.js"),fe=e.n(q),ne=e("./node_modules/core-js/modules/es.object.keys.js"),Be=e.n(ne),ee=e("./node_modules/core-js/modules/es.array.concat.js"),N=e.n(ee),X=e("./frontend/src/lib/hooks/useEventListener.ts"),H=function(U,s){var _=U.composedPath()||U.path;if(!_)return!1;var P=_[0],Y=P.tagName||"not an html element";return s.includes(Y.toLowerCase())},B=[".hotkey-block",".hotkey-block *"];function de(G,U){var s=["input","textarea"];Object(X.a)("keydown",function(_){var P=_.key;if(!(_.metaKey||_.ctrlKey||_.altKey)&&!B.some(function(T){return _.target.matches(T)})){var Y=s.includes(_.target.tagName.toLowerCase());if(!(P!=="Escape"&&(Y||H(_,s))))for(var A=0,te=Object.keys(G);A<te.length;A++){var l=te[A],v=G[l];if(!(!v||v.disabled)&&P.toLowerCase()===l){_.preventDefault(),v.action();break}}}},void 0,[G].concat(ye()(U||[])))}},"./frontend/src/scenes/dashboard/Dashboard.tsx":function(J,p,e){"use strict";e.r(p),e.d(p,"scene",function(){return jt}),e.d(p,"Dashboard",function(){return ze});var F=e("./node_modules/core-js/modules/es.array.includes.js"),ye=e("./node_modules/core-js/modules/es.string.includes.js"),R=e("./node_modules/react/index.js"),t=e.n(R),i=e("./node_modules/kea/lib/index.esm.js"),O=e("./frontend/src/scenes/dashboard/dashboardLogic.ts"),q=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),fe=e.n(q),ne=e("./node_modules/core-js/modules/es.array.map.js"),Be=e("./node_modules/core-js/modules/es.function.name.js"),ee=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),N=e.n(ee),X=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/DashboardItems.scss"),H=e.n(X),B={};B.insert="head",B.singleton=!1;var de=N()(H.a,B),G=H.a.locals||{},U=e("./node_modules/react-grid-layout/index.js"),s=e("./frontend/src/types.ts"),_=e("./frontend/src/models/insightsModel.tsx"),P=e("./node_modules/clsx/dist/clsx.m.js"),Y=e("./frontend/src/lib/components/InsightCard/index.tsx"),A=e("./frontend/src/lib/hooks/useResizeObserver.ts");function te(){var r=Object(i.useValues)(O.c),a=r.dashboard,n=r.items,d=r.layouts,o=r.dashboardMode,I=r.placement,D=r.isRefreshing,y=r.highlightedInsightId,x=r.refreshStatus,C=Object(i.useActions)(O.c),se=C.updateLayouts,L=C.updateContainerWidth,u=C.updateItemColor,V=C.removeItem,ge=C.refreshAllDashboardItems,re=Object(i.useActions)(_.a),Pe=re.duplicateInsight,Ae=re.renameInsight,je=re.moveToDashboard,Me=Object(R.useState)(null),Ve=fe()(Me,2),Te=Ve[0],we=Ve[1],Re=Object(R.useRef)(!1),Oe=Object(R.useRef)(null),Je=Object(P.a)({"dashboard-view-mode":o!==s.k.Edit,"dashboard-edit-mode":o===s.k.Edit}),He=Object(A.b)(),Ee=He.width,g=He.ref,oe=!Ee||Ee>O.a.sm;return t.a.createElement("div",{className:"dashboard-items-wrapper",ref:g},t.a.createElement(U.Responsive,{width:Ee||0,className:Je,isDraggable:o===s.k.Edit,isResizable:o===s.k.Edit,layouts:d,rowHeight:80,margin:[16,16],containerPadding:[0,0],onLayoutChange:function(De,k){o===s.k.Edit&&se(k)},onWidthChange:function(De,k,w){L(De,w)},breakpoints:O.a,resizeHandles:oe?["s","e","se"]:["s"],cols:O.b,onResize:function(De,k,w){(!Te||Te.w!==w.w||Te.h!==w.h)&&we(w)},onResizeStop:function(){we(null)},onDrag:function(){Re.current=!0,Oe.current&&window.clearTimeout(Oe.current)},onDragStop:function(){Oe.current&&window.clearTimeout(Oe.current),Oe.current=window.setTimeout(function(){Re.current=!1},250)},draggableCancel:".anticon,.ant-dropdown,table,.ant-popover-content,button,.Popup"},n==null?void 0:n.map(function(j){var De;return t.a.createElement(Y.a,{key:j.short_id,insight:j,dashboardId:a==null?void 0:a.id,loading:D(j.short_id),apiErrored:((De=x[j.short_id])===null||De===void 0?void 0:De.error)||!1,highlighted:y&&j.short_id===y,showResizeHandles:o===s.k.Edit,canResizeWidth:oe,updateColor:function(w){return u(j.id,w)},removeFromDashboard:function(){return V(j)},refresh:function(){return ge([j])},rename:function(){return Ae(j)},duplicate:function(){return Pe(j)},moveToDashboardOld:function(w){return Pe(j,w,!0)},moveToDashboard:function(w){var Ot=w.id,Dt=w.name;if(!a)throw new Error("must be on a dashboard to move an insight");je(j,a.id,Ot,Dt)},showEditingControls:[s.l.Dashboard,s.l.ProjectHomepage].includes(I),showDetailsControls:I!=s.l.Export})})))}var l=e("./frontend/src/lib/components/DateFilter/DateFilter.tsx"),v=e("./node_modules/@ant-design/icons/es/icons/CalendarOutlined.js"),T=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/Dashboard.scss"),m=e.n(T),ae={};ae.insert="head",ae.singleton=!1;var pe=N()(m.a,ae),le=m.a.locals||{},Se=e("./frontend/src/lib/hooks/useKeyboardHotkeys.tsx"),E=e("./frontend/src/lib/utils/eventUsageLogic.ts"),ie=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),ce=e("./node_modules/core-js/modules/es.array.fill.js"),Q=e("./node_modules/antd/es/card/index.js"),ue=e("./node_modules/antd/es/row/index.js"),$=e("./node_modules/antd/es/col/index.js"),S=e("./node_modules/antd/es/skeleton/index.js"),We=e("./frontend/src/lib/components/Link.tsx"),me=e("./frontend/src/scenes/urls.ts"),W=e("./frontend/src/lib/components/LemonButton/index.ts");function Ue(r){var a=r.active;return t.a.createElement(Q.a,{className:"hide-lte-lg"},t.a.createElement(ue.a,null,t.a.createElement($.a,{span:12},t.a.createElement(S.a,{paragraph:{rows:1},active:a}),t.a.createElement("div",{className:"mt"},t.a.createElement("div",{className:"mt"},t.a.createElement(S.a.Button,{active:a}),t.a.createElement(S.a.Button,{active:a,style:{marginLeft:4,width:140}})),t.a.createElement("div",{className:"mt"},t.a.createElement(S.a.Button,{active:a}),t.a.createElement(S.a.Button,{active:a,style:{marginLeft:4,width:140}})),t.a.createElement("div",{className:"mt"},t.a.createElement(S.a.Button,{active:a}),t.a.createElement(S.a.Button,{active:a,style:{marginLeft:4,width:140}})))),t.a.createElement($.a,{span:12},t.a.createElement("div",{className:"skeleton-actions"},t.a.createElement(S.a.Avatar,{active:a,shape:"circle",size:"small"}),t.a.createElement(S.a.Avatar,{active:a,shape:"circle",size:"small"})),t.a.createElement(S.a.Avatar,{active:a,shape:"circle",size:"large",className:"pie-chart"}))))}function Ce(){return t.a.createElement("div",{className:"bar-chart ant-skeleton-content"},Array(8).fill(0).map(function(r,a){var n=200,d=40,o=Math.floor(Math.random()*(n-d+1))+d;return t.a.createElement("div",{className:"bar-el ant-skeleton-title",key:a,style:{height:o}})}))}var Ge=t.a.memo(Ce);function c(r){var a=r.active;return t.a.createElement(Q.a,{className:Object(P.a)("ant-skeleton",a&&"ant-skeleton-active")},t.a.createElement(ue.a,null,t.a.createElement($.a,{span:12},t.a.createElement(S.a,{active:a,paragraph:{rows:1}})),t.a.createElement($.a,{span:12},t.a.createElement("div",{className:"skeleton-actions"},t.a.createElement(S.a.Avatar,{active:a,shape:"circle",size:"small"}),t.a.createElement(S.a.Avatar,{active:a,shape:"circle",size:"small"})))),t.a.createElement(Ge,null))}function f(r){var a=r.loading,n=Object(i.useValues)(O.c),d=n.dashboard;return t.a.createElement("div",{className:"empty-state"},!a&&t.a.createElement("div",{className:"cta"},t.a.createElement(Q.a,{className:"card-elevated"},t.a.createElement("h3",{className:"l3"},"Dashboard empty"),t.a.createElement("p",null,"This dashboard sure would look better with some graphs!"),t.a.createElement("div",{className:"mt text-center"},t.a.createElement(We.a,{to:me.a.insightNew(void 0,d==null?void 0:d.id)},t.a.createElement(W.a,{"data-attr":"dashboard-add-graph-header"},"Add insight"))))),t.a.createElement(ue.a,{gutter:16},t.a.createElement($.a,{span:24,lg:12},t.a.createElement(Ue,{active:a})),t.a.createElement($.a,{span:24,lg:12},t.a.createElement(c,{active:a}))),t.a.createElement(ue.a,{gutter:16,className:"fade-out-graphs"},t.a.createElement($.a,{span:24,lg:12},t.a.createElement(Ue,{active:a})),t.a.createElement($.a,{span:24,lg:12},t.a.createElement(c,{active:a}))))}try{f.displayName="EmptyDashboardComponent",f.__docgenInfo={description:"",displayName:"EmptyDashboardComponent",props:{loading:{defaultValue:null,description:"",name:"loading",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/EmptyDashboardComponent.tsx#EmptyDashboardComponent"]={docgenInfo:f.__docgenInfo,name:"EmptyDashboardComponent",path:"frontend/src/scenes/dashboard/EmptyDashboardComponent.tsx#EmptyDashboardComponent"})}catch(r){}var h=e("./frontend/src/lib/components/NotFound/index.tsx"),M=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),Z=e.n(M),_e=e("./node_modules/core-js/modules/es.array.from.js"),z=e("./node_modules/core-js/modules/es.string.iterator.js"),xe=e("./node_modules/antd/es/dropdown/index.js"),K=e("./node_modules/antd/es/menu/index.js"),Ke=e("./node_modules/antd/es/checkbox/index.js"),ve=e("./node_modules/antd/es/radio/index.js"),be=e("./node_modules/antd/es/space/index.js"),Ie=e("./node_modules/@ant-design/icons/es/icons/DownOutlined.js"),he=e("./node_modules/@ant-design/icons/es/icons/LoadingOutlined.js"),Le=e("./node_modules/@ant-design/icons/es/icons/ReloadOutlined.js"),Ye=e("./frontend/src/lib/utils.tsx"),b=e("./frontend/src/lib/components/Tooltip.tsx"),at=e("./frontend/src/lib/dayjs.ts"),Xe=function(){var a=Object(i.useValues)(O.c),n=a.lastRefreshed;return t.a.createElement("span",null,"Last updated ",t.a.createElement("b",null,n?Object(at.a)(n).fromNow():"a while ago"))},st=Z()(Array.from([60,120,300,900],function(r){return{label:Object(Ye.N)(r),value:r}}));function rt(){var r=Object(i.useValues)(O.c),a=r.itemsLoading,n=r.autoRefresh,d=r.refreshMetrics,o=Object(i.useActions)(O.c),I=o.refreshAllDashboardItemsManual,D=o.setAutoRefresh,y=Object(R.useState)(!1),x=fe()(y,2),C=x[0],se=x[1];return t.a.createElement(t.a.Fragment,null,t.a.createElement(xe.a.Button,{overlay:t.a.createElement(K.a,{"data-attr":"auto-refresh-picker",id:"auto-refresh-picker"},t.a.createElement("div",{id:"auto-refresh-check",key:"auto-refresh-check",onClick:function(u){u.stopPropagation(),se(!0),D(!n.enabled,n.interval)}},t.a.createElement(b.a,{title:"Refresh dashboard automatically",placement:"bottomLeft"},t.a.createElement(Ke.a,{onChange:function(u){u.stopPropagation(),u.preventDefault()},checked:n.enabled}),t.a.createElement("label",{style:{marginLeft:10,cursor:"pointer"}},"Auto refresh"))),t.a.createElement(K.a.Divider,null),t.a.createElement(K.a.ItemGroup,{title:"Refresh interval"},t.a.createElement(ve.a.Group,{onChange:function(u){D(!0,parseInt(u.target.value))},value:n.interval,style:{width:"100%"}},t.a.createElement(be.b,{direction:"vertical",style:{width:"100%"}},st.map(function(L){var u=L.label,V=L.value;return t.a.createElement(ve.a,{key:V,value:V,style:{width:"100%"}},u)}))))),trigger:["click"],onClick:function(){return I()},icon:t.a.createElement(Ie.a,null),disabled:a,buttonsRender:function(u){var V=fe()(u,2),ge=V[0],re=V[1];return[t.a.cloneElement(ge,{style:{paddingLeft:10}}),re]},visible:C,onVisibleChange:function(u){return se(u)}},t.a.createElement("span",{className:"dashboard-items-action-icon"},a?t.a.createElement(he.a,null):t.a.createElement(Le.a,null)),t.a.createElement("span",{className:Object(P.a)("dashboard-items-action-refresh-text",{hidden:a})},t.a.createElement(Xe,null)),t.a.createElement("span",{className:Object(P.a)("dashboard-items-action-refresh-text","completed",{hidden:!a})},"Refreshed ",d.completed," out of ",d.total)))}var ot=e("./frontend/src/scenes/insights/EmptyStates/index.ts"),yt=e("./node_modules/core-js/modules/es.symbol.js"),xt=e("./node_modules/core-js/modules/es.symbol.description.js"),Pt=e("./node_modules/core-js/modules/es.array.filter.js"),Mt=e("./node_modules/core-js/modules/es.object.to-string.js"),Ct=e("./node_modules/core-js/modules/es.array.concat.js"),It=e("./node_modules/core-js/modules/es.array.join.js"),Qe=e("./frontend/src/lib/components/EditableField/EditableField.tsx");function Fe(r){var a=r.onExit,n="aside.ant-layout-sider, .layout-top-content";return Object(R.useEffect)(function(){for(var d=window.document.querySelectorAll(n),o=0;o<d.length;o++)d[o].style.display="none";var I=function(){window.document.fullscreenElement===null&&(a==null||a())};try{window.document.body.requestFullscreen().then(function(){window.addEventListener("fullscreenchange",I,!1)})}catch(D){}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch(D){}return function(){for(var D=window.document.querySelectorAll(n),y=0;y<D.length;y++)D[y].style.display="block";try{window.removeEventListener("fullscreenchange",I,!1),window.document.fullscreenElement!==null&&window.document.exitFullscreen()}catch(x){}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch(x){}}},[]),null}try{Fe.displayName="FullScreen",Fe.__docgenInfo={description:"",displayName:"FullScreen",props:{onExit:{defaultValue:null,description:"",name:"onExit",required:!1,type:{name:"(() => any)"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/FullScreen.tsx#FullScreen"]={docgenInfo:Fe.__docgenInfo,name:"FullScreen",path:"frontend/src/lib/components/FullScreen.tsx#FullScreen"})}catch(r){}var nt=e("./frontend/src/lib/components/LemonButton/More.tsx"),dt=e("./frontend/src/lib/components/LemonRow/index.ts"),$e=e("./frontend/src/lib/components/LemonDivider/index.ts"),Ze=e("./frontend/src/lib/components/ObjectTags/ObjectTags.tsx"),lt=e("./frontend/src/lib/components/PageHeader.tsx"),ke=e("./frontend/src/models/dashboardsModel.tsx"),it=e("./frontend/src/scenes/dashboard/dashboardsLogic.ts"),ct=e("./frontend/src/scenes/dashboard/DashboardCollaborators.tsx"),ut=e("./frontend/src/scenes/userLogic.ts"),Ne=e("./frontend/src/lib/constants.tsx"),mt=e("./frontend/src/lib/components/ProfilePicture/ProfileBubbles.tsx"),ht=e("./frontend/src/scenes/dashboard/dashboardCollaboratorsLogic.ts"),Et=e("./frontend/src/lib/components/icons.tsx"),qe=e("./frontend/src/lib/logic/featureFlagLogic.ts"),ft=e("./frontend/src/lib/components/ExportButton/ExportButton.tsx"),et=e("./frontend/src/lib/components/Subscriptions/SubscriptionsModal.tsx"),pt=e("./node_modules/kea-router/lib/index.js"),_t=e("./frontend/src/lib/components/Sharing/SharingModal.tsx");function vt(){var r=Object(i.useValues)(O.c),a=r.dashboard,n=r.allItemsLoading,d=r.dashboardMode,o=r.canEditDashboard,I=r.showSubscriptions,D=r.subscriptionId,y=Object(i.useActions)(O.c),x=y.setDashboardMode,C=y.triggerDashboardUpdate,se=Object(i.useValues)(it.b),L=se.dashboardTags,u=Object(i.useActions)(ke.a),V=u.updateDashboard,ge=u.pinDashboard,re=u.unpinDashboard,Pe=u.deleteDashboard,Ae=u.duplicateDashboard,je=Object(i.useValues)(ke.a),Me=je.dashboardLoading,Ve=Object(i.useValues)(ut.a),Te=Ve.hasAvailableFeature,we=Object(i.useValues)(qe.a),Re=we.featureFlags,Oe=Re[Ne.h.EXPORT_DASHBOARD_INSIGHTS],Je=Re[Ne.h.INSIGHT_SUBSCRIPTIONS],He=Object(i.useActions)(pt.router),Ee=He.push;return a||n?t.a.createElement(t.a.Fragment,null,d===s.k.Fullscreen&&t.a.createElement(Fe,{onExit:function(){return x(null,E.a.Browser)}}),a&&t.a.createElement(t.a.Fragment,null,t.a.createElement(et.c,{visible:I,closeModal:function(){return Ee(me.a.dashboard(a.id))},dashboardId:a.id,subscriptionId:D}),t.a.createElement(_t.b,{visible:d===s.k.Sharing,closeModal:function(){return Ee(me.a.dashboard(a.id))},dashboardId:a.id})),t.a.createElement(lt.a,{title:t.a.createElement("div",{style:{display:"flex",alignItems:"center"}},t.a.createElement(Qe.a,{name:"name",value:(a==null?void 0:a.name)||(n?"Loading\u2026":""),placeholder:"Name this dashboard",onSave:a?function(g){return V({id:a.id,name:g})}:void 0,minLength:1,maxLength:400,mode:o?void 0:"view",notice:a&&!o?{icon:t.a.createElement(Et.IconLock,null),tooltip:"You don't have edit permissions in this dashboard. Ask a dashboard collaborator with edit access to add you."}:void 0})),buttons:d===s.k.Edit?t.a.createElement(W.a,{"data-attr":"dashboard-edit-mode-save",type:"primary",onClick:function(){return x(null,E.a.DashboardHeader)},tabIndex:10,disabled:n},"Done editing"):d===s.k.Fullscreen?t.a.createElement(W.a,{type:"secondary",onClick:function(){return x(null,E.a.DashboardHeader)},"data-attr":"dashboard-exit-presentation-mode",disabled:n},"Exit full screen"):t.a.createElement(t.a.Fragment,null,t.a.createElement(nt.a,{overlay:a?t.a.createElement(t.a.Fragment,null,a.created_by&&t.a.createElement(t.a.Fragment,null,t.a.createElement(dt.a,{fullWidth:!0,style:{color:"var(--muted-alt)"}},"Created by"," ",a.created_by.first_name||a.created_by.email||"-"," ","on ",Object(Ye.M)(a.created_at)),t.a.createElement($e.a,null)),o&&t.a.createElement(W.a,{onClick:function(){return x(s.k.Edit,E.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Edit layout (E)"),t.a.createElement(W.a,{onClick:function(){return x(s.k.Fullscreen,E.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Go full screen (F)"),o&&(a.pinned?t.a.createElement(W.a,{onClick:function(){return re(a.id,E.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Unpin dashboard"):t.a.createElement(W.a,{onClick:function(){return ge(a.id,E.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Pin dashboard")),Je&&t.a.createElement(et.a,{dashboardId:a.id}),Oe&&t.a.createElement(ft.a,{dashboardId:a.id,fullWidth:!0,type:"stealth"}),t.a.createElement($e.a,null),t.a.createElement(W.a,{onClick:function(){return Ae({id:a.id,name:a.name,show:!0})},type:"stealth",fullWidth:!0},"Duplicate dashboard"),o&&t.a.createElement(W.a,{onClick:function(){return Pe({id:a.id,redirect:!0})},status:"danger",type:"stealth",fullWidth:!0},"Delete dashboard")):void 0}),t.a.createElement($e.a,{vertical:!0}),a&&t.a.createElement(t.a.Fragment,null,t.a.createElement(bt,{dashboard:a,onClick:function(){return Ee(me.a.dashboardSharing(a.id))}}),t.a.createElement(W.a,{type:"secondary","data-attr":"dashboard-share-button",onClick:function(){return Ee(me.a.dashboardSharing(a.id))}},"Share")),o&&t.a.createElement(We.a,{to:me.a.insightNew(void 0,a==null?void 0:a.id)},t.a.createElement(W.a,{type:"primary","data-attr":"dashboard-add-graph-header"},"Add insight"))),caption:t.a.createElement(t.a.Fragment,null,a&&!!(o||a.description)&&t.a.createElement(Qe.a,{multiline:!0,name:"description",value:a.description||"",placeholder:"Description (optional)",onSave:function(oe){return V({id:a.id,description:oe})},compactButtons:!0,mode:o?void 0:"view",paywall:!Te(s.d.DASHBOARD_COLLABORATION)}),(a==null?void 0:a.tags)&&t.a.createElement(t.a.Fragment,null,o?t.a.createElement(Ze.a,{tags:a.tags,onChange:function(oe,j){return C({tags:j})},saving:Me,tagsAvailable:L.filter(function(g){var oe;return!((oe=a.tags)!==null&&oe!==void 0&&oe.includes(g))}),className:"insight-metadata-tags"}):a.tags.length?t.a.createElement(Ze.a,{tags:a.tags,saving:Me,staticOnly:!0,className:"insight-metadata-tags"}):null)),delimited:!0})):null}function bt(r){var a=r.dashboard,n=r.onClick,d=Object(i.useValues)(Object(ht.a)({dashboardId:a.id})),o=d.allCollaborators;if(!a)return null;var I=ct.a[a.effective_restriction_level],D=[];return I!=null&&I.label&&D.push(I.label),a.is_shared&&D.push("Shared publicly"),t.a.createElement(mt.a,{people:o.map(function(y){return{email:y.user.email,name:y.user.first_name,title:"".concat(y.user.first_name," (").concat(Ne.C[y.level],")")}}),tooltip:D.join(" \u2022 "),onClick:n})}var gt=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),jt={component:tt,logic:O.c,paramsToProps:function(a){var n=a.params,d=n.id,o=n.placement;return{id:d?parseInt(d):void 0,placement:o}}};function ze(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=r.id,n=r.dashboard,d=r.placement;return t.a.createElement(i.BindLogic,{logic:O.c,props:{id:a?parseInt(a):void 0,placement:d,dashboard:n}},t.a.createElement(tt,null))}function tt(){var r,a,n=Object(i.useValues)(O.c),d=n.placement,o=n.dashboard,I=n.canEditDashboard,D=n.items,y=n.itemsLoading,x=n.filters,C=n.dashboardMode,se=n.receivedErrorsFromAPI,L=Object(i.useActions)(O.c),u=L.setDashboardMode,V=L.setDates,ge=L.reportDashboardViewed,re=L.setProperties,Pe=Object(i.useValues)(qe.a),Ae=Pe.featureFlags;return Object(R.useEffect)(function(){ge()},[]),Object(Se.a)([s.l.Public,s.l.InternalMetrics].includes(d)?{}:{e:{action:function(){return u(C===s.k.Edit?null:s.k.Edit,E.a.Hotkey)},disabled:!I||C!==null&&C!==s.k.Edit},f:{action:function(){return u(C===s.k.Fullscreen?null:s.k.Fullscreen,E.a.Hotkey)},disabled:C!==null&&C!==s.k.Fullscreen},escape:{action:function(){return u(null,E.a.Hotkey)},disabled:C!==s.k.Edit}},[u,C]),!o&&!y&&se?t.a.createElement(h.a,{object:"dashboard"}):t.a.createElement("div",{className:"dashboard"},![s.l.ProjectHomepage,s.l.Public,s.l.Export,s.l.InternalMetrics].includes(d)&&t.a.createElement(vt,null),se?t.a.createElement(ot.d,{title:"There was an error loading this dashboard"}):!D||D.length===0?t.a.createElement(f,{loading:y}):t.a.createElement("div",null,![s.l.Public,s.l.Export,s.l.InternalMetrics].includes(d)&&t.a.createElement("div",{className:"flex pb border-bottom space-x"},t.a.createElement("div",{className:"flex-grow flex",style:{height:30}},t.a.createElement(ie.a,{style:{marginRight:8,fontWeight:"bold",lineHeight:"30px"}}),t.a.createElement(l.a,{defaultValue:"Custom",showCustom:!0,dateFrom:(r=x==null?void 0:x.date_from)!==null&&r!==void 0?r:void 0,dateTo:(a=x==null?void 0:x.date_to)!==null&&a!==void 0?a:void 0,onChange:V,disabled:!I,makeLabel:function(Me){return t.a.createElement(t.a.Fragment,null,t.a.createElement(v.a,null),t.a.createElement("span",{className:"hide-when-small"}," ",Me))}})),(Ae[Ne.h.PROPERTY_FILTER_ON_DASHBOARD]||(o==null?void 0:o.filters.properties))&&t.a.createElement(gt.a,{onChange:re,pageKey:"dashboard_"+(o==null?void 0:o.id),propertyFilters:o==null?void 0:o.filters.properties,useLemonButton:!0})),d!==s.l.Export&&t.a.createElement("div",{className:"flex pt pb space-x dashoard-items-actions"},t.a.createElement("div",{className:"left-item",style:d===s.l.Public?{textAlign:"right"}:void 0},[s.l.Public,s.l.InternalMetrics].includes(d)?t.a.createElement(Xe,null):t.a.createElement(rt,null))),t.a.createElement(te,null)))}try{ze.displayName="Dashboard",ze.__docgenInfo={description:"",displayName:"Dashboard",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},dashboard:{defaultValue:null,description:"",name:"dashboard",required:!1,type:{name:"DashboardType"}},placement:{defaultValue:null,description:"",name:"placement",required:!1,type:{name:"enum",value:[{value:'"dashboard"'},{value:'"internal-metrics"'},{value:'"project-homepage"'},{value:'"public"'},{value:'"export"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/Dashboard.tsx#Dashboard"]={docgenInfo:ze.__docgenInfo,name:"Dashboard",path:"frontend/src/scenes/dashboard/Dashboard.tsx#Dashboard"})}catch(r){}},"./frontend/src/scenes/dashboard/dashboardsLogic.ts":function(J,p,e){"use strict";e.d(p,"a",function(){return A}),e.d(p,"b",function(){return te});var F=e("./node_modules/core-js/modules/es.array.sort.js"),ye=e.n(F),R=e("./node_modules/core-js/modules/es.array.filter.js"),t=e.n(R),i=e("./node_modules/core-js/modules/es.object.to-string.js"),O=e.n(i),q=e("./node_modules/core-js/modules/es.function.name.js"),fe=e.n(q),ne=e("./node_modules/core-js/modules/es.array.map.js"),Be=e.n(ne),ee=e("./node_modules/core-js/modules/es.regexp.exec.js"),N=e.n(ee),X=e("./node_modules/core-js/modules/es.string.search.js"),H=e.n(X),B=e("./node_modules/core-js/modules/es.array.flat-map.js"),de=e.n(B),G=e("./node_modules/core-js/modules/es.array.unscopables.flat-map.js"),U=e.n(G),s=e("./node_modules/kea/lib/index.esm.js"),_=e("./node_modules/fuse.js/dist/fuse.esm.js"),P=e("./frontend/src/models/dashboardsModel.tsx"),Y=e("./frontend/src/lib/utils.tsx"),A;(function(l){l.All="all",l.Pinned="pinned",l.Shared="shared"})(A||(A={}));var te=Object(s.kea)({path:["scenes","dashboard","dashboardsLogic"],actions:{setSearchTerm:function(v){return{searchTerm:v}},setCurrentTab:function(v){return{tab:v}}},reducers:{searchTerm:{setSearchTerm:function(v,T){var m=T.searchTerm;return m}},currentTab:[A.All,{setCurrentTab:function(v,T){var m=T.tab;return m}}]},selectors:{dashboards:[function(l){return[P.a.selectors.nameSortedDashboards,l.searchTerm,l.currentTab]},function(l,v,T){return l=l.filter(function(m){return!m.deleted}).sort(function(m,ae){var pe,le;return((pe=m.name)!==null&&pe!==void 0?pe:"Untitled").localeCompare((le=ae.name)!==null&&le!==void 0?le:"Untitled")}),T===A.Pinned?l=l.filter(function(m){return m.pinned}):T===A.Shared&&(l=l.filter(function(m){return m.is_shared})),v?new _.a(l,{keys:["key","name"],threshold:.3}).search(v).map(function(m){return m.item}):l}],dashboardTags:[function(){return[P.a.selectors.nameSortedDashboards]},function(l){return Object(Y.Db)(l.flatMap(function(v){var T=v.tags;return T||""}),function(v){return v}).sort()}]}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/Dashboard.scss":function(J,p,e){var F=e("./node_modules/css-loader/dist/runtime/api.js");p=F(!1),p.push([J.i,'.dashboard .empty-state .fade-out-graphs:after{content:"";width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent);position:absolute;pointer-events:none;bottom:0}.dashboard-header .dashboard-select{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.dashboard{margin-top:1rem}.dashboard .dashboard-items-action-icon{margin-right:6px}.dashboard .dashboard-items-action-refresh-text{visibility:visible}.dashboard .dashboard-items-action-refresh-text.hidden{visibility:hidden}.dashboard .dashboard-items-action-refresh-text.completed{position:absolute;left:30px}.dashboard .empty-state{position:relative}.dashboard .empty-state .skeleton-actions{text-align:right}.dashboard .empty-state .skeleton-actions .ant-skeleton-avatar{margin-right:8px}.dashboard .empty-state .pie-chart{height:200px;width:200px;max-width:100%;margin-top:1rem}@media(max-width:992px){.dashboard .empty-state .pie-chart{height:140px;width:140px}}.dashboard .empty-state .bar-chart{display:flex;margin-top:1rem;align-items:flex-end}.dashboard .empty-state .bar-chart .bar-el{width:12.5%;margin-left:4px;height:100px}.dashboard .empty-state .ant-col{flex-grow:1}.dashboard .empty-state .ant-col .ant-card{height:100%}.dashboard .empty-state .fade-out-graphs{margin-top:1rem;height:150px;overflow:hidden;position:relative}.dashboard .empty-state .fade-out-graphs:after{width:calc(100% - 16px);left:8px;height:150px}.dashboard .empty-state .cta{width:360px;max-width:calc(100% - 32px);position:absolute;top:16px;left:50%;transform:translateX(-50%);z-index:var(--z-content-overlay)}.dashboard-header{display:flex;justify-content:space-between;margin-bottom:1rem;width:100%}.dashboard-header.full-screen{margin-top:1rem}.dashboard-header .dashboard-select{flex:1;padding-right:2rem}.dashboard-header .dashboard-select .ant-select-single{max-width:100%;line-height:40px}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector{align-items:center;padding-left:0;padding-right:8px;line-height:40px;height:40px}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector .ant-select-selection-item{font-size:28px;font-weight:600;line-height:40px;width:100%;height:35px;display:flex;align-items:center}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector .ant-select-selection-item .anticon-share-alt{font-size:16px;margin-left:6px!important;margin-right:4px}.dashboard-header .dashboard-select .ant-select-single.ant-select-open .ant-select-arrow{color:var(--depr-rgba-text-default-0-4)}.dashboard-header .dashboard-select .ant-select-single .ant-select-arrow{color:var(--text-default);font-size:14px}.dashboard-header .dashboard-meta{white-space:nowrap;display:flex;align-items:center}.dashboard-header .dashboard-meta .ant-btn{margin-left:10px}.dashboard-header .dashboard-meta .ant-btn .anticon{vertical-align:baseline}.dashboard-header .dashboard-meta .ant-btn.button-box{padding:4px 8px}@media(max-width:768px){.dashboard-header{flex-direction:column}.dashboard-header .dashboard-meta{padding-top:1rem;justify-content:flex-end}}#auto-refresh-check{padding:5px 12px;cursor:pointer}.CollaboratorRow{justify-content:space-between;height:2rem;margin-top:.5rem;padding-left:.5rem}.CollaboratorRow,.CollaboratorRow__details{display:flex;align-items:center}.CollaboratorRow__details>span{margin-right:.5rem}',""]),J.exports=p},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/DashboardItems.scss":function(J,p,e){var F=e("./node_modules/css-loader/dist/runtime/api.js");p=F(!1),p.push([J.i,".dashboard-items-wrapper{width:100%}.react-grid-layout{position:relative;transition:height .1s ease;margin-bottom:2rem}.react-grid-layout.dashboard-view-mode .react-grid-item{transition:none}.react-grid-item{transition:all .1s ease;transition-property:left,top}.react-grid-item.cssTransforms{transition-property:transform}.react-grid-item.resizing{z-index:1;will-change:width,height}.react-grid-item.react-draggable{cursor:move}.react-grid-item.react-draggable-dragging{transition:none;z-index:105;will-change:transform}.react-grid-item.dropping{visibility:hidden}.react-grid-item.react-grid-placeholder{transition:.1s ease;max-width:100%;position:relative;border:1px solid var(--primary);outline:1px solid var(--primary);border-radius:var(--radius);z-index:2;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-resizable-hide>.react-resizable-handle{display:none}.react-grid-item>.react-resizable-handle{position:absolute;width:2rem;height:2rem;bottom:-.5rem;right:-.5rem;cursor:se-resize;z-index:10}.react-grid-item>.react-resizable-handle.react-resizable-handle-se{cursor:se-resize}.react-grid-item>.react-resizable-handle.react-resizable-handle-e{top:0;bottom:2rem;height:auto;cursor:ew-resize}.react-grid-item>.react-resizable-handle.react-resizable-handle-s{left:0;right:2rem;width:auto;cursor:ns-resize}.ant-dropdown{z-index:700}.dive-btn{margin-right:.5rem}.dive-btn.dive-btn-dive{border-color:var(--primary);color:var(--primary)}.dive-btn.dive-btn-dive:hover{border-color:var(--depr-darken-primary-30);color:var(--depr-darken-primary-30)}",""]),J.exports=p}}]);
