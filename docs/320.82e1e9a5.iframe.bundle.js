(window.webpackJsonp=window.webpackJsonp||[]).push([[320],{"./frontend/src/scenes/session-recordings/SessionRecordings.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"SessionsRecordings",(function(){return SessionsRecordings})),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene}));var PageHeader=__webpack_require__("./frontend/src/lib/components/PageHeader.tsx"),teamLogic=__webpack_require__("./frontend/src/scenes/teamLogic.tsx"),index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),urls=__webpack_require__("./frontend/src/scenes/urls.ts"),SessionRecordingsPlaylist=__webpack_require__("./frontend/src/scenes/session-recordings/playlist/SessionRecordingsPlaylist.tsx"),LemonBanner=__webpack_require__("./frontend/src/lib/lemon-ui/LemonBanner/index.ts"),src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),tabs=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/tabs/index.js"),types=__webpack_require__("./frontend/src/types.ts"),savedSessionRecordingPlaylistsLogic=__webpack_require__("./frontend/src/scenes/session-recordings/saved-playlists/savedSessionRecordingPlaylistsLogic.ts"),columnUtils=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTable/columnUtils.tsx"),DateFilter=__webpack_require__("./frontend/src/lib/components/DateFilter/DateFilter.tsx"),membersLogic=__webpack_require__("./frontend/src/scenes/organization/Settings/membersLogic.tsx"),apps_common_src=__webpack_require__("./frontend/@posthog/apps-common/src/index.ts"),LemonButton=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/index.ts"),icons=__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts"),playlistUtils=__webpack_require__("./frontend/src/scenes/session-recordings/playlist/playlistUtils.ts"),sceneLogic=__webpack_require__("./frontend/src/scenes/sceneLogic.ts"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function SavedSessionRecordingPlaylistsEmptyState(){const{guardAvailableFeature:guardAvailableFeature}=Object(index_esm.useActions)(sceneLogic.a),playlistsLogic=Object(savedSessionRecordingPlaylistsLogic.b)({tab:types.ab.Recent}),{playlists:playlists}=Object(index_esm.useValues)(playlistsLogic);return Object(jsx_runtime.jsx)("div",{className:"flex items-center justify-center",children:Object(jsx_runtime.jsxs)("div",{className:"max-w-lg mt-12 flex flex-col items-center",children:[Object(jsx_runtime.jsx)("h2",{className:"text-xl",children:"There are no playlists that match these filters"}),Object(jsx_runtime.jsx)("p",{className:"text-muted",children:"Once you create a playlist, it will show up here."}),Object(jsx_runtime.jsx)(LemonButton.a,{type:"primary","data-attr":"add-session-playlist-button-empty-state",icon:Object(jsx_runtime.jsx)(icons.qc,{}),onClick:()=>guardAvailableFeature(types.e.RECORDINGS_PLAYLISTS,"recording playlists","Playlists allow you to save certain session recordings as a group to easily find and watch them again in the future. You've unfortunately run out of playlists on your current subscription plan.",(()=>Object(playlistUtils.a)({},!0)),void 0,playlists.count),children:"New playlist"})]})})}var clsx_m=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),More=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/More.tsx");function SavedSessionRecordingPlaylists(_ref){let{tab:tab}=_ref;const logic=Object(savedSessionRecordingPlaylistsLogic.b)({tab:tab}),{playlists:playlists,playlistsLoading:playlistsLoading,filters:filters,sorting:sorting,pagination:pagination}=Object(index_esm.useValues)(logic),{setSavedPlaylistsFilters:setSavedPlaylistsFilters,updatePlaylist:updatePlaylist,duplicatePlaylist:duplicatePlaylist,deletePlaylist:deletePlaylist}=Object(index_esm.useActions)(logic),{meFirstMembers:meFirstMembers}=Object(index_esm.useValues)(membersLogic.a),columns=[{width:0,dataIndex:"pinned",render:function Render(pinned,_ref2){let{short_id:short_id}=_ref2;return Object(jsx_runtime.jsx)(src.LemonButton,{size:"small",status:"primary-alt",onClick:()=>updatePlaylist(short_id,{pinned:!pinned}),icon:pinned?Object(jsx_runtime.jsx)(icons.mc,{}):Object(jsx_runtime.jsx)(icons.nc,{})})}},{title:"Name",dataIndex:"name",render:function Render(name,_ref3){let{short_id:short_id,derived_name:derived_name,description:description}=_ref3;return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.Link,{className:Object(clsx_m.default)("font-semibold",!name&&"italic"),to:urls.a.sessionRecordingPlaylist(short_id),children:name||derived_name||"(Untitled)"}),description?Object(jsx_runtime.jsx)("div",{className:"truncate",children:description}):null]})}},{...Object(columnUtils.b)(),width:0},{title:"Last modified",sorter:!0,dataIndex:"last_modified_at",width:0,render:function Render(last_modified_at){return Object(jsx_runtime.jsx)("div",{children:last_modified_at&&"string"==typeof last_modified_at&&Object(jsx_runtime.jsx)(apps_common_src.TZLabel,{time:last_modified_at})})}},{width:0,render:function Render(_,playlist){return Object(jsx_runtime.jsx)(More.a,{overlay:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.LemonButton,{status:"stealth",onClick:()=>duplicatePlaylist(playlist),fullWidth:!0,"data-attr":"duplicate-playlist",loading:playlistsLoading,children:"Duplicate"}),Object(jsx_runtime.jsx)(src.LemonDivider,{}),Object(jsx_runtime.jsx)(src.LemonButton,{status:"danger",onClick:()=>deletePlaylist(playlist),fullWidth:!0,loading:playlistsLoading,children:"Delete playlist"})]})})}}];return Object(jsx_runtime.jsxs)("div",{className:"space-y-4",children:[Object(jsx_runtime.jsxs)("div",{className:"flex justify-between gap-2 mb-2 items-center flex-wrap",children:[Object(jsx_runtime.jsx)(src.LemonInput,{type:"search",placeholder:"Search for playlists",onChange:value=>setSavedPlaylistsFilters({search:value||void 0}),value:filters.search||""}),Object(jsx_runtime.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[Object(jsx_runtime.jsx)("div",{className:"flex items-center gap-2",children:Object(jsx_runtime.jsx)(src.LemonButton,{"data-attr":"session-recording-playlist-pinned-filter",active:filters.pinned,size:"small",type:"secondary",status:"stealth",center:!0,onClick:()=>setSavedPlaylistsFilters({pinned:!filters.pinned}),icon:filters.pinned?Object(jsx_runtime.jsx)(icons.mc,{}):Object(jsx_runtime.jsx)(icons.nc,{}),children:"Pinned"})}),Object(jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[Object(jsx_runtime.jsx)("span",{children:"Last modified:"}),Object(jsx_runtime.jsx)(DateFilter.a,{disabled:!1,dateFrom:filters.dateFrom,dateTo:filters.dateTo,onChange:(fromDate,toDate)=>setSavedPlaylistsFilters({dateFrom:fromDate,dateTo:null!=toDate?toDate:void 0}),makeLabel:key=>Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(icons.w,{}),Object(jsx_runtime.jsxs)("span",{className:"hide-when-small",children:[" ",key]})]})})]}),Object(jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[Object(jsx_runtime.jsx)("span",{children:"Created by:"}),Object(jsx_runtime.jsx)(src.LemonSelect,{size:"small",options:[{value:"All users",label:"All Users"},...meFirstMembers.map((x=>({value:x.user.id,label:x.user.first_name})))],value:filters.createdBy,onChange:v=>{setSavedPlaylistsFilters({createdBy:v})},dropdownMatchSelectWidth:!1})]})]})]}),!playlistsLoading&&playlists.count<1?Object(jsx_runtime.jsx)(SavedSessionRecordingPlaylistsEmptyState,{}):Object(jsx_runtime.jsx)(src.LemonTable,{loading:playlistsLoading,columns:columns,dataSource:playlists.results,pagination:pagination,noSortingCancellation:!0,sorting:sorting,onSort:newSorting=>setSavedPlaylistsFilters({order:newSorting?`${-1===newSorting.order?"-":""}${newSorting.columnKey}`:void 0}),rowKey:"id",loadingSkeletonRows:savedSessionRecordingPlaylistsLogic.a,nouns:["playlist","playlists"]})]})}try{SavedSessionRecordingPlaylists.displayName="SavedSessionRecordingPlaylists",SavedSessionRecordingPlaylists.__docgenInfo={description:"",displayName:"SavedSessionRecordingPlaylists",props:{tab:{defaultValue:null,description:"",name:"tab",required:!0,type:{name:"SessionRecordingsTabs.Playlists"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/session-recordings/saved-playlists/SavedSessionRecordingPlaylists.tsx#SavedSessionRecordingPlaylists"]={docgenInfo:SavedSessionRecordingPlaylists.__docgenInfo,name:"SavedSessionRecordingPlaylists",path:"frontend/src/scenes/session-recordings/saved-playlists/SavedSessionRecordingPlaylists.tsx#SavedSessionRecordingPlaylists"})}catch(__react_docgen_typescript_loader_error){}var sessionRecordingsLogic=__webpack_require__("./frontend/src/scenes/session-recordings/sessionRecordingsLogic.ts"),Spinner=__webpack_require__("./frontend/src/lib/lemon-ui/Spinner/Spinner.tsx"),lib=__webpack_require__("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.5/node_modules/kea-router/lib/index.js"),SessionRecordingSettings=__webpack_require__("./frontend/src/scenes/session-recordings/settings/SessionRecordingSettings.tsx"),Dragger=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/lib/upload/Dragger.js"),Dragger_default=__webpack_require__.n(Dragger),SessionRecordingPlayer=__webpack_require__("./frontend/src/scenes/session-recordings/player/SessionRecordingPlayer.tsx"),sessionRecordingFilePlaybackLogic=__webpack_require__("./frontend/src/scenes/session-recordings/file-playback/sessionRecordingFilePlaybackLogic.ts"),userLogic=__webpack_require__("./frontend/src/scenes/userLogic.ts"),PayGatePage=__webpack_require__("./frontend/src/lib/components/PayGatePage/PayGatePage.tsx");function SessionRecordingFilePlayback(){const{loadFromFile:loadFromFile,resetSessionRecording:resetSessionRecording}=Object(index_esm.useActions)(sessionRecordingFilePlaybackLogic.b),{sessionRecording:sessionRecording,sessionRecordingLoading:sessionRecordingLoading,playerKey:playerKey}=Object(index_esm.useValues)(sessionRecordingFilePlaybackLogic.b),{hasAvailableFeature:hasAvailableFeature}=Object(index_esm.useValues)(userLogic.a);return hasAvailableFeature(types.e.RECORDINGS_FILE_EXPORT)?Object(jsx_runtime.jsx)("div",{children:sessionRecordingLoading?Object(jsx_runtime.jsx)(Spinner.b,{}):sessionRecording?Object(jsx_runtime.jsxs)("div",{className:"space-y-2",children:[Object(jsx_runtime.jsx)(LemonBanner.a,{type:"info",action:{onClick:()=>resetSessionRecording(),children:"Load a different recording"},children:"You are viewing a recording loaded from a file."}),Object(jsx_runtime.jsx)(SessionRecordingPlayer.a,{sessionRecordingId:"",playerKey:playerKey})]}):Object(jsx_runtime.jsx)(Dragger_default.a,{name:"file",multiple:!1,accept:".json",showUploadList:!1,beforeUpload:file=>(loadFromFile(file),!1),children:Object(jsx_runtime.jsxs)("div",{className:"p-20 flex flex-col items-center justify-center space-y-2 text-muted-alt",children:[Object(jsx_runtime.jsxs)("p",{className:"flex items-center gap-2 font-semibold",children:[Object(jsx_runtime.jsx)(icons.qd,{className:"text-xl"}),"Load recording"]}),Object(jsx_runtime.jsx)("p",{className:"text-muted-alt ",children:"Drag and drop your exported recording here or click to open the file browser."})]})})}):Object(jsx_runtime.jsx)(PayGatePage.a,{featureKey:types.e.RECORDINGS_FILE_EXPORT,featureName:"Recording Exports",header:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Export and playback ",Object(jsx_runtime.jsx)("span",{className:"highlight",children:"Recordings from file"}),"!"]}),caption:"Store your recordings outside of PostHog wherever you like.",docsLink:"https://posthog.com/docs/user-guides/session-recordings"})}var useAsyncHandler=__webpack_require__("./frontend/src/lib/hooks/useAsyncHandler.ts"),eventUsageLogic=__webpack_require__("./frontend/src/lib/utils/eventUsageLogic.ts");function SessionsRecordings(){const{currentTeam:currentTeam}=Object(index_esm.useValues)(teamLogic.b),{tab:tab}=Object(index_esm.useValues)(sessionRecordingsLogic.c),recordingsDisabled=currentTeam&&!(null!=currentTeam&&currentTeam.session_recording_opt_in),{reportRecordingPlaylistCreated:reportRecordingPlaylistCreated}=Object(index_esm.useActions)(eventUsageLogic.e),{guardAvailableFeature:guardAvailableFeature}=Object(index_esm.useActions)(sceneLogic.a),playlistsLogic=Object(savedSessionRecordingPlaylistsLogic.b)({tab:types.ab.Recent}),{playlists:playlists}=Object(index_esm.useValues)(playlistsLogic),newPlaylistHandler=Object(useAsyncHandler.a)((async()=>{await Object(playlistUtils.a)({},!0),reportRecordingPlaylistCreated("new")}));return Object(jsx_runtime.jsxs)("div",{className:"-mb-12",children:[Object(jsx_runtime.jsx)(PageHeader.a,{title:Object(jsx_runtime.jsx)("div",{children:"Session Recordings"}),buttons:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[tab===types.ab.Recent&&!recordingsDisabled&&Object(jsx_runtime.jsx)(src.LemonButton,{type:"secondary",icon:Object(jsx_runtime.jsx)(icons.Kc,{}),onClick:()=>Object(SessionRecordingSettings.b)(),children:"Configure"}),tab===types.ab.Playlists&&Object(jsx_runtime.jsx)(src.LemonButton,{type:"primary",onClick:e=>guardAvailableFeature(types.e.RECORDINGS_PLAYLISTS,"recording playlists","Playlists allow you to save certain session recordings as a group to easily find and watch them again in the future. You've unfortunately run out of playlists on your current subscription plan.",(()=>{var _newPlaylistHandler$o;return null===(_newPlaylistHandler$o=newPlaylistHandler.onEvent)||void 0===_newPlaylistHandler$o?void 0:_newPlaylistHandler$o.call(newPlaylistHandler,e)}),void 0,playlists.count),"data-attr":"save-recordings-playlist-button",loading:newPlaylistHandler.loading,children:"New playlist"})]})}),Object(jsx_runtime.jsx)(tabs.a,{activeKey:tab,animated:!1,style:{borderColor:"#D9D9D9"},onChange:t=>lib.router.actions.push(urls.a.sessionRecordings(t)),children:Object.values(types.ab).map((value=>Object(jsx_runtime.jsx)(tabs.a.TabPane,{tab:Object(sessionRecordingsLogic.b)(value)},value)))}),recordingsDisabled?Object(jsx_runtime.jsx)("div",{className:"mb-4",children:Object(jsx_runtime.jsx)(LemonBanner.a,{type:"info",action:{type:"secondary",icon:Object(jsx_runtime.jsx)(icons.Kc,{}),onClick:()=>Object(SessionRecordingSettings.b)(),children:"Configure"},children:"Session recordings are currently disabled for this project."})}):null,tab?tab===types.ab.Recent?Object(jsx_runtime.jsx)(SessionRecordingsPlaylist.b,{updateSearchParams:!0}):tab===types.ab.Playlists?Object(jsx_runtime.jsx)(SavedSessionRecordingPlaylists,{tab:types.ab.Playlists}):tab===types.ab.FilePlayback?Object(jsx_runtime.jsx)(SessionRecordingFilePlayback,{}):null:Object(jsx_runtime.jsx)(Spinner.a,{})]})}const scene={component:SessionsRecordings,logic:sessionRecordingsLogic.c}}}]);