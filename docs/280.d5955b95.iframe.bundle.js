var R=(b,l,e)=>new Promise((r,u)=>{var i=a=>{try{t(e.next(a))}catch(m){u(m)}},c=a=>{try{t(e.throw(a))}catch(m){u(m)}},t=a=>a.done?r(a.value):Promise.resolve(a.value).then(i,c);t((e=e.apply(b,l)).next())});(window.webpackJsonp=window.webpackJsonp||[]).push([[280],{"./frontend/src/scenes/groups/groupsListLogic.ts":function(b,l,e){"use strict";e.d(l,"a",function(){return d});var r=e("./node_modules/.pnpm/kea@3.0.4_react@16.14.0/node_modules/kea/lib/index.esm.js"),u=e("./frontend/src/lib/api.ts"),i=e("./frontend/src/lib/introductions/groupsAccessLogic.ts"),c=e("./frontend/src/lib/utils.tsx"),t=e("./frontend/src/scenes/teamLogic.tsx"),a=e("./frontend/src/scenes/urls.ts"),m=e("./frontend/src/models/groupsModel.ts");const d=Object(r.kea)({path:["groups","groupsListLogic"],connect:{values:[t.a,["currentTeamId"],m.a,["groupTypes","aggregationLabel"],i.b,["groupsEnabled"]]},actions:()=>({loadGroups:o=>({url:o}),setTab:o=>({tab:o})}),loaders:o=>{let{values:n}=o;return{groups:[{next:null,previous:null,results:[]},{loadGroups:p=>R(this,null,function*(){let{url:s}=p;if(n.groupsEnabled)return s=s||`api/projects/${n.currentTeamId}/groups/?group_type_index=${n.currentTab}`,yield u.b.get(s)})}]}},reducers:{currentTab:["-1",{setTab:(o,n)=>{let{tab:p}=n;return p}}]},selectors:{currentTabName:[o=>[o.currentTab,o.groupTypes,o.aggregationLabel],(o,n,p)=>o==="-1"?"Persons":n!=null&&n.length?Object(c.i)(p(parseInt(o)).singular):""],groupName:[o=>[o.currentTab,o.aggregationLabel],(o,n)=>o==="-1"?{singular:"person",plural:"persons"}:n(parseInt(o))],breadcrumbs:[o=>[o.currentTabName,o.currentTab],(o,n)=>[{name:o,path:a.a.groups(n)}]]},actionToUrl:()=>({setTab:o=>{let{tab:n}=o;return n!=="-1"?a.a.groups(n):a.a.persons()}}),urlToAction:o=>{let{actions:n,values:p}=o;return{"/groups/:id":s=>{let{id:_}=s;_&&(n.setTab(_),n.loadGroups())},"/persons":()=>{p.currentTab!=="-1"&&n.setTab("-1")}}}})},"./frontend/src/scenes/persons/PersonDeleteModal.tsx":function(b,l,e){"use strict";e.d(l,"a",function(){return m});var r=e("./node_modules/.pnpm/kea@3.0.4_react@16.14.0/node_modules/kea/lib/index.esm.js"),u=e("./frontend/src/scenes/persons/personsLogic.tsx"),i=e("./frontend/src/scenes/persons/PersonHeader.tsx"),c=e("./frontend/@posthog/lemon-ui/src/index.ts"),t=e("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js"),a=e.n(t);function m(){const{personDeleteModal:d}=Object(r.useValues)(u.a),{deletePerson:o,showPersonDeleteModal:n}=Object(r.useActions)(u.a);return Object(t.jsx)(c.LemonModal,{isOpen:!!d,onClose:()=>n(null),title:`Are you sure you want to delete "${Object(i.b)(d)}"?`,description:Object(t.jsxs)(t.Fragment,{children:["This action cannot be undone. If you opt to delete the person and its corresponding events, the events will not be immediately removed. Instead these events will be deleted on a set schedule during non-peak usage times.",Object(t.jsxs)("a",{href:"https://posthog.com/docs/privacy/data-deletion",target:"_blank",rel:"noopener",className:"font-bold",children:[" ","Learn more"]})]}),footer:Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(c.LemonButton,{status:"danger",type:"secondary",onClick:()=>{o({person:d,deleteEvents:!0}),n(null)},"data-attr":"delete-person-with-events",children:"Delete person and all corresponding events"}),Object(t.jsx)(c.LemonButton,{type:"secondary",onClick:()=>n(null),"data-attr":"delete-person-cancel",children:"Cancel"}),Object(t.jsx)(c.LemonButton,{type:"primary",status:"danger",onClick:()=>{o({person:d,deleteEvents:!1}),n(null)},"data-attr":"delete-person-no-events",children:"Delete person"})]})})}},"./frontend/src/scenes/persons/PersonPageHeader.tsx":function(b,l,e){"use strict";e.d(l,"a",function(){return n});var r=e("./node_modules/.pnpm/kea@3.0.4_react@16.14.0/node_modules/kea/lib/index.esm.js"),u=e("./frontend/src/lib/components/PageHeader.tsx"),i=e("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/tabs/index.js"),c=e("./frontend/src/lib/introductions/groupsAccessLogic.ts"),t=e("./frontend/src/lib/utils.tsx"),a=e("./frontend/src/models/groupsModel.ts"),m=e("./frontend/src/scenes/groups/groupsListLogic.ts"),d=e("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function o(){const{setTab:p}=Object(r.useActions)(m.a),{currentTab:s}=Object(r.useValues)(m.a),{groupTypes:_,aggregationLabel:I}=Object(r.useValues)(a.a),{groupsAccessStatus:v}=Object(r.useValues)(c.b),C=[c.a.HasAccess,c.a.HasGroupTypes,c.a.NoAccess].includes(v);return Object(d.jsxs)(i.a,{activeKey:s,onChange:h=>p(h),children:[Object(d.jsx)(i.a.TabPane,{tab:"Persons"},"-1"),C?Object(d.jsx)(i.a.TabPane,{tab:"Introducing Group Analytics"},"0"):_.map(h=>Object(d.jsx)(i.a.TabPane,{tab:Object(t.i)(I(h.group_type_index).plural)},h.group_type_index))]})}function n(p){let{hideGroupTabs:s}=p;const{showGroupsOptions:_}=Object(r.useValues)(a.a);return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(u.a,{title:`Persons${_?" & Groups":""}`,caption:`A catalog of your product's end users${_?" and groups":""}.`}),!s&&_&&Object(d.jsx)(o,{})]})}try{n.displayName="PersonPageHeader",n.__docgenInfo={description:"",displayName:"PersonPageHeader",props:{hideGroupTabs:{defaultValue:null,description:"",name:"hideGroupTabs",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"]={docgenInfo:n.__docgenInfo,name:"PersonPageHeader",path:"frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"})}catch(p){}},"./frontend/src/scenes/persons/Persons.scss":function(b,l,e){"use strict";var r=e("./node_modules/.pnpm/style-loader@2.0.0_webpack@4.46.0/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),u=e.n(r),i=e("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/persons/Persons.scss"),c=e.n(i),t={};t.insert="head",t.singleton=!1;var a=u()(c.a,t),m=c.a.locals||{}},"./frontend/src/scenes/persons/Persons.tsx":function(b,l,e){"use strict";e.r(l),e.d(l,"scene",function(){return W}),e.d(l,"Persons",function(){return L}),e.d(l,"PersonsScene",function(){return A});var r=e("./node_modules/.pnpm/kea@3.0.4_react@16.14.0/node_modules/kea/lib/index.esm.js"),u=e("./frontend/src/lib/components/TZLabel/index.tsx"),i=e("./frontend/src/lib/components/PropertiesTable.tsx"),c=e("./frontend/src/scenes/persons/Persons.scss"),t=e("./frontend/src/lib/components/CopyToClipboard.tsx"),a=e("./frontend/src/scenes/persons/PersonHeader.tsx"),m=e("./frontend/src/lib/components/LemonTable/index.ts"),d=e("./frontend/@posthog/lemon-ui/src/index.ts"),o=e("./frontend/src/lib/components/icons.tsx"),n=e("./frontend/src/scenes/persons/personsLogic.tsx"),p=e("./frontend/src/scenes/persons/PersonDeleteModal.tsx"),s=e("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function _(j){let{people:y,loading:T=!1,hasPrevious:f,hasNext:x,loadPrevious:P,loadNext:E,compact:M}=j;const{showPersonDeleteModal:S}=Object(r.useActions)(n.a),F=[{title:"Person",key:"person",render:function(O,g){return Object(s.jsx)(a.a,{withIcon:!0,person:g})}},{title:"ID",key:"id",render:function(O,g){return Object(s.jsx)("div",{className:"overflow-hidden",children:g.distinct_ids.length&&Object(s.jsx)(t.a,{explicitValue:g.distinct_ids[0],iconStyle:{color:"var(--primary)"},description:"person distinct ID",children:g.distinct_ids[0]})})}},...M?[]:[{title:"First seen",dataIndex:"created_at",render:function(O){return O?Object(s.jsx)(u.a,{time:O}):Object(s.jsx)(s.Fragment,{})}},{render:function(O,g){return Object(s.jsx)(d.LemonButton,{onClick:()=>S(g),icon:Object(s.jsx)(o.IconDelete,{}),status:"danger",size:"small"})}}]];return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(m.a,{"data-attr":"persons-table",columns:F,loading:T,rowKey:"id",pagination:{controlled:!0,pageSize:100,onForward:x?()=>{E==null||E(),window.scrollTo(0,0)}:void 0,onBackward:f?()=>{P==null||P(),window.scrollTo(0,0)}:void 0},expandable:{expandedRowRender:function(O){let{properties:g}=O;return Object.keys(g).length?Object(s.jsx)(i.a,{properties:g}):"This person has no properties."}},dataSource:y,emptyState:"No persons",nouns:["person","persons"]}),Object(s.jsx)(p.a,{})]})}try{_.displayName="PersonsTable",_.__docgenInfo={description:"",displayName:"PersonsTable",props:{people:{defaultValue:null,description:"",name:"people",required:!0,type:{name:"PersonType[]"}},loading:{defaultValue:{value:"false"},description:"",name:"loading",required:!1,type:{name:"boolean"}},hasPrevious:{defaultValue:null,description:"",name:"hasPrevious",required:!1,type:{name:"boolean"}},hasNext:{defaultValue:null,description:"",name:"hasNext",required:!1,type:{name:"boolean"}},loadPrevious:{defaultValue:null,description:"",name:"loadPrevious",required:!1,type:{name:"(() => void)"}},loadNext:{defaultValue:null,description:"",name:"loadNext",required:!1,type:{name:"(() => void)"}},compact:{defaultValue:null,description:"",name:"compact",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"]={docgenInfo:_.__docgenInfo,name:"PersonsTable",path:"frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"})}catch(j){}var I=e("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/popconfirm/index.js"),v=e("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),C=e("./frontend/src/lib/components/Tooltip.tsx"),h=e("./node_modules/.pnpm/use-debounce@6.0.1_react@16.14.0/node_modules/use-debounce/esm/useDebouncedCallback.js");const B=()=>{const{loadPersons:j,setListFilters:y}=Object(r.useActions)(n.a),{listFilters:T}=Object(r.useValues)(n.a),[f,x]=Object(v.useState)(""),P=Object(h.a)(j,800);return Object(v.useEffect)(()=>{x(T.search||"")},[]),Object(v.useEffect)(()=>{y({search:f||void 0}),P()},[f]),Object(s.jsxs)("div",{className:"flex items-center gap-2",children:[Object(s.jsx)(d.LemonInput,{type:"search",placeholder:"Search for persons",onChange:x,value:f,"data-attr":"persons-search"}),Object(s.jsx)(C.a,{title:Object(s.jsx)(s.Fragment,{children:'Search by email or Distinct ID. Email will match partially, for example: "@gmail.com". Distinct ID needs to match exactly.'}),children:Object(s.jsx)(o.IconInfo,{className:"text-2xl text-muted-alt shrink-0"})})]})};var K=e("./frontend/src/scenes/persons/PersonPageHeader.tsx"),N=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),U=e("./frontend/src/lib/components/TaxonomicFilter/types.ts"),H=e("./frontend/src/lib/components/LemonButton/index.ts"),V=e("./frontend/src/lib/components/ExportButton/exporter.tsx");const W={component:A,logic:n.a,paramsToProps:()=>({syncWithUrl:!0})};function L(){let{cohort:j}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object(s.jsx)(r.BindLogic,{logic:n.a,props:{cohort:j,syncWithUrl:!j},children:Object(s.jsx)(A,{})})}function A(){const{loadPersons:j,setListFilters:y}=Object(r.useActions)(n.a),{cohortId:T,persons:f,listFilters:x,personsLoading:P,exporterProps:E,apiDocsURL:M}=Object(r.useValues)(n.a);return Object(s.jsxs)("div",{className:"persons-list",children:[!T&&Object(s.jsx)(K.a,{}),Object(s.jsxs)("div",{className:"space-y-2",children:[Object(s.jsxs)("div",{className:"flex justify-between items-center gap-2",children:[Object(s.jsx)(B,{}),Object(s.jsx)(I.a,{placement:"topRight",title:Object(s.jsxs)(s.Fragment,{children:["Exporting by CSV is limited to 10,000 users.",Object(s.jsx)("br",{}),"To export more, please use ",Object(s.jsx)("a",{href:M,children:"the API"}),". Do you want to export by CSV?"]}),onConfirm:()=>Object(V.a)(E[0]),children:Object(s.jsx)(H.a,{type:"secondary",icon:Object(s.jsx)(o.IconExport,{style:{color:"var(--primary)"}}),children:x.properties&&x.properties.length>0?Object(s.jsxs)("div",{style:{display:"block"},children:["Export (",Object(s.jsx)("strong",{children:x.properties.length})," filter)"]}):"Export"})})]}),Object(s.jsx)(N.a,{pageKey:"persons-list-page",propertyFilters:x.properties,onChange:S=>{y({properties:S}),j()},endpoint:"person",taxonomicGroupTypes:[U.a.PersonProperties],showConditionBadge:!0}),Object(s.jsx)(_,{people:f.results,loading:P,hasPrevious:!!f.previous,hasNext:!!f.next,loadPrevious:()=>j(f.previous),loadNext:()=>j(f.next)})]})]})}try{L.displayName="Persons",L.__docgenInfo={description:"",displayName:"Persons",props:{cohort:{defaultValue:null,description:"",name:"cohort",required:!1,type:{name:'number | "new"'}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/Persons.tsx#Persons"]={docgenInfo:L.__docgenInfo,name:"Persons",path:"frontend/src/scenes/persons/Persons.tsx#Persons"})}catch(j){}},"./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/persons/Persons.scss":function(b,l,e){var r=e("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/runtime/api.js");l=r(!1),l.push([b.i,".extra-ids{display:inline-flex;align-items:center;height:1.25rem;line-height:1.125rem;margin:0 0 0 .25rem;padding:0 .25rem 0 .375rem;color:var(--primary);cursor:pointer}.extra-ids svg{margin-left:.25rem}",""]),b.exports=l}}]);
