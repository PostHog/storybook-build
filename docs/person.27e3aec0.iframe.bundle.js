(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{5714:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return personsLogic}));__webpack_require__(39),__webpack_require__(60),__webpack_require__(158),__webpack_require__(95),__webpack_require__(322),__webpack_require__(44),__webpack_require__(198),__webpack_require__(266),__webpack_require__(243),__webpack_require__(2609),__webpack_require__(108),__webpack_require__(37),__webpack_require__(115),__webpack_require__(49);var _babel_runtime_helpers_objectDestructuringEmpty__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(99),_babel_runtime_helpers_objectDestructuringEmpty__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(_babel_runtime_helpers_objectDestructuringEmpty__WEBPACK_IMPORTED_MODULE_14__),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(6),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15__),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(89),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_16__),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_18__=(__webpack_require__(67),__webpack_require__(13)),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_18__),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(5),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_19__),kea__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(3),kea_router__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(20),lib_api__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(21),react_toastify__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(58),_types__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(8),lib_utils_eventUsageLogic__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(46),scenes_urls__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(32),lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(63),lib_constants__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(19),scenes_teamLogic__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(27);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_19___default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var FILTER_ALLOWLIST=["is_identified","search","cohort"],personsLogic=Object(kea__WEBPACK_IMPORTED_MODULE_20__.kea)({connect:{actions:[lib_utils_eventUsageLogic__WEBPACK_IMPORTED_MODULE_25__.d,["reportPersonDetailViewed"]],values:[lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_27__.a,["featureFlags"],scenes_teamLogic__WEBPACK_IMPORTED_MODULE_29__.a,["currentTeam"]]},actions:{setListFilters:function setListFilters(payload){return{payload:payload}},editProperty:function editProperty(key,newValue){return{key:key,newValue:newValue}},setHasNewKeys:!0,navigateToCohort:function navigateToCohort(cohort){return{cohort:cohort}},navigateToTab:function navigateToTab(tab){return{tab:tab}},setSplitMergeModalShown:function setSplitMergeModalShown(shown){return{shown:shown}}},reducers:{listFilters:[{},{setListFilters:function setListFilters(state,_ref){var payload=_ref.payload;return _objectSpread(_objectSpread({},state),payload)}}],hasNewKeys:[!1,{setHasNewKeys:function setHasNewKeys(){return!0}}],activeTab:[null,{navigateToTab:function navigateToTab(_,_ref2){return _ref2.tab}}],splitMergeModalShown:[!1,{setSplitMergeModalShown:function setSplitMergeModalShown(_,_ref3){return _ref3.shown}}]},selectors:{exampleEmail:[function(s){return[s.persons]},function(persons){var _match$properties,match=persons&&persons.results.find((function(person){var _person$properties;return null===(_person$properties=person.properties)||void 0===_person$properties?void 0:_person$properties.email}));return(null==match||null===(_match$properties=match.properties)||void 0===_match$properties?void 0:_match$properties.email)||"example@gmail.com"}],showSessionRecordings:[function(s){return[s.featureFlags,s.currentTeam]},function(featureFlags,currentTeam){return!!featureFlags[lib_constants__WEBPACK_IMPORTED_MODULE_28__.o.REMOVE_SESSIONS]&&(null==currentTeam?void 0:currentTeam.session_recording_opt_in)}],showTabs:[function(s){return[s.featureFlags,s.showSessionRecordings]},function(featureFlags,showSessionRecordings){return!featureFlags[lib_constants__WEBPACK_IMPORTED_MODULE_28__.o.REMOVE_SESSIONS]||showSessionRecordings}],currentTab:[function(s){return[s.activeTab,s.showSessionRecordings,s.featureFlags]},function(activeTab,showSessionRecordings,featureFlags){return!activeTab||activeTab===_types__WEBPACK_IMPORTED_MODULE_24__.q.SESSIONS&&featureFlags[lib_constants__WEBPACK_IMPORTED_MODULE_28__.o.REMOVE_SESSIONS]?showSessionRecordings?_types__WEBPACK_IMPORTED_MODULE_24__.q.SESSION_RECORDINGS:_types__WEBPACK_IMPORTED_MODULE_24__.q.EVENTS:activeTab!==_types__WEBPACK_IMPORTED_MODULE_24__.q.SESSION_RECORDINGS||showSessionRecordings?activeTab:featureFlags[lib_constants__WEBPACK_IMPORTED_MODULE_28__.o.REMOVE_SESSIONS]?_types__WEBPACK_IMPORTED_MODULE_24__.q.EVENTS:_types__WEBPACK_IMPORTED_MODULE_24__.q.SESSIONS}]},listeners:function listeners(_ref4){var _editProperty,actions=_ref4.actions,values=_ref4.values;return{deletePersonSuccess:function deletePersonSuccess(){Object(react_toastify__WEBPACK_IMPORTED_MODULE_23__.c)("Person deleted successfully"),actions.loadPersons(),kea_router__WEBPACK_IMPORTED_MODULE_21__.router.actions.push(scenes_urls__WEBPACK_IMPORTED_MODULE_26__.a.persons())},editProperty:(_editProperty=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_18___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.mark((function _callee(_ref5){var key,newValue,person,parsedValue,action,oldPropertyType,newPropertyType,attemptedParsedNumber,lowercaseValue,response;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(key=_ref5.key,newValue=_ref5.newValue,!(person=values.person)){_context.next=17;break}return parsedValue=newValue,oldPropertyType=null===person.properties[key]?"null":_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_16___default()(person.properties[key]),newPropertyType=_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_16___default()(newValue),attemptedParsedNumber=Number(newValue),Number.isNaN(attemptedParsedNumber)||"boolean"==typeof newValue||(parsedValue=attemptedParsedNumber,newPropertyType="number"),"true"!==(lowercaseValue="string"==typeof parsedValue&&parsedValue.toLowerCase())&&"false"!==lowercaseValue&&"null"!==lowercaseValue||(newPropertyType=null!==(parsedValue="true"===lowercaseValue||"null"===lowercaseValue&&null)?"boolean":"null"),Object.keys(person.properties).includes(key)?(person.properties[key]=parsedValue,action=void 0!==parsedValue?"updated":"removed"):(actions.setHasNewKeys(),person.properties=_objectSpread(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_19___default()({},key,parsedValue),person.properties),action="added"),actions.setPerson(person),_context.next=14,lib_api__WEBPACK_IMPORTED_MODULE_22__.a.update("api/person/".concat(person.id),person);case 14:response=_context.sent,actions.setPerson(response),lib_utils_eventUsageLogic__WEBPACK_IMPORTED_MODULE_25__.d.actions.reportPersonPropertyUpdated(action,Object.keys(person.properties).length,oldPropertyType,newPropertyType);case 17:case"end":return _context.stop()}}),_callee)}))),function editProperty(_x){return _editProperty.apply(this,arguments)}),navigateToCohort:function navigateToCohort(_ref6){var cohort=_ref6.cohort;kea_router__WEBPACK_IMPORTED_MODULE_21__.router.actions.push(scenes_urls__WEBPACK_IMPORTED_MODULE_26__.a.cohort(cohort.id))}}},loaders:function loaders(_ref7){var _deletePerson,_loadCohorts,_loadPerson,_loadPersons,values=_ref7.values,actions=_ref7.actions;return{persons:[{next:null,previous:null,results:[]},{loadPersons:(_loadPersons=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_18___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.mark((function _callee2(){var url,qs,_args2=arguments;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return(url=_args2.length>0&&void 0!==_args2[0]?_args2[0]:"")||(qs=Object.keys(values.listFilters).filter((function(key){var _url;return"is_identified"!==key?FILTER_ALLOWLIST.includes(key):!(null===(_url=url)||void 0===_url?void 0:_url.includes("is_identified"))})).reduce((function(result,key){var value=values.listFilters[key];return null!=value&&result.push("".concat(key,"=").concat(encodeURIComponent(value))),result}),[]),url="api/person/".concat(qs.length?"?"+qs.join("&"):"")),_context2.next=4,lib_api__WEBPACK_IMPORTED_MODULE_22__.a.get(url);case 4:return _context2.abrupt("return",_context2.sent);case 5:case"end":return _context2.stop()}}),_callee2)}))),function loadPersons(){return _loadPersons.apply(this,arguments)})}],person:[null,{loadPerson:(_loadPerson=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_18___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.mark((function _callee3(id){var response,person;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,lib_api__WEBPACK_IMPORTED_MODULE_22__.a.get("api/person/?distinct_id=".concat(id));case 2:return(response=_context3.sent).results.length||kea_router__WEBPACK_IMPORTED_MODULE_21__.router.actions.push(scenes_urls__WEBPACK_IMPORTED_MODULE_26__.a.notFound()),(person=response.results[0])&&actions.reportPersonDetailViewed(person),_context3.abrupt("return",person);case 7:case"end":return _context3.stop()}}),_callee3)}))),function loadPerson(_x2){return _loadPerson.apply(this,arguments)}),setPerson:function setPerson(person){return person}}],cohorts:[null,{loadCohorts:(_loadCohorts=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_18___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.mark((function _callee4(){var _values$person,response;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,lib_api__WEBPACK_IMPORTED_MODULE_22__.a.get("api/person/cohorts/?person_id=".concat(null===(_values$person=values.person)||void 0===_values$person?void 0:_values$person.id));case 2:return response=_context4.sent,_context4.abrupt("return",response.results);case 4:case"end":return _context4.stop()}}),_callee4)}))),function loadCohorts(){return _loadCohorts.apply(this,arguments)})}],deletedPerson:[!1,{deletePerson:(_deletePerson=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_18___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.mark((function _callee5(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(values.person){_context5.next=2;break}return _context5.abrupt("return",!1);case 2:return _context5.next=4,lib_api__WEBPACK_IMPORTED_MODULE_22__.a.delete("api/person/".concat(values.person.id));case 4:return _context5.abrupt("return",!0);case 5:case"end":return _context5.stop()}}),_callee5)}))),function deletePerson(){return _deletePerson.apply(this,arguments)})}]}},actionToUrl:function actionToUrl(_ref8){var values=_ref8.values,props=_ref8.props;return{setListFilters:function setListFilters(){if(props.updateURL&&kea_router__WEBPACK_IMPORTED_MODULE_21__.router.values.location.pathname.indexOf("/persons")>-1)return["/persons",values.listFilters,void 0,{replace:!0}]},navigateToTab:function navigateToTab(){if(kea_router__WEBPACK_IMPORTED_MODULE_21__.router.values.location.pathname.indexOf("/person")>-1)return[kea_router__WEBPACK_IMPORTED_MODULE_21__.router.values.location.pathname,kea_router__WEBPACK_IMPORTED_MODULE_21__.router.values.searchParams,_objectSpread(_objectSpread({},kea_router__WEBPACK_IMPORTED_MODULE_21__.router.values.hashParams),{},{activeTab:values.activeTab})]}}},urlToAction:function urlToAction(_ref9){var actions=_ref9.actions,values=_ref9.values;return{"/persons":function persons(_ref10,searchParams){_babel_runtime_helpers_objectDestructuringEmpty__WEBPACK_IMPORTED_MODULE_14___default()(_ref10),actions.setListFilters(searchParams),values.persons.results.length||values.personsLoading||actions.loadPersons()},"/person/*":function person(_ref11,_ref12,_ref13){var _person=_ref11._,sessionRecordingId=_ref12.sessionRecordingId,activeTab=_ref13.activeTab;sessionRecordingId?values.showSessionRecordings?actions.navigateToTab(_types__WEBPACK_IMPORTED_MODULE_24__.q.SESSION_RECORDINGS):actions.navigateToTab(_types__WEBPACK_IMPORTED_MODULE_24__.q.SESSIONS):activeTab&&values.activeTab!==activeTab&&actions.navigateToTab(activeTab),_person&&actions.loadPerson(_person)}}},path:function path(){return["scenes","persons","personsLogic"]}})},5722:function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(2),_interopRequireDefault=__webpack_require__(1);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(__webpack_require__(22)),_defineProperty2=_interopRequireDefault(__webpack_require__(5)),React=_interopRequireWildcard(__webpack_require__(0)),_classnames=_interopRequireDefault(__webpack_require__(10)),_default=function Element(props){var _classNames,_classNames2,prefixCls=props.prefixCls,className=props.className,style=props.style,size=props.size,shape=props.shape,sizeCls=(0,_classnames.default)((_classNames={},(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-lg"),"large"===size),(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-sm"),"small"===size),_classNames)),shapeCls=(0,_classnames.default)((_classNames2={},(0,_defineProperty2.default)(_classNames2,"".concat(prefixCls,"-circle"),"circle"===shape),(0,_defineProperty2.default)(_classNames2,"".concat(prefixCls,"-square"),"square"===shape),(0,_defineProperty2.default)(_classNames2,"".concat(prefixCls,"-round"),"round"===shape),_classNames2)),sizeStyle="number"==typeof size?{width:size,height:size,lineHeight:"".concat(size,"px")}:{};return React.createElement("span",{className:(0,_classnames.default)(prefixCls,sizeCls,shapeCls,className),style:(0,_extends2.default)((0,_extends2.default)({},sizeStyle),style)})};exports.default=_default},5845:function(module,exports,__webpack_require__){(exports=__webpack_require__(54)(!1)).push([module.i,'.bg-mid{background-color:#f2f2f2!important}.mixin-base-bordered-card{border-radius:4px;box-shadow:0 4px 10px rgba(0,0,0,.04)}.mixin-gradient-overlay{width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent)}.mixin-gradient-overlay,.mixin-gradient-overlay-right{content:"";position:absolute;pointer-events:none;bottom:0}.mixin-gradient-overlay-right{width:3rem;height:100%;background:linear-gradient(270deg,#fff,transparent)}.text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.merge-split-person .activity-header{background-color:#f2f2f2;border-top:1px solid #d9d9d9;border-bottom:1px solid #d9d9d9;margin-left:-24px;margin-right:-24px;padding:8px 0;display:flex;justify-content:center;margin-bottom:16px}.merge-split-person .ant-modal-header{border-bottom:0}.merge-split-person .ant-modal-body{padding-top:0}.merge-split-person .ant-radio-wrapper{margin-right:2px}.merge-split-person .ant-col{margin-right:16px}.merge-split-person code{background-color:#f2f2f2;color:#35416b;padding:4px 8px;border-radius:4px}',""]),exports.locals={zDrawer:"950",zPopup:"1060",zGraphAnnotationPrompt:"99"},module.exports=exports},5846:function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(1);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=_interopRequireDefault(__webpack_require__(5847)).default;exports.default=_default},5847:function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(2),_interopRequireDefault=__webpack_require__(1);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _defineProperty2=_interopRequireDefault(__webpack_require__(5)),_extends2=_interopRequireDefault(__webpack_require__(22)),_typeof2=_interopRequireDefault(__webpack_require__(89)),React=_interopRequireWildcard(__webpack_require__(0)),_classnames=_interopRequireDefault(__webpack_require__(10)),_Title=_interopRequireDefault(__webpack_require__(5848)),_Paragraph=_interopRequireDefault(__webpack_require__(5849)),_configProvider=__webpack_require__(119),_Element=_interopRequireDefault(__webpack_require__(5722)),_Avatar=_interopRequireDefault(__webpack_require__(5850)),_Button=_interopRequireDefault(__webpack_require__(5851)),_Input=_interopRequireDefault(__webpack_require__(5852)),_Image=_interopRequireDefault(__webpack_require__(5853));function getComponentProps(prop){return prop&&"object"===(0,_typeof2.default)(prop)?prop:{}}var Skeleton=function Skeleton(props){var renderSkeleton=function renderSkeleton(_ref){var getPrefixCls=_ref.getPrefixCls,direction=_ref.direction,customizePrefixCls=props.prefixCls,loading=props.loading,className=props.className,children=props.children,avatar=props.avatar,title=props.title,paragraph=props.paragraph,active=props.active,round=props.round,prefixCls=getPrefixCls("skeleton",customizePrefixCls);if(loading||!("loading"in props)){var _classNames,avatarNode,contentNode,hasAvatar=!!avatar,hasTitle=!!title,hasParagraph=!!paragraph;if(hasAvatar){var avatarProps=(0,_extends2.default)((0,_extends2.default)({prefixCls:"".concat(prefixCls,"-avatar")},function getAvatarBasicProps(hasTitle,hasParagraph){return hasTitle&&!hasParagraph?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}(hasTitle,hasParagraph)),getComponentProps(avatar));avatarNode=React.createElement("div",{className:"".concat(prefixCls,"-header")},React.createElement(_Element.default,avatarProps))}if(hasTitle||hasParagraph){var $title,paragraphNode;if(hasTitle){var titleProps=(0,_extends2.default)((0,_extends2.default)({prefixCls:"".concat(prefixCls,"-title")},function getTitleBasicProps(hasAvatar,hasParagraph){return!hasAvatar&&hasParagraph?{width:"38%"}:hasAvatar&&hasParagraph?{width:"50%"}:{}}(hasAvatar,hasParagraph)),getComponentProps(title));$title=React.createElement(_Title.default,titleProps)}if(hasParagraph){var paragraphProps=(0,_extends2.default)((0,_extends2.default)({prefixCls:"".concat(prefixCls,"-paragraph")},function getParagraphBasicProps(hasAvatar,hasTitle){var basicProps={};return hasAvatar&&hasTitle||(basicProps.width="61%"),basicProps.rows=!hasAvatar&&hasTitle?3:2,basicProps}(hasAvatar,hasTitle)),getComponentProps(paragraph));paragraphNode=React.createElement(_Paragraph.default,paragraphProps)}contentNode=React.createElement("div",{className:"".concat(prefixCls,"-content")},$title,paragraphNode)}var cls=(0,_classnames.default)(prefixCls,(_classNames={},(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-with-avatar"),hasAvatar),(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-active"),active),(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-rtl"),"rtl"===direction),(0,_defineProperty2.default)(_classNames,"".concat(prefixCls,"-round"),round),_classNames),className);return React.createElement("div",{className:cls},avatarNode,contentNode)}return children};return React.createElement(_configProvider.ConfigConsumer,null,renderSkeleton)};Skeleton.defaultProps={avatar:!1,title:!0,paragraph:!0},Skeleton.Button=_Button.default,Skeleton.Avatar=_Avatar.default,Skeleton.Input=_Input.default,Skeleton.Image=_Image.default;var _default=Skeleton;exports.default=_default},5848:function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(2),_interopRequireDefault=__webpack_require__(1);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(__webpack_require__(22)),React=_interopRequireWildcard(__webpack_require__(0)),_classnames=_interopRequireDefault(__webpack_require__(10)),_default=function Title(_ref){var prefixCls=_ref.prefixCls,className=_ref.className,width=_ref.width,style=_ref.style;return React.createElement("h3",{className:(0,_classnames.default)(prefixCls,className),style:(0,_extends2.default)({width:width},style)})};exports.default=_default},5849:function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(2),_interopRequireDefault=__webpack_require__(1);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _toConsumableArray2=_interopRequireDefault(__webpack_require__(18)),React=_interopRequireWildcard(__webpack_require__(0)),_classnames=_interopRequireDefault(__webpack_require__(10)),_default=function Paragraph(props){var getWidth=function getWidth(index){var width=props.width,_props$rows=props.rows,rows=void 0===_props$rows?2:_props$rows;return Array.isArray(width)?width[index]:rows-1===index?width:void 0},prefixCls=props.prefixCls,className=props.className,style=props.style,rows=props.rows,rowList=(0,_toConsumableArray2.default)(Array(rows)).map((function(_,index){return React.createElement("li",{key:index,style:{width:getWidth(index)}})}));return React.createElement("ul",{className:(0,_classnames.default)(prefixCls,className),style:style},rowList)};exports.default=_default},5850:function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(2),_interopRequireDefault=__webpack_require__(1);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(__webpack_require__(22)),_defineProperty2=_interopRequireDefault(__webpack_require__(5)),React=_interopRequireWildcard(__webpack_require__(0)),_omit=_interopRequireDefault(__webpack_require__(429)),_classnames=_interopRequireDefault(__webpack_require__(10)),_configProvider=__webpack_require__(119),_Element=_interopRequireDefault(__webpack_require__(5722)),SkeletonAvatar=function SkeletonAvatar(props){var renderSkeletonAvatar=function renderSkeletonAvatar(_ref){var getPrefixCls=_ref.getPrefixCls,customizePrefixCls=props.prefixCls,className=props.className,active=props.active,prefixCls=getPrefixCls("skeleton",customizePrefixCls),otherProps=(0,_omit.default)(props,["prefixCls"]),cls=(0,_classnames.default)(prefixCls,"".concat(prefixCls,"-element"),(0,_defineProperty2.default)({},"".concat(prefixCls,"-active"),active),className);return React.createElement("div",{className:cls},React.createElement(_Element.default,(0,_extends2.default)({prefixCls:"".concat(prefixCls,"-avatar")},otherProps)))};return React.createElement(_configProvider.ConfigConsumer,null,renderSkeletonAvatar)};SkeletonAvatar.defaultProps={size:"default",shape:"circle"};var _default=SkeletonAvatar;exports.default=_default},5851:function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(2),_interopRequireDefault=__webpack_require__(1);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(__webpack_require__(22)),_defineProperty2=_interopRequireDefault(__webpack_require__(5)),React=_interopRequireWildcard(__webpack_require__(0)),_omit=_interopRequireDefault(__webpack_require__(429)),_classnames=_interopRequireDefault(__webpack_require__(10)),_Element=_interopRequireDefault(__webpack_require__(5722)),_configProvider=__webpack_require__(119),SkeletonButton=function SkeletonButton(props){var renderSkeletonButton=function renderSkeletonButton(_ref){var getPrefixCls=_ref.getPrefixCls,customizePrefixCls=props.prefixCls,className=props.className,active=props.active,prefixCls=getPrefixCls("skeleton",customizePrefixCls),otherProps=(0,_omit.default)(props,["prefixCls"]),cls=(0,_classnames.default)(prefixCls,"".concat(prefixCls,"-element"),(0,_defineProperty2.default)({},"".concat(prefixCls,"-active"),active),className);return React.createElement("div",{className:cls},React.createElement(_Element.default,(0,_extends2.default)({prefixCls:"".concat(prefixCls,"-button")},otherProps)))};return React.createElement(_configProvider.ConfigConsumer,null,renderSkeletonButton)};SkeletonButton.defaultProps={size:"default"};var _default=SkeletonButton;exports.default=_default},5852:function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(2),_interopRequireDefault=__webpack_require__(1);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(__webpack_require__(22)),_defineProperty2=_interopRequireDefault(__webpack_require__(5)),React=_interopRequireWildcard(__webpack_require__(0)),_omit=_interopRequireDefault(__webpack_require__(429)),_classnames=_interopRequireDefault(__webpack_require__(10)),_Element=_interopRequireDefault(__webpack_require__(5722)),_configProvider=__webpack_require__(119),SkeletonInput=function SkeletonInput(props){var renderSkeletonInput=function renderSkeletonInput(_ref){var getPrefixCls=_ref.getPrefixCls,customizePrefixCls=props.prefixCls,className=props.className,active=props.active,prefixCls=getPrefixCls("skeleton",customizePrefixCls),otherProps=(0,_omit.default)(props,["prefixCls"]),cls=(0,_classnames.default)(prefixCls,"".concat(prefixCls,"-element"),(0,_defineProperty2.default)({},"".concat(prefixCls,"-active"),active),className);return React.createElement("div",{className:cls},React.createElement(_Element.default,(0,_extends2.default)({prefixCls:"".concat(prefixCls,"-input")},otherProps)))};return React.createElement(_configProvider.ConfigConsumer,null,renderSkeletonInput)};SkeletonInput.defaultProps={size:"default"};var _default=SkeletonInput;exports.default=_default},5853:function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(1),_interopRequireWildcard=__webpack_require__(2);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var React=_interopRequireWildcard(__webpack_require__(0)),_classnames=_interopRequireDefault(__webpack_require__(10)),_configProvider=__webpack_require__(119),_default=function SkeletonImage(props){var renderSkeletonImage=function renderSkeletonImage(_ref){var getPrefixCls=_ref.getPrefixCls,customizePrefixCls=props.prefixCls,className=props.className,style=props.style,prefixCls=getPrefixCls("skeleton",customizePrefixCls),cls=(0,_classnames.default)(prefixCls,"".concat(prefixCls,"-element"),className);return React.createElement("div",{className:cls},React.createElement("div",{className:(0,_classnames.default)("".concat(prefixCls,"-image"),className),style:style},React.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(prefixCls,"-image-svg")},React.createElement("path",{d:"M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",className:"".concat(prefixCls,"-image-path")}))))};return React.createElement(_configProvider.ConfigConsumer,null,renderSkeletonImage)};exports.default=_default},5891:function(module,__webpack_exports__,__webpack_require__){"use strict";var react=__webpack_require__(0),asn_MergeCellsOutlined={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482.2 508.4L331.3 389c-3-2.4-7.3-.2-7.3 3.6V478H184V184h204v128c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V144c0-15.5-12.5-28-28-28H144c-15.5 0-28 12.5-28 28v736c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v128H184V546h140v85.4c0 3.8 4.4 6 7.3 3.6l150.9-119.4a4.5 4.5 0 000-7.2zM880 116H596c-15.5 0-28 12.5-28 28v168c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V184h204v294H700v-85.4c0-3.8-4.3-6-7.3-3.6l-151 119.4a4.52 4.52 0 000 7.1l151 119.5c2.9 2.3 7.3.2 7.3-3.6V546h140v294H636V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v168c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V144c0-15.5-12.5-28-28-28z"}}]},name:"merge-cells",theme:"outlined"},AntdIcon=__webpack_require__(17),icons_MergeCellsOutlined_MergeCellsOutlined=function MergeCellsOutlined(props,ref){return react.createElement(AntdIcon.a,Object.assign({},props,{ref:ref,icon:asn_MergeCellsOutlined}))};icons_MergeCellsOutlined_MergeCellsOutlined.displayName="MergeCellsOutlined";__webpack_exports__.a=react.forwardRef(icons_MergeCellsOutlined_MergeCellsOutlined)},6095:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene})),__webpack_require__.d(__webpack_exports__,"Person",(function(){return Person}));__webpack_require__(198),__webpack_require__(36);var ActivityType,slicedToArray=__webpack_require__(15),slicedToArray_default=__webpack_require__.n(slicedToArray),react=__webpack_require__(0),react_default=__webpack_require__.n(react),tabs=__webpack_require__(525),menu=__webpack_require__(318),row=__webpack_require__(354),col=__webpack_require__(231),card=__webpack_require__(5622),dropdown=__webpack_require__(858),tag=__webpack_require__(864),es_button=__webpack_require__(114),popconfirm=__webpack_require__(5586),skeleton=__webpack_require__(1178),SessionsView=__webpack_require__(5775),events=__webpack_require__(1790),SessionRecordingsTable=__webpack_require__(2495),index_esm=__webpack_require__(3),personsLogic=__webpack_require__(5714),PersonHeader=__webpack_require__(459),CopyToClipboard=(__webpack_require__(2637),__webpack_require__(604)),utils=__webpack_require__(12),DownOutlined=__webpack_require__(587),MergeCellsOutlined=__webpack_require__(5891),LoadingOutlined=__webpack_require__(371),DeleteOutlined=__webpack_require__(5602),dayjs_min=__webpack_require__(33),dayjs_min_default=__webpack_require__.n(dayjs_min),modal=(__webpack_require__(60),__webpack_require__(65),__webpack_require__(2605)),es_radio=__webpack_require__(1157),es_select=__webpack_require__(209),injectStylesIntoStyleTag=__webpack_require__(23),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),MergeSplitPerson=__webpack_require__(5845),MergeSplitPerson_default=__webpack_require__.n(MergeSplitPerson),options={insert:"head",singleton:!1},regenerator=(injectStylesIntoStyleTag_default()(MergeSplitPerson_default.a,options),MergeSplitPerson_default.a.locals,__webpack_require__(44),__webpack_require__(37),__webpack_require__(49),__webpack_require__(6)),regenerator_default=__webpack_require__.n(regenerator),defineProperty=__webpack_require__(5),defineProperty_default=__webpack_require__.n(defineProperty),asyncToGenerator=(__webpack_require__(67),__webpack_require__(13)),asyncToGenerator_default=__webpack_require__.n(asyncToGenerator),lib=__webpack_require__(20),api=__webpack_require__(21),eventUsageLogic=__webpack_require__(46);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}!function(ActivityType){ActivityType.SPLIT="split",ActivityType.MERGE="merge"}(ActivityType||(ActivityType={}));var mergeSplitPersonLogic=Object(index_esm.kea)({props:{},key:function key(props){return props.person.id},connect:{actions:[personsLogic.a,["setListFilters","loadPersons","setPerson","setSplitMergeModalShown"]],values:[personsLogic.a,["persons"]]},actions:{setActivity:function setActivity(activity){return{activity:activity}},setSelectedPersonsToMerge:function setSelectedPersonsToMerge(persons){return{persons:persons}},setSelectedPersonToAssignSplit:function setSelectedPersonToAssignSplit(id){return{id:id}},cancel:!0},reducers:function reducers(_ref){var props=_ref.props;return{activity:[ActivityType.MERGE,{setActivity:function setActivity(_,_ref2){return _ref2.activity}}],person:[props.person,{}],selectedPersonsToMerge:[[],{setSelectedPersonsToMerge:function setSelectedPersonsToMerge(_,_ref3){return _ref3.persons}}],selectedPersonsToAssignSplit:[null,{setSelectedPersonToAssignSplit:function setSelectedPersonToAssignSplit(_,_ref4){return _ref4.id}}]}},listeners:function listeners(_ref5){var actions=_ref5.actions,values=_ref5.values;return{setListFilters:function setListFilters(){actions.loadPersons()},cancel:function cancel(){values.executedLoading||actions.setSplitMergeModalShown(!1)}}},loaders:function loaders(_ref6){var _execute,values=_ref6.values,actions=_ref6.actions;return{executed:[!1,{execute:(_execute=asyncToGenerator_default()(regenerator_default.a.mark((function _callee(){var newPerson;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(values.activity!==ActivityType.MERGE){_context.next=12;break}return _context.next=3,api.a.create("api/person/"+values.person.id+"/merge/",{ids:values.selectedPersonsToMerge});case 3:if(!(newPerson=_context.sent).id){_context.next=10;break}return Object(utils.mb)("Persons succesfully merged.","All users have been succesfully merged. Changes should take effect immediately."),eventUsageLogic.d.actions.reportPersonMerged(values.selectedPersonsToMerge.length),actions.setSplitMergeModalShown(!1),actions.setPerson(newPerson),_context.abrupt("return",!0);case 10:_context.next=21;break;case 12:return _context.next=14,api.a.create("api/person/"+values.person.id+"/split/",_objectSpread({},values.selectedPersonsToAssignSplit?{main_distinct_id:values.selectedPersonsToAssignSplit}:{}));case 14:if(!_context.sent.success){_context.next=21;break}return Object(utils.mb)("Person succesfully split.","We are in the process of splitting this person. It may take up to a couple of minutes to complete."),eventUsageLogic.d.actions.reportPersonSplit(values.person.distinct_ids.length),actions.setSplitMergeModalShown(!1),lib.router.actions.push("/persons"),_context.abrupt("return",!0);case 21:return _context.abrupt("return",!1);case 22:case"end":return _context.stop()}}),_callee)}))),function execute(){return _execute.apply(this,arguments)})}]}},events:function events(_ref7){return{afterMount:[_ref7.actions.loadPersons]}},path:function path(key){return["scenes","persons","mergeSplitPersonLogic",key]}}),ErrorMessage=__webpack_require__(507),Tooltip=__webpack_require__(56);function MergeSplitPerson_MergeSplitPerson(_ref){var person=_ref.person,logicProps={person:person},_useValues=Object(index_esm.useValues)(mergeSplitPersonLogic(logicProps)),activity=_useValues.activity,executedLoading=_useValues.executedLoading,_useActions=Object(index_esm.useActions)(mergeSplitPersonLogic(logicProps)),setActivity=_useActions.setActivity,execute=_useActions.execute,cancel=_useActions.cancel;return react_default.a.createElement(modal.a,{visible:!0,title:"Merge/split persons",onCancel:cancel,className:"merge-split-person",okText:"".concat(Object(utils.h)(activity)," persons"),onOk:execute,okButtonProps:{loading:executedLoading},cancelButtonProps:{disabled:executedLoading}},react_default.a.createElement("div",{className:"activity-header"},react_default.a.createElement(row.a,{align:"middle"},react_default.a.createElement(es_radio.a.Group,{onChange:function onChange(e){return setActivity(e.target.value)},value:activity},react_default.a.createElement(col.a,{className:"tab-btn ant-btn"},react_default.a.createElement(es_radio.a,{value:"merge"},"Merge")),react_default.a.createElement(col.a,{className:"tab-btn ant-btn"},react_default.a.createElement(es_radio.a,{value:"split",disabled:person.distinct_ids.length<2},person.distinct_ids.length<2?react_default.a.createElement(Tooltip.a,{title:"Only persons with more than two distinct IDs can be split.",delayMs:0},"Split"):react_default.a.createElement(react_default.a.Fragment,null,"Split")))))),react_default.a.createElement(index_esm.BindLogic,{logic:mergeSplitPersonLogic,props:logicProps},react_default.a.createElement(react_default.a.Fragment,null,activity===ActivityType.MERGE?react_default.a.createElement(MergePerson,null):react_default.a.createElement(SplitPerson,null))))}function MergePerson(){var _useValues2=Object(index_esm.useValues)(mergeSplitPersonLogic),persons=_useValues2.persons,person=_useValues2.person,executedLoading=_useValues2.executedLoading,_useActions2=Object(index_esm.useActions)(mergeSplitPersonLogic),setListFilters=_useActions2.setListFilters,setSelectedPersonsToMerge=_useActions2.setSelectedPersonsToMerge;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("p",{className:"mb"},"Merge all properties and events of the selected persons into ",react_default.a.createElement("strong",null,person.name)," ",react_default.a.createElement("span",{style:{fontSize:"1.2em"}},"("),react_default.a.createElement("code",{title:person.distinct_ids[0]},Object(utils.X)(person.distinct_ids[0],20)),react_default.a.createElement("span",{style:{fontSize:"1.2em"}},")"),". If there is a ",react_default.a.createElement("b",null,"conflict"),", the properties of"," ",react_default.a.createElement("b",null,"this person will take precedence"),"."),react_default.a.createElement(es_select.a,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"100%"},placeholder:"Please select persons to merge",onChange:function onChange(value){return setSelectedPersonsToMerge(value)},filterOption:!1,onSearch:function onSearch(value){setListFilters({search:value})},className:"mt",disabled:executedLoading},persons.results&&persons.results.filter((function(p){return p.uuid!==person.uuid})).map((function(p){return p.id?react_default.a.createElement(es_select.a.Option,{value:p.id,key:p.id},p.name):void 0}))),react_default.a.createElement(ErrorMessage.a,{style:{marginTop:16}},"This action is not reversible. Please be sure before continuing."))}function SplitPerson(){var _useValues3=Object(index_esm.useValues)(mergeSplitPersonLogic),person=_useValues3.person,executedLoading=_useValues3.executedLoading,setSelectedPersonToAssignSplit=Object(index_esm.useActions)(mergeSplitPersonLogic).setSelectedPersonToAssignSplit;return person?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("p",null,"This will split all Distinct IDs for this person into unique persons."),react_default.a.createElement("p",null,"You can select a distinct ID for which all the current properties will be assigned (",react_default.a.createElement("i",null,"optional"),"). All other new users will start without any properties."),react_default.a.createElement(es_select.a,{allowClear:!0,showSearch:!0,style:{width:"100%"},placeholder:"Select a distinct ID to which to assign all properties (optional)",onChange:function onChange(value){return setSelectedPersonToAssignSplit(value)},filterOption:!1,disabled:executedLoading},null==person?void 0:person.distinct_ids.map((function(distinct_id){return react_default.a.createElement(es_select.a.Option,{value:distinct_id,key:distinct_id},distinct_id)}))),react_default.a.createElement(ErrorMessage.a,{style:{marginTop:16}},react_default.a.createElement("div",null,"This will create ",react_default.a.createElement("strong",null,person.distinct_ids.length-1)," new"," ",Object(utils.eb)(person.distinct_ids.length,"person",void 0,!1),". This might change the numbers in your charts, even historically. Please be certain."))):null}try{MergeSplitPerson_MergeSplitPerson.displayName="MergeSplitPerson",MergeSplitPerson_MergeSplitPerson.__docgenInfo={description:"",displayName:"MergeSplitPerson",props:{person:{defaultValue:null,description:"",name:"person",required:!0,type:{name:"PersonType"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/MergeSplitPerson.tsx#MergeSplitPerson"]={docgenInfo:MergeSplitPerson_MergeSplitPerson.__docgenInfo,name:"MergeSplitPerson",path:"frontend/src/scenes/persons/MergeSplitPerson.tsx#MergeSplitPerson"})}catch(__react_docgen_typescript_loader_error){}var lib_skeleton=__webpack_require__(5846),skeleton_default=__webpack_require__.n(lib_skeleton),table=__webpack_require__(2604);function PersonCohorts(){var _useValues=Object(index_esm.useValues)(personsLogic.a),cohorts=_useValues.cohorts,cohortsLoading=_useValues.cohortsLoading,_useActions=Object(index_esm.useActions)(personsLogic.a),loadCohorts=_useActions.loadCohorts,navigateToCohort=_useActions.navigateToCohort;if(Object(react.useEffect)((function(){null!==cohorts||cohortsLoading||loadCohorts()}),[cohorts,cohortsLoading]),cohortsLoading)return react_default.a.createElement(skeleton_default.a,{paragraph:{rows:2},active:!0});return react_default.a.createElement(table.a,{dataSource:cohorts||[],loading:cohortsLoading,columns:[{title:"Name",dataIndex:"name",key:"name",className:"ph-no-capture",sorter:function sorter(a,b){return(""+a.name).localeCompare(b.name)}},{title:"Users in cohort",render:function RenderCount(_,cohort){var _cohort$count;return null===(_cohort$count=cohort.count)||void 0===_cohort$count?void 0:_cohort$count.toLocaleString()},sorter:function sorter(a,b){return(a.count||0)-(b.count||0)}}],rowClassName:"cursor-pointer",rowKey:"id",pagination:{pageSize:100,hideOnSinglePage:!0},onRow:function onRow(cohort){return{onClick:function onClick(){return navigateToCohort(cohort)},"data-test-cohort-row":cohort.id}},locale:{emptyText:"Person belongs to no cohorts"}})}var PropertiesTable=__webpack_require__(673),input=__webpack_require__(702),PlusOutlined=__webpack_require__(1782),SaveOutlined=__webpack_require__(5692),BulbOutlined=__webpack_require__(5678),CheckOutlined=__webpack_require__(871),CloseOutlined=__webpack_require__(238),StopOutlined=__webpack_require__(5595),icons=__webpack_require__(80),Modal=__webpack_require__(345),Modal_default=__webpack_require__.n(Modal);function NewPropertyComponent_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function NewPropertyComponent_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?NewPropertyComponent_ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):NewPropertyComponent_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var NewPropertyComponent_NewPropertyComponent=function NewPropertyComponent(){var initialState={creating:!1,propertyType:"string"},_useState=Object(react.useState)(initialState),_useState2=slicedToArray_default()(_useState,2),state=_useState2[0],setState=_useState2[1],editProperty=Object(index_esm.useActions)(personsLogic.a).editProperty,saveProperty=function saveProperty(){state.key&&void 0!==state.value&&(editProperty(state.key,state.value),setState(initialState))};return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("div",{className:"mb"},react_default.a.createElement("div",{className:"text-right"},react_default.a.createElement(es_button.a,{"data-attr":"add-prop-button",onClick:function onClick(){return setState(NewPropertyComponent_objectSpread(NewPropertyComponent_objectSpread({},state),{},{creating:!0}))},type:"primary",icon:react_default.a.createElement(PlusOutlined.a,null)},"New property"))),react_default.a.createElement(Modal_default.a,{visible:state.creating,destroyOnClose:!0,onCancel:function onCancel(){return setState(initialState)},title:"Adding new property",okText:react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(SaveOutlined.a,{style:{marginRight:4}}),"Save Property"),okButtonProps:{disabled:!state.key||void 0===state.value},onOk:saveProperty},react_default.a.createElement("div",{className:"input-set"},react_default.a.createElement("label",{htmlFor:"propertyKey"},"Key"),react_default.a.createElement(input.a,{id:"propertyKey",autoFocus:!0,placeholder:"try email, first_name, is_verified, membership_level, total_revenue",onChange:function onChange(e){return setState(NewPropertyComponent_objectSpread(NewPropertyComponent_objectSpread({},state),{},{key:e.target.value}))}})),react_default.a.createElement("div",{className:"input-set"},react_default.a.createElement("label",{htmlFor:"propertyType"},"Type of Property"),react_default.a.createElement("div",null,react_default.a.createElement(es_radio.a.Group,{value:state.propertyType,onChange:function onChange(e){return setState(NewPropertyComponent_objectSpread(NewPropertyComponent_objectSpread({},state),{},{propertyType:e.target.value,value:"string"===e.target.value?void 0:"true"}))},id:"propertyType",buttonStyle:"solid"},react_default.a.createElement(es_radio.a.Button,{value:"string"},react_default.a.createElement(icons.IconText,null)," Text or Number"),react_default.a.createElement(es_radio.a.Button,{value:"boolean"},react_default.a.createElement(BulbOutlined.a,null)," Boolean or Null")))),react_default.a.createElement("div",{className:"input-set"},react_default.a.createElement("label",{htmlFor:"propertyValue"},"Value"),"boolean"===state.propertyType?react_default.a.createElement("div",null,react_default.a.createElement(es_radio.a.Group,{value:state.value,onChange:function onChange(e){return setState(NewPropertyComponent_objectSpread(NewPropertyComponent_objectSpread({},state),{},{value:e.target.value}))},id:"propertyValue",buttonStyle:"solid"},react_default.a.createElement(es_radio.a.Button,{value:"true",defaultChecked:!0},react_default.a.createElement(CheckOutlined.a,null)," True"),react_default.a.createElement(es_radio.a.Button,{value:"false"},react_default.a.createElement(CloseOutlined.a,null)," False"),react_default.a.createElement(es_radio.a.Button,{value:"null"},react_default.a.createElement(StopOutlined.a,null)," Null"))):react_default.a.createElement(input.a,{placeholder:"try email@example.com, gold, 1",onChange:function onChange(e){return setState(NewPropertyComponent_objectSpread(NewPropertyComponent_objectSpread({},state),{},{value:e.target.value}))},id:"propertyValue",onKeyDown:function onKeyDown(e){return"Enter"===e.key&&saveProperty()}}))))},relativeTime=__webpack_require__(239),relativeTime_default=__webpack_require__.n(relativeTime),TimezoneAware=__webpack_require__(599),types=__webpack_require__(8),PageHeader=__webpack_require__(319),featureFlagLogic=__webpack_require__(63),constants=__webpack_require__(19);dayjs_min_default.a.extend(relativeTime_default.a);var TabPane=tabs.a.TabPane,scene={component:Person,logic:personsLogic.a};function Person(){var _useState=Object(react.useState)("properties"),_useState2=slicedToArray_default()(_useState,2),activeCardTab=_useState2[0],setActiveCardTab=_useState2[1],_useValues=Object(index_esm.useValues)(personsLogic.a),person=_useValues.person,personLoading=_useValues.personLoading,deletedPersonLoading=_useValues.deletedPersonLoading,hasNewKeys=_useValues.hasNewKeys,currentTab=_useValues.currentTab,showSessionRecordings=_useValues.showSessionRecordings,showTabs=_useValues.showTabs,splitMergeModalShown=_useValues.splitMergeModalShown,_useActions=Object(index_esm.useActions)(personsLogic.a),deletePerson=_useActions.deletePerson,editProperty=_useActions.editProperty,navigateToTab=_useActions.navigateToTab,setSplitMergeModalShown=_useActions.setSplitMergeModalShown,featureFlags=Object(index_esm.useValues)(featureFlagLogic.a).featureFlags,ids=react_default.a.createElement(menu.a,null,null==person?void 0:person.distinct_ids.map((function(distinct_id){return react_default.a.createElement(menu.a.Item,{key:distinct_id},react_default.a.createElement(CopyToClipboard.a,{explicitValue:distinct_id,iconStyle:{color:"var(--primary)"}},Object(utils.X)(distinct_id,32)))})));return react_default.a.createElement("div",{style:{paddingTop:32}},react_default.a.createElement(row.a,{gutter:16},react_default.a.createElement(col.a,{span:16},showTabs?react_default.a.createElement(tabs.a,{defaultActiveKey:types.q.EVENTS,activeKey:currentTab,onChange:function onChange(tab){navigateToTab(tab)}},showSessionRecordings?react_default.a.createElement(TabPane,{tab:react_default.a.createElement("span",{"data-attr":"person-session-recordings-tab"},"Recordings"),key:"sessionRecordings"}):null,react_default.a.createElement(TabPane,{tab:react_default.a.createElement("span",{"data-attr":"persons-events-tab"},"Events"),key:"events"}),featureFlags[constants.o.REMOVE_SESSIONS]?null:react_default.a.createElement(TabPane,{tab:react_default.a.createElement("span",{"data-attr":"person-sessions-tab"},"Sessions"),key:"sessions"})):null,person&&react_default.a.createElement("div",null,currentTab===types.q.SESSION_RECORDINGS?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(PageHeader.a,{title:"Recordings",caption:"Watch recordings to see how this user interacts with your app.",style:{marginTop:0}}),react_default.a.createElement(SessionRecordingsTable.a,{key:person.distinct_ids.join("__"),personUUID:person.uuid,isPersonPage:!0})):currentTab===types.q.SESSIONS?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(PageHeader.a,{title:"Sessions",caption:"Explore how events are being processed within sessions.",style:{marginTop:0}}),react_default.a.createElement(SessionsView.b,{key:person.distinct_ids.join("__"),personIds:person.distinct_ids,isPersonPage:!0})):react_default.a.createElement(events.c,{pageKey:person.distinct_ids.join("__"),fixedFilters:{person_id:person.id},hidePersonColumn:!0}))),react_default.a.createElement(col.a,{span:8},react_default.a.createElement(card.a,{className:"card-elevated person-detail","data-test-person-details":!0},person&&react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(PersonHeader.a,{withIcon:!0,person:person}),react_default.a.createElement("div",{className:"item-group"},react_default.a.createElement("label",null,"IDs"),react_default.a.createElement("div",{style:{display:"flex"}},react_default.a.createElement(CopyToClipboard.a,{explicitValue:person.distinct_ids[0],tooltipMessage:null,iconStyle:{color:"var(--primary)"},style:{justifyContent:"flex-end"}},Object(utils.X)(person.distinct_ids[0],20)),person.distinct_ids.length>1&&react_default.a.createElement(dropdown.a,{overlay:ids,trigger:["click"]},react_default.a.createElement(tag.a,{className:"extra-ids"},"+",person.distinct_ids.length," ",react_default.a.createElement(DownOutlined.a,null))))),person.created_at&&react_default.a.createElement("div",{className:"item-group"},react_default.a.createElement("label",null,"First seen"),react_default.a.createElement("div",null,react_default.a.createElement(TimezoneAware.b,{time:person.created_at}))),react_default.a.createElement("div",{className:"text-center mt"},react_default.a.createElement(es_button.a,{type:"link",onClick:function onClick(){return setSplitMergeModalShown(!0)},"data-attr":"merge-person-button"},react_default.a.createElement(MergeCellsOutlined.a,null)," Split or merge IDs"),react_default.a.createElement(popconfirm.a,{title:"Are you sure to delete this person and all associated data?",onConfirm:deletePerson,okText:"Yes",cancelText:"No"},react_default.a.createElement(es_button.a,{className:"text-danger",disabled:deletedPersonLoading,"data-attr":"delete-person",type:"link"},deletedPersonLoading?react_default.a.createElement(LoadingOutlined.a,{spin:!0}):react_default.a.createElement(DeleteOutlined.a,null)," ","Delete this person")))),!person&&personLoading&&react_default.a.createElement(skeleton.a,{paragraph:{rows:4},active:!0})),react_default.a.createElement(card.a,{className:"card-elevated person-properties",style:{marginTop:16}},react_default.a.createElement(tabs.a,{defaultActiveKey:activeCardTab,onChange:function onChange(tab){setActiveCardTab(tab)}},react_default.a.createElement(TabPane,{tab:react_default.a.createElement("span",{"data-attr":"persons-properties-tab"},"Properties"),key:"properties",disabled:personLoading}),react_default.a.createElement(TabPane,{tab:react_default.a.createElement("span",{"data-attr":"persons-cohorts-tab"},"Cohorts"),key:"cohorts",disabled:personLoading})),person&&("properties"==activeCardTab?react_default.a.createElement("div",{style:{maxWidth:"100%",overflow:"hidden"}},react_default.a.createElement(NewPropertyComponent_NewPropertyComponent,null),react_default.a.createElement("h3",{className:"l3"},"Properties list"),react_default.a.createElement(PropertiesTable.a,{properties:person.properties,onEdit:editProperty,sortProperties:!hasNewKeys,onDelete:function onDelete(key){return editProperty(key,void 0)},className:"persons-page-props-table"})):react_default.a.createElement(PersonCohorts,null)),!person&&personLoading&&react_default.a.createElement(skeleton.a,{paragraph:{rows:6},active:!0})))),splitMergeModalShown&&person&&react_default.a.createElement(MergeSplitPerson_MergeSplitPerson,{person:person}))}}}]);