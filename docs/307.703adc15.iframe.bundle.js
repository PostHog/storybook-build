(window.webpackJsonp=window.webpackJsonp||[]).push([[307],{"./frontend/src/scenes/instance/AsyncMigrations/AsyncMigrations.tsx":function(We,w,i){"use strict";i.r(w),i.d(w,"scene",function(){return Ce}),i.d(w,"AsyncMigrations",function(){return re});var Ue=i("./node_modules/core-js/modules/es.function.name.js"),Ye=i("./node_modules/core-js/modules/es.symbol.js"),He=i("./node_modules/core-js/modules/es.symbol.description.js"),Ge=i("./node_modules/core-js/modules/es.array.includes.js"),ze=i("./node_modules/core-js/modules/es.string.includes.js"),Je=i("./node_modules/core-js/modules/es.array.map.js"),F=i("./node_modules/react/index.js"),n=i.n(F),H=i("./frontend/src/lib/components/PageHeader.tsx"),G=i("./node_modules/antd/es/tabs/index.js"),se=i("./node_modules/antd/es/progress/index.js"),z=i("./node_modules/antd/es/button/index.js"),le=i("./node_modules/antd/es/space/index.js"),p=i("./node_modules/kea/lib/index.esm.js"),ce=i("./node_modules/@ant-design/icons/es/icons/PlayCircleOutlined.js"),Qe=i("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Xe=i("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Ze=i("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),ue=i("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),S=i.n(ue),de=i("./node_modules/@babel/runtime/helpers/defineProperty.js"),R=i.n(de),ge=i("./node_modules/@babel/runtime/regenerator/index.js"),m=i.n(ge),qe=i("./node_modules/core-js/modules/es.array.iterator.js"),_e=i("./node_modules/core-js/modules/es.object.to-string.js"),et=i("./node_modules/core-js/modules/web.dom-collections.iterator.js"),tt=i("./node_modules/core-js/modules/es.array.filter.js"),nt=i("./node_modules/core-js/modules/es.object.keys.js"),rt=i("./node_modules/core-js/modules/es.array.concat.js"),T=i("./frontend/src/lib/api.ts"),V=i("./frontend/src/scenes/userLogic.ts"),me=i("./frontend/src/scenes/instance/SystemStatus/systemStatusLogic.ts"),P=i("./frontend/src/lib/components/lemonToast.tsx"),fe=i("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),pe=i("./node_modules/kea-loaders/lib/index.js"),J=i("./node_modules/kea-router/lib/index.js");function Q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,a)}return r}function j(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Q(Object(r),!0).forEach(function(a){R()(t,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(r,a))})}return t}var M;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.CompletedSuccessfully=2]="CompletedSuccessfully",t[t.Errored=3]="Errored",t[t.RolledBack=4]="RolledBack",t[t.Starting=5]="Starting",t[t.FailedAtStartup=6]="FailedAtStartup"})(M||(M={}));var E;(function(t){t.Management="management",t.FutureMigrations="future",t.Settings="settings"})(E||(E={}));var ye={0:"Not started",1:"Running",2:"Complete",3:"Error",4:"Rolled back",5:"Starting",6:"Failed at startup"},O=Object(p.kea)([Object(p.path)(["scenes","instance","AsyncMigrations","asyncMigrationsLogic"]),Object(p.connect)({values:[fe.a,["preflight"]]}),Object(p.actions)({triggerMigration:function(e){return{migration:e}},resumeMigration:function(e){return{migration:e}},rollbackMigration:function(e){return{migration:e}},forceStopMigration:function(e){return{migration:e}},forceStopMigrationWithoutRollback:function(e){return{migration:e}},updateMigrationStatus:function(e,r,a){return{migration:e,endpoint:r,message:a}},setActiveTab:function(e){return{tab:e}},updateSetting:function(e,r){return{settingKey:e,newValue:r}},loadAsyncMigrationErrors:function(e){return{migrationId:e}},loadAsyncMigrationErrorsSuccess:function(e,r){return{migrationId:e,errors:r}},loadAsyncMigrationErrorsFailure:function(e,r){return{migrationId:e,error:r}},openAsyncMigrationsModal:function(e,r,a){return{migration:e,endpoint:r,message:a}},closeAsyncMigrationsModal:!0}),Object(p.reducers)({activeTab:[E.Management,{setActiveTab:function(e,r){var a=r.tab;return a}}],asyncMigrationErrors:[{},{loadAsyncMigrationErrorsSuccess:function(e,r){var a=r.migrationId,s=r.errors;return j(j({},e),{},R()({},a,s))}}],asyncMigrationErrorsLoading:[{},{loadAsyncMigrationErrors:function(e,r){var a=r.migrationId;return j(j({},e),{},R()({},a,!0))},loadAsyncMigrationErrorsSuccess:function(e,r){var a=r.migrationId;return j(j({},e),{},R()({},a,!1))},loadAsyncMigrationErrorsFailure:function(e,r){var a=r.migrationId;return j(j({},e),{},R()({},a,!1))}}],activeAsyncMigrationModal:[null,{openAsyncMigrationsModal:function(e,r){return r},closeAsyncMigrationsModal:function(){return null},updateMigrationStatus:function(){return null}}]}),Object(pe.loaders)(function(){return{asyncMigrations:[[],{loadAsyncMigrations:function(){var t=S()(m.a.mark(function r(){var a;return m.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if((a=V.a.values.user)!==null&&a!==void 0&&a.is_staff){l.next=2;break}return l.abrupt("return",[]);case 2:return l.next=4,T.b.get("api/async_migrations");case 4:return l.abrupt("return",l.sent.results);case 5:case"end":return l.stop()}},r)}));function e(){return t.apply(this,arguments)}return e}()}],asyncMigrationSettings:[[],{loadAsyncMigrationSettings:function(){var t=S()(m.a.mark(function r(){var a,s;return m.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if((a=V.a.values.user)!==null&&a!==void 0&&a.is_staff){o.next=2;break}return o.abrupt("return",[]);case 2:return o.next=4,T.b.get("api/instance_settings");case 4:return s=o.sent.results,o.abrupt("return",s.filter(function(d){return d.key.includes("ASYNC_MIGRATIONS")}));case 6:case"end":return o.stop()}},r)}));function e(){return t.apply(this,arguments)}return e}()}]}}),Object(p.selectors)({isAnyMigrationRunning:[function(t){return[t.asyncMigrations]},function(t){return t.some(function(e){return[M.Running,M.Starting].includes(e.status)})}],actionableMigrations:[function(t){return[t.asyncMigrations]},function(t){return t.filter(function(e){return e.is_available})}],futureMigrations:[function(t){return[t.asyncMigrations]},function(t){return t.filter(function(e){return!e.is_available})}]}),Object(p.listeners)(function(t){var e=t.actions;return{triggerMigration:function(){var r=S()(m.a.mark(function s(l){var o;return m.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:o=l.migration,Object.keys(o.parameter_definitions).length>0?e.openAsyncMigrationsModal(o,"trigger","Migration triggered successfully"):e.updateMigrationStatus(o,"trigger","Migration triggered successfully");case 2:case"end":return u.stop()}},s)}));function a(s){return r.apply(this,arguments)}return a}(),resumeMigration:function(){var r=S()(m.a.mark(function s(l){var o;return m.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:o=l.migration,Object.keys(o.parameter_definitions).length>0?e.openAsyncMigrationsModal(o,"resume","Migration resume triggered successfully"):e.updateMigrationStatus(o,"resume","Migration resume triggered successfully");case 2:case"end":return u.stop()}},s)}));function a(s){return r.apply(this,arguments)}return a}(),rollbackMigration:function(){var r=S()(m.a.mark(function s(l){var o;return m.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:o=l.migration,e.updateMigrationStatus(o,"rollback","Migration rollback triggered successfully");case 2:case"end":return u.stop()}},s)}));function a(s){return r.apply(this,arguments)}return a}(),forceStopMigration:function(){var r=S()(m.a.mark(function s(l){var o;return m.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:o=l.migration,e.updateMigrationStatus(o,"force_stop","Force stop triggered successfully");case 2:case"end":return u.stop()}},s)}));function a(s){return r.apply(this,arguments)}return a}(),forceStopMigrationWithoutRollback:function(){var r=S()(m.a.mark(function s(l){var o;return m.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:o=l.migration,e.updateMigrationStatus(o,"force_stop_without_rollback","Force stop without rollback triggered successfully");case 2:case"end":return u.stop()}},s)}));function a(s){return r.apply(this,arguments)}return a}(),updateMigrationStatus:function(){var r=S()(m.a.mark(function s(l){var o,d,u,c;return m.a.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return o=l.migration,d=l.endpoint,u=l.message,A.next=3,T.b.create("/api/async_migrations/".concat(o.id,"/").concat(d),{parameters:o.parameters});case 3:c=A.sent,c.success?(P.d.success(u),e.loadAsyncMigrations()):P.d.error(c.error);case 5:case"end":return A.stop()}},s)}));function a(s){return r.apply(this,arguments)}return a}(),updateSetting:function(){var r=S()(m.a.mark(function s(l){var o,d;return m.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=l.settingKey,d=l.newValue,c.prev=1,c.next=4,T.b.update("/api/instance_settings/".concat(o),{value:d});case 4:P.d.success("Instance setting ".concat(o," updated")),e.loadAsyncMigrationSettings(),e.loadAsyncMigrations(),me.b.actions.loadSystemStatus(),c.next=13;break;case 10:c.prev=10,c.t0=c.catch(1),P.d.error("Failed to trigger migration");case 13:case"end":return c.stop()}},s,null,[[1,10]])}));function a(s){return r.apply(this,arguments)}return a}(),loadAsyncMigrationErrors:function(){var r=S()(m.a.mark(function s(l){var o,d;return m.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=l.migrationId,c.prev=1,c.next=4,T.b.get("api/async_migrations/".concat(o,"/errors"));case 4:d=c.sent,e.loadAsyncMigrationErrorsSuccess(o,d),c.next=11;break;case 8:c.prev=8,c.t0=c.catch(1),e.loadAsyncMigrationErrorsFailure(o,c.t0);case 11:case"end":return c.stop()}},s,null,[[1,8]])}));function a(s){return r.apply(this,arguments)}return a}()}}),Object(p.events)(function(t){var e=t.actions;return{afterMount:function(){e.loadAsyncMigrations(),e.loadAsyncMigrationSettings()}}}),Object(J.actionToUrl)(function(t){var e=t.values;return{setActiveTab:function(){return"/instance/async_migrations".concat(e.activeTab===E.Management?"":"/"+e.activeTab)}}}),Object(J.urlToAction)(function(t){var e=t.actions,r=t.values;return{"/instance/async_migrations(/:tab)":function(s){var l=s.tab;l&&l!==r.activeTab&&l!==E.Management&&e.setActiveTab(l)}}})]),X=i("./frontend/src/lib/components/Tooltip.tsx"),Z=i("./frontend/src/lib/components/Spinner/Spinner.tsx"),ve=i("./node_modules/@babel/runtime/helpers/slicedToArray.js"),L=i.n(ve),Me=i("./node_modules/antd/es/row/index.js"),q=i("./node_modules/antd/es/col/index.js"),Ee=i("./node_modules/antd/es/input/index.js"),be=i("./node_modules/antd/es/divider/index.js");function I(t){var e=t.setting,r=Object(p.useActions)(O),a=r.updateSetting,s=Object(F.useState)(String(e.value)),l=L()(s,2),o=l[0],d=l[1];return n.a.createElement("div",{key:e.key},n.a.createElement("h4",null,e.key),n.a.createElement("p",null,e.description),n.a.createElement(Me.a,{gutter:[8,8]},n.a.createElement(q.a,{span:8},n.a.createElement(Ee.a,{value:o,onChange:function(c){return d(c.target.value)}})),n.a.createElement(q.a,{span:16},n.a.createElement(z.a,{disabled:String(e.value)===o,type:"primary",onClick:function(){return a(e.key,o)}},"Update"))),n.a.createElement(be.a,null))}try{I.displayName="SettingUpdateField",I.__docgenInfo={description:"",displayName:"SettingUpdateField",props:{setting:{defaultValue:null,description:"",name:"setting",required:!0,type:{name:"InstanceSetting"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/instance/AsyncMigrations/SettingUpdateField.tsx#SettingUpdateField"]={docgenInfo:I.__docgenInfo,name:"SettingUpdateField",path:"frontend/src/scenes/instance/AsyncMigrations/SettingUpdateField.tsx#SettingUpdateField"})}catch(t){}var _=i("./frontend/src/lib/components/LemonTable/index.ts"),D=i("./frontend/src/lib/utils.tsx"),h=i("./frontend/src/lib/components/LemonButton/index.ts"),$=i("./frontend/src/lib/components/icons.tsx");function k(t){var e=t.asyncMigration,r=Object(p.useValues)(O),a=r.asyncMigrationErrorsLoading,s=r.asyncMigrationErrors,l=Object(p.useActions)(O),o=l.loadAsyncMigrationErrors,d=[{title:"Error",dataIndex:"description"},{title:n.a.createElement(h.a,{icon:a[e.id]?n.a.createElement(Z.a,null):n.a.createElement($.IconRefresh,null),onClick:function(){return o(e.id)},type:"secondary",size:"small"},"Refresh errors"),render:function(c,b){return n.a.createElement("div",null,Object(D.N)(b.created_at))}}];return n.a.createElement(_.a,{columns:d,dataSource:s[e.id],loading:a[e.id],embedded:!0})}try{k.displayName="AsyncMigrationDetails",k.__docgenInfo={description:"",displayName:"AsyncMigrationDetails",props:{asyncMigration:{defaultValue:null,description:"",name:"asyncMigration",required:!0,type:{name:"AsyncMigration"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/instance/AsyncMigrations/AsyncMigrationDetails.tsx#AsyncMigrationDetails"]={docgenInfo:k.__docgenInfo,name:"AsyncMigrationDetails",path:"frontend/src/scenes/instance/AsyncMigrations/AsyncMigrationDetails.tsx#AsyncMigrationDetails"})}catch(t){}var ee=i("./frontend/src/lib/components/LemonButton/More.tsx"),Se=i("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),at=i("./node_modules/core-js/modules/es.object.entries.js"),B=i("./node_modules/kea-forms/lib/index.js");function te(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,a)}return r}function ne(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?te(Object(r),!0).forEach(function(a){R()(t,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(r,a))})}return t}var Ae=Object(p.kea)([Object(p.path)(["scenes","instance","AsyncMigrations","asyncMigrationParameterFormLogic"]),Object(p.props)({}),Object(p.key)(function(t){return t.migration.id}),Object(B.forms)(function(t){var e=t.props;return{parameters:{defaults:he(e),submit:function(){var r=S()(m.a.mark(function s(l){return m.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:O.actions.updateMigrationStatus(ne(ne({},e.migration),{},{parameters:l}),e.endpoint,e.message);case 1:case"end":return d.stop()}},s)}));function a(s){return r.apply(this,arguments)}return a}()}}})]);function he(t){var e={};return Object.keys(t.migration.parameter_definitions).forEach(function(r){t.migration.parameters[r]?e[r]=t.migration.parameters[r]:e[r]=t.migration.parameter_definitions[r][0]}),e}var je=i("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),Oe=i("./frontend/src/lib/components/AnimatedCollapsible.tsx"),x=i("./frontend/src/lib/components/LemonModal/index.ts");function N(t){var e=Object(p.useActions)(O),r=e.closeAsyncMigrationsModal,a=Object(F.useState)(!0),s=L()(a,2),l=s[0],o=s[1];return n.a.createElement(x.a,{title:"",onClose:r,isOpen:!0,simple:!0},n.a.createElement(B.Form,{logic:Ae,props:t,formKey:"parameters",enableFormOnSubmit:!0,id:"async-migration-parameters-form",className:"LemonModal__layout"},n.a.createElement(x.a.Header,null,n.a.createElement("h3",null,"Advanced migration configuration")),n.a.createElement(x.a.Content,null,n.a.createElement("p",null,"This async migration allows tuning parameters used in the async migration.",l&&n.a.createElement(n.a.Fragment,null,n.a.createElement("br",null),n.a.createElement("a",{onClick:function(){o(!l)}},"Click here to show advanced configuration."))),n.a.createElement(Oe.a,{collapsed:l},Object.entries(t.migration.parameter_definitions).map(function(d){var u=L()(d,2),c=u[0],b=L()(u[1],2),A=b[0],W=b[1];return n.a.createElement(B.Field,{name:c,key:c,label:n.a.createElement(n.a.Fragment,null,W)},n.a.createElement(je.a,{type:typeof A=="number"?"number":"text"}))}))),n.a.createElement(x.a.Footer,null,n.a.createElement(h.a,{form:"async-migration-parameters-form",type:"secondary","data-attr":"async-migration-parameters-cancel",className:"mr-2",onClick:r},"Cancel"),n.a.createElement(h.a,{form:"async-migration-parameters-form",htmlType:"submit",type:"primary","data-attr":"async-migration-parameters-submit"},"Run migration"))))}try{N.displayName="AsyncMigrationParametersModal",N.__docgenInfo={description:"",displayName:"AsyncMigrationParametersModal",props:{migration:{defaultValue:null,description:"",name:"migration",required:!0,type:{name:"AsyncMigration"}},endpoint:{defaultValue:null,description:"",name:"endpoint",required:!0,type:{name:"string"}},message:{defaultValue:null,description:"",name:"message",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/instance/AsyncMigrations/AsyncMigrationParametersModal.tsx#AsyncMigrationParametersModal"]={docgenInfo:N.__docgenInfo,name:"AsyncMigrationParametersModal",path:"frontend/src/scenes/instance/AsyncMigrations/AsyncMigrationParametersModal.tsx#AsyncMigrationParametersModal"})}catch(t){}var K=G.a.TabPane,Ce={component:re,logic:O},Re=3e3;function re(){var t=Object(p.useValues)(V.a),e=t.user,r=Object(p.useValues)(O),a=r.asyncMigrationsLoading,s=r.activeTab,l=r.asyncMigrationSettings,o=r.isAnyMigrationRunning,d=r.activeAsyncMigrationModal,u=r.actionableMigrations,c=r.futureMigrations,b=Object(p.useActions)(O),A=b.triggerMigration,W=b.resumeMigration,Te=b.rollbackMigration,Fe=b.forceStopMigration,Pe=b.forceStopMigrationWithoutRollback,ae=b.loadAsyncMigrations,Le=b.loadAsyncMigrationErrors,Ie=b.setActiveTab;Object(F.useEffect)(function(){if(o){var y=setInterval(function(){return ae()},Re);return function(){return clearInterval(y)}}},[o]);var ie={title:"Migration",render:function(v,g){var f="https://github.com/PostHog/posthog/blob/master/posthog/async_migrations/migrations/"+g.name+".py";return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"row-name"},n.a.createElement("a",{href:f},g.name)),n.a.createElement("div",{className:"row-description"},g.description))}},ke={title:"Progress",render:function(v,g){var f=g.progress;return n.a.createElement("div",null,n.a.createElement(se.a,{percent:f}))}},oe={title:"Status",render:function(v,g){var f=g.status,C=f===M.Running?"success":f===M.Errored||f===M.FailedAtStartup?"danger":f===M.Starting||f===M.RolledBack?"warning":"default";return n.a.createElement(Se.a,{type:C,className:"uppercase"},ye[f])}},xe={title:"Last operation index",render:function(v,g){return n.a.createElement("div",null,g.current_operation_index)}},Ne={title:"Last query ID",render:function(v,g){return n.a.createElement("div",null,n.a.createElement("small",null,g.current_query_id))}},we={title:"Started at",render:function(v,g){var f=g.started_at;return n.a.createElement("div",null,Object(D.N)(f))}},Ve={title:"Finished at",render:function(v,g){var f=g.finished_at;return n.a.createElement("div",null,Object(D.N)(f))}},De={title:"",render:function(v,g){var f=g.status;return n.a.createElement("div",null,f===M.NotStarted||f===M.FailedAtStartup?n.a.createElement(X.a,{title:"Start"},n.a.createElement(z.a,{type:"link",icon:n.a.createElement(ce.a,null),onClick:function(){return A(g)}},"Run")):f===M.Starting||f===M.Running?n.a.createElement(ee.a,{overlay:n.a.createElement(n.a.Fragment,null,n.a.createElement(h.a,{status:"stealth",onClick:function(){return Fe(g)},fullWidth:!0},"Stop and rollback"),n.a.createElement(h.a,{status:"stealth",onClick:function(){return Pe(g)},fullWidth:!0},"Stop"))}):f===M.CompletedSuccessfully?n.a.createElement(n.a.Fragment,null):f===M.Errored?n.a.createElement(ee.a,{overlay:n.a.createElement(n.a.Fragment,null,n.a.createElement(h.a,{status:"stealth",onClick:function(){return W(g)},fullWidth:!0},"Resume"),n.a.createElement(h.a,{status:"stealth",onClick:function(){return Te(g)},fullWidth:!0},"Rollback"))}):f===M.RolledBack?n.a.createElement(X.a,{title:"Restart"},n.a.createElement(h.a,{status:"stealth",icon:n.a.createElement($.IconReplay,null),onClick:function(){return A(g)},fullWidth:!0})):null)}},$e={title:"Minimum PostHog version",render:function(v,g){return n.a.createElement("div",null,g.posthog_min_version)}},Be={title:"Maximum PostHog version",render:function(v,g){return n.a.createElement("div",null,g.posthog_max_version)}},U={};U[E.FutureMigrations]=[ie,oe,$e,Be],U[E.Management]=[ie,ke,oe,xe,Ne,we,Ve,De];var Y={};Y[E.FutureMigrations]=c,Y[E.Management]=u;var Ke={expandedRowRender:function(v){return v&&n.a.createElement(k,{asyncMigration:v})},rowExpandable:function(v){return v.error_count>0},onRowExpand:function(v){Le(v.id)}};return n.a.createElement("div",null,e!=null&&e.is_staff?n.a.createElement(n.a.Fragment,null,n.a.createElement(H.a,{title:"Async Migrations",caption:n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,"Manage async migrations in your instance."),n.a.createElement("p",null,"Read about async migrations on our"," ",n.a.createElement("a",{href:"https://posthog.com/docs/self-host/configure/async-migrations/overview"},"dedicated docs page"),"."))}),n.a.createElement(G.a,{activeKey:s,onTabClick:function(v){return Ie(v)}},n.a.createElement(K,{tab:"Management (".concat(u.length,")"),key:E.Management}),c.length>0&&n.a.createElement(K,{tab:"Future Migrations (".concat(c.length,")"),key:E.FutureMigrations}),n.a.createElement(K,{tab:"Settings",key:E.Settings})),[E.Management,E.FutureMigrations].includes(s)?n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"mb-4 float-right"},n.a.createElement(h.a,{icon:a?n.a.createElement(Z.a,null):n.a.createElement($.IconRefresh,null),onClick:ae,type:"secondary",size:"small"},"Refresh")),n.a.createElement(le.b,null),n.a.createElement(_.a,{pagination:{pageSize:10},loading:a,columns:U[s],dataSource:Y[s],expandable:Ke}),d?n.a.createElement(N,d):null):s===E.Settings?n.a.createElement(n.a.Fragment,null,n.a.createElement("br",null),l.map(function(y){return n.a.createElement("div",{key:y.key},n.a.createElement(I,{setting:y}))})):null):n.a.createElement(H.a,{title:"Async Migrations",caption:n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,"Only users with staff access can manage async migrations. Please contact your instance admin."),n.a.createElement("p",null,"If you're an admin and don't have access, set ",n.a.createElement("code",null,"is_staff=true")," for your user on the PostgreSQL ",n.a.createElement("code",null,"posthog_user")," table."))}))}}}]);
