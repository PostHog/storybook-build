"use strict";(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[99303],{"./frontend/src/scenes/pipeline/PipelineNodeNew.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PipelineNodeNew:()=>PipelineNodeNew,scene:()=>scene});var index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),NotFound=__webpack_require__("./frontend/src/lib/components/NotFound/index.tsx"),LemonButton=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/index.ts"),LemonTable=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTable/index.ts"),LemonTableLink=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTable/LemonTableLink.tsx"),urls=__webpack_require__("./frontend/src/scenes/urls.ts"),types=__webpack_require__("./frontend/src/types.ts"),destinationsLogic=__webpack_require__("./frontend/src/scenes/pipeline/destinationsLogic.tsx"),frontendAppsLogic=__webpack_require__("./frontend/src/scenes/pipeline/frontendAppsLogic.tsx"),PipelineNode=__webpack_require__("./frontend/src/scenes/pipeline/PipelineNode.tsx"),utils=__webpack_require__("./frontend/src/lib/utils.tsx"),sceneTypes=__webpack_require__("./frontend/src/scenes/sceneTypes.ts");let NODE_STAGE_TO_PIPELINE_TAB={[types.We.Transformation]:types.J9.Transformations,[types.We.Destination]:types.J9.Destinations,[types.We.SiteApp]:types.J9.SiteApps},pipelineNodeNewLogic=(0,index_esm.kea)([(0,index_esm.props)({}),(0,index_esm.path)(pluginIdOrBatchExportDestination=>["scenes","pipeline","pipelineNodeNewLogic",pluginIdOrBatchExportDestination]),(0,index_esm.selectors)(()=>({breadcrumbs:[(_,p)=>[p.stage,p.pluginId,p.batchExportDestination],(stage,pluginId,batchDestination)=>[{key:sceneTypes.x.Pipeline,name:"Data pipeline",path:urls.j.pipeline()},{key:stage||"unknown",name:stage?(0,utils.fm)(NODE_STAGE_TO_PIPELINE_TAB[stage]||""):"Unknown",path:urls.j.pipeline(stage?NODE_STAGE_TO_PIPELINE_TAB[stage]:void 0)},{key:pluginId||batchDestination||"Unknown",name:pluginId?pluginId.toString():null!=batchDestination?batchDestination:"Options"}]]}))]);var transformationsLogic=__webpack_require__("./frontend/src/scenes/pipeline/transformationsLogic.tsx"),pipeline_utils=__webpack_require__("./frontend/src/scenes/pipeline/utils.tsx"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let paramsToProps=_ref=>{let{params:{stage,pluginIdOrBatchExportDestination}}=_ref,numericId=pluginIdOrBatchExportDestination&&/^\d+$/.test(pluginIdOrBatchExportDestination)?parseInt(pluginIdOrBatchExportDestination):void 0,pluginId=numericId&&!isNaN(numericId)?numericId:null,batchExportDestination=pluginId?null:null!=pluginIdOrBatchExportDestination?pluginIdOrBatchExportDestination:null;return{stage:PipelineNode.PIPELINE_TAB_TO_NODE_STAGE[stage+"s"]||null,pluginId:pluginId,batchExportDestination:batchExportDestination}},scene={component:PipelineNodeNew,logic:pipelineNodeNewLogic,paramsToProps};function convertPluginToTableEntry(plugin){return{id:plugin.id,name:plugin.name,description:plugin.description,plugin:plugin,service:null}}function PipelineNodeNew(){let params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{stage,pluginId,batchExportDestination}=paramsToProps({params});if(!stage)return(0,jsx_runtime.jsx)(NotFound.T,{object:"pipeline app stage"});if(pluginId)return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Plugin ID ",pluginId]});if(batchExportDestination)return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Batch Export Destination ",batchExportDestination]});if(stage===types.We.Transformation){let{plugins,loading}=(0,index_esm.useValues)(transformationsLogic.P),targets=Object.values(plugins).map(convertPluginToTableEntry);return nodeOptionsTable(stage,targets,loading)}if(stage===types.We.Destination){let{plugins,loading}=(0,index_esm.useValues)(destinationsLogic.w),targets=Object.values(plugins).map(convertPluginToTableEntry);return nodeOptionsTable(stage,targets,loading)}if(stage===types.We.SiteApp){let{plugins,loading}=(0,index_esm.useValues)(frontendAppsLogic.$),targets=Object.values(plugins).map(convertPluginToTableEntry);return nodeOptionsTable(stage,targets,loading)}return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Creation is unavailable for ",stage]})}function nodeOptionsTable(stage,targets,loading){return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(LemonTable.g,{dataSource:targets,size:"small",loading:loading,columns:[{title:"Name",sticky:!0,render:function RenderPluginName(_,target){return(0,jsx_runtime.jsx)(LemonTableLink.i,{to:urls.j.pipelineNodeNew(stage,target.id),title:target.name,description:target.description})}},{title:"App",render:function RenderAppInfo(_,target){return target.plugin?(0,jsx_runtime.jsx)(pipeline_utils.Wf,{plugin:target.plugin}):(0,jsx_runtime.jsx)(pipeline_utils.oe,{type:target.service.type})}},{title:"Actions",width:100,align:"right",render:function RenderActions(_,target){return(0,jsx_runtime.jsx)(LemonButton.J,{type:"primary","data-attr":`new-${stage}-${target.id}`,to:urls.j.pipelineNodeNew(stage,target.id),children:"Create"})}}]})})}}}]);