(window.webpackJsonp=window.webpackJsonp||[]).push([[8,10],{"./frontend/src/scenes/apps/appMetricsSceneLogic.ts":function(K,j,r){"use strict";r.r(j),r.d(j,"AppMetricsTab",function(){return c}),r.d(j,"appMetricsSceneLogic",function(){return X});var T=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),p=r.n(T),v=r("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),s=r.n(v),y=r("./node_modules/@babel/runtime/regenerator/index.js"),d=r.n(y),P=r("./node_modules/core-js/modules/es.array.iterator.js"),Y=r.n(P),W=r("./node_modules/core-js/modules/es.object.to-string.js"),Z=r.n(W),F=r("./node_modules/core-js/modules/web.dom-collections.iterator.js"),w=r.n(F),H=r("./node_modules/core-js/modules/es.array.concat.js"),k=r.n(H),S=r("./node_modules/core-js/modules/es.function.name.js"),q=r.n(S),J=r("./node_modules/core-js/modules/es.array.filter.js"),ee=r.n(J),$=r("./node_modules/core-js/modules/es.array.includes.js"),re=r.n($),G=r("./node_modules/core-js/modules/es.string.includes.js"),te=r.n(G),N=r("./node_modules/core-js/modules/es.number.constructor.js"),se=r.n(N),E=r("./node_modules/kea/lib/index.esm.js"),A=r("./node_modules/kea-loaders/lib/index.js"),ne=r.n(A),b=r("./frontend/src/scenes/urls.ts"),z=r("./frontend/src/types.ts"),M=r("./frontend/src/lib/api.ts"),O=r("./frontend/src/scenes/teamLogic.tsx"),D=r("./node_modules/kea-router/lib/index.js"),oe=r.n(D),I=r("./frontend/src/lib/utils.tsx"),C=r("./frontend/src/scenes/plugins/edit/interface-jobs/PluginJobConfiguration.tsx"),Q=r("./frontend/src/scenes/plugins/edit/interface-jobs/interfaceJobsLogic.ts"),L=r("./frontend/src/lib/dayjs.ts"),V=r("./frontend/src/scenes/userLogic.ts"),c;(function(t){t.ProcessEvent="processEvent",t.OnEvent="onEvent",t.ExportEvents="exportEvents",t.ScheduledTask="scheduledTask",t.HistoricalExports="historical_exports",t.History="history"})(c||(c={}));var h="-30d",x=[c.ProcessEvent,c.OnEvent,c.ExportEvents,c.ScheduledTask],X=Object(E.kea)([Object(E.path)(function(t){return["scenes","apps","appMetricsSceneLogic",t]}),Object(E.props)({}),Object(E.key)(function(t){return t.pluginConfigId}),Object(E.actions)({setActiveTab:function(n){return{tab:n}},setDateFrom:function(n){return{dateFrom:n}},openErrorDetailsModal:function(n,o,e){return{errorType:n,category:o,jobId:e}},closeErrorDetailsModal:!0,openHistoricalExportModal:!0}),Object(E.reducers)({activeTab:[null,{setActiveTab:function(n,o){var e=o.tab;return e}}],selectedDateFrom:[null,{setDateFrom:function(n,o){var e=o.dateFrom;return e}}],errorDetailsModalError:[null,{openErrorDetailsModal:function(n,o){var e=o.errorType;return e},closeErrorDetailsModal:function(){return null}}]}),Object(A.loaders)(function(t){var n=t.values,o=t.props;return{pluginConfig:[null,{loadPluginConfig:function(){var e=s()(d.a.mark(function i(){return d.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,M.b.get("api/projects/".concat(O.a.values.currentTeamId,"/plugin_configs/").concat(o.pluginConfigId));case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},i)}));function a(){return e.apply(this,arguments)}return a}()}],appMetricsResponse:[null,{loadMetrics:function(){var e=s()(d.a.mark(function i(){var l;return d.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(!(n.activeTab&&n.dateFrom)){_.next=5;break}return l=Object(I.Gb)({category:n.activeTab,date_from:n.dateFrom}),_.next=4,M.b.get("api/projects/".concat(O.a.values.currentTeamId,"/app_metrics/").concat(o.pluginConfigId,"?").concat(l));case 4:return _.abrupt("return",_.sent);case 5:case"end":return _.stop()}},i)}));function a(){return e.apply(this,arguments)}return a}()}],historicalExports:[[],{loadHistoricalExports:function(){var e=s()(d.a.mark(function i(){var l,u;return d.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,M.b.get("api/projects/".concat(O.a.values.currentTeamId,"/app_metrics/").concat(o.pluginConfigId,"/historical_exports"));case 2:return l=f.sent,u=l.results,f.abrupt("return",u);case 5:case"end":return f.stop()}},i)}));function a(){return e.apply(this,arguments)}return a}()}],errorDetails:[[],{openErrorDetailsModal:function(){var e=s()(d.a.mark(function i(l){var u,_,f,R,U,B;return d.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return u=l.category,_=l.jobId,f=l.errorType,R=Object(I.Gb)({category:u,job_id:_,error_type:f}),m.next=4,M.b.get("api/projects/".concat(O.a.values.currentTeamId,"/app_metrics/").concat(o.pluginConfigId,"/error_details?").concat(R));case 4:return U=m.sent,B=U.result,m.abrupt("return",B);case 7:case"end":return m.stop()}},i)}));function a(i){return e.apply(this,arguments)}return a}()}]}}),Object(E.selectors)(function(t){var n=t.values,o=t.actions;return{breadcrumbs:[function(e){return[e.pluginConfig,function(a,i){return i.pluginConfigId}]},function(e,a){var i;return[{name:"Apps",path:b.a.projectApps()},{name:e==null||(i=e.plugin_info)===null||i===void 0?void 0:i.name,path:b.a.appMetrics(a)}]}],shouldShowAppMetrics:[function(){return[V.a.selectors.hasAvailableFeature]},function(e){return e(z.e.APP_METRICS)}],defaultTab:[function(e){return[e.pluginConfig]},function(){var e;return(e=x.filter(function(a){return n.showTab(a)})[0])!==null&&e!==void 0?e:c.History}],currentTime:[function(){return[]},function(){return Date.now()}],defaultDateFrom:[function(e){return[e.pluginConfig,e.currentTime]},function(e,a){if(!(e!=null&&e.created_at))return h;var i=L.a.utc(e.created_at),l=Object(L.a)(a).diff(i,"days",!0);return l<=1?"-24h":l<=7?"-7d":h}],dateFrom:[function(e){return[e.selectedDateFrom,e.defaultDateFrom]},function(e,a){var i;return(i=e!=null?e:a)!==null&&i!==void 0?i:h}],showTab:[function(e){return[e.shouldShowAppMetrics]},function(e){return function(a){if(n.pluginConfigLoading||!n.pluginConfig||!n.pluginConfig.plugin_info.capabilities)return!1;var i=n.pluginConfig.plugin_info.capabilities,l=i.methods.includes("exportEvents");return a===c.History?!0:e?a===c.HistoricalExports?l:a===c.OnEvent&&l?!1:a===c.ScheduledTask?!l&&["runEveryMinute","runEveryHour","runEveryDay"].some(function(u){return i.scheduled_tasks.includes(u)}):i.methods.includes(a):!1}}],interfaceJobsProps:[function(e){return[e.pluginConfig]},function(e){return!e||!e.plugin_info.public_jobs||!(e!=null&&e.enabled)?null:{jobName:C.b,jobSpec:e.plugin_info.public_jobs[C.b],pluginConfigId:e.id,pluginId:e.plugin,onSubmit:o.loadHistoricalExports}}],hasRunningExports:[function(e){return[e.historicalExports]},function(e){return e.some(function(a){return a.status=="not_finished"})}]}}),Object(E.listeners)(function(t){var n=t.values,o=t.actions;return{loadPluginConfigSuccess:function(){n.activeTab||o.setActiveTab(n.defaultTab)},setActiveTab:function(a){var i=a.tab;i===c.HistoricalExports?o.loadHistoricalExports():i!==c.History&&o.loadMetrics()},setDateFrom:function(){o.loadMetrics()},openHistoricalExportModal:function(){n.interfaceJobsProps&&Object(Q.a)(n.interfaceJobsProps).actions.setIsJobModalOpen(!0)}}}),Object(D.actionToUrl)(function(t){var n=t.values,o=t.props;return{setActiveTab:function(){return g(n,o)},setDateFrom:function(){return g(n,o)},openErrorDetailsModal:function(){return g(n,o)},closeErrorDetailsModal:function(){return g(n,o)}}}),Object(D.urlToAction)(function(t){var n=t.values,o=t.actions,e=t.props;return{"/app/:pluginConfigId/:page":function(i,l){if(e.pluginConfigId===Number(i.pluginConfigId))if(n.pluginConfig||o.loadPluginConfig(),i.page===c.HistoricalExports)o.setActiveTab(c.HistoricalExports);else if(i.page===c.History)o.setActiveTab(c.History);else if(l.tab&&x.includes(l.tab)&&l.tab!==n.activeTab?o.setActiveTab(l.tab):!n.pluginConfigLoading&&n.activeTab!==n.defaultTab&&o.setActiveTab(n.defaultTab),l.from&&n.selectedDateFrom!==l.from&&o.setDateFrom(l.from),l.error){var u=p()(l.error,2),_=u[0],f=u[1];n.errorDetailsModalError!==_&&(o.setActiveTab(f),o.openErrorDetailsModal(_,f))}else o.closeErrorDetailsModal()}}})]);function g(t,n){if(t.activeTab===c.HistoricalExports)return b.a.appHistoricalExports(n.pluginConfigId);if(t.activeTab===c.History)return b.a.appHistory(n.pluginConfigId,D.router.values.searchParams);var o={};return t.activeTab&&t.activeTab!==t.defaultTab&&(o.tab=t.activeTab),t.selectedDateFrom&&(o.from=t.selectedDateFrom),t.errorDetailsModalError&&t.activeTab&&(o.error=[t.errorDetailsModalError,t.activeTab]),b.a.appMetrics(n.pluginConfigId,o)}},"./frontend/src/scenes/apps/constants.tsx":function(K,j,r){"use strict";r.r(j),r.d(j,"DescriptionColumns",function(){return P});var T=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),p=r.n(T),v=r("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),s=r("./node_modules/react/jsx-runtime.js"),y=r.n(s),d,P=(d={},p()(d,v.AppMetricsTab.ProcessEvent,{successes:"Events processed",successes_tooltip:Object(s.jsxs)(s.Fragment,{children:["These events were successfully processed and transformed by the ",Object(s.jsx)("i",{children:"processEvent"})," app method."]}),failures:"Failed events",failures_tooltip:Object(s.jsxs)(s.Fragment,{children:["These events had errors when being processed by the ",Object(s.jsx)("i",{children:"processEvent"})," app method, but were still ingested."]})}),p()(d,v.AppMetricsTab.OnEvent,{successes:"Events processed",successes_tooltip:Object(s.jsxs)(s.Fragment,{children:["These events were successfully processed by the ",Object(s.jsx)("i",{children:"onEvent"})," app method on the first try."]}),successes_on_retry:"Events processed on retry",successes_on_retry_tooltip:Object(s.jsxs)(s.Fragment,{children:["These events were successfully processed by the ",Object(s.jsx)("i",{children:"onEvent"})," app method after being retried."]}),failures:"Failed events",failures_tooltip:Object(s.jsxs)(s.Fragment,{children:["These events had errors when being processed by the ",Object(s.jsx)("i",{children:"onEvent"})," app method."]})}),p()(d,v.AppMetricsTab.ExportEvents,{successes:"Events delivered",successes_tooltip:Object(s.jsx)(s.Fragment,{children:"These events were successfully delivered to the configured destination on the first try."}),successes_on_retry:"Events delivered on retry",successes_on_retry_tooltip:Object(s.jsx)(s.Fragment,{children:"These events were successfully delivered to the configured destination after being retried."}),failures:"Failed events",failures_tooltip:Object(s.jsx)(s.Fragment,{children:"These events failed to be delivered to the configured destination due to errors."})}),p()(d,v.AppMetricsTab.HistoricalExports,{successes:"Events delivered",successes_tooltip:Object(s.jsx)(s.Fragment,{children:"These events were successfully delivered to the configured destination on the first try."}),successes_on_retry:"Events delivered on retry",successes_on_retry_tooltip:Object(s.jsx)(s.Fragment,{children:"These events were successfully delivered to the configured destination after being retried."}),failures:"Failed events",failures_tooltip:Object(s.jsx)(s.Fragment,{children:"These events failed to be delivered to the configured destination due to errors."})}),p()(d,v.AppMetricsTab.ScheduledTask,{successes:"Successes",successes_tooltip:Object(s.jsxs)(s.Fragment,{children:["How many times ",Object(s.jsx)("i",{children:"runEveryMinute"}),", ",Object(s.jsx)("i",{children:"runEveryHour"})," or ",Object(s.jsx)("i",{children:"runEveryDay"})," was called successfully."]}),failures:"Failures",failures_tooltip:Object(s.jsxs)(s.Fragment,{children:["How many times ",Object(s.jsx)("i",{children:"runEveryMinute"}),", ",Object(s.jsx)("i",{children:"runEveryHour"})," or ",Object(s.jsx)("i",{children:"runEveryDay"})," failed due to errors."]})}),d)}}]);
