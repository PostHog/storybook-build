(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{5723:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createdAtColumn})),__webpack_require__.d(__webpack_exports__,"b",(function(){return createdByColumn}));__webpack_require__(36);var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),lib_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(12),kea__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2),scenes_userLogic__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(73),_TimezoneAware__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(602),lib_components_Table_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(866);function createdAtColumn(){return{title:Object(lib_components_Table_utils__WEBPACK_IMPORTED_MODULE_6__.a)("Created"),render:function RenderCreatedAt(_,item){return item.created_at&&react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{style:{whiteSpace:"nowrap"}},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_TimezoneAware__WEBPACK_IMPORTED_MODULE_5__.b,{time:item.created_at}))},sorter:function sorter(a,b){return new Date(a.created_at)>new Date(b.created_at)?1:-1}}}function createdByColumn(items){var user=Object(kea__WEBPACK_IMPORTED_MODULE_3__.useValues)(scenes_userLogic__WEBPACK_IMPORTED_MODULE_4__.a).user;return{title:Object(lib_components_Table_utils__WEBPACK_IMPORTED_MODULE_6__.a)("Created by"),render:function Render(_,item){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{style:{maxWidth:250,width:"auto"}},item.created_by?item.created_by.first_name||item.created_by.email:"-")},filters:Object(lib_utils__WEBPACK_IMPORTED_MODULE_2__.rb)(items.map((function(item){var _item$created_by,_item$created_by2,_item$created_by3;return item.created_by?{text:(null===(_item$created_by=item.created_by)||void 0===_item$created_by?void 0:_item$created_by.first_name)||(null===(_item$created_by2=item.created_by)||void 0===_item$created_by2?void 0:_item$created_by2.email),value:null===(_item$created_by3=item.created_by)||void 0===_item$created_by3?void 0:_item$created_by3.uuid}:{text:"(none)",value:null}})),(function(item){return null==item?void 0:item.value})).sort((function(a,b){return a.value===(null==user?void 0:user.uuid)?-10:b.value===(null==user?void 0:user.uuid)?10:(a.text+"").localeCompare(b.text+"")})),onFilter:function onFilter(value,item){var _item$created_by4;return null===value&&null===item.created_by||(null===(_item$created_by4=item.created_by)||void 0===_item$created_by4?void 0:_item$created_by4.uuid)===value},sorter:function sorter(a,b){var _a$created_by,_a$created_by2,_b$created_by,_b$created_by2;return((null===(_a$created_by=a.created_by)||void 0===_a$created_by?void 0:_a$created_by.first_name)||(null===(_a$created_by2=a.created_by)||void 0===_a$created_by2?void 0:_a$created_by2.email)||"").localeCompare((null===(_b$created_by=b.created_by)||void 0===_b$created_by?void 0:_b$created_by.first_name)||(null===(_b$created_by2=b.created_by)||void 0===_b$created_by2?void 0:_b$created_by2.email)||"")}}}try{createdByColumn.displayName="createdByColumn",createdByColumn.__docgenInfo={description:"",displayName:"createdByColumn",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Table/Table.tsx#createdByColumn"]={docgenInfo:createdByColumn.__docgenInfo,name:"createdByColumn",path:"frontend/src/lib/components/Table/Table.tsx#createdByColumn"})}catch(__react_docgen_typescript_loader_error){}},5740:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return dashboardsLogic}));__webpack_require__(62),__webpack_require__(1185),__webpack_require__(1186),__webpack_require__(65);var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__),kea__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_models_dashboardsModel__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(91),kea_router__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(21),lib_utils__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(12),scenes_urls__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(32),dashboardsLogic=Object(kea__WEBPACK_IMPORTED_MODULE_5__.kea)({actions:{addNewDashboard:!0,setNewDashboardDrawer:function setNewDashboardDrawer(shown){return{shown:shown}}},reducers:{newDashboardDrawer:[!1,{setNewDashboardDrawer:function setNewDashboardDrawer(_,_ref){return _ref.shown}}]},selectors:{dashboards:[function(){return[_models_dashboardsModel__WEBPACK_IMPORTED_MODULE_6__.a.selectors.nameSortedDashboards]},function(dashboards){return dashboards.filter((function(d){return!d.deleted})).sort((function(a,b){var _a$name,_b$name;return(null!==(_a$name=a.name)&&void 0!==_a$name?_a$name:"Untitled").localeCompare(null!==(_b$name=b.name)&&void 0!==_b$name?_b$name:"Untitled")}))}],dashboardTags:[function(){return[_models_dashboardsModel__WEBPACK_IMPORTED_MODULE_6__.a.selectors.nameSortedDashboards]},function(dashboards){return Object(lib_utils__WEBPACK_IMPORTED_MODULE_8__.rb)(dashboards.flatMap((function(_ref2){return _ref2.tags})),(function(item){return item})).sort()}]},listeners:function listeners(){return _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4___default()({},_models_dashboardsModel__WEBPACK_IMPORTED_MODULE_6__.a.actionTypes.addDashboardSuccess,(function(_ref3){var dashboard=_ref3.dashboard;kea_router__WEBPACK_IMPORTED_MODULE_7__.router.actions.push(scenes_urls__WEBPACK_IMPORTED_MODULE_9__.a.dashboard(dashboard.id))}))},urlToAction:function urlToAction(_ref5){var actions=_ref5.actions;return{"/dashboard":function dashboard(_,_ref6){void 0!==_ref6.new&&actions.setNewDashboardDrawer(!0)}}},path:function path(){return["scenes","dashboard","dashboardsLogic"]}})},5895:function(module,__webpack_exports__,__webpack_require__){"use strict";var react=__webpack_require__(0),asn_PushpinOutlined={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M878.3 392.1L631.9 145.7c-6.5-6.5-15-9.7-23.5-9.7s-17 3.2-23.5 9.7L423.8 306.9c-12.2-1.4-24.5-2-36.8-2-73.2 0-146.4 24.1-206.5 72.3a33.23 33.23 0 00-2.7 49.4l181.7 181.7-215.4 215.2a15.8 15.8 0 00-4.6 9.8l-3.4 37.2c-.9 9.4 6.6 17.4 15.9 17.4.5 0 1 0 1.5-.1l37.2-3.4c3.7-.3 7.2-2 9.8-4.6l215.4-215.4 181.7 181.7c6.5 6.5 15 9.7 23.5 9.7 9.7 0 19.3-4.2 25.9-12.4 56.3-70.3 79.7-158.3 70.2-243.4l161.1-161.1c12.9-12.8 12.9-33.8 0-46.8zM666.2 549.3l-24.5 24.5 3.8 34.4a259.92 259.92 0 01-30.4 153.9L262 408.8c12.9-7.1 26.3-13.1 40.3-17.9 27.2-9.4 55.7-14.1 84.7-14.1 9.6 0 19.3.5 28.9 1.6l34.4 3.8 24.5-24.5L608.5 224 800 415.5 666.2 549.3z"}}]},name:"pushpin",theme:"outlined"},AntdIcon=__webpack_require__(17),icons_PushpinOutlined_PushpinOutlined=function PushpinOutlined(props,ref){return react.createElement(AntdIcon.a,Object.assign({},props,{ref:ref,icon:asn_PushpinOutlined}))};icons_PushpinOutlined_PushpinOutlined.displayName="PushpinOutlined";__webpack_exports__.a=react.forwardRef(icons_PushpinOutlined_PushpinOutlined)},6113:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene})),__webpack_require__.d(__webpack_exports__,"Dashboards",(function(){return Dashboards}));__webpack_require__(62),__webpack_require__(95),__webpack_require__(36),__webpack_require__(65),__webpack_require__(37),__webpack_require__(117),__webpack_require__(115);var slicedToArray=__webpack_require__(15),slicedToArray_default=__webpack_require__.n(slicedToArray),react=__webpack_require__(0),react_default=__webpack_require__.n(react),index_esm=__webpack_require__(2),dashboardsModel=__webpack_require__(91),es_button=__webpack_require__(109),drawer=__webpack_require__(5596),card=__webpack_require__(5630),spin=__webpack_require__(596),table=__webpack_require__(2611),row=__webpack_require__(354),col=__webpack_require__(232),dashboardsLogic=__webpack_require__(5740),Link=__webpack_require__(60),PushpinFilled=__webpack_require__(5642),PushpinOutlined=__webpack_require__(5895),DeleteOutlined=__webpack_require__(5610),CopyOutlined=__webpack_require__(865),PlusOutlined=__webpack_require__(1787),asn_AppstoreAddOutlined={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zm52 132H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200zM424 712H296V584c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v128H104c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h128v128c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V776h128c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}}]},name:"appstore-add",theme:"outlined"},AntdIcon=__webpack_require__(17),icons_AppstoreAddOutlined_AppstoreAddOutlined=function AppstoreAddOutlined(props,ref){return react.createElement(AntdIcon.a,Object.assign({},props,{ref:ref,icon:asn_AppstoreAddOutlined}))};icons_AppstoreAddOutlined_AppstoreAddOutlined.displayName="AppstoreAddOutlined";var icons_AppstoreAddOutlined=react.forwardRef(icons_AppstoreAddOutlined_AppstoreAddOutlined),es_form=__webpack_require__(429),input=__webpack_require__(704),es_select=__webpack_require__(212),utils=__webpack_require__(12),SaveOutlined=__webpack_require__(5700);function NewDashboard(){var _Form$useForm=es_form.a.useForm(),form=slicedToArray_default()(_Form$useForm,1)[0],addDashboard=Object(index_esm.useActions)(dashboardsModel.a).addDashboard;return react_default.a.createElement(es_form.a,{layout:"vertical",form:form,onFinish:function onFinish(values){addDashboard(values)}},react_default.a.createElement(es_form.a.Item,{name:"name",label:"Dashboard name",rules:[{required:!0,message:"Please give your dashboard a name."}]},react_default.a.createElement(input.a,{autoFocus:!0,onChange:function onChange(e){return form.setFieldsValue({key:Object(utils.ib)(e.target.value)})},"data-attr":"dashboard-name-input",className:"ph-ignore-input"})),react_default.a.createElement(es_form.a.Item,{name:"useTemplate",label:"Start from"},react_default.a.createElement(es_select.a,{"data-attr":"copy-from-template",style:{width:"100%"}},react_default.a.createElement(es_select.a.Option,{"data-attr":"dashboard-select-empty",value:""},"Empty Dashboard"),react_default.a.createElement(es_select.a.Option,{"data-attr":"dashboard-select-default-app",value:"DEFAULT_APP"},"Default Dashboard - Web App"))),react_default.a.createElement("br",null),react_default.a.createElement(es_form.a.Item,null,react_default.a.createElement(es_button.a,{icon:react_default.a.createElement(SaveOutlined.a,null),htmlType:"submit",type:"primary","data-attr":"dashboard-submit"},"Create")))}var PageHeader=__webpack_require__(322),Table=__webpack_require__(5723),types=__webpack_require__(8),ObjectTags=__webpack_require__(867),userLogic=__webpack_require__(73),eventUsageLogic=__webpack_require__(41),urls=__webpack_require__(32),scene={component:Dashboards,logic:__webpack_require__(152).a};function Dashboards(){var _user$organization,dashboardsLoading=Object(index_esm.useValues)(dashboardsModel.a).dashboardsLoading,_useActions=Object(index_esm.useActions)(dashboardsModel.a),deleteDashboard=_useActions.deleteDashboard,unpinDashboard=_useActions.unpinDashboard,pinDashboard=_useActions.pinDashboard,addDashboard=_useActions.addDashboard,duplicateDashboard=_useActions.duplicateDashboard,setNewDashboardDrawer=Object(index_esm.useActions)(dashboardsLogic.a).setNewDashboardDrawer,_useValues2=Object(index_esm.useValues)(dashboardsLogic.a),dashboards=_useValues2.dashboards,newDashboardDrawer=_useValues2.newDashboardDrawer,dashboardTags=_useValues2.dashboardTags,_useValues3=Object(index_esm.useValues)(userLogic.a),user=_useValues3.user,hasAvailableFeature=_useValues3.hasAvailableFeature,_useState=Object(react.useState)([]),_useState2=slicedToArray_default()(_useState,2),displayedColumns=_useState2[0],setDisplayedColumns=_useState2[1],columns=[{title:"",width:24,align:"center",render:function Render(_ref){var id=_ref.id,pinned=_ref.pinned;return react_default.a.createElement("span",{onClick:function onClick(){return pinned?unpinDashboard(id,eventUsageLogic.a.DashboardsList):pinDashboard(id,eventUsageLogic.a.DashboardsList)},style:{color:"rgba(0, 0, 0, 0.85)",cursor:"pointer"}},pinned?react_default.a.createElement(PushpinFilled.a,null):react_default.a.createElement(PushpinOutlined.a,null))},sorter:{multiple:20,compare:function compare(a,b){var aAsInt=a.pinned?1:0,bAsInt=b.pinned?1:0;return aAsInt+bAsInt!==1?0:aAsInt<bAsInt?-1:1}},defaultSortOrder:"descend"},{title:"Dashboard",dataIndex:"name",key:"name",render:function Render(name,_ref2){var id=_ref2.id;return react_default.a.createElement(Link.a,{"data-attr":"dashboard-name",to:urls.a.dashboard(id)},name||"Untitled")},sorter:{multiple:10,compare:function compare(a,b){var _a$name,_b$name;return(null!==(_a$name=a.name)&&void 0!==_a$name?_a$name:"Untitled").localeCompare(null!==(_b$name=b.name)&&void 0!==_b$name?_b$name:"Untitled")}},defaultSortOrder:"ascend"},{title:"Description",dataIndex:"description",key:"description",render:function Render(description){return react_default.a.createElement(react_default.a.Fragment,null,description||react_default.a.createElement("span",{style:{color:"var(--muted)"}},"-"))}},{title:"Tags",dataIndex:"tags",key:"tags",render:function Render(tags){return tags.length?react_default.a.createElement(ObjectTags.a,{tags:tags,staticOnly:!0}):react_default.a.createElement("span",{style:{color:"var(--muted)"}},"-")},filters:dashboardTags.map((function(tag){return{text:tag,value:tag}})),onFilter:function onFilter(value,record){return"string"==typeof value&&record.tags.includes(value)}},Object(Table.a)(),Object(Table.b)(dashboards),{title:"Actions",align:"center",width:120,render:function RenderActions(_ref3){var id=_ref3.id,name=_ref3.name;return react_default.a.createElement("span",null,react_default.a.createElement("span",{title:"Delete",style:{cursor:"pointer"},onClick:function onClick(){return deleteDashboard({id:id,redirect:!1})},className:"text-danger"},react_default.a.createElement(DeleteOutlined.a,null)),react_default.a.createElement("span",{title:"Duplicate",style:{cursor:"pointer",marginLeft:8},onClick:function onClick(){return duplicateDashboard({id:id,name:name})}},react_default.a.createElement(CopyOutlined.a,null)))}}];return Object(react.useEffect)((function(){hasAvailableFeature(types.c.DASHBOARD_COLLABORATION)?setDisplayedColumns(columns):setDisplayedColumns(columns.filter((function(col){return!col.dataIndex||!["description","tags"].includes(col.dataIndex.toString())})))}),[null==user||null===(_user$organization=user.organization)||void 0===_user$organization?void 0:_user$organization.available_features,dashboardTags]),react_default.a.createElement("div",null,react_default.a.createElement(PageHeader.a,{title:"Dashboards"}),react_default.a.createElement("div",{className:"mb text-right"},react_default.a.createElement(es_button.a,{"data-attr":"new-dashboard",onClick:function onClick(){return setNewDashboardDrawer(!0)},type:"primary",icon:react_default.a.createElement(PlusOutlined.a,null)},"New Dashboard")),react_default.a.createElement(drawer.a,{title:"New Dashboard",width:400,onClose:function onClose(){return setNewDashboardDrawer(!1)},destroyOnClose:!0,visible:newDashboardDrawer},react_default.a.createElement(NewDashboard,null)),react_default.a.createElement(card.a,null,dashboardsLoading?react_default.a.createElement(spin.a,null):dashboards.length>0?react_default.a.createElement(table.a,{dataSource:dashboards,rowKey:"id",size:"small",pagination:{pageSize:100,hideOnSinglePage:!0},columns:displayedColumns}):react_default.a.createElement("div",null,react_default.a.createElement("p",null,"Create your first dashboard:"),react_default.a.createElement(row.a,{gutter:24},react_default.a.createElement(col.a,{xs:24,xl:6},react_default.a.createElement(card.a,{title:"Empty",size:"small",style:{cursor:"pointer"},onClick:function onClick(){return addDashboard({name:"New Dashboard",show:!0,useTemplate:""})}},react_default.a.createElement("div",{style:{textAlign:"center",fontSize:40}},react_default.a.createElement(icons_AppstoreAddOutlined,null)))),react_default.a.createElement(col.a,{xs:24,xl:6},react_default.a.createElement(card.a,{title:"App Default",size:"small",style:{cursor:"pointer"},onClick:function onClick(){return addDashboard({name:"Web App Dashboard",show:!0,useTemplate:"DEFAULT_APP"})}},react_default.a.createElement("div",{style:{textAlign:"center",fontSize:40}},react_default.a.createElement(icons_AppstoreAddOutlined,null))))))))}}}]);