(window.webpackJsonp=window.webpackJsonp||[]).push([[294],{"./frontend/src/scenes/cohorts/Cohorts.tsx":function(h,r,e){"use strict";e.r(r),e.d(r,"Cohorts",function(){return O}),e.d(r,"scene",function(){return Y});var g=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),I=e.n(g),re=e("./node_modules/core-js/modules/es.array.map.js"),ae=e("./node_modules/core-js/modules/es.regexp.exec.js"),le=e("./node_modules/core-js/modules/es.string.search.js"),ce=e("./node_modules/core-js/modules/es.function.name.js"),ie=e("./node_modules/core-js/modules/es.symbol.js"),de=e("./node_modules/core-js/modules/es.symbol.description.js"),x=e("./node_modules/react/index.js"),t=e.n(x),N=e("./node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),f=e("./frontend/src/models/cohortsModel.ts"),c=e("./node_modules/kea/lib/index.esm.js"),V=e("./frontend/src/lib/components/PageHeader.tsx"),P=e("./frontend/src/types.ts"),R=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),F=e.n(R),U=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/cohorts/Cohorts.scss"),y=e.n(U),v={};v.insert="head",v.singleton=!1;var me=F()(y.a,v),ue=y.a.locals||{},B=e("./node_modules/fuse.js/dist/fuse.esm.js"),E=e("./frontend/src/lib/components/LemonTable/columnUtils.tsx"),D=e("./frontend/src/lib/components/Tooltip.tsx"),M=e("./frontend/src/lib/components/Link.tsx"),W=e("./frontend/src/lib/dayjs.ts"),H=e("./frontend/src/lib/components/Spinner/Spinner.tsx"),i=e("./frontend/src/scenes/urls.ts"),z=e("./frontend/src/lib/components/LemonTable/index.ts"),J=e("./frontend/src/scenes/userLogic.ts"),K=e("./frontend/src/lib/components/LemonButton/More.tsx"),a=e("./frontend/src/lib/components/LemonButton/index.ts"),X=e("./frontend/src/lib/components/LemonDivider/index.ts"),d=e("./node_modules/kea-router/lib/index.js"),L=e("./frontend/@posthog/lemon-ui/src/index.ts"),$=e("./frontend/src/lib/logic/featureFlagLogic.ts"),G=e("./frontend/src/lib/constants.tsx"),Q=function(m,j){return new B.a(m,{keys:["name"],threshold:.3}).search(j).map(function(u){return u.item})};function O(){var p=Object(c.useValues)(f.a),m=p.cohorts,j=p.cohortsLoading,u=Object(c.useActions)(f.a),Z=u.deleteCohort,S=u.exportCohortPersons,w=Object(c.useValues)(J.a),k=w.hasAvailableFeature,q=Object(c.useValues)(d.router),_=q.searchParams,ee=Object(x.useState)(""),T=I()(ee,2),C=T[0],te=T[1],oe=Object(c.useValues)($.a),se=oe.featureFlags,b=se[G.h.ALLOW_CSV_EXPORT_COLUMN_CHOICE],ne=[{title:"Name",dataIndex:"name",className:"ph-no-capture",width:"30%",sorter:function(s,o){return(s.name||"").localeCompare(o.name||"")},render:function(s,o){var n=o.id,A=o.description;return t.a.createElement(t.a.Fragment,null,t.a.createElement(M.a,{to:Object(d.combineUrl)(i.a.cohort(n),_).url,className:"row-name"},s||"Untitled"),k(P.d.DASHBOARD_COLLABORATION)&&A&&t.a.createElement("span",{className:"row-description"},A))}},{title:"Users in cohort",align:"right",render:function(s,o){var n;return(n=o.count)===null||n===void 0?void 0:n.toLocaleString()},dataIndex:"count",sorter:function(s,o){return(s.count||0)-(o.count||0)}},Object(E.b)(),Object(E.a)(),{title:t.a.createElement("span",null,t.a.createElement(D.a,{title:"PostHog calculates what users belong to each cohort. This is then used when filtering on cohorts in the Trends page etc. Calculating happens every 15 minutes, or whenever a cohort is updated."},"Last calculated",t.a.createElement(N.a,{style:{marginLeft:6}}))),render:function(s,o){return o.is_static?t.a.createElement(t.a.Fragment,null,"N/A"):o.is_calculating?t.a.createElement("span",{className:"flex items-center"},"in progress ",t.a.createElement(H.a,{className:"ml-2"})):Object(W.a)(o.last_calculation).fromNow()}},{width:0,render:function(s,o){return t.a.createElement(K.a,{overlay:t.a.createElement(t.a.Fragment,null,t.a.createElement(a.a,{status:"stealth",to:i.a.cohort(o.id),fullWidth:!0},"Edit"),t.a.createElement(a.a,{status:"stealth",to:Object(d.combineUrl)(i.a.sessionRecordings(),{filters:{properties:[{key:"id",label:o.name,type:"cohort",value:o.id}]}}).url,fullWidth:!0},"View session recordings"),b&&t.a.createElement(a.a,{status:"stealth",onClick:function(){return S(o.id,["distinct_ids.0","id","name","properties.email"])},tooltip:"Export specific columns for users belonging to this cohort in CSV format. Includes distinct id, internal id, email, and name",fullWidth:!0},"Export important columns for users\xA0",t.a.createElement(L.LemonTag,{type:"warning",className:"uppercase"},"Beta")),t.a.createElement(a.a,{status:"stealth",onClick:function(){return S(o.id)},tooltip:"Export all users belonging to this cohort in CSV format.",fullWidth:!0},"Export ",b?" all columns for ":"","users"),t.a.createElement(X.a,null),t.a.createElement(a.a,{status:"danger",onClick:function(){return Z(o)},fullWidth:!0},"Delete cohort"))})}}];return t.a.createElement("div",null,t.a.createElement(V.a,{title:"Cohorts",caption:"Create lists of users who have something in common to use in analytics or feature flags."}),t.a.createElement("div",{className:"flex justify-between items-center mb-4 gap-2"},t.a.createElement(L.LemonInput,{type:"search",placeholder:"Search for cohorts",onChange:te,value:C}),t.a.createElement(a.a,{type:"primary","data-attr":"create-cohort",onClick:function(){return d.router.actions.push(i.a.cohort("new"))}},"New Cohort")),t.a.createElement(z.a,{columns:ne,loading:j,rowKey:"id",pagination:{pageSize:100},dataSource:C?Q(m,C):m,nouns:["cohort","cohorts"],"data-attr":"cohorts-table"}))}var Y={component:O,logic:f.a}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/cohorts/Cohorts.scss":function(h,r,e){var g=e("./node_modules/css-loader/dist/runtime/api.js");r=g(!1),r.push([h.i,".cohorts-drawer .ant-drawer-content-wrapper{max-width:850px!important;width:100%!important}.cohort-recalculating{background-color:var(--bg-mid);padding:.5rem 1rem;margin-top:1rem;border-radius:var(--radius)}.cohort-recalculating .ant-spin-spinning{margin-right:.375rem}.cohort-csv-dragger{height:155px!important;background-color:transparent!important;margin-top:1rem;border:2px dashed var(--primary)!important;border-radius:4px!important}.cohort-csv-dragger:hover{border-color:var(--primary-light)!important}.cohort-csv-dragger .ant-upload-drag-container{display:flex!important;justify-content:center;flex-direction:column;align-items:center;height:100%;padding:0 1rem}.cohort-csv-dragger .ant-upload-drag-container .ant-upload-text{font-weight:600;font-size:1rem!important;margin:8px 0 0!important}",""]),h.exports=r}}]);
