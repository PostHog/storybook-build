(window.webpackJsonp=window.webpackJsonp||[]).push([[6,8,12],{"./frontend/src/scenes/apps/HistoricalExport.tsx":function(K,d,e){"use strict";e.r(d),e.d(d,"HistoricalExport",function(){return i});var u=e("./node_modules/antd/es/card/index.js"),f=e("./node_modules/kea/lib/index.esm.js"),v=e("./frontend/src/scenes/apps/AppMetricsGraph.tsx"),j=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),L=e("./frontend/src/scenes/apps/historicalExportLogic.ts"),b=e("./frontend/src/scenes/apps/MetricsTab.tsx"),t=e("./node_modules/react/jsx-runtime.js"),U=e.n(t);function i(I){var m,g,n,O,M,T=Object(f.useValues)(Object(L.historicalExportLogic)(I)),s=T.data,P=T.dataLoading;return Object(t.jsxs)("div",{className:"mt-4 mb-4 mr-8",children:[Object(t.jsx)(u.a,{title:"Overview",children:Object(t.jsx)(b.MetricsOverview,{tab:j.AppMetricsTab.HistoricalExports,metrics:(m=s==null?void 0:s.metrics)!==null&&m!==void 0?m:null,metricsLoading:P,exportDuration:s==null||(g=s.summary)===null||g===void 0?void 0:g.duration,exportFailureReason:s==null||(n=s.summary)===null||n===void 0?void 0:n.failure_reason})}),Object(t.jsx)(u.a,{title:"Delivery trends",className:"mt-4",children:Object(t.jsx)(v.AppMetricsGraph,{tab:j.AppMetricsTab.HistoricalExports,metrics:(O=s==null?void 0:s.metrics)!==null&&O!==void 0?O:null,metricsLoading:P})}),Object(t.jsx)(u.a,{title:"Errors",className:"mt-4",children:Object(t.jsx)(b.ErrorsOverview,{errors:(s==null?void 0:s.errors)||[],loading:P,category:"exportEvents",jobId:s==null||(M=s.summary)===null||M===void 0?void 0:M.job_id})})]})}try{i.displayName="HistoricalExport",i.__docgenInfo={description:"",displayName:"HistoricalExport",props:{pluginConfigId:{defaultValue:null,description:"",name:"pluginConfigId",required:!0,type:{name:"number"}},jobId:{defaultValue:null,description:"",name:"jobId",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/apps/HistoricalExport.tsx#HistoricalExport"]={docgenInfo:i.__docgenInfo,name:"HistoricalExport",path:"frontend/src/scenes/apps/HistoricalExport.tsx#HistoricalExport"})}catch(I){}},"./frontend/src/scenes/apps/HistoricalExportsTab.tsx":function(K,d,e){"use strict";e.r(d),e.d(d,"HistoricalExportsTab",function(){return Y});var u=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),f=e.n(u),v=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),j=e.n(v),L=e("./node_modules/core-js/modules/es.array.concat.js"),b=e.n(L),t=e("./node_modules/core-js/modules/es.object.keys.js"),U=e.n(t),i=e("./node_modules/core-js/modules/es.symbol.js"),I=e.n(i),m=e("./node_modules/core-js/modules/es.array.filter.js"),g=e.n(m),n=e("./node_modules/core-js/modules/es.object.to-string.js"),O=e.n(n),M=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),T=e.n(M),s=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),P=e.n(s),E=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),p=e.n(E),D=e("./node_modules/kea/lib/index.esm.js"),C=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),R=e("./frontend/src/lib/components/LemonTable/index.ts"),W=e("./frontend/src/scenes/apps/HistoricalExport.tsx"),c=e("./frontend/src/lib/components/LemonTable/columnUtils.tsx"),h=e("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),G=e("./node_modules/antd/es/progress/index.js"),J=e("./frontend/src/lib/components/LemonButton/index.ts"),V=e("./frontend/src/scenes/plugins/edit/interface-jobs/PluginJobConfiguration.tsx"),a=e("./node_modules/react/jsx-runtime.js"),X=e.n(a);function S(o,l){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);l&&(r=r.filter(function(x){return Object.getOwnPropertyDescriptor(o,x).enumerable})),_.push.apply(_,r)}return _}function F(o){for(var l=1;l<arguments.length;l++){var _=arguments[l]!=null?arguments[l]:{};l%2?S(Object(_),!0).forEach(function(r){f()(o,r,_[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):S(Object(_)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(_,r))})}return o}function Y(){var o=Object(D.useValues)(C.appMetricsSceneLogic),l=o.historicalExports,_=o.historicalExportsLoading,r=o.pluginConfig,x=o.interfaceJobsProps,z=Object(D.useActions)(C.appMetricsSceneLogic),Q=z.openHistoricalExportModal;return Object(a.jsxs)("div",{className:"space-y-2",children:[Object(a.jsx)("div",{className:"flex items-center justify-end",children:Object(a.jsx)(J.a,{type:"primary",onClick:Q,disabled:!x,children:"Start new export"})}),Object(a.jsx)(R.a,{dataSource:l,loading:_,columns:[{title:"Dates exported",render:function(y,A){var N=j()(A.payload.dateRange,2),B=N[0],$=N[1];return B===$?B:"".concat(B," - ").concat($)}},{title:"Progress",width:130,render:function(y,A){switch(A.status){case"success":return Object(a.jsx)(h.a,{type:"success",className:"uppercase",children:"Success"});case"fail":return Object(a.jsx)(h.a,{type:"danger",className:"uppercase",children:"Failed"});case"not_finished":return Object(a.jsx)(G.a,{percent:Math.floor((A.progress||0)*100)})}},align:"right"},Object(c.b)(),Object(c.a)()],expandable:{expandedRowRender:function(y){if(!!r)return Object(a.jsx)(W.HistoricalExport,{pluginConfigId:r.id,jobId:y.job_id})}},useURLForSorting:!1,noSortingCancellation:!0}),x&&Object(a.jsx)(V.d,F({},x))]})}},"./frontend/src/scenes/apps/historicalExportLogic.ts":function(K,d,e){"use strict";e.r(d),e.d(d,"historicalExportLogic",function(){return P});var u=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),f=e.n(u),v=e("./node_modules/@babel/runtime/regenerator/index.js"),j=e.n(v),L=e("./node_modules/core-js/modules/es.array.concat.js"),b=e.n(L),t=e("./node_modules/core-js/modules/es.array.iterator.js"),U=e.n(t),i=e("./node_modules/core-js/modules/es.object.to-string.js"),I=e.n(i),m=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),g=e.n(m),n=e("./node_modules/kea/lib/index.esm.js"),O=e("./node_modules/kea-loaders/lib/index.js"),M=e.n(O),T=e("./frontend/src/lib/api.ts"),s=e("./frontend/src/scenes/teamLogic.tsx"),P=Object(n.kea)([Object(n.path)(["scenes","apps","historicalExportLogic"]),Object(n.props)({}),Object(n.key)(function(E){var p=E.pluginConfigId,D=E.jobId;return"".concat(p,"_").concat(D)}),Object(O.loaders)(function(E){var p=E.props;return{data:[null,{loadExportData:function(){var D=f()(j.a.mark(function R(){return j.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,T.b.get("api/projects/".concat(s.a.values.currentTeamId,"/app_metrics/").concat(p.pluginConfigId,"/historical_exports/").concat(p.jobId));case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},R)}));function C(){return D.apply(this,arguments)}return C}()}]}}),Object(n.events)(function(E){var p=E.actions;return{afterMount:p.loadExportData}})])}}]);
