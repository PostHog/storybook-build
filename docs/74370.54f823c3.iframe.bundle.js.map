{"version":3,"file":"74370.54f823c3.iframe.bundle.js","mappings":";AA6DA","sources":["webpack://@posthog/storybook/../../frontend/src/scenes/persons/PersonsScene.tsx"],"sourcesContent":["import { useActions, useAsyncActions, useValues } from 'kea'\n\nimport { IconEllipsis } from '@posthog/icons'\nimport { LemonButton, LemonDialog, LemonInput, LemonMenu } from '@posthog/lemon-ui'\n\nimport { LemonField } from 'lib/lemon-ui/LemonField'\nimport { Link } from 'lib/lemon-ui/Link'\nimport { PersonsManagementSceneTabs } from 'scenes/persons-management/PersonsManagementSceneTabs'\nimport { Scene, SceneExport } from 'scenes/sceneTypes'\nimport { sceneConfigurations } from 'scenes/scenes'\nimport { teamLogic } from 'scenes/teamLogic'\nimport { urls } from 'scenes/urls'\n\nimport { SceneContent } from '~/layout/scenes/components/SceneContent'\nimport { SceneDivider } from '~/layout/scenes/components/SceneDivider'\nimport { SceneTitleSection } from '~/layout/scenes/components/SceneTitleSection'\nimport { Query } from '~/queries/Query/Query'\nimport { OnboardingStepKey, ProductKey } from '~/types'\n\nimport { personsSceneLogic } from './personsSceneLogic'\n\nexport const scene: SceneExport = {\n    component: PersonsScene,\n    logic: personsSceneLogic,\n}\n\nexport function PersonsScene({ tabId }: { tabId?: string } = {}): JSX.Element {\n    if (!tabId) {\n        // TODO: sometimes when opening a property filter on a scene, the tabId is suddently empty.\n        // If I remove the \"{closable && !disabledReason && ...}\" block from within\n        // \"frontend/src/lib/components/PropertyFilters/components/PropertyFilterButton.tsx\"\n        // ... then the issue goes away. We should still figure out why this happens.\n        // Throwing seems to make it go away.\n        throw new Error('PersonsScene rendered with no tabId')\n    }\n\n    const { query } = useValues(personsSceneLogic)\n    const { setQuery } = useActions(personsSceneLogic)\n    const { resetDeletedDistinctId } = useAsyncActions(personsSceneLogic)\n    const { currentTeam } = useValues(teamLogic)\n\n    return (\n        <SceneContent>\n            <PersonsManagementSceneTabs tabKey=\"persons\" />\n\n            <SceneTitleSection\n                name={sceneConfigurations[Scene.Persons].name}\n                description={sceneConfigurations[Scene.Persons].description}\n                resourceType={{\n                    type: sceneConfigurations[Scene.Persons].iconType || 'default_icon_type',\n                }}\n                actions={\n                    <LemonMenu\n                        items={[\n                            {\n                                label: 'Reset a deleted person...',\n                                onClick: () =>\n                                    LemonDialog.openForm({\n                                        width: '30rem',\n                                        title: 'Reset deleted person',\n                                        description: `Once a person is deleted, the \"distinct_id\" associated with them can no longer be used. \n                                            You can use this tool to reset the \"distinct_id\" for a person so that new events associated with it will create a new Person profile.`,\n                                        initialValues: {\n                                            distinct_id: '',\n                                        },\n                                        content: (\n                                            <LemonField name=\"distinct_id\" label=\"Distinct ID to reset\">\n                                                <LemonInput type=\"text\" autoFocus />\n                                            </LemonField>\n                                        ),\n                                        errors: {\n                                            distinct_id: (distinct_id) =>\n                                                !distinct_id ? 'This is required' : undefined,\n                                        },\n                                        onSubmit: async ({ distinct_id }) => await resetDeletedDistinctId(distinct_id),\n                                    }),\n                            },\n                        ]}\n                    >\n                        <LemonButton aria-label=\"more\" icon={<IconEllipsis />} size=\"small\" />\n                    </LemonMenu>\n                }\n            />\n            <SceneDivider />\n\n            <Query\n                uniqueKey={`persons-query-${tabId}`}\n                attachTo={personsSceneLogic({ tabId })}\n                query={query}\n                setQuery={setQuery}\n                context={{\n                    refresh: 'blocking',\n                    emptyStateHeading: currentTeam?.ingested_event\n                        ? 'There are no matching persons for this query'\n                        : 'No persons exist because no events have been ingested',\n                    emptyStateDetail: currentTeam?.ingested_event ? (\n                        'Try changing the date range or property filters.'\n                    ) : (\n                        <>\n                            Go to the{' '}\n                            <Link\n                                to={urls.onboarding(ProductKey.PRODUCT_ANALYTICS, OnboardingStepKey.INSTALL)}\n                                data-attr=\"real_project_with_no_events-ingestion_link\"\n                            >\n                                onboarding wizard\n                            </Link>{' '}\n                            to get things moving\n                        </>\n                    ),\n                }}\n                dataAttr=\"persons-table\"\n            />\n        </SceneContent>\n    )\n}\n"],"names":[],"sourceRoot":""}