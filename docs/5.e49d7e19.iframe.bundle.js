(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"./frontend/src/scenes/plugins/edit/PluginDrawer.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return PluginDrawer}));var react=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),react_default=__webpack_require__.n(react),index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),pluginsLogic=__webpack_require__("./frontend/src/scenes/plugins/pluginsLogic.ts"),es_switch=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/switch/index.js"),es_form=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/form/index.js"),space=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/space/index.js"),popconfirm=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/popconfirm/index.js"),es_button=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/button/index.js"),tag=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/tag/index.js"),LockFilled=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/LockFilled.js"),DeleteOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/DeleteOutlined.js"),RollbackOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/RollbackOutlined.js"),GlobalOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/GlobalOutlined.js"),CodeOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/CodeOutlined.js"),userLogic=__webpack_require__("./frontend/src/scenes/userLogic.ts"),PluginImage=__webpack_require__("./frontend/src/scenes/plugins/plugin/PluginImage.tsx"),Drawer=__webpack_require__("./frontend/src/lib/components/Drawer.tsx"),LocalPluginTag=__webpack_require__("./frontend/src/scenes/plugins/plugin/LocalPluginTag.tsx"),utils=__webpack_require__("./frontend/src/scenes/plugins/utils.ts"),react_markdown=__webpack_require__("./node_modules/.pnpm/react-markdown@5.0.3_@types+react@16.14.34_react@16.14.0/node_modules/react-markdown/lib/react-markdown.js"),react_markdown_default=__webpack_require__.n(react_markdown),SourcePluginTag=__webpack_require__("./frontend/src/scenes/plugins/plugin/SourcePluginTag.tsx"),PluginSource=__webpack_require__("./frontend/src/scenes/plugins/source/PluginSource.tsx"),upload=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/upload/index.js"),UploadOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/UploadOutlined.js"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function UploadField(_ref){let{value:value,onChange:onChange}=_ref;return Object(jsx_runtime.jsx)(upload.a,{multiple:!1,fileList:null!=value&&value.size?[value]:[],beforeUpload:file=>(null==onChange||onChange(file),!1),onRemove:()=>(null==onChange||onChange(null),!1),className:"ph-ignore-input",children:Object(jsx_runtime.jsx)(es_button.a,{icon:Object(jsx_runtime.jsx)(UploadOutlined.a,{}),children:"Click to upload"})})}try{UploadField.displayName="UploadField",UploadField.__docgenInfo={description:"",displayName:"UploadField",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"UploadFile<any> | null"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((file?: UploadFile<any> | null) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/edit/UploadField.tsx#UploadField"]={docgenInfo:UploadField.__docgenInfo,name:"UploadField",path:"frontend/src/scenes/plugins/edit/UploadField.tsx#UploadField"})}catch(__react_docgen_typescript_loader_error){}var input=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/input/index.js"),es_select=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/select/index.js"),EditOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/EditOutlined.js"),es=__webpack_require__("./node_modules/.pnpm/@monaco-editor+react@4.4.6_monaco-editor@0.39.0_react-dom@16.14.0_react@16.14.0/node_modules/@monaco-editor/react/lib/es/index.js"),AutoSizer=__webpack_require__("./node_modules/.pnpm/react-virtualized@9.22.5_react-dom@16.14.0_react@16.14.0/node_modules/react-virtualized/dist/es/AutoSizer/index.js"),Spinner=__webpack_require__("./frontend/src/lib/lemon-ui/Spinner/index.ts");function JsonConfigField(props){return Object(jsx_runtime.jsx)(AutoSizer.a,{disableWidth:!0,className:"min-h-60",children:_ref=>{let{height:height}=_ref;return Object(jsx_runtime.jsx)(es.a,{theme:"vs-light",className:"border",language:"json",value:props.value,onChange:v=>props.onChange(null!=v?v:""),height:height,options:{minimap:{enabled:!1}},loading:Object(jsx_runtime.jsx)(Spinner.a,{})})}})}function PluginField(_ref2){let{value:value,onChange:onChange,fieldConfig:fieldConfig}=_ref2;const[editingSecret,setEditingSecret]=Object(react.useState)(!1);return!fieldConfig.secret||editingSecret||!value||value!==utils.a&&value.name!==utils.a?"attachment"===fieldConfig.type?Object(jsx_runtime.jsx)(UploadField,{value:value,onChange:onChange}):"string"===fieldConfig.type?Object(jsx_runtime.jsx)(input.a,{value:value,onChange:onChange,autoFocus:editingSecret,className:"ph-no-capture"}):"json"===fieldConfig.type?Object(jsx_runtime.jsx)(JsonConfigField,{value:value,onChange:onChange,autoFocus:editingSecret,className:"ph-no-capture"}):"choice"===fieldConfig.type?Object(jsx_runtime.jsx)(es_select.a,{dropdownMatchSelectWidth:!1,value:value,className:"ph-no-capture",onChange:onChange,showSearch:!0,children:fieldConfig.choices.map((choice=>Object(jsx_runtime.jsx)(es_select.a.Option,{value:choice,children:choice},choice)))}):Object(jsx_runtime.jsxs)("strong",{style:{color:"var(--danger)"},children:['Unknown field type "',Object(jsx_runtime.jsx)("code",{children:fieldConfig.type}),'".',Object(jsx_runtime.jsx)("br",{}),"You may need to upgrade PostHog!"]}):Object(jsx_runtime.jsxs)(es_button.a,{icon:Object(jsx_runtime.jsx)(EditOutlined.a,{}),onClick:()=>{onChange(fieldConfig.default||""),setEditingSecret(!0)},children:["Reset secret ","attachment"===fieldConfig.type?"attachment":"field"]})}try{PluginField.displayName="PluginField",PluginField.__docgenInfo={description:"",displayName:"PluginField",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"any"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: any) => void"}},fieldConfig:{defaultValue:null,description:"",name:"fieldConfig",required:!0,type:{name:"PluginConfigSchema"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/edit/PluginField.tsx#PluginField"]={docgenInfo:PluginField.__docgenInfo,name:"PluginField",path:"frontend/src/scenes/plugins/edit/PluginField.tsx#PluginField"})}catch(__react_docgen_typescript_loader_error){}var lib_utils=__webpack_require__("./frontend/src/lib/utils.tsx"),access=__webpack_require__("./frontend/src/scenes/plugins/access.ts"),preflightLogic=__webpack_require__("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx");const capabilitiesInfo={processEvent:"Read + modify access to events before ingestion",processEventBatch:"Read + modify access to events before ingestion, in batches",onEvent:"Read-only access to events",exportEvents:"Read-only access to events, optimized for export",runEveryMinute:"Runs a task every minute",runEveryHour:"Runs a task every hour",runEveryDay:"Runs a task every day"};var Tooltip=__webpack_require__("./frontend/src/lib/lemon-ui/Tooltip.tsx"),src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),Link=__webpack_require__("./frontend/src/lib/lemon-ui/Link/index.ts"),PluginJobConfiguration=__webpack_require__("./frontend/src/scenes/plugins/edit/interface-jobs/PluginJobConfiguration.tsx"),featureFlagLogic=__webpack_require__("./frontend/src/lib/logic/featureFlagLogic.ts"),constants=__webpack_require__("./frontend/src/lib/constants.tsx");function PluginJobOptions(_ref){let{pluginId:pluginId,pluginConfigId:pluginConfigId,capabilities:capabilities,publicJobs:publicJobs,onSubmit:onSubmit}=_ref;const{featureFlags:featureFlags}=Object(index_esm.useValues)(featureFlagLogic.a),jobs=Object(react.useMemo)((()=>((null==capabilities?void 0:capabilities.jobs)||[]).filter((jobName=>jobName in publicJobs)).filter((jobName=>(jobName!==PluginJobConfiguration.a||!featureFlags[constants.i.HISTORICAL_EXPORTS_V2])&&!(jobName===PluginJobConfiguration.b&&!featureFlags[constants.i.HISTORICAL_EXPORTS_V2])))),[capabilities,publicJobs,featureFlags]);return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsxs)("h3",{className:"l3 mt-8",children:["Jobs",Object(jsx_runtime.jsx)(src.LemonTag,{type:"warning",className:"uppercase",style:{verticalAlign:"0.125em",marginLeft:6},children:"BETA"})]}),jobs.map((jobName=>Object(jsx_runtime.jsx)("div",{children:jobName.includes("Export historical events")?Object(jsx_runtime.jsxs)("i",{children:["Currently unavailable, see"," ",Object(jsx_runtime.jsx)(Link.a,{to:"https://github.com/PostHog/posthog/issues/15997",children:"GitHub issue"})]}):Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("i",{children:jobName}),Object(jsx_runtime.jsx)(PluginJobConfiguration.c,{jobName:jobName,jobSpec:publicJobs[jobName],pluginConfigId:pluginConfigId,pluginId:pluginId,onSubmit:onSubmit})]})},jobName)))]})}try{PluginJobOptions.displayName="PluginJobOptions",PluginJobOptions.__docgenInfo={description:"",displayName:"PluginJobOptions",props:{pluginId:{defaultValue:null,description:"",name:"pluginId",required:!0,type:{name:"number"}},pluginConfigId:{defaultValue:null,description:"",name:"pluginConfigId",required:!0,type:{name:"number"}},capabilities:{defaultValue:null,description:"",name:"capabilities",required:!0,type:{name:'Record<"jobs" | "methods" | "scheduled_tasks", string[] | undefined>'}},publicJobs:{defaultValue:null,description:"",name:"publicJobs",required:!0,type:{name:"Record<string, JobSpec>"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/edit/interface-jobs/PluginJobOptions.tsx#PluginJobOptions"]={docgenInfo:PluginJobOptions.__docgenInfo,name:"PluginJobOptions",path:"frontend/src/scenes/plugins/edit/interface-jobs/PluginJobOptions.tsx#PluginJobOptions"})}catch(__react_docgen_typescript_loader_error){}function EnabledDisabledSwitch(_ref){let{value:value,onChange:onChange}=_ref;return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(es_switch.a,{checked:value,onChange:onChange}),Object(jsx_runtime.jsx)("strong",{className:"pl-2.5",children:value?"Enabled":"Disabled"})]})}window.process=constants.m;const SecretFieldIcon=()=>Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object(jsx_runtime.jsx)(Tooltip.a,{placement:"topLeft",title:"This is a secret write-only field. Its value is not available after saving.",children:Object(jsx_runtime.jsx)(LockFilled.a,{style:{marginRight:5}})})});function PluginDrawer(){var _editingPlugin$capabi,_editingPlugin$capabi2,_editingPlugin$capabi3,_editingPlugin$plugin;const{user:user}=Object(index_esm.useValues)(userLogic.a),{preflight:preflight}=Object(index_esm.useValues)(preflightLogic.a),{editingPlugin:editingPlugin,loading:loading,editingSource:editingSource,editingPluginInitialChanges:editingPluginInitialChanges}=Object(index_esm.useValues)(pluginsLogic.b),{editPlugin:editPlugin,savePluginConfig:savePluginConfig,uninstallPlugin:uninstallPlugin,setEditingSource:setEditingSource,generateApiKeysIfNeeded:generateApiKeysIfNeeded,patchPlugin:patchPlugin,showPluginLogs:showPluginLogs}=Object(index_esm.useActions)(pluginsLogic.b),[form]=es_form.a.useForm(),[invisibleFields,setInvisibleFields]=Object(react.useState)([]),[requiredFields,setRequiredFields]=Object(react.useState)([]);Object(react.useEffect)((()=>{editingPlugin?(form.setFieldsValue({...editingPlugin.pluginConfig.config||Object(utils.b)(editingPlugin),__enabled:editingPlugin.pluginConfig.enabled,...editingPluginInitialChanges}),generateApiKeysIfNeeded(form)):form.resetFields(),updateInvisibleAndRequiredFields()}),[null==editingPlugin?void 0:editingPlugin.id,null==editingPlugin?void 0:editingPlugin.config_schema]);const updateInvisibleAndRequiredFields=()=>{determineAndSetInvisibleFields(),determineAndSetRequiredFields()},determineAndSetInvisibleFields=()=>{const fieldsToSetAsInvisible=[];for(const field of Object.values(Object(utils.d)((null==editingPlugin?void 0:editingPlugin.config_schema)||{}))){if(!field.visible_if||!field.key)continue;field.visible_if.every((_ref2=>{let[targetFieldName,targetFieldValue]=_ref2;return Object(utils.c)(form,targetFieldName,targetFieldValue)}))||fieldsToSetAsInvisible.push(field.key)}setInvisibleFields(fieldsToSetAsInvisible)},determineAndSetRequiredFields=()=>{const fieldsToSetAsRequired=[];for(const field of Object.values(Object(utils.d)((null==editingPlugin?void 0:editingPlugin.config_schema)||{}))){if(!field.required_if||!Array.isArray(field.required_if)||!field.key)continue;field.required_if.every((_ref3=>{let[targetFieldName,targetFieldValue]=_ref3;return Object(utils.c)(form,targetFieldName,targetFieldValue)}))&&fieldsToSetAsRequired.push(field.key)}setRequiredFields(fieldsToSetAsRequired)},isValidField=fieldConfig=>"choice"!==fieldConfig.type||(fieldConfig=>Array.isArray(fieldConfig.choices)&&!!fieldConfig.choices.length&&!fieldConfig.choices.find((c=>"string"!=typeof c))&&!fieldConfig.secret)(fieldConfig);return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(Drawer.a,{forceRender:!0,visible:!!editingPlugin,onClose:()=>editPlugin(null),width:"min(90vw, 500px)",title:null==editingPlugin?void 0:editingPlugin.name,"data-attr":"plugin-drawer",footer:Object(jsx_runtime.jsxs)("div",{className:"flex",children:[Object(jsx_runtime.jsxs)(space.b,{style:{flexGrow:1},children:[editingPlugin&&!editingPlugin.is_global&&Object(access.c)(null==user?void 0:user.organization,editingPlugin.organization_id)&&Object(jsx_runtime.jsx)(popconfirm.a,{placement:"topLeft",title:"Are you sure you wish to uninstall this app completely?",onConfirm:()=>uninstallPlugin(editingPlugin.name),okText:"Uninstall",cancelText:"Cancel",className:"plugins-popconfirm",children:Object(jsx_runtime.jsx)(es_button.a,{style:{color:"var(--danger)",padding:4},type:"text",icon:Object(jsx_runtime.jsx)(DeleteOutlined.a,{}),"data-attr":"plugin-uninstall",children:"Uninstall"})}),(null==preflight?void 0:preflight.cloud)&&editingPlugin&&Object(access.b)(null==user?void 0:user.organization)&&(editingPlugin.is_global?Object(jsx_runtime.jsx)(Tooltip.a,{title:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["This app can currently be used by other organizations in this instance of PostHog. This action will ",Object(jsx_runtime.jsx)("b",{children:"disable and hide it"})," for all organizations other than yours."]}),children:Object(jsx_runtime.jsx)(es_button.a,{type:"text",icon:Object(jsx_runtime.jsx)(RollbackOutlined.a,{}),onClick:()=>patchPlugin(editingPlugin.id,{is_global:!1}),style:{padding:4},children:"Make local"})}):Object(jsx_runtime.jsx)(Tooltip.a,{title:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["This action will mark this app as installed for ",Object(jsx_runtime.jsx)("b",{children:"all organizations"})," ","in this instance of PostHog."]}),children:Object(jsx_runtime.jsx)(es_button.a,{type:"text",icon:Object(jsx_runtime.jsx)(GlobalOutlined.a,{}),onClick:()=>patchPlugin(editingPlugin.id,{is_global:!0}),style:{padding:4},children:"Make global"})}))]}),Object(jsx_runtime.jsxs)(space.b,{children:[Object(jsx_runtime.jsx)(es_button.a,{onClick:()=>editPlugin(null),"data-attr":"plugin-drawer-cancel",children:"Cancel"}),Object(jsx_runtime.jsx)(es_button.a,{type:"primary",loading:loading,onClick:form.submit,"data-attr":"plugin-drawer-save",children:"Save"})]})]}),children:Object(jsx_runtime.jsx)(es_form.a,{form:form,layout:"vertical",name:"basic",onFinish:savePluginConfig,children:editingPlugin?Object(jsx_runtime.jsxs)("div",{children:[Object(jsx_runtime.jsxs)("div",{className:"flex mb-4",children:[Object(jsx_runtime.jsx)(PluginImage.a,{pluginType:editingPlugin.plugin_type,url:editingPlugin.url,icon:editingPlugin.icon,size:"large"}),Object(jsx_runtime.jsxs)("div",{className:"grow pl-4",children:[Object(lib_utils.z)(editingPlugin.description),Object(jsx_runtime.jsxs)("div",{className:"mt-1.5",children:["local"===(null==editingPlugin?void 0:editingPlugin.plugin_type)&&editingPlugin.url?Object(jsx_runtime.jsx)(LocalPluginTag.a,{url:editingPlugin.url,title:"Installed Locally"}):"source"===editingPlugin.plugin_type?Object(jsx_runtime.jsx)(SourcePluginTag.a,{}):null,editingPlugin.url&&Object(jsx_runtime.jsx)("a",{href:editingPlugin.url,children:Object(jsx_runtime.jsx)("i",{children:"â¤· Learn more"})})]}),Object(jsx_runtime.jsx)("div",{className:"flex items-center mt-1.5",children:Object(jsx_runtime.jsx)(es_form.a.Item,{fieldKey:"__enabled",name:"__enabled",style:{display:"inline-block",marginBottom:0},"data-attr":"plugin-enabled-switch",children:Object(jsx_runtime.jsx)(EnabledDisabledSwitch,{})})})]})]}),"source"===editingPlugin.plugin_type&&Object(access.b)(null==user?void 0:user.organization)?Object(jsx_runtime.jsx)("div",{children:Object(jsx_runtime.jsx)(es_button.a,{type:editingSource?"default":"primary",icon:Object(jsx_runtime.jsx)(CodeOutlined.a,{}),onClick:()=>setEditingSource(!editingSource),"data-attr":"plugin-edit-source",children:"Edit source"})}):null,editingPlugin.capabilities&&Object.keys(editingPlugin.capabilities).length>0?Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("h3",{className:"l3 mt-8",children:"Capabilities"}),Object(jsx_runtime.jsxs)("div",{className:"mt-1.5",children:[[...editingPlugin.capabilities.methods||[],...editingPlugin.capabilities.scheduled_tasks||[]].filter((capability=>!["setupPlugin","teardownPlugin"].includes(capability))).map((capability=>Object(jsx_runtime.jsx)(Tooltip.a,{title:capabilitiesInfo[capability]||"",children:Object(jsx_runtime.jsx)(tag.a,{className:"plugin-capabilities-tag",children:capability})},capability))),((null===(_editingPlugin$capabi=editingPlugin.capabilities)||void 0===_editingPlugin$capabi?void 0:_editingPlugin$capabi.jobs)||[]).map((jobName=>Object(jsx_runtime.jsx)(Tooltip.a,{title:"Custom job",children:Object(jsx_runtime.jsx)(tag.a,{className:"plugin-capabilities-tag",children:jobName})},jobName)))]})]}):null,!!(editingPlugin.pluginConfig.id&&null!==(_editingPlugin$capabi2=editingPlugin.capabilities)&&void 0!==_editingPlugin$capabi2&&null!==(_editingPlugin$capabi3=_editingPlugin$capabi2.jobs)&&void 0!==_editingPlugin$capabi3&&_editingPlugin$capabi3.length&&editingPlugin.public_jobs&&Object.keys(editingPlugin.public_jobs).length)&&Object(jsx_runtime.jsx)(PluginJobOptions,{pluginId:editingPlugin.id,pluginConfigId:editingPlugin.pluginConfig.id,capabilities:editingPlugin.capabilities,publicJobs:editingPlugin.public_jobs,onSubmit:()=>showPluginLogs(editingPlugin.id)}),Object(jsx_runtime.jsx)("h3",{className:"l3 mt-8",children:"Configuration"}),0===Object(utils.d)(editingPlugin.config_schema).length?Object(jsx_runtime.jsx)("div",{children:"This app is not configurable."}):null,Object(utils.d)(editingPlugin.config_schema).map(((fieldConfig,index)=>Object(jsx_runtime.jsxs)(react_default.a.Fragment,{children:[fieldConfig.markdown&&Object(jsx_runtime.jsx)(react_markdown_default.a,{source:fieldConfig.markdown,linkTarget:"_blank"}),fieldConfig.type&&isValidField(fieldConfig)?Object(jsx_runtime.jsx)(es_form.a.Item,{hidden:!!fieldConfig.key&&invisibleFields.includes(fieldConfig.key),label:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[fieldConfig.secret&&Object(jsx_runtime.jsx)(SecretFieldIcon,{}),fieldConfig.name||fieldConfig.key]}),extra:fieldConfig.hint&&Object(jsx_runtime.jsxs)("small",{children:[Object(jsx_runtime.jsx)("div",{className:"h-0.5"}),Object(jsx_runtime.jsx)(react_markdown_default.a,{source:fieldConfig.hint,linkTarget:"_blank"})]}),name:fieldConfig.key,required:fieldConfig.required||!!fieldConfig.key&&requiredFields.includes(fieldConfig.key),rules:[{required:fieldConfig.required||!!fieldConfig.key&&requiredFields.includes(fieldConfig.key),message:"Please enter a value!"}],children:Object(jsx_runtime.jsx)(PluginField,{fieldConfig:fieldConfig,onChange:updateInvisibleAndRequiredFields})}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:fieldConfig.type?Object(jsx_runtime.jsxs)("p",{className:"text-danger",children:["Invalid config field ",Object(jsx_runtime.jsx)("i",{children:fieldConfig.name||fieldConfig.key}),"."]}):null})]},fieldConfig.key||`__key__${index}`)))]}):null})}),"source"===(null==editingPlugin?void 0:editingPlugin.plugin_type)&&editingPlugin.id?Object(jsx_runtime.jsx)(PluginSource.a,{visible:editingSource,close:()=>setEditingSource(!1),pluginId:editingPlugin.id,pluginConfigId:null===(_editingPlugin$plugin=editingPlugin.pluginConfig)||void 0===_editingPlugin$plugin?void 0:_editingPlugin$plugin.id}):null]})}},"./frontend/src/scenes/plugins/edit/interface-jobs/PluginJobConfiguration.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return HISTORICAL_EXPORT_JOB_NAME})),__webpack_require__.d(__webpack_exports__,"b",(function(){return HISTORICAL_EXPORT_JOB_NAME_V2})),__webpack_require__.d(__webpack_exports__,"c",(function(){return PluginJobConfiguration})),__webpack_require__.d(__webpack_exports__,"d",(function(){return PluginJobModal}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),_ant_design_icons__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/PlayCircleOutlined.js"),_ant_design_icons__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/SettingOutlined.js"),_ant_design_icons__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/CheckOutlined.js"),_ant_design_icons__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),antd__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/tooltip/index.js"),antd__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/input-number/index.js"),antd__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/radio/index.js"),kea_forms__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.5/node_modules/kea-forms/lib/index.js"),lib_forms_Field__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./frontend/src/lib/forms/Field.tsx"),_monaco_editor_react__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/.pnpm/@monaco-editor+react@4.4.6_monaco-editor@0.39.0_react-dom@16.14.0_react@16.14.0/node_modules/@monaco-editor/react/lib/es/index.js"),kea__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),scenes_userLogic__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./frontend/src/scenes/userLogic.ts"),_interfaceJobsLogic__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./frontend/src/scenes/plugins/edit/interface-jobs/interfaceJobsLogic.ts"),lib_lemon_ui_LemonInput_LemonInput__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./frontend/src/lib/lemon-ui/LemonInput/LemonInput.tsx"),lib_lemon_ui_LemonModal__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./frontend/src/lib/lemon-ui/LemonModal/index.ts"),lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/index.ts"),lib_lemon_ui_LemonCalendarRange_LemonCalendarRangeInline__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./frontend/src/lib/lemon-ui/LemonCalendarRange/LemonCalendarRangeInline.tsx"),lib_dayjs__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./frontend/src/lib/dayjs.ts"),lib_utils__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("./frontend/src/lib/utils.tsx"),lib_components_DatePicker__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("./frontend/src/lib/components/DatePicker.tsx"),lib_lemon_ui_Spinner__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("./frontend/src/lib/lemon-ui/Spinner/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");const HISTORICAL_EXPORT_JOB_NAME="Export historical events",HISTORICAL_EXPORT_JOB_NAME_V2="Export historical events V2";function PluginJobConfiguration(props){const{jobName:jobName,jobSpec:jobSpec,pluginConfigId:pluginConfigId,pluginId:pluginId}=props,{playButtonOnClick:playButtonOnClick}=Object(kea__WEBPACK_IMPORTED_MODULE_11__.useActions)(Object(_interfaceJobsLogic__WEBPACK_IMPORTED_MODULE_13__.a)(props)),{runJobAvailable:runJobAvailable}=Object(kea__WEBPACK_IMPORTED_MODULE_11__.useValues)(Object(_interfaceJobsLogic__WEBPACK_IMPORTED_MODULE_13__.a)(props)),jobHasEmptyPayload=0===Object.keys(jobSpec.payload||{}).length,configureOrRunJobTooltip=runJobAvailable?jobHasEmptyPayload?"Run job":"Configure and run job":"You already ran this job recently.";return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)("span",{className:"ml-1",onClick:()=>playButtonOnClick(jobHasEmptyPayload),children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(antd__WEBPACK_IMPORTED_MODULE_5__.a,{title:configureOrRunJobTooltip,children:jobHasEmptyPayload?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(_ant_design_icons__WEBPACK_IMPORTED_MODULE_1__.a,{className:runJobAvailable?"plugin-run-job-button":"plugin-run-job-button-disabled"}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(_ant_design_icons__WEBPACK_IMPORTED_MODULE_2__.a,{className:runJobAvailable?"plugin-run-job-button":"plugin-run-job-button-disabled"})})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(PluginJobModal,{jobName:jobName,jobSpec:jobSpec,pluginConfigId:pluginConfigId,pluginId:pluginId})]})}function PluginJobModal(props){const{jobName:jobName,jobSpec:jobSpec}=props,{setIsJobModalOpen:setIsJobModalOpen,submitJobPayload:submitJobPayload}=Object(kea__WEBPACK_IMPORTED_MODULE_11__.useActions)(Object(_interfaceJobsLogic__WEBPACK_IMPORTED_MODULE_13__.a)(props)),{isJobModalOpen:isJobModalOpen}=Object(kea__WEBPACK_IMPORTED_MODULE_11__.useValues)(Object(_interfaceJobsLogic__WEBPACK_IMPORTED_MODULE_13__.a)(props)),{user:user}=Object(kea__WEBPACK_IMPORTED_MODULE_11__.useValues)(scenes_userLogic__WEBPACK_IMPORTED_MODULE_12__.a),shownFields=Object(react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>Object.entries(jobSpec.payload||{}).filter((_ref=>{let[,options]=_ref;return!options.staff_only||(null==user?void 0:user.is_staff)||(null==user?void 0:user.is_impersonated)})).sort(((a,b)=>a[0].localeCompare(b[0])))),[jobSpec,user]);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(lib_lemon_ui_LemonModal__WEBPACK_IMPORTED_MODULE_15__.a,{isOpen:isJobModalOpen,onClose:()=>setIsJobModalOpen(!1),title:`Configuring job '${jobName}'`,footer:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_16__.a,{type:"secondary",className:"mr-2",onClick:()=>setIsJobModalOpen(!1),children:"Cancel"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_16__.a,{"data-attr":"run-job",type:"primary",onClick:()=>submitJobPayload(),children:"Run job now"})]}),children:shownFields.length>0?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(kea_forms__WEBPACK_IMPORTED_MODULE_8__.Form,{logic:_interfaceJobsLogic__WEBPACK_IMPORTED_MODULE_13__.a,props:props,formKey:"jobPayload",children:shownFields.map((_ref2=>{let[key,options]=_ref2;return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(lib_forms_Field__WEBPACK_IMPORTED_MODULE_9__.a,{name:key,label:options.title||key,className:"mb-4",children:props=>Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(FieldInput,{options:options,...props})},key)}))}):null})}function FieldInput(_ref3){let{options:options,value:value,onChange:onChange}=_ref3;switch(options.type){case"string":return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(lib_lemon_ui_LemonInput_LemonInput__WEBPACK_IMPORTED_MODULE_14__.a,{value:value||"",onChange:onChange});case"number":return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(antd__WEBPACK_IMPORTED_MODULE_6__.a,{value:value,onChange:onChange});case"json":return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(_monaco_editor_react__WEBPACK_IMPORTED_MODULE_10__.a,{theme:"vs-dark",options:{codeLens:!1,lineNumbers:"off"},className:"plugin-job-json-editor",language:"json",height:200,value:value,onChange:onChange,loading:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(lib_lemon_ui_Spinner__WEBPACK_IMPORTED_MODULE_21__.a,{})});case"boolean":return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsxs)(antd__WEBPACK_IMPORTED_MODULE_7__.a.Group,{id:"propertyValue",buttonStyle:"solid",value:value,onChange:e=>onChange(e.target.value),children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsxs)(antd__WEBPACK_IMPORTED_MODULE_7__.a.Button,{value:!0,defaultChecked:!0,children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(_ant_design_icons__WEBPACK_IMPORTED_MODULE_3__.a,{})," True"]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsxs)(antd__WEBPACK_IMPORTED_MODULE_7__.a.Button,{value:!1,children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(_ant_design_icons__WEBPACK_IMPORTED_MODULE_4__.a,{})," False"]})]});case"date":return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(lib_components_DatePicker__WEBPACK_IMPORTED_MODULE_20__.a,{popupStyle:{zIndex:1061},allowClear:!0,placeholder:"Choose a date",className:"retention-date-picker",suffixIcon:null,use12Hours:!0,showTime:!0,value:value?Object(lib_dayjs__WEBPACK_IMPORTED_MODULE_18__.a)(value):null,onChange:date=>onChange(null==date?void 0:date.toISOString())});case"daterange":return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsxs)("div",{className:"border rounded p-4",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)("div",{className:"pb-4",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)(lib_lemon_ui_LemonCalendarRange_LemonCalendarRangeInline__WEBPACK_IMPORTED_MODULE_17__.a,{value:value?[Object(lib_dayjs__WEBPACK_IMPORTED_MODULE_18__.a)(value[0]),Object(lib_dayjs__WEBPACK_IMPORTED_MODULE_18__.a)(value[1])]:null,onChange:_ref4=>{let[rangeStart,rangeEnd]=_ref4;return onChange([rangeStart.format("YYYY-MM-DD"),rangeEnd.format("YYYY-MM-DD")])}})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsxs)("div",{className:"border-t pt-4",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)("span",{className:"text-muted",children:"Selected period:"})," ",value?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)("span",{children:value[0]===value[1]?Object(lib_utils__WEBPACK_IMPORTED_MODULE_19__.E)(Object(lib_dayjs__WEBPACK_IMPORTED_MODULE_18__.a)(value[0])):Object(lib_utils__WEBPACK_IMPORTED_MODULE_19__.F)(Object(lib_dayjs__WEBPACK_IMPORTED_MODULE_18__.a)(value[0]),Object(lib_dayjs__WEBPACK_IMPORTED_MODULE_18__.a)(value[1]))}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_22__.jsx)("span",{className:"italic",children:"No period selected."})]})]})}}try{PluginJobConfiguration.displayName="PluginJobConfiguration",PluginJobConfiguration.__docgenInfo={description:"",displayName:"PluginJobConfiguration",props:{jobName:{defaultValue:null,description:"",name:"jobName",required:!0,type:{name:"string"}},jobSpec:{defaultValue:null,description:"",name:"jobSpec",required:!0,type:{name:"JobSpec"}},pluginConfigId:{defaultValue:null,description:"",name:"pluginConfigId",required:!0,type:{name:"number"}},pluginId:{defaultValue:null,description:"",name:"pluginId",required:!0,type:{name:"number"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/edit/interface-jobs/PluginJobConfiguration.tsx#PluginJobConfiguration"]={docgenInfo:PluginJobConfiguration.__docgenInfo,name:"PluginJobConfiguration",path:"frontend/src/scenes/plugins/edit/interface-jobs/PluginJobConfiguration.tsx#PluginJobConfiguration"})}catch(__react_docgen_typescript_loader_error){}try{PluginJobModal.displayName="PluginJobModal",PluginJobModal.__docgenInfo={description:"",displayName:"PluginJobModal",props:{jobName:{defaultValue:null,description:"",name:"jobName",required:!0,type:{name:"string"}},jobSpec:{defaultValue:null,description:"",name:"jobSpec",required:!0,type:{name:"JobSpec"}},pluginConfigId:{defaultValue:null,description:"",name:"pluginConfigId",required:!0,type:{name:"number"}},pluginId:{defaultValue:null,description:"",name:"pluginId",required:!0,type:{name:"number"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/edit/interface-jobs/PluginJobConfiguration.tsx#PluginJobModal"]={docgenInfo:PluginJobModal.__docgenInfo,name:"PluginJobModal",path:"frontend/src/scenes/plugins/edit/interface-jobs/PluginJobConfiguration.tsx#PluginJobModal"})}catch(__react_docgen_typescript_loader_error){}},"./frontend/src/scenes/plugins/edit/interface-jobs/interfaceJobsLogic.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return interfaceJobsLogic}));var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),kea_forms__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.5/node_modules/kea-forms/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/lib/api.ts"),lib_lemon_ui_lemonToast__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/lib/lemon-ui/lemonToast.tsx"),lib_utils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/lib/utils.tsx");const interfaceJobsLogic=Object(kea__WEBPACK_IMPORTED_MODULE_0__.kea)([Object(kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","plugins","edit","interface-jobs","interfaceJobsLogic"]),Object(kea__WEBPACK_IMPORTED_MODULE_0__.props)({}),Object(kea__WEBPACK_IMPORTED_MODULE_0__.key)((props=>`${props.pluginId}_${props.jobName}`)),Object(kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setIsJobModalOpen:isOpen=>({isOpen:isOpen}),setRunJobAvailable:isAvailable=>({isAvailable:isAvailable}),runJob:form=>({form:form}),playButtonOnClick:jobHasEmptyPayload=>({jobHasEmptyPayload:jobHasEmptyPayload}),setRunJobAvailableTimeout:timeout=>({timeout:timeout})}),Object(kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({isJobModalOpen:[!1,{setIsJobModalOpen:(_,_ref)=>{let{isOpen:isOpen}=_ref;return isOpen}}],runJobAvailable:[!0,{setRunJobAvailable:(_,_ref2)=>{let{isAvailable:isAvailable}=_ref2;return isAvailable}}],runJobAvailableTimeout:[null,{setRunJobAvailableTimeout:(_,_ref3)=>{let{timeout:timeout}=_ref3;return timeout}}]}),Object(kea__WEBPACK_IMPORTED_MODULE_0__.listeners)((_ref4=>{let{actions:actions,values:values}=_ref4;return{playButtonOnClick:_ref5=>{let{jobHasEmptyPayload:jobHasEmptyPayload}=_ref5;values.runJobAvailable&&(jobHasEmptyPayload?actions.submitJobPayload():actions.setIsJobModalOpen(!0))}}})),Object(kea_forms__WEBPACK_IMPORTED_MODULE_1__.forms)((_ref6=>{let{actions:actions,props:props,values:values}=_ref6;return{jobPayload:{defaults:Object.fromEntries(Object.entries(props.jobSpec.payload||{}).filter((_ref7=>{let[,spec]=_ref7;return"default"in spec})).map((_ref8=>{let[key,spec]=_ref8;return[key,spec.default]}))),errors:payload=>{const errors={};for(const key of Object.keys(props.jobSpec.payload||{})){var _props$jobSpec$payloa;const spec=null===(_props$jobSpec$payloa=props.jobSpec.payload)||void 0===_props$jobSpec$payloa?void 0:_props$jobSpec$payloa[key];null!=spec&&spec.required&&null==payload[key]?errors[key]="Please enter a value":"json"!=(null==spec?void 0:spec.type)||Object(lib_utils__WEBPACK_IMPORTED_MODULE_4__.Pb)(payload[key])||(errors[key]="Please enter valid JSON")}return errors},submit:async payload=>{var _props$onSubmit;actions.setIsJobModalOpen(!1);try{await lib_api__WEBPACK_IMPORTED_MODULE_2__.b.create(`api/plugin_config/${props.pluginConfigId}/job`,{job:{type:props.jobName,payload:payload}})}catch(error){return void lib_lemon_ui_lemonToast__WEBPACK_IMPORTED_MODULE_3__.d.error(`Enqueuing job "${props.jobName}" failed`)}null===(_props$onSubmit=props.onSubmit)||void 0===_props$onSubmit||_props$onSubmit.call(props),actions.setRunJobAvailable(!1),values.runJobAvailableTimeout&&clearTimeout(values.runJobAvailableTimeout);const timeout=window.setTimeout((()=>{actions.setRunJobAvailable(!0)}),15e3);actions.setRunJobAvailableTimeout(timeout),lib_lemon_ui_lemonToast__WEBPACK_IMPORTED_MODULE_3__.d.success("Job has been enqueued")}}}})),Object(kea__WEBPACK_IMPORTED_MODULE_0__.events)((_ref9=>{let{values:values}=_ref9;return{beforeUnmount:()=>{values.runJobAvailableTimeout&&clearTimeout(values.runJobAvailableTimeout)}}}))])},"./frontend/src/scenes/plugins/plugin/LocalPluginTag.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return LocalPluginTag}));var antd__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/tag/index.js"),lib_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./frontend/src/lib/utils.tsx"),lib_lemon_ui_Tooltip__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/lib/lemon-ui/Tooltip.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function LocalPluginTag(_ref){let{url:url,title:title,style:style}=_ref;return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(lib_lemon_ui_Tooltip__WEBPACK_IMPORTED_MODULE_2__.a,{title:url.substring(5),children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(antd__WEBPACK_IMPORTED_MODULE_0__.a,{color:"purple",onClick:async()=>await Object(lib_utils__WEBPACK_IMPORTED_MODULE_1__.s)(url.substring(5)),style:style,children:title||"Local App"})})}try{LocalPluginTag.displayName="LocalPluginTag",LocalPluginTag.__docgenInfo={description:"",displayName:"LocalPluginTag",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/LocalPluginTag.tsx#LocalPluginTag"]={docgenInfo:LocalPluginTag.__docgenInfo,name:"LocalPluginTag",path:"frontend/src/scenes/plugins/plugin/LocalPluginTag.tsx#LocalPluginTag"})}catch(__react_docgen_typescript_loader_error){}},"./frontend/src/scenes/plugins/plugin/PluginImage.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return PluginImage}));var utils=__webpack_require__("./frontend/src/lib/utils.tsx"),react=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),CodeOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/CodeOutlined.js"),plugin_default=__webpack_require__.p+"images/plugin-default.e3e047768d82d1c3fe24fce102eaef18.svg",jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function PluginImage(_ref){let{url:url,icon:icon,pluginType:pluginType,size:size="medium"}=_ref;const[state,setState]=Object(react.useState)({image:plugin_default}),pixelSize="large"===size?100:60;return Object(react.useEffect)((()=>{if(icon)setState((state=>({...state,image:icon})));else if(null!=url&&url.includes("github.com")){const{user:user,repo:repo,path:path}=Object(utils.vb)(url);setState({...state,image:`https://raw.githubusercontent.com/${user}/${repo}/${path||"main"}/logo.png`})}}),[url]),"source"===pluginType?Object(jsx_runtime.jsx)(CodeOutlined.a,{style:{fontSize:pixelSize},className:"plugin-image"}):Object(jsx_runtime.jsx)("div",{className:"plugin-image",style:{width:pixelSize,height:pixelSize,backgroundImage:`url(${state.image})`,backgroundSize:"contain",backgroundRepeat:"no-repeat"},onError:()=>setState({...state,image:plugin_default})})}try{PluginImage.displayName="PluginImage",PluginImage.__docgenInfo={description:"",displayName:"PluginImage",props:{url:{defaultValue:null,description:"",name:"url",required:!1,type:{name:"string"}},icon:{defaultValue:null,description:"",name:"icon",required:!1,type:{name:"string"}},pluginType:{defaultValue:null,description:"",name:"pluginType",required:!1,type:{name:"enum",value:[{value:'"local"'},{value:'"custom"'},{value:'"repository"'},{value:'"source"'}]}},size:{defaultValue:{value:"medium"},description:"",name:"size",required:!1,type:{name:"enum",value:[{value:'"large"'},{value:'"medium"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/PluginImage.tsx#PluginImage"]={docgenInfo:PluginImage.__docgenInfo,name:"PluginImage",path:"frontend/src/scenes/plugins/plugin/PluginImage.tsx#PluginImage"})}catch(__react_docgen_typescript_loader_error){}},"./frontend/src/scenes/plugins/plugin/SourcePluginTag.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return SourcePluginTag}));var antd__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/tag/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function SourcePluginTag(_ref){let{title:title="Source Code",style:style}=_ref;return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(antd__WEBPACK_IMPORTED_MODULE_0__.a,{style:style,children:title})}try{SourcePluginTag.displayName="SourcePluginTag",SourcePluginTag.__docgenInfo={description:"",displayName:"SourcePluginTag",props:{title:{defaultValue:{value:"Source Code"},description:"",name:"title",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/plugins/plugin/SourcePluginTag.tsx#SourcePluginTag"]={docgenInfo:SourcePluginTag.__docgenInfo,name:"SourcePluginTag",path:"frontend/src/scenes/plugins/plugin/SourcePluginTag.tsx#SourcePluginTag"})}catch(__react_docgen_typescript_loader_error){}}}]);