(window.webpackJsonp=window.webpackJsonp||[]).push([[231,241],{"./frontend/src/lib/components/LemonSelect.tsx":function(ae,O,e){"use strict";e.d(O,"a",function(){return A});var b=e("./node_modules/core-js/modules/es.array.map.js"),s=e.n(b),B=e("./node_modules/core-js/modules/es.object.entries.js"),R=e.n(B),z=e("./node_modules/@babel/runtime/helpers/extends.js"),re=e.n(z),k=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),j=e.n(k),W=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),Q=e.n(W),m=e("./node_modules/react/index.js"),t=e.n(m),Z=e("./frontend/src/lib/components/icons.tsx"),S=e("./frontend/src/lib/components/LemonButton/index.ts");function A(f){var v,H,C=f.value,U=f.onChange,K=f.options,oe=f.placeholder,d=f.dropdownMatchSelectWidth,u=d===void 0?!0:d,c=f.allowClear,J=c===void 0?!1:c,se=Q()(f,["value","onChange","options","placeholder","dropdownMatchSelectWidth","allowClear"]),le=Object(m.useState)(C),ie=j()(le,2),V=ie[0],I=ie[1],w=Object(m.useState)(!1),T=j()(w,2),F=T[0],ee=T[1],de=J&&F&&!!V;return Object(m.useEffect)(function(){se.loading||I(C)},[C,se.loading]),t.a.createElement("div",{className:"LemonButtonWithSideAction",onMouseEnter:function(){return ee(!0)},onMouseLeave:function(){return ee(!1)}},t.a.createElement(S.b,re()({popup:{overlay:Object.entries(K).map(function(_){var N=j()(_,2),x=N[0],G=N[1];return t.a.createElement(S.a,{key:x,icon:G.icon,onClick:function(){x!=V&&(U(x),I(x))},type:x==V?"highlighted":"stealth",disabled:G.disabled,fullWidth:!0,"data-attr":G["data-attr"]},G.label||x)}),sameWidth:u,actionable:!0},icon:V&&((v=K[V])===null||v===void 0?void 0:v.icon),sideIcon:de?t.a.createElement("div",null):void 0},se),V&&(((H=K[V])===null||H===void 0?void 0:H.label)||V)||t.a.createElement("span",{className:"text-muted"},oe)),de&&t.a.createElement(S.a,{className:"side-button",type:"tertiary",icon:t.a.createElement(Z.IconClose,{style:{fontSize:"1rem"}}),tooltip:"Clear selection",onClick:function(){U(null),I(null)}}))}try{A.displayName="LemonSelect",A.__docgenInfo={description:"",displayName:"LemonSelect",props:{options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"LemonSelectOptions"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string | number | symbol | null"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(newValue: keyof O | null) => void"}},dropdownMatchSelectWidth:{defaultValue:{value:"true"},description:"",name:"dropdownMatchSelectWidth",required:!1,type:{name:"boolean"}},allowClear:{defaultValue:{value:"false"},description:"",name:"allowClear",required:!1,type:{name:"boolean"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"highlighted"'},{value:'"primary"'},{value:'"secondary"'},{value:'"tertiary"'},{value:'"stealth"'},{value:'"primary-alt"'}]}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLButtonElement>"}},relaxedIconWidth:{defaultValue:null,description:"If icon width is relaxed, width of icon box is set to auto. Default icon width is 1em",name:"relaxedIconWidth",required:!1,type:{name:"boolean"}},status:{defaultValue:null,description:"",name:"status",required:!1,type:{name:"enum",value:[{value:'"muted"'},{value:'"success"'},{value:'"warning"'},{value:'"danger"'},{value:'"highlighted"'}]}},extendedContent:{defaultValue:null,description:"Extended content, e.g. a description, to show in the lower button area.",name:"extendedContent",required:!1,type:{name:"ReactNode"}},tooltip:{defaultValue:null,description:"Tooltip to display on hover.",name:"tooltip",required:!1,type:{name:"any"}},sideIcon:{defaultValue:null,description:"",name:"sideIcon",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>> | null"}},loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"boolean"}},compact:{defaultValue:null,description:"A compact row is slightly smaller than normal to better look inline with text.",name:"compact",required:!1,type:{name:"boolean"}},fullWidth:{defaultValue:null,description:"Whether the row should take up the parent's full width.",name:"fullWidth",required:!1,type:{name:"boolean"}},center:{defaultValue:null,description:"Whether the row's contents should be centered.",name:"center",required:!1,type:{name:"boolean"}},outlined:{defaultValue:null,description:"Whether the element should be outlined with a standard border.",name:"outlined",required:!1,type:{name:"any"}},"data-attr":{defaultValue:null,description:"",name:"data-attr",required:!1,type:{name:"string"}},to:{defaultValue:null,description:"URL to link to.",name:"to",required:!1,type:{name:"string"}},htmlType:{defaultValue:null,description:"",name:"htmlType",required:!1,type:{name:"string"}},translucent:{defaultValue:null,description:"Whether the button should have transparent background in its base state (i.e. non-hover).",name:"translucent",required:!1,type:{name:"boolean"}},active:{defaultValue:null,description:"Whether hover style should be applied, signaling that the button is held active in some way.",name:"active",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/LemonSelect.tsx#LemonSelect"]={docgenInfo:A.__docgenInfo,name:"LemonSelect",path:"frontend/src/lib/components/LemonSelect.tsx#LemonSelect"})}catch(f){}},"./frontend/src/lib/forms/Field.tsx":function(ae,O,e){"use strict";e.d(O,"a",function(){return t});var b=e("./node_modules/core-js/modules/es.function.name.js"),s=e.n(b),B=e("./node_modules/@babel/runtime/helpers/extends.js"),R=e.n(B),z=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),re=e.n(z),k=e("./node_modules/clsx/dist/clsx.m.js"),j=e("./node_modules/kea-forms/lib/components.js"),W=e.n(j),Q=e("./node_modules/react/index.js"),m=e.n(Q),t=function(S){var A=S.showOptional,f=S.name,v=re()(S,["showOptional","name"]),H=function(U){var K=U.label,oe=U.kids,d=U.hint,u=U.error;return m.a.createElement("div",{className:Object(k.a)("ant-row","ant-form-item",d||u?"ant-form-item-with-help":"",u?"ant-form-item-has-error":"")},K?m.a.createElement("div",{className:"ant-col ant-form-item-label"},m.a.createElement("label",{htmlFor:String(f),title:typeof K=="string"?K:void 0},A?m.a.createElement(m.a.Fragment,null,K,A?m.a.createElement("span",{className:"ant-form-item-optional",title:""},"(optional)"):null):K)):null,m.a.createElement("div",{className:"ant-col ant-form-item-control"},m.a.createElement("div",{className:"ant-form-item-control-input"},m.a.createElement("div",{className:"ant-form-item-control-input-content"},oe)),d||u?m.a.createElement("div",{className:"ant-form-item-explain ant-form-item-explain-connected"},u?m.a.createElement("div",{role:"alert",className:"ant-form-item-explain-error"},"Error: ",u):null,d?m.a.createElement("div",{role:"alert",className:"ant-form-item-explain-warning"},"Hint: ",d):null):null))};return m.a.createElement(j.Field,R()({},v,{name:f,template:H}))};try{t.displayName="Field",t.__docgenInfo={description:"Compatible replacement for Form.Item",displayName:"Field",props:{showOptional:{defaultValue:null,description:"",name:"showOptional",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/forms/Field.tsx#Field"]={docgenInfo:t.__docgenInfo,name:"Field",path:"frontend/src/lib/forms/Field.tsx#Field"})}catch(Z){}},"./frontend/src/lib/forms/VerticalForm.tsx":function(ae,O,e){"use strict";e.d(O,"a",function(){return j});var b=e("./node_modules/@babel/runtime/helpers/extends.js"),s=e.n(b),B=e("./node_modules/react/index.js"),R=e.n(B),z=e("./node_modules/kea-forms/lib/index.js"),re=e.n(z),k=e("./node_modules/clsx/dist/clsx.m.js");function j(W){return R.a.createElement(z.Form,s()({},W,{className:Object(k.a)("antd-form ant-form-vertical",W.className)}),W.children)}try{j.displayName="VerticalForm",j.__docgenInfo={description:"",displayName:"VerticalForm",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/forms/VerticalForm.tsx#VerticalForm"]={docgenInfo:j.__docgenInfo,name:"VerticalForm",path:"frontend/src/lib/forms/VerticalForm.tsx#VerticalForm"})}catch(W){}},"./frontend/src/scenes/cohorts/Cohort.tsx":function(ae,O,e){"use strict";e.r(O),e.d(O,"scene",function(){return Fe}),e.d(O,"Cohort",function(){return he});var b=e("./node_modules/core-js/modules/es.array.concat.js"),s=e("./node_modules/core-js/modules/es.array.filter.js"),B=e("./node_modules/core-js/modules/es.array.map.js"),R=e("./node_modules/core-js/modules/es.function.name.js"),z=e("./node_modules/core-js/modules/es.object.to-string.js"),re=e("./node_modules/core-js/modules/es.regexp.to-string.js"),k=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),j=e.n(k),W=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),Q=e.n(W),m=e("./node_modules/react/index.js"),t=e.n(m),Z=e("./node_modules/kea/lib/index.esm.js"),S=e("./node_modules/kea-forms/lib/index.js"),A=e("./node_modules/antd/es/divider/index.js"),f=e("./node_modules/antd/es/row/index.js"),v=e("./node_modules/antd/es/col/index.js"),H=e("./frontend/src/types.ts"),C=e("./frontend/src/lib/constants.tsx"),U=e("./node_modules/@ant-design/icons/es/icons/PlusOutlined.js"),K=e("./node_modules/antd/lib/upload/Dragger.js"),oe=e.n(K),d=e("./frontend/src/scenes/persons/Persons.tsx"),u=e("./node_modules/core-js/modules/es.symbol.js"),c=e("./node_modules/core-js/modules/es.symbol.description.js"),J=e("./node_modules/core-js/modules/es.array.find-index.js"),se=e("./node_modules/core-js/modules/es.array.iterator.js"),le=e("./node_modules/core-js/modules/es.object.entries.js"),ie=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),V=e("./node_modules/@babel/runtime/regenerator/index.js"),I=e.n(V),w=e("./node_modules/regenerator-runtime/runtime.js"),T=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),F=e.n(T),ee=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),de=e.n(ee),_=e("./frontend/src/lib/api.ts"),N=e("./frontend/src/models/cohortsModel.ts"),x=e("./frontend/src/lib/utils.tsx"),G=e("./frontend/src/scenes/persons/personsLogic.ts"),ce=e("./frontend/src/lib/components/lemonToast.tsx"),ue=e("./frontend/src/scenes/urls.ts"),te=e("./node_modules/kea-router/lib/index.js");function X(o,a){var n=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);a&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(o,i).enumerable})),n.push.apply(n,r)}return n}function p(o){for(var a=1;a<arguments.length;a++){var n=arguments[a]!=null?arguments[a]:{};a%2?X(Object(n),!0).forEach(function(r){Q()(o,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(n,r))})}return o}function ve(o){for(var a=p(p(p(p(p({},o.name?{name:o.name}:{}),o.description?{description:o.description}:{}),o.csv?{csv:o.csv}:{}),o.is_static?{is_static:o.is_static}:{}),{},{groups:JSON.stringify(o.is_static?[]:o.groups.map(function(D){return p(p({},D),{},{id:void 0,matchType:void 0})}))}),n=new FormData,r=0,i=Object.entries(a);r<i.length;r++){var L=de()(i[r],2),g=L[0],E=L[1];n.append(g,E)}return n}function pe(o){var a=o.action_id||o.event_id?C.f:C.p;return p({matchType:a,id:Math.random().toString().substr(2,5)},o)}function ge(o){return o.groups&&(o.groups=o.groups.map(function(a){return pe(a)}),o.groups=o.groups.map(function(a){return a.properties?p(p({},a),{},{properties:Object(x.r)(a.properties)}):a})),o}var Ee=ge({id:"new",groups:[{id:Math.random().toString().substr(2,5),matchType:C.p,properties:[]}]}),Ce=Object(Z.kea)({props:{},key:function(a){return a.id||"new"},path:function(a){return["scenes","cohorts","cohortLogic",a]},actions:function(){return{saveCohort:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{cohortParams:n}},setCohort:function(n){return{cohort:n}},deleteCohort:!0,fetchCohort:function(n){return{id:n}},onCriteriaChange:function(n,r){return{newGroup:n,id:r}},setPollTimeout:function(n){return{pollTimeout:n}},checkIfFinishedCalculating:function(n){return{cohort:n}}}},reducers:function(){return{cohort:[Ee,{onCriteriaChange:function(n,r){var i=r.newGroup,L=r.id,g=p({},n),E=g.groups.findIndex(function(D){return D.id===L});return i.matchType?g.groups[E]=p({id:g.groups[E].id,matchType:C.f},i):g.groups[E]=p(p({},g.groups[E]),i),ge(g)}}],pollTimeout:[null,{setPollTimeout:function(n,r){var i=r.pollTimeout;return i}}]}},forms:function(a){var n=a.actions;return{cohort:{defaults:Ee,validator:function(i){var L=i.name,g=i.csv,E=i.is_static,D=i.groups;return{name:L?void 0:"You need to set a name",csv:E&&!g?"You need to upload a CSV file":null,groups:E?void 0:!D||D.length<1?[{id:"You need at least one matching group"}]:D==null?void 0:D.map(function(l){var Y=l.matchType,h=l.properties,ne=l.action_id,y=l.event_id;return Y===C.p&&!(h!=null&&h.length)?{id:"Please select at least one property or remove this match group."}:Y===C.f&&!(ne||y)?{id:"Please select an event or action."}:{id:void 0}})}},submit:function(i){n.saveCohort(i)}}}},loaders:function(a){var n=a.actions,r=a.values,i=a.key;return{cohort:[Ee,{setCohort:function(g){var E=g.cohort;return ge(E)},fetchCohort:function(){var L=F()(I.a.mark(function E(D,l){var Y,h;return I.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return Y=D.id,y.prev=1,y.next=4,_.b.cohorts.get(Y);case 4:return h=y.sent,l(),N.a.actions.updateCohort(h),n.checkIfFinishedCalculating(h),y.abrupt("return",ge(h));case 11:return y.prev=11,y.t0=y.catch(1),ce.a.error(y.t0.detail||"Failed to fetch cohort"),y.abrupt("return",r.cohort);case 15:case"end":return y.stop()}},E,null,[[1,11]])}));function g(E,D){return L.apply(this,arguments)}return g}(),saveCohort:function(){var L=F()(I.a.mark(function E(D,l){var Y,h,ne;return I.a.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(Y=D.cohortParams,h=p({},Y),ne=ve(h),M.prev=3,h.id==="new"){M.next=11;break}return M.next=7,_.b.cohorts.update(h.id,ne);case 7:h=M.sent,N.a.actions.updateCohort(h),M.next=15;break;case 11:return M.next=13,_.b.cohorts.create(ne);case 13:h=M.sent,N.a.actions.cohortCreated(h);case 15:M.next=21;break;case 17:return M.prev=17,M.t0=M.catch(3),ce.a.error(M.t0.detail||"Failed to save cohort"),M.abrupt("return",r.cohort);case 21:return h.is_calculating=!0,l(),delete h.csv,n.setCohort(h),ce.a.success("Cohort saved. Please wait up to a few minutes for it to be calculated",{toastId:"cohort-saved-".concat(i)}),n.checkIfFinishedCalculating(h),M.abrupt("return",h);case 28:case"end":return M.stop()}},E,null,[[3,17]])}));function g(E,D){return L.apply(this,arguments)}return g}()}]}},selectors:{breadcrumbs:[function(o){return[o.cohort]},function(o){return[{name:"Cohorts",path:ue.a.cohorts()}].concat(j()(o?[{name:o.name||"Untitled"}]:[]))}]},listeners:function(a){var n=a.actions,r=a.values;return{deleteCohort:function(){var L;(L=N.a.findMounted())===null||L===void 0||L.actions.deleteCohort(r.cohort),te.router.actions.push(ue.a.cohorts())},checkIfFinishedCalculating:function(){var i=F()(I.a.mark(function g(E,D){var l,Y;return I.a.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:l=E.cohort,l.is_calculating?n.setPollTimeout(setTimeout(F()(I.a.mark(function y(){var M;return I.a.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,_.b.cohorts.get(l.id);case 2:M=P.sent,D(),n.checkIfFinishedCalculating(M);case 5:case"end":return P.stop()}},y)})),1e3)):(n.setCohort(l),N.a.actions.updateCohort(l),(Y=G.a.findMounted({syncWithUrl:!0}))===null||Y===void 0||Y.actions.loadCohorts(),r.pollTimeout&&(clearTimeout(r.pollTimeout),n.setPollTimeout(null)));case 2:case"end":return ne.stop()}},g)}));function L(g,E){return i.apply(this,arguments)}return L}()}},actionToUrl:function(a){var n=a.values;return{saveCohortSuccess:function(){return ue.a.cohort(n.cohort.id)}}},events:function(a){var n=a.values,r=a.actions,i=a.props;return{afterMount:function(){var L=F()(I.a.mark(function E(){return I.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:!i.id||i.id==="new"?r.setCohort(Ee):r.fetchCohort(i.id);case 1:case"end":return l.stop()}},E)}));function g(){return L.apply(this,arguments)}return g}(),beforeUnmount:function(){n.pollTimeout&&clearTimeout(n.pollTimeout)}}}}),Le=e("./frontend/src/scenes/userLogic.ts"),Ke=e("./node_modules/antd/lib/dropdown/style/index.css"),Me=e("./frontend/src/lib/components/Spinner/Spinner.tsx"),Te=e("./frontend/src/lib/components/LemonButton/index.ts"),De=e("./frontend/src/lib/components/PageHeader.tsx"),Ae=e("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),ye=e("./frontend/src/lib/forms/Field.tsx"),Ie=e("./frontend/src/lib/forms/VerticalForm.tsx"),_e=e("./frontend/src/lib/components/LemonSelect.tsx"),Re=e("./frontend/src/lib/components/LemonTextArea/LemonTextArea.tsx"),je=e("./frontend/src/lib/components/icons.tsx"),Be=e("./frontend/src/scenes/cohorts/MatchCriteriaSelector.tsx"),We=e("./frontend/src/lib/components/Tooltip.tsx"),Pe;function Se(o,a){var n=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);a&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(o,i).enumerable})),n.push.apply(n,r)}return n}function Oe(o){for(var a=1;a<arguments.length;a++){var n=arguments[a]!=null?arguments[a]:{};a%2?Se(Object(n),!0).forEach(function(r){Q()(o,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(n,r))})}return o}var Fe={component:he,logic:Ce,paramsToProps:function(a){var n=a.params.id;return{id:n&&n!=="new"?parseInt(n):"new"}}},Ue=(Pe={},Q()(Pe,C.b.Static,{label:"Static \xB7 Updated manually"}),Q()(Pe,C.b.Dynamic,{label:"Dynamic \xB7 Updates automatically"}),Pe);function he(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=o.id,n={id:a},r=Ce(n),i=Object(Z.useActions)(r),L=i.deleteCohort,g=i.setCohort,E=i.onCriteriaChange,D=Object(Z.useValues)(r),l=D.cohort,Y=D.cohortLoading,h=Object(Z.useValues)(Le.a),ne=h.hasAvailableFeature,y=l.id==="new"||l.id===void 0,M=function(){g(Oe(Oe({},l),{},{groups:[].concat(j()(l.groups),[{id:Math.random().toString().substr(2,5),matchType:C.p,properties:[]}])}))},xe=function($){g(Oe(Oe({},l),{},{groups:l.groups.filter(function(q,me){return me!==$})}))};return t.a.createElement("div",{className:"cohort"},t.a.createElement(Ie.a,{logic:Ce,props:n,formKey:"cohort"},t.a.createElement(De.a,{title:y?"New cohort":l.name||"Untitled",buttons:t.a.createElement("div",{className:"flex-center"},y?t.a.createElement(Te.a,{"data-attr":"cancel-cohort",type:"secondary",onClick:function(){te.router.actions.push(ue.a.cohorts())},style:{marginRight:8},disabled:Y},"Cancel"):t.a.createElement(Te.a,{"data-attr":"delete-cohort",status:"danger",type:"secondary",onClick:function(){L()},style:{marginRight:8},disabled:Y},"Delete"),t.a.createElement(Te.a,{type:"primary","data-attr":"save-cohort",htmlType:"submit",loading:Y},"Save"))}),t.a.createElement(A.a,null),t.a.createElement(f.a,{gutter:[16,24],style:{maxWidth:640}},t.a.createElement(v.a,{xs:24,sm:12},t.a.createElement(ye.a,{name:"name",label:"Name"},function(P){var $=P.value,q=P.onValueChange;return t.a.createElement(Ae.a,{value:$,onChange:q,"data-attr":"cohort-name"})})),t.a.createElement(v.a,{xs:24,sm:12},t.a.createElement(ye.a,{name:"is_static",label:"Type"},function(P){var $=P.value,q=P.onValueChange;return t.a.createElement(We.a,{title:y?null:"Create a new cohort to use a different type of cohort."},t.a.createElement("div",null,t.a.createElement(_e.a,{disabled:!y,options:Ue,value:$?C.b.Static:C.b.Dynamic,onChange:function(fe){q(fe===C.b.Static)},type:"stealth",outlined:!0,style:{width:"100%"},"data-attr":"cohort-type"})))}))),ne(H.d.DASHBOARD_COLLABORATION)&&t.a.createElement(f.a,{gutter:[16,24],className:"mt ph-ignore-input",style:{maxWidth:640}},t.a.createElement(v.a,{span:24},t.a.createElement(ye.a,{name:"description",label:"Description","data-attr":"cohort-description"},function(P){var $=P.value,q=P.onValueChange;return t.a.createElement(Re.a,{value:$,onChange:q})}))),l.is_static?t.a.createElement(f.a,{gutter:24,className:"mt ph-ignore-input"},t.a.createElement(v.a,{span:24},t.a.createElement(ye.a,{name:"csv",label:y?"Upload users":"Add users","data-attr":"cohort-csv"},function(P){var $,q,me=P.onValueChange;return t.a.createElement(t.a.Fragment,null,t.a.createElement("span",{className:"mb"},"Upload a CSV file to add users to your cohort. The CSV file only requires a single column with the user\u2019s distinct ID."),t.a.createElement(oe.a,{name:"file",multiple:!1,fileList:l.csv?[l.csv]:[],accept:".csv",showUploadList:!1,beforeUpload:function(be){return me(be),!1},className:"cohort-csv-dragger"},l.csv?t.a.createElement(t.a.Fragment,null,t.a.createElement(je.IconUploadFile,{style:{fontSize:"3rem",color:"var(--muted-alt)"}}),t.a.createElement("div",{className:"ant-upload-text"},($=(q=l.csv)===null||q===void 0?void 0:q.name)!==null&&$!==void 0?$:"File chosen")):t.a.createElement(t.a.Fragment,null,t.a.createElement(je.IconUploadFile,{style:{fontSize:"3rem",color:"var(--muted-alt)"}}),t.a.createElement("div",{className:"ant-upload-text"},"Drag a file here or click to browse for a file"))))}))):t.a.createElement(t.a.Fragment,null,t.a.createElement(A.a,null),t.a.createElement(f.a,{gutter:24,className:"mt"},t.a.createElement(v.a,{span:24},t.a.createElement(t.a.Fragment,null,t.a.createElement("div",{className:"ant-row ant-form-item ant-form-item-label",style:{display:"flex"}},t.a.createElement("label",{htmlFor:"groups",title:"Matching criteria"},"Matching criteria"),t.a.createElement("span",null,"Actors who match the following criteria will be part of the cohort. Continuously updated automatically.")),l.groups.map(function(P,$){return t.a.createElement(S.Group,{key:$,name:["groups",$]},t.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"}},t.a.createElement(S.Field,{name:"id",template:function(me){var fe=me.error,be=me.kids;return t.a.createElement("div",{style:{padding:15,border:fe?"1px solid var(--danger)":"1px solid rgba(0, 0, 0, 0.1)",borderRadius:4,width:"100%"}},be,t.a.createElement(f.a,null,fe&&t.a.createElement("div",{style:{color:"var(--danger)",marginTop:16}},fe)))}},t.a.createElement(Be.b,{onCriteriaChange:function(me){return E(me,P.id)},onRemove:function(){return xe($)},group:P,hideRemove:l.groups.length===1})),$<l.groups.length-1&&t.a.createElement("div",{className:"stateful-badge or mt mb"},"OR")))})),t.a.createElement("span",{id:"add"}),t.a.createElement("div",{style:{marginTop:8,marginBottom:8}},t.a.createElement("a",{href:"#add",style:{padding:0},onClick:function(){return M()},"data-attr":"add-match-criteria"},t.a.createElement(U.a,null)," Add matching criteria"))))),!y&&t.a.createElement(t.a.Fragment,null,t.a.createElement(A.a,null),t.a.createElement("div",null,t.a.createElement("h3",{className:"l3"},"Persons in this cohort"),l.is_calculating?t.a.createElement("div",{className:"cohort-recalculating flex-center"},t.a.createElement(Me.a,{size:"sm",style:{marginRight:4}}),"We're recalculating who belongs to this cohort. This could take up to a couple of minutes."):t.a.createElement("div",{style:{marginTop:15}},t.a.createElement(d.Persons,{cohort:l.id}))))))}try{he.displayName="Cohort",he.__docgenInfo={description:"",displayName:"Cohort",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:'number | "new"'}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/cohorts/Cohort.tsx#Cohort"]={docgenInfo:he.__docgenInfo,name:"Cohort",path:"frontend/src/scenes/cohorts/Cohort.tsx#Cohort"})}catch(o){}},"./frontend/src/scenes/groups/groupsListLogic.ts":function(ae,O,e){"use strict";e.d(O,"a",function(){return oe});var b=e("./node_modules/core-js/modules/es.array.concat.js"),s=e.n(b),B=e("./node_modules/core-js/modules/es.array.iterator.js"),R=e.n(B),z=e("./node_modules/core-js/modules/es.object.to-string.js"),re=e.n(z),k=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),j=e.n(k),W=e("./node_modules/@babel/runtime/regenerator/index.js"),Q=e.n(W),m=e("./node_modules/regenerator-runtime/runtime.js"),t=e.n(m),Z=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),S=e.n(Z),A=e("./node_modules/kea/lib/index.esm.js"),f=e("./frontend/src/lib/api.ts"),v=e("./frontend/src/lib/introductions/groupsAccessLogic.ts"),H=e("./frontend/src/lib/utils.tsx"),C=e("./frontend/src/scenes/teamLogic.ts"),U=e("./frontend/src/scenes/urls.ts"),K=e("./frontend/src/models/groupsModel.ts"),oe=Object(A.kea)({path:["groups","groupsListLogic"],connect:{values:[C.a,["currentTeamId"],K.a,["groupTypes","aggregationLabel"],v.b,["groupsEnabled"]]},actions:function(){return{loadGroups:function(c){return{url:c}},setTab:function(c){return{tab:c}}}},loaders:function(u){var c=u.values;return{groups:[{next:null,previous:null,results:[]},{loadGroups:function(){var J=S()(Q.a.mark(function le(ie){var V;return Q.a.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(V=ie.url,!c.groupsEnabled){w.next=6;break}return V=V||"api/projects/".concat(c.currentTeamId,"/groups/?group_type_index=").concat(c.currentTab),w.next=5,f.b.get(V);case 5:return w.abrupt("return",w.sent);case 6:case"end":return w.stop()}},le)}));function se(le){return J.apply(this,arguments)}return se}()}]}},reducers:{currentTab:["-1",{setTab:function(u,c){var J=c.tab;return J}}]},selectors:{currentTabName:[function(d){return[d.currentTab,d.groupTypes,d.aggregationLabel]},function(d,u,c){return d==="-1"?"Persons":u!=null&&u.length?Object(H.i)(c(parseInt(d)).singular):""}],breadcrumbs:[function(d){return[d.currentTabName,d.currentTab]},function(d,u){return[{name:d,path:U.a.groups(u)}]}]},actionToUrl:function(){return{setTab:function(c){var J=c.tab;return J!=="-1"?U.a.groups(J):U.a.persons()}}},urlToAction:function(u){var c=u.actions,J=u.values;return{"/groups/:id":function(le){var ie=le.id;ie&&(c.setTab(ie),c.loadGroups())},"/persons":function(){J.currentTab!=="-1"&&c.setTab("-1")}}}})},"./frontend/src/scenes/persons/PersonPageHeader.tsx":function(ae,O,e){"use strict";e.d(O,"a",function(){return S});var b=e("./node_modules/kea/lib/index.esm.js"),s=e("./frontend/src/lib/components/PageHeader.tsx"),B=e("./node_modules/react/index.js"),R=e.n(B),z=e("./node_modules/core-js/modules/es.array.includes.js"),re=e("./node_modules/core-js/modules/es.array.map.js"),k=e("./node_modules/core-js/modules/es.string.includes.js"),j=e("./node_modules/antd/es/tabs/index.js"),W=e("./frontend/src/lib/introductions/groupsAccessLogic.ts"),Q=e("./frontend/src/lib/utils.tsx"),m=e("./frontend/src/models/groupsModel.ts"),t=e("./frontend/src/scenes/groups/groupsListLogic.ts");function Z(){var A=Object(b.useActions)(t.a),f=A.setTab,v=Object(b.useValues)(t.a),H=v.currentTab,C=Object(b.useValues)(m.a),U=C.groupTypes,K=C.aggregationLabel,oe=Object(b.useValues)(W.b),d=oe.groupsAccessStatus,u=[W.a.HasAccess,W.a.HasGroupTypes,W.a.NoAccess].includes(d);return R.a.createElement(j.a,{activeKey:H,onChange:function(J){return f(J)}},R.a.createElement(j.a.TabPane,{tab:"Persons",key:"-1"}),u?R.a.createElement(j.a.TabPane,{tab:"Introducing Group Analytics",key:"0"}):U.map(function(c){return R.a.createElement(j.a.TabPane,{tab:Object(Q.i)(K(c.group_type_index).plural),key:c.group_type_index})}))}function S(A){var f=A.hideGroupTabs,v=Object(b.useValues)(m.a),H=v.showGroupsOptions;return R.a.createElement(R.a.Fragment,null,R.a.createElement(s.a,{title:"Persons".concat(H?" & Groups":""),caption:"A catalog of your product's end users".concat(H?" and groups":"",".")}),!f&&H&&R.a.createElement(Z,null))}try{S.displayName="PersonPageHeader",S.__docgenInfo={description:"",displayName:"PersonPageHeader",props:{hideGroupTabs:{defaultValue:null,description:"",name:"hideGroupTabs",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"]={docgenInfo:S.__docgenInfo,name:"PersonPageHeader",path:"frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"})}catch(A){}},"./frontend/src/scenes/persons/Persons.scss":function(ae,O,e){"use strict";var b=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),s=e.n(b),B=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/persons/Persons.scss"),R=e.n(B),z={};z.insert="head",z.singleton=!1;var re=s()(R.a,z),k=R.a.locals||{}},"./frontend/src/scenes/persons/Persons.tsx":function(ae,O,e){"use strict";e.r(O),e.d(O,"scene",function(){return V}),e.d(O,"Persons",function(){return I}),e.d(O,"PersonsScene",function(){return w});var b=e("./node_modules/react/index.js"),s=e.n(b),B=e("./node_modules/kea/lib/index.esm.js"),R=e("./node_modules/core-js/modules/es.array.concat.js"),z=e("./node_modules/core-js/modules/es.object.keys.js"),re=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),k=e.n(re),j=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),W=e("./frontend/src/lib/components/PropertiesTable.tsx"),Q=e("./frontend/src/scenes/persons/Persons.scss"),m=e("./frontend/src/lib/components/CopyToClipboard.tsx"),t=e("./frontend/src/scenes/persons/PersonHeader.tsx"),Z=e("./frontend/src/lib/components/LemonTable/index.ts");function S(T){var F=T.people,ee=T.loading,de=ee===void 0?!1:ee,_=T.hasPrevious,N=T.hasNext,x=T.loadPrevious,G=T.loadNext,ce=T.compact,ue=[{title:"Person",key:"person",render:function(X,p){return s.a.createElement(t.a,{withIcon:!0,person:p})}},{title:"ID",key:"id",render:function(X,p){return s.a.createElement("div",{style:{overflow:"hidden"}},p.distinct_ids.length&&s.a.createElement(m.a,{explicitValue:p.distinct_ids[0],iconStyle:{color:"var(--primary)"},description:"person distinct ID"},p.distinct_ids[0]))}}].concat(k()(ce?[]:[{title:"First seen",dataIndex:"created_at",render:function(X){return X?s.a.createElement(j.b,{time:X}):s.a.createElement(s.a.Fragment,null)}}]));return s.a.createElement(Z.a,{columns:ue,loading:de,rowKey:"id",pagination:{controlled:!0,pageSize:100,onForward:N?function(){G==null||G(),window.scrollTo(0,0)}:void 0,onBackward:_?function(){x==null||x(),window.scrollTo(0,0)}:void 0},expandable:{expandedRowRender:function(X){var p=X.properties;return Object.keys(p).length?s.a.createElement(W.a,{properties:p}):"This person has no properties."}},dataSource:F,emptyState:"No persons",nouns:["person","persons"]})}try{S.displayName="PersonsTable",S.__docgenInfo={description:"",displayName:"PersonsTable",props:{people:{defaultValue:null,description:"",name:"people",required:!0,type:{name:"PersonType[]"}},loading:{defaultValue:{value:"false"},description:"",name:"loading",required:!1,type:{name:"boolean"}},hasPrevious:{defaultValue:null,description:"",name:"hasPrevious",required:!1,type:{name:"boolean"}},hasNext:{defaultValue:null,description:"",name:"hasNext",required:!1,type:{name:"boolean"}},loadPrevious:{defaultValue:null,description:"",name:"loadPrevious",required:!1,type:{name:"(() => void)"}},loadNext:{defaultValue:null,description:"",name:"loadNext",required:!1,type:{name:"(() => void)"}},compact:{defaultValue:null,description:"",name:"compact",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"]={docgenInfo:S.__docgenInfo,name:"PersonsTable",path:"frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"})}catch(T){}var A=e("./node_modules/antd/es/row/index.js"),f=e("./node_modules/antd/es/popconfirm/index.js"),v=e("./frontend/src/scenes/persons/personsLogic.ts"),H=e("./node_modules/core-js/modules/es.regexp.exec.js"),C=e("./node_modules/core-js/modules/es.string.search.js"),U=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),K=e.n(U),oe=e("./node_modules/antd/es/input/index.js"),d=e("./frontend/src/lib/components/LemonRow/index.ts"),u=e("./frontend/src/lib/components/icons.tsx"),c=function(F){var ee=F.autoFocus,de=ee===void 0?!0:ee,_=Object(B.useActions)(v.a),N=_.loadPersons,x=_.setListFilters,G=Object(B.useValues)(v.a),ce=G.listFilters,ue=Object(b.useState)(""),te=K()(ue,2),X=te[0],p=te[1];return Object(b.useEffect)(function(){p(ce.search||"")},[]),s.a.createElement("div",{style:{display:"flex",alignItems:"center",width:"min(100%, 24rem)"}},s.a.createElement(oe.a.Search,{"data-attr":"persons-search",placeholder:"Search for persons",autoFocus:de,value:X,onChange:function(pe){p(pe.target.value),pe.target.value||(x({search:void 0}),N())},enterButton:!0,onPressEnter:function(pe){pe.preventDefault(),x({search:X||void 0}),N()},allowClear:!0,onSearch:function(){x({search:X||void 0}),N()},style:{width:"100%"}}),s.a.createElement(d.a,{className:"ml-05",type:"stealth",tooltip:s.a.createElement(s.a.Fragment,null,"Search by email, name, ID, or even contents of properties. You can also search for persons who just ",s.a.createElement("i",null,"have"),' a property like so: "has:your_property".'),icon:s.a.createElement(u.IconInfo,null)}))};try{c.displayName="PersonsSearch",c.__docgenInfo={description:"",displayName:"PersonsSearch",props:{autoFocus:{defaultValue:{value:"true"},description:"",name:"autoFocus",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonsSearch.tsx#PersonsSearch"]={docgenInfo:c.__docgenInfo,name:"PersonsSearch",path:"frontend/src/scenes/persons/PersonsSearch.tsx#PersonsSearch"})}catch(T){}var J=e("./frontend/src/scenes/persons/PersonPageHeader.tsx"),se=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),le=e("./frontend/src/lib/components/TaxonomicFilter/types.ts"),ie=e("./frontend/src/lib/components/LemonButton/index.ts"),V={component:w,logic:v.a,paramsToProps:function(){return{syncWithUrl:!0}}};function I(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},F=T.cohort;return s.a.createElement(B.BindLogic,{logic:v.a,props:{cohort:F,syncWithUrl:!F}},s.a.createElement(w,null))}function w(){var T=Object(B.useActions)(v.a),F=T.loadPersons,ee=T.setListFilters,de=T.exportCsv,_=Object(B.useValues)(v.a),N=_.cohortId,x=_.persons,G=_.listFilters,ce=_.personsLoading,ue=_.exportUrl;return s.a.createElement("div",{className:"persons-list"},!N&&s.a.createElement(J.a,null),s.a.createElement(A.a,{align:"middle",justify:"space-between",className:"mb-05",style:{gap:"0.75rem"}},s.a.createElement(c,{autoFocus:!N}),s.a.createElement("div",null,s.a.createElement(f.a,{placement:"topRight",title:s.a.createElement(s.a.Fragment,null,"Exporting by csv is limited to 10,000 users.",s.a.createElement("br",null),"To return more, please use ",s.a.createElement("a",{href:"https://posthog.com/docs/api/persons"},"the API"),". Do you want to export by CSV?"),onConfirm:de},ue&&s.a.createElement(ie.a,{type:"secondary",icon:s.a.createElement(u.IconExport,{style:{color:"var(--primary)"}})},G.properties&&G.properties.length>0?s.a.createElement("div",{style:{display:"block"}},"Export (",s.a.createElement("strong",null,G.properties.length)," filter)"):"Export")))),s.a.createElement(se.a,{pageKey:"persons-list-page",propertyFilters:G.properties,onChange:function(X){ee({properties:X}),F()},endpoint:"person",taxonomicGroupTypes:[le.a.PersonProperties,le.a.Cohorts],showConditionBadge:!0}),s.a.createElement(S,{people:x.results,loading:ce,hasPrevious:!!x.previous,hasNext:!!x.next,loadPrevious:function(){return F(x.previous)},loadNext:function(){return F(x.next)}}))}try{I.displayName="Persons",I.__docgenInfo={description:"",displayName:"Persons",props:{cohort:{defaultValue:null,description:"",name:"cohort",required:!1,type:{name:'number | "new"'}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/Persons.tsx#Persons"]={docgenInfo:I.__docgenInfo,name:"Persons",path:"frontend/src/scenes/persons/Persons.tsx#Persons"})}catch(T){}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/persons/Persons.scss":function(ae,O,e){var b=e("./node_modules/css-loader/dist/runtime/api.js");O=b(!1),O.push([ae.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.extra-ids{display:inline-flex;align-items:center;height:1.25rem;line-height:1.125rem;margin:0 0 0 .25rem;padding:0 .25rem 0 .375rem;color:#5375ff;cursor:pointer}.extra-ids svg{margin-left:.25rem}",""]),ae.exports=O}}]);
