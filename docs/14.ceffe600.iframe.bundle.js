(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"./frontend/src/lib/components/ChartFilter/chartFilterLogic.ts":function(Q,w,t){"use strict";t.d(w,"a",function(){return ke});var Z=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),N=t.n(Z),he=t("./node_modules/core-js/modules/es.array.includes.js"),re=t.n(he),ie=t("./node_modules/core-js/modules/es.string.includes.js"),we=t.n(ie),Ee=t("./node_modules/core-js/modules/es.object.values.js"),l=t.n(Ee),ge=t("./node_modules/core-js/modules/es.array.iterator.js"),We=t.n(ge),xe=t("./node_modules/core-js/modules/es.object.to-string.js"),Re=t.n(xe),me=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),pe=t.n(me),de=t("./node_modules/core-js/modules/es.object.keys.js"),ue=t.n(de),Pe=t("./node_modules/core-js/modules/es.symbol.js"),a=t.n(Pe),L=t("./node_modules/core-js/modules/es.array.filter.js"),G=t.n(L),ye=t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),ee=t.n(ye),_=t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),e=t.n(_),le=t("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),ve=t.n(le),K=t("./node_modules/kea/lib/index.esm.js"),$=t("./frontend/src/lib/utils.tsx"),h=t("./frontend/src/types.ts"),S=t("./frontend/src/scenes/insights/sharedUtils.ts"),Y=t("./frontend/src/scenes/insights/insightLogic.ts");function J(H,te){var oe=Object.keys(H);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols(H);te&&(q=q.filter(function(dt){return Object.getOwnPropertyDescriptor(H,dt).enumerable})),oe.push.apply(oe,q)}return oe}function ce(H){for(var te=1;te<arguments.length;te++){var oe=arguments[te]!=null?arguments[te]:{};te%2?J(Object(oe),!0).forEach(function(q){N()(H,q,oe[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(oe)):J(Object(oe)).forEach(function(q){Object.defineProperty(H,q,Object.getOwnPropertyDescriptor(oe,q))})}return H}function Me(H){return Object.values(h.A).includes(H)}var ke=Object(K.kea)({props:{},key:Object(S.k)("new"),path:function(te){return["lib","components","ChartFilter","chartFilterLogic",te]},connect:function(te){return{actions:[Object(Y.c)(te),["setFilters"]],values:[Object(Y.c)(te),["filters"]]}},actions:function(){return{setChartFilter:function(oe){return{chartFilter:oe}}}},selectors:{chartFilter:[function(H){return[H.filters]},function(H){return(Object(S.d)(H)?H.funnel_viz_type:Object(S.b)(H)?H.display:null)||null}]},listeners:function(te){var oe=te.actions,q=te.values;return{setChartFilter:function(Ct){var Ne=Ct.chartFilter;if(Me(Ne)){var Et=Object(S.d)(q.filters)?q.filters.funnel_viz_type:null;if(Et!==Ne){var Pt=ce(ce({},q.filters),{},{funnel_viz_type:Ne});oe.setFilters(Pt)}}else if((Object(S.i)(q.filters)||Object(S.h)(q.filters))&&!Object($.qb)(q.filters.display,Ne)){var St=ce(ce({},q.filters),{},{display:Ne});oe.setFilters(St)}}}}})},"./frontend/src/lib/components/CompareFilter/compareFilterLogic.ts":function(Q,w,t){"use strict";t.d(w,"a",function(){return $});var Z=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),N=t.n(Z),he=t("./node_modules/core-js/modules/es.array.iterator.js"),re=t.n(he),ie=t("./node_modules/core-js/modules/es.object.to-string.js"),we=t.n(ie),Ee=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),l=t.n(Ee),ge=t("./node_modules/core-js/modules/es.object.keys.js"),We=t.n(ge),xe=t("./node_modules/core-js/modules/es.symbol.js"),Re=t.n(xe),me=t("./node_modules/core-js/modules/es.array.filter.js"),pe=t.n(me),de=t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),ue=t.n(de),Pe=t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),a=t.n(Pe),L=t("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),G=t.n(L),ye=t("./node_modules/kea/lib/index.esm.js"),ee=t("./frontend/src/lib/utils.tsx"),_=t("./frontend/src/types.ts"),e=t("./frontend/src/scenes/insights/sharedUtils.ts"),le=t("./frontend/src/scenes/insights/insightLogic.ts");function ve(h,S){var Y=Object.keys(h);if(Object.getOwnPropertySymbols){var J=Object.getOwnPropertySymbols(h);S&&(J=J.filter(function(ce){return Object.getOwnPropertyDescriptor(h,ce).enumerable})),Y.push.apply(Y,J)}return Y}function K(h){for(var S=1;S<arguments.length;S++){var Y=arguments[S]!=null?arguments[S]:{};S%2?ve(Object(Y),!0).forEach(function(J){N()(h,J,Y[J])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(Y)):ve(Object(Y)).forEach(function(J){Object.defineProperty(h,J,Object.getOwnPropertyDescriptor(Y,J))})}return h}var $=Object(ye.kea)({props:{},key:Object(e.k)("new"),path:function(S){return["lib","components","CompareFilter","compareFilterLogic",S]},connect:function(S){return{actions:[Object(le.c)(S),["setFilters"]],values:[Object(le.c)(S),["filters as inflightFilters","canEditInsight"]]}},actions:function(){return{setCompare:function(Y){return{compare:Y}},toggleCompare:!0}},selectors:{filters:[function(h){return[h.inflightFilters]},function(h){return h&&Object(e.i)(h)?h:{}}],compare:[function(h){return[h.filters]},function(h){return h&&Object(e.i)(h)&&!!h.compare}],disabled:[function(h){return[h.filters,h.canEditInsight]},function(h,S){var Y=h.insight,J=h.date_from,ce=h.display;return!S||Y===_.E.LIFECYCLE||ce===_.j.WorldMap||J==="all"}]},listeners:function(S){var Y=S.values,J=S.actions;return{setCompare:function(Me){var ke=Me.compare;if(!Object(ee.qb)(ke,Y.compare)){var H=K(K({},Y.filters),{},{compare:ke});J.setFilters(H)}},toggleCompare:function(){J.setCompare(!Y.compare)}}}})},"./frontend/src/lib/components/InlineMessage/InlineMessage.tsx":function(Q,w,t){"use strict";t.d(w,"a",function(){return de});var Z=t("./node_modules/@babel/runtime/helpers/slicedToArray.js"),N=t.n(Z),he=t("./node_modules/react/index.js"),re=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),ie=t.n(re),we=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/lib/components/InlineMessage/InlineMessage.scss"),Ee=t.n(we),l={};l.insert="head",l.singleton=!1;var ge=ie()(Ee.a,l),We=Ee.a.locals||{},xe=t("./node_modules/@ant-design/icons/es/icons/ExclamationCircleFilled.js"),Re=t("./node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),me=t("./node_modules/clsx/dist/clsx.m.js"),pe=t("./node_modules/react/jsx-runtime.js");function de(ue){var Pe=ue.children,a=ue.style,L=ue.icon,G=L===void 0?Object(pe.jsx)(xe.a,{}):L,ye=ue.type,ee=ye===void 0?"info":ye,_=ue.closable,e=ue.onClose,le=Object(he.useState)(!0),ve=N()(le,2),K=ve[0],$=ve[1],h=function(){$(!1),e==null||e()};return Object(pe.jsxs)("div",{className:Object(me.a)("inline-message",ee,_&&"closable",!K&&"hidden"),style:a,children:[Object(pe.jsx)("div",{className:"inline-icon",children:G}),Object(pe.jsx)("div",{className:"inline-main",children:Pe}),_&&Object(pe.jsx)("div",{className:"closable",onClick:h,children:Object(pe.jsx)(Re.a,{})})]})}try{de.displayName="InlineMessage",de.__docgenInfo={description:"",displayName:"InlineMessage",props:{style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},icon:{defaultValue:{value:"<ExclamationCircleFilled />"},description:"",name:"icon",required:!1,type:{name:"Element"}},type:{defaultValue:{value:"info"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"warning"'},{value:'"danger"'},{value:'"info"'}]}},closable:{defaultValue:null,description:"",name:"closable",required:!1,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"(() => void)"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/InlineMessage/InlineMessage.tsx#InlineMessage"]={docgenInfo:de.__docgenInfo,name:"InlineMessage",path:"frontend/src/lib/components/InlineMessage/InlineMessage.tsx#InlineMessage"})}catch(ue){}},"./frontend/src/scenes/insights/InsightContainer.tsx":function(Q,w,t){"use strict";t.d(w,"a",function(){return at});var Z=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),N=t.n(Z),he=t("./node_modules/antd/es/card/index.js"),re=t("./node_modules/antd/es/row/index.js"),ie=t("./node_modules/antd/es/col/index.js"),we=t("./node_modules/core-js/modules/es.array.includes.js"),Ee=t("./node_modules/core-js/modules/es.string.includes.js"),l=t("./node_modules/kea/lib/index.esm.js"),ge=t("./frontend/src/lib/components/ChartFilter/chartFilterLogic.ts"),We=t("./node_modules/@ant-design/icons/es/icons/OrderedListOutlined.js"),xe=t("./node_modules/@ant-design/icons/es/icons/LineChartOutlined.js"),Re=t("./node_modules/@ant-design/icons/es/icons/AreaChartOutlined.js"),me=t("./node_modules/@ant-design/icons/es/icons/BarChartOutlined.js"),pe=t("./node_modules/@ant-design/icons/es/icons/NumberOutlined.js"),de=t("./node_modules/@ant-design/icons/es/icons/TableOutlined.js"),ue=t("./node_modules/@ant-design/icons/es/icons/PieChartOutlined.js"),Pe=t("./node_modules/@ant-design/icons/es/icons/GlobalOutlined.js"),a=t("./frontend/src/types.ts"),L=t("./frontend/src/scenes/insights/insightLogic.ts"),G=t("./frontend/src/lib/components/Tooltip.tsx"),ye=t("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),ee=t("./frontend/@posthog/lemon-ui/src/index.ts"),_=t("./frontend/src/scenes/insights/sharedUtils.ts"),e=t("./node_modules/react/jsx-runtime.js");function le(s){var n=s.filters,o=s.onChange,r=s.disabled,u=Object(l.useValues)(L.c),i=u.insightProps,d=u.isSingleSeries,c=Object(l.useValues)(Object(ge.a)(i)),j=c.chartFilter,f=Object(l.useActions)(Object(ge.a)(i)),b=f.setChartFilter,v=Object(_.h)(n)||Object(_.g)(n),O=Object(_.h)(n)||Object(_.g)(n),m=Object(_.h)(n)||Object(_.g)(n)&&!!n.breakdown&&n.breakdown!=="$geoip_country_code"&&n.breakdown!=="$geoip_country_name"||!d||Object(_.i)(n)&&!!n.formula,x=Object(_.h)(n)||Object(_.g)(n)||!d,C=Object(_.g)(n),y=C||Object(_.h)(n)||Object(_.g)(n),U=Object(_.g)(n)?a.j.ActionsTable:a.j.ActionsLineGraph;function P(F){var p=F.icon,g=F.tooltip,I=F.children,R=I===void 0?null:I;return Object(e.jsx)(G.a,{title:g,placement:"left",children:Object(e.jsxs)("div",{className:"w-full",children:[p," ",R]})})}var W=n.insight===a.E.FUNNELS?[{value:a.A.Steps,label:Object(e.jsx)(P,{icon:Object(e.jsx)(We.a,{}),children:"Steps"})},{value:a.A.Trends,label:Object(e.jsxs)(P,{icon:Object(e.jsx)(xe.a,{}),children:["Trends",Object(e.jsx)(ye.a,{type:"warning",className:"uppercase",style:{marginLeft:6,lineHeight:"1.4em"},children:"BETA"})]})}]:[{title:"Line Chart",options:[{value:a.j.ActionsLineGraph,label:Object(e.jsx)(P,{icon:Object(e.jsx)(xe.a,{}),children:"Linear"})},{value:a.j.ActionsLineGraphCumulative,label:Object(e.jsx)(P,{icon:Object(e.jsx)(Re.a,{}),children:"Cumulative"}),disabled:v}]},{title:"Bar Chart",options:[{value:a.j.ActionsBar,label:Object(e.jsx)(P,{icon:Object(e.jsx)(me.a,{}),children:"Time"}),disabled:C},{value:a.j.ActionsBarValue,label:Object(e.jsx)(P,{icon:Object(e.jsx)(me.a,{}),children:"Value"}),disabled:y}]},{options:[{value:a.j.BoldNumber,label:Object(e.jsx)(P,{icon:Object(e.jsx)(pe.a,{}),tooltip:"Big and bold. Only works with one series at a time.",children:"Number"}),disabled:x},{value:a.j.ActionsTable,label:Object(e.jsx)(P,{icon:Object(e.jsx)(de.a,{}),children:"Table"})},{value:a.j.ActionsPie,label:Object(e.jsx)(P,{icon:Object(e.jsx)(ue.a,{}),children:"Pie"}),disabled:O},{value:a.j.WorldMap,label:Object(e.jsx)(P,{icon:Object(e.jsx)(Pe.a,{}),tooltip:"Visualize data by country. Only works with one series at a time.",children:"World Map"}),disabled:m}]}];return Object(e.jsx)(ee.LemonSelect,{value:j||U,onChange:function(p){b(p),o==null||o(p)},dropdownPlacement:"bottom-end",dropdownMatchSelectWidth:!1,"data-attr":"chart-filter",disabled:r,options:W,size:"small"},"2")}try{le.displayName="ChartFilter",le.__docgenInfo={description:"",displayName:"ChartFilter",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((chartFilter: ChartDisplayType | FunnelVizType) => void)"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/ChartFilter/ChartFilter.tsx#ChartFilter"]={docgenInfo:le.__docgenInfo,name:"ChartFilter",path:"frontend/src/lib/components/ChartFilter/ChartFilter.tsx#ChartFilter"})}catch(s){}var ve=t("./frontend/src/lib/components/CompareFilter/compareFilterLogic.ts");function K(){var s=Object(l.useValues)(L.c),n=s.insightProps,o=Object(l.useValues)(Object(ve.a)(n)),r=o.compare,u=o.disabled,i=Object(l.useActions)(Object(ve.a)(n)),d=i.setCompare;return u?null:Object(e.jsx)(ee.LemonCheckbox,{onChange:d,checked:r,disabled:u,label:Object(e.jsx)("span",{className:"font-normal",children:"Compare to previous time period"}),bordered:!0,size:"small"})}var $=t("./node_modules/@babel/runtime/helpers/slicedToArray.js"),h=t.n($),S=t("./node_modules/core-js/modules/es.array.map.js"),Y=t("./node_modules/core-js/modules/es.object.entries.js"),J=t("./node_modules/core-js/modules/es.array.iterator.js"),ce=t("./node_modules/core-js/modules/es.object.to-string.js"),Me=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),ke=t("./node_modules/core-js/modules/es.object.keys.js"),H=t("./node_modules/core-js/modules/es.symbol.js"),te=t("./node_modules/core-js/modules/es.array.filter.js"),oe=t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),q=t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),dt=t("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Ct=t("./node_modules/core-js/modules/es.array.slice.js"),Ne=t("./node_modules/core-js/modules/es.function.name.js"),Et=t("./node_modules/core-js/modules/es.array.from.js"),Pt=t("./node_modules/core-js/modules/es.string.iterator.js"),St=t("./node_modules/core-js/modules/es.regexp.exec.js"),Fs=t("./node_modules/core-js/modules/es.symbol.description.js"),Ts=t("./node_modules/core-js/modules/es.symbol.iterator.js"),D=t("./frontend/src/lib/utils.tsx"),je=t("./frontend/src/lib/dayjs.ts"),Ft=t("./frontend/src/lib/logic/featureFlagLogic.ts");function un(s,n){var o=typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(!o){if(Array.isArray(s)||(o=jn(s))||n&&s&&typeof s.length=="number"){o&&(s=o);var r=0,u=function(){};return{s:u,n:function(){return r>=s.length?{done:!0}:{done:!1,value:s[r++]}},e:function(f){throw f},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,d=!1,c;return{s:function(){o=o.call(s)},n:function(){var f=o.next();return i=f.done,f},e:function(f){d=!0,c=f},f:function(){try{!i&&o.return!=null&&o.return()}finally{if(d)throw c}}}}function jn(s,n){if(!!s){if(typeof s=="string")return Tt(s,n);var o=Object.prototype.toString.call(s).slice(8,-1);if(o==="Object"&&s.constructor&&(o=s.constructor.name),o==="Map"||o==="Set")return Array.from(s);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return Tt(s,n)}}function Tt(s,n){(n==null||n>s.length)&&(n=s.length);for(var o=0,r=new Array(n);o<n;o++)r[o]=s[o];return r}function It(s,n){var o=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);n&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(s,u).enumerable})),o.push.apply(o,r)}return o}function At(s){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?It(Object(o),!0).forEach(function(r){N()(s,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(o)):It(Object(o)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(o,r))})}return s}var Lt=Object(l.kea)({props:{},key:Object(_.k)("new"),path:function(n){return["lib","components","IntervalFilter","intervalFilterLogic",n]},connect:function(n){return{actions:[Object(L.c)(n),["setFilters"]],values:[Object(L.c)(n),["filters"],Ft.a,["featureFlags"]]}},actions:function(){return{setInterval:function(o){return{interval:o}}}},listeners:function(n){var o=n.values,r=n.actions,u=n.selectors;return{setInterval:function(d){var c=d.interval;Object(D.qb)(c,o.filters.interval)||r.setFilters(At(At({},o.filters),{},{interval:c}))},setFilters:function(d,c,j,f){var b=d.filters,v=b.date_from,O=b.date_to,m=u.filters(f);if(!(!v||Object(D.qb)(v,m.date_from)&&Object(D.qb)(O,m.date_to))){if(v&&O&&Object(je.a)(b.date_from).isValid()&&Object(je.a)(b.date_to).isValid()){Object(je.a)(O).diff(Object(je.a)(v),"day")<=3?r.setInterval("hour"):Object(je.a)(O).diff(Object(je.a)(v),"month")<=3?r.setInterval("day"):r.setInterval("month");return}var x="day",C=un(D.u),y;try{for(C.s();!(y=C.n()).done;){var U=y.value,P=U.key,W=U.values,F=U.defaultInterval;if(W[0]===v&&W[1]===(O||void 0)&&P!=="Custom"&&F){x=F;break}}}catch(p){C.e(p)}finally{C.f()}r.setInterval(x)}}}},selectors:{interval:[function(s){return[s.filters]},function(s){return s==null?void 0:s.interval}]}}),fn={hour:{label:"Hour",newDateFrom:"dStart"},day:{label:"Day",newDateFrom:void 0},week:{label:"Week",newDateFrom:"-30d"},month:{label:"Month",newDateFrom:"-90d"}};function Ye(s){var n=s.disabled,o=Object(l.useValues)(L.c),r=o.insightProps,u=Object(l.useValues)(Lt(r)),i=u.interval,d=Object(l.useActions)(Lt(r)),c=d.setInterval;return Object(e.jsx)(ee.LemonSelect,{size:"small",disabled:n,value:i||void 0,dropdownMatchSelectWidth:!1,onChange:function(f){f&&c(String(f))},"data-attr":"interval-filter",options:Object.entries(fn).map(function(j){var f=h()(j,2),b=f[0],v=f[1].label;return{value:b,label:v}})})}try{Ye.displayName="IntervalFilter",Ye.__docgenInfo={description:"",displayName:"IntervalFilter",props:{view:{defaultValue:null,description:"",name:"view",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/IntervalFilter/IntervalFilter.tsx#IntervalFilter"]={docgenInfo:Ye.__docgenInfo,name:"IntervalFilter",path:"frontend/src/lib/components/IntervalFilter/IntervalFilter.tsx#IntervalFilter"})}catch(s){}var Oe=t("./node_modules/antd/es/select/index.js"),bn=t("./node_modules/@ant-design/icons/es/icons/FundOutlined.js"),mn=t("./frontend/src/lib/components/SmoothingFilter/smoothings.ts"),Ve=t("./frontend/src/scenes/trends/trendsLogic.ts");function Dt(s,n){var o=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);n&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(s,u).enumerable})),o.push.apply(o,r)}return o}function Rt(s){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?Dt(Object(o),!0).forEach(function(r){N()(s,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(o)):Dt(Object(o)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(o,r))})}return s}function pn(){var s=Object(l.useValues)(L.c),n=s.insightProps,o=Object(l.useValues)(Object(Ve.a)(n)),r=o.filters,u=Object(l.useActions)(Object(Ve.a)(n)),i=u.setFilters;if(!r.interval||!Object(_.i)(r))return null;var d=r.interval,c=r.smoothing_intervals,j=mn.a[d].map(function(f){var b=f.value,v=f.label;return{value:b,label:b===c?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(bn.a,{})," ",v]}):v}});return j.length?Object(e.jsx)(Oe.a,{bordered:!0,value:c||1,dropdownMatchSelectWidth:!1,onChange:function(b){i(Rt(Rt({},r),{},{smoothing_intervals:b}))},"data-attr":"smoothing-filter",options:j},d):Object(e.jsx)(e.Fragment,{})}var Te=t("./frontend/src/lib/constants.tsx"),vn=t("./node_modules/@ant-design/icons/es/icons/CalendarOutlined.js"),Se=t("./node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),Mt=t("./frontend/src/scenes/insights/filters/InsightDateFilter/insightDateFilterLogic.ts"),On=t("./frontend/src/lib/components/DateFilter/DateFilter.tsx");function Nt(s,n){var o=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);n&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(s,u).enumerable})),o.push.apply(o,r)}return o}function Vt(s){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?Nt(Object(o),!0).forEach(function(r){N()(s,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(o)):Nt(Object(o)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(o,r))})}return s}function He(s){var n,o=Object(l.useValues)(L.c),r=o.insightProps,u=Object(l.useValues)(Object(Mt.a)(r)),i=u.dates,d=i.dateFrom,c=i.dateTo,j=Object(l.useActions)(Object(Mt.a)(r)),f=j.setDates;return Object(e.jsx)(On.a,Vt(Vt({},s),{},{dateFrom:(n=d!=null?d:"-7d")!==null&&n!==void 0?n:void 0,dateTo:c!=null?c:void 0,onChange:function(v,O){var m;f(v,O),(m=s.onChange)===null||m===void 0||m.call(s,v,O)}}))}try{He.displayName="InsightDateFilter",He.__docgenInfo={description:"",displayName:"InsightDateFilter",props:{showCustom:{defaultValue:null,description:"",name:"showCustom",required:!1,type:{name:"boolean"}},showRollingRangePicker:{defaultValue:null,description:"",name:"showRollingRangePicker",required:!1,type:{name:"boolean"}},makeLabel:{defaultValue:null,description:"",name:"makeLabel",required:!1,type:{name:"((key: ReactNode) => ReactNode)"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((fromDate: string | null, toDate: string | null) => void)"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},getPopupContainer:{defaultValue:null,description:"",name:"getPopupContainer",required:!1,type:{name:"(() => HTMLElement)"}},dateOptions:{defaultValue:null,description:"",name:"dateOptions",required:!1,type:{name:"DateMappingOption[]"}},isDateFormatted:{defaultValue:null,description:"",name:"isDateFormatted",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/filters/InsightDateFilter/InsightDateFilter.tsx#InsightDateFilter"]={docgenInfo:He.__docgenInfo,name:"InsightDateFilter",path:"frontend/src/scenes/insights/filters/InsightDateFilter/InsightDateFilter.tsx#InsightDateFilter"})}catch(s){}var Ge=t("./frontend/src/scenes/retention/retentionTableLogic.ts"),hn=t("./frontend/src/lib/components/DatePicker.tsx");function Je(s){var n=s.disabled,o=Object(l.useValues)(L.c),r=o.insightProps,u=Object(l.useValues)(Object(Ge.e)(r)),i=u.filters,d=Object(l.useActions)(Object(Ge.e)(r)),c=d.setFilters,j=i.date_to&&Object(je.a)(i.date_to).year()!==Object(je.a)().year()?", YYYY":"";return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(G.a,{title:"Cohorts up to this end date",children:Object(e.jsx)("span",{style:{maxWidth:100},className:"flex inline-flex items-center pl-2",children:Object(e.jsx)(hn.a,{showTime:i.period==="Hour",use12Hours:!0,format:i.period==="Hour"?"MMM D".concat(j,", h a"):"MMM D".concat(j),value:i.date_to?Object(je.a)(i.date_to):void 0,onChange:function(b){return c({date_to:b&&Object(je.a)(b).toISOString()})},allowClear:!0,placeholder:"Today",className:"retention-date-picker",disabled:n})})})})}try{Je.displayName="RetentionDatePicker",Je.__docgenInfo={description:"",displayName:"RetentionDatePicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/RetentionDatePicker.tsx#RetentionDatePicker"]={docgenInfo:Je.__docgenInfo,name:"RetentionDatePicker",path:"frontend/src/scenes/insights/RetentionDatePicker.tsx#RetentionDatePicker"})}catch(s){}var ne=t("./frontend/src/scenes/funnels/funnelLogic.ts"),_e=t("./frontend/src/lib/components/icons.tsx");function Xe(s){var n=s.disabled,o=Object(l.useValues)(L.c),r=o.insightProps,u=Object(l.useValues)(Object(ne.a)(r)),i=u.barGraphLayout,d=Object(l.useActions)(Object(ne.a)(r)),c=d.setFilters,j=[{title:"Graph Display Options",options:[{value:Te.j.vertical,icon:Object(e.jsx)(_e.IconFunnelVertical,{}),label:"Left to right"},{value:Te.j.horizontal,icon:Object(e.jsx)(_e.IconFunnelHorizontal,{}),label:"Top to bottom"}]}];return Object(e.jsx)(ee.LemonSelect,{value:i||Te.j.vertical,onChange:function(b){return b&&c({layout:b})},dropdownMatchSelectWidth:!1,"data-attr":"funnel-bar-layout-selector",disabled:n,options:j,size:"small"})}try{Xe.displayName="FunnelDisplayLayoutPicker",Xe.__docgenInfo={description:"",displayName:"FunnelDisplayLayoutPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/views/Funnels/FunnelDisplayLayoutPicker.tsx#FunnelDisplayLayoutPicker"]={docgenInfo:Xe.__docgenInfo,name:"FunnelDisplayLayoutPicker",path:"frontend/src/scenes/insights/views/Funnels/FunnelDisplayLayoutPicker.tsx#FunnelDisplayLayoutPicker"})}catch(s){}var gn=t("./node_modules/@ant-design/icons/es/icons/BarsOutlined.js"),ut=t("./frontend/src/scenes/paths/pathsLogic.ts"),xn=t("./frontend/src/scenes/userLogic.ts");function Qe(s){var n,o=s.disabled,r=Object(l.useValues)(L.c),u=r.insightProps,i=Object(l.useValues)(Object(ut.b)(u)),d=i.filter,c=Object(l.useActions)(Object(ut.b)(u)),j=c.setFilter,f=Object(l.useValues)(xn.a),b=f.user,v=2,O=b!=null&&(n=b.organization)!==null&&n!==void 0&&n.available_features.includes(a.d.PATHS_ADVANCED)?20:5,m=Array.from(Array.from(Array.from(Array(O+1).keys()).slice(v)),function(x){return{label:"".concat(x," Steps"),value:x}});return Object(e.jsx)(Oe.a,{id:"path-step-filter","data-attr":"path-step-filter",defaultValue:5,value:d.step_limit||ut.a,onSelect:function(C){return j({step_limit:C})},listHeight:440,bordered:!1,dropdownMatchSelectWidth:!0,dropdownAlign:D.a.bottomRight,optionLabelProp:"label",disabled:o,children:m.map(function(x){return Object(e.jsx)(Oe.a.Option,{value:x.value,label:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(gn.a,{})," ",x.label]}),children:x.label},x.value)})})}try{Qe.displayName="PathStepPicker",Qe.__docgenInfo={description:"",displayName:"PathStepPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/views/Paths/PathStepPicker.tsx#PathStepPicker"]={docgenInfo:Qe.__docgenInfo,name:"PathStepPicker",path:"frontend/src/scenes/insights/views/Paths/PathStepPicker.tsx#PathStepPicker"})}catch(s){}var Bt=t("./node_modules/@ant-design/icons/es/icons/PercentageOutlined.js");function Ze(s){var n=s.disabled,o=Object(l.useValues)(L.c),r=o.insightProps,u=Object(l.useValues)(Object(Ge.e)(r)),i=u.retentionReference,d=Object(l.useActions)(Object(Ge.e)(r)),c=d.setRetentionReference;return Object(e.jsx)(Oe.a,{value:i,onChange:c,bordered:!1,dropdownMatchSelectWidth:!1,"data-attr":"reference-selector",optionLabelProp:"label",disabled:n,children:[{value:"total",icon:Object(e.jsx)(Bt.a,{}),label:"Overall cohort"},{value:"previous",icon:Object(e.jsx)(Bt.a,{}),label:"Relative to previous period"}].map(function(j){return Object(e.jsx)(Oe.a.Option,{value:j.value,label:Object(e.jsxs)(e.Fragment,{children:[j.icon," ",j.label]}),children:j.label},j.value)})})}try{Ze.displayName="ReferencePicker",Ze.__docgenInfo={description:"",displayName:"ReferencePicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/filters/ReferencePicker.tsx#ReferencePicker"]={docgenInfo:Ze.__docgenInfo,name:"ReferencePicker",path:"frontend/src/scenes/insights/filters/ReferencePicker.tsx#ReferencePicker"})}catch(s){}var Kt=t("./node_modules/antd/es/tooltip/index.js"),yn=t("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),Fe=t.n(yn),Is=t("./node_modules/core-js/modules/es.set.js"),As=t("./node_modules/core-js/modules/es.array.concat.js"),_n=t("./node_modules/antd/es/input-number/index.js"),jt=t("./node_modules/clsx/dist/clsx.m.js"),Cn=1,Ut=90,En=new Set([5,15,25,50,90]),Pn=[{label:"Auto bins",value:Te.a,display:!0}].concat(Fe()(Array.from(Array.from(Array(Ut+1).keys()),function(s){return{label:"".concat(s," bins"),value:s,display:En.has(s)}})),[{label:"Custom",value:"custom",display:!0}]);function qe(s){var n=s.disabled,o=Object(l.useValues)(L.c),r=o.insightProps,u=Object(l.useValues)(Object(ne.a)(r)),i=u.filters,d=u.numericBinCount,c=Object(l.useActions)(Object(ne.a)(r)),j=c.setBinCount;return Object(e.jsx)(Oe.a,{id:"funnel-bin-filter",dropdownClassName:"funnel-bin-filter-dropdown","data-attr":"funnel-bin-filter",defaultValue:Te.a,value:i.bin_count||Te.a,onSelect:function(b){return j(b)},dropdownRender:function(b){return Object(e.jsxs)(e.Fragment,{children:[b,Object(e.jsxs)("div",{children:[Object(e.jsx)(_n.a,{className:"funnel-bins-custom-picker",size:"middle",min:Cn,max:Ut,value:d,onChange:function(O){var m=typeof O=="string"?parseInt(O):O;m&&j(m)}})," ","bins"]})]})},listHeight:440,bordered:!1,dropdownMatchSelectWidth:!1,dropdownAlign:D.a.bottomRight,optionLabelProp:"label",disabled:n,children:Object(e.jsx)(Oe.a.OptGroup,{label:"Bin Count",children:Pn.map(function(f){return f.value==="custom"?null:Object(e.jsx)(Oe.a.Option,{className:Object(jt.a)({hidden:!f.display}),value:f.value,label:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(me.a,{})," ",f.label]}),children:f.label},f.value)})})})}try{qe.displayName="FunnelBinsPicker",qe.__docgenInfo={description:"",displayName:"FunnelBinsPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/views/Funnels/FunnelBinsPicker.tsx#FunnelBinsPicker"]={docgenInfo:qe.__docgenInfo,name:"FunnelBinsPicker",path:"frontend/src/scenes/insights/views/Funnels/FunnelBinsPicker.tsx#FunnelBinsPicker"})}catch(s){}var ft=t("./frontend/src/scenes/insights/aggregationAxisFormat.ts"),fe=t("./frontend/src/lib/components/LemonButton/index.ts"),Sn=t("./frontend/src/lib/components/LemonDivider/index.ts"),ae=t("./node_modules/react/index.js"),wt=t.n(ae),Fn=t("./frontend/src/lib/hooks/useKeyboardHotkeys.tsx"),bt=t("./frontend/src/lib/utils/eventUsageLogic.ts"),Tn=t("./frontend/src/lib/components/LemonModal/index.ts"),In=t("./frontend/src/lib/forms/Field.tsx"),An=t("./frontend/src/lib/components/LemonInput/LemonInput.tsx");function Wt(s,n){return s==="prefix"?n.aggregation_axis_prefix||"":s==="postfix"&&n.aggregation_axis_postfix||""}function et(s){var n=s.isOpen,o=s.onSave,r=s.formativeElement,u=s.filters,i=s.onClose,d=s.overlayRef,c=Object(ae.useState)(Wt(r,u)),j=h()(c,2),f=j[0],b=j[1];return Object(ae.useEffect)(function(){b(Wt(r,u))},[r]),r===null?null:Object(e.jsx)(Tn.a,{overlayRef:d,isOpen:n,onClose:i,forceAbovePopups:!0,title:"Custom ".concat(r),footer:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(fe.a,{type:"secondary","data-attr":"custom-prefix-cancel",onClick:i,children:"Cancel"}),Object(e.jsx)(fe.a,{type:"primary",onClick:function(){return o(N()({},r,f))},children:"Apply"})]}),children:Object(e.jsx)(In.b,{label:"".concat(Object(D.i)(r),":"),help:Object(e.jsxs)(e.Fragment,{children:["With a ",r,' of "',Object(e.jsx)("strong",{children:f||"$"}),'", 123.45 will be displayed as "',Object(e.jsxs)("strong",{children:[r==="prefix"?f||"$":"","123.45",r==="postfix"?f||"$":""]}),'"']}),children:Object(e.jsx)(An.a,{value:f,onChange:b,autoFocus:!0})})})}try{et.displayName="CustomUnitModal",et.__docgenInfo={description:"",displayName:"CustomUnitModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!0,type:{name:"(hx: HandleUnitChange) => void"}},formativeElement:{defaultValue:null,description:"",name:"formativeElement",required:!0,type:{name:'"prefix" | "postfix" | null'}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"Partial<FilterType>"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},overlayRef:{defaultValue:null,description:"",name:"overlayRef",required:!0,type:{name:"(instance: HTMLDivElement | null) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/UnitPicker/CustomUnitModal.tsx#CustomUnitModal"]={docgenInfo:et.__docgenInfo,name:"CustomUnitModal",path:"frontend/src/lib/components/UnitPicker/CustomUnitModal.tsx#CustomUnitModal"})}catch(s){}function kt(s,n){var o=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);n&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(s,u).enumerable})),o.push.apply(o,r)}return o}function zt(s){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?kt(Object(o),!0).forEach(function(r){N()(s,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(o)):kt(Object(o)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(o,r))})}return s}var Ln=ft.a.reduce(function(s,n){return s[n.value]=n.label,s},{});function tt(s){var n=s.filters,o=s.setFilters,r=Object(l.useActions)(bt.e),u=r.reportAxisUnitsChanged,i=Object(ae.useState)(!1),d=h()(i,2),c=d[0],j=d[1],f=Object(ae.useState)(n.aggregation_axis_format||void 0),b=h()(f,2),v=b[0],O=b[1],m=Object(ae.useState)(null),x=h()(m,2),C=x[0],y=x[1],U=Object(ae.useRef)(null);Object(Fn.a)({escape:{action:function(){y(null),j(!1)}}},[]);var P=function(p){var g=p.format,I=p.prefix,R=p.postfix;O(g),o(zt(zt({},n),{},{aggregation_axis_format:g,aggregation_axis_prefix:I,aggregation_axis_postfix:R})),u({format:g,prefix:I,postfix:R,display:n.display,unitIsSet:!!I||!!R||g&&g!=="numeric"}),j(!1),y(null)},W=Object(ae.useMemo)(function(){var F,p,g="None";return v&&(g=Ln[v]),(F=n.aggregation_axis_prefix)!==null&&F!==void 0&&F.length&&(g="Prefix: ".concat(n.aggregation_axis_prefix)),(p=n.aggregation_axis_postfix)!==null&&p!==void 0&&p.length&&(g="Postfix: ".concat(n.aggregation_axis_postfix)),g},[v,n]);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("span",{children:Object(ft.b)(n.display)}),Object(e.jsx)(et,{formativeElement:C,isOpen:C!==null,onSave:P,filters:n,onClose:function(){return y(null)},overlayRef:function(p){return U.current=p}}),Object(e.jsx)(fe.b,{onClick:function(){return j(!c)},size:"small",type:"secondary",status:"stealth","data-attr":"chart-aggregation-axis-format",popup:{onClickOutside:function(){return j(!1)},additionalRefs:[U],visible:c,overlay:Object(e.jsxs)(e.Fragment,{children:[ft.a.map(function(F,p){var g=F.value,I=F.label;return Object(e.jsx)(fe.a,{onClick:function(){return P({format:g})},status:"stealth",active:g===v,fullWidth:!0,children:I},p)}),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Sn.a,{}),Object(e.jsxs)(fe.a,{onClick:function(){return y("prefix")},status:"stealth",active:!!n.aggregation_axis_prefix,fullWidth:!0,children:["Custom prefix",n.aggregation_axis_prefix?": ".concat(n.aggregation_axis_prefix,"..."):"..."]}),Object(e.jsxs)(fe.a,{onClick:function(){return y("postfix")},status:"stealth",active:!!n.aggregation_axis_postfix,fullWidth:!0,children:["Custom postfix",n.aggregation_axis_postfix?": ".concat(n.aggregation_axis_postfix,"..."):"..."]})]})]}),placement:"bottom-start",actionable:!0,closeOnClickInside:!1},children:W})]})}try{tt.displayName="UnitPicker",tt.__docgenInfo={description:"",displayName:"UnitPicker",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"TrendsFilterType"}},setFilters:{defaultValue:null,description:"",name:"setFilters",required:!0,type:{name:"(filters: Partial<TrendsFilterType>, insightMode?: ItemMode | undefined) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/UnitPicker/UnitPicker.tsx#UnitPicker"]={docgenInfo:tt.__docgenInfo,name:"UnitPicker",path:"frontend/src/lib/components/UnitPicker/UnitPicker.tsx#UnitPicker"})}catch(s){}var Ie,Ae,Dn=function(n){return Object(_.d)(n)?n.funnel_viz_type===a.A.Trends:Object(_.g)(n)||Object(_.f)(n)?!1:(Object(_.i)(n)||Object(_.h)(n))&&(!n.display||!Te.n.includes(n.display))},Rn=(Ie={},N()(Ie,"".concat(a.E.TRENDS),!0),N()(Ie,"".concat(a.E.STICKINESS),!0),N()(Ie,"".concat(a.E.LIFECYCLE),!0),N()(Ie,"".concat(a.E.FUNNELS),!0),N()(Ie,"".concat(a.E.RETENTION),!1),N()(Ie,"".concat(a.E.PATHS),!0),Ie),Mn=(Ae={},N()(Ae,"".concat(a.E.TRENDS),!0),N()(Ae,"".concat(a.E.STICKINESS),!0),N()(Ae,"".concat(a.E.LIFECYCLE),!1),N()(Ae,"".concat(a.E.FUNNELS),!1),N()(Ae,"".concat(a.E.RETENTION),!1),N()(Ae,"".concat(a.E.PATHS),!1),Ae),Nn=function(n){var o,r;return!n.actions&&!n.events||((o=n.actions)===null||o===void 0?void 0:o.length)===0&&((r=n.events)===null||r===void 0?void 0:r.length)===0};function Ce(s){return Object(e.jsx)("span",{className:"space-x-2 flex items-center text-sm",children:s.children})}function nt(s){var n=s.filters,o=s.disableTable,r=Object(_.d)(n),u=Object(_.f)(n),i=Object(l.useValues)(Ft.a),d=i.featureFlags,c=Object(l.useActions)(L.c),j=c.setFilters;return Object(e.jsxs)("div",{className:"flex justify-between items-center flex-wrap","data-attr":"insight-filters",children:[Object(e.jsxs)("div",{className:"flex items-center space-x-2 flex-wrap my-2",children:[n.insight&&Rn[n.insight]&&!o&&Object(e.jsxs)(Ce,{children:[Object(e.jsx)("span",{children:"Date range"}),Object(e.jsx)(He,{disabled:r&&Nn(n),makeLabel:function(b){return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(vn.a,{})," ",b,b=="All time"&&Object(e.jsx)(Kt.a,{title:"Only events dated after 2015 will be shown",children:Object(e.jsx)(Se.a,{className:"info-indicator"})})]})}})]}),Dn(n)&&Object(e.jsxs)(Ce,{children:[Object(e.jsxs)("span",{children:[Object(e.jsx)("span",{className:"hide-lte-md",children:"grouped "}),"by"]}),Object(e.jsx)(Ye,{view:n.insight||a.E.TRENDS})]}),Object(_.i)(n)&&!n.breakdown_type&&!n.compare&&(!n.display||n.display===a.j.ActionsLineGraph)&&d[Te.h.SMOOTHING_INTERVAL]?Object(e.jsx)(Ce,{children:Object(e.jsx)(pn,{})}):null,Object(_.g)(n)&&Object(e.jsxs)(Ce,{children:[Object(e.jsx)(Je,{}),Object(e.jsx)(Ze,{})]}),u&&Object(e.jsx)(Ce,{children:Object(e.jsx)(Qe,{})}),n.insight&&Mn[n.insight]&&Object(e.jsx)(Ce,{children:Object(e.jsx)(K,{})})]}),Object(e.jsxs)("div",{className:"flex items-center space-x-4 flex-wrap my-2",children:[Object(_.b)(n)&&Object(e.jsxs)(e.Fragment,{children:[Object(_.i)(n)&&Object(e.jsx)(Ce,{children:Object(e.jsx)(tt,{filters:n,setFilters:j})}),Object(e.jsxs)(Ce,{children:[Object(e.jsx)("span",{children:"Chart type"}),Object(e.jsx)(le,{filters:n})]})]}),r&&n.funnel_viz_type===a.A.Steps&&Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(Ce,{children:Object(e.jsx)(Xe,{})})}),r&&n.funnel_viz_type===a.A.TimeToConvert&&Object(e.jsx)(Ce,{children:Object(e.jsx)(qe,{})})]})]})}try{nt.displayName="InsightDisplayConfig",nt.__docgenInfo={description:"",displayName:"InsightDisplayConfig",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},activeView:{defaultValue:null,description:"",name:"activeView",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}},insightMode:{defaultValue:null,description:"",name:"insightMode",required:!0,type:{name:"enum",value:[{value:'"edit"'},{value:'"view"'},{value:'"subscriptions"'},{value:'"sharing"'}]}},disableTable:{defaultValue:null,description:"",name:"disableTable",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightDisplayConfig.tsx#InsightDisplayConfig"]={docgenInfo:nt.__docgenInfo,name:"InsightDisplayConfig",path:"frontend/src/scenes/insights/InsightDisplayConfig.tsx#InsightDisplayConfig"})}catch(s){}var mt=t("./node_modules/antd/es/button/index.js"),Vn=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),st=t.n(Vn),Bn=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/funnels/FunnelCanvasLabel.scss"),$t=t.n(Bn),pt={};pt.insert="head",pt.singleton=!1;var Ls=st()($t.a,pt),Ds=$t.a.locals||{},Rs=t("./node_modules/core-js/modules/es.array.find.js"),Yt=t("./frontend/src/lib/components/EntityFilterInfo.tsx");function Ht(){var s,n=Object(l.useValues)(L.c),o=n.insightProps,r=Object(l.useValues)(Object(ne.a)(o)),u=r.filters,i=r.numberOfSeries,d=r.areFiltersValid,c=r.filterSteps,j=Object(l.useActions)(Object(ne.a)(o)),f=j.changeStepRange;if(u.funnel_viz_type===a.A.Steps)return null;var b=function(C,y){f(C,y)},v=d?Array.from(Array(Math.max(i)).keys()).slice(0,-1):[0],O=d?Array.from(Array(Math.max(i)).keys()).slice(((s=u.funnel_from_step)!==null&&s!==void 0?s:0)+1):[1],m=function(C){return C.map(function(y){var U=c.find(function(P){return P.order===y});return U?Object(e.jsx)(Oe.a.Option,{value:y,label:"Step ".concat(y+1),children:Object(e.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(e.jsxs)("span",{style:{marginRight:4},children:["Step ",y+1,":"]}),Object(e.jsx)(Yt.a,{filter:U})]})},y):null})};return Object(e.jsxs)(re.a,{className:"funnel-options-inputs",children:[Object(e.jsx)("span",{className:"text-muted-alt",children:"from"}),Object(e.jsx)(Oe.a,{disabled:!d,dropdownMatchSelectWidth:!1,dropdownAlign:D.a.bottomLeft,"data-attr":"funnel-header-steps-funnel_from_step-selector",optionLabelProp:"label",value:u.funnel_from_step||0,onChange:function(C){return b(C,u.funnel_to_step)},style:{marginLeft:4,marginRight:4},children:m(v)}),Object(e.jsx)("span",{className:"text-muted-alt",children:"to"}),Object(e.jsx)(Oe.a,{disabled:!d,dropdownMatchSelectWidth:!1,dropdownAlign:D.a.bottomLeft,"data-attr":"funnel-header-steps-funnel_to_step-selector",optionLabelProp:"label",value:u.funnel_to_step||Math.max(i-1,1),onChange:function(C){return b(u.funnel_from_step,C)},style:{marginLeft:4,marginRight:4},children:m(O)})]})}function Kn(){var s=Object(l.useValues)(L.c),n=s.insightProps,o=s.activeView,r=Object(l.useValues)(Object(ne.a)(n)),u=r.conversionMetrics,i=r.filters,d=r.aggregationTargetLabel,c=Object(l.useActions)(Object(ge.a)(n)),j=c.setChartFilter;if(o!==a.E.FUNNELS)return null;var f=[].concat(Fe()(i.funnel_viz_type===a.A.Steps?[Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("span",{className:"text-muted-alt mr-1",children:[Object(e.jsx)(G.a,{title:"Overall conversion rate for all ".concat(d.plural," on the entire funnel."),children:Object(e.jsx)(Se.a,{className:"info-indicator left"})}),"Total conversion rate:"]}),Object(e.jsx)("span",{className:"l4",children:Object(D.sb)(u.totalRate,2,!0)})]})]:[]),Fe()(i.funnel_viz_type!==a.A.Trends?[Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("span",{className:"text-muted-alt",children:[Object(e.jsx)(G.a,{title:"Average (arithmetic mean) of the total time each ".concat(d.singular," spent in the entire funnel."),children:Object(e.jsx)(Se.a,{className:"info-indicator left"})}),"Average time to convert"," "]}),i.funnel_viz_type===a.A.TimeToConvert&&Object(e.jsx)(Ht,{}),Object(e.jsx)("span",{className:"text-muted-alt mr-1",children:":"}),Object(e.jsx)(mt.a,{type:"link",onClick:function(){return j(a.A.TimeToConvert)},disabled:i.funnel_viz_type===a.A.TimeToConvert,children:Object(e.jsx)("span",{className:"l4",children:Object(D.O)(u.averageTime)})})]})]:[]),Fe()(i.funnel_viz_type===a.A.Trends?[Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("span",{className:"text-muted-alt",children:"Conversion rate "}),Object(e.jsx)(Ht,{})]})]:[]));return Object(e.jsx)(re.a,{className:"funnel-canvas-label",align:"middle",children:f.map(function(b,v){return Object(e.jsxs)(wt.a.Fragment,{children:[v>0&&Object(e.jsx)("span",{style:{margin:"2px 8px",borderLeft:"1px solid var(--border)",height:14}}),b]},v)})})}var Un=t("./frontend/src/lib/hooks/usePeriodicRerender.ts"),Gt=3;function wn(){var s=Object(l.useValues)(L.c),n=s.lastRefresh,o=Object(l.useActions)(L.c),r=o.loadResults;return Object(Un.a)(15e3),Object(e.jsxs)("div",{className:"text-muted-alt",style:{height:32,display:"flex",alignItems:"center"},children:["Computed ",n?Object(je.a)(n).fromNow():"a while ago",Object(e.jsx)("span",{style:{padding:"0 4px"},children:"\u2022"}),Object(e.jsx)(Kt.a,{title:Object(e.jsxs)(e.Fragment,{children:["Insights can be refreshed",Object(e.jsx)("br",{}),"every ",Gt," minutes."]}),children:Object(e.jsx)(mt.a,{size:"small",type:"link",onClick:function(){return r(!0)},disabled:!!n&&Object(je.a)().subtract(Gt-.5,"minutes").isBefore(n),style:{padding:0},children:Object(e.jsx)("span",{style:{fontSize:14},children:"Refresh"})})})]})}var vt=t("./frontend/src/scenes/trends/viz/index.ts"),Jt=t("./frontend/src/scenes/insights/views/InsightsTable/InsightsTable.tsx");try{InsightsTable.displayName="InsightsTable",InsightsTable.__docgenInfo={description:"",displayName:"InsightsTable",props:{isLegend:{defaultValue:{value:"false"},description:"Whether this is just a legend instead of standalone insight viz. Default: false.",name:"isLegend",required:!1,type:{name:"boolean"}},embedded:{defaultValue:{value:"false"},description:"Whether this is table is embedded in another card or whether it should be a card of its own. Default: false.",name:"embedded",required:!1,type:{name:"boolean"}},filterKey:{defaultValue:null,description:"Key for the entityFilterLogic",name:"filterKey",required:!0,type:{name:"string"}},canEditSeriesNameInline:{defaultValue:{value:"false"},description:"",name:"canEditSeriesNameInline",required:!1,type:{name:"boolean"}},canCheckUncheckSeries:{defaultValue:{value:"true"},description:"(Un)checking series updates the insight via the API, so it should be disabled if updates aren't desired.",name:"canCheckUncheckSeries",required:!1,type:{name:"boolean"}},isMainInsightView:{defaultValue:{value:"false"},description:"",name:"isMainInsightView",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/views/InsightsTable/index.tsx#InsightsTable"]={docgenInfo:InsightsTable.__docgenInfo,name:"InsightsTable",path:"frontend/src/scenes/insights/views/InsightsTable/index.tsx#InsightsTable"})}catch(s){}var Xt=t("./frontend/src/scenes/insights/insightSceneLogic.tsx"),Wn=t("./frontend/src/scenes/insights/views/WorldMap/index.ts"),kn=t("./frontend/src/scenes/insights/views/BoldNumber/index.ts");function Be(s){var n=s.view,o=Object(l.useValues)(Xt.a),r=o.insightMode,u=Object(l.useValues)(L.c),i=u.insightProps,d=Object(l.useValues)(Object(Ve.a)(i)),c=d.filters,j=d.loadMoreBreakdownUrl,f=d.breakdownValuesLoading,b=Object(l.useActions)(Object(Ve.a)(i)),v=b.loadMoreBreakdownValues,O=Object(_.i)(c)||Object(_.h)(c)?c.display:null,m=function(){if(!O||O===a.j.ActionsLineGraph||O===a.j.ActionsLineGraphCumulative||O===a.j.ActionsBar)return Object(e.jsx)(vt.b,{});if(O===a.j.BoldNumber)return Object(e.jsx)(kn.a,{});if(O===a.j.ActionsTable)return Object(e.jsx)(l.BindLogic,{logic:Ve.a,props:{dashboardItemId:null,view:n,filters:null},children:Object(e.jsx)(Jt.b,{embedded:!0,filterKey:"trends_".concat(n),canEditSeriesNameInline:r===a.F.Edit,isMainInsightView:!0})});if(O===a.j.ActionsPie)return Object(e.jsx)(vt.c,{});if(O===a.j.ActionsBarValue)return Object(e.jsx)(vt.a,{});if(O===a.j.WorldMap)return Object(e.jsx)(Wn.a,{})};return Object(e.jsxs)(e.Fragment,{children:[(c.actions||c.events)&&Object(e.jsx)("div",{className:O!==a.j.ActionsTable&&O!==a.j.WorldMap&&O!==a.j.BoldNumber?"trends-insights-container":void 0,children:m()}),c.breakdown&&j&&Object(e.jsxs)("div",{className:"my-4 flex flex-col items-center",children:[Object(e.jsxs)("div",{className:"text-muted mb-2",children:["For readability, ",Object(e.jsx)("b",{children:"not all breakdown values are displayed"}),". Click below to load them."]}),Object(e.jsx)(ee.LemonButton,{onClick:v,loading:f,size:"small",type:"secondary",children:"Load more breakdown values"})]})]})}try{Be.displayName="TrendInsight",Be.__docgenInfo={description:"",displayName:"TrendInsight",props:{view:{defaultValue:null,description:"",name:"view",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/trends/Trends.tsx#TrendInsight"]={docgenInfo:Be.__docgenInfo,name:"TrendInsight",path:"frontend/src/scenes/trends/Trends.tsx#TrendInsight"})}catch(s){}var zn=t("./frontend/src/scenes/retention/RetentionContainer.tsx"),$n=t("./frontend/src/scenes/paths/Paths.tsx"),ze=t("./frontend/src/scenes/insights/EmptyStates/index.ts");function Yn(){var s=Object(l.useValues)(L.c),n=s.activeView;return n!==a.E.PATHS?null:Object(e.jsx)(re.a,{className:"funnel-canvas-label",align:"middle",children:Object(e.jsx)(wt.a.Fragment,{children:Object(e.jsx)("span",{className:"text-muted-alt",children:"Large path items are shown by default. View smaller items by hovering over a node"})})})}var Qt=t("./frontend/src/lib/components/InsightLegend/InsightLegend.tsx"),Ms=t("./node_modules/core-js/modules/es.object.from-entries.js"),Ns=t("./node_modules/core-js/modules/es.array.flat-map.js"),Vs=t("./node_modules/core-js/modules/es.array.unscopables.flat-map.js"),Hn=t("./frontend/src/lib/components/LemonTable/index.ts"),rt=t("./frontend/src/scenes/funnels/funnelUtils.ts"),Ot=t("./frontend/src/scenes/insights/views/Funnels/funnelStepTableUtils.tsx"),Gn=t("./frontend/src/models/cohortsModel.ts"),Zt=t("./frontend/src/lib/components/LemonCheckbox/index.ts"),qt=t("./frontend/src/lib/components/Lettermark/Lettermark.tsx"),ht=t("./frontend/src/lib/components/LemonRow/index.ts"),Ke=t("./frontend/src/scenes/funnels/ValueInspectorButton.tsx"),Jn=t("./frontend/src/lib/colors.ts"),Xn=t("./frontend/src/models/propertyDefinitionsModel.ts"),Qn=t("./frontend/src/scenes/insights/utils.tsx");function Zn(){var s=Object(l.useValues)(L.c),n=s.insightProps,o=Object(ne.a)(n),r=Object(l.useValues)(o),u=r.insightLoading,i=r.filters,d=r.steps,c=r.flattenedBreakdowns,j=r.hiddenLegendKeys,f=r.visibleStepsWithConversionMetrics,b=r.isOnlySeries,v=Object(l.useActions)(o),O=v.setHiddenById,m=v.toggleVisibilityByBreakdown,x=v.openPersonsModalForSeries,C=Object(l.useValues)(Gn.a),y=C.cohorts,U=Object(l.useValues)(Xn.a),P=U.formatPropertyValueForDisplay,W=c==null?void 0:c.every(function(p){return!j[Object(rt.l)(p.breakdown_value)]}),F=[{children:[{title:b?"Breakdown":Object(e.jsx)(Zt.a,{checked:W||(c!=null&&c.some(function(p){return!j[Object(rt.l)(p.breakdown_value)]})?"indeterminate":!1),onChange:function(){O(Object.fromEntries(f.flatMap(function(){return c.map(function(g){return[Object(rt.l)(g.breakdown_value),W]})})))},label:Object(e.jsx)("span",{className:"font-bold",children:"Breakdown"}),size:"small"}),dataIndex:"breakdown_value",render:function(g,I){var R,V=((R=I.breakdown_value)===null||R===void 0?void 0:R.length)==1?I.breakdown_value[0]:I.breakdown_value,B=Object(Qn.d)(y,P,V,I.breakdown,i.breakdown_type);return b?Object(e.jsx)("span",{className:"font-medium",children:B}):Object(e.jsx)(Zt.a,{checked:!j[Object(rt.l)(I.breakdown_value)],onChange:function(){return m(I.breakdown_value)},label:B})}},{title:Object(e.jsxs)(e.Fragment,{children:["Total",Object(e.jsx)("br",{}),"conversion"]}),render:function(g,I){var R,V;return Object(D.sb)((R=I==null||(V=I.conversionRates)===null||V===void 0?void 0:V.total)!==null&&R!==void 0?R:0,2,!0)},align:"right"}]}].concat(Fe()(d.map(function(p,g){return{title:Object(e.jsx)(ht.a,{icon:Object(e.jsx)(qt.a,{name:g+1,color:qt.b.Gray}),style:{font:"inherit",padding:0},size:"small",children:Object(e.jsx)(Yt.a,{filter:Object(Ot.a)(p)})}),children:[{title:g===0?"Entered":"Converted",render:function(R,V){var B,A,E=(B=V.steps)===null||B===void 0?void 0:B[g];return E&&Object(e.jsx)(Ke.a,{onClick:function(){return x({step:p,series:E,converted:!0})},style:{padding:0},children:Object(D.P)((A=E.count)!==null&&A!==void 0?A:0)})},align:"right"}].concat(Fe()(g===0?[]:[{title:"Dropped\xA0off",render:function(R,V){var B,A,E=(B=V.steps)===null||B===void 0?void 0:B[g];return E&&Object(e.jsx)(Ke.a,{onClick:function(){return x({step:p,series:E,converted:!1})},style:{padding:0},children:Object(D.P)((A=E.droppedOffFromPrevious)!==null&&A!==void 0?A:0)})},align:"right"}]),[{title:Object(e.jsxs)(e.Fragment,{children:["Conversion",Object(e.jsx)("br",{}),"so\xA0far"]}),render:function(R,V){var B,A,E,k,z,T,M=Object(Ot.b)(V,p.order);return M!=null&&M.total?Object(e.jsx)(ht.a,{className:"significance-highlight",tooltip:"Significantly different from other breakdown values",icon:Object(e.jsx)(_e.IconFlag,{}),size:"small",children:Object(D.sb)((B=(A=V.steps)===null||A===void 0||(E=A[p.order])===null||E===void 0?void 0:E.conversionRates.total)!==null&&B!==void 0?B:0,2,!0)}):Object(D.sb)((k=(z=V.steps)===null||z===void 0||(T=z[p.order])===null||T===void 0?void 0:T.conversionRates.total)!==null&&k!==void 0?k:0,2,!0)},align:"right"}],Fe()(g===0?[]:[{title:Object(e.jsxs)(e.Fragment,{children:["Conversion",Object(e.jsx)("br",{}),"from\xA0previous"]}),render:function(R,V){var B,A,E,k,z,T,M=Object(Ot.b)(V,p.order);return!(M!=null&&M.total)&&M!==null&&M!==void 0&&M.fromPrevious?Object(e.jsx)(ht.a,{className:"significance-highlight",tooltip:"Significantly different from other breakdown values",icon:Object(e.jsx)(_e.IconFlag,{}),size:"small",children:Object(D.sb)((B=(A=V.steps)===null||A===void 0||(E=A[p.order])===null||E===void 0?void 0:E.conversionRates.fromPrevious)!==null&&B!==void 0?B:0,2,!0)}):Object(D.sb)((k=(z=V.steps)===null||z===void 0||(T=z[p.order])===null||T===void 0?void 0:T.conversionRates.fromPrevious)!==null&&k!==void 0?k:0,2,!0)},align:"right"},{title:Object(e.jsxs)(e.Fragment,{children:["Median",Object(e.jsx)("br",{}),"time"]}),render:function(R,V){var B,A;return((B=V.steps)===null||B===void 0||(A=B[p.order])===null||A===void 0?void 0:A.median_conversion_time)!=null?Object(D.O)(V.steps[p.order].median_conversion_time,3):"\u2013"},align:"right",width:0,className:"whitespace-nowrap"},{title:Object(e.jsxs)(e.Fragment,{children:["Average",Object(e.jsx)("br",{}),"time"]}),render:function(R,V){var B,A;return((B=V.steps)===null||B===void 0||(A=B[p.order])===null||A===void 0?void 0:A.average_conversion_time)!=null?Object(D.O)(V.steps[p.order].average_conversion_time,3):"\u2013"},align:"right",width:0,className:"whitespace-nowrap"}]))}})));return Object(e.jsx)(Hn.a,{dataSource:c,columns:F,loading:u,rowKey:"breakdownIndex",rowStatus:function(g){return g.significant?"highlighted":null},rowRibbonColor:function(g){var I;return Object(Jn.d)((I=g==null?void 0:g.breakdownIndex)!==null&&I!==void 0?I:0)}})}var qn=t("./frontend/src/lib/components/Animation/Animation.tsx"),es=t("./frontend/src/lib/animations/animations.ts"),ts=t("./node_modules/@ant-design/icons/es/icons/CommentOutlined.js"),ns=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/FunnelCorrelation.scss"),en=t.n(ns),gt={};gt.insert="head",gt.singleton=!1;var Bs=st()(en.a,gt),Ks=en.a.locals||{},ss=t("./node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),rs=t("./frontend/src/lib/components/PayCard/PayCard.tsx"),os=t("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),Us=t("./node_modules/core-js/modules/es.number.is-integer.js"),ws=t("./node_modules/core-js/modules/es.number.constructor.js"),Ws=t("./node_modules/core-js/modules/es.number.to-fixed.js"),ks=t("./node_modules/core-js/modules/es.string.split.js"),as=t("./node_modules/antd/es/spin/index.js"),xt=t("./node_modules/antd/es/table/index.js"),is=t("./node_modules/antd/lib/table/Column.js"),be=t.n(is),tn=t("./node_modules/@ant-design/icons/es/icons/RiseOutlined.js"),nn=t("./node_modules/@ant-design/icons/es/icons/FallOutlined.js"),sn=t("./node_modules/@ant-design/icons/es/icons/EllipsisOutlined.js"),ls=t("./node_modules/antd/lib/checkbox/Checkbox.js"),ot=t.n(ls),Ue=t("./frontend/src/lib/components/PropertyKeyInfo.tsx"),cs=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/FunnelCorrelationTable.scss"),rn=t.n(cs),yt={};yt.insert="head",yt.singleton=!1;var zs=st()(rn.a,yt),$s=rn.a.locals||{},ds=t("./frontend/src/lib/components/VisibilitySensor/visibilitySensorLogic.tsx");function $e(s){var n=s.id,o=s.offset,r=s.children,u=Object(l.useActions)(Object(ds.a)({id:n,offset:o})),i=u.scrolling,d=Object(ae.useRef)(null);return Object(ae.useEffect)(function(){var c=d.current;return document.addEventListener("scroll",function(){return c&&i(c)}),function(){return document.removeEventListener("scroll",function(){return c&&i(c)})}},[d.current]),Object(e.jsx)("div",{ref:d,children:r})}try{$e.displayName="VisibilitySensor",$e.__docgenInfo={description:"",displayName:"VisibilitySensor",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},offset:{defaultValue:null,description:"",name:"offset",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/VisibilitySensor/VisibilitySensor.tsx#VisibilitySensor"]={docgenInfo:$e.__docgenInfo,name:"VisibilitySensor",path:"frontend/src/lib/components/VisibilitySensor/VisibilitySensor.tsx#VisibilitySensor"})}catch(s){}var on=t("./frontend/src/lib/components/Popup/Popup.tsx"),us=t("./node_modules/antd/es/modal/index.js"),js=t("./node_modules/@ant-design/icons/es/icons/CheckCircleFilled.js"),fs=t("./node_modules/@ant-design/icons/es/icons/MinusCircleOutlined.js"),bs=t("./node_modules/@ant-design/icons/es/icons/CloseCircleOutlined.js"),ms=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/CorrelationMatrix.scss"),an=t.n(ms),_t={};_t.insert="head",_t.singleton=!1;var Ys=st()(an.a,_t),Hs=an.a.locals||{},ps=t("./frontend/src/lib/components/Spinner/Spinner.tsx"),ln=t("./frontend/src/lib/components/Link.tsx"),vs=t("./frontend/src/lib/components/InlineMessage/InlineMessage.tsx");function Os(){var s=Object(l.useValues)(L.c),n=s.insightProps,o=Object(ne.a)(n),r=Object(l.useValues)(o),u=r.correlationsLoading,i=r.funnelCorrelationDetails,d=r.parseDisplayNameForCorrelation,c=r.correlationMatrixAndScore,j=Object(l.useActions)(o),f=j.setFunnelCorrelationDetails,b=j.openCorrelationPersonsModal,v=(i==null?void 0:i.result_type)===a.w.Events?"event":"property",O=(i==null?void 0:i.result_type)===a.w.Events?"performed event":"have property",m=Object(e.jsx)(e.Fragment,{});if(i){var x=d(i),C=x.first_value,y=x.second_value;m=Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Ue.a,{value:C}),y!==void 0&&Object(e.jsxs)(e.Fragment,{children:[" :: ",Object(e.jsx)(Ue.a,{value:y,disablePopover:!0})]})]})}var U=c.correlationScore,P=c.truePositive,W=c.falsePositive,F=c.trueNegative,p=c.falseNegative,g=c.correlationScoreStrength,I=g==="strong"?Object(e.jsx)(js.a,{style:{color:"var(--success)"}}):g==="moderate"?Object(e.jsx)(fs.a,{style:{color:"var(--warning)"}}):Object(e.jsx)(bs.a,{style:{color:"var(--danger)"}}),R=function(){return f(null)};return Object(e.jsx)(us.a,{className:"correlation-matrix",visible:!!i,onCancel:R,destroyOnClose:!0,footer:Object(e.jsx)(mt.a,{onClick:R,children:"Dismiss"}),width:600,title:"Correlation details",children:Object(e.jsx)("div",{className:"correlation-table-wrapper",children:u?Object(e.jsx)("div",{className:"mt-4 text-center",children:Object(e.jsx)(ps.a,{className:"text-4xl"})}):i?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("p",{className:"text-muted-alt mb-4",children:["The table below displays the correlation details for users who ",O," ",Object(e.jsx)("b",{children:m}),"."]}),Object(e.jsxs)("table",{children:[Object(e.jsxs)("thead",{children:[Object(e.jsx)("tr",{className:"table-title",children:Object(e.jsx)("td",{colSpan:3,children:"Results matrix"})}),Object(e.jsxs)("tr",{children:[Object(e.jsx)("td",{children:(i==null?void 0:i.result_type)===a.w.Events?"Performed event":"Has property"}),Object(e.jsx)("td",{children:"Success"}),Object(e.jsx)("td",{children:"Dropped off"})]})]}),Object(e.jsxs)("tbody",{children:[Object(e.jsxs)("tr",{children:[Object(e.jsx)("td",{className:"horizontal-header",children:"Yes"}),Object(e.jsxs)("td",{children:[Object(e.jsx)(G.a,{title:"True positive (TP) - Percentage of users who ".concat(O," and completed the funnel."),children:Object(e.jsx)("div",{className:"percentage",children:P?Object(D.sb)(P/(P+W)):"0.00%"})}),P===0?"0 users":Object(e.jsx)(ln.a,{onClick:function(){b(i,!0)},children:Object(D.tb)(P,"user",void 0,!0)})]}),Object(e.jsxs)("td",{children:[Object(e.jsx)("div",{className:"percentage",children:Object(e.jsx)(G.a,{title:"False negative (FN) - Percentage of users who ".concat(O," and did not complete the funnel."),children:p?Object(D.sb)(p/(p+F)):"0.00%"})}),p===0?"0 users":Object(e.jsx)(ln.a,{onClick:function(){b(i,!1)},children:Object(D.tb)(p,"user",void 0,!0)})]})]}),Object(e.jsxs)("tr",{children:[Object(e.jsx)("td",{className:"horizontal-header",children:"No"}),Object(e.jsxs)("td",{children:[Object(e.jsx)("div",{className:"percentage",children:Object(e.jsx)(G.a,{title:"False positive (FP) - Percentage of users who did not ".concat(O," and completed the funnel."),children:W?Object(D.sb)(W/(P+W)):"0.00%"})}),Object(D.tb)(W,"user",void 0,!0)]}),Object(e.jsxs)("td",{children:[Object(e.jsx)("div",{className:"percentage",children:Object(e.jsx)(G.a,{title:"True negative (TN) - Percentage of users who did not ".concat(O," and did not complete the funnel."),children:F?Object(D.sb)(F/(p+F)):"0.00%"})}),Object(D.tb)(F,"user",void 0,!0)]})]}),Object(e.jsxs)("tr",{children:[Object(e.jsx)("td",{className:"horizontal-header"}),Object(e.jsx)("td",{children:Object(e.jsx)("b",{children:"100%"})}),Object(e.jsx)("td",{children:Object(e.jsx)("b",{children:"100%"})})]})]})]}),Object(e.jsxs)("div",{className:"mt-4 text-center",children:[Object(D.i)((i==null?void 0:i.result_type)||"")," ",Object(e.jsx)("b",{children:m})," ","has a"," ",(i==null?void 0:i.correlation_type)===a.x.Success?Object(e.jsxs)("b",{className:"text-success",children:["positive"," ",Object(e.jsx)(G.a,{title:"Positive correlation means this ".concat(v," is correlated with a successful conversion."),children:Object(e.jsx)(Se.a,{className:"cursor-pointer"})})]}):Object(e.jsxs)("b",{className:"text-danger",children:["negative"," ",Object(e.jsx)(G.a,{title:"Negative correlation means this ".concat(v," is correlated with an unsuccessful conversion (user dropped off)."),children:Object(e.jsx)(Se.a,{className:"cursor-pointer"})})]})," ","correlation score of"," ",Object(e.jsx)("b",{style:{color:g==="strong"?"var(--success)":g==="moderate"?"var(--warning)":"var(--danger)"},children:Object(e.jsx)(G.a,{title:"This ".concat(v," has ").concat(g," correlation."),children:Object(e.jsxs)("span",{style:{cursor:"pointer"},children:[I," ",U.toFixed(3)]})})})]})]}):Object(e.jsx)("div",{children:Object(e.jsx)(vs.a,{type:"danger",children:"We could not load the details for this correlation value. Please recreate your funnel and try again."})})})})}function hs(){var s=Object(l.useValues)(L.c),n=s.insightProps,o=Object(ne.a)(n),r=Object(l.useValues)(o),u=r.steps,i=r.correlationValues,d=r.correlationTypes,c=r.eventHasPropertyCorrelations,j=r.eventWithPropertyCorrelationsValues,f=r.parseDisplayNameForCorrelation,b=r.correlationsLoading,v=r.eventWithPropertyCorrelationsLoading,O=r.nestedTableExpandedKeys,m=r.correlationPropKey,x=r.filters,C=r.aggregationTargetLabel,y=Object(l.useActions)(o),U=y.setCorrelationTypes,P=y.loadEventWithPropertyCorrelations,W=y.addNestedTableExpandedKey,F=y.removeNestedTableExpandedKey,p=y.openCorrelationPersonsModal,g=y.loadCorrelations,I=Object(l.useActions)(bt.e),R=I.reportCorrelationInteraction;Object(ae.useEffect)(function(){g({})},[x]);var V=function(T){d?d.includes(T)?U(d.filter(function(M){return M!==T})):U([].concat(Fe()(d),[T])):U([T])},B=function(T){var M=function(ct){return ct<10&&!Number.isInteger(ct)?ct.toFixed(1):ct.toFixed()},se=T.correlation_type===a.x.Success,X=f(T),De=X.first_value,it=X.second_value;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("h4",{children:[se?Object(e.jsx)(tn.a,{style:{color:"green"}}):Object(e.jsx)(nn.a,{style:{color:"red"}})," ",Object(e.jsx)(Ue.a,{value:De}),it!==void 0&&Object(e.jsxs)(e.Fragment,{children:[" :: ",Object(e.jsx)(Ue.a,{value:it,disablePopover:!0})]})]}),Object(e.jsxs)("div",{children:[Object(D.i)(C.plural)," ",x.aggregation_group_type_index!=null?"that":"who"," converted were"," ",Object(e.jsx)("mark",{children:Object(e.jsxs)("b",{children:[M(T.odds_ratio),"x ",se?"more":"less"," likely"]})})," ","to"," ",T.result_type===a.w.EventWithProperties?"have this event property":"do this event"]}),Object(e.jsx)(Os,{})]})},A=function(T){return Object(e.jsx)(Ke.a,{onClick:function(){p(T,!0)},children:T.success_count})},E=function(T){return Object(e.jsx)(Ke.a,{onClick:function(){p(T,!1)},children:T.failure_count})},k=function(T){return v?Object(e.jsxs)("div",{className:"nested-properties-loading",children:[Object(e.jsx)(as.a,{}),Object(e.jsx)("h3",{children:"Loading correlation results"}),Object(e.jsx)("p",{children:"This process can take up to 20 seconds. "})]}):Object(e.jsxs)("div",{children:[Object(e.jsx)("h4",{style:{paddingLeft:16},children:"Correlated properties"}),Object(e.jsxs)(xt.a,{dataSource:j[T],rowKey:function(se){return se.event.event},className:"nested-properties-table",scroll:{x:"max-content"},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(se,X){return R(a.w.EventWithProperties,"pagination change",{page:se,page_size:X})}},children:[Object(e.jsx)(be.a,{title:"Property",render:function(se,X){return B(X)},align:"left"},"eventName"),Object(e.jsx)(be.a,{title:"Completed",render:function(se,X){return A(X)},width:90,align:"center"},"success_count"),Object(e.jsx)(be.a,{title:"Dropped off",render:function(se,X){return E(X)},width:120,align:"center"},"failure_count"),Object(e.jsx)(be.a,{title:"",render:function(se,X){return Object(e.jsx)(cn,{record:X})},align:"center",width:30},"actions")]})]})};return u.length>1?Object(e.jsx)($e,{id:m,offset:152,children:Object(e.jsxs)("div",{className:"funnel-correlation-table",children:[Object(e.jsxs)("span",{className:"funnel-correlation-header",children:[Object(e.jsxs)("span",{className:"table-header",children:[Object(e.jsx)(_e.IconSelectEvents,{style:{marginRight:4,fontSize:24,opacity:.5}}),"CORRELATED EVENTS"]}),Object(e.jsxs)("span",{className:"table-options",children:[Object(e.jsx)("p",{className:"title",children:"CORRELATION"}),Object(e.jsx)("div",{className:"tab-btn ant-btn",style:{paddingTop:"1px",paddingBottom:"1px",borderTopRightRadius:0,borderBottomRightRadius:0},onClick:function(){return V(a.x.Success)},children:Object(e.jsx)(ot.a,{checked:d.includes(a.x.Success),style:{pointerEvents:"none"},children:"Success"})}),Object(e.jsx)("div",{className:"tab-btn ant-btn",style:{marginRight:"8px",paddingTop:"1px",paddingBottom:"1px",borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:function(){return V(a.x.Failure)},children:Object(e.jsx)(ot.a,{checked:d.includes(a.x.Failure),style:{pointerEvents:"none"},children:"Dropoff"})})]})]}),Object(e.jsxs)(xt.a,{dataSource:i,loading:b,size:"small",scroll:{x:"max-content"},rowKey:function(T){return T.event.event},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(){return R(a.w.Events,"load more")}},expandable:{expandedRowRender:function(T){return k(T.event.event)},expandedRowKeys:O,rowExpandable:function(){return x.aggregation_group_type_index===void 0},expandIcon:function(T){var M=T.expanded,se=T.onExpand,X=T.record,De=T.expandable;return De?M?Object(e.jsx)(G.a,{title:"Collapse",children:Object(e.jsx)("div",{style:{cursor:"pointer",opacity:.5,fontSize:24},onClick:function(lt){F(X.event.event),se(X,lt)},children:Object(e.jsx)(_e.IconUnfoldLess,{})})}):Object(e.jsx)(G.a,{title:"Expand to see correlated properties for this event",children:Object(e.jsx)("div",{style:{cursor:"pointer",opacity:.5,fontSize:24},onClick:function(lt){!c(X.event.event)&&P(X.event.event),W(X.event.event),se(X,lt)},children:Object(e.jsx)(_e.IconUnfoldMore,{})})}):null}},children:[Object(e.jsx)(be.a,{title:"Event",render:function(T,M){return B(M)},align:"left",ellipsis:!0},"eventName"),Object(e.jsx)(be.a,{title:Object(e.jsxs)("div",{className:"flex items-center",children:["Completed",Object(e.jsx)(G.a,{title:"".concat(Object(D.i)(C.plural)," ").concat(x.aggregation_group_type_index!=null?"that":"who"," performed the event and completed the entire funnel."),children:Object(e.jsx)(Se.a,{className:"column-info"})})]}),render:function(T,M){return A(M)},width:90,align:"center"},"success_count"),Object(e.jsx)(be.a,{title:Object(e.jsxs)("div",{className:"flex items-center",children:["Dropped off",Object(e.jsx)(G.a,{title:Object(e.jsxs)(e.Fragment,{children:[Object(D.i)(C.plural)," ",x.aggregation_group_type_index!=null?"that":"who"," ","performed the event and did ",Object(e.jsx)("b",{children:"not complete"})," the entire funnel."]}),children:Object(e.jsx)(Se.a,{className:"column-info"})})]}),render:function(T,M){return E(M)},width:120,align:"center"},"failure_count"),Object(e.jsx)(be.a,{title:"",render:function(T,M){return Object(e.jsx)(cn,{record:M})},width:30},"actions")]})]})}):null}var cn=function(n){var o=n.record,r=Object(l.useValues)(L.c),u=r.insightProps,i=Object(ne.a)(u),d=Object(l.useActions)(i),c=d.excludeEventPropertyFromProject,j=d.excludeEventFromProject,f=d.setFunnelCorrelationDetails,b=Object(l.useValues)(i),v=b.isEventPropertyExcluded,O=b.isEventExcluded,m=o.event.event.split("::"),x=Object(ae.useState)(!1),C=h()(x,2),y=C[0],U=C[1];return Object(e.jsx)(re.a,{style:{justifyContent:"flex-end"},children:Object(e.jsx)(on.a,{visible:y,actionable:!0,onClickOutside:function(){return U(!1)},overlay:Object(e.jsxs)(e.Fragment,{children:[o.result_type===a.w.Events&&Object(e.jsx)(fe.a,{onClick:function(){return f(o)},fullWidth:!0,status:"stealth",children:"View correlation details"}),Object(e.jsx)(fe.a,{disabled:o.result_type===a.w.EventWithProperties?v(m[1]):O(m[0]),onClick:function(){return o.result_type===a.w.EventWithProperties?c(m[0],m[1]):j(m[0])},fullWidth:!0,title:"Remove this event from any correlation analysis report in this project.",status:"stealth",children:"Exclude event from project"})]}),children:Object(e.jsx)(fe.a,{status:"stealth",onClick:function(){return U(!y)},children:Object(e.jsx)(sn.a,{style:{color:"var(--primary)",fontSize:24},className:"insight-dropdown-actions"})})})})},gs=t("./frontend/src/lib/components/PropertyNamesSelect/PropertyNamesSelect.tsx");function xs(){var s=Object(l.useValues)(L.c),n=s.insightProps,o=Object(ne.a)(n),r=Object(l.useValues)(o),u=r.steps,i=r.propertyCorrelationValues,d=r.propertyCorrelationTypes,c=r.excludedPropertyNames,j=r.parseDisplayNameForCorrelation,f=r.propertyCorrelationsLoading,b=r.inversePropertyNames,v=r.propertyNames,O=r.correlationPropKey,m=r.allProperties,x=r.filters,C=r.aggregationTargetLabel,y=Object(l.useActions)(o),U=y.setPropertyCorrelationTypes,P=y.setPropertyNames,W=y.openCorrelationPersonsModal,F=y.loadPropertyCorrelations,p=Object(l.useActions)(bt.e),g=p.reportCorrelationInteraction;Object(ae.useEffect)(function(){v.length===0&&P(m),F({})},[x]);var I=function(E){d?d.includes(E)?U(d.filter(function(k){return k!==E})):U([].concat(Fe()(d),[E])):U([E])},R=function(E){return Object(e.jsx)(Ke.a,{onClick:function(){W(E,!0)},children:E.success_count})},V=function(E){return Object(e.jsx)(Ke.a,{onClick:function(){W(E,!1)},children:E.failure_count})},B=function(E){var k=function(De){return De<10&&!Number.isInteger(De)?De.toFixed(1):De.toFixed()},z=E.correlation_type===a.x.Success,T=j(E),M=T.first_value,se=T.second_value;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("h4",{children:[z?Object(e.jsx)(tn.a,{style:{color:"green"}}):Object(e.jsx)(nn.a,{style:{color:"red"}})," ",Object(e.jsx)(Ue.a,{value:M}),se!==void 0&&Object(e.jsxs)(e.Fragment,{children:[" :: ",Object(e.jsx)(Ue.a,{value:se,disablePopover:!0})]})]}),Object(e.jsxs)("div",{children:[Object(D.i)(C.plural)," ",x.aggregation_group_type_index!=null?"that":"who"," converted were"," ",Object(e.jsx)("mark",{children:Object(e.jsxs)("b",{children:[k(E.odds_ratio),"x ",z?"more":"less"," likely"]})})," ","to have this property value"]})]})};return u.length>1?Object(e.jsx)($e,{offset:150,id:"".concat(O,"-properties"),children:Object(e.jsxs)("div",{className:"funnel-correlation-table",children:[Object(e.jsxs)(re.a,{className:"funnel-correlation-header",children:[Object(e.jsxs)(ie.a,{className:"table-header",children:[Object(e.jsx)(_e.IconSelectProperties,{style:{marginRight:4,opacity:.5,fontSize:24}}),"CORRELATED PROPERTIES"]}),Object(e.jsxs)(ie.a,{className:"table-options",children:[Object(e.jsx)(re.a,{style:{display:"contents"},children:m.length>0&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("p",{className:"title",children:"PROPERTIES "}),Object(e.jsx)(gs.a,{value:new Set(v),onChange:function(E){return P(E)},allProperties:b(c||[])})]})}),Object(e.jsxs)(re.a,{style:{display:"contents"},children:[Object(e.jsx)("p",{className:"title",style:{marginLeft:8},children:"CORRELATION"}),Object(e.jsx)("div",{className:"tab-btn ant-btn",style:{paddingTop:"1px",paddingBottom:"1px",borderTopRightRadius:0,borderBottomRightRadius:0},onClick:function(){return I(a.x.Success)},children:Object(e.jsx)(ot.a,{checked:d.includes(a.x.Success),style:{pointerEvents:"none"},children:"Success"})}),Object(e.jsx)("div",{className:"tab-btn ant-btn",style:{marginRight:"8px",paddingTop:"1px",paddingBottom:"1px",borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:function(){return I(a.x.Failure)},children:Object(e.jsx)(ot.a,{checked:d.includes(a.x.Failure),style:{pointerEvents:"none"},children:"Dropoff"})})]})]})]}),Object(e.jsxs)(xt.a,{dataSource:i,loading:f,scroll:{x:"max-content"},size:"small",rowKey:function(E){return E.event.event},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(E,k){return g(a.w.Properties,"pagination change",{page:E,page_size:k})}},children:[Object(e.jsx)(be.a,{title:"".concat(Object(D.i)(C.singular)," property"),render:function(E,k){return B(k)},align:"left"},"propertName"),Object(e.jsx)(be.a,{title:Object(e.jsxs)("div",{className:"flex items-center",children:["Completed",Object(e.jsx)(G.a,{title:"".concat(Object(D.i)(C.plural)," ").concat(x.aggregation_group_type_index!=null?"that":"who"," have this property and completed the entire funnel."),children:Object(e.jsx)(Se.a,{className:"column-info"})})]}),render:function(E,k){return R(k)},width:90,align:"center"},"success_count"),Object(e.jsx)(be.a,{title:Object(e.jsxs)("div",{className:"flex items-center",children:["Dropped off",Object(e.jsx)(G.a,{title:Object(e.jsxs)(e.Fragment,{children:[Object(D.i)(C.plural)," ",x.aggregation_group_type_index!=null?"that":"who"," have this property and did ",Object(e.jsx)("b",{children:"not complete"})," the entire funnel."]}),children:Object(e.jsx)(Se.a,{className:"column-info"})})]}),render:function(E,k){return V(k)},width:120,align:"center"},"failure_count"),Object(e.jsx)(be.a,{title:"",render:function(E,k){return Object(e.jsx)(ys,{record:k})},align:"center",width:30},"actions")]})]})}):null}var ys=function(n){var o=n.record,r=Object(l.useValues)(L.c),u=r.insightProps,i=Object(ne.a)(u),d=Object(l.useActions)(i),c=d.excludePropertyFromProject,j=d.setFunnelCorrelationDetails,f=Object(l.useValues)(i),b=f.isPropertyExcludedFromProject,v=(o.event.event||"").split("::")[0],O=Object(ae.useState)(!1),m=h()(O,2),x=m[0],C=m[1];return Object(e.jsx)(re.a,{style:{justifyContent:"flex-end"},children:Object(e.jsx)(on.a,{visible:x,actionable:!0,onClickOutside:function(){return C(!1)},overlay:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(fe.a,{onClick:function(){return j(o)},fullWidth:!0,status:"stealth",children:"View correlation details"}),Object(e.jsx)(fe.a,{disabled:b(v),onClick:function(){return c(v)},fullWidth:!0,title:"Remove this property from any correlation analysis report in this project.",status:"stealth",children:"Exclude property from project"})]}),children:Object(e.jsx)(fe.a,{status:"stealth",onClick:function(){return C(!x)},children:Object(e.jsx)(sn.a,{style:{color:"var(--primary)",fontSize:24},className:"insight-dropdown-actions"})})})})},_s=function(){var n,o=Object(l.useValues)(L.c),r=o.insightProps,u=Object(l.useValues)(Object(ne.a)(r)),i=u.isSkewed,d=u.steps,c=u.correlationFeedbackHidden,j=u.correlationDetailedFeedbackVisible,f=u.correlationFeedbackRating,b=u.correlationAnalysisAvailable,v=u.aggregationTargetLabel,O=Object(l.useActions)(Object(ne.a)(r)),m=O.sendCorrelationAnalysisFeedback,x=O.hideSkewWarning,C=O.hideCorrelationAnalysisFeedback,y=O.setCorrelationFeedbackRating,U=O.setCorrelationDetailedFeedback,P=Object(l.useValues)(os.a),W=P.preflight,F=Object(ae.useRef)(null);return d.length<=1?null:!b&&!(W!=null&&(n=W.instance_preferences)!==null&&n!==void 0&&n.disable_paid_fs)?Object(e.jsx)(rs.a,{identifier:a.d.CORRELATION_ANALYSIS,title:"Get a deeper understanding of why your ".concat(v.plural," are not converting"),caption:"Correlation analysis automatically finds signals for why ".concat(v.plural," are converting or dropping off.")}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h2",{style:{margin:"1rem 0"},children:"Correlation analysis"}),Object(e.jsxs)("div",{className:"funnel-correlation",children:[i&&Object(e.jsxs)(he.a,{className:"skew-warning",children:[Object(e.jsxs)("h4",{children:[Object(e.jsx)(_e.IconFeedbackWarning,{style:{fontSize:24,marginRight:4,color:"var(--warning)"}})," ","Adjust your funnel definition to improve correlation analysis",Object(e.jsx)(ss.a,{className:"close-button",onClick:x})]}),Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:"Tips for adjusting your funnel:"}),Object(e.jsxs)("ol",{children:[Object(e.jsx)("li",{children:"Adjust your first funnel step to be more specific. For example, choose a page or an event that occurs less frequently."}),Object(e.jsx)("li",{children:"Choose an event that happens more frequently for subsequent funnels steps."})]})]})]}),Object(e.jsx)(hs,{}),!c&&Object(e.jsxs)("div",{className:"border rounded p-4 space-y-2 mt-4",children:[Object(e.jsxs)("div",{className:"flex items-center justify-between",children:[Object(e.jsxs)("h4",{className:"text-muted-alt",children:[Object(e.jsx)(ts.a,{style:{marginRight:4}}),"Was this correlation analysis report useful?"]}),Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[!!f&&Object(e.jsx)("i",{className:"text-success mr-2",children:"Thanks for your feedback!"}),[[5,"\u{1F60D}"],[4,"\u{1F600}"],[3,"\u{1F634}"],[2,"\u{1F614}"],[1,"\u{1F44E}"]].map(function(p,g){return Object(e.jsx)(ee.LemonButton,{active:f===p[0],onClick:function(){f===p[0]?y(0):(y(p[0]),setTimeout(function(){var R;return(R=F.current)===null||R===void 0?void 0:R.focus()},100))},children:p[1]},g)}),Object(e.jsx)(ee.LemonButton,{icon:Object(e.jsx)(_e.IconClose,{}),onClick:C,status:"stealth"})]})]}),j?Object(e.jsx)(e.Fragment,{children:Object(e.jsxs)("form",{onSubmit:m,className:"space-y-2",children:[Object(e.jsx)(ee.LemonTextArea,{onBlur:function(g){return U(g.target.value)},placeholder:"Optional. Help us by sharing details around your experience...",ref:F,onPressCmdEnter:function(){var g;(g=F.current)===null||g===void 0||g.blur(),m()}}),Object(e.jsx)("div",{className:"flex justify-end",children:Object(e.jsx)(ee.LemonButton,{"data-attr":"correlation-analysis-share-feedback",type:"primary",htmlType:"submit",children:"Share feedback"})})]})}):null]}),Object(e.jsx)(xs,{})]})]})},Cs=t("./frontend/src/scenes/funnels/Funnel.tsx");function Es(){var s=Object(l.useValues)(L.c),n=s.insightProps,o=Object(l.useValues)(Object(ne.a)(n)),r=o.isValidFunnel,u=o.insightLoading,i=o.areFiltersValid,d=r&&i||u;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)("div",{className:Object(jt.a)("funnel-insights-container",{"non-empty-state":d}),children:Object(e.jsx)(Cs.a,{})})})}var Ps=t("./frontend/src/lib/components/ExportButton/ExportButton.tsx"),Ss=t("./frontend/src/lib/components/AlertMessage/index.ts"),Le,dn=(Le={},N()(Le,"".concat(a.E.TRENDS),Object(e.jsx)(Be,{view:a.E.TRENDS})),N()(Le,"".concat(a.E.STICKINESS),Object(e.jsx)(Be,{view:a.E.STICKINESS})),N()(Le,"".concat(a.E.LIFECYCLE),Object(e.jsx)(Be,{view:a.E.LIFECYCLE})),N()(Le,"".concat(a.E.FUNNELS),Object(e.jsx)(Es,{})),N()(Le,"".concat(a.E.RETENTION),Object(e.jsx)(zn.a,{})),N()(Le,"".concat(a.E.PATHS),Object(e.jsx)($n.a,{})),Le);function at(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{disableHeader:!1,disableTable:!1,disableCorrelationTable:!1,disableLastComputation:!1},n=s.disableHeader,o=s.disableTable,r=s.disableCorrelationTable,u=s.disableLastComputation,i=Object(l.useValues)(Xt.a),d=i.insightMode,c=Object(l.useValues)(L.c),j=c.insightProps,f=c.canEditInsight,b=c.insightLoading,v=c.activeView,O=c.loadedView,m=c.filters,x=c.showTimeoutMessage,C=c.showErrorMessage,y=c.exporterResourceParams,U=c.isUsingSessionAnalysis,P=Object(l.useValues)(Object(ne.a)(j)),W=P.areFiltersValid,F=P.isValidFunnel,p=P.areExclusionFiltersValid,g=P.correlationAnalysisAvailable,I=function(){if(v!==O||b&&!x)return Object(e.jsx)("div",{className:"text-center",children:Object(e.jsx)(qn.a,{type:es.a.LaptopHog})});if(O===a.E.FUNNELS){if(!W)return Object(e.jsx)(ze.b,{actionable:d===a.F.Edit||o});if(!p)return Object(e.jsx)(ze.a,{});if(!F&&!b)return Object(e.jsx)(ze.c,{})}return C?Object(e.jsx)(ze.d,{}):x?Object(e.jsx)(ze.e,{isLoading:b}):null}();function R(){return Object(_.d)(m)&&!C&&!x&&W&&F&&m.funnel_viz_type===a.A.Steps&&!o?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h2",{className:"my-4 mx-0",children:"Detailed results"}),Object(e.jsx)(Zn,{})]}):Object(_.i)(m)&&(!m.display||(m==null?void 0:m.display)!==a.j.ActionsTable&&(m==null?void 0:m.display)!==a.j.ActionsBarValue)&&!o?Object(e.jsxs)(e.Fragment,{children:[y&&Object(e.jsxs)("div",{className:"flex items-center justify-between my-4 mx-0",children:[Object(e.jsx)("h2",{className:"m-0",children:"Detailed results"}),Object(e.jsx)(G.a,{title:"Export this table in CSV format",placement:"left",children:Object(e.jsx)(Ps.a,{type:"secondary",status:"primary",items:[{export_format:a.s.CSV,export_context:y}]})})]}),Object(e.jsx)(l.BindLogic,{logic:Ve.a,props:j,children:Object(e.jsx)(Jt.b,{isLegend:!0,filterKey:Object(_.i)(m)?"trends_".concat(v):"",canEditSeriesNameInline:Object(_.i)(m)&&d===a.F.Edit,canCheckUncheckSeries:f})})]}):null}return Object(e.jsxs)(e.Fragment,{children:[U?Object(e.jsx)("div",{className:"mb-4",children:Object(e.jsxs)(Ss.a,{type:"info",children:["When using sessions and session properties, events without session IDs will be excluded from the set of results."," ",Object(e.jsx)("a",{href:"https://posthog.com/docs/user-guides/sessions",children:"Learn more about sessions."})]})}):null,Object(e.jsx)(he.a,{title:n?null:Object(e.jsx)(nt,{activeView:v,insightMode:d,filters:m,disableTable:!!o}),"data-attr":"insights-graph",className:"insights-graph-container",children:Object(e.jsxs)("div",{children:[Object(e.jsxs)(re.a,{className:Object(jt.a)("insights-graph-header",{funnels:Object(_.d)(m)}),align:"middle",justify:"space-between",children:[!u&&Object(e.jsx)(ie.a,{children:Object(e.jsx)(wn,{})}),Object(e.jsxs)(ie.a,{children:[Object(_.d)(m)?Object(e.jsx)(Kn,{}):null,Object(_.f)(m)?Object(e.jsx)(Yn,{}):null,Object(e.jsx)(Qt.b,{})]})]}),I||(Object(_.b)(m)&&m.show_legend?Object(e.jsxs)(re.a,{className:"insights-graph-container-row",wrap:!1,children:[Object(e.jsx)(ie.a,{className:"insights-graph-container-row-left",children:dn[v]}),Object(e.jsx)(ie.a,{className:"insights-graph-container-row-right",children:Object(e.jsx)(Qt.a,{})})]}):dn[v])]})}),R(),!r&&g&&v===a.E.FUNNELS&&Object(e.jsx)(_s,{})]})}try{at.displayName="InsightContainer",at.__docgenInfo={description:"",displayName:"InsightContainer",props:{disableHeader:{defaultValue:null,description:"",name:"disableHeader",required:!1,type:{name:"boolean"}},disableTable:{defaultValue:null,description:"",name:"disableTable",required:!1,type:{name:"boolean"}},disableCorrelationTable:{defaultValue:null,description:"",name:"disableCorrelationTable",required:!1,type:{name:"boolean"}},disableLastComputation:{defaultValue:null,description:"",name:"disableLastComputation",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightContainer.tsx#InsightContainer"]={docgenInfo:at.__docgenInfo,name:"InsightContainer",path:"frontend/src/scenes/insights/InsightContainer.tsx#InsightContainer"})}catch(s){}},"./frontend/src/scenes/insights/filters/InsightDateFilter/insightDateFilterLogic.ts":function(Q,w,t){"use strict";t.d(w,"a",function(){return ve});var Z=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),N=t.n(Z),he=t("./node_modules/core-js/modules/es.array.iterator.js"),re=t.n(he),ie=t("./node_modules/core-js/modules/es.object.to-string.js"),we=t.n(ie),Ee=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),l=t.n(Ee),ge=t("./node_modules/core-js/modules/es.object.keys.js"),We=t.n(ge),xe=t("./node_modules/core-js/modules/es.symbol.js"),Re=t.n(xe),me=t("./node_modules/core-js/modules/es.array.filter.js"),pe=t.n(me),de=t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),ue=t.n(de),Pe=t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),a=t.n(Pe),L=t("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),G=t.n(L),ye=t("./node_modules/kea/lib/index.esm.js"),ee=t("./frontend/src/scenes/insights/insightLogic.ts"),_=t("./frontend/src/scenes/insights/sharedUtils.ts");function e(K,$){var h=Object.keys(K);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(K);$&&(S=S.filter(function(Y){return Object.getOwnPropertyDescriptor(K,Y).enumerable})),h.push.apply(h,S)}return h}function le(K){for(var $=1;$<arguments.length;$++){var h=arguments[$]!=null?arguments[$]:{};$%2?e(Object(h),!0).forEach(function(S){N()(K,S,h[S])}):Object.getOwnPropertyDescriptors?Object.defineProperties(K,Object.getOwnPropertyDescriptors(h)):e(Object(h)).forEach(function(S){Object.defineProperty(K,S,Object.getOwnPropertyDescriptor(h,S))})}return K}var ve=Object(ye.kea)({props:{},key:Object(_.k)("new"),path:function($){return["scenes","insights","InsightDateFilter","insightDateFilterLogic",$]},connect:function($){return{actions:[Object(ee.c)($),["setFilters"]],values:[Object(ee.c)($),["filters"]]}},actions:function(){return{setDates:function(h,S){return{dateFrom:h,dateTo:S}}}},selectors:{dates:[function(K){return[K.filters]},function(K){return{dateFrom:(K==null?void 0:K.date_from)||null,dateTo:(K==null?void 0:K.date_to)||null}}]},listeners:function($){var h=$.actions,S=$.values;return{setDates:function(J){var ce=J.dateFrom,Me=J.dateTo;h.setFilters(le(le({},S.filters),{},{date_from:ce||null,date_to:Me||null}))}}}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/lib/components/InlineMessage/InlineMessage.scss":function(Q,w,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");w=Z(!1),w.push([Q.i,".inline-message{background-color:var(--bg-mid);border-radius:var(--radius);padding:.5rem 1rem;font-weight:var(--font-medium);display:flex;align-items:center;color:var(--primary-alt)}.inline-message.danger{background-color:var(--danger-highlight);color:var(--danger)}.inline-message.closable{padding-right:.5rem}.inline-message.hidden{display:none}.inline-message .inline-icon{margin-right:6px;display:flex;align-items:center}.inline-message .inline-main{flex-grow:1}.inline-message .closable{color:var(--muted);align-self:flex-start;padding-left:1rem;cursor:pointer}",""]),Q.exports=w},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/funnels/FunnelCanvasLabel.scss":function(Q,w,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");w=Z(!1),w.push([Q.i,".insights-graph-header.funnels{border-bottom:1px solid var(--border)}.insights-graph-header.funnels .funnel-canvas-label .ant-btn-link{padding:0}.insights-graph-header.funnels .funnel-canvas-label .ant-btn-link:disabled{cursor:default;color:var(--default)}.insights-graph-header.funnels .funnel-canvas-label .funnel-options-label{padding:4px}.insights-graph-header.funnels .funnel-canvas-label .funnel-options-inputs{align-items:center;padding:4px}",""]),Q.exports=w},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/CorrelationMatrix.scss":function(Q,w,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");w=Z(!1),w.push([Q.i,".correlation-matrix .ant-modal-body{display:flex;justify-content:center}.correlation-matrix .correlation-table-wrapper table{border-radius:var(--radius);border:1px solid var(--border);border-collapse:separate;border-spacing:0;margin:0 auto}.correlation-matrix .correlation-table-wrapper table td{padding:.5rem 1rem;border-left:1px solid var(--border);border-top:1px solid var(--border);text-align:center}.correlation-matrix .correlation-table-wrapper table td .percentage{font-weight:700;padding-bottom:.25rem}.correlation-matrix .correlation-table-wrapper table td:first-child{border-left:none}.correlation-matrix .correlation-table-wrapper table .table-title{color:var(--muted-alt)}.correlation-matrix .correlation-table-wrapper table .table-title td{border-top:none}.correlation-matrix .correlation-table-wrapper table .horizontal-header,.correlation-matrix .correlation-table-wrapper table thead{font-weight:700;background-color:var(--antd-table-background-dark);text-transform:uppercase;color:var(--muted)}.correlation-matrix .correlation-table-wrapper table tbody td:not(.horizontal-header){text-align:right}",""]),Q.exports=w},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/FunnelCorrelation.scss":function(Q,w,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");w=Z(!1),w.push([Q.i,".funnel-correlation{margin-bottom:3rem}.funnel-correlation .skew-warning{margin-top:1rem;line-height:2em;border:1px solid var(--warning)}.funnel-correlation .skew-warning .ant-card-body{padding:.5rem 1rem}.funnel-correlation .skew-warning h4{font-size:1.1em;display:flex;align-items:center;border-bottom:1px solid var(--border);padding:.5rem 1rem;margin-left:-1rem;margin-right:-1rem;position:relative}.funnel-correlation .skew-warning h4 .close-button{position:absolute;right:16px;color:var(--muted)!important;cursor:pointer}.funnel-correlation .skew-warning b{padding-bottom:.5rem;font-weight:var(--font-medium)}",""]),Q.exports=w},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/FunnelCorrelationTable.scss":function(Q,w,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");w=Z(!1),w.push([Q.i,".funnel-correlation-table{margin-top:1rem;border:1px solid var(--border);border-radius:var(--radius)}.funnel-correlation-table .ant-table thead th{border-bottom:1px solid var(--border)}.funnel-correlation-table .funnel-correlation-header{background:#f2f2f2;display:flex;align-self:stretch;justify-content:space-between;align-content:space-between;border-top-left-radius:var(--radius);border-top-right-radius:var(--radius);padding-bottom:5px}.funnel-correlation-table .funnel-correlation-header .table-header{font-style:normal;font-weight:700;font-size:11px;line-height:16px;padding-bottom:4px;display:flex;align-items:center;letter-spacing:.02em;text-transform:uppercase;color:var(--default);margin-left:1rem;margin-top:.5rem}.funnel-correlation-table .funnel-correlation-header .table-options{display:flex;flex-grow:1;justify-content:flex-end;align-items:center;margin-top:5px}.funnel-correlation-table .funnel-correlation-header .table-options .title{font-family:Inter;font-style:normal;font-weight:600;font-size:11px;line-height:16px;display:flex;align-items:center;letter-spacing:.02em;text-transform:uppercase;margin:5px;color:rgba(0,0,0,.5)}.funnel-correlation-table .column-info{color:var(--muted-alt);cursor:pointer;padding-left:4px}.funnel-correlation-table .nested-properties-table{margin:1rem;border:1px solid var(--border);border-radius:var(--radius)}.funnel-correlation-table .nested-properties-table thead th{border-bottom:1px solid var(--border)}.funnel-correlation-table .nested-properties-loading{text-align:center;padding:2rem 0}.funnel-correlation-table .nested-properties-loading h3{font-size:1rem;font-weight:700;margin-bottom:0}.funnel-correlation-table .nested-properties-loading h3 p{color:var(--muted-alt)}",""]),Q.exports=w}}]);
