(window.webpackJsonp=window.webpackJsonp||[]).push([[232,239],{"./frontend/src/scenes/cohorts/Cohort.tsx":function(te,C,e){"use strict";e.r(C),e.d(C,"scene",function(){return We}),e.d(C,"Cohort",function(){return ve});var O=e("./node_modules/core-js/modules/es.object.keys.js"),a=e("./node_modules/core-js/modules/es.symbol.js"),F=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),b=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),$=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),pe=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),oe=e.n(pe),z=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),M=e.n(z),he=e("./node_modules/core-js/modules/es.array.concat.js"),ne=e("./node_modules/core-js/modules/es.object.to-string.js"),ae=e("./node_modules/core-js/modules/es.regexp.to-string.js"),le=e("./node_modules/core-js/modules/es.array.filter.js"),N=e("./node_modules/core-js/modules/es.function.name.js"),J=e("./node_modules/core-js/modules/es.array.map.js"),Q=e("./node_modules/react/index.js"),t=e.n(Q),u=e("./node_modules/kea/lib/index.esm.js"),H=e("./node_modules/kea-forms/lib/index.js"),_=e("./node_modules/antd/es/divider/index.js"),m=e("./node_modules/antd/es/row/index.js"),f=e("./node_modules/antd/es/col/index.js"),v=e("./frontend/src/types.ts"),d=e("./frontend/src/lib/constants.tsx"),I=e("./node_modules/@ant-design/icons/es/icons/PlusOutlined.js"),Y=e("./node_modules/antd/lib/upload/Dragger.js"),q=e.n(Y),X=e("./frontend/src/scenes/persons/Persons.tsx"),ge=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),D=e.n(ge),ce=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),fe=e.n(ce),y=e("./node_modules/@babel/runtime/regenerator/index.js"),P=e.n(y),ee=e("./node_modules/core-js/modules/es.symbol.description.js"),ie=e("./node_modules/core-js/modules/es.object.entries.js"),V=e("./node_modules/core-js/modules/es.array.find-index.js"),Z=e("./node_modules/core-js/modules/es.array.iterator.js"),R=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),A=e("./frontend/src/lib/api.ts"),G=e("./frontend/src/models/cohortsModel.ts"),se=e("./frontend/src/lib/utils.tsx"),W=e("./frontend/src/scenes/persons/personsLogic.ts"),x=e("./frontend/src/lib/components/lemonToast.tsx"),S=e("./frontend/src/scenes/urls.ts"),de=e("./node_modules/kea-router/lib/index.js"),ue=e("./node_modules/kea-loaders/lib/index.js");function xe(o,n){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);n&&(r=r.filter(function(p){return Object.getOwnPropertyDescriptor(o,p).enumerable})),s.push.apply(s,r)}return s}function L(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?xe(Object(s),!0).forEach(function(r){M()(o,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):xe(Object(s)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(s,r))})}return o}function Ie(o){for(var n=L(L(L(L(L({},o.name?{name:o.name}:{}),o.description?{description:o.description}:{}),o.csv?{csv:o.csv}:{}),o.is_static?{is_static:o.is_static}:{}),{},{groups:JSON.stringify(o.is_static?[]:o.groups.map(function(E){return L(L({},E),{},{id:void 0,matchType:void 0})}))}),s=new FormData,r=0,p=Object.entries(n);r<p.length;r++){var g=fe()(p[r],2),h=g[0],j=g[1];s.append(h,j)}return s}function De(o){var n=o.action_id||o.event_id?d.f:d.p;return L({matchType:n,id:Math.random().toString().substr(2,5)},o)}function ye(o){return o.groups&&(o.groups=o.groups.map(function(n){return De(n)}),o.groups=o.groups.map(function(n){return n.properties?L(L({},n),{},{properties:Object(se.r)(n.properties)}):n})),o}var Ee=ye({id:"new",groups:[{id:Math.random().toString().substr(2,5),matchType:d.p,properties:[]}]}),Ce=Object(u.kea)([Object(u.props)({}),Object(u.key)(function(o){return o.id||"new"}),Object(u.path)(["scenes","cohorts","cohortLogic"]),Object(u.actions)({saveCohort:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{cohortParams:n}},setCohort:function(n){return{cohort:n}},deleteCohort:!0,fetchCohort:function(n){return{id:n}},onCriteriaChange:function(n,s){return{newGroup:n,id:s}},setPollTimeout:function(n){return{pollTimeout:n}},checkIfFinishedCalculating:function(n){return{cohort:n}}}),Object(u.reducers)(function(){return{cohort:[Ee,{onCriteriaChange:function(n,s){var r=s.newGroup,p=s.id,g=L({},n),h=g.groups.findIndex(function(j){return j.id===p});return r.matchType?g.groups[h]=L({id:g.groups[h].id,matchType:d.f},r):g.groups[h]=L(L({},g.groups[h]),r),ye(g)}}],pollTimeout:[null,{setPollTimeout:function(n,s){var r=s.pollTimeout;return r}}]}}),Object(H.forms)(function(o){var n=o.actions;return{cohort:{defaults:Ee,errors:function(r){var p=r.name,g=r.csv,h=r.is_static,j=r.groups;return{name:p?void 0:"You need to set a name",csv:h&&!g?"You need to upload a CSV file":null,groups:h?void 0:!j||j.length<1?[{id:"You need at least one matching group"}]:j==null?void 0:j.map(function(E){var l=E.matchType,c=E.properties,B=E.action_id,T=E.event_id;return l===d.p&&!(c!=null&&c.length)?{id:"Please select at least one property or remove this match group."}:l===d.f&&!(B||T)?{id:"Please select an event or action."}:{id:void 0}})}},submit:function(r){n.saveCohort(r)}}}}),Object(ue.loaders)(function(o){var n=o.actions,s=o.values,r=o.key;return{cohort:[Ee,{setCohort:function(g){var h=g.cohort;return ye(h)},fetchCohort:function(){var p=D()(P.a.mark(function h(j,E){var l,c;return P.a.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return l=j.id,T.prev=1,T.next=4,A.b.cohorts.get(l);case 4:return c=T.sent,E(),G.a.actions.updateCohort(c),n.checkIfFinishedCalculating(c),T.abrupt("return",ye(c));case 11:return T.prev=11,T.t0=T.catch(1),x.b.error(T.t0.detail||"Failed to fetch cohort"),T.abrupt("return",s.cohort);case 15:case"end":return T.stop()}},h,null,[[1,11]])}));function g(h,j){return p.apply(this,arguments)}return g}(),saveCohort:function(){var p=D()(P.a.mark(function h(j,E){var l,c,B;return P.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(l=j.cohortParams,c=L({},l),B=Ie(c),i.prev=3,c.id==="new"){i.next=11;break}return i.next=7,A.b.cohorts.update(c.id,B);case 7:c=i.sent,G.a.actions.updateCohort(c),i.next=15;break;case 11:return i.next=13,A.b.cohorts.create(B);case 13:c=i.sent,G.a.actions.cohortCreated(c);case 15:i.next=22;break;case 17:return i.prev=17,i.t0=i.catch(3),E(),x.b.error(i.t0.detail||"Failed to save cohort"),i.abrupt("return",s.cohort);case 22:return c.is_calculating=!0,E(),delete c.csv,n.setCohort(c),x.b.success("Cohort saved. Please wait up to a few minutes for it to be calculated",{toastId:"cohort-saved-".concat(r)}),n.checkIfFinishedCalculating(c),i.abrupt("return",c);case 29:case"end":return i.stop()}},h,null,[[3,17]])}));function g(h,j){return p.apply(this,arguments)}return g}()}]}}),Object(u.selectors)({breadcrumbs:[function(o){return[o.cohort]},function(o){return[{name:"Cohorts",path:S.a.cohorts()}].concat(oe()(o?[{name:o.name||"Untitled"}]:[]))}]}),Object(u.listeners)(function(o){var n=o.actions,s=o.values;return{deleteCohort:function(){var p;(p=G.a.findMounted())===null||p===void 0||p.actions.deleteCohort(s.cohort),de.router.actions.push(S.a.cohorts())},checkIfFinishedCalculating:function(){var r=D()(P.a.mark(function g(h,j){var E,l;return P.a.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:E=h.cohort,E.is_calculating?n.setPollTimeout(setTimeout(D()(P.a.mark(function T(){var i;return P.a.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.next=2,A.b.cohorts.get(E.id);case 2:i=re.sent,j(),n.checkIfFinishedCalculating(i);case 5:case"end":return re.stop()}},T)})),1e3)):(n.setCohort(E),G.a.actions.updateCohort(E),(l=W.a.findMounted({syncWithUrl:!0}))===null||l===void 0||l.actions.loadCohorts(),s.pollTimeout&&(clearTimeout(s.pollTimeout),n.setPollTimeout(null)));case 2:case"end":return B.stop()}},g)}));function p(g,h){return r.apply(this,arguments)}return p}()}}),Object(de.actionToUrl)(function(o){var n=o.values;return{saveCohortSuccess:function(){return S.a.cohort(n.cohort.id)}}}),Object(u.afterMount)(function(o){var n=o.actions,s=o.props;!s.id||s.id==="new"?n.setCohort(Ee):n.fetchCohort(s.id)}),Object(u.beforeUnmount)(function(o){var n=o.values;n.pollTimeout&&clearTimeout(n.pollTimeout)})]),Re=e("./frontend/src/scenes/userLogic.ts"),Ye=e("./node_modules/antd/lib/dropdown/style/index.css"),Me=e("./frontend/src/lib/components/Spinner/Spinner.tsx"),be=e("./frontend/src/lib/components/LemonButton/index.ts"),Fe=e("./frontend/src/lib/components/PageHeader.tsx"),Ne=e("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),Pe=e("./frontend/src/lib/forms/Field.tsx"),Be=e("./frontend/src/lib/forms/VerticalForm.tsx"),Ue=e("./frontend/src/lib/components/LemonSelect.tsx"),Ke=e("./frontend/src/lib/components/LemonTextArea/LemonTextArea.tsx"),Se=e("./frontend/src/lib/components/icons.tsx"),Ve=e("./frontend/src/scenes/cohorts/MatchCriteriaSelector.tsx"),Ge=e("./frontend/src/lib/components/Tooltip.tsx"),je;function Ae(o,n){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);n&&(r=r.filter(function(p){return Object.getOwnPropertyDescriptor(o,p).enumerable})),s.push.apply(s,r)}return s}function Te(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?Ae(Object(s),!0).forEach(function(r){M()(o,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):Ae(Object(s)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(s,r))})}return o}var We={component:ve,logic:Ce,paramsToProps:function(n){var s=n.params.id;return{id:s&&s!=="new"?parseInt(s):"new"}}},He=(je={},M()(je,d.b.Static,{label:"Static \xB7 Updated manually"}),M()(je,d.b.Dynamic,{label:"Dynamic \xB7 Updates automatically"}),je);function ve(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=o.id,s={id:n},r=Ce(s),p=Object(u.useActions)(r),g=p.deleteCohort,h=p.setCohort,j=p.onCriteriaChange,E=Object(u.useValues)(r),l=E.cohort,c=E.cohortLoading,B=Object(u.useValues)(Re.a),T=B.hasAvailableFeature,i=l.id==="new"||l.id===void 0,Le=function(){h(Te(Te({},l),{},{groups:[].concat(oe()(l.groups),[{id:Math.random().toString().substr(2,5),matchType:d.p,properties:[]}])}))},re=function(K){h(Te(Te({},l),{},{groups:l.groups.filter(function(w,k){return k!==K})}))};return t.a.createElement("div",{className:"cohort"},t.a.createElement(Be.a,{logic:Ce,props:s,formKey:"cohort",enableFormOnSubmit:!0},t.a.createElement(Fe.a,{title:i?"New cohort":l.name||"Untitled",buttons:t.a.createElement("div",{className:"flex-center"},i?t.a.createElement(be.a,{"data-attr":"cancel-cohort",type:"secondary",onClick:function(){de.router.actions.push(S.a.cohorts())},style:{marginRight:8},disabled:c},"Cancel"):t.a.createElement(be.a,{"data-attr":"delete-cohort",status:"danger",type:"secondary",onClick:function(){g()},style:{marginRight:8},disabled:c},"Delete"),t.a.createElement(be.a,{type:"primary","data-attr":"save-cohort",htmlType:"submit",loading:c},"Save"))}),t.a.createElement(_.a,null),t.a.createElement(m.a,{gutter:[16,24],style:{maxWidth:640}},t.a.createElement(f.a,{xs:24,sm:12},t.a.createElement(Pe.a,{name:"name",label:"Name"},t.a.createElement(Ne.a,{"data-attr":"cohort-name"}))),t.a.createElement(f.a,{xs:24,sm:12},t.a.createElement(Pe.a,{name:"is_static",label:"Type"},function(U){var K=U.value,w=U.onChange;return t.a.createElement(Ge.a,{title:i?null:"Create a new cohort to use a different type of cohort."},t.a.createElement("div",null,t.a.createElement(Ue.a,{disabled:!i,options:He,value:K?d.b.Static:d.b.Dynamic,onChange:function(me){w(me===d.b.Static)},type:"stealth",outlined:!0,style:{width:"100%"},"data-attr":"cohort-type"})))}))),T(v.d.DASHBOARD_COLLABORATION)&&t.a.createElement(m.a,{gutter:[16,24],className:"mt ph-ignore-input",style:{maxWidth:640}},t.a.createElement(f.a,{span:24},t.a.createElement(Pe.a,{name:"description",label:"Description","data-attr":"cohort-description"},t.a.createElement(Ke.a,null)))),l.is_static?t.a.createElement(m.a,{gutter:24,className:"mt ph-ignore-input"},t.a.createElement(f.a,{span:24},t.a.createElement(Pe.a,{name:"csv",label:i?"Upload users":"Add users","data-attr":"cohort-csv"},function(U){var K,w,k=U.onChange;return t.a.createElement(t.a.Fragment,null,t.a.createElement("span",{className:"mb"},"Upload a CSV file to add users to your cohort. The CSV file only requires a single column with the user\u2019s distinct ID."),t.a.createElement(q.a,{name:"file",multiple:!1,fileList:l.csv?[l.csv]:[],accept:".csv",showUploadList:!1,beforeUpload:function(Oe){return k(Oe),!1},className:"cohort-csv-dragger"},l.csv?t.a.createElement(t.a.Fragment,null,t.a.createElement(Se.IconUploadFile,{style:{fontSize:"3rem",color:"var(--muted-alt)"}}),t.a.createElement("div",{className:"ant-upload-text"},(K=(w=l.csv)===null||w===void 0?void 0:w.name)!==null&&K!==void 0?K:"File chosen")):t.a.createElement(t.a.Fragment,null,t.a.createElement(Se.IconUploadFile,{style:{fontSize:"3rem",color:"var(--muted-alt)"}}),t.a.createElement("div",{className:"ant-upload-text"},"Drag a file here or click to browse for a file"))))}))):t.a.createElement(t.a.Fragment,null,t.a.createElement(_.a,null),t.a.createElement(m.a,{gutter:24,className:"mt"},t.a.createElement(f.a,{span:24},t.a.createElement(t.a.Fragment,null,t.a.createElement("div",{className:"ant-row ant-form-item ant-form-item-label",style:{display:"flex"}},t.a.createElement("label",{htmlFor:"groups",title:"Matching criteria"},"Matching criteria"),t.a.createElement("span",null,"Actors who match the following criteria will be part of the cohort. Continuously updated automatically.")),l.groups.map(function(U,K){return t.a.createElement(H.Group,{key:K,name:["groups",K]},t.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"}},t.a.createElement(H.Field,{name:"id",template:function(k){var me=k.error,Oe=k.kids;return t.a.createElement("div",{style:{padding:15,border:me?"1px solid var(--danger)":"1px solid rgba(0, 0, 0, 0.1)",borderRadius:4,width:"100%"}},Oe,t.a.createElement(m.a,null,me&&t.a.createElement("div",{style:{color:"var(--danger)",marginTop:16}},me)))}},t.a.createElement(Ve.b,{onCriteriaChange:function(k){return j(k,U.id)},onRemove:function(){return re(K)},group:U,hideRemove:l.groups.length===1})),K<l.groups.length-1&&t.a.createElement("div",{className:"stateful-badge or mt mb"},"OR")))})),t.a.createElement("span",{id:"add"}),t.a.createElement("div",{style:{marginTop:8,marginBottom:8}},t.a.createElement("a",{href:"#add",style:{padding:0},onClick:function(){return Le()},"data-attr":"add-match-criteria"},t.a.createElement(I.a,null)," Add matching criteria"))))),!i&&t.a.createElement(t.a.Fragment,null,t.a.createElement(_.a,null),t.a.createElement("div",null,t.a.createElement("h3",{className:"l3"},"Persons in this cohort"),l.is_calculating?t.a.createElement("div",{className:"cohort-recalculating flex-center"},t.a.createElement(Me.a,{size:"sm",style:{marginRight:4}}),"We're recalculating who belongs to this cohort. This could take up to a couple of minutes."):t.a.createElement("div",{style:{marginTop:15}},t.a.createElement(X.Persons,{cohort:l.id}))))))}try{ve.displayName="Cohort",ve.__docgenInfo={description:"",displayName:"Cohort",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:'number | "new"'}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/cohorts/Cohort.tsx#Cohort"]={docgenInfo:ve.__docgenInfo,name:"Cohort",path:"frontend/src/scenes/cohorts/Cohort.tsx#Cohort"})}catch(o){}},"./frontend/src/scenes/groups/groupsListLogic.ts":function(te,C,e){"use strict";e.d(C,"a",function(){return _});var O=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),a=e.n(O),F=e("./node_modules/@babel/runtime/regenerator/index.js"),b=e.n(F),$=e("./node_modules/core-js/modules/es.array.iterator.js"),pe=e.n($),oe=e("./node_modules/core-js/modules/es.object.to-string.js"),z=e.n(oe),M=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),he=e.n(M),ne=e("./node_modules/core-js/modules/es.array.concat.js"),ae=e.n(ne),le=e("./node_modules/kea/lib/index.esm.js"),N=e("./frontend/src/lib/api.ts"),J=e("./frontend/src/lib/introductions/groupsAccessLogic.ts"),Q=e("./frontend/src/lib/utils.tsx"),t=e("./frontend/src/scenes/teamLogic.ts"),u=e("./frontend/src/scenes/urls.ts"),H=e("./frontend/src/models/groupsModel.ts"),_=Object(le.kea)({path:["groups","groupsListLogic"],connect:{values:[t.a,["currentTeamId"],H.a,["groupTypes","aggregationLabel"],J.b,["groupsEnabled"]]},actions:function(){return{loadGroups:function(v){return{url:v}},setTab:function(v){return{tab:v}}}},loaders:function(f){var v=f.values;return{groups:[{next:null,previous:null,results:[]},{loadGroups:function(){var d=a()(b.a.mark(function Y(q){var X;return b.a.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(X=q.url,!v.groupsEnabled){D.next=6;break}return X=X||"api/projects/".concat(v.currentTeamId,"/groups/?group_type_index=").concat(v.currentTab),D.next=5,N.b.get(X);case 5:return D.abrupt("return",D.sent);case 6:case"end":return D.stop()}},Y)}));function I(Y){return d.apply(this,arguments)}return I}()}]}},reducers:{currentTab:["-1",{setTab:function(f,v){var d=v.tab;return d}}]},selectors:{currentTabName:[function(m){return[m.currentTab,m.groupTypes,m.aggregationLabel]},function(m,f,v){return m==="-1"?"Persons":f!=null&&f.length?Object(Q.i)(v(parseInt(m)).singular):""}],breadcrumbs:[function(m){return[m.currentTabName,m.currentTab]},function(m,f){return[{name:m,path:u.a.groups(f)}]}]},actionToUrl:function(){return{setTab:function(v){var d=v.tab;return d!=="-1"?u.a.groups(d):u.a.persons()}}},urlToAction:function(f){var v=f.actions,d=f.values;return{"/groups/:id":function(Y){var q=Y.id;q&&(v.setTab(q),v.loadGroups())},"/persons":function(){d.currentTab!=="-1"&&v.setTab("-1")}}}})},"./frontend/src/scenes/persons/PersonPageHeader.tsx":function(te,C,e){"use strict";e.d(C,"a",function(){return N});var O=e("./node_modules/kea/lib/index.esm.js"),a=e("./frontend/src/lib/components/PageHeader.tsx"),F=e("./node_modules/react/index.js"),b=e.n(F),$=e("./node_modules/core-js/modules/es.array.includes.js"),pe=e("./node_modules/core-js/modules/es.string.includes.js"),oe=e("./node_modules/core-js/modules/es.array.map.js"),z=e("./node_modules/antd/es/tabs/index.js"),M=e("./frontend/src/lib/introductions/groupsAccessLogic.ts"),he=e("./frontend/src/lib/utils.tsx"),ne=e("./frontend/src/models/groupsModel.ts"),ae=e("./frontend/src/scenes/groups/groupsListLogic.ts");function le(){var J=Object(O.useActions)(ae.a),Q=J.setTab,t=Object(O.useValues)(ae.a),u=t.currentTab,H=Object(O.useValues)(ne.a),_=H.groupTypes,m=H.aggregationLabel,f=Object(O.useValues)(M.b),v=f.groupsAccessStatus,d=[M.a.HasAccess,M.a.HasGroupTypes,M.a.NoAccess].includes(v);return b.a.createElement(z.a,{activeKey:u,onChange:function(Y){return Q(Y)}},b.a.createElement(z.a.TabPane,{tab:"Persons",key:"-1"}),d?b.a.createElement(z.a.TabPane,{tab:"Introducing Group Analytics",key:"0"}):_.map(function(I){return b.a.createElement(z.a.TabPane,{tab:Object(he.i)(m(I.group_type_index).plural),key:I.group_type_index})}))}function N(J){var Q=J.hideGroupTabs,t=Object(O.useValues)(ne.a),u=t.showGroupsOptions;return b.a.createElement(b.a.Fragment,null,b.a.createElement(a.a,{title:"Persons".concat(u?" & Groups":""),caption:"A catalog of your product's end users".concat(u?" and groups":"",".")}),!Q&&u&&b.a.createElement(le,null))}try{N.displayName="PersonPageHeader",N.__docgenInfo={description:"",displayName:"PersonPageHeader",props:{hideGroupTabs:{defaultValue:null,description:"",name:"hideGroupTabs",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"]={docgenInfo:N.__docgenInfo,name:"PersonPageHeader",path:"frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"})}catch(J){}},"./frontend/src/scenes/persons/Persons.scss":function(te,C,e){"use strict";var O=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),a=e.n(O),F=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/persons/Persons.scss"),b=e.n(F),$={};$.insert="head",$.singleton=!1;var pe=a()(b.a,$),oe=b.a.locals||{}},"./frontend/src/scenes/persons/Persons.tsx":function(te,C,e){"use strict";e.r(C),e.d(C,"scene",function(){return D}),e.d(C,"Persons",function(){return ce}),e.d(C,"PersonsScene",function(){return fe});var O=e("./node_modules/react/index.js"),a=e.n(O),F=e("./node_modules/kea/lib/index.esm.js"),b=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),$=e.n(b),pe=e("./node_modules/core-js/modules/es.array.concat.js"),oe=e("./node_modules/core-js/modules/es.object.keys.js"),z=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),M=e("./frontend/src/lib/components/PropertiesTable.tsx"),he=e("./frontend/src/scenes/persons/Persons.scss"),ne=e("./frontend/src/lib/components/CopyToClipboard.tsx"),ae=e("./frontend/src/scenes/persons/PersonHeader.tsx"),le=e("./frontend/src/lib/components/LemonTable/index.ts");function N(y){var P=y.people,ee=y.loading,ie=ee===void 0?!1:ee,V=y.hasPrevious,Z=y.hasNext,R=y.loadPrevious,A=y.loadNext,G=y.compact,se=[{title:"Person",key:"person",render:function(x,S){return a.a.createElement(ae.a,{withIcon:!0,person:S})}},{title:"ID",key:"id",render:function(x,S){return a.a.createElement("div",{style:{overflow:"hidden"}},S.distinct_ids.length&&a.a.createElement(ne.a,{explicitValue:S.distinct_ids[0],iconStyle:{color:"var(--primary)"},description:"person distinct ID"},S.distinct_ids[0]))}}].concat($()(G?[]:[{title:"First seen",dataIndex:"created_at",render:function(x){return x?a.a.createElement(z.b,{time:x}):a.a.createElement(a.a.Fragment,null)}}]));return a.a.createElement(le.a,{columns:se,loading:ie,rowKey:"id",pagination:{controlled:!0,pageSize:100,onForward:Z?function(){A==null||A(),window.scrollTo(0,0)}:void 0,onBackward:V?function(){R==null||R(),window.scrollTo(0,0)}:void 0},expandable:{expandedRowRender:function(x){var S=x.properties;return Object.keys(S).length?a.a.createElement(M.a,{properties:S}):"This person has no properties."}},dataSource:P,emptyState:"No persons",nouns:["person","persons"]})}try{N.displayName="PersonsTable",N.__docgenInfo={description:"",displayName:"PersonsTable",props:{people:{defaultValue:null,description:"",name:"people",required:!0,type:{name:"PersonType[]"}},loading:{defaultValue:{value:"false"},description:"",name:"loading",required:!1,type:{name:"boolean"}},hasPrevious:{defaultValue:null,description:"",name:"hasPrevious",required:!1,type:{name:"boolean"}},hasNext:{defaultValue:null,description:"",name:"hasNext",required:!1,type:{name:"boolean"}},loadPrevious:{defaultValue:null,description:"",name:"loadPrevious",required:!1,type:{name:"(() => void)"}},loadNext:{defaultValue:null,description:"",name:"loadNext",required:!1,type:{name:"(() => void)"}},compact:{defaultValue:null,description:"",name:"compact",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"]={docgenInfo:N.__docgenInfo,name:"PersonsTable",path:"frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"})}catch(y){}var J=e("./node_modules/antd/es/row/index.js"),Q=e("./node_modules/antd/es/popconfirm/index.js"),t=e("./frontend/src/scenes/persons/personsLogic.ts"),u=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),H=e.n(u),_=e("./node_modules/core-js/modules/es.regexp.exec.js"),m=e("./node_modules/core-js/modules/es.string.search.js"),f=e("./node_modules/antd/es/input/index.js"),v=e("./frontend/src/lib/components/LemonRow/index.ts"),d=e("./frontend/src/lib/components/icons.tsx"),I=function(P){var ee=P.autoFocus,ie=ee===void 0?!0:ee,V=Object(F.useActions)(t.a),Z=V.loadPersons,R=V.setListFilters,A=Object(F.useValues)(t.a),G=A.listFilters,se=Object(O.useState)(""),W=H()(se,2),x=W[0],S=W[1];return Object(O.useEffect)(function(){S(G.search||"")},[]),a.a.createElement("div",{style:{display:"flex",alignItems:"center",width:"min(100%, 24rem)"}},a.a.createElement(f.a.Search,{"data-attr":"persons-search",placeholder:"Search for persons",autoFocus:ie,value:x,onChange:function(ue){S(ue.target.value),ue.target.value||(R({search:void 0}),Z())},enterButton:!0,onPressEnter:function(ue){ue.preventDefault(),R({search:x||void 0}),Z()},allowClear:!0,onSearch:function(){R({search:x||void 0}),Z()},style:{width:"100%"}}),a.a.createElement(v.a,{className:"ml-05",type:"stealth",tooltip:a.a.createElement(a.a.Fragment,null,"Search by email, name, ID, or even contents of properties. You can also search for persons who just ",a.a.createElement("i",null,"have"),' a property like so: "has:your_property".'),icon:a.a.createElement(d.IconInfo,null)}))};try{I.displayName="PersonsSearch",I.__docgenInfo={description:"",displayName:"PersonsSearch",props:{autoFocus:{defaultValue:{value:"true"},description:"",name:"autoFocus",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonsSearch.tsx#PersonsSearch"]={docgenInfo:I.__docgenInfo,name:"PersonsSearch",path:"frontend/src/scenes/persons/PersonsSearch.tsx#PersonsSearch"})}catch(y){}var Y=e("./frontend/src/scenes/persons/PersonPageHeader.tsx"),q=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),X=e("./frontend/src/lib/components/TaxonomicFilter/types.ts"),ge=e("./frontend/src/lib/components/LemonButton/index.ts"),D={component:fe,logic:t.a,paramsToProps:function(){return{syncWithUrl:!0}}};function ce(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},P=y.cohort;return a.a.createElement(F.BindLogic,{logic:t.a,props:{cohort:P,syncWithUrl:!P}},a.a.createElement(fe,null))}function fe(){var y=Object(F.useActions)(t.a),P=y.loadPersons,ee=y.setListFilters,ie=y.exportCsv,V=Object(F.useValues)(t.a),Z=V.cohortId,R=V.persons,A=V.listFilters,G=V.personsLoading,se=V.exportUrl;return a.a.createElement("div",{className:"persons-list"},!Z&&a.a.createElement(Y.a,null),a.a.createElement(J.a,{align:"middle",justify:"space-between",className:"mb-05",style:{gap:"0.75rem"}},a.a.createElement(I,{autoFocus:!Z}),a.a.createElement("div",null,a.a.createElement(Q.a,{placement:"topRight",title:a.a.createElement(a.a.Fragment,null,"Exporting by csv is limited to 10,000 users.",a.a.createElement("br",null),"To return more, please use ",a.a.createElement("a",{href:"https://posthog.com/docs/api/persons"},"the API"),". Do you want to export by CSV?"),onConfirm:ie},se&&a.a.createElement(ge.a,{type:"secondary",icon:a.a.createElement(d.IconExport,{style:{color:"var(--primary)"}})},A.properties&&A.properties.length>0?a.a.createElement("div",{style:{display:"block"}},"Export (",a.a.createElement("strong",null,A.properties.length)," filter)"):"Export")))),a.a.createElement(q.a,{pageKey:"persons-list-page",propertyFilters:A.properties,onChange:function(x){ee({properties:x}),P()},endpoint:"person",taxonomicGroupTypes:[X.a.PersonProperties,X.a.Cohorts],showConditionBadge:!0}),a.a.createElement(N,{people:R.results,loading:G,hasPrevious:!!R.previous,hasNext:!!R.next,loadPrevious:function(){return P(R.previous)},loadNext:function(){return P(R.next)}}))}try{ce.displayName="Persons",ce.__docgenInfo={description:"",displayName:"Persons",props:{cohort:{defaultValue:null,description:"",name:"cohort",required:!1,type:{name:'number | "new"'}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/Persons.tsx#Persons"]={docgenInfo:ce.__docgenInfo,name:"Persons",path:"frontend/src/scenes/persons/Persons.tsx#Persons"})}catch(y){}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/persons/Persons.scss":function(te,C,e){var O=e("./node_modules/css-loader/dist/runtime/api.js");C=O(!1),C.push([te.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.extra-ids{display:inline-flex;align-items:center;height:1.25rem;line-height:1.125rem;margin:0 0 0 .25rem;padding:0 .25rem 0 .375rem;color:#5375ff;cursor:pointer}.extra-ids svg{margin-left:.25rem}",""]),te.exports=C}}]);
