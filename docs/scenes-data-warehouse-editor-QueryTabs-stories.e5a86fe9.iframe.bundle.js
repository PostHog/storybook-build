"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[90209],{"../../frontend/src/scenes/data-warehouse/editor/QueryTabs.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,NoActiveTabs:()=>NoActiveTabs,SingleTab:()=>SingleTab,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),_multitabEditorLogic__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/src/scenes/data-warehouse/editor/multitabEditorLogic.tsx"),_QueryTabs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/scenes/data-warehouse/editor/QueryTabs.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let __WEBPACK_DEFAULT_EXPORT__={title:"Scenes-App/Data Warehouse/QueryTabs",component:_QueryTabs__WEBPACK_IMPORTED_MODULE_2__.K,parameters:{layout:"fullscreen",viewMode:"story"},tags:["autodocs"]},Template=args=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(kea__WEBPACK_IMPORTED_MODULE_0__.BindLogic,{logic:_multitabEditorLogic__WEBPACK_IMPORTED_MODULE_1__.tg,props:{key:"new"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_QueryTabs__WEBPACK_IMPORTED_MODULE_2__.K,{...args})}),mockModels=[{uri:{path:"/query1.sql",scheme:"file",authority:"",query:"",fragment:"",fsPath:"",with:function(change){return change.path="/query1.sql",this},toJSON:function(){return{path:"/query1.sql",scheme:"file",authority:"",query:"",fragment:""}}},name:"Query 1",view:void 0},{uri:{path:"/query2.sql",scheme:"file",authority:"",query:"",fragment:"",fsPath:"",with:function(change){return change.path="/query1.sql",this},toJSON:function(){return{path:"/query1.sql",scheme:"file",authority:"",query:"",fragment:""}}},name:"Query 2"}],Default=Template.bind({});Default.args={models:mockModels,activeModelUri:mockModels[0]};let SingleTab=Template.bind({});SingleTab.args={models:[mockModels[0]],activeModelUri:mockModels[0]};let NoActiveTabs=Template.bind({});NoActiveTabs.args={models:mockModels,activeModelUri:null},Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => {\n  return <BindLogic logic={multitabEditorLogic} props={{\n    key: 'new'\n  }}>\n            <QueryTabs {...args} />\n        </BindLogic>;\n}",...Default.parameters?.docs?.source}}},SingleTab.parameters={...SingleTab.parameters,docs:{...SingleTab.parameters?.docs,source:{originalSource:"args => {\n  return <BindLogic logic={multitabEditorLogic} props={{\n    key: 'new'\n  }}>\n            <QueryTabs {...args} />\n        </BindLogic>;\n}",...SingleTab.parameters?.docs?.source}}},NoActiveTabs.parameters={...NoActiveTabs.parameters,docs:{...NoActiveTabs.parameters?.docs,source:{originalSource:"args => {\n  return <BindLogic logic={multitabEditorLogic} props={{\n    key: 'new'\n  }}>\n            <QueryTabs {...args} />\n        </BindLogic>;\n}",...NoActiveTabs.parameters?.docs?.source}}};let __namedExportsOrder=["Default","SingleTab","NoActiveTabs"]},"../../frontend/src/scenes/data-warehouse/editor/QueryTabs.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{K:()=>QueryTabs});var posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.22.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),clsx_m=__webpack_require__("../../node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),react=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let editor_AutoTab=_ref=>{let{value,onChange,onKeyDown,onBlur,autoFocus}=_ref,inputRef=(0,react.useRef)(null),spanRef=(0,react.useRef)(null);return(0,react.useEffect)(()=>{if(!inputRef.current||!spanRef.current)return;let newWidth=spanRef.current.offsetWidth;inputRef.current.style.width=newWidth+"px"},[value]),(0,jsx_runtime.jsxs)("div",{className:"relative inline-block",children:[(0,jsx_runtime.jsx)("span",{ref:spanRef,className:"pointer-events-none absolute invisible whitespace-pre","aria-hidden":"true",children:value}),(0,jsx_runtime.jsx)("input",{ref:inputRef,className:"bg-transparent border-none focus:outline-hidden p-0",value:value,onChange:e=>{onChange(e)},onKeyDown:onKeyDown,onBlur:onBlur,autoFocus:autoFocus})]})};var multitabEditorLogic=__webpack_require__("../../frontend/src/scenes/data-warehouse/editor/multitabEditorLogic.tsx");function QueryTabs(_ref){let{models,onClear,onClick,onAdd,onRename,activeModelUri}=_ref,{allTabs}=(0,index_esm.useValues)(multitabEditorLogic.tg),containerRef=(0,react.useRef)(null),prevTabsCountRef=(0,react.useRef)(allTabs.length);return(0,react.useEffect)(()=>{allTabs.length>prevTabsCountRef.current&&containerRef.current?.scrollTo({left:containerRef.current.scrollWidth,behavior:"smooth"}),prevTabsCountRef.current=allTabs.length},[allTabs]),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"flex flex-row overflow-scroll hide-scrollbar h-[39px]",ref:containerRef,children:models.map(model=>(0,jsx_runtime.jsx)(QueryTabComponent,{model:model,onClear:models.length>1?onClear:void 0,onClick:onClick,active:activeModelUri?.uri.path===model.uri.path,onRename:onRename},model.uri.path))}),(0,jsx_runtime.jsx)(src.Jp,{className:"rounded-none",onClick:()=>onAdd(),icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconPlus,{fontSize:14}),"data-attr":"sql-editor-new-tab-button"})]})}function QueryTabComponent(_ref2){let{model,active,onClear,onClick,onRename}=_ref2,[tabName,setTabName]=(0,react.useState)(()=>model.name||multitabEditorLogic.x$),[isEditing,setIsEditing]=(0,react.useState)(!1);(0,react.useEffect)(()=>{setTabName(model.view?.name||model.name||multitabEditorLogic.x$)},[model.view?.name,model.name]);let handleRename=()=>{setIsEditing(!1),onRename(model,tabName)};return(0,jsx_runtime.jsxs)("div",{onClick:()=>onClick?.(model),className:(0,clsx_m.default)("deprecated-space-y-px p-1 flex border-b-2 flex-row items-center gap-1 hover:bg-surface-primary cursor-pointer",active?"bg-surface-primary border-b-2 !border-brand-yellow":"bg-surface-secondary border-transparent",onClear?"pl-3 pr-2":"px-3"),children:[isEditing?(0,jsx_runtime.jsx)(editor_AutoTab,{value:tabName,onChange:e=>setTabName(e.target.value),onBlur:handleRename,autoFocus:!0,onKeyDown:e=>{"Enter"===e.key?handleRename():"Escape"===e.key&&setIsEditing(!1)}}):(0,jsx_runtime.jsx)("div",{onDoubleClick:()=>{!model.view&&setIsEditing(!isEditing)},className:"flex-grow text-left whitespace-pre",children:tabName}),onClear&&(0,jsx_runtime.jsx)(src.Jp,{onClick:e=>{e.stopPropagation(),onClear(model)},size:"xsmall",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconX,{})})]})}}}]);