"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[60162],{"../../frontend/src/scenes/heatmaps/components/HeatmapsWarnings.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>HeatmapsWarnings});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),_posthog_icons__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.35.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),scenes_teamLogic__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/scenes/teamLogic.tsx"),_layout_navigation_3000_sidepanel_panels_sidePanelSettingsLogic__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/layout/navigation-3000/sidepanel/panels/sidePanelSettingsLogic.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function HeatmapsWarnings(){let{currentTeam}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(scenes_teamLogic__WEBPACK_IMPORTED_MODULE_3__.teamLogic),heatmapsEnabled=currentTeam?.heatmaps_opt_in,{openSettingsPanel}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(_layout_navigation_3000_sidepanel_panels_sidePanelSettingsLogic__WEBPACK_IMPORTED_MODULE_4__.A);return heatmapsEnabled?null:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.Vp,{type:"warning",action:{type:"secondary",icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_1__.IconGear,{}),onClick:()=>openSettingsPanel({sectionId:"environment-autocapture",settingId:"heatmaps"}),children:"Configure"},dismissKey:"heatmaps-might-be-disabled-warning",children:"You aren't collecting heatmaps data. Enable heatmaps in your project."})}},"../../frontend/src/scenes/heatmaps/scenes/heatmaps/HeatmapsScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{HeatmapsScene:()=>HeatmapsScene,scene:()=>scene});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),_posthog_icons__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.35.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),lib_components_MemberSelect__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/components/MemberSelect.tsx"),lib_components_TZLabel__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/components/TZLabel/index.tsx"),lib_lemon_ui_LemonBanner__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonBanner/index.ts"),lib_lemon_ui_LemonButton_More__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/More.tsx"),lib_lemon_ui_LemonTable_columnUtils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/columnUtils.tsx"),scenes_heatmaps_components_HeatmapsWarnings__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../frontend/src/scenes/heatmaps/components/HeatmapsWarnings.tsx"),scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),scenes_scenes__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../frontend/src/scenes/scenes.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../frontend/src/scenes/urls.ts"),_layout_scenes_components_SceneContent__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("../../frontend/src/layout/scenes/components/SceneContent.tsx"),_layout_scenes_components_SceneDivider__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("../../frontend/src/layout/scenes/components/SceneDivider.tsx"),_layout_scenes_components_SceneTitleSection__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("../../frontend/src/layout/scenes/components/SceneTitleSection.tsx"),_heatmapsSceneLogic__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("../../frontend/src/scenes/heatmaps/scenes/heatmaps/heatmapsSceneLogic.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let scene={component:HeatmapsScene,logic:_heatmapsSceneLogic__WEBPACK_IMPORTED_MODULE_15__.lF,settingSectionId:"environment-autocapture"};function HeatmapsScene(){let{savedHeatmaps,savedHeatmapsLoading,filters,totalCount}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(_heatmapsSceneLogic__WEBPACK_IMPORTED_MODULE_15__.lF),{deleteHeatmap,setHeatmapsFilters}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(_heatmapsSceneLogic__WEBPACK_IMPORTED_MODULE_15__.lF),columns=[{title:"Name",dataIndex:"name",render:(_,row)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.rU,{to:scenes_urls__WEBPACK_IMPORTED_MODULE_11__.j.heatmap(row.short_id),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)("span",{className:"truncate max-w-[32rem] inline-block align-middle",children:row.name})})},{title:"Page",dataIndex:"url",render:(_,row)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.rU,{to:scenes_urls__WEBPACK_IMPORTED_MODULE_11__.j.heatmap(row.short_id),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)("span",{className:"truncate max-w-[32rem] inline-block align-middle",children:row.url})})},{title:"Heatmap data URL",dataIndex:"data_url",render:(_,row)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.rU,{to:scenes_urls__WEBPACK_IMPORTED_MODULE_11__.j.heatmap(row.short_id),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)("span",{className:"truncate max-w-[32rem] inline-block align-middle",children:row.data_url})})},{title:"Type",dataIndex:"type",render:(_,row)=>row.type.charAt(0).toUpperCase()+row.type.slice(1)},{title:"Created",dataIndex:"created_at",render:function Render(created_at){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)("div",{children:created_at&&"string"==typeof created_at&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(lib_components_TZLabel__WEBPACK_IMPORTED_MODULE_4__.w,{time:created_at})})}},{...(0,lib_lemon_ui_LemonTable_columnUtils__WEBPACK_IMPORTED_MODULE_7__.JB)(),width:0},{width:0,render:function Render(_,row){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(lib_lemon_ui_LemonButton_More__WEBPACK_IMPORTED_MODULE_6__.T,{overlay:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.Fragment,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.Jp,{status:"danger",onClick:()=>deleteHeatmap(row.short_id),fullWidth:!0,loading:savedHeatmapsLoading,children:"Delete"})})})}}];return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsxs)(_layout_scenes_components_SceneContent__WEBPACK_IMPORTED_MODULE_12__._,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(scenes_heatmaps_components_HeatmapsWarnings__WEBPACK_IMPORTED_MODULE_8__.X,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_layout_scenes_components_SceneTitleSection__WEBPACK_IMPORTED_MODULE_14__.s,{name:scenes_scenes__WEBPACK_IMPORTED_MODULE_10__.lc[scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_9__.x.Heatmaps].name,description:scenes_scenes__WEBPACK_IMPORTED_MODULE_10__.lc[scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_9__.x.Heatmaps].description,resourceType:{type:scenes_scenes__WEBPACK_IMPORTED_MODULE_10__.lc[scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_9__.x.Heatmaps].iconType||"default"},actions:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.Jp,{type:"primary",to:scenes_urls__WEBPACK_IMPORTED_MODULE_11__.j.heatmap("new"),"data-attr":"heatmaps-new-heatmap-button",size:"small",icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_1__.IconPlusSmall,{}),children:"New heatmap"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_layout_scenes_components_SceneDivider__WEBPACK_IMPORTED_MODULE_13__.V,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(lib_lemon_ui_LemonBanner__WEBPACK_IMPORTED_MODULE_5__.V,{type:"info",dismissKey:"heatmaps-beta-banner",className:"mb-4",action:{children:"Send feedback",id:"heatmaps-feedback-button"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)("p",{children:"Heatmaps is in beta. Please let us know what you'd like to see here and/or report any issues directly to us!"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsxs)("div",{className:"flex justify-between gap-2 items-center flex-wrap",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.DF,{type:"search",placeholder:"Search for heatmaps",onChange:value=>setHeatmapsFilters({...filters,search:value||""}),value:filters.search||""}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsxs)("div",{className:"flex items-center gap-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)("span",{children:"Created by:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(lib_components_MemberSelect__WEBPACK_IMPORTED_MODULE_3__.a,{value:"All users"===filters.createdBy?null:filters.createdBy,onChange:user=>setHeatmapsFilters({...filters,createdBy:user?.id||"All users"})})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)("div",{className:"mb-4",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.g3,{dataSource:savedHeatmaps,loading:savedHeatmapsLoading,columns:columns,rowKey:"id",pagination:{controlled:!0,pageSize:_heatmapsSceneLogic__WEBPACK_IMPORTED_MODULE_15__.JY,currentPage:filters.page,entryCount:totalCount,onBackward:(filters.page||1)>1?()=>setHeatmapsFilters({...filters,page:Math.max(1,(filters.page||1)-1)}):void 0,onForward:(filters.page||1)*_heatmapsSceneLogic__WEBPACK_IMPORTED_MODULE_15__.JY<(totalCount||0)?()=>setHeatmapsFilters({...filters,page:(filters.page||1)+1}):void 0},nouns:["heatmap","heatmaps"]})})]})}},"../../frontend/src/scenes/heatmaps/scenes/heatmaps/heatmapsSceneLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{JY:()=>HEATMAPS_PER_PAGE,lF:()=>heatmapsSceneLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib_api__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/src/lib/api.ts"),lib_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/utils.tsx"),lib_utils_deleteWithUndo__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/utils/deleteWithUndo.tsx"),scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),scenes_scenes__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/scenes/scenes.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/scenes/urls.ts");let DEFAULT_HEATMAP_FILTERS={createdBy:"All users",search:"",page:1,order:"-created_at"},HEATMAPS_PER_PAGE=30,heatmapsSceneLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","heatmaps","scenes","heatmaps","heatmapsSceneLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({loadSavedHeatmaps:!0,setSavedHeatmaps:items=>({items}),setLoading:loading=>({loading}),deleteHeatmap:short_id=>({short_id}),setHeatmapsFilters:filters=>({filters}),setTotalCount:count=>({count})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({savedHeatmaps:[[],{setSavedHeatmaps:(_,_ref)=>{let{items}=_ref;return items}}],savedHeatmapsLoading:[!1,{setLoading:(_,_ref2)=>{let{loading}=_ref2;return loading}}],filters:[DEFAULT_HEATMAP_FILTERS,{persist:!0},{setHeatmapsFilters:(_,_ref3)=>{let{filters}=_ref3;return filters}}],totalCount:[0,{setTotalCount:(_,_ref4)=>{let{count}=_ref4;return count}}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)(()=>({breadcrumbs:[()=>[],()=>[{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_4__.x.Heatmaps,name:scenes_scenes__WEBPACK_IMPORTED_MODULE_5__.lc[scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_4__.x.Heatmaps].name||"Heatmaps",path:scenes_urls__WEBPACK_IMPORTED_MODULE_6__.j.heatmaps(),iconType:scenes_scenes__WEBPACK_IMPORTED_MODULE_5__.lc[scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_4__.x.Heatmaps].iconType||"default_icon_type"}]]})),(0,kea__WEBPACK_IMPORTED_MODULE_0__.listeners)(_ref5=>{let{actions,values}=_ref5;return{loadSavedHeatmaps:async(_,breakpoint)=>{(0,lib_utils__WEBPACK_IMPORTED_MODULE_2__.h0)(values.filters,DEFAULT_HEATMAP_FILTERS)||await breakpoint(300),actions.setLoading(!0);try{let f=values.filters||{},createdBy="All users"===f.createdBy?void 0:f.createdBy,params={search:f.search||"",createdBy:createdBy||"All users",page:f.page||1,order:f.order||"-created_at",limit:HEATMAPS_PER_PAGE,offset:Math.max(0,(f.page-1||0)*HEATMAPS_PER_PAGE)},response=await lib_api__WEBPACK_IMPORTED_MODULE_1__.ZP.savedHeatmaps.list(params);actions.setSavedHeatmaps(response.results||[]),actions.setTotalCount(response.count||0)}finally{actions.setLoading(!1)}},deleteHeatmap:async _ref6=>{let{short_id}=_ref6,item=values.savedHeatmaps.find(h=>h.short_id===short_id),object={id:item?.id,short_id,name:item?.name||item?.url||"Heatmap"};await (0,lib_utils_deleteWithUndo__WEBPACK_IMPORTED_MODULE_3__.S)({object,idField:"short_id",endpoint:"environments/@current/saved",callback:()=>actions.loadSavedHeatmaps()})},setHeatmapsFilters:()=>{actions.loadSavedHeatmaps()}}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.afterMount)(_ref7=>{let{actions}=_ref7;actions.loadSavedHeatmaps()})])}}]);