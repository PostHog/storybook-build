(window.webpackJsonp=window.webpackJsonp||[]).push([[318],{"./frontend/src/scenes/instance/Licenses/index.tsx":function(G,f,n){"use strict";n.r(f),n.d(f,"scene",function(){return Y}),n.d(f,"Licenses",function(){return L});var g=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),y=n.n(g),C=n("./node_modules/core-js/modules/es.array.filter.js"),Q=n.n(C),b=n("./node_modules/core-js/modules/es.object.to-string.js"),X=n.n(b),A=n("./node_modules/core-js/modules/es.array.sort.js"),Z=n.n(A),T=n("./node_modules/core-js/modules/es.array.slice.js"),w=n.n(T),B=n("./node_modules/core-js/modules/es.array.map.js"),k=n.n(B),I=n("./node_modules/core-js/modules/es.function.name.js"),q=n.n(I),W=n("./frontend/src/lib/components/LemonButton/More.tsx"),m=n("./node_modules/antd/es/form/index.js"),K=n("./node_modules/antd/es/alert/index.js"),U=n("./node_modules/antd/es/input/index.js"),R=n("./node_modules/antd/es/button/index.js"),u=n("./frontend/src/scenes/instance/Licenses/licenseLogic.ts"),h=n("./node_modules/kea/lib/index.esm.js"),D=n("./frontend/src/lib/utils.tsx"),p=n("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),F=n("./frontend/src/lib/components/PageHeader.tsx"),N=n("./node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),z=n("./frontend/src/lib/components/Tooltip.tsx"),V=n("./frontend/src/lib/components/LemonTable/index.ts"),M=n("./frontend/src/lib/components/LemonButton/index.ts"),S=n("./frontend/src/scenes/organizationLogic.tsx"),x=n("./frontend/src/lib/dayjs.ts"),H=n("./frontend/src/lib/components/LemonModal/index.ts"),e=n("./node_modules/react/jsx-runtime.js"),ee=n.n(e),Y={component:L,logic:u.b};function J(a){var P=a.licenses,_=a.isOpen,i=a.onCancel,j=a.onOk,v=Object(h.useValues)(S.a),c=v.currentOrganization,d=P.filter(function(t){return Object(x.a)().isBefore(t.valid_until)}).length>1,l=((c==null?void 0:c.teams)||[]).filter(function(t){return!t.is_demo}).sort(function(t,E){return t.id-E.id}),O=!d&&l.slice(1,l.length).length>0;return Object(e.jsx)(H.a,{isOpen:_,onClose:i,title:"Are you sure you want to deactivate your license?",footer:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(M.a,{form:"new-dashboard-form",type:"secondary","data-attr":"deactivate-license-cancel",className:"mr-2",onClick:i,children:"Cancel"}),Object(e.jsx)(M.a,{"data-attr":"deactivate-license-proceed",type:"primary",status:"danger",onClick:j,children:O?Object(e.jsxs)(e.Fragment,{children:["Deactivate license & delete ",l.length," project(s)"]}):"Deactivate license"})]}),children:Object(e.jsxs)("ul",{className:"pl-3 list-disc",children:[d?Object(e.jsxs)("li",{children:["You will ",Object(e.jsx)("strong",{children:"keep"})," all premium features available with your other valid license."]}):Object(e.jsxs)("li",{children:["You will ",Object(e.jsx)("strong",{children:"IMMEDIATELY"})," lose access to all premium features such as"," ",Object(e.jsx)("strong",{children:"multiple projects"}),", ",Object(e.jsx)("strong",{children:"single sign on"}),","," ",Object(e.jsx)("strong",{children:"group analytics"}),", ",Object(e.jsx)("strong",{children:"multivariate feature flags"})," and many more."]}),O&&Object(e.jsxs)("li",{children:["We will ",Object(e.jsx)("strong",{className:"text-danger",children:"DELETE"})," the following projects:",Object(e.jsx)("ul",{className:"pl-6 list-disc mb-2",children:l.map(function(t){return Object(e.jsx)("li",{children:Object(e.jsx)("strong",{children:t.name})},t.id)})}),"To keep one of these projects instead, remove all other projects first."]}),Object(e.jsx)("li",{children:"You will immediately be billed for usage in the current period, if any."})]})})}function L(){var a=m.a.useForm(),P=y()(a,1),_=P[0],i=Object(h.useValues)(u.b),j=i.licenses,v=i.licensesLoading,c=i.error,d=i.showConfirmCancel,l=Object(h.useActions)(u.b),O=l.createLicense,t=l.deleteLicense,E=l.setShowConfirmCancel,$=[{title:"Active",render:function(r,s){return Object(u.a)(s)?"expired":"active"}},{title:"Valid until",render:function(r,s){return Object(D.N)(s.valid_until)}},{title:"Plan",dataIndex:"plan"},{title:function(){return Object(e.jsxs)(z.a,{placement:"right",title:"Maximum number of team members that you can have across all organizations with your current license.",children:["Max #\xA0of team members",Object(e.jsx)(N.a,{className:"info-indicator"})]})},render:function(r,s){return s.max_users===null?"Unlimited":s.max_users}},{title:"Key",render:function(r,s){return Object(e.jsx)(p.a,{children:s.key})}},{title:"License added on",render:function(r,s){return Object(D.N)(s.created_at)}},{width:0,render:function(r,s){return Object(x.a)().isAfter(s.valid_until)?null:Object(e.jsx)(W.a,{overlay:Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(M.a,{status:"danger",onClick:function(){return E(s)},fullWidth:!0,children:"Deactivate license"})})})}}];return Object(e.jsxs)("div",{children:[Object(e.jsx)(J,{licenses:j,isOpen:!!d,onCancel:function(){return E(null)},onOk:function(){return d?t(d):null}}),Object(e.jsx)(F.a,{title:"Licenses",caption:Object(e.jsxs)(e.Fragment,{children:["Here you can add and manage your PostHog enterprise licenses. When you activate a license key, enterprise functionality will be enabled immediately. Contact"," ",Object(e.jsx)("a",{href:"mailto:sales@posthog.com",children:"sales@posthog.com"})," to buy a license or if you have any issues with a license."]})}),c&&Object(e.jsx)(K.a,{message:c.detail||Object(e.jsx)("span",{children:"Could not validate license key. Please try again or contact us."}),type:"error",style:{marginBottom:"1em"}}),Object(e.jsxs)(m.a,{form:_,name:"horizontal_login",layout:"inline",onFinish:function(r){return O({key:r.key})},style:{marginBottom:"1rem"},children:[Object(e.jsx)(m.a.Item,{name:"key",rules:[{required:!0,message:"Please input a license key!"}],children:Object(e.jsx)(U.a,{placeholder:"License key",style:{minWidth:400}})}),Object(e.jsx)(m.a.Item,{shouldUpdate:!0,children:function(){return Object(e.jsx)(R.a,{type:"primary",htmlType:"submit",disabled:!_.isFieldsTouched(!0)||!!_.getFieldsError().filter(function(r){var s=r.errors;return s.length}).length,children:"Activate License Key"})}})]}),Object(e.jsx)(V.a,{"data-attr":"license-table",size:"small",rowKey:"id",rowClassName:"cursor-pointer",dataSource:j,columns:$,loading:v})]})}}}]);
