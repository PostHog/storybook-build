"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[9600],{"../../frontend/src/scenes/hog-functions/HogFunctionScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{HogFunctionScene:()=>HogFunctionScene,hogFunctionSceneLogic:()=>hogFunctionSceneLogic,scene:()=>scene});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib=__webpack_require__("../../node_modules/.pnpm/kea-router@3.2.1_kea@3.1.5_react@18.2.0_/node_modules/kea-router/lib/index.js"),ActivityLog=__webpack_require__("../../frontend/src/lib/components/ActivityLog/ActivityLog.tsx"),NotFound=__webpack_require__("../../frontend/src/lib/components/NotFound/index.tsx"),LemonSkeleton=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonSkeleton/index.ts"),LemonTabs=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTabs/index.ts"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),HogFunctionConfiguration=__webpack_require__("../../frontend/src/scenes/hog-functions/configuration/HogFunctionConfiguration.tsx"),hogFunctionConfigurationLogic=__webpack_require__("../../frontend/src/scenes/hog-functions/configuration/hogFunctionConfigurationLogic.tsx"),HogFunctionLogs=__webpack_require__("../../frontend/src/scenes/hog-functions/logs/HogFunctionLogs.tsx"),HogFunctionMetrics=__webpack_require__("../../frontend/src/scenes/hog-functions/metrics/HogFunctionMetrics.tsx"),HogFunctionTesting=__webpack_require__("../../frontend/src/scenes/hog-functions/testing/HogFunctionTesting.tsx"),sceneTypes=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),types=__webpack_require__("../../frontend/src/types.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function HogFunctionSkeleton(){return(0,jsx_runtime.jsxs)("div",{className:"flex flex-row flex-wrap gap-4 h-120",children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-col flex-1 gap-4 min-w-60",children:[(0,jsx_runtime.jsx)(LemonSkeleton.y,{className:"flex-1 w-full h-full"}),(0,jsx_runtime.jsx)(LemonSkeleton.y,{className:"flex-1 w-full h-full"})]}),(0,jsx_runtime.jsx)("div",{className:"flex flex-col gap-4 flex-2 min-w-60",children:(0,jsx_runtime.jsx)(LemonSkeleton.y,{className:"flex-1 w-full h-full"})})]})}let HOG_FUNCTION_SCENE_TABS=["configuration","metrics","logs","testing","history"],DataPipelinesSceneMapping={transformation:types.J9.Transformations,destination:types.J9.Destinations,site_destination:types.J9.Destinations,site_app:types.J9.SiteApps,source_webhook:types.J9.Sources},hogFunctionSceneLogic=(0,index_esm.kea)([(0,index_esm.props)({}),(0,index_esm.key)(_ref=>{var _ref2;let{id,templateId}=_ref;return null!==(_ref2=null!=id?id:templateId)&&void 0!==_ref2?_ref2:"new"}),(0,index_esm.path)(key=>["scenes","hog-functions","hogFunctionSceneLogic",key]),(0,index_esm.connect)(props=>({values:[(0,hogFunctionConfigurationLogic.nM)(props),["configuration","type","loading","loaded"]]})),(0,index_esm.actions)({setCurrentTab:tab=>({tab})}),(0,index_esm.reducers)(()=>({currentTab:["configuration",{setCurrentTab:(_,_ref3)=>{let{tab}=_ref3;return tab}}]})),(0,index_esm.selectors)({logicProps:[()=>[(_,props)=>props],props=>props],alertId:[s=>[s.configuration],configuration=>{if(!configuration?.filters?.properties)return;let alertIdProp=configuration.filters.properties.find(p=>"alert_id"===p.key),value=alertIdProp?.value;return value?String(value):void 0}],breadcrumbs:[s=>[s.type,s.loading,s.configuration,s.alertId],(type,loading,configuration,alertId)=>{if(loading)return[{key:sceneTypes.x.HogFunction,name:"Loading..."}];let finalCrumb={key:sceneTypes.x.HogFunction,name:configuration?.name||"(Untitled)"};if("internal_destination"===type&&alertId)return[{key:sceneTypes.x.Insight,name:"Insight",path:urls.j.alerts()},{key:"alert",name:"Alert",path:urls.j.alert(alertId)},finalCrumb];let pipelineTab=DataPipelinesSceneMapping[type];return pipelineTab?[{key:sceneTypes.x.Pipeline,name:"Data pipelines",path:urls.j.pipeline(types.J9.Overview)},{key:sceneTypes.x.HogFunction,name:`${(0,utils.fm)(type).replace("_"," ")}s`,path:urls.j.pipeline(pipelineTab)},finalCrumb]:"internal_destination"===type?configuration?.filters?.events?.some(e=>e.id.includes("error_tracking"))?[{key:sceneTypes.x.ErrorTracking,name:"Error tracking",path:urls.j.errorTracking()},{key:sceneTypes.x.HogFunction,name:"Alerts",path:urls.j.errorTrackingConfiguration()+"#selectedSetting=error-tracking-alerting"},finalCrumb]:[{key:sceneTypes.x.HogFunction,name:"Notifications"},finalCrumb]:[{key:sceneTypes.x.HogFunction,name:"Function"},finalCrumb]}]}),(0,lib.actionToUrl)(_ref4=>{let{values}=_ref4;return{setCurrentTab:()=>[lib.router.values.location.pathname,{...lib.router.values.searchParams,tab:values.currentTab},lib.router.values.hashParams]}}),(0,lib.urlToAction)(_ref5=>{let{actions,values}=_ref5,reactToTabChange=(_,search)=>{var _search$tab;let possibleTab=null!==(_search$tab=search.tab)&&void 0!==_search$tab?_search$tab:"configuration",tab=HOG_FUNCTION_SCENE_TABS.includes(possibleTab)?possibleTab:"configuration";tab!==values.currentTab&&actions.setCurrentTab(tab)};return{[urls.j.hogFunction(":id")]:reactToTabChange,[urls.j.errorTrackingAlert(":id")]:reactToTabChange}})]),scene={component:HogFunctionScene,logic:hogFunctionSceneLogic,paramsToProps:_ref6=>{let{params:{id,templateId}}=_ref6;return{id,templateId}}};function HogFunctionScene(){let{currentTab,loading,loaded,logicProps,type}=(0,index_esm.useValues)(hogFunctionSceneLogic),{setCurrentTab}=(0,index_esm.useActions)(hogFunctionSceneLogic),{id,templateId}=logicProps;if(loading&&!loaded)return(0,jsx_runtime.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,jsx_runtime.jsx)(LemonSkeleton.y,{className:"w-full h-12"}),(0,jsx_runtime.jsx)(HogFunctionSkeleton,{})]});if(!loaded)return(0,jsx_runtime.jsx)(NotFound.T,{object:"Hog function"});if(templateId)return(0,jsx_runtime.jsx)(HogFunctionConfiguration.g,{templateId:templateId});if(!id)return(0,jsx_runtime.jsx)(NotFound.T,{object:"Hog function"});let tabs=[{label:"Configuration",key:"configuration",content:(0,jsx_runtime.jsx)(HogFunctionConfiguration.g,{id:id})},"site_app"===type||"site_destination"===type?null:{label:"Metrics",key:"metrics",content:(0,jsx_runtime.jsx)(HogFunctionMetrics.k,{id:id})},"site_app"===type||"site_destination"===type?null:{label:"Logs",key:"logs",content:(0,jsx_runtime.jsx)(HogFunctionLogs.x,{hogFunctionId:id})},"site_app"===type||"site_destination"===type||"internal_destination"===type?null:{label:"Testing",key:"testing",content:(0,jsx_runtime.jsx)(HogFunctionTesting.D,{id:id})},{label:"History",key:"history",content:(0,jsx_runtime.jsx)(ActivityLog.DA,{id:id,scope:types.jc.HOG_FUNCTION})}];return(0,jsx_runtime.jsx)(LemonTabs.T,{activeKey:currentTab,tabs:tabs,onChange:setCurrentTab})}},"../../frontend/src/scenes/pipeline/pipelineNodeLogic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{y:()=>pipelineNodeLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_router__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.2.1_kea@3.1.5_react@18.2.0_/node_modules/kea-router/lib/index.js"),lib_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/utils.tsx"),scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/scenes/urls.ts"),_layout_navigation_3000_sidepanel_types__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../frontend/src/layout/navigation-3000/sidepanel/types.ts"),_types__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/types.ts"),_pipelineNodeNewLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/scenes/pipeline/pipelineNodeNewLogic.tsx"),_types__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/scenes/pipeline/types.ts");let pipelineNodeLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.key)(_ref=>{let{id}=_ref;return id}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(id=>["scenes","pipeline","pipelineNodeLogic",id]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setCurrentTab:function(){let tab=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_types__WEBPACK_IMPORTED_MODULE_5__.il.Configuration;return{tab}},setBreadcrumbTitle:title=>({title}),setProjectTreeRef:projectTreeRef=>({projectTreeRef})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)(()=>({currentTab:[_types__WEBPACK_IMPORTED_MODULE_5__.il.Configuration,{setCurrentTab:(_,_ref2)=>{let{tab}=_ref2;return tab}}],breadcrumbTitle:["",{setBreadcrumbTitle:(_,_ref3)=>{let{title}=_ref3;return title}}],projectTreeRef:[null,{setProjectTreeRef:(_,_ref4)=>{let{projectTreeRef}=_ref4;return projectTreeRef}}]})),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)(()=>({breadcrumbs:[(s,p)=>[p.id,p.stage,s.breadcrumbTitle],(id,stage,breadcrumbTitle)=>[{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_3__.x.Pipeline,name:"Data pipeline",path:scenes_urls__WEBPACK_IMPORTED_MODULE_4__.j.pipeline()},{key:stage||"unknown",name:stage?(0,lib_utils__WEBPACK_IMPORTED_MODULE_2__.fm)(_pipelineNodeNewLogic__WEBPACK_IMPORTED_MODULE_6__.U[stage]||""):"Unknown",path:scenes_urls__WEBPACK_IMPORTED_MODULE_4__.j.pipeline(stage?_pipelineNodeNewLogic__WEBPACK_IMPORTED_MODULE_6__.U[stage]:void 0)},{key:[scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_3__.x.PipelineNode,id],name:breadcrumbTitle}]],[_layout_navigation_3000_sidepanel_types__WEBPACK_IMPORTED_MODULE_8__.f]:[s=>[s.node],node=>node.backend===_types__WEBPACK_IMPORTED_MODULE_7__.b.Plugin?{activity_scope:_types__WEBPACK_IMPORTED_MODULE_5__.jc.PLUGIN,activity_item_id:`${node.id}`}:null],nodeBackend:[s=>[s.node],node=>node.backend],node:[(_,p)=>[p.id],id=>"string"==typeof id?0===id.indexOf("hog-")?{backend:_types__WEBPACK_IMPORTED_MODULE_7__.b.HogFunction,id:`${id}`.replace("hog-","")}:{backend:_types__WEBPACK_IMPORTED_MODULE_7__.b.BatchExport,id}:{backend:_types__WEBPACK_IMPORTED_MODULE_7__.b.Plugin,id}],tabs:[s=>[s.nodeBackend],nodeBackend=>{let tabs=Object.values(_types__WEBPACK_IMPORTED_MODULE_5__.il);return nodeBackend===_types__WEBPACK_IMPORTED_MODULE_7__.b.BatchExport?tabs.filter(t=>t!==_types__WEBPACK_IMPORTED_MODULE_5__.il.History):tabs}],id:[(_,p)=>[p.id],id=>id],stage:[(_,p)=>[p.stage],stage=>stage]})),(0,kea_router__WEBPACK_IMPORTED_MODULE_1__.actionToUrl)(_ref5=>{let{values,props}=_ref5;return{setCurrentTab:()=>[scenes_urls__WEBPACK_IMPORTED_MODULE_4__.j.pipelineNode(props.stage,props.id,values.currentTab)]}}),(0,kea_router__WEBPACK_IMPORTED_MODULE_1__.urlToAction)(_ref6=>{let{props,actions,values}=_ref6;return{[scenes_urls__WEBPACK_IMPORTED_MODULE_4__.j.pipelineNode(props.stage,props.id,":nodeTab")]:_ref7=>{let{nodeTab}=_ref7;if(nodeTab!==values.currentTab&&Object.values(_types__WEBPACK_IMPORTED_MODULE_5__.il).includes(nodeTab)&&actions.setCurrentTab(nodeTab),"string"==typeof props.id&&(props.id.startsWith("managed-")||props.id.startsWith("self-managed-"))){kea_router__WEBPACK_IMPORTED_MODULE_1__.router.actions.replace(scenes_urls__WEBPACK_IMPORTED_MODULE_4__.j.dataWarehouseSource(props.id.toString()));return}let match=kea_router__WEBPACK_IMPORTED_MODULE_1__.router.values.location.pathname.match(/\/pipeline\/([^/]+)\/hog-([^/]+)\/?/);if(match){let{projectTreeRef}=values,type="hog_function/",ref=match[2];projectTreeRef&&projectTreeRef.type===type&&projectTreeRef.ref===ref||actions.setProjectTreeRef({type,ref})}}}})])},"../../frontend/src/scenes/pipeline/pipelineNodeNewLogic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>pipelineNodeNewLogic,U:()=>NODE_STAGE_TO_PIPELINE_TAB});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.5_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),lib_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/utils.tsx"),scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/scenes/urls.ts"),scenes_userLogic__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/scenes/userLogic.ts"),_types__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/types.ts"),_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/scenes/pipeline/utils.tsx");let NODE_STAGE_TO_PIPELINE_TAB={[_types__WEBPACK_IMPORTED_MODULE_6__.We.Transformation]:_types__WEBPACK_IMPORTED_MODULE_6__.J9.Transformations,[_types__WEBPACK_IMPORTED_MODULE_6__.We.Destination]:_types__WEBPACK_IMPORTED_MODULE_6__.J9.Destinations,[_types__WEBPACK_IMPORTED_MODULE_6__.We.SiteApp]:_types__WEBPACK_IMPORTED_MODULE_6__.J9.SiteApps,[_types__WEBPACK_IMPORTED_MODULE_6__.We.Source]:_types__WEBPACK_IMPORTED_MODULE_6__.J9.Sources},pipelineNodeNewLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)(()=>({values:[scenes_userLogic__WEBPACK_IMPORTED_MODULE_5__.userLogic,["user"]]})),(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(id=>["scenes","pipeline","pipelineNodeNewLogic",id]),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)({plugins:[{},{loadPlugins:async()=>(0,_utils__WEBPACK_IMPORTED_MODULE_7__.c$)("api/organizations/@current/pipeline_destinations")}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({loading:[s=>[s.pluginsLoading],pluginsLoading=>pluginsLoading],breadcrumbs:[(_,p)=>[p.stage,p.pluginId,p.kind,p.batchExportDestination],(stage,pluginId,kind,batchDestination)=>{let parsedStage=stage?stage.replace("-"," "):null;return[{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_3__.x.Pipeline,name:"Data pipeline",path:scenes_urls__WEBPACK_IMPORTED_MODULE_4__.j.pipeline()},{key:stage||"unknown",name:stage?(0,lib_utils__WEBPACK_IMPORTED_MODULE_2__.fm)(NODE_STAGE_TO_PIPELINE_TAB[stage]||""):"Unknown",path:scenes_urls__WEBPACK_IMPORTED_MODULE_4__.j.pipeline(stage?NODE_STAGE_TO_PIPELINE_TAB[stage]:void 0)},{key:pluginId||batchDestination||"Unknown",name:kind?`New ${(0,lib_utils__WEBPACK_IMPORTED_MODULE_2__.fm)(kind)} source`:pluginId?"New":batchDestination?`New ${batchDestination} destination`:`New ${parsedStage}`.trim()}]}],projectTreeRef:[s=>[s.loading],()=>({type:"hog_function/",ref:null})]})])}}]);