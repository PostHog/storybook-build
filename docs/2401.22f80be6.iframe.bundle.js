"use strict";(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[2401],{"./frontend/src/scenes/error-tracking/AlphaAccessScenePrompt.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_:()=>AlphaAccessScenePrompt});var _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),lib_components_ProductIntroduction_ProductIntroduction__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./frontend/src/lib/components/ProductIntroduction/ProductIntroduction.tsx"),lib_hooks_useFeatureFlag__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/lib/hooks/useFeatureFlag.ts"),posthog_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/posthog-js@1.206.0/node_modules/posthog-js/dist/module.js"),_types__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/types.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let AlphaAccessScenePrompt=_ref=>{let{children}=_ref,hasErrorTracking=(0,lib_hooks_useFeatureFlag__WEBPACK_IMPORTED_MODULE_2__.y)("ERROR_TRACKING");return hasErrorTracking?children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(lib_components_ProductIntroduction_ProductIntroduction__WEBPACK_IMPORTED_MODULE_1__.C,{productName:"Error tracking",thingName:"issue",titleOverride:"Welcome to Error Tracking",description:"Error tracking is in closed alpha for our JS and Python SDKs. If you would like access please reach out and someone on our team will onboard you.",isEmpty:!0,docsURL:"https://posthog.com/docs/error-tracking",productKey:_types__WEBPACK_IMPORTED_MODULE_4__.Md.ERROR_TRACKING,actionElementOverride:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.Jp,{type:"primary",onClick:()=>posthog_js__WEBPACK_IMPORTED_MODULE_3__.ZP.updateEarlyAccessFeatureEnrollment("error-tracking",!0),children:"Get started"})})}},"./frontend/src/scenes/error-tracking/ErrorTrackingConfigurationScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ErrorTrackingConfigurationScene:()=>ErrorTrackingConfigurationScene,scene:()=>scene});var posthog_icons_es=__webpack_require__("./node_modules/.pnpm/@posthog+icons@0.9.3_react-dom@18.2.0_react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),stackFrameLogic=__webpack_require__("./frontend/src/lib/components/Errors/stackFrameLogic.ts"),JSONViewer=__webpack_require__("./frontend/src/lib/components/JSONViewer.tsx"),utils=__webpack_require__("./frontend/src/lib/utils.tsx"),react=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),AlphaAccessScenePrompt=__webpack_require__("./frontend/src/scenes/error-tracking/AlphaAccessScenePrompt.tsx"),lib=__webpack_require__("./node_modules/.pnpm/kea-forms@3.2.0_kea@3.1.5/node_modules/kea-forms/lib/index.js"),kea_loaders_lib=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),api=__webpack_require__("./frontend/src/lib/api.ts"),sceneTypes=__webpack_require__("./frontend/src/scenes/sceneTypes.ts"),urls=__webpack_require__("./frontend/src/scenes/urls.ts");let errorTrackingSymbolSetLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","error-tracking","errorTrackingSymbolSetLogic"]),(0,index_esm.actions)({setUploadSymbolSetId:id=>({id})}),(0,index_esm.reducers)({uploadSymbolSetId:[null,{setUploadSymbolSetId:(_,_ref)=>{let{id}=_ref;return id}}]}),(0,kea_loaders_lib.loaders)(_ref2=>{let{values}=_ref2;return{symbolSets:[[],{loadSymbolSets:async()=>{let response=await api.ZP.errorTracking.symbolSets();return response.results},deleteSymbolSet:async id=>{await api.ZP.errorTracking.deleteSymbolSet(id);let newValues=[...values.symbolSets];return newValues.filter(v=>v.id!==id)}}]}}),(0,index_esm.selectors)({breadcrumbs:[()=>[],()=>[{key:sceneTypes.x.ErrorTracking,name:"Error tracking",path:urls.j.errorTracking()},{key:sceneTypes.x.ErrorTrackingConfiguration,name:"Configuration"}]],validSymbolSets:[s=>[s.symbolSets],symbolSets=>symbolSets.filter(s=>!!s.storage_ptr)],missingSymbolSets:[s=>[s.symbolSets],symbolSets=>symbolSets.filter(s=>!s.storage_ptr)]}),(0,lib.forms)(_ref3=>{let{values,actions}=_ref3;return{uploadSymbolSet:{defaults:{minified:[],sourceMap:[]},submit:async _ref4=>{let{minified,sourceMap}=_ref4;if(minified.length<1||sourceMap.length<1){src.UJ.error("Please select both a minified file and a source map file");return}let minifiedSrc=minified[0],sourceMapSrc=sourceMap[0],id=values.uploadSymbolSetId;if(null==id)return;let formData=new FormData;formData.append("minified",minifiedSrc),formData.append("source_map",sourceMapSrc),await api.ZP.errorTracking.updateSymbolSet(id,formData),actions.setUploadSymbolSetId(null),actions.loadSymbolSets(),actions.resetUploadSymbolSet(),src.UJ.success("Source map uploaded")}}}})]);var icons=__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts"),LemonField=__webpack_require__("./frontend/src/lib/lemon-ui/LemonField/index.ts"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let SymbolSetUploadModal=()=>{let{setUploadSymbolSetId}=(0,index_esm.useActions)(errorTrackingSymbolSetLogic),{uploadSymbolSetId,isUploadSymbolSetSubmitting,uploadSymbolSet}=(0,index_esm.useValues)(errorTrackingSymbolSetLogic),onClose=()=>setUploadSymbolSetId(null);return(0,jsx_runtime.jsx)(src.fQ,{title:"",onClose:onClose,isOpen:!!uploadSymbolSetId,simple:!0,children:(0,jsx_runtime.jsxs)(lib.Form,{logic:errorTrackingSymbolSetLogic,formKey:"uploadSymbolSet",className:"gap-1",enableFormOnSubmit:!0,children:[(0,jsx_runtime.jsx)(src.fQ.Header,{children:(0,jsx_runtime.jsx)("h3",{children:"Upload javscript symbol set"})}),(0,jsx_runtime.jsxs)(src.fQ.Content,{className:"space-y-2",children:[(0,jsx_runtime.jsx)(LemonField.D,{name:"minified",children:(0,jsx_runtime.jsx)(src.mH,{accept:"text/javascript",multiple:!1,callToAction:(0,jsx_runtime.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-2 border border-dashed rounded p-4 w-full",children:[(0,jsx_runtime.jsxs)("span",{className:"flex items-center gap-2 font-semibold",children:[(0,jsx_runtime.jsx)(icons.bn,{className:"text-2xl"})," Add minified source"]}),(0,jsx_runtime.jsx)("div",{children:"Drag and drop your minified source file here or click to open the file browser."})]})})}),(0,jsx_runtime.jsx)(LemonField.D,{name:"sourcemap",children:(0,jsx_runtime.jsx)(src.mH,{accept:"*",multiple:!1,callToAction:(0,jsx_runtime.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-2 border border-dashed rounded p-4 w-full",children:[(0,jsx_runtime.jsxs)("span",{className:"flex items-center gap-2 font-semibold",children:[(0,jsx_runtime.jsx)(icons.bn,{className:"text-2xl"})," Add source map"]}),(0,jsx_runtime.jsx)("div",{children:"Drag and drop your source map here or click to open the file browser."})]})})})]}),(0,jsx_runtime.jsxs)(src.fQ.Footer,{children:[(0,jsx_runtime.jsx)(src.Jp,{type:"secondary",onClick:onClose,children:"Cancel"}),(0,jsx_runtime.jsx)(src.Jp,{disabledReason:uploadSymbolSet.minified.length<1?"Upload a minified source":uploadSymbolSet.sourceMap.length<1?"Upload a source map":void 0,type:"primary",status:"alt",htmlType:"submit",loading:isUploadSymbolSetSubmitting,children:"Upload"})]})]})})},scene={component:ErrorTrackingConfigurationScene,logic:errorTrackingSymbolSetLogic};function ErrorTrackingConfigurationScene(){let{missingSymbolSets,validSymbolSets}=(0,index_esm.useValues)(errorTrackingSymbolSetLogic),{loadSymbolSets}=(0,index_esm.useActions)(errorTrackingSymbolSetLogic);return(0,react.useEffect)(()=>{loadSymbolSets()},[loadSymbolSets]),(0,jsx_runtime.jsx)(AlphaAccessScenePrompt._,{children:(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsx)("h2",{children:"Symbol sets"}),(0,jsx_runtime.jsx)("p",{children:"Source maps are required to demangle any minified code in your exception stack traces. PostHog automatically retrieves source maps where possible. Cases where it was not possible are listed below. Source maps can be uploaded retroactively but changes will only apply to all future exceptions ingested."}),missingSymbolSets.length>0&&(0,jsx_runtime.jsx)(SymbolSetTable,{id:"missing",dataSource:missingSymbolSets,pageSize:5,missing:!0}),(validSymbolSets.length>0||0===missingSymbolSets.length)&&(0,jsx_runtime.jsx)(SymbolSetTable,{id:"valid",dataSource:validSymbolSets,pageSize:10}),(0,jsx_runtime.jsx)(SymbolSetUploadModal,{})]})})}let SymbolSetTable=_ref=>{let{id,dataSource,pageSize,missing}=_ref,{symbolSetsLoading}=(0,index_esm.useValues)(errorTrackingSymbolSetLogic),{deleteSymbolSet,setUploadSymbolSetId}=(0,index_esm.useActions)(errorTrackingSymbolSetLogic),columns=[{title:missing&&"Missing symbol sets",dataIndex:"ref"},{title:"Created At",dataIndex:"created_at",render:data=>(0,utils.bo)(data)},{dataIndex:"id",render:(_,_ref2)=>{let{id}=_ref2;return(0,jsx_runtime.jsxs)("div",{className:"flex justify-end space-x-1",children:[(0,jsx_runtime.jsx)(src.Jp,{type:missing?"primary":"secondary",size:"xsmall",tooltip:missing?"Upload symbol set":"Replace symbol set",icon:missing?(0,jsx_runtime.jsx)(posthog_icons_es.IconUpload,{}):(0,jsx_runtime.jsx)(posthog_icons_es.IconRevert,{}),onClick:()=>setUploadSymbolSetId(id),className:"py-1",children:missing&&"Upload"}),(0,jsx_runtime.jsx)(src.Jp,{type:"secondary",size:"xsmall",tooltip:"Delete symbol set",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconTrash,{}),onClick:()=>src.dn.open({title:"Delete symbol set",description:"Are you sure you want to delete this symbol set?",secondaryButton:{type:"secondary",children:"Cancel"},primaryButton:{type:"primary",onClick:()=>deleteSymbolSet(id),children:"Delete"}}),className:"py-1"})]})}}];return missing&&columns.splice(1,0,{title:"Failure reason",dataIndex:"failure_reason"}),(0,jsx_runtime.jsx)(src.g3,{id:id,showHeader:missing,pagination:{pageSize},columns:columns,loading:symbolSetsLoading,dataSource:dataSource,expandable:{noIndent:!0,expandedRowRender:function RenderPropertiesTable(symbolSet){return(0,jsx_runtime.jsx)(SymbolSetStackFrames,{symbolSet:symbolSet})}}})},SymbolSetStackFrames=_ref3=>{let{symbolSet}=_ref3,{stackFrameRecords}=(0,index_esm.useValues)(stackFrameLogic.e),{loadForSymbolSet}=(0,index_esm.useActions)(stackFrameLogic.e),[activeTab,setActiveTab]=(0,react.useState)("contents");(0,react.useEffect)(()=>{loadForSymbolSet(symbolSet.id)},[loadForSymbolSet,symbolSet]);let frames=Object.values(stackFrameRecords).filter(r=>r.symbol_set_ref==symbolSet.ref);return(0,jsx_runtime.jsx)(src.JL,{size:"small",panels:frames.map(_ref4=>{let{id,raw_id,contents,context}=_ref4;return{key:id,header:raw_id,className:"py-0",content:(0,jsx_runtime.jsx)(src.TP,{activeKey:activeTab,onChange:setActiveTab,tabs:[{key:"contents",label:"Contents",content:(0,jsx_runtime.jsx)(JSONViewer.C,{src:contents,name:null})},context&&{key:"context",label:"Context",content:(0,jsx_runtime.jsx)(JSONViewer.C,{src:context,name:null})}]})}}),embedded:!0})}}}]);