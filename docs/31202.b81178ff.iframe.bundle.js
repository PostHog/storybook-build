"use strict";(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[31202],{"./products/llm_observability/frontend/LLMObservabilityScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{LLMObservabilityScene:()=>LLMObservabilityScene,scene:()=>scene});var src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),clsx_m=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),CardMeta=__webpack_require__("./frontend/src/lib/components/Cards/CardMeta.tsx"),LemonMenu=__webpack_require__("./frontend/src/lib/lemon-ui/LemonMenu/LemonMenu.tsx"),react=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),urls=__webpack_require__("./frontend/src/scenes/urls.ts"),ErrorBoundary=__webpack_require__("./frontend/src/layout/ErrorBoundary/index.ts"),themeLogic=__webpack_require__("./frontend/src/layout/navigation-3000/themeLogic.ts"),Query=__webpack_require__("./frontend/src/queries/Query/Query.tsx"),InsightDetails=__webpack_require__("./frontend/src/lib/components/Cards/InsightCard/InsightDetails.tsx"),InsightMeta=__webpack_require__("./frontend/src/lib/components/Cards/InsightCard/InsightMeta.tsx"),TopHeading=__webpack_require__("./frontend/src/lib/components/Cards/InsightCard/TopHeading.tsx"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let QueryCard=react.forwardRef(function QueryCard(_ref,ref){var _divProps$style,_theme$boxStyle;let{query,title,description,highlighted,ribbonColor,className,...divProps}=_ref,{theme}=(0,index_esm.useValues)(themeLogic.b),[areDetailsShown,setAreDetailsShown]=(0,react.useState)(!1);return(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.default)("InsightCard border",highlighted&&"InsightCard--highlighted",className),"data-attr":"insight-card",...divProps,style:{...null!==(_divProps$style=divProps?.style)&&void 0!==_divProps$style?_divProps$style:{},...null!==(_theme$boxStyle=theme?.boxStyle)&&void 0!==_theme$boxStyle?_theme$boxStyle:{}},ref:ref,children:(0,jsx_runtime.jsxs)(ErrorBoundary.S,{tags:{feature:"insight"},children:[(0,jsx_runtime.jsx)(CardMeta.I,{ribbonColor:ribbonColor,setAreDetailsShown:setAreDetailsShown,areDetailsShown:areDetailsShown,topHeading:(0,jsx_runtime.jsx)(TopHeading.l,{query:query}),content:(0,jsx_runtime.jsx)(InsightMeta.Q,{title:title,description:description}),metaDetails:(0,jsx_runtime.jsx)(InsightDetails.Mz,{query:query}),samplingFactor:"samplingFactor"in query&&"number"==typeof query.samplingFactor?query.samplingFactor:void 0,moreButtons:(0,jsx_runtime.jsx)(LemonMenu.tN,{items:[{label:"Open as new insight",to:urls.j.insightNew(void 0,void 0,query)}]}),showEditingControls:!0}),(0,jsx_runtime.jsx)("div",{className:"InsightCard__viz",children:(0,jsx_runtime.jsx)(Query.A,{query:query,readOnly:!0,embedded:!0})})]})})});var DateFilter=__webpack_require__("./frontend/src/lib/components/DateFilter/DateFilter.tsx"),PropertyFilters=__webpack_require__("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),TestAccountFiltersSwitch=__webpack_require__("./frontend/src/lib/components/TestAccountFiltersSwitch.tsx"),dataNodeCollectionLogic=__webpack_require__("./frontend/src/queries/nodes/DataNode/dataNodeCollectionLogic.ts"),DataTable=__webpack_require__("./frontend/src/queries/nodes/DataTable/DataTable.tsx"),schema_general=__webpack_require__("./frontend/src/queries/schema/schema-general.ts"),utils=__webpack_require__("./frontend/src/queries/utils.ts"),llmObservabilityLogic=__webpack_require__("./products/llm_observability/frontend/llmObservabilityLogic.tsx"),apps_common_src=__webpack_require__("./frontend/@posthog/apps-common/src/index.ts"),frontend_utils=__webpack_require__("./products/llm_observability/frontend/utils.ts");function LLMObservabilityTraces(){let{setDates,setShouldFilterTestAccounts,setPropertyFilters}=(0,index_esm.useActions)(llmObservabilityLogic.K),{tracesQuery}=(0,index_esm.useValues)(llmObservabilityLogic.K);return(0,jsx_runtime.jsx)(DataTable.w,{query:tracesQuery,setQuery:query=>{if(!(0,utils.zO)(query.source))throw Error("Invalid query");setDates(query.source.dateRange?.date_from||null,query.source.dateRange?.date_to||null),setShouldFilterTestAccounts(query.source.filterTestAccounts||!1),setPropertyFilters(query.source.properties||[])},context:{emptyStateHeading:"There were no traces in this period",emptyStateDetail:"Try changing the date range or filters.",columns:{id:{title:"ID",render:IDColumn},timestamp:{title:"Time",render:TimestampColumn},person:{title:"Person"},totalLatency:{title:"Latency",render:LatencyColumn},usage:{title:"Token Usage",render:UsageColumn},totalCost:{title:"Total Cost",render:CostColumn}}},uniqueKey:"llm-observability-traces"})}let IDColumn=_ref=>{let{record}=_ref;return(0,jsx_runtime.jsx)(apps_common_src.rU,{className:"ph-no-capture font-semibold",to:apps_common_src.jk.llmObservabilityTrace(record.id),children:record.id})},TimestampColumn=_ref2=>{let{record}=_ref2;return(0,jsx_runtime.jsx)(apps_common_src.w4,{time:record.createdAt})};TimestampColumn.displayName="TimestampColumn";let LatencyColumn=_ref3=>{let{record}=_ref3;return"number"==typeof record.totalLatency?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[record.totalLatency,"s"]}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"–"})};LatencyColumn.displayName="LatencyColumn";let UsageColumn=_ref4=>{let{record}=_ref4,usage=(0,frontend_utils.Pz)(record);return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:usage||"–"})};UsageColumn.displayName="UsageColumn";let CostColumn=_ref5=>{let{record}=_ref5;return"number"==typeof record.totalCost?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,frontend_utils.K7)(record.totalCost)}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"–"})};CostColumn.displayName="CostColumn";let scene={component:LLMObservabilityScene},Filters=()=>{let{dateFilter:{dateTo,dateFrom},shouldFilterTestAccounts,generationsQuery,propertyFilters}=(0,index_esm.useValues)(llmObservabilityLogic.K),{setDates,setShouldFilterTestAccounts,setPropertyFilters}=(0,index_esm.useActions)(llmObservabilityLogic.K);return(0,jsx_runtime.jsxs)("div",{className:"flex gap-x-4 gap-y-2 items-center flex-wrap py-4 -mt-4 mb-4 border-b",children:[(0,jsx_runtime.jsx)(DateFilter.f,{dateFrom:dateFrom,dateTo:dateTo,onChange:setDates}),(0,jsx_runtime.jsx)(PropertyFilters.t,{propertyFilters:propertyFilters,taxonomicGroupTypes:generationsQuery.showPropertyFilter,onChange:setPropertyFilters,pageKey:"llm-observability"}),(0,jsx_runtime.jsx)("div",{className:"flex-1"}),(0,jsx_runtime.jsx)(TestAccountFiltersSwitch.Z,{checked:shouldFilterTestAccounts,onChange:setShouldFilterTestAccounts})]})},Tiles=()=>{let{tiles}=(0,index_esm.useValues)(llmObservabilityLogic.K);return(0,jsx_runtime.jsx)("div",{className:"mt-2 grid grid-cols-1 @xl/dashboard:grid-cols-2 @4xl/dashboard:grid-cols-6 gap-4",children:tiles.map((_ref,i)=>{let{title,description,query}=_ref;return(0,jsx_runtime.jsx)(QueryCard,{title:title,description:description,query:{kind:schema_general.OH.InsightVizNode,source:query},className:(0,clsx_m.default)("h-96",i<3||i>=5?"@4xl/dashboard:col-span-2":"@4xl/dashboard:col-span-3")},i)})})},IngestionStatusCheck=()=>{let{hasSentAiGenerationEvent}=(0,index_esm.useValues)(llmObservabilityLogic.K);return!1!==hasSentAiGenerationEvent?null:(0,jsx_runtime.jsxs)(src.Vp,{type:"warning",className:"mt-2",children:[(0,jsx_runtime.jsx)("p",{children:(0,jsx_runtime.jsx)("strong",{children:"No LLM generation events have been detected!"})}),(0,jsx_runtime.jsxs)("p",{children:["To use the LLM Observability product, please"," ",(0,jsx_runtime.jsx)(src.rU,{to:"https://posthog.com/docs/ai-engineering/observability",children:"instrument your LLM calls with the PostHog SDK"})," ","(otherwise it'll be a little empty!)"]}),(0,jsx_runtime.jsxs)("p",{children:["To get cost information, you'll also"," ",(0,jsx_runtime.jsx)(src.rU,{to:"/pipeline/new/transformation",children:'need to enable the "AI Costs" transformation.'})]})]})};function LLMObservabilityDashboard(){return(0,jsx_runtime.jsxs)("div",{className:"@container/dashboard",children:[(0,jsx_runtime.jsx)(Filters,{}),(0,jsx_runtime.jsx)(Tiles,{})]})}function LLMObservabilityGenerations(){let{setDates,setShouldFilterTestAccounts,setPropertyFilters}=(0,index_esm.useActions)(llmObservabilityLogic.K),{generationsQuery}=(0,index_esm.useValues)(llmObservabilityLogic.K);return(0,jsx_runtime.jsx)(DataTable.w,{query:generationsQuery,setQuery:query=>{if(!(0,utils.rz)(query.source))throw Error("Invalid query");setDates(query.source.after||null,query.source.before||null),setShouldFilterTestAccounts(query.source.filterTestAccounts||!1),setPropertyFilters(query.source.properties||[])},context:{emptyStateHeading:"There were no generations in this period",emptyStateDetail:"Try changing the date range or filters."},uniqueKey:"llm-observability-generations"})}function LLMObservabilityScene(){let{activeTab}=(0,index_esm.useValues)(llmObservabilityLogic.K);return(0,jsx_runtime.jsxs)(index_esm.BindLogic,{logic:dataNodeCollectionLogic.y,props:{key:llmObservabilityLogic.E},children:[(0,jsx_runtime.jsx)(IngestionStatusCheck,{}),(0,jsx_runtime.jsx)(src.TP,{activeKey:activeTab,tabs:[{key:"dashboard",label:"Dashboard",content:(0,jsx_runtime.jsx)(LLMObservabilityDashboard,{}),link:urls.j.llmObservability("dashboard")},{key:"traces",label:"Traces",content:(0,jsx_runtime.jsx)(LLMObservabilityTraces,{}),link:urls.j.llmObservability("traces")},{key:"generations",label:"Generations",content:(0,jsx_runtime.jsx)(LLMObservabilityGenerations,{}),link:urls.j.llmObservability("generations")}]})]})}},"./products/llm_observability/frontend/llmObservabilityLogic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E:()=>LLM_OBSERVABILITY_DATA_COLLECTION_NODE_ID,K:()=>llmObservabilityLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/lib/api.ts"),lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/lib/components/TaxonomicFilter/types.ts"),lib_utils_definitions__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/lib/utils/definitions.ts"),scenes_sceneLogic__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./frontend/src/scenes/sceneLogic.ts"),_models_groupsModel__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./frontend/src/models/groupsModel.ts"),_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./frontend/src/queries/schema/schema-general.ts"),_types__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./frontend/src/types.ts");let LLM_OBSERVABILITY_DATA_COLLECTION_NODE_ID="llm-observability-data",llmObservabilityLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["products","llm_observability","frontend","llmObservabilityLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)({values:[scenes_sceneLogic__WEBPACK_IMPORTED_MODULE_5__.k,["sceneKey"]]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setDates:(dateFrom,dateTo)=>({dateFrom,dateTo}),setShouldFilterTestAccounts:shouldFilterTestAccounts=>({shouldFilterTestAccounts}),setPropertyFilters:propertyFilters=>({propertyFilters})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({dateFilter:[{dateFrom:"-7d",dateTo:null},{setDates:(_,_ref)=>{let{dateFrom,dateTo}=_ref;return{dateFrom,dateTo}}}],shouldFilterTestAccounts:[!1,{setShouldFilterTestAccounts:(_,_ref2)=>{let{shouldFilterTestAccounts}=_ref2;return shouldFilterTestAccounts}}],propertyFilters:[[],{setPropertyFilters:(_,_ref3)=>{let{propertyFilters}=_ref3;return propertyFilters}}]}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)({hasSentAiGenerationEvent:{__default:void 0,loadAIEventDefinition:async()=>{let aiGenerationDefinition=await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.eventDefinitions.list({event_type:_types__WEBPACK_IMPORTED_MODULE_8__.uW.Event,search:"$ai_generation"}),definition=aiGenerationDefinition.results.find(r=>"$ai_generation"===r.name);return!!definition&&!(0,lib_utils_definitions__WEBPACK_IMPORTED_MODULE_4__.U)(definition)}}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({activeTab:[s=>[s.sceneKey],sceneKey=>"llmObservabilityGenerations"===sceneKey?"generations":"llmObservabilityTraces"===sceneKey?"traces":"dashboard"],tiles:[s=>[s.dateFilter,s.shouldFilterTestAccounts,s.propertyFilters],(dateFilter,shouldFilterTestAccounts,propertyFilters)=>[{title:"Traces",query:{kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.TrendsQuery,series:[{event:"$ai_generation",name:"$ai_generation",kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.EventsNode,math:_types__WEBPACK_IMPORTED_MODULE_8__.mY.HogQL,math_hogql:"COUNT(DISTINCT properties.$ai_trace_id)"}],dateRange:{date_from:dateFilter.dateFrom,date_to:dateFilter.dateTo},properties:propertyFilters,filterTestAccounts:shouldFilterTestAccounts}},{title:"Generative AI users",description:"To count users, set `distinct_id` in LLM tracking.",query:{kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.TrendsQuery,series:[{event:"$ai_generation",name:"$ai_generation",kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.EventsNode,math:_types__WEBPACK_IMPORTED_MODULE_8__.vN.UniqueUsers}],dateRange:{date_from:dateFilter.dateFrom,date_to:dateFilter.dateTo},properties:propertyFilters,filterTestAccounts:shouldFilterTestAccounts}},{title:"Total cost (USD)",query:{kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.TrendsQuery,series:[{event:"$ai_generation",name:"$ai_generation",math:_types__WEBPACK_IMPORTED_MODULE_8__.O4.Sum,kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.EventsNode,math_property:"$ai_total_cost_usd"}],trendsFilter:{aggregationAxisPrefix:"$",decimalPlaces:4,display:_types__WEBPACK_IMPORTED_MODULE_8__.Qb.BoldNumber},dateRange:{date_from:dateFilter.dateFrom,date_to:dateFilter.dateTo},properties:propertyFilters,filterTestAccounts:shouldFilterTestAccounts}},{title:"Cost per user (USD)",description:"Average cost for each generative AI user active in the data point's period.",query:{kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.TrendsQuery,series:[{event:"$ai_generation",name:"$ai_generation",math:_types__WEBPACK_IMPORTED_MODULE_8__.O4.Sum,kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.EventsNode,math_property:"$ai_total_cost_usd"},{event:"$ai_generation",name:"$ai_generation",kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.EventsNode,math:_types__WEBPACK_IMPORTED_MODULE_8__.vN.UniqueUsers}],trendsFilter:{formula:"A / B",aggregationAxisPrefix:"$",decimalPlaces:2},dateRange:{date_from:dateFilter.dateFrom,date_to:dateFilter.dateTo},properties:propertyFilters,filterTestAccounts:shouldFilterTestAccounts}},{title:"Cost by model (USD)",query:{kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.TrendsQuery,series:[{event:"$ai_generation",name:"$ai_generation",math:_types__WEBPACK_IMPORTED_MODULE_8__.O4.Sum,kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.EventsNode,math_property:"$ai_total_cost_usd"}],breakdownFilter:{breakdown_type:"event",breakdown:"$ai_model"},trendsFilter:{aggregationAxisPrefix:"$",decimalPlaces:2,display:_types__WEBPACK_IMPORTED_MODULE_8__.Qb.ActionsBarValue,showValuesOnSeries:!0},dateRange:{date_from:dateFilter.dateFrom,date_to:dateFilter.dateTo},properties:propertyFilters,filterTestAccounts:shouldFilterTestAccounts}},{title:"Generation calls",query:{kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.TrendsQuery,series:[{event:"$ai_generation",name:"$ai_generation",kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.EventsNode}],dateRange:{date_from:dateFilter.dateFrom,date_to:dateFilter.dateTo},properties:propertyFilters,filterTestAccounts:shouldFilterTestAccounts}},{title:"Generation latency by model (median)",query:{kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.TrendsQuery,series:[{event:"$ai_generation",name:"$ai_generation",math:_types__WEBPACK_IMPORTED_MODULE_8__.O4.Median,kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.EventsNode,math_property:"$ai_latency"}],breakdownFilter:{breakdown:"$ai_model"},trendsFilter:{aggregationAxisPostfix:"\xa0s",decimalPlaces:3,yAxisScaleType:"log10"},dateRange:{date_from:dateFilter.dateFrom,date_to:dateFilter.dateTo},properties:propertyFilters,filterTestAccounts:shouldFilterTestAccounts}},{title:"Generations by HTTP status",query:{kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.TrendsQuery,series:[{event:"$ai_generation",name:"$ai_generation",kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.EventsNode}],breakdownFilter:{breakdown:"$ai_http_status"},trendsFilter:{display:_types__WEBPACK_IMPORTED_MODULE_8__.Qb.ActionsBarValue},dateRange:{date_from:dateFilter.dateFrom,date_to:dateFilter.dateTo},properties:propertyFilters,filterTestAccounts:shouldFilterTestAccounts}}]],tracesQuery:[s=>[s.dateFilter,s.shouldFilterTestAccounts,s.propertyFilters,_models_groupsModel__WEBPACK_IMPORTED_MODULE_6__.$.selectors.groupsTaxonomicTypes],(dateFilter,shouldFilterTestAccounts,propertyFilters,groupsTaxonomicTypes)=>({kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.DataTableNode,source:{kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.TracesQuery,dateRange:{date_from:dateFilter.dateFrom||void 0,date_to:dateFilter.dateTo||void 0},filterTestAccounts:null!=shouldFilterTestAccounts&&shouldFilterTestAccounts,properties:propertyFilters},columns:["id","person","totalLatency","usage","totalCost","timestamp"],showDateRange:!0,showReload:!0,showSearch:!0,showTestAccountFilters:!0,showExport:!0,showOpenEditorButton:!1,showPropertyFilter:[lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__.t.EventProperties,lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__.t.PersonProperties,...groupsTaxonomicTypes,lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__.t.Cohorts,lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__.t.HogQLExpression]})],generationsQuery:[s=>[s.dateFilter,s.shouldFilterTestAccounts,s.propertyFilters,_models_groupsModel__WEBPACK_IMPORTED_MODULE_6__.$.selectors.groupsTaxonomicTypes],(dateFilter,shouldFilterTestAccounts,propertyFilters,groupsTaxonomicTypes)=>({kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.DataTableNode,source:{kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_7__.OH.EventsQuery,select:["*","person","f'{properties.$ai_trace_id}' -- Trace ID","f'{properties.$ai_model}' -- Model","f'${round(toFloat(properties.$ai_total_cost_usd), 6)}' -- Total cost","f'{properties.$ai_input_tokens} → {properties.$ai_output_tokens} (∑\xa0{properties.$ai_input_tokens + properties.$ai_output_tokens})' -- Token usage","f'{properties.$ai_latency}\xa0s' -- Latency","timestamp"],orderBy:["timestamp DESC"],after:dateFilter.dateFrom||void 0,before:dateFilter.dateTo||void 0,filterTestAccounts:shouldFilterTestAccounts,event:"$ai_generation",properties:propertyFilters},showDateRange:!0,showReload:!0,showSearch:!0,showTestAccountFilters:!0,showColumnConfigurator:!0,showPropertyFilter:[lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__.t.EventProperties,lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__.t.PersonProperties,...groupsTaxonomicTypes,lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__.t.Cohorts,lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__.t.HogQLExpression],showExport:!0})]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.afterMount)(_ref4=>{let{actions}=_ref4;actions.loadAIEventDefinition()})])},"./products/llm_observability/frontend/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function formatLLMUsage(trace){return"number"==typeof trace.inputTokens?`${trace.inputTokens} → ${trace.outputTokens||0} (∑\xa0${trace.inputTokens+(trace.outputTokens||0)})`:null}function formatLLMLatency(latency){return`${Math.round(100*latency)/100}\xa0s`}__webpack_require__.d(__webpack_exports__,{DB:()=>formatLLMLatency,E4:()=>isChoicesOutput,K7:()=>formatLLMCost,Pz:()=>formatLLMUsage,bJ:()=>formatAsMarkdownJSONBlock,dw:()=>isRoleBasedMessage,ux:()=>isToolCallsArray,wQ:()=>formatToolCalls});let usdFormatter=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:4});function formatLLMCost(cost){return usdFormatter.format(cost)}function isRoleBasedMessage(input){return"object"==typeof input&&"role"in input&&"content"in input&&"string"==typeof input.role&&"string"==typeof input.content}function isChoicesOutput(input){return"object"==typeof input&&"choices"in input&&Array.isArray(input.choices)}function isToolCall(input){return"object"==typeof input&&"type"in input&&"function"in input&&"function"===input.type}function isToolCallsArray(input){return Array.isArray(input)&&input.every(isToolCall)}function formatToolCalls(toolCalls){let toolsWithParsedArguments=toolCalls.map(toolCall=>({...toolCall,function:{...toolCall.function,arguments:"string"==typeof toolCall.function.arguments?JSON.parse(toolCall.function.arguments):toolCall.function.arguments}}));return JSON.stringify(toolsWithParsedArguments,null,2)}function formatAsMarkdownJSONBlock(output){return`\`\`\`json
${output}
\`\`\``}}}]);
//# sourceMappingURL=31202.b81178ff.iframe.bundle.js.map