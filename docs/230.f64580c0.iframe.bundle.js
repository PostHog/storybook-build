(window.webpackJsonp=window.webpackJsonp||[]).push([[230,240],{"./frontend/src/lib/forms/Field.tsx":function(k,E,e){"use strict";e.d(E,"a",function(){return J});var O=e("./node_modules/@babel/runtime/helpers/extends.js"),s=e.n(O),I=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),y=e.n(I),K=e("./node_modules/core-js/modules/es.function.name.js"),ae=e.n(K),z=e("./node_modules/clsx/dist/clsx.m.js"),D=e("./node_modules/kea-forms/lib/components.js"),b=e.n(D),ie=e("./node_modules/react/index.js"),P=e.n(ie),oe=["showOptional","name"],J=function(G){var H=G.showOptional,t=G.name,u=y()(G,oe),Y=function(c){var i=c.label,f=c.kids,l=c.hint,j=c.error;return P.a.createElement("div",{className:Object(z.a)("ant-row","ant-form-item",l||j?"ant-form-item-with-help":"",j?"ant-form-item-has-error":"")},i?P.a.createElement("div",{className:"ant-col ant-form-item-label"},P.a.createElement("label",{htmlFor:String(t),title:typeof i=="string"?i:void 0},H?P.a.createElement(P.a.Fragment,null,i,H?P.a.createElement("span",{className:"ant-form-item-optional",title:""},"(optional)"):null):i)):null,P.a.createElement("div",{className:"ant-col ant-form-item-control"},P.a.createElement("div",{className:"ant-form-item-control-input"},P.a.createElement("div",{className:"ant-form-item-control-input-content"},f)),l||j?P.a.createElement("div",{className:"ant-form-item-explain ant-form-item-explain-connected"},j?P.a.createElement("div",{role:"alert",className:"ant-form-item-explain-error"},"Error: ",j):null,l?P.a.createElement("div",{role:"alert",className:"ant-form-item-explain-warning"},"Hint: ",l):null):null))};return P.a.createElement(D.Field,s()({},u,{name:t,template:Y}))};try{J.displayName="Field",J.__docgenInfo={description:"Compatible replacement for Form.Item",displayName:"Field",props:{showOptional:{defaultValue:null,description:"",name:"showOptional",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/forms/Field.tsx#Field"]={docgenInfo:J.__docgenInfo,name:"Field",path:"frontend/src/lib/forms/Field.tsx#Field"})}catch(U){}},"./frontend/src/lib/forms/VerticalForm.tsx":function(k,E,e){"use strict";e.d(E,"a",function(){return D});var O=e("./node_modules/@babel/runtime/helpers/extends.js"),s=e.n(O),I=e("./node_modules/react/index.js"),y=e.n(I),K=e("./node_modules/kea-forms/lib/index.js"),ae=e.n(K),z=e("./node_modules/clsx/dist/clsx.m.js");function D(b){return y.a.createElement(K.Form,s()({},b,{className:Object(z.a)("antd-form ant-form-vertical",b.className)}),b.children)}try{D.displayName="VerticalForm",D.__docgenInfo={description:"",displayName:"VerticalForm",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/forms/VerticalForm.tsx#VerticalForm"]={docgenInfo:D.__docgenInfo,name:"VerticalForm",path:"frontend/src/lib/forms/VerticalForm.tsx#VerticalForm"})}catch(b){}},"./frontend/src/scenes/cohorts/Cohort.tsx":function(k,E,e){"use strict";e.r(E),e.d(E,"scene",function(){return Ge}),e.d(E,"Cohort",function(){return he});var O=e("./node_modules/core-js/modules/es.object.keys.js"),s=e("./node_modules/core-js/modules/es.symbol.js"),I=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),y=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),K=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),ae=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),z=e.n(ae),D=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=e.n(D),ie=e("./node_modules/core-js/modules/es.array.concat.js"),P=e("./node_modules/core-js/modules/es.object.to-string.js"),oe=e("./node_modules/core-js/modules/es.regexp.to-string.js"),J=e("./node_modules/core-js/modules/es.array.filter.js"),U=e("./node_modules/core-js/modules/es.function.name.js"),G=e("./node_modules/core-js/modules/es.array.map.js"),H=e("./node_modules/react/index.js"),t=e.n(H),u=e("./node_modules/kea/lib/index.esm.js"),Y=e("./node_modules/kea-forms/lib/index.js"),q=e("./node_modules/antd/es/divider/index.js"),c=e("./node_modules/antd/es/row/index.js"),i=e("./node_modules/antd/es/col/index.js"),f=e("./frontend/src/types.ts"),l=e("./frontend/src/lib/constants.tsx"),j=e("./node_modules/@ant-design/icons/es/icons/PlusOutlined.js"),w=e("./node_modules/antd/lib/upload/Dragger.js"),re=e.n(w),ee=e("./frontend/src/scenes/persons/Persons.tsx"),ge=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),V=e.n(ge),de=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),ve=e.n(de),C=e("./node_modules/@babel/runtime/regenerator/index.js"),x=e.n(C),se=e("./node_modules/core-js/modules/es.symbol.description.js"),ue=e("./node_modules/core-js/modules/es.object.entries.js"),Q=e("./node_modules/core-js/modules/es.array.find-index.js"),te=e("./node_modules/core-js/modules/es.array.iterator.js"),W=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),B=e("./frontend/src/lib/api.ts"),X=e("./frontend/src/models/cohortsModel.ts"),le=e("./frontend/src/lib/utils.tsx"),Z=e("./frontend/src/scenes/persons/personsLogic.ts"),M=e("./frontend/src/lib/components/lemonToast.tsx"),R=e("./frontend/src/scenes/urls.ts"),me=e("./node_modules/kea-router/lib/index.js"),pe=e("./node_modules/kea-loaders/lib/index.js");function xe(n,o){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);o&&(a=a.filter(function(v){return Object.getOwnPropertyDescriptor(n,v).enumerable})),r.push.apply(r,a)}return r}function N(n){for(var o=1;o<arguments.length;o++){var r=arguments[o]!=null?arguments[o]:{};o%2?xe(Object(r),!0).forEach(function(a){b()(n,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):xe(Object(r)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(r,a))})}return n}function De(n){for(var o=N(N(N(N(N({},n.name?{name:n.name}:{}),n.description?{description:n.description}:{}),n.csv?{csv:n.csv}:{}),n.is_static?{is_static:n.is_static}:{}),{},{groups:JSON.stringify(n.is_static?[]:n.groups.map(function(T){return N(N({},T),{},{id:void 0,matchType:void 0})}))}),r=new FormData,a=0,v=Object.entries(o);a<v.length;a++){var g=ve()(v[a],2),h=g[0],S=g[1];r.append(h,S)}return r}function Ie(n){var o=n.action_id||n.event_id?l.f:l.p;return N({matchType:o,id:Math.random().toString().substr(2,5)},n)}function Ee(n){return n.groups&&(n.groups=n.groups.map(function(o){return Ie(o)}),n.groups=n.groups.map(function(o){return o.properties?N(N({},o),{},{properties:Object(le.r)(o.properties)}):o})),n}var ye=Ee({id:"new",groups:[{id:Math.random().toString().substr(2,5),matchType:l.p,properties:[]}]}),Ce=Object(u.kea)([Object(u.props)({}),Object(u.key)(function(n){return n.id||"new"}),Object(u.path)(["scenes","cohorts","cohortLogic"]),Object(u.actions)({saveCohort:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{cohortParams:o}},setCohort:function(o){return{cohort:o}},deleteCohort:!0,fetchCohort:function(o){return{id:o}},onCriteriaChange:function(o,r){return{newGroup:o,id:r}},setPollTimeout:function(o){return{pollTimeout:o}},checkIfFinishedCalculating:function(o){return{cohort:o}}}),Object(u.reducers)(function(){return{cohort:[ye,{onCriteriaChange:function(o,r){var a=r.newGroup,v=r.id,g=N({},o),h=g.groups.findIndex(function(S){return S.id===v});return a.matchType?g.groups[h]=N({id:g.groups[h].id,matchType:l.f},a):g.groups[h]=N(N({},g.groups[h]),a),Ee(g)}}],pollTimeout:[null,{setPollTimeout:function(o,r){var a=r.pollTimeout;return a}}]}}),Object(Y.forms)(function(n){var o=n.actions;return{cohort:{defaults:ye,errors:function(a){var v=a.name,g=a.csv,h=a.is_static,S=a.groups;return{name:v?void 0:"You need to set a name",csv:h&&!g?"You need to upload a CSV file":null,groups:h?void 0:!S||S.length<1?[{id:"You need at least one matching group"}]:S==null?void 0:S.map(function(T){var d=T.matchType,m=T.properties,$=T.action_id,A=T.event_id;return d===l.p&&!(m!=null&&m.length)?{id:"Please select at least one property or remove this match group."}:d===l.f&&!($||A)?{id:"Please select an event or action."}:{id:void 0}})}},submit:function(a){o.saveCohort(a)}}}}),Object(pe.loaders)(function(n){var o=n.actions,r=n.values,a=n.key;return{cohort:[ye,{setCohort:function(g){var h=g.cohort;return Ee(h)},fetchCohort:function(){var v=V()(x.a.mark(function h(S,T){var d,m;return x.a.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return d=S.id,A.prev=1,A.next=4,B.b.cohorts.get(d);case 4:return m=A.sent,T(),X.a.actions.updateCohort(m),o.checkIfFinishedCalculating(m),A.abrupt("return",Ee(m));case 11:return A.prev=11,A.t0=A.catch(1),M.b.error(A.t0.detail||"Failed to fetch cohort"),A.abrupt("return",r.cohort);case 15:case"end":return A.stop()}},h,null,[[1,11]])}));function g(h,S){return v.apply(this,arguments)}return g}(),saveCohort:function(){var v=V()(x.a.mark(function h(S,T){var d,m,$;return x.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(d=S.cohortParams,m=N({},d),$=De(m),p.prev=3,m.id==="new"){p.next=11;break}return p.next=7,B.b.cohorts.update(m.id,$);case 7:m=p.sent,X.a.actions.updateCohort(m),p.next=15;break;case 11:return p.next=13,B.b.cohorts.create($);case 13:m=p.sent,X.a.actions.cohortCreated(m);case 15:p.next=22;break;case 17:return p.prev=17,p.t0=p.catch(3),T(),M.b.error(p.t0.detail||"Failed to save cohort"),p.abrupt("return",r.cohort);case 22:return m.is_calculating=!0,T(),delete m.csv,o.setCohort(m),M.b.success("Cohort saved. Please wait up to a few minutes for it to be calculated",{toastId:"cohort-saved-".concat(a)}),o.checkIfFinishedCalculating(m),p.abrupt("return",m);case 29:case"end":return p.stop()}},h,null,[[3,17]])}));function g(h,S){return v.apply(this,arguments)}return g}()}]}}),Object(u.selectors)({breadcrumbs:[function(n){return[n.cohort]},function(n){return[{name:"Cohorts",path:R.a.cohorts()}].concat(z()(n?[{name:n.name||"Untitled"}]:[]))}]}),Object(u.listeners)(function(n){var o=n.actions,r=n.values;return{deleteCohort:function(){var v;(v=X.a.findMounted())===null||v===void 0||v.actions.deleteCohort(r.cohort),me.router.actions.push(R.a.cohorts())},checkIfFinishedCalculating:function(){var a=V()(x.a.mark(function g(h,S){var T,d;return x.a.wrap(function($){for(;;)switch($.prev=$.next){case 0:T=h.cohort,T.is_calculating?o.setPollTimeout(setTimeout(V()(x.a.mark(function A(){var p;return x.a.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return ce.next=2,B.b.cohorts.get(T.id);case 2:p=ce.sent,S(),o.checkIfFinishedCalculating(p);case 5:case"end":return ce.stop()}},A)})),1e3)):(o.setCohort(T),X.a.actions.updateCohort(T),(d=Z.a.findMounted({syncWithUrl:!0}))===null||d===void 0||d.actions.loadCohorts(),r.pollTimeout&&(clearTimeout(r.pollTimeout),o.setPollTimeout(null)));case 2:case"end":return $.stop()}},g)}));function v(g,h){return a.apply(this,arguments)}return v}()}}),Object(me.actionToUrl)(function(n){var o=n.values;return{saveCohortSuccess:function(){return R.a.cohort(o.cohort.id)}}}),Object(u.afterMount)(function(n){var o=n.actions,r=n.props;!r.id||r.id==="new"?o.setCohort(ye):o.fetchCohort(r.id)}),Object(u.beforeUnmount)(function(n){var o=n.values;o.pollTimeout&&clearTimeout(o.pollTimeout)})]),Me=e("./frontend/src/scenes/userLogic.ts"),He=e("./node_modules/antd/lib/dropdown/style/index.css"),Re=e("./frontend/src/lib/components/Spinner/Spinner.tsx"),Te=e("./frontend/src/lib/components/LemonButton/index.ts"),Fe=e("./frontend/src/lib/components/PageHeader.tsx"),Be=e("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),Pe=e("./frontend/src/lib/forms/Field.tsx"),Ne=e("./frontend/src/lib/forms/VerticalForm.tsx"),Ke=e("./frontend/src/lib/components/LemonSelect.tsx"),Ue=e("./frontend/src/lib/components/LemonTextArea/LemonTextArea.tsx"),Se=e("./frontend/src/lib/components/icons.tsx"),Ve=e("./frontend/src/scenes/cohorts/MatchCriteriaSelector.tsx"),We=e("./frontend/src/lib/components/Tooltip.tsx"),Oe;function Ae(n,o){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);o&&(a=a.filter(function(v){return Object.getOwnPropertyDescriptor(n,v).enumerable})),r.push.apply(r,a)}return r}function je(n){for(var o=1;o<arguments.length;o++){var r=arguments[o]!=null?arguments[o]:{};o%2?Ae(Object(r),!0).forEach(function(a){b()(n,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Ae(Object(r)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(r,a))})}return n}var Ge={component:he,logic:Ce,paramsToProps:function(o){var r=o.params.id;return{id:r&&r!=="new"?parseInt(r):"new"}}},_e=(Oe={},b()(Oe,l.b.Static,{label:"Static \xB7 Updated manually"}),b()(Oe,l.b.Dynamic,{label:"Dynamic \xB7 Updates automatically"}),Oe);function he(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=n.id,r={id:o},a=Ce(r),v=Object(u.useActions)(a),g=v.deleteCohort,h=v.setCohort,S=v.onCriteriaChange,T=Object(u.useValues)(a),d=T.cohort,m=T.cohortLoading,$=Object(u.useValues)(Me.a),A=$.hasAvailableFeature,p=d.id==="new"||d.id===void 0,Le=function(){h(je(je({},d),{},{groups:[].concat(z()(d.groups),[{id:Math.random().toString().substr(2,5),matchType:l.p,properties:[]}])}))},ce=function(F){h(je(je({},d),{},{groups:d.groups.filter(function(_,ne){return ne!==F})}))};return t.a.createElement("div",{className:"cohort"},t.a.createElement(Ne.a,{logic:Ce,props:r,formKey:"cohort",enableFormOnSubmit:!0},t.a.createElement(Fe.a,{title:p?"New cohort":d.name||"Untitled",buttons:t.a.createElement("div",{className:"flex-center"},p?t.a.createElement(Te.a,{"data-attr":"cancel-cohort",type:"secondary",onClick:function(){me.router.actions.push(R.a.cohorts())},style:{marginRight:8},disabled:m},"Cancel"):t.a.createElement(Te.a,{"data-attr":"delete-cohort",status:"danger",type:"secondary",onClick:function(){g()},style:{marginRight:8},disabled:m},"Delete"),t.a.createElement(Te.a,{type:"primary","data-attr":"save-cohort",htmlType:"submit",loading:m},"Save"))}),t.a.createElement(q.a,null),t.a.createElement(c.a,{gutter:[16,24],style:{maxWidth:640}},t.a.createElement(i.a,{xs:24,sm:12},t.a.createElement(Pe.a,{name:"name",label:"Name"},function(L){var F=L.value,_=L.onValueChange;return t.a.createElement(Be.a,{value:F,onChange:_,"data-attr":"cohort-name"})})),t.a.createElement(i.a,{xs:24,sm:12},t.a.createElement(Pe.a,{name:"is_static",label:"Type"},function(L){var F=L.value,_=L.onValueChange;return t.a.createElement(We.a,{title:p?null:"Create a new cohort to use a different type of cohort."},t.a.createElement("div",null,t.a.createElement(Ke.a,{disabled:!p,options:_e,value:F?l.b.Static:l.b.Dynamic,onChange:function(fe){_(fe===l.b.Static)},type:"stealth",outlined:!0,style:{width:"100%"},"data-attr":"cohort-type"})))}))),A(f.d.DASHBOARD_COLLABORATION)&&t.a.createElement(c.a,{gutter:[16,24],className:"mt ph-ignore-input",style:{maxWidth:640}},t.a.createElement(i.a,{span:24},t.a.createElement(Pe.a,{name:"description",label:"Description","data-attr":"cohort-description"},function(L){var F=L.value,_=L.onValueChange;return t.a.createElement(Ue.a,{value:F,onChange:_})}))),d.is_static?t.a.createElement(c.a,{gutter:24,className:"mt ph-ignore-input"},t.a.createElement(i.a,{span:24},t.a.createElement(Pe.a,{name:"csv",label:p?"Upload users":"Add users","data-attr":"cohort-csv"},function(L){var F,_,ne=L.onValueChange;return t.a.createElement(t.a.Fragment,null,t.a.createElement("span",{className:"mb"},"Upload a CSV file to add users to your cohort. The CSV file only requires a single column with the user\u2019s distinct ID."),t.a.createElement(re.a,{name:"file",multiple:!1,fileList:d.csv?[d.csv]:[],accept:".csv",showUploadList:!1,beforeUpload:function(be){return ne(be),!1},className:"cohort-csv-dragger"},d.csv?t.a.createElement(t.a.Fragment,null,t.a.createElement(Se.IconUploadFile,{style:{fontSize:"3rem",color:"var(--muted-alt)"}}),t.a.createElement("div",{className:"ant-upload-text"},(F=(_=d.csv)===null||_===void 0?void 0:_.name)!==null&&F!==void 0?F:"File chosen")):t.a.createElement(t.a.Fragment,null,t.a.createElement(Se.IconUploadFile,{style:{fontSize:"3rem",color:"var(--muted-alt)"}}),t.a.createElement("div",{className:"ant-upload-text"},"Drag a file here or click to browse for a file"))))}))):t.a.createElement(t.a.Fragment,null,t.a.createElement(q.a,null),t.a.createElement(c.a,{gutter:24,className:"mt"},t.a.createElement(i.a,{span:24},t.a.createElement(t.a.Fragment,null,t.a.createElement("div",{className:"ant-row ant-form-item ant-form-item-label",style:{display:"flex"}},t.a.createElement("label",{htmlFor:"groups",title:"Matching criteria"},"Matching criteria"),t.a.createElement("span",null,"Actors who match the following criteria will be part of the cohort. Continuously updated automatically.")),d.groups.map(function(L,F){return t.a.createElement(Y.Group,{key:F,name:["groups",F]},t.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"}},t.a.createElement(Y.Field,{name:"id",template:function(ne){var fe=ne.error,be=ne.kids;return t.a.createElement("div",{style:{padding:15,border:fe?"1px solid var(--danger)":"1px solid rgba(0, 0, 0, 0.1)",borderRadius:4,width:"100%"}},be,t.a.createElement(c.a,null,fe&&t.a.createElement("div",{style:{color:"var(--danger)",marginTop:16}},fe)))}},t.a.createElement(Ve.b,{onCriteriaChange:function(ne){return S(ne,L.id)},onRemove:function(){return ce(F)},group:L,hideRemove:d.groups.length===1})),F<d.groups.length-1&&t.a.createElement("div",{className:"stateful-badge or mt mb"},"OR")))})),t.a.createElement("span",{id:"add"}),t.a.createElement("div",{style:{marginTop:8,marginBottom:8}},t.a.createElement("a",{href:"#add",style:{padding:0},onClick:function(){return Le()},"data-attr":"add-match-criteria"},t.a.createElement(j.a,null)," Add matching criteria"))))),!p&&t.a.createElement(t.a.Fragment,null,t.a.createElement(q.a,null),t.a.createElement("div",null,t.a.createElement("h3",{className:"l3"},"Persons in this cohort"),d.is_calculating?t.a.createElement("div",{className:"cohort-recalculating flex-center"},t.a.createElement(Re.a,{size:"sm",style:{marginRight:4}}),"We're recalculating who belongs to this cohort. This could take up to a couple of minutes."):t.a.createElement("div",{style:{marginTop:15}},t.a.createElement(ee.Persons,{cohort:d.id}))))))}try{he.displayName="Cohort",he.__docgenInfo={description:"",displayName:"Cohort",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:'number | "new"'}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/cohorts/Cohort.tsx#Cohort"]={docgenInfo:he.__docgenInfo,name:"Cohort",path:"frontend/src/scenes/cohorts/Cohort.tsx#Cohort"})}catch(n){}},"./frontend/src/scenes/groups/groupsListLogic.ts":function(k,E,e){"use strict";e.d(E,"a",function(){return q});var O=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),s=e.n(O),I=e("./node_modules/@babel/runtime/regenerator/index.js"),y=e.n(I),K=e("./node_modules/core-js/modules/es.array.iterator.js"),ae=e.n(K),z=e("./node_modules/core-js/modules/es.object.to-string.js"),D=e.n(z),b=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),ie=e.n(b),P=e("./node_modules/core-js/modules/es.array.concat.js"),oe=e.n(P),J=e("./node_modules/kea/lib/index.esm.js"),U=e("./frontend/src/lib/api.ts"),G=e("./frontend/src/lib/introductions/groupsAccessLogic.ts"),H=e("./frontend/src/lib/utils.tsx"),t=e("./frontend/src/scenes/teamLogic.ts"),u=e("./frontend/src/scenes/urls.ts"),Y=e("./frontend/src/models/groupsModel.ts"),q=Object(J.kea)({path:["groups","groupsListLogic"],connect:{values:[t.a,["currentTeamId"],Y.a,["groupTypes","aggregationLabel"],G.b,["groupsEnabled"]]},actions:function(){return{loadGroups:function(f){return{url:f}},setTab:function(f){return{tab:f}}}},loaders:function(i){var f=i.values;return{groups:[{next:null,previous:null,results:[]},{loadGroups:function(){var l=s()(y.a.mark(function w(re){var ee;return y.a.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(ee=re.url,!f.groupsEnabled){V.next=6;break}return ee=ee||"api/projects/".concat(f.currentTeamId,"/groups/?group_type_index=").concat(f.currentTab),V.next=5,U.b.get(ee);case 5:return V.abrupt("return",V.sent);case 6:case"end":return V.stop()}},w)}));function j(w){return l.apply(this,arguments)}return j}()}]}},reducers:{currentTab:["-1",{setTab:function(i,f){var l=f.tab;return l}}]},selectors:{currentTabName:[function(c){return[c.currentTab,c.groupTypes,c.aggregationLabel]},function(c,i,f){return c==="-1"?"Persons":i!=null&&i.length?Object(H.i)(f(parseInt(c)).singular):""}],breadcrumbs:[function(c){return[c.currentTabName,c.currentTab]},function(c,i){return[{name:c,path:u.a.groups(i)}]}]},actionToUrl:function(){return{setTab:function(f){var l=f.tab;return l!=="-1"?u.a.groups(l):u.a.persons()}}},urlToAction:function(i){var f=i.actions,l=i.values;return{"/groups/:id":function(w){var re=w.id;re&&(f.setTab(re),f.loadGroups())},"/persons":function(){l.currentTab!=="-1"&&f.setTab("-1")}}}})},"./frontend/src/scenes/persons/PersonPageHeader.tsx":function(k,E,e){"use strict";e.d(E,"a",function(){return U});var O=e("./node_modules/kea/lib/index.esm.js"),s=e("./frontend/src/lib/components/PageHeader.tsx"),I=e("./node_modules/react/index.js"),y=e.n(I),K=e("./node_modules/core-js/modules/es.array.includes.js"),ae=e("./node_modules/core-js/modules/es.string.includes.js"),z=e("./node_modules/core-js/modules/es.array.map.js"),D=e("./node_modules/antd/es/tabs/index.js"),b=e("./frontend/src/lib/introductions/groupsAccessLogic.ts"),ie=e("./frontend/src/lib/utils.tsx"),P=e("./frontend/src/models/groupsModel.ts"),oe=e("./frontend/src/scenes/groups/groupsListLogic.ts");function J(){var G=Object(O.useActions)(oe.a),H=G.setTab,t=Object(O.useValues)(oe.a),u=t.currentTab,Y=Object(O.useValues)(P.a),q=Y.groupTypes,c=Y.aggregationLabel,i=Object(O.useValues)(b.b),f=i.groupsAccessStatus,l=[b.a.HasAccess,b.a.HasGroupTypes,b.a.NoAccess].includes(f);return y.a.createElement(D.a,{activeKey:u,onChange:function(w){return H(w)}},y.a.createElement(D.a.TabPane,{tab:"Persons",key:"-1"}),l?y.a.createElement(D.a.TabPane,{tab:"Introducing Group Analytics",key:"0"}):q.map(function(j){return y.a.createElement(D.a.TabPane,{tab:Object(ie.i)(c(j.group_type_index).plural),key:j.group_type_index})}))}function U(G){var H=G.hideGroupTabs,t=Object(O.useValues)(P.a),u=t.showGroupsOptions;return y.a.createElement(y.a.Fragment,null,y.a.createElement(s.a,{title:"Persons".concat(u?" & Groups":""),caption:"A catalog of your product's end users".concat(u?" and groups":"",".")}),!H&&u&&y.a.createElement(J,null))}try{U.displayName="PersonPageHeader",U.__docgenInfo={description:"",displayName:"PersonPageHeader",props:{hideGroupTabs:{defaultValue:null,description:"",name:"hideGroupTabs",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"]={docgenInfo:U.__docgenInfo,name:"PersonPageHeader",path:"frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"})}catch(G){}},"./frontend/src/scenes/persons/Persons.scss":function(k,E,e){"use strict";var O=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),s=e.n(O),I=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/persons/Persons.scss"),y=e.n(I),K={};K.insert="head",K.singleton=!1;var ae=s()(y.a,K),z=y.a.locals||{}},"./frontend/src/scenes/persons/Persons.tsx":function(k,E,e){"use strict";e.r(E),e.d(E,"scene",function(){return V}),e.d(E,"Persons",function(){return de}),e.d(E,"PersonsScene",function(){return ve});var O=e("./node_modules/react/index.js"),s=e.n(O),I=e("./node_modules/kea/lib/index.esm.js"),y=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),K=e.n(y),ae=e("./node_modules/core-js/modules/es.array.concat.js"),z=e("./node_modules/core-js/modules/es.object.keys.js"),D=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),b=e("./frontend/src/lib/components/PropertiesTable.tsx"),ie=e("./frontend/src/scenes/persons/Persons.scss"),P=e("./frontend/src/lib/components/CopyToClipboard.tsx"),oe=e("./frontend/src/scenes/persons/PersonHeader.tsx"),J=e("./frontend/src/lib/components/LemonTable/index.ts");function U(C){var x=C.people,se=C.loading,ue=se===void 0?!1:se,Q=C.hasPrevious,te=C.hasNext,W=C.loadPrevious,B=C.loadNext,X=C.compact,le=[{title:"Person",key:"person",render:function(M,R){return s.a.createElement(oe.a,{withIcon:!0,person:R})}},{title:"ID",key:"id",render:function(M,R){return s.a.createElement("div",{style:{overflow:"hidden"}},R.distinct_ids.length&&s.a.createElement(P.a,{explicitValue:R.distinct_ids[0],iconStyle:{color:"var(--primary)"},description:"person distinct ID"},R.distinct_ids[0]))}}].concat(K()(X?[]:[{title:"First seen",dataIndex:"created_at",render:function(M){return M?s.a.createElement(D.b,{time:M}):s.a.createElement(s.a.Fragment,null)}}]));return s.a.createElement(J.a,{columns:le,loading:ue,rowKey:"id",pagination:{controlled:!0,pageSize:100,onForward:te?function(){B==null||B(),window.scrollTo(0,0)}:void 0,onBackward:Q?function(){W==null||W(),window.scrollTo(0,0)}:void 0},expandable:{expandedRowRender:function(M){var R=M.properties;return Object.keys(R).length?s.a.createElement(b.a,{properties:R}):"This person has no properties."}},dataSource:x,emptyState:"No persons",nouns:["person","persons"]})}try{U.displayName="PersonsTable",U.__docgenInfo={description:"",displayName:"PersonsTable",props:{people:{defaultValue:null,description:"",name:"people",required:!0,type:{name:"PersonType[]"}},loading:{defaultValue:{value:"false"},description:"",name:"loading",required:!1,type:{name:"boolean"}},hasPrevious:{defaultValue:null,description:"",name:"hasPrevious",required:!1,type:{name:"boolean"}},hasNext:{defaultValue:null,description:"",name:"hasNext",required:!1,type:{name:"boolean"}},loadPrevious:{defaultValue:null,description:"",name:"loadPrevious",required:!1,type:{name:"(() => void)"}},loadNext:{defaultValue:null,description:"",name:"loadNext",required:!1,type:{name:"(() => void)"}},compact:{defaultValue:null,description:"",name:"compact",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"]={docgenInfo:U.__docgenInfo,name:"PersonsTable",path:"frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"})}catch(C){}var G=e("./node_modules/antd/es/row/index.js"),H=e("./node_modules/antd/es/popconfirm/index.js"),t=e("./frontend/src/scenes/persons/personsLogic.ts"),u=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),Y=e.n(u),q=e("./node_modules/core-js/modules/es.regexp.exec.js"),c=e("./node_modules/core-js/modules/es.string.search.js"),i=e("./node_modules/antd/es/input/index.js"),f=e("./frontend/src/lib/components/LemonRow/index.ts"),l=e("./frontend/src/lib/components/icons.tsx"),j=function(x){var se=x.autoFocus,ue=se===void 0?!0:se,Q=Object(I.useActions)(t.a),te=Q.loadPersons,W=Q.setListFilters,B=Object(I.useValues)(t.a),X=B.listFilters,le=Object(O.useState)(""),Z=Y()(le,2),M=Z[0],R=Z[1];return Object(O.useEffect)(function(){R(X.search||"")},[]),s.a.createElement("div",{style:{display:"flex",alignItems:"center",width:"min(100%, 24rem)"}},s.a.createElement(i.a.Search,{"data-attr":"persons-search",placeholder:"Search for persons",autoFocus:ue,value:M,onChange:function(pe){R(pe.target.value),pe.target.value||(W({search:void 0}),te())},enterButton:!0,onPressEnter:function(pe){pe.preventDefault(),W({search:M||void 0}),te()},allowClear:!0,onSearch:function(){W({search:M||void 0}),te()},style:{width:"100%"}}),s.a.createElement(f.a,{className:"ml-05",type:"stealth",tooltip:s.a.createElement(s.a.Fragment,null,"Search by email, name, ID, or even contents of properties. You can also search for persons who just ",s.a.createElement("i",null,"have"),' a property like so: "has:your_property".'),icon:s.a.createElement(l.IconInfo,null)}))};try{j.displayName="PersonsSearch",j.__docgenInfo={description:"",displayName:"PersonsSearch",props:{autoFocus:{defaultValue:{value:"true"},description:"",name:"autoFocus",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonsSearch.tsx#PersonsSearch"]={docgenInfo:j.__docgenInfo,name:"PersonsSearch",path:"frontend/src/scenes/persons/PersonsSearch.tsx#PersonsSearch"})}catch(C){}var w=e("./frontend/src/scenes/persons/PersonPageHeader.tsx"),re=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),ee=e("./frontend/src/lib/components/TaxonomicFilter/types.ts"),ge=e("./frontend/src/lib/components/LemonButton/index.ts"),V={component:ve,logic:t.a,paramsToProps:function(){return{syncWithUrl:!0}}};function de(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},x=C.cohort;return s.a.createElement(I.BindLogic,{logic:t.a,props:{cohort:x,syncWithUrl:!x}},s.a.createElement(ve,null))}function ve(){var C=Object(I.useActions)(t.a),x=C.loadPersons,se=C.setListFilters,ue=C.exportCsv,Q=Object(I.useValues)(t.a),te=Q.cohortId,W=Q.persons,B=Q.listFilters,X=Q.personsLoading,le=Q.exportUrl;return s.a.createElement("div",{className:"persons-list"},!te&&s.a.createElement(w.a,null),s.a.createElement(G.a,{align:"middle",justify:"space-between",className:"mb-05",style:{gap:"0.75rem"}},s.a.createElement(j,{autoFocus:!te}),s.a.createElement("div",null,s.a.createElement(H.a,{placement:"topRight",title:s.a.createElement(s.a.Fragment,null,"Exporting by csv is limited to 10,000 users.",s.a.createElement("br",null),"To return more, please use ",s.a.createElement("a",{href:"https://posthog.com/docs/api/persons"},"the API"),". Do you want to export by CSV?"),onConfirm:ue},le&&s.a.createElement(ge.a,{type:"secondary",icon:s.a.createElement(l.IconExport,{style:{color:"var(--primary)"}})},B.properties&&B.properties.length>0?s.a.createElement("div",{style:{display:"block"}},"Export (",s.a.createElement("strong",null,B.properties.length)," filter)"):"Export")))),s.a.createElement(re.a,{pageKey:"persons-list-page",propertyFilters:B.properties,onChange:function(M){se({properties:M}),x()},endpoint:"person",taxonomicGroupTypes:[ee.a.PersonProperties,ee.a.Cohorts],showConditionBadge:!0}),s.a.createElement(U,{people:W.results,loading:X,hasPrevious:!!W.previous,hasNext:!!W.next,loadPrevious:function(){return x(W.previous)},loadNext:function(){return x(W.next)}}))}try{de.displayName="Persons",de.__docgenInfo={description:"",displayName:"Persons",props:{cohort:{defaultValue:null,description:"",name:"cohort",required:!1,type:{name:'number | "new"'}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/Persons.tsx#Persons"]={docgenInfo:de.__docgenInfo,name:"Persons",path:"frontend/src/scenes/persons/Persons.tsx#Persons"})}catch(C){}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/persons/Persons.scss":function(k,E,e){var O=e("./node_modules/css-loader/dist/runtime/api.js");E=O(!1),E.push([k.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.extra-ids{display:inline-flex;align-items:center;height:1.25rem;line-height:1.125rem;margin:0 0 0 .25rem;padding:0 .25rem 0 .375rem;color:#5375ff;cursor:pointer}.extra-ids svg{margin-left:.25rem}",""]),k.exports=E}}]);
