(window.webpackJsonp=window.webpackJsonp||[]).push([[226],{4369:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return experimentsLogic}));__webpack_require__(41),__webpack_require__(63),__webpack_require__(49),__webpack_require__(42),__webpack_require__(53);var regenerator=__webpack_require__(8),regenerator_default=__webpack_require__.n(regenerator),asyncToGenerator=(__webpack_require__(70),__webpack_require__(13)),asyncToGenerator_default=__webpack_require__.n(asyncToGenerator),index_esm=__webpack_require__(1),api=(__webpack_require__(90),__webpack_require__(3),__webpack_require__(23)),constants=(__webpack_require__(32),__webpack_require__(21));var api_mock_api=api.a;constants.s.Admin,constants.s.Admin;var teamLogic=__webpack_require__(31),CheckCircleOutlined=__webpack_require__(456),react_toastify=__webpack_require__(68),react=__webpack_require__(0),react_default=__webpack_require__.n(react),experimentsLogic=Object(index_esm.kea)({path:["scenes","experiments","experimentsLogic"],connect:{values:[teamLogic.a,["currentTeamId"]]},actions:{},loaders:function loaders(_ref){var _deleteExperiment,_loadExperiments,values=_ref.values;return{experiments:[[],{loadExperiments:(_loadExperiments=asyncToGenerator_default()(regenerator_default.a.mark((function _callee(){var response;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,api_mock_api.get("api/projects/".concat(values.currentTeamId,"/experiments"));case 2:return response=_context.sent,_context.abrupt("return",response.results);case 4:case"end":return _context.stop()}}),_callee)}))),function loadExperiments(){return _loadExperiments.apply(this,arguments)}),deleteExperiment:(_deleteExperiment=asyncToGenerator_default()(regenerator_default.a.mark((function _callee2(id){return regenerator_default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api_mock_api.delete("api/projects/".concat(values.currentTeamId,"/experiments/").concat(id));case 2:return Object(react_toastify.c)(react_default.a.createElement("div",null,react_default.a.createElement("h1",{className:"text-success"},react_default.a.createElement(CheckCircleOutlined.a,null)," Experiment removed"))),_context2.abrupt("return",values.experiments.filter((function(experiment){return experiment.id!==id})));case 4:case"end":return _context2.stop()}}),_callee2)}))),function deleteExperiment(_x){return _deleteExperiment.apply(this,arguments)})}]}},events:function events(_ref2){var actions=_ref2.actions;return{afterMount:function afterMount(){actions.loadExperiments()}}}})},4479:function(module,exports,__webpack_require__){(exports=__webpack_require__(50)(!1)).push([module.i,'.mixin-gradient-overlay{width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent)}.mixin-gradient-overlay,.mixin-gradient-overlay-right{content:"";position:absolute;pointer-events:none;bottom:0}.mixin-gradient-overlay-right{width:3rem;height:100%;background:linear-gradient(270deg,#fff,transparent)}.text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.experiment-form .metrics-selection{border-top:1px solid rgba(0,0,0,.15);padding-top:1rem;margin-top:1rem}.experiment-form .metrics-selection .action-filters-bordered .draggable-action-filter{border-bottom:1px solid rgba(0,0,0,.15);padding:1rem .25rem;margin-top:0}.experiment-form .metrics-selection .action-filters-bordered .row-action-btn{color:#35416b}.experiment-form .insights-graph-container{margin-bottom:1rem;background-color:#fff}.experiment-form .insights-graph-container .ant-card-head{border-bottom:1px solid rgba(0,0,0,.15);min-height:unset;background-color:#fff;padding-left:1rem;padding-right:1rem}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title{padding:.5rem 0}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter{font-size:14px}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter:not(:last-child),.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter span.head-title-item{margin-right:.5rem}.experiment-form .insights-graph-container .display-config-inner{display:flex;align-items:center;justify-content:space-between;overflow-x:auto}.experiment-form .insights-graph-container .ant-card-body{padding:0}.experiment-form .insights-graph-container .insights-graph-container-row .insights-graph-container-row-left{width:100%}.experiment-form .insights-graph-container .insights-graph-container-row .insights-graph-container-row-right{width:100%;height:min(calc(90vh - 16rem),36rem);max-width:300px;padding:0 1rem 1rem 0;display:flex;align-items:center}.experiment-form .insights-graph-container .graph-container{width:calc(100% - 48px);height:calc(100% - 48px);margin-top:2rem}.experiment-form .insights-graph-header{margin-top:0!important;margin-bottom:0!important;padding-left:1rem;padding-right:1rem;min-height:48px}.experiment-form .experiment-preview,.experiment-form .experiment-preview .preview-row{margin-bottom:1rem;border-bottom:1px solid rgba(0,0,0,.15)}.experiment-form .experiment-preview .preview-row{padding-bottom:1rem}.experiment-form .feature-flag-variant{border:1px solid rgba(0,0,0,.15);border-radius:4px;padding-left:12px;padding-top:.5rem;padding-bottom:.5rem;margin-top:20px}.experiment-form .feature-flag-variant .ant-form-item-explain-error{padding-top:.5rem}.experiment-form .ant-input-number-disabled,.experiment-form .ant-input[disabled]{color:#000}.view-experiment .draft-header{margin-bottom:1rem;border-bottom:1px solid rgba(0,0,0,.15)}.view-experiment .stop-experiment{background-color:#f96132;color:#fff}.view-experiment .description{font-style:italic;color:rgba(0,0,0,.5)}.view-experiment .participants{background-color:#fff}.view-experiment .participants .ant-collapse-header{padding-top:.5rem;padding-bottom:.5rem;padding-left:.75rem}.view-experiment .variants-list{list-style:none;margin:0;padding:0}.view-experiment .variants-list li{display:inline}.view-experiment .variants-list li:after{content:", "}.view-experiment .variants-list li:last-child:after{content:""}.view-experiment .experiment-result{padding-top:1rem;border-top:1px solid rgba(0,0,0,.15)}',""]),module.exports=exports},4480:function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(67),_interopRequireDefault=__webpack_require__(22);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _objectSpread2=_interopRequireDefault(__webpack_require__(80)),React=_interopRequireWildcard(__webpack_require__(0)),_SaveOutlined=_interopRequireDefault(__webpack_require__(4481)),_AntdIcon=_interopRequireDefault(__webpack_require__(107)),SaveOutlined=function SaveOutlined(props,ref){return React.createElement(_AntdIcon.default,(0,_objectSpread2.default)((0,_objectSpread2.default)({},props),{},{ref:ref,icon:_SaveOutlined.default}))};SaveOutlined.displayName="SaveOutlined";var _default=React.forwardRef(SaveOutlined);exports.default=_default},4481:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"}},4731:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene})),__webpack_require__.d(__webpack_exports__,"Experiment",(function(){return Experiment_Experiment})),__webpack_require__.d(__webpack_exports__,"CodeLanguageSelect",(function(){return CodeLanguageSelect}));__webpack_require__(227),__webpack_require__(240),__webpack_require__(41),__webpack_require__(63),__webpack_require__(34),__webpack_require__(64),__webpack_require__(228),__webpack_require__(506),__webpack_require__(42),__webpack_require__(122);var defineProperty=__webpack_require__(3),defineProperty_default=__webpack_require__.n(defineProperty),slicedToArray=__webpack_require__(12),slicedToArray_default=__webpack_require__.n(slicedToArray),SaveOutlined=__webpack_require__(4480),SaveOutlined_default=__webpack_require__.n(SaveOutlined),es_form=__webpack_require__(317),row=__webpack_require__(380),col=__webpack_require__(347),input=__webpack_require__(458),input_number=__webpack_require__(4249),tooltip=__webpack_require__(288),es_button=__webpack_require__(133),es_select=__webpack_require__(295),card=__webpack_require__(4255),tag=__webpack_require__(1241),progress=__webpack_require__(2560),index_esm=__webpack_require__(1),PageHeader=__webpack_require__(296),PropertyFilters=__webpack_require__(312),utils=__webpack_require__(166),types=__webpack_require__(40),react=__webpack_require__(0),react_default=__webpack_require__.n(react),funnelLogic=__webpack_require__(69),ActionFilter=__webpack_require__(400),insightLogic=__webpack_require__(24),src_types=__webpack_require__(6),injectStylesIntoStyleTag=__webpack_require__(20),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),Experiment=__webpack_require__(4479),Experiment_default=__webpack_require__.n(Experiment),options={insert:"head",singleton:!1},regenerator=(injectStylesIntoStyleTag_default()(Experiment_default.a,options),Experiment_default.a.locals,__webpack_require__(1246),__webpack_require__(140),__webpack_require__(49),__webpack_require__(644),__webpack_require__(1887),__webpack_require__(121),__webpack_require__(241),__webpack_require__(53),__webpack_require__(8)),regenerator_default=__webpack_require__.n(regenerator),asyncToGenerator=(__webpack_require__(70),__webpack_require__(13)),asyncToGenerator_default=__webpack_require__.n(asyncToGenerator),toConsumableArray=__webpack_require__(15),toConsumableArray_default=__webpack_require__.n(toConsumableArray),api=__webpack_require__(23),dayjs=__webpack_require__(37),lib_utils=__webpack_require__(11),randomAnimal=__webpack_require__(2453),react_toastify=__webpack_require__(68),cleanFilters=__webpack_require__(117),teamLogic=__webpack_require__(31),urls=__webpack_require__(18),lib=__webpack_require__(32),experimentsLogic=__webpack_require__(4369),constants=__webpack_require__(21),trendsLogic=__webpack_require__(202);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var experimentLogic=Object(index_esm.kea)({path:["scenes","experiment","experimentLogic"],connect:{values:[teamLogic.a,["currentTeamId"]],actions:[experimentsLogic.a,["loadExperiments"]]},actions:{setExperiment:function setExperiment(experiment){return{experiment:experiment}},createExperiment:function createExperiment(draft,runningTime,sampleSize){return{draft:draft,runningTime:runningTime,sampleSize:sampleSize}},setExperimentInsightId:function setExperimentInsightId(shortId){return{shortId:shortId}},createNewExperimentInsight:function createNewExperimentInsight(filters){return{filters:filters}},setFilters:function setFilters(filters){return{filters:filters}},setExperimentId:function setExperimentId(experimentId){return{experimentId:experimentId}},setNewExperimentData:function setNewExperimentData(experimentData){return{experimentData:experimentData}},updateExperimentGroup:function updateExperimentGroup(variant,idx){return{variant:variant,idx:idx}},removeExperimentGroup:function removeExperimentGroup(idx){return{idx:idx}},setExperimentInsightType:function setExperimentInsightType(insightType){return{insightType:insightType}},resetNewExperiment:!0,launchExperiment:!0,endExperiment:!0,editExperiment:!0,addExperimentGroup:!0},reducers:{experimentId:[null,{setExperimentId:function setExperimentId(_,_ref){return _ref.experimentId}}],newExperimentData:[null,{setNewExperimentData:function setNewExperimentData(vals,_ref2){var experimentData=_ref2.experimentData;if(experimentData.filters){var newFilters=_objectSpread(_objectSpread({},null==vals?void 0:vals.filters),experimentData.filters);return _objectSpread(_objectSpread(_objectSpread({},vals),experimentData),{},{filters:newFilters})}return _objectSpread(_objectSpread({},vals),experimentData)},updateExperimentGroup:function updateExperimentGroup(state,_ref3){var _state$parameters,variant=_ref3.variant,idx=_ref3.idx,featureFlagVariants=toConsumableArray_default()((null==state||null===(_state$parameters=state.parameters)||void 0===_state$parameters?void 0:_state$parameters.feature_flag_variants)||[]);return featureFlagVariants[idx]=_objectSpread(_objectSpread({},featureFlagVariants[idx]),variant),_objectSpread(_objectSpread({},state),{},{parameters:_objectSpread(_objectSpread({},null==state?void 0:state.parameters),{},{feature_flag_variants:featureFlagVariants})})},addExperimentGroup:function addExperimentGroup(state){var _state$parameters2;if(null==state||null===(_state$parameters2=state.parameters)||void 0===_state$parameters2?void 0:_state$parameters2.feature_flag_variants){var newRolloutPercentages=percentageDistribution(state.parameters.feature_flag_variants.length+1),updatedRolloutPercentageVariants=state.parameters.feature_flag_variants.map((function(variant,i){return _objectSpread(_objectSpread({},variant),{},{rollout_percentage:newRolloutPercentages[i]})}));return _objectSpread(_objectSpread({},state),{},{parameters:_objectSpread(_objectSpread({},state.parameters),{},{feature_flag_variants:[].concat(toConsumableArray_default()(updatedRolloutPercentageVariants),[{key:"test_group_".concat(state.parameters.feature_flag_variants.length),rollout_percentage:newRolloutPercentages[newRolloutPercentages.length-1]}])})})}return state},removeExperimentGroup:function removeExperimentGroup(state,_ref4){var _state$parameters3,_state$parameters4,idx=_ref4.idx;if(!state)return state;var variants=toConsumableArray_default()((null===(_state$parameters3=state.parameters)||void 0===_state$parameters3?void 0:_state$parameters3.feature_flag_variants)||[]);variants.splice(idx,1);var newRolloutPercentages=percentageDistribution((null==state||null===(_state$parameters4=state.parameters)||void 0===_state$parameters4?void 0:_state$parameters4.feature_flag_variants.length)-1),updatedVariants=variants.map((function(variant,i){return _objectSpread(_objectSpread({},variant),{},{rollout_percentage:newRolloutPercentages[i]})}));return _objectSpread(_objectSpread({},state),{},{parameters:_objectSpread(_objectSpread({},state.parameters),{},{feature_flag_variants:updatedVariants})})},resetNewExperiment:function resetNewExperiment(){return{parameters:{feature_flag_variants:[{key:"control",rollout_percentage:50},{key:"test",rollout_percentage:50}]}}}}],experimentInsightType:[src_types.p.FUNNELS,{setExperimentInsightType:function setExperimentInsightType(_,_ref5){return _ref5.insightType}}],experimentInsightId:[null,{setExperimentInsightId:function setExperimentInsightId(_,_ref6){return _ref6.shortId}}],editingExistingExperiment:[!1,{editExperiment:function editExperiment(){return!0},createExperiment:function createExperiment(){return!1}}]},listeners:function listeners(_ref7){var _endExperiment,_launchExperiment,_loadExperimentSuccess,_createNewExperimentInsight,_createExperiment,values=_ref7.values,actions=_ref7.actions;return{createExperiment:(_createExperiment=asyncToGenerator_default()(regenerator_default.a.mark((function _callee(_ref8){var _values$newExperiment,_response,draft,runningTime,sampleSize,response,isUpdate,_values$newExperiment2,_values$newExperiment3,experimentId;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(draft=_ref8.draft,runningTime=_ref8.runningTime,sampleSize=_ref8.sampleSize,response=null,isUpdate=!!(null===(_values$newExperiment=values.newExperimentData)||void 0===_values$newExperiment?void 0:_values$newExperiment.id),_context.prev=3,!(null===(_values$newExperiment2=values.newExperimentData)||void 0===_values$newExperiment2?void 0:_values$newExperiment2.id)){_context.next=10;break}return _context.next=7,api.a.update("api/projects/".concat(values.currentTeamId,"/experiments/").concat(values.experimentId),_objectSpread(_objectSpread({},values.newExperimentData),{},{parameters:_objectSpread(_objectSpread({},values.newExperimentData.parameters),{},{recommended_running_time:runningTime,recommended_sample_size:sampleSize})},!draft&&{start_date:Object(dayjs.a)()}));case 7:response=_context.sent,_context.next=13;break;case 10:return _context.next=12,api.a.create("api/projects/".concat(values.currentTeamId,"/experiments"),_objectSpread(_objectSpread({},values.newExperimentData),{},{parameters:_objectSpread(_objectSpread({},null===(_values$newExperiment3=values.newExperimentData)||void 0===_values$newExperiment3?void 0:_values$newExperiment3.parameters),{},{recommended_running_time:runningTime,recommended_sample_size:sampleSize})},!draft&&{start_date:Object(dayjs.a)()}));case 12:response=_context.sent;case 13:_context.next=19;break;case 15:return _context.prev=15,_context.t0=_context.catch(3),Object(lib_utils.y)("Error creating your experiment","Attempting to create this experiment returned an error:",0!==_context.t0.status?_context.t0.detail:"Check your internet connection and make sure you don't have an extension blocking our requests.",_context.t0.code),_context.abrupt("return");case 19:(null===(_response=response)||void 0===_response?void 0:_response.id)&&(experimentId=response.id,react_toastify.c.success(react_default.a.createElement("div",{"data-attr":"success-toast"},react_default.a.createElement("h1",null,"Experiment ",isUpdate?"updated":"created"," successfully!"),!isUpdate&&react_default.a.createElement("p",null,"Click here to view this experiment.")),{onClick:function onClick(){lib.router.actions.push(urls.a.experiment(experimentId))},closeOnClick:!0,onClose:function onClose(){lib.router.actions.push(urls.a.experiment(experimentId))}}));case 20:case"end":return _context.stop()}}),_callee,null,[[3,15]])}))),function createExperiment(_x){return _createExperiment.apply(this,arguments)}),createNewExperimentInsight:(_createNewExperimentInsight=asyncToGenerator_default()(regenerator_default.a.mark((function _callee2(_ref9){var filters,newInsightFilters,newInsight,createdInsight;return regenerator_default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return filters=_ref9.filters,newInsightFilters=values.experimentInsightType===src_types.p.FUNNELS?Object(cleanFilters.a)(_objectSpread({insight:src_types.p.FUNNELS,funnel_viz_type:src_types.l.Steps,display:src_types.d.FunnelViz,date_from:Object(dayjs.a)().subtract(14,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(dayjs.a)().endOf("d").format("YYYY-MM-DDTHH:mm"),layout:constants.q.horizontal},filters)):Object(cleanFilters.a)(_objectSpread({insight:src_types.p.TRENDS,date_from:Object(dayjs.a)().subtract(14,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(dayjs.a)().endOf("d").format("YYYY-MM-DDTHH:mm")},filters)),newInsight={name:Object(randomAnimal.a)(),description:"",tags:[],filters:newInsightFilters,result:null},_context2.next=5,api.a.create("api/projects/".concat(teamLogic.a.values.currentTeamId,"/insights"),newInsight);case 5:createdInsight=_context2.sent,actions.setExperimentInsightId(createdInsight.short_id),actions.setNewExperimentData({filters:_objectSpread({},newInsight.filters)});case 8:case"end":return _context2.stop()}}),_callee2)}))),function createNewExperimentInsight(_x2){return _createNewExperimentInsight.apply(this,arguments)}),setFilters:function setFilters(_ref10){var _funnelLogic$findMoun,_trendsLogic$findMoun,filters=_ref10.filters;values.experimentInsightType===src_types.p.FUNNELS?null===(_funnelLogic$findMoun=funnelLogic.a.findMounted({dashboardItemId:values.experimentInsightId}))||void 0===_funnelLogic$findMoun||_funnelLogic$findMoun.actions.setFilters(filters):null===(_trendsLogic$findMoun=trendsLogic.a.findMounted({dashboardItemId:values.experimentInsightId}))||void 0===_trendsLogic$findMoun||_trendsLogic$findMoun.actions.setFilters(filters)},loadExperimentSuccess:(_loadExperimentSuccess=asyncToGenerator_default()(regenerator_default.a.mark((function _callee3(_ref11){var experimentData;return regenerator_default.a.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:experimentData=_ref11.experimentData,actions.setExperimentInsightType((null==experimentData?void 0:experimentData.filters.insight)||src_types.p.FUNNELS),(null==experimentData?void 0:experimentData.start_date)||(actions.setNewExperimentData(_objectSpread({},experimentData)),actions.createNewExperimentInsight(null==experimentData?void 0:experimentData.filters));case 3:case"end":return _context3.stop()}}),_callee3)}))),function loadExperimentSuccess(_x3){return _loadExperimentSuccess.apply(this,arguments)}),launchExperiment:(_launchExperiment=asyncToGenerator_default()(regenerator_default.a.mark((function _callee4(){var response;return regenerator_default.a.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,api.a.update("api/projects/".concat(values.currentTeamId,"/experiments/").concat(values.experimentId),{start_date:Object(dayjs.a)()});case 2:response=_context4.sent,actions.setExperimentId(response.id||"new"),actions.loadExperiment();case 5:case"end":return _context4.stop()}}),_callee4)}))),function launchExperiment(){return _launchExperiment.apply(this,arguments)}),endExperiment:(_endExperiment=asyncToGenerator_default()(regenerator_default.a.mark((function _callee5(){var response;return regenerator_default.a.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,api.a.update("api/projects/".concat(values.currentTeamId,"/experiments/").concat(values.experimentId),{end_date:Object(dayjs.a)()});case 2:response=_context5.sent,actions.setExperimentId(response.id||"new"),actions.loadExperiment();case 5:case"end":return _context5.stop()}}),_callee5)}))),function endExperiment(){return _endExperiment.apply(this,arguments)}),setExperimentInsightType:function setExperimentInsightType(){var _values$experimentDat;"new"===values.experimentId?actions.createNewExperimentInsight():actions.createNewExperimentInsight(null===(_values$experimentDat=values.experimentData)||void 0===_values$experimentDat?void 0:_values$experimentDat.filters)}}},loaders:function loaders(_ref12){var _loadExperimentResults,_loadExperiment,values=_ref12.values;return{experimentData:[null,{loadExperiment:(_loadExperiment=asyncToGenerator_default()(regenerator_default.a.mark((function _callee6(){var response;return regenerator_default.a.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(!values.experimentId||"new"===values.experimentId){_context6.next=5;break}return _context6.next=3,api.a.get("api/projects/".concat(values.currentTeamId,"/experiments/").concat(values.experimentId));case 3:return response=_context6.sent,_context6.abrupt("return",response);case 5:return _context6.abrupt("return",null);case 6:case"end":return _context6.stop()}}),_callee6)}))),function loadExperiment(){return _loadExperiment.apply(this,arguments)})}],experimentResults:[null,{loadExperimentResults:(_loadExperimentResults=asyncToGenerator_default()(regenerator_default.a.mark((function _callee7(){var response;return regenerator_default.a.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.prev=0,_context7.next=3,api.a.get("api/projects/".concat(values.currentTeamId,"/experiments/").concat(values.experimentId,"/results"));case 3:return response=_context7.sent,_context7.abrupt("return",_objectSpread(_objectSpread({},response),{},{itemID:Math.random().toString(36).substring(2,15)}));case 7:if(_context7.prev=7,_context7.t0=_context7.catch(0),"no_data"!==_context7.t0.code){_context7.next=11;break}return _context7.abrupt("return",null);case 11:return Object(lib_utils.y)("Error loading experiment results","Attempting to load results returned an error:",0!==_context7.t0.status?_context7.t0.detail:"Check your internet connection and make sure you don't have an extension blocking our requests.",_context7.t0.code),_context7.abrupt("return",null);case 13:case"end":return _context7.stop()}}),_callee7,null,[[0,7]])}))),function loadExperimentResults(){return _loadExperimentResults.apply(this,arguments)}),emptyExperimentResults:function emptyExperimentResults(){return null}}]}},selectors:{breadcrumbs:[function(s){return[s.experimentData,s.experimentId]},function(experimentData,experimentId){return[{name:"Experiments",path:urls.a.experiments()},{name:(null==experimentData?void 0:experimentData.name)||"New Experiment",path:urls.a.experiment(experimentId||"new")}]}],variants:[function(s){return[s.newExperimentData,s.experimentData]},function(newExperimentData,experimentData){var _newExperimentData$pa,_experimentData$param;return(null==newExperimentData||null===(_newExperimentData$pa=newExperimentData.parameters)||void 0===_newExperimentData$pa?void 0:_newExperimentData$pa.feature_flag_variants)||(null==experimentData||null===(_experimentData$param=experimentData.parameters)||void 0===_experimentData$param?void 0:_experimentData$param.feature_flag_variants)||[]}],minimumDetectableChange:[function(s){return[s.newExperimentData]},function(newExperimentData){var _newExperimentData$pa2;return(null==newExperimentData||null===(_newExperimentData$pa2=newExperimentData.parameters)||void 0===_newExperimentData$pa2?void 0:_newExperimentData$pa2.minimum_detectable_effect)||5}],minimumSampleSizePerVariant:[function(s){return[s.minimumDetectableChange]},function(mde){return function(conversionRate){return Math.ceil(1600*conversionRate*(1-conversionRate/100)/(mde*mde))}}],mdeGivenSampleSizeAndConversionRate:[function(){return[]},function(){return function(sampleSize,conversionRate){return Math.sqrt(1600*conversionRate*(1-conversionRate/100)/sampleSize)}}],mdeGivenCountData:[function(){return[]},function(){return function(controlCountData){return Math.ceil(2*Math.sqrt(2)*Math.sqrt(controlCountData))}}],recommendedExposureForCountData:[function(){return[]},function(){return function(baseCountData){var lambda1=baseCountData,lambda2=.05*baseCountData+baseCountData;return parseFloat((4/Math.pow(Math.sqrt(lambda1/14)-Math.sqrt(lambda2/14),2)).toFixed(1))}}],expectedRunningTime:[function(){return[]},function(){return function(entrants,sampleSize){return parseFloat((sampleSize/(entrants/14)).toFixed(1))}}],conversionRateForVariant:[function(s){return[s.experimentResults]},function(experimentResults){return function(variant){if(!experimentResults)return"Can't find variant";var variantResults=(null==experimentResults?void 0:experimentResults.insight).find((function(variantFunnel){var _variantFunnel$,_variantFunnel$$break;return(null===(_variantFunnel$=variantFunnel[0])||void 0===_variantFunnel$||null===(_variantFunnel$$break=_variantFunnel$.breakdown_value)||void 0===_variantFunnel$$break?void 0:_variantFunnel$$break[0])===variant}));return variantResults?(variantResults[variantResults.length-1].count/variantResults[0].count*100).toFixed(1):"Can't find variant"}}],countDataForVariant:[function(s){return[s.experimentResults]},function(experimentResults){return function(variant){if(!experimentResults)return"Can't find variant";var variantResults=(null==experimentResults?void 0:experimentResults.insight).find((function(variantTrend){return variantTrend.breakdown_value===variant}));return variantResults?variantResults.count.toString():"Can't find variant"}}],highestProbabilityVariant:[function(s){return[s.experimentResults]},function(experimentResults){if(experimentResults){var maxValue=Math.max.apply(Math,toConsumableArray_default()(Object.values(experimentResults.probability)));return Object.keys(experimentResults.probability).find((function(key){return Math.abs(experimentResults.probability[key]-maxValue)<Number.EPSILON}))}}]},urlToAction:function urlToAction(_ref13){var actions=_ref13.actions,values=_ref13.values;return{"/experiments/:id":function experimentsId(_ref14){var id=_ref14.id;if(actions.emptyExperimentResults(),id){var parsedId="new"===id?"new":parseInt(id);"new"===parsedId&&(actions.createNewExperimentInsight(),actions.resetNewExperiment()),parsedId!==values.experimentId&&actions.setExperimentId(parsedId),"new"!==parsedId&&(actions.loadExperiment(),actions.loadExperimentResults())}}}}});function percentageDistribution(variantCount){var percentageRounded=Math.round(100/variantCount),delta=percentageRounded*variantCount-100,percentages=new Array(variantCount).fill(percentageRounded);return percentages[variantCount-1]=percentageRounded-delta,percentages}var InsightContainer=__webpack_require__(1748),icons=__webpack_require__(36),DeleteOutlined=__webpack_require__(4230),PlusOutlined=__webpack_require__(1864),CaretDownOutlined=__webpack_require__(2680),CopyToClipboard=__webpack_require__(649),CodeSnippet=__webpack_require__(52),PropertyFilterButton=__webpack_require__(878),Spinner=__webpack_require__(206),funnelUtils=__webpack_require__(59);function Experiment_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function Experiment_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Experiment_ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):Experiment_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var scene={component:Experiment_Experiment,logic:experimentLogic};function Experiment_Experiment(){var _trendResults$,_results$,_newExperimentData$pa,_experimentData$filte,_experimentData$param,_experimentData$param2,_experimentData$param3,_experimentData$param4,_experimentData$param5,_experimentData$featu,_useValues=Object(index_esm.useValues)(experimentLogic),newExperimentData=_useValues.newExperimentData,experimentId=_useValues.experimentId,experimentData=_useValues.experimentData,experimentInsightId=_useValues.experimentInsightId,minimumSampleSizePerVariant=_useValues.minimumSampleSizePerVariant,recommendedExposureForCountData=_useValues.recommendedExposureForCountData,variants=_useValues.variants,expectedRunningTime=_useValues.expectedRunningTime,experimentResults=_useValues.experimentResults,conversionRateForVariant=_useValues.conversionRateForVariant,countDataForVariant=_useValues.countDataForVariant,editingExistingExperiment=_useValues.editingExistingExperiment,experimentInsightType=_useValues.experimentInsightType,experimentResultsLoading=_useValues.experimentResultsLoading,_useActions=Object(index_esm.useActions)(experimentLogic),setNewExperimentData=_useActions.setNewExperimentData,createExperiment=_useActions.createExperiment,launchExperiment=_useActions.launchExperiment,_setFilters=_useActions.setFilters,editExperiment=_useActions.editExperiment,endExperiment=_useActions.endExperiment,addExperimentGroup=_useActions.addExperimentGroup,updateExperimentGroup=_useActions.updateExperimentGroup,removeExperimentGroup=_useActions.removeExperimentGroup,setExperimentInsightType=_useActions.setExperimentInsightType,_Form$useForm=es_form.a.useForm(),form=slicedToArray_default()(_Form$useForm,1)[0],_useState=Object(react.useState)("control"),_useState2=slicedToArray_default()(_useState,2),currentVariant=_useState2[0],setCurrentVariant=_useState2[1],insightProps=Object(index_esm.useValues)(Object(insightLogic.b)({dashboardItemId:experimentInsightId,syncWithUrl:!1})).insightProps,_useValues3=Object(index_esm.useValues)(Object(funnelLogic.a)(insightProps)),isStepsEmpty=_useValues3.isStepsEmpty,filterSteps=_useValues3.filterSteps,funnelsFilters=_useValues3.filters,results=_useValues3.results,conversionMetrics=_useValues3.conversionMetrics,_useValues4=Object(index_esm.useValues)(Object(trendsLogic.a)(insightProps)),trendsFilters=_useValues4.filters,trendResults=_useValues4.results,conversionRate=100*conversionMetrics.totalRate,sampleSizePerVariant=minimumSampleSizePerVariant(conversionRate),sampleSize=sampleSizePerVariant*variants.length,trendCount=null===(_trendResults$=trendResults[0])||void 0===_trendResults$?void 0:_trendResults$.count,runningTime=expectedRunningTime(null==results||null===(_results$=results[0])||void 0===_results$?void 0:_results$.count,sampleSize),exposure=recommendedExposureForCountData(trendCount),status=function status(){return(null==experimentData?void 0:experimentData.start_date)?(null==experimentData?void 0:experimentData.end_date)?"complete":"running":"draft"};return react_default.a.createElement(react_default.a.Fragment,null,"new"===experimentId||editingExistingExperiment?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(row.a,{align:"middle",justify:"space-between",style:{borderBottom:"1px solid var(--border)",marginBottom:"1rem",paddingBottom:8}},react_default.a.createElement(PageHeader.a,{title:"New Experiment"})),react_default.a.createElement(es_form.a,{name:"new-experiment",layout:"vertical",className:"experiment-form",form:form,onValuesChange:function onValuesChange(values){return setNewExperimentData(values)},initialValues:{name:null==newExperimentData?void 0:newExperimentData.name,feature_flag_key:null==newExperimentData?void 0:newExperimentData.feature_flag_key,description:null==newExperimentData?void 0:newExperimentData.description},onFinish:function onFinish(){return createExperiment(!0,exposure,sampleSize)},scrollToFirstError:!0},react_default.a.createElement("div",null,react_default.a.createElement(row.a,null,react_default.a.createElement(col.a,{span:12,style:{paddingRight:24}},react_default.a.createElement(es_form.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"You have to enter a name."}]},react_default.a.createElement(input.a,{"data-attr":"experiment-name",className:"ph-ignore-input"})),react_default.a.createElement(es_form.a.Item,{label:"Feature flag key",name:"feature_flag_key",rules:[{required:!0,message:"You have to enter a feature flag key name."}],help:react_default.a.createElement("span",{className:"text-small text-muted"},"Enter a new and unique name for the feature flag key to be associated with this experiment.")},react_default.a.createElement(input.a,{"data-attr":"experiment-feature-flag-key",placeholder:"examples: new-landing-page-experiment, betaFeatureExperiment, ab_test_1_experiment"})),react_default.a.createElement(es_form.a.Item,{label:"Description",name:"description"},react_default.a.createElement(input.a.TextArea,{"data-attr":"experiment-description",className:"ph-ignore-input",placeholder:"Adding a helpful description can ensure others know what this experiment is about."}))),react_default.a.createElement(col.a,{span:12},react_default.a.createElement(es_form.a.Item,{label:"Select participants",name:"person-selection"},react_default.a.createElement(col.a,null,react_default.a.createElement("div",{className:"text-muted"},"Select the entities who will participate in this experiment. If no filters are set, 100% of participants will be targeted."),react_default.a.createElement("div",{style:{flex:3,marginRight:5}},react_default.a.createElement(PropertyFilters.a,{endpoint:"person",pageKey:"EditFunnel-property",propertyFilters:(experimentInsightType===src_types.p.FUNNELS?funnelsFilters.properties:trendsFilters.properties)||[],onChange:function onChange(anyProperties){setNewExperimentData({filters:{properties:anyProperties}}),_setFilters({properties:anyProperties.filter(utils.b)})},style:{margin:"1rem 0 0"},taxonomicGroupTypes:[types.a.PersonProperties,types.a.CohortsWithAllUsers],popoverPlacement:"top",taxonomicPopoverPlacement:"auto"})))),(null==newExperimentData||null===(_newExperimentData$pa=newExperimentData.parameters)||void 0===_newExperimentData$pa?void 0:_newExperimentData$pa.feature_flag_variants)&&react_default.a.createElement(col.a,null,react_default.a.createElement("label",null,react_default.a.createElement("b",null,"Experiment groups")),react_default.a.createElement("div",{className:"text-muted"},"Participants are divided into experiment groups. All experiments must consist of a control group and at least one test group."),react_default.a.createElement(col.a,null,newExperimentData.parameters.feature_flag_variants.map((function(variant,idx){var _newExperimentData$pa2;return react_default.a.createElement(es_form.a,{key:"".concat(variant,"-").concat(idx),initialValues:null===(_newExperimentData$pa2=newExperimentData.parameters)||void 0===_newExperimentData$pa2?void 0:_newExperimentData$pa2.feature_flag_variants,onValuesChange:function onValuesChange(changedValues){updateExperimentGroup(changedValues,idx)},validateTrigger:["onChange","onBlur"]},react_default.a.createElement(row.a,{className:"feature-flag-variant"},react_default.a.createElement(es_form.a.Item,{name:"key",rules:[{required:!0,message:"Key should not be empty."},{pattern:/^([A-z]|[a-z]|[0-9]|-|_)+$/,message:"Only letters, numbers, hyphens (-) & underscores (_) are allowed."}]},react_default.a.createElement(input.a,{disabled:0===idx,defaultValue:variant.key,"data-attr":"feature-flag-variant-key","data-key-index":idx.toString(),className:"ph-ignore-input",style:{maxWidth:150},placeholder:"example-variant-".concat(idx+1),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})),react_default.a.createElement("div",{className:"ml-05"}," ","Roll out to"," ",react_default.a.createElement(input_number.a,{disabled:!0,defaultValue:variant.rollout_percentage,value:variant.rollout_percentage,formatter:function formatter(value){return"".concat(value,"%")}})," ","of ",react_default.a.createElement("b",null,"participants")),react_default.a.createElement("div",{className:"float-right"},!(0===idx||1===idx)&&react_default.a.createElement(tooltip.a,{title:"Delete this variant",placement:"bottomLeft"},react_default.a.createElement(es_button.a,{type:"link",icon:react_default.a.createElement(DeleteOutlined.a,null),onClick:function onClick(){return removeExperimentGroup(idx)},style:{color:"var(--danger)",float:"right"}})))))})),newExperimentData.parameters.feature_flag_variants.length<4&&react_default.a.createElement(es_button.a,{style:{color:"var(--primary)",border:"none",boxShadow:"none",marginTop:"1rem"},icon:react_default.a.createElement(PlusOutlined.a,null),onClick:function onClick(){return addExperimentGroup()}},"Add test group"))))),react_default.a.createElement("div",null,react_default.a.createElement(row.a,{className:"metrics-selection"},react_default.a.createElement(index_esm.BindLogic,{logic:insightLogic.b,props:insightProps},react_default.a.createElement(row.a,{style:{width:"100%"}},react_default.a.createElement(col.a,{span:8,style:{paddingRight:8}},react_default.a.createElement("div",{className:"mb"},react_default.a.createElement("b",null,"Goal type")),react_default.a.createElement(es_select.a,{style:{display:"flex"},defaultValue:experimentInsightType,onChange:setExperimentInsightType,suffixIcon:react_default.a.createElement(CaretDownOutlined.a,null),dropdownMatchSelectWidth:!1},react_default.a.createElement(es_select.a.Option,{value:src_types.p.TRENDS},react_default.a.createElement(col.a,null,react_default.a.createElement("span",null,react_default.a.createElement("b",null,"Trend")),react_default.a.createElement("div",null,"Track how many participants complete a specific event or action"))),react_default.a.createElement(es_select.a.Option,{value:src_types.p.FUNNELS},react_default.a.createElement(col.a,null,react_default.a.createElement("span",null,react_default.a.createElement("b",null,"Funnel")),react_default.a.createElement("div",null,"Track conversion rates between events and actions")))),react_default.a.createElement("div",{className:"mb mt"},react_default.a.createElement("b",null,"Experiment goal")),react_default.a.createElement(row.a,null,react_default.a.createElement(card.a,{className:"action-filters-bordered",style:{width:"100%",marginRight:8},bodyStyle:{padding:0}},experimentInsightType===src_types.p.FUNNELS&&react_default.a.createElement(ActionFilter.a,{filters:funnelsFilters,setFilters:function setFilters(payload){setNewExperimentData({filters:payload}),_setFilters(payload)},typeKey:"EditFunnel-action",hideMathSelector:!0,hideDeleteBtn:1===filterSteps.length,buttonCopy:"Add funnel step",showSeriesIndicator:!isStepsEmpty,seriesIndicatorType:"numeric",fullWidth:!0,sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[types.a.EventProperties,types.a.PersonProperties,types.a.Cohorts,types.a.Elements],rowClassName:"action-filters-bordered"}),experimentInsightType===src_types.p.TRENDS&&react_default.a.createElement(ActionFilter.a,{horizontalUI:!0,filters:trendsFilters,setFilters:function setFilters(payload){setNewExperimentData({filters:payload}),_setFilters(payload)},typeKey:"experiment-trends",buttonCopy:"Add graph series",showSeriesIndicator:!0,singleFilter:!0,hideMathSelector:!0,propertiesTaxonomicGroupTypes:[types.a.EventProperties,types.a.PersonProperties,types.a.Cohorts,types.a.Elements],customRowPrefix:trendsFilters.insight===src_types.p.LIFECYCLE?react_default.a.createElement(react_default.a.Fragment,null,"Showing ",react_default.a.createElement("b",null,"Unique users")," who did"):void 0})))),react_default.a.createElement(col.a,{span:16},react_default.a.createElement(InsightContainer.a,{disableHeader:experimentInsightType===src_types.p.TRENDS,disableTable:!0})))))),react_default.a.createElement(card.a,{className:"experiment-preview"},react_default.a.createElement(row.a,{className:"preview-row"},react_default.a.createElement(col.a,null,react_default.a.createElement("div",{className:"card-secondary"},"Preview"),react_default.a.createElement("div",null,react_default.a.createElement("span",{className:"mr-05"},react_default.a.createElement("b",null,null==newExperimentData?void 0:newExperimentData.name)),(null==newExperimentData?void 0:newExperimentData.feature_flag_key)&&react_default.a.createElement(CopyToClipboard.a,{explicitValue:newExperimentData.feature_flag_key,iconStyle:{color:"var(--text-muted-alt)"},description:"feature flag key"},react_default.a.createElement("span",{className:"text-muted"},newExperimentData.feature_flag_key))))),react_default.a.createElement(row.a,{className:"preview-row"},experimentInsightType===src_types.p.TRENDS?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(col.a,{span:12},react_default.a.createElement("div",{className:"card-secondary"},"Baseline Count"),react_default.a.createElement("div",{className:"l4"},trendCount)),react_default.a.createElement(col.a,{span:12},react_default.a.createElement("div",{className:"card-secondary"},"Recommended Duration"),react_default.a.createElement("div",null,react_default.a.createElement("span",{className:"l4"},"~",exposure)," days"))):react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(col.a,{span:8},react_default.a.createElement("div",{className:"card-secondary"},"Baseline Conversion Rate"),react_default.a.createElement("div",{className:"l4"},conversionRate.toFixed(1),"%")),react_default.a.createElement(col.a,{span:8},react_default.a.createElement("div",{className:"card-secondary"},"Recommended Sample Size"),react_default.a.createElement("div",{className:"pb"},react_default.a.createElement("span",{className:"l4"},"~",sampleSizePerVariant)," persons")),react_default.a.createElement(col.a,{span:8},react_default.a.createElement("div",{className:"card-secondary"},"Expected Duration"),react_default.a.createElement("div",null,react_default.a.createElement("span",{className:"l4"},"~",runningTime)," days")))))),react_default.a.createElement(es_button.a,{icon:react_default.a.createElement(SaveOutlined_default.a,null),className:"float-right",type:"primary",htmlType:"submit"},"Save"))):experimentData?react_default.a.createElement("div",{className:"view-experiment"},react_default.a.createElement(row.a,{className:"draft-header"},react_default.a.createElement(row.a,{justify:"space-between",align:"middle",className:"full-width pb"},react_default.a.createElement(col.a,null,react_default.a.createElement(row.a,null,react_default.a.createElement(PageHeader.a,{style:{margin:0,paddingRight:8},title:"".concat(null==experimentData?void 0:experimentData.name)}),react_default.a.createElement(CopyToClipboard.a,{iconStyle:{color:"var(--text-muted-alt)"}},react_default.a.createElement("span",{className:"text-muted"},experimentData.feature_flag_key)),react_default.a.createElement(tag.a,{style:{alignSelf:"center",marginLeft:"1rem"},color:{running:"green",draft:"default",complete:"purple"}[status()]},react_default.a.createElement("b",{className:"uppercase"},status()))),react_default.a.createElement("span",{className:"description"},experimentData.description||"There is no description for this experiment.")),experimentData&&!experimentData.start_date&&react_default.a.createElement("div",null,react_default.a.createElement(es_button.a,{className:"mr-05",onClick:function onClick(){return editExperiment()}},"Edit"),react_default.a.createElement(es_button.a,{type:"primary",onClick:function onClick(){return launchExperiment()}},"Launch")),experimentData&&experimentData.start_date&&!experimentData.end_date&&react_default.a.createElement(es_button.a,{className:"stop-experiment",onClick:function onClick(){return endExperiment()}},"Stop experiment"))),react_default.a.createElement(row.a,{className:"mb"},react_default.a.createElement(col.a,{span:10,style:{paddingRight:"1rem"}},react_default.a.createElement(col.a,null,react_default.a.createElement("div",{className:"card-secondary"},"Participants"),react_default.a.createElement("div",null,(null===(_experimentData$filte=experimentData.filters.properties)||void 0===_experimentData$filte?void 0:_experimentData$filte.length)?react_default.a.createElement("div",null,experimentData.filters.properties.map((function(item){return react_default.a.createElement(PropertyFilterButton.b,{key:item.key,item:item,greyBadges:!0})}))):"100% of users")),experimentInsightType===src_types.p.TRENDS?react_default.a.createElement(col.a,null,react_default.a.createElement("div",{className:"card-secondary mt"},"Recommended running time"),react_default.a.createElement("span",null,"~",null===(_experimentData$param=experimentData.parameters)||void 0===_experimentData$param?void 0:_experimentData$param.recommended_running_time," ",react_default.a.createElement("span",{className:"text-muted"},"days"))):react_default.a.createElement(col.a,null,react_default.a.createElement("div",{className:"card-secondary mt"},"Recommended sample size"),react_default.a.createElement("span",null,"~",null===(_experimentData$param2=experimentData.parameters)||void 0===_experimentData$param2?void 0:_experimentData$param2.recommended_sample_size," ",react_default.a.createElement("span",{className:"text-muted"},"persons"))),react_default.a.createElement(col.a,null,react_default.a.createElement("div",{className:"card-secondary mt"},"Variants"),react_default.a.createElement("ul",{className:"variants-list"},null===(_experimentData$param3=experimentData.parameters)||void 0===_experimentData$param3||null===(_experimentData$param4=_experimentData$param3.feature_flag_variants)||void 0===_experimentData$param4?void 0:_experimentData$param4.map((function(variant,idx){return react_default.a.createElement("li",{key:idx},variant.key)})))),react_default.a.createElement(row.a,null,react_default.a.createElement(col.a,{className:"mr"},react_default.a.createElement("div",{className:"card-secondary mt"},"Start date"),experimentData.start_date?react_default.a.createElement("span",null,Object(dayjs.a)(experimentData.start_date).format("D MMM YYYY")):react_default.a.createElement("span",{className:"description"},"Not started yet")),experimentData.end_date&&react_default.a.createElement(col.a,{className:"ml"},react_default.a.createElement("div",{className:"card-secondary mt"},"Completed date"),react_default.a.createElement("span",null,Object(dayjs.a)(experimentData.end_date).format("D MMM YYYY"))))),react_default.a.createElement(col.a,{span:14},react_default.a.createElement("div",{style:{borderBottom:"1px solid (--border)"}},react_default.a.createElement("b",null,"Test that your code works properly for each variant")),react_default.a.createElement(row.a,{justify:"space-between"},react_default.a.createElement("div",null,"Feature flag override for"," ",react_default.a.createElement(es_select.a,{onChange:setCurrentVariant,defaultValue:"control",suffixIcon:react_default.a.createElement(CaretDownOutlined.a,null)},null===(_experimentData$param5=experimentData.parameters.feature_flag_variants)||void 0===_experimentData$param5?void 0:_experimentData$param5.map((function(variant,idx){return react_default.a.createElement(es_select.a.Option,{key:idx,value:variant.key},variant.key)})))),react_default.a.createElement("div",null,"Language ",react_default.a.createElement(CodeLanguageSelect,null))),react_default.a.createElement(CodeSnippet.a,{language:CodeSnippet.b.JavaScript},"posthog.feature_flags.override({'".concat(experimentData.feature_flag_key,"': '").concat(currentVariant,"'})")),react_default.a.createElement(CodeSnippet.a,{language:CodeSnippet.b.JavaScript,wrap:!0},"if (posthog.getFeatureFlag('".concat(null!==(_experimentData$featu=experimentData.feature_flag_key)&&void 0!==_experimentData$featu?_experimentData$featu:"","') === '").concat(currentVariant,"') {\n    // where '").concat(currentVariant,"' is the variant, run your code here\n}")),react_default.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://posthog.com/docs/user-guides/feature-flags"},react_default.a.createElement(row.a,{align:"middle"},"Experiment implementation guide",react_default.a.createElement(icons.IconOpenInNew,{className:"ml-05"}))))),react_default.a.createElement("div",{className:"experiment-result"},experimentResults?react_default.a.createElement(row.a,{justify:"space-around",style:{flexFlow:"nowrap"}},experimentData.parameters.feature_flag_variants.map((function(variant,idx){return react_default.a.createElement(col.a,{key:idx,className:"pr"},react_default.a.createElement("div",{style:{fontSize:16}},react_default.a.createElement("b",null,Object(lib_utils.i)(variant.key))),experimentInsightType===src_types.p.FUNNELS?"Conversion rate: ":"Count: ",react_default.a.createElement("b",null,experimentInsightType===src_types.p.FUNNELS?"".concat(conversionRateForVariant(variant.key),"%"):countDataForVariant(variant.key)),experimentInsightType===src_types.p.FUNNELS&&react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(progress.a,{percent:Number(conversionRateForVariant(variant.key)),size:"small",showInfo:!1,strokeColor:Object(funnelUtils.k)(idx+1)}),react_default.a.createElement("div",null,"Probability that this variant has higher conversion than other variants:"," ",react_default.a.createElement("b",null,(100*experimentResults.probability[variant.key]).toFixed(1),"%"))))}))):experimentResultsLoading?react_default.a.createElement("div",{className:"text-center"},react_default.a.createElement(Spinner.a,null)):react_default.a.createElement("span",{style:{fontWeight:500}},"There are no results for this experiment yet."," ",!experimentData.start_date&&"Launch this experiment to start it!"),experimentResults?react_default.a.createElement(index_esm.BindLogic,{logic:insightLogic.b,props:{dashboardItemId:experimentResults.itemID,filters:Experiment_objectSpread(Experiment_objectSpread(Experiment_objectSpread({},experimentResults.filters),{},{insight:experimentInsightType,display:experimentData.filters.display},experimentInsightType===src_types.p.FUNNELS&&{layout:constants.q.vertical,funnel_viz_type:src_types.l.Steps}),experimentInsightType===src_types.p.TRENDS&&{display:src_types.d.ActionsLineGraphCumulative}),cachedResults:experimentResults.insight,syncWithUrl:!1,doNotLoad:!0}},react_default.a.createElement("div",{className:"mt"},react_default.a.createElement(InsightContainer.a,{disableHeader:experimentInsightType===src_types.p.TRENDS,disableTable:experimentInsightType===src_types.p.FUNNELS}))):react_default.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:16,background:"#FAFAF9",border:"1px solid var(--border)",width:"100%",minHeight:320,fontSize:24}},experimentResultsLoading?react_default.a.createElement(Spinner.a,null):react_default.a.createElement("b",null,"There are no results for this experiment yet.")))):react_default.a.createElement("div",null,"Loading Data..."))}function CodeLanguageSelect(){return react_default.a.createElement(es_select.a,{defaultValue:"JavaScript",suffixIcon:react_default.a.createElement(CaretDownOutlined.a,null)},react_default.a.createElement(es_select.a.Option,{value:"JavaScript"},react_default.a.createElement(row.a,{align:"middle"},react_default.a.createElement(icons.IconJavascript,{style:{marginRight:6}})," JavaScript")))}}}]);