(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[26007],{"./frontend/src/scenes/early-access-features/EarlyAccessFeature.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{EarlyAccessFeature:function(){return EarlyAccessFeature},FlagSelector:function(){return FlagSelector},scene:function(){return scene}});var src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),PageHeader=__webpack_require__("./frontend/src/lib/components/PageHeader.tsx"),Field=__webpack_require__("./frontend/src/lib/forms/Field.tsx"),lib=__webpack_require__("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.5/node_modules/kea-forms/lib/index.js"),kea_loaders_lib=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),kea_router_lib=__webpack_require__("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.5/node_modules/kea-router/lib/index.js"),api=__webpack_require__("./frontend/src/lib/api.ts"),urls=__webpack_require__("./frontend/src/scenes/urls.ts"),types=__webpack_require__("./frontend/src/types.ts"),earlyAccessFeaturesLogic=__webpack_require__("./frontend/src/scenes/early-access-features/earlyAccessFeaturesLogic.ts"),teamLogic=__webpack_require__("./frontend/src/scenes/teamLogic.tsx");const NEW_EARLY_ACCESS_FEATURE={name:"",description:"",stage:types.nE.Draft,documentation_url:"",feature_flag_id:void 0},earlyAccessFeatureLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","features","featureLogic"]),(0,index_esm.props)({}),(0,index_esm.key)((_ref=>{let{id:id}=_ref;return id})),(0,index_esm.connect)((()=>({values:[teamLogic.teamLogic,["currentTeamId"],earlyAccessFeaturesLogic.Z,["earlyAccessFeatures"]],actions:[earlyAccessFeaturesLogic.Z,["loadEarlyAccessFeatures","loadEarlyAccessFeaturesSuccess"]]}))),(0,index_esm.actions)({toggleImplementOptInInstructionsModal:!0,cancel:!0,editFeature:editing=>({editing:editing}),updateStage:stage=>({stage:stage}),deleteEarlyAccessFeature:earlyAccessFeatureId=>({earlyAccessFeatureId:earlyAccessFeatureId}),setActiveTab:activeTab=>({activeTab:activeTab})}),(0,kea_loaders_lib.loaders)((_ref2=>{let{props:props}=_ref2;return{earlyAccessFeature:{loadEarlyAccessFeature:async()=>{if(props.id&&"new"!==props.id){return await api.ZP.earlyAccessFeatures.get(props.id)}return NEW_EARLY_ACCESS_FEATURE},saveEarlyAccessFeature:async updatedEarlyAccessFeature=>{let result;return"new"===props.id?(result=await api.ZP.earlyAccessFeatures.create(updatedEarlyAccessFeature),kea_router_lib.router.actions.replace(urls.j.earlyAccessFeature(result.id))):result=await api.ZP.earlyAccessFeatures.update(props.id,updatedEarlyAccessFeature),result}}}})),(0,lib.forms)((_ref3=>{let{actions:actions}=_ref3;return{earlyAccessFeature:{defaults:{...NEW_EARLY_ACCESS_FEATURE},errors:payload=>({name:payload.name?void 0:"Feature name must be set"}),submit:async payload=>{actions.saveEarlyAccessFeature(payload)}}}})),(0,index_esm.reducers)({isEditingFeature:[!1,{editFeature:(_,_ref4)=>{let{editing:editing}=_ref4;return editing}}],implementOptInInstructionsModal:[!1,{toggleImplementOptInInstructionsModal:state=>!state}],activeTab:[types.ML.OptedIn,{setActiveTab:(_,_ref5)=>{let{activeTab:activeTab}=_ref5;return activeTab}}]}),(0,index_esm.selectors)({mode:[(_,p)=>[p.id],id=>"new"===id?"edit":"view"],breadcrumbs:[s=>[s.earlyAccessFeature],earlyAccessFeature=>[{name:"Early Access Management",path:urls.j.earlyAccessFeatures()},...earlyAccessFeature?.name?[{name:earlyAccessFeature.name}]:[]]]}),(0,index_esm.listeners)((_ref6=>{let{actions:actions,values:values,props:props}=_ref6;return{cancel:()=>{"id"in values.earlyAccessFeature&&actions.loadEarlyAccessFeature(),actions.editFeature(!1)},updateStage:async _ref7=>{let{stage:stage}=_ref7;"id"in values.earlyAccessFeature&&await api.ZP.earlyAccessFeatures.update(props.id,{...values.earlyAccessFeature,stage:stage}),actions.loadEarlyAccessFeature(),actions.loadEarlyAccessFeatures()},saveEarlyAccessFeatureSuccess:_ref8=>{let{earlyAccessFeature:earlyAccessFeature}=_ref8;src.lemonToast.success("Early Access Feature saved"),actions.loadEarlyAccessFeatures(),earlyAccessFeature.id&&kea_router_lib.router.actions.replace(urls.j.earlyAccessFeature(earlyAccessFeature.id)),actions.editFeature(!1)},deleteEarlyAccessFeature:async _ref9=>{let{earlyAccessFeatureId:earlyAccessFeatureId}=_ref9;try{await api.ZP.earlyAccessFeatures.delete(earlyAccessFeatureId),src.lemonToast.info("Early access feature deleted. Remember to delete corresponding feature flag if necessary"),actions.loadEarlyAccessFeaturesSuccess(values.earlyAccessFeatures.filter((feature=>feature.id!==earlyAccessFeatureId))),kea_router_lib.router.actions.push(urls.j.earlyAccessFeatures())}catch(e){src.lemonToast.error(`Error deleting Early Access Feature: ${e}`)}}}})),(0,kea_router_lib.urlToAction)((_ref10=>{var _props$id;let{actions:actions,props:props}=_ref10;return{[urls.j.earlyAccessFeature(null!==(_props$id=props.id)&&void 0!==_props$id?_props$id:"new")]:(_,__,___,_ref11)=>{let{method:method}=_ref11;"PUSH"===method&&props.id&&actions.loadEarlyAccessFeature()}}})),(0,index_esm.afterMount)((async _ref12=>{let{props:props,actions:actions}=_ref12;"new"!==props.id&&await actions.loadEarlyAccessFeature()}))]);var icons=__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts"),react=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),Popover=__webpack_require__("./frontend/src/lib/lemon-ui/Popover/index.ts"),TaxonomicFilter=__webpack_require__("./frontend/src/lib/components/TaxonomicFilter/TaxonomicFilter.tsx"),TaxonomicFilter_types=__webpack_require__("./frontend/src/lib/components/TaxonomicFilter/types.ts"),featureFlagLogic=__webpack_require__("./frontend/src/scenes/feature-flags/featureFlagLogic.ts"),personsLogic=__webpack_require__("./frontend/src/scenes/persons/personsLogic.tsx"),clsx_m=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),CodeSnippet=__webpack_require__("./frontend/src/lib/components/CodeSnippet/index.ts"),early_access_feature_demo=__webpack_require__.p+"images/early-access-feature-demo.8931b5833f0ea2443173aef331bedf12.png",preflightLogic=__webpack_require__("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function InstructionsModal(_ref){let{onClose:onClose,visible:visible,featureFlag:featureFlag}=_ref;const{preflight:preflight}=(0,index_esm.useValues)(preflightLogic.preflightLogic),panels=preflight?.cloud?(0,jsx_runtime.jsx)(src.LemonCollapse,{className:"mt-2",defaultActiveKey:"1",panels:[{key:"1",header:"Option 1: Widget Site App",content:(0,jsx_runtime.jsxs)("div",{children:["Give your users a"," ",(0,jsx_runtime.jsx)(src.Link,{to:"https://app.posthog.com/project/apps/574",children:"prebuilt widget"})," to opt-in to features",(0,jsx_runtime.jsx)("img",{style:{maxHeight:"100%",maxWidth:"100%",marginTop:10},src:early_access_feature_demo})]})},{key:"2",header:"Option 2: Custom implementation",content:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("b",{children:"Opt user in"}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(FeatureEnrollInstructions,{featureFlag:featureFlag})}),(0,jsx_runtime.jsx)("b",{children:"Opt user out"}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(FeatureUnenrollInstructions,{featureFlag:featureFlag})}),(0,jsx_runtime.jsx)("b",{children:"Retrieve Previews"}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(RetrievePreviewsInstructions,{})})]})}]}):(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("b",{children:"Opt user in"}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(FeatureEnrollInstructions,{featureFlag:featureFlag})}),(0,jsx_runtime.jsx)("b",{children:"Opt user out"}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(FeatureUnenrollInstructions,{featureFlag:featureFlag})}),(0,jsx_runtime.jsx)("b",{children:"Retrieve Previews"}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(RetrievePreviewsInstructions,{})})]});return(0,jsx_runtime.jsx)(src.LemonModal,{title:"How to implement opt-in feature flags",isOpen:visible,onClose:onClose,width:640,children:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{className:"mb-2",children:"Implement manual release condition toggles to give your users the ability choose which features they want to try"}),panels]})})}function FeatureEnrollInstructions(_ref2){let{featureFlag:featureFlag}=_ref2;return(0,jsx_runtime.jsx)(CodeSnippet.O,{language:CodeSnippet.S.JavaScript,wrap:!0,children:`posthog.updateEarlyAccessFeatureEnrollment("${featureFlag.key}", true)\n`})}function FeatureUnenrollInstructions(_ref3){let{featureFlag:featureFlag}=_ref3;return(0,jsx_runtime.jsx)(CodeSnippet.O,{language:CodeSnippet.S.JavaScript,wrap:!0,children:`posthog.updateEarlyAccessFeatureEnrollment("${featureFlag.key}", false)\n`})}function RetrievePreviewsInstructions(){return(0,jsx_runtime.jsx)(CodeSnippet.O,{language:CodeSnippet.S.JavaScript,wrap:!0,children:"posthog.getEarlyAccessFeatures((previewItemData) => {\n    // do something with early access feature\n})\n"})}try{InstructionsModal.displayName="InstructionsModal",InstructionsModal.__docgenInfo={description:"",displayName:"InstructionsModal",props:{featureFlag:{defaultValue:null,description:"",name:"featureFlag",required:!0,type:{name:"FeatureFlagType"}},visible:{defaultValue:null,description:"",name:"visible",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/early-access-features/InstructionsModal.tsx#InstructionsModal"]={docgenInfo:InstructionsModal.__docgenInfo,name:"InstructionsModal",path:"frontend/src/scenes/early-access-features/InstructionsModal.tsx#InstructionsModal"})}catch(__react_docgen_typescript_loader_error){}var TZLabel=__webpack_require__("./frontend/src/lib/components/TZLabel/index.tsx"),PropertiesTable=__webpack_require__("./frontend/src/lib/components/PropertiesTable/index.ts"),CopyToClipboard=(__webpack_require__("./frontend/src/scenes/persons/Persons.scss"),__webpack_require__("./frontend/src/lib/components/CopyToClipboard.tsx")),PersonDisplay=__webpack_require__("./frontend/src/scenes/persons/PersonDisplay.tsx"),LemonTable=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTable/index.ts"),PersonDeleteModal=__webpack_require__("./frontend/src/scenes/persons/PersonDeleteModal.tsx"),personDeleteModalLogic=__webpack_require__("./frontend/src/scenes/persons/personDeleteModalLogic.tsx");function PersonsTable(_ref){let{people:people,loading:loading=!1,hasPrevious:hasPrevious,hasNext:hasNext,loadPrevious:loadPrevious,loadNext:loadNext,compact:compact,extraColumns:extraColumns,emptyState:emptyState}=_ref;const{showPersonDeleteModal:showPersonDeleteModal}=(0,index_esm.useActions)(personDeleteModalLogic.C),{loadPersons:loadPersons}=(0,index_esm.useActions)(personsLogic.T),columns=[{title:"Person",key:"person",render:function Render(_,person){return(0,jsx_runtime.jsx)(PersonDisplay.I,{withIcon:!0,person:person})}},...compact?[]:[{title:"ID",key:"id",render:function Render(_,person){return(0,jsx_runtime.jsx)("div",{className:"overflow-hidden",children:person.distinct_ids.length&&(0,jsx_runtime.jsx)(CopyToClipboard.D,{explicitValue:person.distinct_ids[0],iconStyle:{color:"var(--primary)"},description:"person distinct ID",children:person.distinct_ids[0]})})}},{title:"First seen",dataIndex:"created_at",render:function Render(created_at){return created_at?(0,jsx_runtime.jsx)(TZLabel.w,{time:created_at}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}},{render:function Render(_,person){return(0,jsx_runtime.jsx)(src.LemonButton,{onClick:()=>showPersonDeleteModal(person,(()=>loadPersons())),icon:(0,jsx_runtime.jsx)(icons.Fzz,{}),status:"danger",size:"small"})}}],...extraColumns||[]];return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(LemonTable.g,{"data-attr":"persons-table",columns:columns,loading:loading,rowKey:"id",pagination:{controlled:!0,pageSize:100,onForward:hasNext?()=>{loadNext?.(),window.scrollTo(0,0)}:void 0,onBackward:hasPrevious?()=>{loadPrevious?.(),window.scrollTo(0,0)}:void 0},expandable:{expandedRowRender:function RenderPropertiesTable(_ref2){let{properties:properties}=_ref2;return Object.keys(properties).length?(0,jsx_runtime.jsx)(PropertiesTable.V,{type:types.ll.Person,properties:properties}):"This person has no properties."}},dataSource:people,emptyState:emptyState||"No persons",nouns:["person","persons"]}),(0,jsx_runtime.jsx)(PersonDeleteModal.S,{})]})}try{PersonsTable.displayName="PersonsTable",PersonsTable.__docgenInfo={description:"",displayName:"PersonsTable",props:{people:{defaultValue:null,description:"",name:"people",required:!0,type:{name:"PersonType[]"}},loading:{defaultValue:{value:"false"},description:"",name:"loading",required:!1,type:{name:"boolean"}},hasPrevious:{defaultValue:null,description:"",name:"hasPrevious",required:!1,type:{name:"boolean"}},hasNext:{defaultValue:null,description:"",name:"hasNext",required:!1,type:{name:"boolean"}},loadPrevious:{defaultValue:null,description:"",name:"loadPrevious",required:!1,type:{name:"(() => void)"}},loadNext:{defaultValue:null,description:"",name:"loadNext",required:!1,type:{name:"(() => void)"}},compact:{defaultValue:null,description:"",name:"compact",required:!1,type:{name:"boolean"}},extraColumns:{defaultValue:null,description:"",name:"extraColumns",required:!1,type:{name:"LemonTableColumns<PersonType>"}},emptyState:{defaultValue:null,description:"",name:"emptyState",required:!1,type:{name:"Element"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"]={docgenInfo:PersonsTable.__docgenInfo,name:"PersonsTable",path:"frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"})}catch(__react_docgen_typescript_loader_error){}var PropertyFilters=__webpack_require__("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),Tooltip=__webpack_require__("./frontend/src/lib/lemon-ui/Tooltip.tsx"),index_module=__webpack_require__("./node_modules/.pnpm/use-debounce@9.0.3_react@16.14.0/node_modules/use-debounce/dist/index.module.js");const PersonsSearch=()=>{const{loadPersons:loadPersons,setListFilters:setListFilters}=(0,index_esm.useActions)(personsLogic.T),{listFilters:listFilters}=(0,index_esm.useValues)(personsLogic.T),[searchTerm,setSearchTerm]=(0,react.useState)(""),loadPersonsDebounced=(0,index_module.y1)(loadPersons,800);return(0,react.useEffect)((()=>{setSearchTerm(listFilters.search||"")}),[]),(0,react.useEffect)((()=>{setListFilters({search:searchTerm||void 0}),loadPersonsDebounced()}),[searchTerm]),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(src.LemonInput,{type:"search",placeholder:"Search for persons",onChange:setSearchTerm,value:searchTerm,"data-attr":"persons-search"}),(0,jsx_runtime.jsx)(Tooltip.u,{title:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:'Search by email or Distinct ID. Email will match partially, for example: "@gmail.com". Distinct ID needs to match exactly.'}),children:(0,jsx_runtime.jsx)(icons.aUG,{className:"text-2xl text-muted-alt shrink-0"})})]})};var LemonDialog=__webpack_require__("./frontend/src/lib/lemon-ui/LemonDialog/index.ts"),LemonTabs=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTabs/index.ts");const scene={component:EarlyAccessFeature,logic:earlyAccessFeatureLogic,paramsToProps:_ref=>{let{params:{id:id}}=_ref;return{id:id&&"new"!==id?id:"new"}}};function EarlyAccessFeature(){let{id:id}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{earlyAccessFeature:earlyAccessFeature,earlyAccessFeatureLoading:earlyAccessFeatureLoading,isEarlyAccessFeatureSubmitting:isEarlyAccessFeatureSubmitting,isEditingFeature:isEditingFeature}=(0,index_esm.useValues)(earlyAccessFeatureLogic),{submitEarlyAccessFeatureRequest:submitEarlyAccessFeatureRequest,cancel:cancel,editFeature:editFeature,updateStage:updateStage,deleteEarlyAccessFeature:deleteEarlyAccessFeature}=(0,index_esm.useActions)(earlyAccessFeatureLogic),isNewEarlyAccessFeature="new"===id||void 0===id;return(0,jsx_runtime.jsxs)(lib.Form,{formKey:"earlyAccessFeature",logic:earlyAccessFeatureLogic,children:[(0,jsx_runtime.jsx)(PageHeader.m,{title:isNewEarlyAccessFeature?"New Feature Release":earlyAccessFeature.name,buttons:earlyAccessFeatureLoading?void 0:earlyAccessFeature.stage!=types.nE.GeneralAvailability&&(isNewEarlyAccessFeature||isEditingFeature)?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",onClick:()=>cancel(),disabledReason:isEarlyAccessFeatureSubmitting?"Savingâ€¦":void 0,children:"Cancel"}),(0,jsx_runtime.jsx)(src.LemonButton,{type:"primary",htmlType:"submit",onClick:()=>{submitEarlyAccessFeatureRequest(earlyAccessFeature)},loading:isEarlyAccessFeatureSubmitting,children:isNewEarlyAccessFeature?"Save as draft":"Save"})]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(src.LemonButton,{"data-attr":"delete-feature",status:"danger",type:"secondary",onClick:()=>{LemonDialog.d.open({title:"Permanently delete feature?",description:"Doing so will remove any opt in conditions from the feature flag.",primaryButton:{children:"Delete",type:"primary",status:"danger",onClick:()=>{deleteEarlyAccessFeature(earlyAccessFeature?.id)}},secondaryButton:{children:"Close",type:"secondary"}})},children:"Delete"}),earlyAccessFeature.stage==types.nE.Beta&&(0,jsx_runtime.jsx)(src.LemonButton,{"data-attr":"archive-feature",type:"secondary",onClick:()=>updateStage(types.nE.Archived),children:"Archive"}),earlyAccessFeature.stage==types.nE.Archived&&(0,jsx_runtime.jsx)(src.LemonButton,{"data-attr":"reactive-feature",type:"secondary",onClick:()=>updateStage(types.nE.Beta),children:"Reactivate Beta"}),earlyAccessFeature.stage==types.nE.Draft&&(0,jsx_runtime.jsx)(src.LemonButton,{onClick:()=>updateStage(types.nE.Beta),tooltip:"Make beta feature available",type:"primary",children:"Release Beta"}),(0,jsx_runtime.jsx)(src.LemonDivider,{vertical:!0}),earlyAccessFeature.stage!=types.nE.GeneralAvailability&&(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",onClick:()=>editFeature(!0),loading:!1,children:"Edit"})]}),delimited:!0}),(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.default)("flex flex-wrap gap-6",isEditingFeature||isNewEarlyAccessFeature?"max-w-160":null),children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-col gap-4 flex-2 min-w-60",children:[isNewEarlyAccessFeature&&(0,jsx_runtime.jsx)(Field.g,{name:"name",label:"Name",children:(0,jsx_runtime.jsx)(src.LemonInput,{"data-attr":"feature-name"})}),"feature_flag"in earlyAccessFeature?(0,jsx_runtime.jsx)(Field.e,{label:"Connected Feature flag",children:(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",onClick:()=>earlyAccessFeature.feature_flag&&kea_router_lib.router.actions.push(urls.j.featureFlag(earlyAccessFeature.feature_flag.id)),icon:(0,jsx_runtime.jsx)(icons.GyD,{}),children:earlyAccessFeature.feature_flag.key})})}):(0,jsx_runtime.jsx)(Field.g,{name:"feature_flag_id",label:"Link feature flag (optional)",info:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"A feature flag will be generated from feature name if not provided"}),children:_ref2=>{let{value:value,onChange:onChange}=_ref2;return(0,jsx_runtime.jsxs)("div",{className:"flex",children:[(0,jsx_runtime.jsx)(FlagSelector,{value:value,onChange:onChange}),value&&(0,jsx_runtime.jsx)(src.LemonButton,{className:"ml-2",icon:(0,jsx_runtime.jsx)(icons.bMz,{}),size:"small",status:"stealth",onClick:()=>onChange(void 0),"aria-label":"close"})]})}}),isEditingFeature||isNewEarlyAccessFeature?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}):(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("b",{children:"Stage"}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(src.LemonTag,{type:"beta"===earlyAccessFeature.stage?"warning":"general-availability"===earlyAccessFeature.stage?"success":"default",className:"mt-2 uppercase",children:earlyAccessFeature.stage})})]}),isEditingFeature||isNewEarlyAccessFeature?(0,jsx_runtime.jsx)(Field.g,{name:"description",label:"Description",showOptional:!0,children:(0,jsx_runtime.jsx)(src.LemonTextArea,{className:"ph-ignore-input",placeholder:"Help your users understand the feature"})}):(0,jsx_runtime.jsxs)("div",{className:"mb-2",children:[(0,jsx_runtime.jsx)("b",{children:"Description"}),(0,jsx_runtime.jsx)("div",{children:earlyAccessFeature.description?earlyAccessFeature.description:(0,jsx_runtime.jsx)("span",{className:"text-muted",children:"No description"})})]}),isEditingFeature||isNewEarlyAccessFeature?(0,jsx_runtime.jsx)(Field.g,{name:"documentation_url",label:"Documentation URL",showOptional:!0,children:(0,jsx_runtime.jsx)(src.LemonInput,{autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})}):(0,jsx_runtime.jsxs)("div",{className:"mb-2",children:[(0,jsx_runtime.jsx)("b",{children:"Documentation Url"}),(0,jsx_runtime.jsx)("div",{children:earlyAccessFeature.documentation_url?earlyAccessFeature.documentation_url:(0,jsx_runtime.jsx)("span",{className:"text-muted",children:"No documentation url"})})]})]}),!isEditingFeature&&!isNewEarlyAccessFeature&&"id"in earlyAccessFeature&&(0,jsx_runtime.jsx)("div",{className:"flex-3 min-w-60",children:(0,jsx_runtime.jsx)(PersonList,{earlyAccessFeature:earlyAccessFeature})})]})]})}function FlagSelector(_ref3){let{value:value,onChange:onChange,readOnly:readOnly}=_ref3;const[visible,setVisible]=(0,react.useState)(!1),{featureFlag:featureFlag}=(0,index_esm.useValues)((0,featureFlagLogic.h)({id:value||"link"})),taxonomicFilterLogicProps={groupType:TaxonomicFilter_types.t.FeatureFlags,value:value,onChange:(_,__,item)=>{"id"in item&&item.id&&onChange(item.id),setVisible(!1)},taxonomicGroupTypes:[TaxonomicFilter_types.t.FeatureFlags],optionsFromProp:void 0,popoverEnabled:!0,selectFirstItem:!0,taxonomicFilterLogicKey:"flag-selectorz"};return(0,jsx_runtime.jsx)(Popover.J2,{overlay:(0,jsx_runtime.jsx)(TaxonomicFilter.I,{...taxonomicFilterLogicProps}),visible:visible,placement:"right-start",fallbackPlacements:["bottom"],onClickOutside:()=>setVisible(!1),children:readOnly?(0,jsx_runtime.jsx)("div",{children:featureFlag.key}):(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",onClick:()=>setVisible(!visible),children:featureFlag.key?featureFlag.key:"Select flag"})})}function PersonList(_ref4){let{earlyAccessFeature:earlyAccessFeature}=_ref4;const{implementOptInInstructionsModal:implementOptInInstructionsModal,activeTab:activeTab}=(0,index_esm.useValues)(earlyAccessFeatureLogic),{toggleImplementOptInInstructionsModal:toggleImplementOptInInstructionsModal,setActiveTab:setActiveTab}=(0,index_esm.useActions)(earlyAccessFeatureLogic),{featureFlag:featureFlag}=(0,index_esm.useValues)((0,featureFlagLogic.h)({id:earlyAccessFeature.feature_flag.id||"link"})),key="$feature_enrollment/"+earlyAccessFeature.feature_flag.key;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(LemonTabs.T,{activeKey:activeTab,onChange:newKey=>setActiveTab(newKey),tabs:[{key:types.ML.OptedIn,label:"Opted-In Users",content:(0,jsx_runtime.jsx)(PersonsTableByFilter,{properties:[{key:key,type:types.FT.Person,operator:types.WV.Exact,value:["true"]}],emptyState:(0,jsx_runtime.jsxs)("div",{children:["No manual opt-ins. Manually opted-in people will appear here. Start by"," ",(0,jsx_runtime.jsx)("a",{onClick:toggleImplementOptInInstructionsModal,children:"implementing public opt-in"})]})})},{key:types.ML.OptedOut,label:"Opted-Out Users",content:(0,jsx_runtime.jsx)(PersonsTableByFilter,{properties:[{key:key,type:types.FT.Person,operator:types.WV.Exact,value:["false"]}],emptyState:(0,jsx_runtime.jsxs)("div",{children:["No manual opt-outs. Manually opted-out people will appear here. Start by"," ",(0,jsx_runtime.jsx)("a",{onClick:toggleImplementOptInInstructionsModal,children:"implementing public opt-out"})]})})}]}),(0,jsx_runtime.jsx)(InstructionsModal,{featureFlag:featureFlag,visible:implementOptInInstructionsModal,onClose:toggleImplementOptInInstructionsModal})]})}function PersonsTableByFilter(_ref5){let{properties:properties,emptyState:emptyState}=_ref5;const{toggleImplementOptInInstructionsModal:toggleImplementOptInInstructionsModal}=(0,index_esm.useActions)(earlyAccessFeatureLogic),personsLogicProps={cohort:void 0,syncWithUrl:!1,fixedProperties:properties},logic=(0,personsLogic.T)(personsLogicProps),{persons:persons,personsLoading:personsLoading,listFilters:listFilters}=(0,index_esm.useValues)(logic),{loadPersons:loadPersons,setListFilters:setListFilters}=(0,index_esm.useActions)(logic);return(0,jsx_runtime.jsxs)("div",{className:"space-y-2",children:[(0,jsx_runtime.jsx)("div",{className:"flex-col",children:(0,jsx_runtime.jsx)(PersonsSearch,{})}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,jsx_runtime.jsx)(PropertyFilters.t,{pageKey:"persons-list-page",propertyFilters:listFilters.properties,onChange:properties=>{setListFilters({properties:properties}),loadPersons()},endpoint:"person",taxonomicGroupTypes:[TaxonomicFilter_types.t.PersonProperties],showConditionBadge:!0}),(0,jsx_runtime.jsx)(src.LemonButton,{onClick:toggleImplementOptInInstructionsModal,sideIcon:(0,jsx_runtime.jsx)(icons.Hnp,{}),children:"Implement public opt-in"},"help-button")]}),(0,jsx_runtime.jsx)(PersonsTable,{people:persons.results,loading:personsLoading,hasPrevious:!!persons.previous,hasNext:!!persons.next,loadPrevious:()=>loadPersons(persons.previous),loadNext:()=>loadPersons(persons.next),compact:!0,extraColumns:[],emptyState:emptyState})]})}try{EarlyAccessFeature.displayName="EarlyAccessFeature",EarlyAccessFeature.__docgenInfo={description:"",displayName:"EarlyAccessFeature",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/early-access-features/EarlyAccessFeature.tsx#EarlyAccessFeature"]={docgenInfo:EarlyAccessFeature.__docgenInfo,name:"EarlyAccessFeature",path:"frontend/src/scenes/early-access-features/EarlyAccessFeature.tsx#EarlyAccessFeature"})}catch(__react_docgen_typescript_loader_error){}try{FlagSelector.displayName="FlagSelector",FlagSelector.__docgenInfo={description:"",displayName:"FlagSelector",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"number | undefined"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: any) => void"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/early-access-features/EarlyAccessFeature.tsx#FlagSelector"]={docgenInfo:FlagSelector.__docgenInfo,name:"FlagSelector",path:"frontend/src/scenes/early-access-features/EarlyAccessFeature.tsx#FlagSelector"})}catch(__react_docgen_typescript_loader_error){}},"./frontend/src/scenes/early-access-features/earlyAccessFeaturesLogic.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return earlyAccessFeaturesLogic}});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/lib/api.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/scenes/urls.ts");const earlyAccessFeaturesLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","features","featuresLogic"]),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)({earlyAccessFeatures:{__default:[],loadEarlyAccessFeatures:async()=>(await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.earlyAccessFeatures.list()).results}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({breadcrumbs:[()=>[],()=>[{name:"Early Access Management",path:scenes_urls__WEBPACK_IMPORTED_MODULE_3__.j.earlyAccessFeatures()}]]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.afterMount)((async _ref=>{let{actions:actions}=_ref;await actions.loadEarlyAccessFeatures()}))])},"./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/scenes/persons/Persons.scss":function(module,exports,__webpack_require__){(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".extra-ids{display:inline-flex;align-items:center;height:1.25rem;line-height:1.125rem;margin:0 0 0 .25rem;padding:0 .25rem 0 .375rem;color:var(--primary);cursor:pointer}.extra-ids svg{margin-left:.25rem}",""]),module.exports=exports},"./frontend/src/scenes/persons/Persons.scss":function(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__){"use strict";var _node_modules_pnpm_style_loader_2_0_0_webpack_5_88_2_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/style-loader@2.0.0_webpack@5.88.2/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),_node_modules_pnpm_style_loader_2_0_0_webpack_5_88_2_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_style_loader_2_0_0_webpack_5_88_2_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_3_6_0_webpack_5_88_2_node_modules_css_loader_dist_cjs_js_node_modules_pnpm_postcss_loader_4_3_0_postcss_8_4_18_webpack_5_88_2_node_modules_postcss_loader_dist_cjs_js_node_modules_pnpm_sass_loader_10_3_1_sass_1_56_0_webpack_5_88_2_node_modules_sass_loader_dist_cjs_js_ruleSet_1_rules_2_use_3_Persons_scss__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/scenes/persons/Persons.scss"),_node_modules_pnpm_css_loader_3_6_0_webpack_5_88_2_node_modules_css_loader_dist_cjs_js_node_modules_pnpm_postcss_loader_4_3_0_postcss_8_4_18_webpack_5_88_2_node_modules_postcss_loader_dist_cjs_js_node_modules_pnpm_sass_loader_10_3_1_sass_1_56_0_webpack_5_88_2_node_modules_sass_loader_dist_cjs_js_ruleSet_1_rules_2_use_3_Persons_scss__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_node_modules_pnpm_css_loader_3_6_0_webpack_5_88_2_node_modules_css_loader_dist_cjs_js_node_modules_pnpm_postcss_loader_4_3_0_postcss_8_4_18_webpack_5_88_2_node_modules_postcss_loader_dist_cjs_js_node_modules_pnpm_sass_loader_10_3_1_sass_1_56_0_webpack_5_88_2_node_modules_sass_loader_dist_cjs_js_ruleSet_1_rules_2_use_3_Persons_scss__WEBPACK_IMPORTED_MODULE_1__),options={insert:"head",singleton:!1};_node_modules_pnpm_style_loader_2_0_0_webpack_5_88_2_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default()(_node_modules_pnpm_css_loader_3_6_0_webpack_5_88_2_node_modules_css_loader_dist_cjs_js_node_modules_pnpm_postcss_loader_4_3_0_postcss_8_4_18_webpack_5_88_2_node_modules_postcss_loader_dist_cjs_js_node_modules_pnpm_sass_loader_10_3_1_sass_1_56_0_webpack_5_88_2_node_modules_sass_loader_dist_cjs_js_ruleSet_1_rules_2_use_3_Persons_scss__WEBPACK_IMPORTED_MODULE_1___default(),options),_node_modules_pnpm_css_loader_3_6_0_webpack_5_88_2_node_modules_css_loader_dist_cjs_js_node_modules_pnpm_postcss_loader_4_3_0_postcss_8_4_18_webpack_5_88_2_node_modules_postcss_loader_dist_cjs_js_node_modules_pnpm_sass_loader_10_3_1_sass_1_56_0_webpack_5_88_2_node_modules_sass_loader_dist_cjs_js_ruleSet_1_rules_2_use_3_Persons_scss__WEBPACK_IMPORTED_MODULE_1___default().locals}}]);