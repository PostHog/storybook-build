(window.webpackJsonp=window.webpackJsonp||[]).push([[231],{5786:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return groupsListLogic}));__webpack_require__(37),__webpack_require__(42),__webpack_require__(36),__webpack_require__(46);var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(6),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__(66),__webpack_require__(12)),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__),kea__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1),lib_api__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(22),lib_utils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(11),scenes_teamLogic__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(29),scenes_urls__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(25),_models_groupsModel__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(174),groupsListLogic=Object(kea__WEBPACK_IMPORTED_MODULE_7__.kea)({path:["groups","groupsListLogic"],connect:{values:[scenes_teamLogic__WEBPACK_IMPORTED_MODULE_10__.a,["currentTeamId"],_models_groupsModel__WEBPACK_IMPORTED_MODULE_12__.a,["groupsEnabled","groupTypes"]]},actions:function actions(){return{loadGroups:function loadGroups(url){return{url:url}},setTab:function setTab(tab){return{tab:tab}}}},loaders:function loaders(_ref){var _loadGroups,values=_ref.values;return{groups:[{next_url:null,previous_url:null,results:[]},{loadGroups:(_loadGroups=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark((function _callee(_ref2){var url;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(url=_ref2.url,!values.groupsEnabled){_context.next=6;break}return url=url||"api/projects/".concat(values.currentTeamId,"/groups/?group_type_index=").concat(values.currentTab),_context.next=5,lib_api__WEBPACK_IMPORTED_MODULE_8__.a.get(url);case 5:return _context.abrupt("return",_context.sent);case 6:case"end":return _context.stop()}}),_callee)}))),function loadGroups(_x){return _loadGroups.apply(this,arguments)})}]}},reducers:{currentTab:["-1",{setTab:function setTab(_,_ref3){return _ref3.tab}}]},selectors:{currentTabName:[function(s){return[s.currentTab,s.groupTypes]},function(currentTab,groupTypes){return"-1"===currentTab?"Persons":(null==groupTypes?void 0:groupTypes.length)?Object(lib_utils__WEBPACK_IMPORTED_MODULE_9__.i)(groupTypes[parseInt(currentTab)].group_type):""}]},actionToUrl:function actionToUrl(){return{setTab:function setTab(_ref4){var tab=_ref4.tab;return"-1"!==tab?scenes_urls__WEBPACK_IMPORTED_MODULE_11__.a.groups(tab):scenes_urls__WEBPACK_IMPORTED_MODULE_11__.a.persons()}}},urlToAction:function urlToAction(_ref5){var actions=_ref5.actions;return{"/groups/:id":function groupsId(_ref6){var id=_ref6.id;id&&(actions.setTab(id),actions.loadGroups())}}}})},5793:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return PersonPageHeader}));var index_esm=__webpack_require__(1),PageHeader=__webpack_require__(329),react=__webpack_require__(0),react_default=__webpack_require__.n(react),tabs=(__webpack_require__(34),__webpack_require__(537)),utils=__webpack_require__(11),groupsModel=__webpack_require__(174),groupsListLogic=__webpack_require__(5786);function GroupsTabs(){var setTab=Object(index_esm.useActions)(groupsListLogic.a).setTab,currentTab=Object(index_esm.useValues)(groupsListLogic.a).currentTab,groupTypes=Object(index_esm.useValues)(groupsModel.a).groupTypes;return react_default.a.createElement(tabs.a,{activeKey:currentTab,onChange:function onChange(activeKey){return setTab(activeKey)}},react_default.a.createElement(tabs.a.TabPane,{tab:"Persons",key:"-1"}),groupTypes.map((function(groupType){return react_default.a.createElement(tabs.a.TabPane,{tab:Object(utils.i)(groupType.group_type),key:groupType.group_type_index})})))}function PersonPageHeader(_ref){var hideGroupTabs=_ref.hideGroupTabs,groupsEnabled=Object(index_esm.useValues)(groupsModel.a).groupsEnabled;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(PageHeader.a,{title:"Persons".concat(groupsEnabled?" & groups":""),caption:"List of persons (end users) ".concat(groupsEnabled?" and groups ":"","from your app or website.")}),!hideGroupTabs&&groupsEnabled&&react_default.a.createElement(GroupsTabs,null))}try{PersonPageHeader.displayName="PersonPageHeader",PersonPageHeader.__docgenInfo={description:"",displayName:"PersonPageHeader",props:{hideGroupTabs:{defaultValue:null,description:"",name:"hideGroupTabs",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"]={docgenInfo:PersonPageHeader.__docgenInfo,name:"PersonPageHeader",path:"frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"})}catch(__react_docgen_typescript_loader_error){}},5839:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene})),__webpack_require__.d(__webpack_exports__,"Persons",(function(){return Persons}));__webpack_require__(36),__webpack_require__(116);var react=__webpack_require__(0),react_default=__webpack_require__.n(react),index_esm=__webpack_require__(1),PersonsTable=__webpack_require__(1831),row=__webpack_require__(361),es_radio=__webpack_require__(1167),es_alert=__webpack_require__(714),es_button=__webpack_require__(114),ExportOutlined=__webpack_require__(5758),PlusOutlined=__webpack_require__(1806),personsLogic=__webpack_require__(1809),Link=__webpack_require__(64),LinkButton=__webpack_require__(376),ClockCircleFilled=__webpack_require__(5936),utils=__webpack_require__(11),slicedToArray=(__webpack_require__(80),__webpack_require__(255),__webpack_require__(14)),slicedToArray_default=__webpack_require__.n(slicedToArray),input=__webpack_require__(713),PersonsSearch_PersonsSearch=function PersonsSearch(_ref){var _ref$autoFocus=_ref.autoFocus,autoFocus=void 0===_ref$autoFocus||_ref$autoFocus,_useActions=Object(index_esm.useActions)(personsLogic.a),loadPersons=_useActions.loadPersons,setListFilters=_useActions.setListFilters,_useValues=Object(index_esm.useValues)(personsLogic.a),exampleEmail=_useValues.exampleEmail,listFilters=_useValues.listFilters,_useState=Object(react.useState)(""),_useState2=slicedToArray_default()(_useState,2),searchTerm=_useState2[0],setSearchTerm=_useState2[1];return Object(react.useEffect)((function(){setSearchTerm(listFilters.search)}),[]),react_default.a.createElement(input.a.Search,{"data-attr":"persons-search",placeholder:"search person by email, name or ID (e.g. ".concat(exampleEmail,")"),autoFocus:autoFocus,value:searchTerm,onChange:function onChange(e){setSearchTerm(e.target.value),e.target.value||(setListFilters({search:void 0}),loadPersons())},enterButton:!0,allowClear:!0,onSearch:function onSearch(){setListFilters({search:searchTerm||void 0}),loadPersons()},style:{width:"100%"}})};try{PersonsSearch_PersonsSearch.displayName="PersonsSearch",PersonsSearch_PersonsSearch.__docgenInfo={description:"",displayName:"PersonsSearch",props:{autoFocus:{defaultValue:{value:"true"},description:"",name:"autoFocus",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonsSearch.tsx#PersonsSearch"]={docgenInfo:PersonsSearch_PersonsSearch.__docgenInfo,name:"PersonsSearch",path:"frontend/src/scenes/persons/PersonsSearch.tsx#PersonsSearch"})}catch(__react_docgen_typescript_loader_error){}var icons=__webpack_require__(44),PersonPageHeader=__webpack_require__(5793),scene={component:Persons,logic:personsLogic.a};function Persons(){var _ref=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},cohort=_ref.cohort,_useActions=Object(index_esm.useActions)(personsLogic.a),loadPersons=_useActions.loadPersons,setListFilters=_useActions.setListFilters,_useValues=Object(index_esm.useValues)(personsLogic.a),persons=_useValues.persons,listFilters=_useValues.listFilters,personsLoading=_useValues.personsLoading;return Object(react.useEffect)((function(){cohort&&(setListFilters({cohort:cohort.id}),loadPersons())}),[]),react_default.a.createElement("div",{className:"persons-list"},react_default.a.createElement(PersonPageHeader.a,{hideGroupTabs:!!cohort}),react_default.a.createElement(row.a,{style:{gap:"0.75rem"},className:"mb"},react_default.a.createElement("div",{style:{flexGrow:1,maxWidth:600}},react_default.a.createElement(PersonsSearch_PersonsSearch,{autoFocus:!cohort}),react_default.a.createElement("div",{className:"text-muted text-small"},"You can also filter persons that have a certain property set (e.g. ",react_default.a.createElement("code",null,"has:email")," or"," ",react_default.a.createElement("code",null,"has:name"),")")),react_default.a.createElement("div",null,react_default.a.createElement(es_radio.a.Group,{buttonStyle:"solid",onChange:function onChange(e){var key=e.target.value;setListFilters({is_identified:"all"===key?void 0:key}),loadPersons()},value:void 0!==listFilters.is_identified?listFilters.is_identified.toString():"all"},react_default.a.createElement(es_radio.a.Button,{"data-attr":"people-types-tab-all",value:"all"},"All persons"),react_default.a.createElement(es_radio.a.Button,{"data-attr":"people-types-tab-identified",value:"true"},"Identified"),react_default.a.createElement(es_radio.a.Button,{"data-attr":"people-types-tab-anonymous",value:"false"},"Unidentified")))),"false"===listFilters.is_identified&&react_default.a.createElement("div",{className:"mb"},react_default.a.createElement(es_alert.a,{type:"info",closable:!0,message:react_default.a.createElement(react_default.a.Fragment,null,"Unidentified persons are usually anonymous visitors to your app or website that have not been identified to you. To mark a person as identified, call"," ",react_default.a.createElement("code",null,"posthog.identify")," on your frontend."," ",react_default.a.createElement("a",{href:"https://posthog.com/docs/integrations/js-integration?utm_medium=in-product&utm_campaign=persons-unidentified#identifying-users",target:"_blank",style:{display:"inline-flex",alignItems:"center"}},react_default.a.createElement(icons.IconExternalLink,null)," Learn more")),showIcon:!0})),react_default.a.createElement("div",{className:"mb text-right"},cohort?react_default.a.createElement(LinkButton.a,{to:"/sessions?".concat(Object(utils.ub)({properties:[{key:"id",value:cohort.id,type:"cohort"}]})),target:"_blank"},react_default.a.createElement(ClockCircleFilled.a,null)," View sessions"):null,react_default.a.createElement(es_button.a,{type:"default",icon:react_default.a.createElement(ExportOutlined.a,null),href:"/api/person.csv"+(listFilters.cohort?"?cohort="+listFilters.cohort:""),style:{marginLeft:8}},"Export"),react_default.a.createElement(Link.a,{to:"/cohorts/new",style:{display:"none"},className:"ml"},react_default.a.createElement(es_button.a,{type:"default",icon:react_default.a.createElement(PlusOutlined.a,null)},"New Cohort"))),react_default.a.createElement("div",null,react_default.a.createElement(PersonsTable.a,{people:persons.results,loading:personsLoading,hasPrevious:!!persons.previous,hasNext:!!persons.next,loadPrevious:function loadPrevious(){return loadPersons(persons.previous)},loadNext:function loadNext(){return loadPersons(persons.next)},allColumns:!0})))}try{Persons.displayName="Persons",Persons.__docgenInfo={description:"",displayName:"Persons",props:{cohort:{defaultValue:null,description:"",name:"cohort",required:!1,type:{name:"CohortType"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/Persons.tsx#Persons"]={docgenInfo:Persons.__docgenInfo,name:"Persons",path:"frontend/src/scenes/persons/Persons.tsx#Persons"})}catch(__react_docgen_typescript_loader_error){}},5936:function(module,__webpack_exports__,__webpack_require__){"use strict";var react=__webpack_require__(0),asn_ClockCircleFilled={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm176.5 585.7l-28.6 39a7.99 7.99 0 01-11.2 1.7L483.3 569.8a7.92 7.92 0 01-3.3-6.5V288c0-4.4 3.6-8 8-8h48.1c4.4 0 8 3.6 8 8v247.5l142.6 103.1c3.6 2.5 4.4 7.5 1.8 11.1z"}}]},name:"clock-circle",theme:"filled"},AntdIcon=__webpack_require__(18),icons_ClockCircleFilled_ClockCircleFilled=function ClockCircleFilled(props,ref){return react.createElement(AntdIcon.a,Object.assign({},props,{ref:ref,icon:asn_ClockCircleFilled}))};icons_ClockCircleFilled_ClockCircleFilled.displayName="ClockCircleFilled";__webpack_exports__.a=react.forwardRef(icons_ClockCircleFilled_ClockCircleFilled)}}]);