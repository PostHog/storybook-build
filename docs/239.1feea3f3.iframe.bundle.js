(window.webpackJsonp=window.webpackJsonp||[]).push([[239],{"./frontend/src/lib/forms/Field.tsx":function(U,h,a){"use strict";a.d(h,"a",function(){return p});var I=a("./node_modules/core-js/modules/es.function.name.js"),Q=a.n(I),G=a("./node_modules/@babel/runtime/helpers/extends.js"),H=a.n(G),L=a("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),T=a.n(L),b=a("./node_modules/clsx/dist/clsx.m.js"),e=a("./node_modules/kea-forms/lib/components.js"),P=a.n(e),j=a("./node_modules/react/index.js"),g=a.n(j),p=function(C){var $=C.showOptional,Y=C.name,se=T()(C,["showOptional","name"]),Z=function(K){var F=K.label,_=K.kids,J=K.hint,M=K.error;return g.a.createElement("div",{className:Object(b.a)("ant-row","ant-form-item",J||M?"ant-form-item-with-help":"",M?"ant-form-item-has-error":"")},F?g.a.createElement("div",{className:"ant-col ant-form-item-label"},g.a.createElement("label",{htmlFor:String(Y),title:typeof F=="string"?F:void 0},$?g.a.createElement(g.a.Fragment,null,F,$?g.a.createElement("span",{className:"ant-form-item-optional",title:""},"(optional)"):null):F)):null,g.a.createElement("div",{className:"ant-col ant-form-item-control"},g.a.createElement("div",{className:"ant-form-item-control-input"},g.a.createElement("div",{className:"ant-form-item-control-input-content"},_)),J||M?g.a.createElement("div",{className:"ant-form-item-explain ant-form-item-explain-connected"},M?g.a.createElement("div",{role:"alert",className:"ant-form-item-explain-error"},"Error: ",M):null,J?g.a.createElement("div",{role:"alert",className:"ant-form-item-explain-warning"},"Hint: ",J):null):null))};return g.a.createElement(e.Field,H()({},se,{name:Y,template:Z}))};try{p.displayName="Field",p.__docgenInfo={description:"Compatible replacement for Form.Item",displayName:"Field",props:{showOptional:{defaultValue:null,description:"",name:"showOptional",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/forms/Field.tsx#Field"]={docgenInfo:p.__docgenInfo,name:"Field",path:"frontend/src/lib/forms/Field.tsx#Field"})}catch(A){}},"./frontend/src/lib/forms/VerticalForm.tsx":function(U,h,a){"use strict";a.d(h,"a",function(){return e});var I=a("./node_modules/@babel/runtime/helpers/extends.js"),Q=a.n(I),G=a("./node_modules/react/index.js"),H=a.n(G),L=a("./node_modules/kea-forms/lib/index.js"),T=a.n(L),b=a("./node_modules/clsx/dist/clsx.m.js");function e(P){return H.a.createElement(L.Form,Q()({},P,{className:Object(b.a)("antd-form ant-form-vertical",P.className)}),P.children)}try{e.displayName="VerticalForm",e.__docgenInfo={description:"",displayName:"VerticalForm",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/forms/VerticalForm.tsx#VerticalForm"]={docgenInfo:e.__docgenInfo,name:"VerticalForm",path:"frontend/src/lib/forms/VerticalForm.tsx#VerticalForm"})}catch(P){}},"./frontend/src/lib/introductions/GroupsIntroductionOption.tsx":function(U,h,a){"use strict";a.d(h,"a",function(){return p});var I=a("./node_modules/core-js/modules/es.array.includes.js"),Q=a.n(I),G=a("./node_modules/core-js/modules/es.string.includes.js"),H=a.n(G),L=a("./node_modules/react/index.js"),T=a.n(L),b=a("./node_modules/kea/lib/index.esm.js"),e=a("./node_modules/@ant-design/icons/es/icons/LockOutlined.js"),P=a("./node_modules/rc-select/es/index.js"),j=a("./frontend/src/lib/components/Link.tsx"),g=a("./frontend/src/lib/introductions/groupsAccessLogic.ts");function p(A){var C=A.value,$=Object(b.useValues)(g.b),Y=$.groupsAccessStatus;return[g.a.HasAccess,g.a.HasGroupTypes,g.a.NoAccess].includes(Y)?T.a.createElement(P.default.Option,{key:"groups",value:C,disabled:!0,style:{height:"100%",width:"100%",overflow:"hidden",textOverflow:"ellipsis",backgroundColor:"var(--bg-side)",color:"var(--text-muted)"}},T.a.createElement(e.a,{style:{marginRight:6,color:"var(--warning)"}}),"Unique groups \u2013"," ",T.a.createElement(j.a,{to:"https://posthog.com/docs/user-guides/group-analytics?utm_medium=in-product&utm_campaign=group-analytics-learn-more",target:"_blank","data-attr":"group-analytics-learn-more",style:{fontWeight:600}},"Learn more")):null}try{p.displayName="GroupsIntroductionOption",p.__docgenInfo={description:"",displayName:"GroupsIntroductionOption",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"]={docgenInfo:p.__docgenInfo,name:"GroupsIntroductionOption",path:"frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"})}catch(A){}},"./frontend/src/scenes/feature-flags/FeatureFlag.tsx":function(U,h,a){"use strict";a.r(h),a.d(h,"scene",function(){return ot}),a.d(h,"FeatureFlag",function(){return z});var I=a("./node_modules/core-js/modules/es.array.concat.js"),Q=a("./node_modules/core-js/modules/es.array.map.js"),G=a("./node_modules/core-js/modules/es.object.to-string.js"),H=a("./node_modules/core-js/modules/es.regexp.to-string.js"),L=a("./node_modules/@babel/runtime/helpers/slicedToArray.js"),T=a.n(L),b=a("./node_modules/react/index.js"),e=a.n(b),P=a("./node_modules/kea-forms/lib/index.js"),j=a("./node_modules/antd/es/button/index.js"),g=a("./node_modules/antd/es/row/index.js"),p=a("./node_modules/antd/es/col/index.js"),A=a("./node_modules/antd/es/input/index.js"),C=a("./node_modules/antd/es/collapse/index.js"),$=a("./node_modules/antd/es/popconfirm/index.js"),Y=a("./node_modules/antd/es/radio/index.js"),se=a("./node_modules/antd/es/slider/index.js"),Z=a("./node_modules/antd/es/input-number/index.js"),k=a("./node_modules/antd/es/select/index.js"),K=a("./node_modules/antd/es/card/index.js"),F=a("./node_modules/kea/lib/index.esm.js"),_=a("./frontend/src/lib/utils.tsx"),J=a("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),M=a("./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js"),ve=a("./node_modules/@ant-design/icons/es/icons/SaveOutlined.js"),Ve=a("./node_modules/@ant-design/icons/es/icons/ApiFilled.js"),Ke=a("./node_modules/@ant-design/icons/es/icons/LockOutlined.js"),_e=a("./node_modules/@ant-design/icons/es/icons/MergeCellsOutlined.js"),Ee=a("./node_modules/@ant-design/icons/es/icons/PlusOutlined.js"),St=a("./node_modules/core-js/modules/es.array.every.js"),xt=a("./node_modules/core-js/modules/es.array.filter.js"),Tt=a("./node_modules/core-js/modules/es.array.find.js"),bt=a("./node_modules/core-js/modules/es.array.for-each.js"),Pt=a("./node_modules/core-js/modules/es.array.iterator.js"),At=a("./node_modules/core-js/modules/es.array.reduce.js"),It=a("./node_modules/core-js/modules/es.array.splice.js"),Lt=a("./node_modules/core-js/modules/es.function.name.js"),Mt=a("./node_modules/core-js/modules/es.regexp.exec.js"),Rt=a("./node_modules/core-js/modules/es.string.match.js"),Dt=a("./node_modules/core-js/modules/es.string.replace.js"),Nt=a("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Vt=a("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Be=a("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),We=a.n(Be),Ue=a("./node_modules/@babel/runtime/regenerator/index.js"),R=a.n(Ue),Kt=a("./node_modules/regenerator-runtime/runtime.js"),Ge=a("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),q=a.n(Ge),$e=a("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),D=a.n($e),Ye=a("./node_modules/@babel/runtime/helpers/defineProperty.js"),ye=a.n(Ye),ie=a("./frontend/src/lib/api.ts"),he=a("./node_modules/kea-router/lib/index.js"),ee=a("./frontend/src/scenes/urls.ts"),Oe=a("./frontend/src/scenes/teamLogic.ts"),ue=a("./frontend/src/scenes/feature-flags/featureFlagsLogic.ts"),Fe=a("./frontend/src/models/groupsModel.ts"),je=a("./frontend/src/lib/components/TaxonomicFilter/types.ts"),Je=a("./frontend/src/lib/components/lemonToast.tsx");function Ce(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),r.push.apply(r,o)}return r}function l(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ce(Object(r),!0).forEach(function(o){ye()(n,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Ce(Object(r)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(r,o))})}return n}var ce={id:null,created_at:null,key:"",name:"",filters:{groups:[{properties:[],rollout_percentage:null}],multivariate:null},deleted:!1,active:!0,created_by:null,is_simple_flag:!1,rollout_percentage:null},we={key:"",name:"",rollout_percentage:0},He={variants:[{key:"",name:"",rollout_percentage:100}]},te=Object(F.kea)({path:function(t){return["scenes","feature-flags","featureFlagLogic",t]},props:{},key:function(t){var r=t.id;return r!=null?r:"new"},connect:{values:[Oe.a,["currentTeamId"],Fe.a,["groupTypes","groupsTaxonomicTypes","aggregationLabel"]]},actions:{setFeatureFlag:function(t){return{featureFlag:t}},addConditionSet:!0,setAggregationGroupTypeIndex:function(t){return{value:t}},removeConditionSet:function(t){return{index:t}},duplicateConditionSet:function(t){return{index:t}},updateConditionSet:function(t,r,o){return{index:t,newRolloutPercentage:r,newProperties:o}},deleteFeatureFlag:function(t){return{featureFlag:t}},setMultivariateEnabled:function(t){return{enabled:t}},setMultivariateOptions:function(t){return{multivariateOptions:t}},addVariant:!0,removeVariant:function(t){return{index:t}},distributeVariantsEqually:!0},forms:function(t){var r=t.actions;return{featureFlag:{defaults:l({},ce),validator:function(u){var i,s,m,c=u.key,O=u.filters;return{key:c?!((i=c.match)===null||i===void 0)&&i.call(c,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key",filters:{multivariate:{variants:O==null||(s=O.multivariate)===null||s===void 0||(m=s.variants)===null||m===void 0?void 0:m.map(function(y){var W,E=y.key;return{key:E?!((W=E.match)===null||W===void 0)&&W.call(E,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key"}})}}}},submit:function(u){r.saveFeatureFlag(u)}}}},reducers:{featureFlag:[l({},ce),{setFeatureFlag:function(t,r){var o=r.featureFlag;if(o.filters.groups){var u=o.filters.groups.map(function(i){return i.properties?l(l({},i),{},{properties:Object(_.s)(i.properties)}):i});return l(l({},o),{},{filters:l(l({},o==null?void 0:o.filters),{},{groups:u})})}return o},addConditionSet:function(t){if(!t)return t;var r=[].concat(D()(t==null?void 0:t.filters.groups),[{properties:[],rollout_percentage:null}]);return l(l({},t),{},{filters:l(l({},t.filters),{},{groups:r})})},updateConditionSet:function(t,r){var o=r.index,u=r.newRolloutPercentage,i=r.newProperties;if(!t)return t;var s=D()(t==null?void 0:t.filters.groups);return u!==void 0&&(s[o]=l(l({},s[o]),{},{rollout_percentage:u})),i!==void 0&&(s[o]=l(l({},s[o]),{},{properties:i})),l(l({},t),{},{filters:l(l({},t.filters),{},{groups:s})})},removeConditionSet:function(t,r){var o=r.index;if(!t)return t;var u=D()(t.filters.groups);return u.splice(o,1),l(l({},t),{},{filters:l(l({},t.filters),{},{groups:u})})},duplicateConditionSet:function(t,r){var o=r.index;if(!t)return t;var u=t.filters.groups.concat([t.filters.groups[o]]);return l(l({},t),{},{filters:l(l({},t.filters),{},{groups:u})})},setMultivariateOptions:function(t,r){var o=r.multivariateOptions;return t&&l(l({},t),{},{filters:l(l({},t.filters),{},{multivariate:o})})},addVariant:function(t){var r;if(!t)return t;var o=D()(((r=t.filters.multivariate)===null||r===void 0?void 0:r.variants)||[]);return l(l({},t),{},{filters:l(l({},t.filters),{},{multivariate:l(l({},t.filters.multivariate||{}),{},{variants:[].concat(D()(o),[we])})})})},removeVariant:function(t,r){var o,u=r.index;if(!t)return t;var i=D()(((o=t.filters.multivariate)===null||o===void 0?void 0:o.variants)||[]);return i.splice(u,1),l(l({},t),{},{filters:l(l({},t.filters),{},{multivariate:l(l({},t.filters.multivariate),{},{variants:i})})})},distributeVariantsEqually:function(t){var r;if(!t)return t;var o=D()(((r=t.filters.multivariate)===null||r===void 0?void 0:r.variants)||[]),u=o.length;if(u>0&&u<=100){var i=Math.round(100/u),s=i*u,m=s-100;o.forEach(function(c,O){o[O]=l(l({},c),{},{rollout_percentage:i})}),o[u-1]=l(l({},o[u-1]),{},{rollout_percentage:i-m})}return l(l({},t),{},{filters:l(l({},t.filters),{},{multivariate:l(l({},t.filters.multivariate),{},{variants:o})})})},setAggregationGroupTypeIndex:function(t,r){var o=r.value;return!t||t.filters.aggregation_group_type_index==o?t:l(l({},t),{},{filters:l(l({},t.filters),{},{aggregation_group_type_index:o,groups:[{properties:[],rollout_percentage:null}]})})}}]},loaders:function(t){var r=t.values,o=t.props;return{featureFlag:{loadFeatureFlag:function(){var u=q()(R.a.mark(function s(){return R.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(o.id&&o.id!=="new")){c.next=4;break}return c.next=3,ie.a.get("api/projects/".concat(r.currentTeamId,"/feature_flags/").concat(o.id));case 3:return c.abrupt("return",c.sent);case 4:return c.abrupt("return",ce);case 5:case"end":return c.stop()}},s)}));function i(){return u.apply(this,arguments)}return i}(),saveFeatureFlag:function(){var u=q()(R.a.mark(function s(m){var c,O,y;return R.a.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(c=m.created_at,O=m.id,y=We()(m,["created_at","id"]),m.id){E.next=7;break}return E.next=4,ie.a.create("api/projects/".concat(r.currentTeamId,"/feature_flags"),y);case 4:return E.abrupt("return",E.sent);case 7:return E.next=9,ie.a.update("api/projects/".concat(r.currentTeamId,"/feature_flags/").concat(m.id),y);case 9:return E.abrupt("return",E.sent);case 10:case"end":return E.stop()}},s)}));function i(s){return u.apply(this,arguments)}return i}()}}},listeners:function(t){var r=t.actions,o=t.values;return{saveFeatureFlagSuccess:function(i){var s,m=i.featureFlag;Je.a.success("Feature flag saved"),(s=ue.a.findMounted())===null||s===void 0||s.actions.updateFlag(m),he.router.actions.replace(ee.a.featureFlag(m.id))},deleteFeatureFlag:function(){var u=q()(R.a.mark(function s(m){var c;return R.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:c=m.featureFlag,Object(_.x)({endpoint:"projects/".concat(o.currentTeamId,"/feature_flags"),object:{name:c.name,id:c.id},callback:function(){var E;c.id&&((E=ue.a.findMounted())===null||E===void 0||E.actions.deleteFlag(c.id)),he.router.actions.push(ee.a.featureFlags())}});case 2:case"end":return y.stop()}},s)}));function i(s){return u.apply(this,arguments)}return i}(),setMultivariateEnabled:function(){var u=q()(R.a.mark(function s(m){var c;return R.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:c=m.enabled,c?r.setMultivariateOptions(He):r.setMultivariateOptions(null);case 2:case"end":return y.stop()}},s)}));function i(s){return u.apply(this,arguments)}return i}()}},selectors:{multivariateEnabled:[function(n){return[n.featureFlag]},function(n){return!!(n!=null&&n.filters.multivariate)}],variants:[function(n){return[n.featureFlag]},function(n){var t;return(n==null||(t=n.filters.multivariate)===null||t===void 0?void 0:t.variants)||[]}],nonEmptyVariants:[function(n){return[n.variants]},function(n){return n.filter(function(t){var r=t.key;return!!r})}],variantRolloutSum:[function(n){return[n.variants]},function(n){return n.reduce(function(t,r){var o=r.rollout_percentage;return t+o},0)}],areVariantRolloutsValid:[function(n){return[n.variants,n.variantRolloutSum]},function(n,t){return n.every(function(r){var o=r.rollout_percentage;return o>=0&&o<=100})&&t===100}],aggregationTargetName:[function(n){return[n.featureFlag,n.groupTypes,n.aggregationLabel]},function(n,t,r){return n&&n.filters.aggregation_group_type_index!=null&&t.length>0?r(n.filters.aggregation_group_type_index).plural:"users"}],taxonomicGroupTypes:[function(n){return[n.featureFlag,n.groupsTaxonomicTypes]},function(n,t){return n&&n.filters.aggregation_group_type_index!=null&&t.length>0?[t[n.filters.aggregation_group_type_index]]:[je.a.PersonProperties,je.a.Cohorts]}],breadcrumbs:[function(n){return[n.featureFlag]},function(n){return[{name:"Feature Flags",path:ee.a.featureFlags()}].concat(D()(n?[{name:n.key||"Unnamed"}]:[]))}]},urlToAction:function(t){var r,o=t.actions,u=t.props;return ye()({},ee.a.featureFlag((r=u.id)!==null&&r!==void 0?r:"new"),function(i,s,m,c){var O=c.method;O==="PUSH"&&(u.id?o.loadFeatureFlag():o.resetFeatureFlag())})},events:function(t){var r=t.props,o=t.actions;return{afterMount:function(){var i,s=(i=ue.a.findMounted())===null||i===void 0?void 0:i.values.featureFlags.find(function(m){return m.id===r.id});s?o.setFeatureFlag(s):r.id!=="new"&&o.loadFeatureFlag()}}}}),ze=a("./frontend/src/lib/components/PageHeader.tsx"),Xe=a("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),Qe=a.n(Xe),Ze=a("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss"),Se=a.n(Ze),de={};de.insert="head",de.singleton=!1;var _t=Qe()(Se.a,de),Bt=Se.a.locals||{},N=a("./frontend/src/lib/components/icons.tsx"),ae=a("./frontend/src/lib/components/Tooltip.tsx"),w=a("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),ne="?utm_medium=in-product&utm_campaign=feature-flag";function re(n){var t=n.flagKey;return e.a.createElement(e.a.Fragment,null,e.a.createElement(w.a,{language:w.b.JavaScript,wrap:!0},"if\xA0(posthog.isFeatureEnabled('".concat(t!=null?t:"",`')) {
    // run your activation code here
}`)),e.a.createElement("div",{className:"mt"},"Need more information?"," ",e.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://posthog.com/docs/integrations/js-integration".concat(ne,"#feature-flags")},"Check the docs ",e.a.createElement(N.IconOpenInNew,null))))}function oe(n){var t=n.flagKey;return e.a.createElement(e.a.Fragment,null,e.a.createElement(w.a,{language:w.b.Python,wrap:!0},'if\xA0posthog.feature_enabled("'.concat(t,`", "user_distinct_id"):
    runAwesomeFeature()
`)),e.a.createElement("div",{className:"mt"},"Need more information?"," ",e.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://posthog.com/docs/integrations/python-integration".concat(ne,"#feature-flags")},"Check the docs ",e.a.createElement(N.IconOpenInNew,null))))}function ke(){var n=Object(F.useValues)(Oe.a),t=n.currentTeam;return e.a.createElement(e.a.Fragment,null,e.a.createElement(w.a,{language:w.b.Bash,wrap:!0},"curl ".concat(window.location.origin,`/decide/ \\
-X POST -H 'Content-Type: application/json' \\
-d '{
    "api_key": "`).concat(t?t.api_token:"[project_api_key]",`",
    "distinct_id": "[user distinct id]"
}'
                `)),e.a.createElement("div",{className:"mt"},"Need more information?"," ",e.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://posthog.com/docs/api/feature-flags".concat(ne)},"Check the docs ",e.a.createElement(N.IconOpenInNew,null))))}try{re.displayName="JSSnippet",re.__docgenInfo={description:"",displayName:"JSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"]={docgenInfo:re.__docgenInfo,name:"JSSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"})}catch(n){}try{oe.displayName="PythonSnippet",oe.__docgenInfo={description:"",displayName:"PythonSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"]={docgenInfo:oe.__docgenInfo,name:"PythonSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"})}catch(n){}var xe=a("./frontend/src/lib/components/LemonRow/index.ts"),qe=a("./frontend/src/lib/introductions/GroupsIntroductionOption.tsx"),et=a("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),tt=a("./frontend/src/scenes/userLogic.ts"),me=a("./frontend/src/types.ts"),at=a("./frontend/src/lib/components/Link.tsx"),Te=a("./frontend/src/lib/components/LemonButton/index.ts"),nt=a("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),B=a("./frontend/src/lib/forms/Field.tsx"),rt=a("./frontend/src/lib/forms/VerticalForm.tsx"),ot={component:z,logic:te,paramsToProps:function(t){var r=t.params.id;return{id:r&&r!=="new"?parseInt(r):"new"}}};function be(n){setTimeout(function(){var t;return(t=document.querySelector('.variant-form-list input[data-key-index="'.concat(n,'"]')))===null||t===void 0?void 0:t.focus()},50)}function z(){var n,t,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=r.id,u={id:o&&o!=="new"?parseInt(o):"new"},i=Object(F.useValues)(te(u)),s=i.featureFlag,m=i.multivariateEnabled,c=i.variants,O=i.nonEmptyVariants,y=i.areVariantRolloutsValid,W=i.variantRolloutSum,E=i.groupTypes,X=i.aggregationTargetName,lt=i.taxonomicGroupTypes,st=i.featureFlagLoading,S=Object(F.useActions)(te(u)),it=S.addConditionSet,Pe=S.updateConditionSet,ut=S.removeConditionSet,ct=S.duplicateConditionSet,dt=S.deleteFeatureFlag,Ae=S.setMultivariateEnabled,mt=S.addVariant,ft=S.removeVariant,gt=S.distributeVariantsEqually,pt=S.setAggregationGroupTypeIndex,Ie=Object(F.useValues)(Fe.a),vt=Ie.showGroupsOptions,Et=Ie.aggregationLabel,Le=Object(F.useValues)(tt.a),fe=Le.hasAvailableFeature,yt=Le.upgradeLink,ht=Object(b.useState)(!1),Me=T()(ht,2),Re=Me[0],Ot=Me[1],Ft=Object(b.useState)(!1),De=T()(Ft,2),jt=De[0],ge=De[1],Ct=Object(qe.a)({value:-2});return e.a.createElement("div",{className:"feature-flag"},s?e.a.createElement(rt.a,{logic:te,props:u,formKey:"featureFlag"},e.a.createElement(ze.a,{title:"Feature Flag",buttons:e.a.createElement("div",{style:{display:"flex"}},e.a.createElement(B.a,{name:"active"},function(f){var d=f.value,v=f.onValueChange;return e.a.createElement(nt.a,{checked:d,onChange:v,label:d?e.a.createElement("span",{className:"text-success"},"Enabled"):e.a.createElement("span",{className:"text-danger"},"Disabled")})}),(s==null?void 0:s.id)&&e.a.createElement(j.a,{"data-attr":"delete-flag",danger:!0,icon:e.a.createElement(M.a,null),onClick:function(){dt(s)},style:{marginRight:16}},"Delete"),e.a.createElement(j.a,{icon:e.a.createElement(ve.a,null),type:"primary","data-attr":"feature-flag-submit",loading:st,htmlType:"submit"},"Save changes"))}),e.a.createElement("h3",{className:"l3"},"General configuration"),e.a.createElement("div",{className:"text-muted mb"},"General settings for your feature flag and integration instructions."),e.a.createElement(g.a,{gutter:16,style:{marginBottom:32}},e.a.createElement(p.a,{span:12},e.a.createElement(B.a,{name:"key",label:"Key (must be unique)",validateStatus:Re?"warning":void 0,hint:Re&&o!=="new"?e.a.createElement("small",null,e.a.createElement("b",null,"Warning! "),"Changing this key will",e.a.createElement("a",{href:"https://posthog.com/docs/features/feature-flags".concat(ne,"#feature-flag-persistence"),target:"_blank",rel:"noopener"}," ","affect the persistence of your flag ",e.a.createElement(N.IconOpenInNew,null))):void 0},function(f){var d=f.value,v=f.onChange;return e.a.createElement(A.a,{value:d,onChange:function(x){x.target.value!==d&&Ot(!0),v(x)},"data-attr":"feature-flag-key",className:"ph-ignore-input",autoFocus:!0,placeholder:"examples: new-landing-page, betaFeature, ab_test_1",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})}),e.a.createElement(B.a,{name:"name",label:"Description"},function(f){var d=f.value,v=f.onChange;return e.a.createElement(A.a.TextArea,{value:d,onChange:v,className:"ph-ignore-input","data-attr":"feature-flag-description",placeholder:"Adding a helpful description can ensure others know what this feature is for."})})),e.a.createElement(p.a,{span:12,style:{paddingTop:31}},e.a.createElement(C.a,null,e.a.createElement(C.a.Panel,{header:e.a.createElement("div",{style:{display:"flex",fontWeight:"bold",alignItems:"center"}},e.a.createElement(N.IconJavascript,{style:{marginRight:6}})," Javascript integration instructions"),key:"js"},e.a.createElement(re,{flagKey:s.key||"my-flag"})),e.a.createElement(C.a.Panel,{header:e.a.createElement("div",{style:{display:"flex",fontWeight:"bold",alignItems:"center"}},e.a.createElement(N.IconPython,{style:{marginRight:6}})," Python integration instructions"),key:"python"},e.a.createElement(oe,{flagKey:s.key||"my-flag"})),e.a.createElement(C.a.Panel,{header:e.a.createElement("div",{style:{display:"flex",fontWeight:"bold",alignItems:"center"}},e.a.createElement(Ve.a,{style:{marginRight:6}})," API integration instructions"),key:"api"},e.a.createElement(ke,null))))),e.a.createElement("div",{className:"mb-2"},e.a.createElement("h3",{className:"l3"},"Served value"),e.a.createElement("div",{className:"mb-05"},e.a.createElement($.a,{placement:"top",title:"Change value type? The variants below will be lost.",visible:jt,onConfirm:function(){Ae(!1),ge(!1)},onCancel:function(){return ge(!1)},okText:"OK",cancelText:"Cancel"},e.a.createElement(Y.a.Group,{options:[{label:"Boolean value (A/B test)",value:!1},{label:e.a.createElement(ae.a,{title:fe(me.c.MULTIVARIATE_FLAGS)?"":"This feature is not available on your current plan."},e.a.createElement("div",null,!fe(me.c.MULTIVARIATE_FLAGS)&&e.a.createElement(at.a,{to:yt,target:"_blank"},e.a.createElement(Ke.a,{style:{marginRight:4,color:"var(--warning)"}})),"String value (Multivariate test)"," ",e.a.createElement(et.a,{type:"warning"},"Beta"))),value:!0,disabled:!fe(me.c.MULTIVARIATE_FLAGS)}],onChange:function(d){var v=d.target.value;v===!1&&O.length?ge(!0):(Ae(v),be(0))},value:m,optionType:"button"}))),e.a.createElement("div",{className:"text-muted mb"},Object(_.j)(X)," will be served"," ",m?e.a.createElement(e.a.Fragment,null,e.a.createElement("strong",null,"a variant key")," according to the below distribution"):e.a.createElement("strong",null,e.a.createElement("code",null,"true"))," ","if they match one or more release condition groups."),m&&e.a.createElement("div",{className:"variant-form-list"},e.a.createElement(g.a,{gutter:8,className:"label-row"},e.a.createElement(p.a,{span:7},"Variant key"),e.a.createElement(p.a,{span:7},"Description"),e.a.createElement(p.a,{span:9},e.a.createElement("span",null,"Rollout percentage"),e.a.createElement(j.a,{type:"link",onClick:gt,icon:e.a.createElement(_e.a,null),style:{padding:"0 0 0 0.5em"},title:"Distribute variants equally"},"Distribute"))),c.map(function(f,d){return e.a.createElement(P.Group,{key:d,name:["filters","multivariate","variants",d]},e.a.createElement(g.a,{gutter:8},e.a.createElement(p.a,{span:7},e.a.createElement(B.a,{name:"key"},e.a.createElement(A.a,{"data-attr":"feature-flag-variant-key","data-key-index":d.toString(),className:"ph-ignore-input",placeholder:"example-variant-".concat(d+1),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}))),e.a.createElement(p.a,{span:7},e.a.createElement(B.a,{name:"name"},e.a.createElement(A.a,{"data-attr":"feature-flag-variant-name",className:"ph-ignore-input",placeholder:"Description"}))),e.a.createElement(p.a,{span:7},e.a.createElement(B.a,{name:"rollout_percentage"},function(v){var V=v.value,x=v.onValueChange;return e.a.createElement(se.a,{tooltipPlacement:"top",value:V,onChange:x})})),e.a.createElement(p.a,{span:2},e.a.createElement(B.a,{name:"rollout_percentage"},function(v){var V=v.value,x=v.onValueChange;return e.a.createElement(Z.a,{min:0,max:100,value:V,onChange:function(pe){if(pe!=null){var Ne=parseInt(pe.toString());isNaN(Ne)||x(Ne)}},style:{width:"100%",borderColor:y?void 0:"var(--danger)"}})})),c.length>1&&e.a.createElement(p.a,{span:1},e.a.createElement(ae.a,{title:"Delete this variant",placement:"bottomLeft"},e.a.createElement(j.a,{type:"link",icon:e.a.createElement(M.a,null),onClick:function(){return ft(d)},style:{color:"var(--danger)"}})))))}),c.length>0&&!y&&e.a.createElement("p",{className:"text-danger"},"Percentage rollouts for variants must sum to 100 (currently ",W,")."),e.a.createElement(j.a,{type:"dashed",block:!0,icon:e.a.createElement(Ee.a,null),onClick:function(){var d=c.length;mt(),be(d)},style:{marginBottom:16}},"Add Variant"))),e.a.createElement("div",{className:"feature-flag-form-row"},e.a.createElement("div",null,e.a.createElement("h3",{className:"l3"},"Release conditions"),e.a.createElement("div",{className:"text-muted mb"},"Specify the ",X," to which you want to release this flag. Note that condition sets are rolled out independently of each other.")),vt&&e.a.createElement("div",{className:"centered"},"Match by",e.a.createElement(k.a,{value:((n=s.filters)===null||n===void 0?void 0:n.aggregation_group_type_index)!=null?(t=s.filters)===null||t===void 0?void 0:t.aggregation_group_type_index:-1,onChange:function(d){var v=d!==-1?d:null;pt(v)},style:{marginLeft:8},"data-attr":"feature-flag-aggregation-filter",dropdownMatchSelectWidth:!1,dropdownAlign:{points:["tr","br"]}},e.a.createElement(k.a.Option,{key:-1,value:-1},"Users"),E.map(function(f){return e.a.createElement(k.a.Option,{key:f.group_type_index,value:f.group_type_index},Object(_.j)(Et(f.group_type_index).plural))}),Ct))),e.a.createElement(g.a,{gutter:16},s.filters.groups.map(function(f,d){var v,V;return e.a.createElement(p.a,{span:24,md:24,key:"".concat(d,"-").concat(s.filters.groups.length)},d>0&&e.a.createElement("div",{style:{display:"flex",marginLeft:16}},e.a.createElement("div",{className:"stateful-badge or-light-grey mb"},"OR")),e.a.createElement(K.a,{style:{marginBottom:16}},e.a.createElement("div",{className:"feature-flag-form-row",style:{height:24}},e.a.createElement("div",null,e.a.createElement("span",{className:"simple-tag tag-light-blue",style:{marginRight:8}},"Set ",d+1),!((v=f.properties)===null||v===void 0)&&v.length?e.a.createElement(e.a.Fragment,null,"Matching ",e.a.createElement("b",null,X)," with filters"):e.a.createElement(e.a.Fragment,null,"Condition set will match ",e.a.createElement("b",null,"all ",X))),e.a.createElement(g.a,{align:"middle"},e.a.createElement(ae.a,{title:"Duplicate this condition set",placement:"bottomLeft"},e.a.createElement(Te.a,{icon:e.a.createElement(N.IconCopy,null),compact:!0,onClick:function(){return ct(d)}})),s.filters.groups.length>1&&e.a.createElement(ae.a,{title:"Delete this condition set",placement:"bottomLeft"},e.a.createElement(Te.a,{icon:e.a.createElement(N.IconDelete,null),compact:!0,onClick:function(){return ut(d)}})))),e.a.createElement(xe.b,{large:!0}),e.a.createElement(J.a,{style:{marginLeft:15},pageKey:"feature-flag-".concat(s.id,"-").concat(d,"-").concat(s.filters.groups.length,"-").concat((V=s.filters.aggregation_group_type_index)!==null&&V!==void 0?V:""),propertyFilters:f==null?void 0:f.properties,onChange:function(le){return Pe(d,void 0,le)},taxonomicGroupTypes:lt,showConditionBadge:!0}),e.a.createElement(xe.b,{large:!0}),e.a.createElement("div",{className:"feature-flag-form-row"},e.a.createElement("div",{className:"centered"},"Roll out to"," ",e.a.createElement(Z.a,{style:{width:100,marginLeft:8,marginRight:8},onChange:function(le){Pe(d,le)},value:f.rollout_percentage!=null?f.rollout_percentage:100,min:0,max:100,addonAfter:"%"})," ","of ",e.a.createElement("b",null,X)," in this set"))))})),e.a.createElement(K.a,{size:"small",style:{marginBottom:16}},e.a.createElement(j.a,{type:"link",onClick:it,style:{marginLeft:5}},e.a.createElement(Ee.a,{style:{marginRight:15}})," Add condition set")),e.a.createElement("div",{className:"text-right"},e.a.createElement(j.a,{icon:e.a.createElement(ve.a,null),htmlType:"submit",type:"primary","data-attr":"feature-flag-submit-bottom"},"Save changes"))):e.a.createElement(_.c,null))}try{z.displayName="FeatureFlag",z.__docgenInfo={description:"",displayName:"FeatureFlag",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"]={docgenInfo:z.__docgenInfo,name:"FeatureFlag",path:"frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"})}catch(n){}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss":function(U,h,a){var I=a("./node_modules/css-loader/dist/runtime/api.js");h=I(!1),h.push([U.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.feature-flag .LemonSwitch{margin-right:1rem!important}.variant-form-list .ant-form-item{min-height:32px}.variant-form-list .label-row{margin-bottom:4px;font-weight:700}.variant-form-list .label-row .ant-col{min-height:32px;display:flex;justify-content:space-between;align-items:center}.feature-flag-form-row{display:flex;justify-content:space-between;align-items:center;width:100%}.feature-flag-form-row .centered{display:flex;align-items:center;white-space:pre-wrap}",""]),U.exports=h}}]);
