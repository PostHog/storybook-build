(window.webpackJsonp=window.webpackJsonp||[]).push([[235],{4415:function(module,exports,__webpack_require__){(exports=__webpack_require__(49)(!1)).push([module.i,".select-box{position:absolute;width:620px;box-shadow:0 3px 6px -4px rgba(0,0,0,.12),0 6px 16px 0 rgba(0,0,0,.08),0 9px 28px 8px rgba(0,0,0,.05);border-radius:2px;height:400px;background:#fff;z-index:999;overflow:visible;outline:none}.select-box .ant-input{border-width:0 0 1px;outline:none}.select-box .ant-divider{margin:12px 0;border-width:2px}.select-box .ant-list-item{padding:4px 12px;cursor:pointer;border:none}.select-box .ant-list-item.selected,.select-box .ant-list-item:hover{background:rgba(0,0,0,.1)}.select-box .search-list{overflow-y:scroll;height:calc(100% - 32px);padding-top:4px;-ms-overflow-style:none;scrollbar-width:none}.select-box .search-list ::-webkit-scrollbar{display:none}.select-box .info-box{padding:1rem;overflow-y:scroll;height:100%}.select-box .info-box pre{margin:0}",""]),module.exports=exports},4441:function(module,exports,__webpack_require__){(exports=__webpack_require__(49)(!1)).push([module.i,'.mixin-gradient-overlay{width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent)}.mixin-gradient-overlay,.mixin-gradient-overlay-right{content:"";position:absolute;pointer-events:none;bottom:0}.mixin-gradient-overlay-right{width:3rem;height:100%;background:linear-gradient(270deg,#fff,transparent)}.text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.cohorts-drawer .ant-drawer-content-wrapper{max-width:850px!important;width:100%!important}.cohort-recalculating{background-color:#f2f2f2;padding:.5rem 1rem;margin-top:1rem;border-radius:4px}.cohort-recalculating .ant-spin-spinning{margin-right:.375rem}.cohort-csv-dragger .ant-upload-drag-container{display:flex!important;text-align:left}.cohort-csv-dragger .ant-upload-drag-container .ant-upload-drag-icon{margin:0!important;padding-left:1rem;padding-right:1rem}.cohort-csv-dragger .ant-upload-drag-container .ant-upload-text{font-size:1rem!important;margin:0!important}',""]),module.exports=exports},4700:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Cohorts",(function(){return Cohorts_Cohorts})),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene}));__webpack_require__(247),__webpack_require__(265),__webpack_require__(43),__webpack_require__(34),__webpack_require__(63),__webpack_require__(248),__webpack_require__(40),__webpack_require__(82),__webpack_require__(125),__webpack_require__(291),__webpack_require__(50);var slicedToArray=__webpack_require__(13),slicedToArray_default=__webpack_require__.n(slicedToArray),regenerator=__webpack_require__(5),regenerator_default=__webpack_require__.n(regenerator),asyncToGenerator=(__webpack_require__(69),__webpack_require__(11)),asyncToGenerator_default=__webpack_require__.n(asyncToGenerator),react=__webpack_require__(0),react_default=__webpack_require__.n(react),utils=__webpack_require__(10),es_input=__webpack_require__(551),es_button=__webpack_require__(130),InfoCircleOutlined=__webpack_require__(723),cohortsModel=__webpack_require__(218),index_esm=__webpack_require__(1),PageHeader=__webpack_require__(338),PlusOutlined=__webpack_require__(1841),helpers_extends=__webpack_require__(16),extends_default=__webpack_require__.n(helpers_extends),defineProperty=__webpack_require__(7),defineProperty_default=__webpack_require__.n(defineProperty);function CohortNameInput(_ref){var input=_ref.input,_onChange=_ref.onChange;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("label",{className:"ant-form-item-label",htmlFor:"cohort-name"},"Name"),react_default.a.createElement(es_input.a,{required:!0,autoFocus:!0,placeholder:"Name your cohort",value:input||"","data-attr":"cohort-name",onChange:function onChange(e){return _onChange(e.target.value)},id:"cohort-name",className:"ph-ignore-input"}))}try{CohortNameInput.displayName="CohortNameInput",CohortNameInput.__docgenInfo={description:"",displayName:"CohortNameInput",props:{input:{defaultValue:null,description:"",name:"input",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(input: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/cohorts/CohortNameInput.tsx#CohortNameInput"]={docgenInfo:CohortNameInput.__docgenInfo,name:"CohortNameInput",path:"frontend/src/scenes/cohorts/CohortNameInput.tsx#CohortNameInput"})}catch(__react_docgen_typescript_loader_error){}function CohortDescriptionInput(_ref){var description=_ref.description,_onChange=_ref.onChange;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("label",{className:"ant-form-item-label",htmlFor:"cohort-description"},"Description"),react_default.a.createElement(es_input.a.TextArea,{placeholder:"Add a useful description for other team members",value:description||"","data-attr":"cohort-description",id:"cohort-description",onChange:function onChange(e){return _onChange(e.target.value)},maxLength:1e3}))}try{CohortDescriptionInput.displayName="CohortDescriptionInput",CohortDescriptionInput.__docgenInfo={description:"",displayName:"CohortDescriptionInput",props:{description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(input: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/cohorts/CohortDescriptionInput.tsx#CohortDescriptionInput"]={docgenInfo:CohortDescriptionInput.__docgenInfo,name:"CohortDescriptionInput",path:"frontend/src/scenes/cohorts/CohortDescriptionInput.tsx#CohortDescriptionInput"})}catch(__react_docgen_typescript_loader_error){}var row=__webpack_require__(337),col=__webpack_require__(246),tooltip=__webpack_require__(284),divider=__webpack_require__(4199),toConsumableArray=(__webpack_require__(41),__webpack_require__(552),__webpack_require__(14)),toConsumableArray_default=__webpack_require__.n(toConsumableArray),es_select=(__webpack_require__(113),__webpack_require__(220)),AimOutlined=__webpack_require__(4266),ContainerOutlined=__webpack_require__(4265),objectWithoutProperties=(__webpack_require__(62),__webpack_require__(4366),__webpack_require__(182),__webpack_require__(92),__webpack_require__(4367),__webpack_require__(631),__webpack_require__(292),__webpack_require__(117),__webpack_require__(183),__webpack_require__(39)),objectWithoutProperties_default=__webpack_require__.n(objectWithoutProperties),list=__webpack_require__(4247),RightOutlined=__webpack_require__(482),DownOutlined=__webpack_require__(619),fuse_esm=(__webpack_require__(1226),__webpack_require__(199),__webpack_require__(172),__webpack_require__(109),__webpack_require__(307)),eventUsageLogic=__webpack_require__(30);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var scrollUpIntoView=function scrollUpIntoView(key){var searchList=document.querySelector(".search-list"),item=document.querySelector('.search-list [datakey="'+key+'"]');if(item&&searchList){var diff=item.getBoundingClientRect().top-searchList.getBoundingClientRect().top;diff-30<0&&(searchList.scrollTop=searchList.scrollTop+diff-30)}},scrollDownIntoView=function scrollDownIntoView(key){var searchList=document.querySelector(".search-list"),item=document.querySelector('.search-list [datakey="'+key+'"]');if(item&&searchList){var diff=item.getBoundingClientRect().top-searchList.getBoundingClientRect().bottom;diff+30>0&&(searchList.scrollTop=searchList.scrollTop+diff+30)}},selectBoxLogic_searchItems=function searchItems(sources,search){return new fuse_esm.a(sources,{keys:["name"],threshold:.3}).search(search).map((function(result){return result.item}))},selectBoxLogic=Object(index_esm.kea)({path:["lib","logic","selectBoxLogic"],props:{},actions:{setSelectedItem:function setSelectedItem(item){return{item:item}},setSearch:function setSearch(search){return{search:search}},clickSelectedItem:function clickSelectedItem(item,group){return{item:item,group:group}},setBlockMouseOver:function setBlockMouseOver(block){return{block:block}},onKeyDown:function onKeyDown(e){return{e:e}}},reducers:{selectedItem:[null,{setSelectedItem:function setSelectedItem(_,_ref){return _ref.item}}],blockMouseOver:[!1,{setBlockMouseOver:function setBlockMouseOver(_,_ref2){return _ref2.block}}],search:["",{setSearch:function setSearch(_,_ref3){return _ref3.search}}]},selectors:function selectors(_ref4){var _selectors=_ref4.selectors,props=_ref4.props;return{selectedGroup:[function(){return[_selectors.selectedItem]},function(item){return item&&props.items.filter((function(boxItem){return boxItem.dataSource.filter((function(i){return i.key===item.key})).length>0}))[0]||null}],data:[function(s){return[s.search]},function(search){if(!search)return props.items;var _step,newItems=[],_iterator=_createForOfIteratorHelper(props.items);try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value;newItems.push(_objectSpread(_objectSpread({},item),{},{dataSource:selectBoxLogic_searchItems(item.dataSource,search),metadata:{search:search}}))}}catch(err){_iterator.e(err)}finally{_iterator.f()}return newItems}]}},listeners:function listeners(_ref5){var _setSearch,_onKeyDown,props=_ref5.props,values=_ref5.values,actions=_ref5.actions;return{clickSelectedItem:function clickSelectedItem(_ref6){var item=_ref6.item,group=_ref6.group;item.onSelect&&(item.onSelect({item:item,group:group}),item.onSelectPreventDefault)||props.updateFilter(group.type,group.getValue(item),group.getLabel(item))},setBlockMouseOver:function setBlockMouseOver(_ref7){_ref7.block&&setTimeout((function(){return actions.setBlockMouseOver(!1)}),200)},onKeyDown:(_onKeyDown=asyncToGenerator_default()(regenerator_default.a.mark((function _callee(_ref8,breakpoint){var e,allSources,currentIndex,item,_item;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return e=_ref8.e,_context.next=3,breakpoint(100);case 3:if(allSources=props.items.map((function(item){return item.dataSource})).flat(),allSources=values.search?selectBoxLogic_searchItems(allSources,values.search):allSources,currentIndex=allSources.findIndex((function(item){var _values$selectedItem;return item.key===(null===(_values$selectedItem=values.selectedItem)||void 0===_values$selectedItem?void 0:_values$selectedItem.key)}))||0,"ArrowDown"!==e.key){_context.next=11;break}(item=allSources[currentIndex+1])&&(actions.setSelectedItem(item),scrollDownIntoView(item.key),actions.setBlockMouseOver(!0)),_context.next=21;break;case 11:if("ArrowUp"!==e.key){_context.next=16;break}(_item=allSources[currentIndex-1])&&(actions.setSelectedItem(_item),scrollUpIntoView(_item.key),actions.setBlockMouseOver(!0)),_context.next=21;break;case 16:if("Enter"!==e.key||!values.selectedItem||!values.selectedGroup){_context.next=20;break}actions.clickSelectedItem(values.selectedItem,values.selectedGroup),_context.next=21;break;case 20:return _context.abrupt("return");case 21:e.stopPropagation(),e.preventDefault();case 23:case"end":return _context.stop()}}),_callee)}))),function onKeyDown(_x,_x2){return _onKeyDown.apply(this,arguments)}),setSearch:(_setSearch=asyncToGenerator_default()(regenerator_default.a.mark((function _callee2(_ref9,breakpoint){var _values$data$0$metada,search,extraProps,_iterator2,_step2,item;return regenerator_default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return search=_ref9.search,_context2.next=3,breakpoint(700);case 3:if((null===(_values$data$0$metada=values.data[0].metadata)||void 0===_values$data$0$metada?void 0:_values$data$0$metada.search)===search){extraProps={},_iterator2=_createForOfIteratorHelper(values.data);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;)item=_step2.value,extraProps["count_".concat(item.key)]=item.dataSource.length,"events"===item.key&&(extraProps.count_posthog_events=item.dataSource.filter((function(_ref10){return"$"===_ref10.name[0]})).length)}catch(err){_iterator2.e(err)}finally{_iterator2.f()}eventUsageLogic.e.actions.reportEventSearched(search,extraProps)}case 4:case"end":return _context2.stop()}}),_callee2)}))),function setSearch(_x3,_x4){return _setSearch.apply(this,arguments)})}}}),injectStylesIntoStyleTag=__webpack_require__(17),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),SelectBox=__webpack_require__(4415),SelectBox_default=__webpack_require__.n(SelectBox),options={insert:"head",singleton:!1},PropertyKeyInfo=(injectStylesIntoStyleTag_default()(SelectBox_default.a,options),SelectBox_default.a.locals,__webpack_require__(58)),AutoSizer=__webpack_require__(610),List=__webpack_require__(611),List_default=__webpack_require__.n(List);function SelectBox_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function SelectBox_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?SelectBox_ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):SelectBox_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function SelectBox_SelectBox(_ref){var items=_ref.items,selectedItemKey=_ref.selectedItemKey,onSelect=_ref.onSelect,onDismiss=_ref.onDismiss,inputPlaceholder=_ref.inputPlaceholder,_ref$disablePopover=_ref.disablePopover,disablePopover=void 0!==_ref$disablePopover&&_ref$disablePopover,dropdownRef=Object(react.useRef)(null),dropdownLogic=selectBoxLogic({updateFilter:onSelect,items:items}),_useValues=Object(index_esm.useValues)(dropdownLogic),selectedItem=_useValues.selectedItem,selectedGroup=_useValues.selectedGroup,data=_useValues.data,_useActions=Object(index_esm.useActions)(dropdownLogic),setSearch=_useActions.setSearch,setSelectedItem=_useActions.setSelectedItem,onKeyDown=_useActions.onKeyDown,deselect=function deselect(e){var _dropdownRef$current;e.target&&(null==dropdownRef||null===(_dropdownRef$current=dropdownRef.current)||void 0===_dropdownRef$current?void 0:_dropdownRef$current.contains(e.target))||onDismiss(e)};return Object(react.useEffect)((function(){if(selectedItemKey){var _document$querySelect,allSources=data.map((function(item){return item.dataSource})).flat();setSelectedItem(allSources.filter((function(item){return item.key===selectedItemKey}))[0]||null);var offset=null===(_document$querySelect=document.querySelector('.search-list [datakey="'+selectedItemKey+'"]'))||void 0===_document$querySelect?void 0:_document$querySelect.offsetTop,searchListSelector=document.querySelector(".search-list");offset&&searchListSelector&&(searchListSelector.scrollTop=offset)}return document.addEventListener("mousedown",deselect),document.addEventListener("keydown",onKeyDown),function(){document.removeEventListener("mousedown",deselect),document.removeEventListener("keydown",onKeyDown)}}),[]),react_default.a.createElement("div",{ref:dropdownRef,className:"select-box",tabIndex:-1},react_default.a.createElement(row.a,{style:{height:"100%"}},react_default.a.createElement(col.a,{sm:14,style:{borderRight:"1px solid rgba(0, 0, 0, 0.1)",maxHeight:"100%"}},react_default.a.createElement(es_input.a,{placeholder:inputPlaceholder||"Search events",autoFocus:!0,onChange:function onChange(e){return setSearch(e.target.value)},onKeyDown:function onKeyDown(e){"Tab"===e.key&&onDismiss()},style:{width:"100%",borderRadius:0,height:"10%"},"data-attr":"select-box-input"}),react_default.a.createElement("div",{style:{width:"100%",height:"90%"},tabIndex:-1},react_default.a.createElement(SelectUnit,{items:Object.assign.apply(Object,[{}].concat(toConsumableArray_default()(data.map((function(item){return defineProperty_default()({},item.name,item)}))))),dropdownLogic:dropdownLogic,disablePopover:disablePopover}))),react_default.a.createElement(col.a,{sm:10,className:"info-box"},selectedGroup&&selectedItem?selectedGroup.renderInfo({item:selectedItem}):null)))}function SelectUnit(_ref3){var dropdownLogic=_ref3.dropdownLogic,items=_ref3.items,_ref3$disablePopover=_ref3.disablePopover,disablePopover=void 0!==_ref3$disablePopover&&_ref3$disablePopover,_useActions2=Object(index_esm.useActions)(dropdownLogic),setSelectedItem=_useActions2.setSelectedItem,clickSelectedItem=_useActions2.clickSelectedItem,_useValues2=Object(index_esm.useValues)(dropdownLogic),selectedItem=_useValues2.selectedItem,search=_useValues2.search,blockMouseOver=_useValues2.blockMouseOver,_useState=Object(react.useState)({}),_useState2=slicedToArray_default()(_useState,2),hiddenData=_useState2[0],setHiddenData=_useState2[1],_useState3=Object(react.useState)({}),_useState4=slicedToArray_default()(_useState3,2),data=_useState4[0],setData=_useState4[1],_useState5=Object(react.useState)([]),_useState6=slicedToArray_default()(_useState5,2),flattenedData=_useState6[0],setFlattenedData=_useState6[1],_useState7=Object(react.useState)([]),_useState8=slicedToArray_default()(_useState7,2),groupTypes=_useState8[0],setGroupTypes=_useState8[1],lengthOfData=0;Object.values(items).forEach((function(entry){var _entry$dataSource;lengthOfData+=(null==entry||null===(_entry$dataSource=entry.dataSource)||void 0===_entry$dataSource?void 0:_entry$dataSource.length)||0})),Object(react.useEffect)((function(){var formattedData={},_hiddenData={},_groupTypes=[],currHidden=Object.keys(hiddenData);Object.keys(items).forEach((function(groupName){currHidden.includes(groupName)?(formattedData[groupName]=[],_hiddenData[groupName]=items[groupName].dataSource):formattedData[groupName]=items[groupName].dataSource,_groupTypes.push(groupName)})),setGroupTypes(_groupTypes),setData(formattedData),setHiddenData(_hiddenData)}),[lengthOfData]),Object(react.useEffect)((function(){var _flattenedData=[];Object.keys(data).forEach((function(key){_flattenedData.push({key:key,name:key,groupName:key}),_flattenedData.push.apply(_flattenedData,toConsumableArray_default()(data[key].map((function(selectItem){return SelectBox_objectSpread(SelectBox_objectSpread({},selectItem),{},{groupName:key})}))))})),setFlattenedData(_flattenedData)}),[data]);var renderItem=function renderItem(_ref4){var index=_ref4.index,style=_ref4.style,item=flattenedData[index];if(!item.groupName)return null;var _data$item$key,_hiddenData$item$key,group=items[item.groupName];return groupTypes.includes(item.key)?react_default.a.createElement("div",{style:style,key:item.key},react_default.a.createElement("span",{onClick:function onClick(){return(null==hiddenData?void 0:hiddenData[item.key])?function showKey(key){var showItem=hiddenData["".concat(key)],restOfData=objectWithoutProperties_default()(hiddenData,["".concat(key)]);setHiddenData(restOfData);var copy=SelectBox_objectSpread({},data);copy[key]=showItem,setData(copy)}(item.key):function hideKey(key){var hideItem=data["".concat(key)],copy=SelectBox_objectSpread({},data);copy[key]=[],setData(copy),setHiddenData(SelectBox_objectSpread(SelectBox_objectSpread({},hiddenData),{},defineProperty_default()({},"".concat(key),hideItem)))}(item.key)}},react_default.a.createElement("h4",{style:{cursor:"pointer",userSelect:"none",padding:"4px 12px",marginBottom:0}},(null==hiddenData?void 0:hiddenData[item.key])||!data[item.key].length?react_default.a.createElement(RightOutlined.a,null):react_default.a.createElement(DownOutlined.a,null)," ",group.header(item.key),react_default.a.createElement("span",{style:{float:"right",fontWeight:search&&flattenedData.length>0?700:"normal"},className:"text-small"},(null==data||null===(_data$item$key=data[item.key])||void 0===_data$item$key?void 0:_data$item$key.length)||(null==hiddenData||null===(_hiddenData$item$key=hiddenData[item.key])||void 0===_hiddenData$item$key?void 0:_hiddenData$item$key.length)||"0"," ",1===flattenedData.length?"entry":"entries")))):react_default.a.createElement(list.b.Item,{className:(null==selectedItem?void 0:selectedItem.key)===item.key?"selected":void 0,key:item.key,onClick:function onClick(){return clickSelectedItem(item,group)},style:style,onMouseOver:function onMouseOver(){return!blockMouseOver&&setSelectedItem(SelectBox_objectSpread(SelectBox_objectSpread({},item),{},{key:item.key,category:group.type}))},"data-attr":"select-item-".concat(index)},react_default.a.createElement(PropertyKeyInfo.b,{value:item.name,disablePopover:disablePopover}))};return react_default.a.createElement(react_default.a.Fragment,null,flattenedData.length>0&&react_default.a.createElement("div",{style:{height:"100%"}},react_default.a.createElement(AutoSizer.AutoSizer,null,(function(_ref5){var height=_ref5.height,width=_ref5.width;return react_default.a.createElement(List_default.a,{height:height,overscanRowCount:0,rowCount:flattenedData.length,rowHeight:35,rowRenderer:renderItem,width:width,tabIndex:-1})}))))}try{SelectBox_SelectBox.displayName="SelectBox",SelectBox_SelectBox.__docgenInfo={description:"",displayName:"SelectBox",props:{items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"SelectBoxItem[]"}},selectedItemKey:{defaultValue:null,description:"",name:"selectedItemKey",required:!1,type:{name:"string"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(type: any, id: string | number, name: string) => void"}},onDismiss:{defaultValue:null,description:"",name:"onDismiss",required:!0,type:{name:"(event?: MouseEvent | undefined) => void"}},inputPlaceholder:{defaultValue:null,description:"",name:"inputPlaceholder",required:!1,type:{name:"string"}},disablePopover:{defaultValue:{value:"false"},description:"",name:"disablePopover",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/SelectBox.tsx#SelectBox"]={docgenInfo:SelectBox_SelectBox.__docgenInfo,name:"SelectBox",path:"frontend/src/lib/components/SelectBox.tsx#SelectBox"})}catch(__react_docgen_typescript_loader_error){}try{SelectUnit.displayName="SelectUnit",SelectUnit.__docgenInfo={description:"",displayName:"SelectUnit",props:{dropdownLogic:{defaultValue:null,description:"",name:"dropdownLogic",required:!0,type:{name:"any"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"Record<string, SelectBoxItem>"}},disablePopover:{defaultValue:{value:"false"},description:"",name:"disablePopover",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/SelectBox.tsx#SelectUnit"]={docgenInfo:SelectUnit.__docgenInfo,name:"SelectUnit",path:"frontend/src/lib/components/SelectBox.tsx#SelectUnit"})}catch(__react_docgen_typescript_loader_error){}var actionsModel=__webpack_require__(524),types=__webpack_require__(4),ActionSelectInfo=__webpack_require__(2549),Link=__webpack_require__(60),urls=__webpack_require__(18);function ActionInfo(_ref){var item=_ref.item;return item.renderInfo?item.renderInfo({item:item}):react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(AimOutlined.a,null)," Actions",item.id&&react_default.a.createElement(Link.a,{to:urls.a.action(item.id),style:{float:"right"},tabIndex:-1},"edit"),react_default.a.createElement("br",null),react_default.a.createElement("h3",null,react_default.a.createElement(PropertyKeyInfo.b,{value:item.name})),item.action&&react_default.a.createElement(ActionSelectInfo.a,{entity:item.action}))}try{ActionInfo.displayName="ActionInfo",ActionInfo.__docgenInfo={description:"",displayName:"ActionInfo",props:{item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"SelectedItem"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/ActionFilter/ActionFilterRow/ActionFilterDropdown.tsx#ActionInfo"]={docgenInfo:ActionInfo.__docgenInfo,name:"ActionInfo",path:"frontend/src/scenes/insights/ActionFilter/ActionFilterRow/ActionFilterDropdown.tsx#ActionInfo"})}catch(__react_docgen_typescript_loader_error){}var eventDefinitionsModel=__webpack_require__(426);function CohortEntityFilterBox_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function CohortEntityFilterBox(_ref){var _ref$open=_ref.open,open=void 0!==_ref$open&&_ref$open,onSelect=_ref.onSelect,eventDefinitions=Object(index_esm.useValues)(eventDefinitionsModel.a).eventDefinitions,actions=Object(index_esm.useValues)(actionsModel.a).actions;if(!open)return null;var groups=[{key:"actions",name:"Actions",header:function actionHeader(label){return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(AimOutlined.a,null)," ",label)},dataSource:actions.map((function(action){return{key:types.f.ACTIONS+action.id,name:action.name,volume:action.count,id:action.id,action:action}})),renderInfo:ActionInfo,type:"action_type",getValue:function getValue(item){var _item$action;return(null===(_item$action=item.action)||void 0===_item$action?void 0:_item$action.id)||""},getLabel:function getLabel(item){var _item$action2;return(null===(_item$action2=item.action)||void 0===_item$action2?void 0:_item$action2.name)||""}},{key:"events",name:"Events",header:function eventHeader(label){return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(ContainerOutlined.a,null)," ",label)},dataSource:eventDefinitions.map((function(definition){return function CohortEntityFilterBox_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?CohortEntityFilterBox_ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):CohortEntityFilterBox_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({key:types.f.EVENTS+definition.name},definition)}))||[],renderInfo:function events(_ref2){var item=_ref2.item;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(ContainerOutlined.a,null)," Events",react_default.a.createElement("br",null),react_default.a.createElement("h3",null,item.name),(null==item?void 0:item.volume_30_day)&&react_default.a.createElement(react_default.a.Fragment,null,"Seen ",react_default.a.createElement("strong",null,item.volume_30_day)," times."," "),(null==item?void 0:item.query_usage_30_day)&&react_default.a.createElement(react_default.a.Fragment,null,"Used in ",react_default.a.createElement("strong",null,item.query_usage_30_day)," queries."))},type:"event_type",getValue:function getValue(item){return item.name},getLabel:function getLabel(item){return item.name}}];return react_default.a.createElement(SelectBox_SelectBox,{selectedItemKey:void 0,onDismiss:function onDismiss(){},onSelect:onSelect,items:groups})}try{CohortEntityFilterBox.displayName="CohortEntityFilterBox",CohortEntityFilterBox.__docgenInfo={description:"",displayName:"CohortEntityFilterBox",props:{open:{defaultValue:{value:"false"},description:"",name:"open",required:!1,type:{name:"boolean"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(type: any, id: string | number, name: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/cohorts/CohortMatchingCriteriaSection/CohortEntityFilterBox.tsx#CohortEntityFilterBox"]={docgenInfo:CohortEntityFilterBox.__docgenInfo,name:"CohortEntityFilterBox",path:"frontend/src/scenes/cohorts/CohortMatchingCriteriaSection/CohortEntityFilterBox.tsx#CohortEntityFilterBox"})}catch(__react_docgen_typescript_loader_error){}var SelectDownIcon=__webpack_require__(2486),constants=__webpack_require__(21),PropertyFilters=__webpack_require__(427),DeleteOutlined=__webpack_require__(4222),TaxonomicFilter_types=__webpack_require__(35),PreflightCheck_logic=__webpack_require__(55);function MatchCriteriaSelector_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}var Option=es_select.a.Option;function MatchCriteriaSelector(_ref){var _group$properties,onCriteriaChange=_ref.onCriteriaChange,group=_ref.group,onRemove=_ref.onRemove,errored=_ref.showErrors&&(group.matchType===constants.k&&!(null===(_group$properties=group.properties)||void 0===_group$properties?void 0:_group$properties.length)||group.matchType===constants.u&&!(group.action_id||group.event_id));return react_default.a.createElement("div",{style:{padding:15,border:errored?"1px solid var(--danger)":"1px solid rgba(0, 0, 0, 0.1)",borderRadius:4,width:"100%"}},react_default.a.createElement(row.a,{align:"middle",justify:"space-between"},react_default.a.createElement("div",null,"Match users who",react_default.a.createElement(es_select.a,{defaultValue:constants.u,value:group.matchType,style:{width:240,marginLeft:10},onChange:function onMatchTypeChange(input){onCriteriaChange(function MatchCriteriaSelector_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?MatchCriteriaSelector_ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):MatchCriteriaSelector_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({matchType:input},input===constants.k?{count_operator:"gte",days:"1"}:{}))}},react_default.a.createElement(Option,{value:constants.u},"have properties"),react_default.a.createElement(Option,{value:constants.k},"performed action or event"))),react_default.a.createElement(DeleteOutlined.a,{onClick:function onClick(){return onRemove()},style:{cursor:"pointer"}})),react_default.a.createElement(row.a,null,errored&&react_default.a.createElement("div",{style:{color:"var(--danger)",marginTop:16}},group.matchType===constants.k?"Please select an event or action.":"Please select at least one property or remove this match group.")),react_default.a.createElement(row.a,{align:"middle"},group.matchType===constants.k?react_default.a.createElement(EntityCriteriaRow,{group:group,onEntityCriteriaChange:onCriteriaChange}):react_default.a.createElement(PropertyCriteriaRow,{onPropertyCriteriaChange:onCriteriaChange,group:group})))}function PropertyCriteriaRow(_ref2){var group=_ref2.group,onPropertyCriteriaChange=_ref2.onPropertyCriteriaChange;return react_default.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%"}},react_default.a.createElement("div",{style:{flex:3,marginRight:5}},react_default.a.createElement(PropertyFilters.b,{endpoint:"person",pageKey:group.id,onChange:function onChange(properties){onPropertyCriteriaChange({properties:properties})},propertyFilters:group.properties,style:{margin:"1rem 0 0"},taxonomicGroupTypes:[TaxonomicFilter_types.a.PersonProperties,TaxonomicFilter_types.a.CohortsWithAllUsers],popoverPlacement:"top",taxonomicPopoverPlacement:"auto"})))}function EntityCriteriaRow(_ref3){var onEntityCriteriaChange=_ref3.onEntityCriteriaChange,group=_ref3.group,_useState=Object(react.useState)(!1),_useState2=slicedToArray_default()(_useState,2),open=_useState2[0],setOpen=_useState2[1],label=group.label,days=group.days,count_operator=group.count_operator,count=group.count,preflight=Object(index_esm.useValues)(PreflightCheck_logic.a).preflight,COUNT_ENABLED=null==preflight?void 0:preflight.is_clickhouse_enabled;return react_default.a.createElement("div",{style:{marginTop:16,width:"100%"}},react_default.a.createElement(row.a,{gutter:8},react_default.a.createElement(col.a,{flex:"auto"},react_default.a.createElement(es_button.a,{onClick:function onClick(){return setOpen(!open)},className:"full-width",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},"data-attr":"edit-cohort-entity-filter"},react_default.a.createElement(PropertyKeyInfo.b,{value:label||"Select an event"}),react_default.a.createElement(SelectDownIcon.a,{className:"text-muted"})),react_default.a.createElement(CohortEntityFilterBox,{open:open,onSelect:function onEntityChange(type,id,newLabel){type===constants.n&&"string"==typeof id?onEntityCriteriaChange({event_id:id,label:newLabel}):type===constants.g&&"number"==typeof id&&onEntityCriteriaChange({action_id:id,label:newLabel}),setOpen(!1)}})),COUNT_ENABLED&&react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(col.a,{span:4},react_default.a.createElement(OperatorSelect,{value:count_operator,onChange:function onOperatorChange(newCountOperator){onEntityCriteriaChange({count_operator:newCountOperator})}})),react_default.a.createElement(col.a,{span:3},react_default.a.createElement(es_input.a,{required:!0,value:count,"data-attr":"entity-count",onChange:function onChange(e){return function onEntityCountChange(newCount){onEntityCriteriaChange({count:newCount})}(parseInt(e.target.value))},placeholder:"1",type:"number"}))),react_default.a.createElement(col.a,{style:{display:"flex",alignItems:"center"}},COUNT_ENABLED&&"times ","in the last"),react_default.a.createElement(col.a,{span:4},react_default.a.createElement(DateIntervalSelect,{value:days,onChange:function onDateIntervalChange(dateInterval){onEntityCriteriaChange({days:dateInterval})}}))))}function OperatorSelect(_ref4){var onChange=_ref4.onChange,value=_ref4.value;return react_default.a.createElement(es_select.a,{value:value||"gte",style:{width:"100%"},onChange:onChange},react_default.a.createElement(Option,{value:"gte"},"at least"),react_default.a.createElement(Option,{value:"eq"},"exactly"),react_default.a.createElement(Option,{value:"lte"},"at most"))}function DateIntervalSelect(_ref5){var onChange=_ref5.onChange,value=_ref5.value,PRESET_OPTIONS={1:"day",7:"week",14:"2 weeks",30:"month"},valueOrDefault=null!=value?value:"1";return react_default.a.createElement(es_select.a,{value:valueOrDefault,style:{width:"100%"},onChange:onChange},Object.keys(PRESET_OPTIONS).map((function(key){return react_default.a.createElement(Option,{value:key,key:key},PRESET_OPTIONS[key])})))}try{MatchCriteriaSelector.displayName="MatchCriteriaSelector",MatchCriteriaSelector.__docgenInfo={description:"",displayName:"MatchCriteriaSelector",props:{onCriteriaChange:{defaultValue:null,description:"",name:"onCriteriaChange",required:!0,type:{name:"(group: Partial<CohortGroupType>) => void"}},group:{defaultValue:null,description:"",name:"group",required:!0,type:{name:"CohortGroupType"}},onRemove:{defaultValue:null,description:"",name:"onRemove",required:!0,type:{name:"() => void"}},showErrors:{defaultValue:null,description:"",name:"showErrors",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/cohorts/CohortMatchingCriteriaSection/MatchCriteriaSelector.tsx#MatchCriteriaSelector"]={docgenInfo:MatchCriteriaSelector.__docgenInfo,name:"MatchCriteriaSelector",path:"frontend/src/scenes/cohorts/CohortMatchingCriteriaSection/MatchCriteriaSelector.tsx#MatchCriteriaSelector"})}catch(__react_docgen_typescript_loader_error){}function CohortMatchingCriteriaSection_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function CohortMatchingCriteriaSection_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?CohortMatchingCriteriaSection_ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):CohortMatchingCriteriaSection_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function CohortMatchingCriteriaSection_CohortMatchingCriteriaSection(_ref){var logic=_ref.logic,_useActions=Object(index_esm.useActions)(logic),setCohort=_useActions.setCohort,_onCriteriaChange=_useActions.onCriteriaChange,_useValues=Object(index_esm.useValues)(logic),cohort=_useValues.cohort,submitted=_useValues.submitted,addButton=react_default.a.createElement("div",{style:{marginTop:8,marginBottom:8}},react_default.a.createElement("a",{href:"#add",style:{padding:0},onClick:function onClick(){return function onAddGroup(){cohort.groups=[].concat(toConsumableArray_default()(cohort.groups),[{id:Math.random().toString().substr(2,5),matchType:constants.u,properties:[]}]),setCohort(CohortMatchingCriteriaSection_objectSpread({},cohort))}()},"data-attr":"add-match-criteria"},react_default.a.createElement(PlusOutlined.a,null)," Add matching criteria"));return react_default.a.createElement(col.a,null,react_default.a.createElement("h3",{className:"l3"},"Matching Criteria"),react_default.a.createElement("div",{className:"mb"},"Users who match the following criteria will be part of the cohort. Continuously updated automatically."),react_default.a.createElement("div",null,cohort.groups.map((function(group,index){return react_default.a.createElement(react_default.a.Fragment,{key:index},react_default.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"}},react_default.a.createElement(MatchCriteriaSelector,{onCriteriaChange:function onCriteriaChange(newGroup){return _onCriteriaChange(newGroup,group.id)},onRemove:function onRemove(){return function onRemoveGroup(index){cohort.groups.splice(index,1),setCohort(CohortMatchingCriteriaSection_objectSpread({},cohort))}(index)},group:group,showErrors:submitted}),index<cohort.groups.length-1&&react_default.a.createElement("div",{className:"stateful-badge or mt mb"},"OR")))}))),react_default.a.createElement("span",{id:"add"}),addButton)}try{CohortMatchingCriteriaSection_CohortMatchingCriteriaSection.displayName="CohortMatchingCriteriaSection",CohortMatchingCriteriaSection_CohortMatchingCriteriaSection.__docgenInfo={description:"",displayName:"CohortMatchingCriteriaSection",props:{logic:{defaultValue:null,description:"",name:"logic",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/cohorts/CohortMatchingCriteriaSection/CohortMatchingCriteriaSection.tsx#CohortMatchingCriteriaSection"]={docgenInfo:CohortMatchingCriteriaSection_CohortMatchingCriteriaSection.__docgenInfo,name:"CohortMatchingCriteriaSection",path:"frontend/src/scenes/cohorts/CohortMatchingCriteriaSection/CohortMatchingCriteriaSection.tsx#CohortMatchingCriteriaSection"})}catch(__react_docgen_typescript_loader_error){}try{CohortMatchingCriteriaSection.displayName="CohortMatchingCriteriaSection",CohortMatchingCriteriaSection.__docgenInfo={description:"",displayName:"CohortMatchingCriteriaSection",props:{logic:{defaultValue:null,description:"",name:"logic",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/cohorts/CohortMatchingCriteriaSection/index.tsx#CohortMatchingCriteriaSection"]={docgenInfo:CohortMatchingCriteriaSection.__docgenInfo,name:"CohortMatchingCriteriaSection",path:"frontend/src/scenes/cohorts/CohortMatchingCriteriaSection/index.tsx#CohortMatchingCriteriaSection"})}catch(__react_docgen_typescript_loader_error){}var OrderedListOutlined=__webpack_require__(4309),CalculatorOutlined=__webpack_require__(4276),InboxOutlined=__webpack_require__(4719),SaveOutlined=__webpack_require__(4305),Dragger=__webpack_require__(4368),Dragger_default=__webpack_require__.n(Dragger),ProfilePicture=__webpack_require__(374);function TeamMemberID(_ref){var person=_ref.person;return react_default.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},person?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(ProfilePicture.a,{name:null==person?void 0:person.first_name,email:null==person?void 0:person.email,size:"md"}),react_default.a.createElement("span",{style:{marginLeft:4}},(null==person?void 0:person.first_name)||(null==person?void 0:person.email))):react_default.a.createElement("span",{className:"text-muted"},"Unknown"))}try{TeamMemberID.displayName="TeamMemberID",TeamMemberID.__docgenInfo={description:"",displayName:"TeamMemberID",props:{person:{defaultValue:null,description:"",name:"person",required:!1,type:{name:"UserBasicType | null"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/TeamMemberID.tsx#TeamMemberID"]={docgenInfo:TeamMemberID.__docgenInfo,name:"TeamMemberID",path:"frontend/src/lib/components/TeamMemberID.tsx#TeamMemberID"})}catch(__react_docgen_typescript_loader_error){}var dayjs=__webpack_require__(47);function CohortDetailsRow(_ref){var cohort=_ref.cohort,preflight=Object(index_esm.useValues)(PreflightCheck_logic.a).preflight,columnSize=(null==preflight?void 0:preflight.is_clickhouse_enabled)?12:8;return react_default.a.createElement(row.a,{justify:"space-between",align:"top",className:"mt text-center"},react_default.a.createElement(col.a,{span:columnSize},react_default.a.createElement("label",{className:"ant-form-item-label"},"Created at"),react_default.a.createElement("div",null,Object(dayjs.a)(cohort.created_at).fromNow())),react_default.a.createElement(col.a,{span:columnSize},react_default.a.createElement("label",{className:"ant-form-item-label"},"Created by"),react_default.a.createElement("div",null,react_default.a.createElement(TeamMemberID,{person:cohort.created_by}))),!(null==preflight?void 0:preflight.is_clickhouse_enabled)&&react_default.a.createElement(col.a,{span:columnSize},react_default.a.createElement("label",{className:"ant-form-item-label"},"Last calculated at"),react_default.a.createElement("div",null,cohort.last_calculation?Object(dayjs.a)(cohort.last_calculation).fromNow():"in progress")))}try{CohortDetailsRow.displayName="CohortDetailsRow",CohortDetailsRow.__docgenInfo={description:"",displayName:"CohortDetailsRow",props:{cohort:{defaultValue:null,description:"",name:"cohort",required:!0,type:{name:"CohortType"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/cohorts/CohortDetailsRow.tsx#CohortDetailsRow"]={docgenInfo:CohortDetailsRow.__docgenInfo,name:"CohortDetailsRow",path:"frontend/src/scenes/cohorts/CohortDetailsRow.tsx#CohortDetailsRow"})}catch(__react_docgen_typescript_loader_error){}var Persons=__webpack_require__(4492),react_toastify=(__webpack_require__(149),__webpack_require__(68)),api=__webpack_require__(22);function cohortLogic_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function cohortLogic_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return cohortLogic_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cohortLogic_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function cohortLogic_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function cohortLogic_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function cohortLogic_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?cohortLogic_ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):cohortLogic_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function formatGroupPayload(group){return cohortLogic_objectSpread(cohortLogic_objectSpread({},group),{},{id:void 0,matchType:void 0})}function determineMatchType(group){return group.action_id||group.event_id?constants.k:constants.u}function processCohortOnSet(cohort){return cohort.groups&&(cohort.groups=cohort.groups.map((function(group){return function addLocalCohortGroupId(group){return cohortLogic_objectSpread({matchType:determineMatchType(group),id:Math.random().toString().substr(2,5)},group)}(group)}))),cohort}var cohortLogic=Object(index_esm.kea)({props:{},key:function key(props){return props.cohort.id||"new"},path:function path(key){return["scenes","cohorts","cohortLogic",key]},connect:[cohortsModel.a],actions:function actions(){return{saveCohort:function saveCohort(){var cohortParams=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},filterParams=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{cohortParams:cohortParams,filterParams:filterParams}},setCohort:function setCohort(cohort){return{cohort:cohort}},onCriteriaChange:function onCriteriaChange(newGroup,id){return{newGroup:newGroup,id:id}},fetchCohort:function fetchCohort(cohort){return{cohort:cohort}},setPollTimeout:function setPollTimeout(pollTimeout){return{pollTimeout:pollTimeout}},setLastSavedAt:function setLastSavedAt(lastSavedAt){return{lastSavedAt:lastSavedAt}},checkIfFinishedCalculating:function checkIfFinishedCalculating(cohort){return{cohort:cohort}},setSubmitted:function setSubmitted(submitted){return{submitted:submitted}}}},reducers:function reducers(_ref){return{pollTimeout:[null,{setPollTimeout:function setPollTimeout(_,_ref2){return _ref2.pollTimeout}}],cohort:[processCohortOnSet(_ref.props.cohort),{setCohort:function setCohort(_,_ref3){return processCohortOnSet(_ref3.cohort)},onCriteriaChange:function onCriteriaChange(state,_ref4){var newGroup=_ref4.newGroup,id=_ref4.id,cohort=cohortLogic_objectSpread({},state),index=cohort.groups.findIndex((function(group){return group.id===id}));return newGroup.matchType?cohort.groups[index]=cohortLogic_objectSpread({id:cohort.groups[index].id,matchType:constants.k},newGroup):cohort.groups[index]=cohortLogic_objectSpread(cohortLogic_objectSpread({},cohort.groups[index]),newGroup),processCohortOnSet(cohort)}}],lastSavedAt:[!1,{setLastSavedAt:function setLastSavedAt(_,_ref5){return _ref5.lastSavedAt}}],submitted:[!1,{setSubmitted:function setSubmitted(_,_ref6){return _ref6.submitted}}]}},listeners:function listeners(_ref7){var _checkIfFinishedCalculating,_fetchCohort,_saveCohort,actions=_ref7.actions,values=_ref7.values,key=_ref7.key;return{saveCohort:(_saveCohort=asyncToGenerator_default()(regenerator_default.a.mark((function _callee(_ref8,breakpoint){var cohortParams,filterParams,cohort,cohortFormData,_i,_Object$entries,_Object$entries$_i,itemKey,value,_iterator,_step,_group$properties,_group,formattedGroups;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:cohortParams=_ref8.cohortParams,filterParams=_ref8.filterParams,cohort=cohortLogic_objectSpread(cohortLogic_objectSpread({},values.cohort),cohortParams),cohortFormData=new FormData,_i=0,_Object$entries=Object.entries(cohort);case 4:if(!(_i<_Object$entries.length)){_context.next=42;break}if(_Object$entries$_i=slicedToArray_default()(_Object$entries[_i],2),itemKey=_Object$entries$_i[0],value=_Object$entries$_i[1],"groups"!==itemKey){_context.next=38;break}if(!cohort.is_static){_context.next=13;break}if(cohort.csv||"new"!==cohort.id){_context.next=11;break}return actions.setSubmitted(!0),_context.abrupt("return");case 11:_context.next=34;break;case 13:_iterator=cohortLogic_createForOfIteratorHelper(value),_context.prev=14,_iterator.s();case 16:if((_step=_iterator.n()).done){_context.next=26;break}if((_group=_step.value).matchType!==constants.u||(null===(_group$properties=_group.properties)||void 0===_group$properties?void 0:_group$properties.length)){_context.next=21;break}return actions.setSubmitted(!0),_context.abrupt("return");case 21:if(_group.matchType!==constants.k||_group.action_id||_group.event_id){_context.next=24;break}return actions.setSubmitted(!0),_context.abrupt("return");case 24:_context.next=16;break;case 26:_context.next=31;break;case 28:_context.prev=28,_context.t0=_context.catch(14),_iterator.e(_context.t0);case 31:return _context.prev=31,_iterator.f(),_context.finish(31);case 34:formattedGroups=value.map((function(group){return formatGroupPayload(group)})),cohort.csv?cohortFormData.append(itemKey,"[]"):cohortFormData.append(itemKey,JSON.stringify(formattedGroups)),_context.next=39;break;case 38:cohortFormData.append(itemKey,value);case 39:_i++,_context.next=4;break;case 42:if(_context.prev=42,"new"===cohort.id){_context.next=50;break}return _context.next=46,api.a.cohorts.update(cohort.id,cohortFormData,filterParams);case 46:cohort=_context.sent,cohortsModel.a.actions.updateCohort(cohort),_context.next=54;break;case 50:return _context.next=52,api.a.cohorts.create(cohortFormData,filterParams);case 52:cohort=_context.sent,cohortsModel.a.actions.cohortCreated(cohort);case 54:_context.next=60;break;case 56:return _context.prev=56,_context.t1=_context.catch(42),Object(utils.z)("Error saving your cohort","Attempting to save this cohort returned an error:",0!==_context.t1.status?_context.t1.detail:"Check your internet connection and make sure you don't have an extension blocking our requests.",_context.t1.code),_context.abrupt("return");case 60:actions.setSubmitted(!1),cohort.is_calculating=!0,breakpoint(),delete cohort.csv,actions.setCohort(cohort),react_toastify.c.success(react_default.a.createElement("div",{"data-attr":"success-toast"},react_default.a.createElement("h1",null,"Cohort saved successfully!"),react_default.a.createElement("p",null,"Please wait up to a few minutes for the cohort to be calculated.")),{toastId:"cohort-saved-".concat(key)}),actions.checkIfFinishedCalculating(cohort);case 67:case"end":return _context.stop()}}),_callee,null,[[14,28,31,34],[42,56]])}))),function saveCohort(_x,_x2){return _saveCohort.apply(this,arguments)}),fetchCohort:(_fetchCohort=asyncToGenerator_default()(regenerator_default.a.mark((function _callee2(_ref9,breakpoint){var cohort;return regenerator_default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return cohort=_ref9.cohort,_context2.next=3,api.a.cohorts.get(cohort.id);case 3:cohort=_context2.sent,breakpoint(),actions.checkIfFinishedCalculating(cohort);case 6:case"end":return _context2.stop()}}),_callee2)}))),function fetchCohort(_x3,_x4){return _fetchCohort.apply(this,arguments)}),checkIfFinishedCalculating:(_checkIfFinishedCalculating=asyncToGenerator_default()(regenerator_default.a.mark((function _callee3(_ref10,breakpoint){var cohort;return regenerator_default.a.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:cohort=_ref10.cohort,breakpoint(),cohort.is_calculating?actions.setPollTimeout(setTimeout((function(){return actions.fetchCohort(cohort)}),1e3)):(actions.setLastSavedAt((new Date).toISOString()),actions.setCohort(cohort),cohortsModel.a.actions.updateCohort(cohort),values.pollTimeout&&(clearTimeout(values.pollTimeout),actions.setPollTimeout(null)));case 3:case"end":return _context3.stop()}}),_callee3)}))),function checkIfFinishedCalculating(_x5,_x6){return _checkIfFinishedCalculating.apply(this,arguments)})}},events:function events(_ref11){var _afterMount,values=_ref11.values,actions=_ref11.actions,props=_ref11.props;return{afterMount:(_afterMount=asyncToGenerator_default()(regenerator_default.a.mark((function _callee4(){return regenerator_default.a.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:props.cohort.id||actions.setCohort({groups:[],id:"new"});case 1:case"end":return _context4.stop()}}),_callee4)}))),function afterMount(){return _afterMount.apply(this,arguments)}),beforeUnmount:function beforeUnmount(){values.pollTimeout&&clearTimeout(values.pollTimeout)}}}}),DropdownSelector=__webpack_require__(2552),userLogic=__webpack_require__(66),Spinner=(__webpack_require__(4416),__webpack_require__(176));function Cohort_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function Cohort_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Cohort_ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):Cohort_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function Cohort(props){var logic=cohortLogic(props),setCohort=Object(index_esm.useActions)(logic).setCohort,_useValues=Object(index_esm.useValues)(logic),cohort=_useValues.cohort,submitted=_useValues.submitted,hasAvailableFeature=Object(index_esm.useValues)(userLogic.a).hasAvailableFeature,onTypeChange=function onTypeChange(type){type===constants.j?setCohort(Cohort_objectSpread(Cohort_objectSpread({},cohort),{},{is_static:!0})):type===constants.i&&setCohort(Cohort_objectSpread(Cohort_objectSpread({},cohort),{},{is_static:!1}))},staticCSVDraggerProps={name:"file",multiple:!1,fileList:cohort.csv?[cohort.csv]:[],beforeUpload:function beforeUpload(file){return setCohort(Cohort_objectSpread(Cohort_objectSpread({},cohort),{},{csv:file})),!1},accept:".csv"},COHORT_TYPE_OPTIONS=[{key:constants.j,label:"Static",description:"Upload a list of users. Updates manually",icon:react_default.a.createElement(OrderedListOutlined.a,null)},{key:constants.i,label:"Dynamic",description:"Cohort updates dynamically based on properties",icon:react_default.a.createElement(CalculatorOutlined.a,null)}],cohortTypeDropdown=function cohortTypeDropdown(){return react_default.a.createElement(DropdownSelector.a,{options:COHORT_TYPE_OPTIONS,disabled:"new"!==cohort.id,value:cohort.is_static?constants.j:constants.i,onValueChange:onTypeChange})};return react_default.a.createElement("div",{className:"mb"},react_default.a.createElement(row.a,{gutter:16},react_default.a.createElement(col.a,null,react_default.a.createElement("h3",{className:"l3"},"General"))),react_default.a.createElement(row.a,{gutter:16},react_default.a.createElement(col.a,{md:14},react_default.a.createElement(CohortNameInput,{input:cohort.name,onChange:function onChange(name){return setCohort(Cohort_objectSpread(Cohort_objectSpread({},cohort),{},{name:name}))}})),react_default.a.createElement(col.a,{md:10},"new"===cohort.id?cohortTypeDropdown():react_default.a.createElement(tooltip.a,{title:"Create a new cohort to use a different type of cohort."},react_default.a.createElement("div",null,cohortTypeDropdown())))),hasAvailableFeature(types.c.DASHBOARD_COLLABORATION)&&react_default.a.createElement(row.a,{gutter:16,className:"mt"},react_default.a.createElement(col.a,{span:24},react_default.a.createElement(CohortDescriptionInput,{description:cohort.description,onChange:function onDescriptionChange(description){setCohort(Cohort_objectSpread(Cohort_objectSpread({},cohort),{},{description:description}))}}))),cohort.id&&"new"!==cohort.id&&react_default.a.createElement(CohortDetailsRow,{cohort:cohort}),react_default.a.createElement(divider.a,null),cohort.is_static?react_default.a.createElement("div",null,react_default.a.createElement("h3",{className:"l3"},"Add Users"),react_default.a.createElement("span",null,"Drop a ",react_default.a.createElement("pre",{style:{display:"inline"}},".csv")," file here to add users to your cohort"),react_default.a.createElement(Dragger_default.a,extends_default()({},staticCSVDraggerProps,{className:"cohort-csv-dragger"}),react_default.a.createElement("p",{className:"ant-upload-drag-icon"},react_default.a.createElement(InboxOutlined.a,null)),react_default.a.createElement("div",null,react_default.a.createElement("p",{className:"ant-upload-text"},"Click or drag file to this area to upload"),react_default.a.createElement("p",{className:"ant-upload-hint"},"The CSV file only requires a single column with the user’s distinct ID."),submitted&&!cohort.csv&&react_default.a.createElement("p",{style:{color:"var(--danger)",marginTop:16}},"You need to upload a CSV file.")))):react_default.a.createElement(CohortMatchingCriteriaSection_CohortMatchingCriteriaSection,{logic:logic}),"new"!==cohort.id&&react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(divider.a,null),react_default.a.createElement("div",null,react_default.a.createElement("h3",{className:"l3"},"Matched Users"),react_default.a.createElement("span",null,"List of users that currently match the criteria defined"),cohort.is_calculating?react_default.a.createElement("div",{className:"cohort-recalculating flex-center"},react_default.a.createElement(Spinner.a,{size:"sm",style:{marginRight:4}}),"We're recalculating who belongs to this cohort. This could take up to a couple of minutes."):react_default.a.createElement("div",{style:{marginTop:15}},react_default.a.createElement(Persons.Persons,{cohort:cohort})))))}function CohortFooter(props){var logic=cohortLogic(props),cohort=Object(index_esm.useValues)(logic).cohort,saveCohort=Object(index_esm.useActions)(logic).saveCohort;return react_default.a.createElement(row.a,{style:{display:"flex"}},react_default.a.createElement("div",{style:{flexGrow:1,textAlign:"right"}},react_default.a.createElement(es_button.a,{disabled:!cohort.name,type:"primary",htmlType:"submit","data-attr":"save-cohort",onClick:function onClick(){return saveCohort()},style:{float:"right"},icon:react_default.a.createElement(SaveOutlined.a,null)},"Save cohort")))}try{Cohort.displayName="Cohort",Cohort.__docgenInfo={description:"",displayName:"Cohort",props:{cohort:{defaultValue:null,description:"",name:"cohort",required:!0,type:{name:"CohortType"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/cohorts/Cohort.tsx#Cohort"]={docgenInfo:Cohort.__docgenInfo,name:"Cohort",path:"frontend/src/scenes/cohorts/Cohort.tsx#Cohort"})}catch(__react_docgen_typescript_loader_error){}try{CohortFooter.displayName="CohortFooter",CohortFooter.__docgenInfo={description:"",displayName:"CohortFooter",props:{cohort:{defaultValue:null,description:"",name:"cohort",required:!0,type:{name:"CohortType"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/cohorts/Cohort.tsx#CohortFooter"]={docgenInfo:CohortFooter.__docgenInfo,name:"CohortFooter",path:"frontend/src/scenes/cohorts/Cohort.tsx#CohortFooter"})}catch(__react_docgen_typescript_loader_error){}var Drawer=__webpack_require__(1846),Cohorts=__webpack_require__(4441),Cohorts_default=__webpack_require__.n(Cohorts),Cohorts_options={insert:"head",singleton:!1},columnUtils=(injectStylesIntoStyleTag_default()(Cohorts_default.a,Cohorts_options),Cohorts_default.a.locals,__webpack_require__(1224)),Tooltip=__webpack_require__(45),LemonTable=__webpack_require__(340),More=__webpack_require__(897),LemonButton=__webpack_require__(91),LemonRow=__webpack_require__(195),lib=__webpack_require__(23),NEW_COHORT={id:"new",groups:[{id:Math.random().toString().substr(2,5),matchType:constants.u,properties:[]}]},cohortsUrlLogic=Object(index_esm.kea)({path:["scenes","cohorts","cohortsUrlLogic"],actions:{setOpenCohort:function setOpenCohort(cohort){return{cohort:cohort}},exportCohortPersons:function exportCohortPersons(id){return{id:id}}},reducers:{openCohort:[null,{setOpenCohort:function setOpenCohort(_,_ref){return _ref.cohort}}]},listeners:{exportCohortPersons:function exportCohortPersons(_ref2){var id=_ref2.id;window.open("/api/person.csv?cohort=".concat(id),"_blank")}},actionToUrl:function actionToUrl(_ref3){var values=_ref3.values;return{setOpenCohort:function setOpenCohort(){return Object(lib.combineUrl)(values.openCohort?urls.a.cohort(values.openCohort.id||"new"):urls.a.cohorts(),lib.router.values.searchParams).url}}},urlToAction:function urlToAction(_ref4){var _cohortsCohortId,actions=_ref4.actions,values=_ref4.values;return{"/cohorts(/:cohortId)":(_cohortsCohortId=asyncToGenerator_default()(regenerator_default.a.mark((function _callee(_ref5){var _values$openCohort,cohortId,cohort;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(cohortId=_ref5.cohortId)||"new"===cohortId||"personsModalNew"===cohortId||Number(cohortId)===(null===(_values$openCohort=values.openCohort)||void 0===_values$openCohort?void 0:_values$openCohort.id)){_context.next=8;break}return _context.next=4,api.a.cohorts.get(parseInt(cohortId));case 4:cohort=_context.sent,actions.setOpenCohort(cohort),_context.next=9;break;case 8:"new"===cohortId?actions.setOpenCohort(NEW_COHORT):cohortId||actions.setOpenCohort(null);case 9:case"end":return _context.stop()}}),_callee)}))),function cohortsCohortId(_x){return _cohortsCohortId.apply(this,arguments)})}}}),Cohorts_searchCohorts=function searchCohorts(sources,search){return new fuse_esm.a(sources,{keys:["name"],threshold:.3}).search(search).map((function(result){return result.item}))};function Cohorts_Cohorts(){var _useValues=Object(index_esm.useValues)(cohortsModel.a),cohorts=_useValues.cohorts,cohortsLoading=_useValues.cohortsLoading,loadCohorts=Object(index_esm.useActions)(cohortsModel.a).loadCohorts,openCohort=Object(index_esm.useValues)(cohortsUrlLogic).openCohort,_useActions2=Object(index_esm.useActions)(cohortsUrlLogic),setOpenCohort=_useActions2.setOpenCohort,exportCohortPersons=_useActions2.exportCohortPersons,hasAvailableFeature=Object(index_esm.useValues)(userLogic.a).hasAvailableFeature,searchParams=Object(index_esm.useValues)(lib.router).searchParams,_useState=Object(react.useState)(!1),_useState2=slicedToArray_default()(_useState,2),searchTerm=_useState2[0],setSearchTerm=_useState2[1],columns=[{title:"Name",dataIndex:"name",className:"ph-no-capture",width:"30%",sorter:function sorter(a,b){return(a.name||"").localeCompare(b.name||"")},render:function Render(name,_ref6){var id=_ref6.id,description=_ref6.description;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(Link.a,{to:Object(lib.combineUrl)(urls.a.cohort(id),searchParams).url},react_default.a.createElement("h4",{className:"row-name"},name||"Untitled")),hasAvailableFeature(types.c.DASHBOARD_COLLABORATION)&&description&&react_default.a.createElement("span",{className:"row-description"},description))}},{title:"Users in cohort",render:function RenderCount(_,cohort){var _cohort$count;return null===(_cohort$count=cohort.count)||void 0===_cohort$count?void 0:_cohort$count.toLocaleString()},dataIndex:"count",sorter:function sorter(a,b){return(a.count||0)-(b.count||0)}},Object(columnUtils.b)(),Object(columnUtils.a)(),{title:react_default.a.createElement("span",null,react_default.a.createElement(Tooltip.a,{title:"PostHog calculates what users belong to each cohort. This is then used when filtering on cohorts in the Trends page etc. Calculating happens every 15 minutes, or whenever a cohort is updated."},"Last calculated",react_default.a.createElement(InfoCircleOutlined.a,{style:{marginLeft:6}}))),render:function RenderCalculation(_,cohort){return cohort.is_static?react_default.a.createElement(react_default.a.Fragment,null,"N/A"):cohort.is_calculating?react_default.a.createElement("span",{style:{display:"inline-flex",alignItems:"center"}},"in progress ",react_default.a.createElement(Spinner.a,{size:"sm",style:{marginLeft:6}})):Object(dayjs.a)(cohort.last_calculation).fromNow()}},{width:0,render:function RenderActions(_,_ref7){var id=_ref7.id,name=_ref7.name;return react_default.a.createElement(More.a,{overlay:react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(LemonButton.a,{type:"stealth",to:urls.a.cohort(id),fullWidth:!0},"Edit"),react_default.a.createElement(LemonButton.a,{type:"stealth",to:Object(lib.combineUrl)(urls.a.sessionRecordings(),{filters:{properties:[{key:"id",label:name,type:"cohort",value:id}]}}).url,fullWidth:!0},"View session recordings"),react_default.a.createElement(LemonButton.a,{type:"stealth",onClick:function onClick(){return exportCohortPersons(id)},tooltip:"Export all users belonging to this cohort in CSV format.",fullWidth:!0},"Export users"),react_default.a.createElement(LemonRow.b,null),react_default.a.createElement(LemonButton.a,{type:"stealth",style:{color:"var(--danger)"},onClick:function onClick(){return Object(utils.s)({endpoint:api.a.cohorts.determineDeleteEndpoint(),object:{name:name,id:id},callback:loadCohorts})},fullWidth:!0},"Delete cohort"))})}}];return react_default.a.createElement("div",null,react_default.a.createElement(PageHeader.a,{title:"Cohorts",caption:"Create lists of users who have something in common to use in analytics or feature flags."}),react_default.a.createElement("div",null,react_default.a.createElement(es_input.a.Search,{allowClear:!0,enterButton:!0,placeholder:"Search for cohorts",style:{maxWidth:400,width:"initial",flexGrow:1},onChange:function onChange(e){setSearchTerm(e.target.value)}}),react_default.a.createElement("div",{className:"mb float-right"},react_default.a.createElement(es_button.a,{type:"primary","data-attr":"create-cohort",onClick:function onClick(){return setOpenCohort(NEW_COHORT)},icon:react_default.a.createElement(PlusOutlined.a,null)},"New Cohort")),react_default.a.createElement(LemonTable.a,{columns:columns,loading:cohortsLoading,rowKey:"id",pagination:{pageSize:30},dataSource:searchTerm?Cohorts_searchCohorts(cohorts,searchTerm):cohorts,nouns:["cohort","cohorts"]}),react_default.a.createElement(Drawer.a,{title:"new"===(null==openCohort?void 0:openCohort.id)?"New cohort":null==openCohort?void 0:openCohort.name,className:"cohorts-drawer",onClose:function onClose(){return setOpenCohort(null)},destroyOnClose:!0,visible:!!openCohort,footer:openCohort&&react_default.a.createElement(CohortFooter,{cohort:openCohort})},openCohort&&react_default.a.createElement(Cohort,{cohort:openCohort}))))}var scene={component:Cohorts_Cohorts,logic:cohortsUrlLogic}}}]);