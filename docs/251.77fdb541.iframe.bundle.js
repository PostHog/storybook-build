(window.webpackJsonp=window.webpackJsonp||[]).push([[251],{"./frontend/src/scenes/dashboard/Dashboards.tsx":function(ve,O,e){"use strict";e.r(O),e.d(O,"scene",function(){return Be}),e.d(O,"Dashboards",function(){return ie});var F=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),te=e.n(F),ne=e("./node_modules/core-js/modules/es.array.concat.js"),be=e("./node_modules/core-js/modules/es.symbol.js"),se=e("./node_modules/core-js/modules/es.symbol.description.js"),Ee=e("./node_modules/core-js/modules/es.function.name.js"),m=e("./node_modules/react/index.js"),a=e.n(m),u=e("./node_modules/kea/lib/index.esm.js"),z=e("./frontend/src/models/dashboardsModel.tsx"),D=e("./node_modules/antd/es/tabs/index.js"),oe=e("./node_modules/antd/es/input/index.js"),H=e("./node_modules/antd/es/row/index.js"),G=e("./node_modules/antd/es/col/index.js"),T=e("./node_modules/antd/es/card/index.js"),l=e("./frontend/src/scenes/dashboard/dashboardsLogic.ts"),A=e("./frontend/src/lib/components/Link.tsx"),b=e("./node_modules/@ant-design/icons/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),$={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M878.3 392.1L631.9 145.7c-6.5-6.5-15-9.7-23.5-9.7s-17 3.2-23.5 9.7L423.8 306.9c-12.2-1.4-24.5-2-36.8-2-73.2 0-146.4 24.1-206.5 72.3-15.4 12.3-16.6 35.4-2.7 49.4l181.7 181.7-215.4 215.2a15.8 15.8 0 00-4.6 9.8l-3.4 37.2c-.9 9.4 6.6 17.4 15.9 17.4.5 0 1 0 1.5-.1l37.2-3.4c3.7-.3 7.2-2 9.8-4.6l215.4-215.4 181.7 181.7c6.5 6.5 15 9.7 23.5 9.7 9.7 0 19.3-4.2 25.9-12.4 56.3-70.3 79.7-158.3 70.2-243.4l161.1-161.1c12.9-12.8 12.9-33.8 0-46.8z"}}]},name:"pushpin",theme:"filled"},J=$,j=e("./node_modules/@ant-design/icons/es/components/AntdIcon.js"),x=function(d,r){return m.createElement(j.a,Object(b.a)(Object(b.a)({},d),{},{ref:r,icon:J}))};x.displayName="PushpinFilled";var E=m.forwardRef(x),Y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M878.3 392.1L631.9 145.7c-6.5-6.5-15-9.7-23.5-9.7s-17 3.2-23.5 9.7L423.8 306.9c-12.2-1.4-24.5-2-36.8-2-73.2 0-146.4 24.1-206.5 72.3a33.23 33.23 0 00-2.7 49.4l181.7 181.7-215.4 215.2a15.8 15.8 0 00-4.6 9.8l-3.4 37.2c-.9 9.4 6.6 17.4 15.9 17.4.5 0 1 0 1.5-.1l37.2-3.4c3.7-.3 7.2-2 9.8-4.6l215.4-215.4 181.7 181.7c6.5 6.5 15 9.7 23.5 9.7 9.7 0 19.3-4.2 25.9-12.4 56.3-70.3 79.7-158.3 70.2-243.4l161.1-161.1c12.9-12.8 12.9-33.8 0-46.8zM666.2 549.3l-24.5 24.5 3.8 34.4a259.92 259.92 0 01-30.4 153.9L262 408.8c12.9-7.1 26.3-13.1 40.3-17.9 27.2-9.4 55.7-14.1 84.7-14.1 9.6 0 19.3.5 28.9 1.6l34.4 3.8 24.5-24.5L608.5 224 800 415.5 666.2 549.3z"}}]},name:"pushpin",theme:"outlined"},t=Y,s=function(d,r){return m.createElement(j.a,Object(b.a)(Object(b.a)({},d),{},{ref:r,icon:t}))};s.displayName="PushpinOutlined";var h=m.forwardRef(s),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 664c-28.5 0-54.8 10-75.4 26.7L469.4 540.8a160.68 160.68 0 000-57.6l207.2-149.9C697.2 350 723.5 360 752 360c66.2 0 120-53.8 120-120s-53.8-120-120-120-120 53.8-120 120c0 11.6 1.6 22.7 4.7 33.3L439.9 415.8C410.7 377.1 364.3 352 312 352c-88.4 0-160 71.6-160 160s71.6 160 160 160c52.3 0 98.7-25.1 127.9-63.8l196.8 142.5c-3.1 10.6-4.7 21.8-4.7 33.3 0 66.2 53.8 120 120 120s120-53.8 120-120-53.8-120-120-120zm0-476c28.7 0 52 23.3 52 52s-23.3 52-52 52-52-23.3-52-52 23.3-52 52-52zM312 600c-48.5 0-88-39.5-88-88s39.5-88 88-88 88 39.5 88 88-39.5 88-88 88zm440 236c-28.7 0-52-23.3-52-52s23.3-52 52-52 52 23.3 52 52-23.3 52-52 52z"}}]},name:"share-alt",theme:"outlined"},Q=o,y=function(d,r){return m.createElement(j.a,Object(b.a)(Object(b.a)({},d),{},{ref:r,icon:Q}))};y.displayName="ShareAltOutlined";var C=m.forwardRef(y),je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zm52 132H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200zM424 712H296V584c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v128H104c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h128v128c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V776h128c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}}]},name:"appstore-add",theme:"outlined"},ge=je,re=function(d,r){return m.createElement(j.a,Object(b.a)(Object(b.a)({},d),{},{ref:r,icon:ge}))};re.displayName="AppstoreAddOutlined";var le=m.forwardRef(re),S=e("./frontend/src/lib/forms/Field.tsx"),pe=e("./frontend/src/lib/components/LemonModal/LemonModal.tsx"),g=e("./frontend/src/lib/components/LemonButton/index.ts"),I=e("./frontend/src/types.ts"),de=e("./frontend/src/lib/components/LemonSelect.tsx"),Oe=e("./frontend/src/lib/components/PayGateMini/PayGateMini.tsx"),De=e("./frontend/src/lib/forms/VerticalForm.tsx"),R=e("./frontend/src/scenes/dashboard/newDashboardLogic.ts"),Ae=e("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),ye=e("./frontend/src/lib/components/LemonTextArea/LemonTextArea.tsx"),Le=e("./frontend/src/scenes/dashboard/DashboardCollaborators.tsx");function Pe(){var p=Object(u.useActions)(R.a),d=p.hideNewDashboardModal,r=Object(u.useValues)(R.a),L=r.isNewDashboardSubmitting,w=r.newDashboardModalVisible;return a.a.createElement(pe.a,{title:"New dashboard",destroyOnClose:!0,onCancel:d,visible:w,footer:a.a.createElement(a.a.Fragment,null,a.a.createElement(g.a,{form:"new-dashboard-form",type:"secondary","data-attr":"dashboard-cancel",loading:L,style:{marginRight:"0.5rem"},onClick:d},"Cancel"),a.a.createElement(g.a,{form:"new-dashboard-form",htmlType:"submit",type:"primary","data-attr":"dashboard-submit",loading:L,disabled:L},"Create"))},a.a.createElement(De.a,{logic:R.a,formKey:"newDashboard",id:"new-dashboard-form",enableFormOnSubmit:!0},a.a.createElement("p",null,"Use dashboards to compose multiple insights into a single view."),a.a.createElement(S.a,{name:"name",label:"Name"},a.a.createElement(Ae.a,{autoFocus:!0,"data-attr":"dashboard-name-input",className:"ph-ignore-input"})),a.a.createElement(S.a,{name:"description",label:"Description",showOptional:!0},a.a.createElement(ye.a,{"data-attr":"dashboard-description-input",className:"ph-ignore-input"})),a.a.createElement(S.a,{name:"useTemplate",label:"Template",showOptional:!0},a.a.createElement(de.a,{placeholder:"Optionally start from template",allowClear:!0,options:{DEFAULT_APP:{label:"Website","data-attr":"dashboard-select-default-app"}},type:"stealth",outlined:!0,style:{width:"100%"},"data-attr":"copy-from-template"})),a.a.createElement(S.a,{name:"restrictionLevel",label:"Collaboration settings"},function(N){var k=N.value,K=N.onChange;return a.a.createElement(Oe.a,{feature:I.d.DASHBOARD_PERMISSIONING},a.a.createElement(de.a,{value:k,onChange:K,options:Le.a,loading:L,type:"stealth",outlined:!0,style:{width:"100%"}}))})))}var Ce=e("./frontend/src/lib/components/PageHeader.tsx"),Me=e("./frontend/src/lib/components/ObjectTags/ObjectTags.tsx"),Te=e("./frontend/src/scenes/userLogic.ts"),U=e("./frontend/src/lib/utils/eventUsageLogic.ts"),B=e("./frontend/src/scenes/urls.ts"),xe=e("./frontend/src/lib/components/LemonTable/index.ts"),ce=e("./frontend/src/lib/components/LemonTable/columnUtils.tsx"),Se=e("./frontend/src/lib/components/LemonButton/More.tsx"),W=e("./frontend/src/scenes/dashboard/dashboardLogic.ts"),Ie=e("./frontend/src/lib/components/LemonRow/index.ts"),X=e("./frontend/src/lib/components/LemonDivider/index.ts"),Z=e("./frontend/src/lib/components/Tooltip.tsx"),_=e("./frontend/src/lib/components/icons.tsx"),Re=e("./frontend/src/scenes/teamLogic.tsx"),Ue=e("./frontend/src/lib/constants.tsx"),Be={component:ie,logic:l.b};function ie(){var p=Object(u.useValues)(z.a),d=p.dashboardsLoading,r=Object(u.useActions)(z.a),L=r.deleteDashboard,w=r.unpinDashboard,N=r.pinDashboard,k=r.duplicateDashboard,K=Object(u.useActions)(l.b),We=K.setSearchTerm,q=K.setCurrentTab,ee=Object(u.useValues)(l.b),me=ee.dashboards,V=ee.searchTerm,P=ee.currentTab,ue=Object(u.useActions)(R.a),Ne=ue.showNewDashboardModal,he=ue.addDashboard,Ke=Object(u.useValues)(Te.a),fe=Ke.hasAvailableFeature,Ve=Object(u.useValues)(Re.a),ae=Ve.currentTeam,Fe=[{width:0,dataIndex:"pinned",render:function(c,i){var n=i.id;return c?a.a.createElement(E,{onClick:function(){return w(n,U.a.DashboardsList)},style:{cursor:"pointer"}}):a.a.createElement(h,{onClick:function(){return N(n,U.a.DashboardsList)},style:{cursor:"pointer"}})}},{title:"Name",dataIndex:"name",width:"40%",render:function(c,i){var n=i.id,v=i.description,M=i._highlight,ze=i.is_shared,He=i.effective_privilege_level,Ge=n===(ae==null?void 0:ae.primary_dashboard),$e=He>=Ue.d.CanEdit;return a.a.createElement("div",{className:M?"highlighted":void 0,style:{display:"inline-block"}},a.a.createElement("div",{className:"row-name"},a.a.createElement(A.a,{"data-attr":"dashboard-name",to:B.a.dashboard(n)},c||"Untitled"),!$e&&a.a.createElement(Z.a,{title:"You don't have edit permissions for this dashboard."},a.a.createElement(_.IconLock,{style:{marginLeft:6,verticalAlign:"-0.125em"}})),ze&&a.a.createElement(Z.a,{title:"This dashboard is shared publicly."},a.a.createElement(C,{style:{marginLeft:6}})),Ge&&a.a.createElement(Z.a,{title:"Primary dashboards are shown on the project home page"},a.a.createElement(_.IconCottage,{style:{marginLeft:6,color:"var(--warning)",fontSize:"1rem",verticalAlign:"-0.125em"}}))),fe(I.d.DASHBOARD_COLLABORATION)&&v&&a.a.createElement("span",{className:"row-description"},v))},sorter:function(c,i){var n,v;return((n=c.name)!==null&&n!==void 0?n:"Untitled").localeCompare((v=i.name)!==null&&v!==void 0?v:"Untitled")}}].concat(te()(fe(I.d.TAGGING)?[{title:"Tags",dataIndex:"tags",render:function(c){return c?a.a.createElement(Me.a,{tags:c,staticOnly:!0}):null}}]:[]),[Object(ce.b)(),Object(ce.a)(),{width:0,render:function(c,i){var n=i.id,v=i.name;return a.a.createElement(Se.a,{overlay:a.a.createElement("div",{style:{maxWidth:250}},a.a.createElement(g.a,{type:"stealth",to:B.a.dashboard(n),onClick:function(){Object(W.c)({id:n}).mount(),Object(W.c)({id:n}).actions.setDashboardMode(null,U.a.DashboardsList)},fullWidth:!0},"View"),a.a.createElement(g.a,{type:"stealth",to:B.a.dashboard(n),onClick:function(){Object(W.c)({id:n}).mount(),Object(W.c)({id:n}).actions.setDashboardMode(I.k.Edit,U.a.DashboardsList)},fullWidth:!0},"Edit"),a.a.createElement(g.a,{type:"stealth",onClick:function(){return k({id:n,name:v})},fullWidth:!0},"Duplicate"),a.a.createElement(X.a,null),a.a.createElement(Ie.a,{icon:a.a.createElement(_.IconCottage,{style:{color:"var(--warning)"}}),fullWidth:!0,status:"muted"},a.a.createElement("span",null,"Change the default dashboard on the"," ",a.a.createElement(A.a,{to:B.a.projectHomepage()},"project home page"),".")),a.a.createElement(X.a,null),a.a.createElement(g.a,{type:"stealth",onClick:function(){return L({id:n,redirect:!1})},fullWidth:!0,status:"danger"},"Delete dashboard"))})}}]);return a.a.createElement("div",null,a.a.createElement(Pe,null),a.a.createElement(Ce.a,{title:"Dashboards",buttons:a.a.createElement(g.a,{"data-attr":"new-dashboard",onClick:Ne,type:"primary"},"New dashboard")}),a.a.createElement(D.a,{activeKey:P,style:{borderColor:"#D9D9D9"},onChange:function(c){return q(c)}},a.a.createElement(D.a.TabPane,{tab:"All Dashboards",key:l.a.All}),a.a.createElement(D.a.TabPane,{tab:"Pinned",key:l.a.Pinned}),a.a.createElement(D.a.TabPane,{tab:"Shared",key:l.a.Shared})),a.a.createElement("div",null,a.a.createElement(oe.a.Search,{allowClear:!0,enterButton:!0,placeholder:"Search for dashboards",style:{width:240},value:V,onChange:function(c){We(c.target.value)}})),a.a.createElement(X.a,{large:!0}),d||me.length>0||V||P!==l.a.All?a.a.createElement(xe.a,{pagination:{pageSize:100},dataSource:me,rowKey:"id",columns:Fe,loading:d,defaultSorting:{columnKey:"name",order:1},emptyState:V?"No ".concat(P===l.a.Pinned?"pinned ":P===l.a.Shared?"shared ":"",'dashboards matching "').concat(V,'"!'):P===l.a.Pinned?a.a.createElement(a.a.Fragment,null,"No dashboards have been pinned for quick access yet."," ",a.a.createElement(A.a,{onClick:function(){return q(l.a.All)}},"Go to All Dashboards to pin one.")):P===l.a.Shared?a.a.createElement(a.a.Fragment,null,"No dashboards have been shared yet."," ",a.a.createElement(A.a,{onClick:function(){return q(l.a.All)}},"Go to All Dashboards to share one.")):void 0,nouns:["dashboard","dashboards"]}):a.a.createElement("div",{className:"mt"},a.a.createElement("p",null,"Create your first dashboard:"),a.a.createElement(H.a,{gutter:[16,16]},a.a.createElement(G.a,{xs:24,xl:6},a.a.createElement(T.a,{title:"Empty",size:"small",style:{cursor:"pointer"},onClick:function(){return he({name:"New Dashboard",useTemplate:""})}},a.a.createElement("div",{style:{textAlign:"center",fontSize:40}},a.a.createElement(le,null)))),a.a.createElement(G.a,{xs:24,xl:6},a.a.createElement(T.a,{title:"App Default",size:"small",style:{cursor:"pointer"},onClick:function(){return he({name:"Web App Dashboard",useTemplate:"DEFAULT_APP"})}},a.a.createElement("div",{style:{textAlign:"center",fontSize:40}},a.a.createElement(le,null)))))))}},"./frontend/src/scenes/dashboard/dashboardsLogic.ts":function(ve,O,e){"use strict";e.d(O,"a",function(){return E}),e.d(O,"b",function(){return Y});var F=e("./node_modules/core-js/modules/es.array.sort.js"),te=e.n(F),ne=e("./node_modules/core-js/modules/es.array.filter.js"),be=e.n(ne),se=e("./node_modules/core-js/modules/es.object.to-string.js"),Ee=e.n(se),m=e("./node_modules/core-js/modules/es.function.name.js"),a=e.n(m),u=e("./node_modules/core-js/modules/es.array.map.js"),z=e.n(u),D=e("./node_modules/core-js/modules/es.regexp.exec.js"),oe=e.n(D),H=e("./node_modules/core-js/modules/es.string.search.js"),G=e.n(H),T=e("./node_modules/core-js/modules/es.array.flat-map.js"),l=e.n(T),A=e("./node_modules/core-js/modules/es.array.unscopables.flat-map.js"),b=e.n(A),$=e("./node_modules/kea/lib/index.esm.js"),J=e("./node_modules/fuse.js/dist/fuse.esm.js"),j=e("./frontend/src/models/dashboardsModel.tsx"),x=e("./frontend/src/lib/utils.tsx"),E;(function(t){t.All="all",t.Pinned="pinned",t.Shared="shared"})(E||(E={}));var Y=Object($.kea)({path:["scenes","dashboard","dashboardsLogic"],actions:{setSearchTerm:function(s){return{searchTerm:s}},setCurrentTab:function(s){return{tab:s}}},reducers:{searchTerm:{setSearchTerm:function(s,h){var o=h.searchTerm;return o}},currentTab:[E.All,{setCurrentTab:function(s,h){var o=h.tab;return o}}]},selectors:{dashboards:[function(t){return[j.a.selectors.nameSortedDashboards,t.searchTerm,t.currentTab]},function(t,s,h){return t=t.filter(function(o){return!o.deleted}).sort(function(o,Q){var y,C;return((y=o.name)!==null&&y!==void 0?y:"Untitled").localeCompare((C=Q.name)!==null&&C!==void 0?C:"Untitled")}),h===E.Pinned?t=t.filter(function(o){return o.pinned}):h===E.Shared&&(t=t.filter(function(o){return o.is_shared})),s?new J.a(t,{keys:["key","name"],threshold:.3}).search(s).map(function(o){return o.item}):t}],dashboardTags:[function(){return[j.a.selectors.nameSortedDashboards]},function(t){return Object(x.Db)(t.flatMap(function(s){var h=s.tags;return h||""}),function(s){return s}).sort()}]}})}}]);
