(window.webpackJsonp=window.webpackJsonp||[]).push([[231],{"./frontend/src/lib/components/ChartFilter/chartFilterLogic.ts":function(Oe,Q,n){"use strict";n.d(Q,"a",function(){return z});var Ne=n("./node_modules/core-js/modules/es.array.includes.js"),he=n.n(Ne),Qe=n("./node_modules/core-js/modules/es.array.iterator.js"),Le=n.n(Qe),Ve=n("./node_modules/core-js/modules/es.object.to-string.js"),Yt=n.n(Ve),et=n("./node_modules/core-js/modules/es.object.values.js"),Me=n.n(et),e=n("./node_modules/core-js/modules/es.string.includes.js"),g=n.n(e),it=n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),ye=n.n(it),Ue=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),We=n.n(Ue),ne=n("./node_modules/kea/lib/index.esm.js"),se=n("./frontend/src/lib/utils.tsx"),P=n("./frontend/src/types.ts"),x=n("./frontend/src/scenes/insights/sharedUtils.ts"),O=n("./frontend/src/scenes/insights/insightLogic.ts");function ce(xe,H){var be=Object.keys(xe);if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(xe);H&&(_e=_e.filter(function(Ce){return Object.getOwnPropertyDescriptor(xe,Ce).enumerable})),be.push.apply(be,_e)}return be}function s(xe){for(var H=1;H<arguments.length;H++){var be=arguments[H]!=null?arguments[H]:{};H%2?ce(Object(be),!0).forEach(function(_e){We()(xe,_e,be[_e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(xe,Object.getOwnPropertyDescriptors(be)):ce(Object(be)).forEach(function(_e){Object.defineProperty(xe,_e,Object.getOwnPropertyDescriptor(be,_e))})}return xe}function M(xe){return Object.values(P.u).includes(xe)}var z=Object(ne.kea)({props:{},key:Object(x.c)("new"),path:function(H){return["lib","components","ChartFilter","chartFilterLogic",H]},connect:function(H){return{actions:[Object(O.c)(H),["setFilters"]],values:[Object(O.c)(H),["filters"]]}},actions:function(){return{setChartFilter:function(be){return{chartFilter:be}}}},selectors:{chartFilter:[function(xe){return[xe.filters]},function(xe){var H=xe.display,be=xe.funnel_viz_type;return(H===P.i.FunnelViz?be:H)||null}]},listeners:function(H){var be=H.actions,_e=H.values;return{setChartFilter:function(zt){var jt=zt.chartFilter,en=_e.filters,le=en.display,lt=en.funnel_viz_type;M(jt)?(lt!==jt||le!==P.i.FunnelViz)&&be.setFilters(s(s({},_e.filters),{},{display:P.i.FunnelViz,funnel_viz_type:jt})):Object(se.lb)(le,jt)||be.setFilters(s(s({},_e.filters),{},{display:jt}))}}}})},"./frontend/src/lib/components/CompareFilter/compareFilterLogic.ts":function(Oe,Q,n){"use strict";n.d(Q,"a",function(){return se});var Ne=n("./node_modules/core-js/modules/es.array.iterator.js"),he=n.n(Ne),Qe=n("./node_modules/core-js/modules/es.object.to-string.js"),Le=n.n(Qe),Ve=n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Yt=n.n(Ve),et=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),Me=n.n(et),e=n("./node_modules/kea/lib/index.esm.js"),g=n("./frontend/src/lib/utils.tsx"),it=n("./frontend/src/types.ts"),ye=n("./frontend/src/scenes/insights/sharedUtils.ts"),Ue=n("./frontend/src/scenes/insights/insightLogic.ts");function We(P,x){var O=Object.keys(P);if(Object.getOwnPropertySymbols){var ce=Object.getOwnPropertySymbols(P);x&&(ce=ce.filter(function(s){return Object.getOwnPropertyDescriptor(P,s).enumerable})),O.push.apply(O,ce)}return O}function ne(P){for(var x=1;x<arguments.length;x++){var O=arguments[x]!=null?arguments[x]:{};x%2?We(Object(O),!0).forEach(function(ce){Me()(P,ce,O[ce])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(O)):We(Object(O)).forEach(function(ce){Object.defineProperty(P,ce,Object.getOwnPropertyDescriptor(O,ce))})}return P}var se=Object(e.kea)({props:{},key:Object(ye.c)("new"),path:function(x){return["lib","components","CompareFilter","compareFilterLogic",x]},connect:function(x){return{actions:[Object(Ue.c)(x),["setFilters"]],values:[Object(Ue.c)(x),["filters","canEditInsight"]]}},actions:function(){return{setCompare:function(O){return{compare:O}},toggleCompare:!0}},selectors:{compare:[function(P){return[P.filters]},function(P){return!!(P!=null&&P.compare)}],disabled:[function(P){return[P.filters,P.canEditInsight]},function(P,x){var O=P.insight,ce=P.date_from,s=P.display;return!x||O===it.y.LIFECYCLE||s===it.i.WorldMap||ce==="all"}]},listeners:function(x){var O=x.values,ce=x.actions;return{setCompare:function(M){var z=M.compare;Object(g.lb)(z,O.compare)||ce.setFilters(ne(ne({},O.filters),{},{compare:z}))},toggleCompare:function(){ce.setCompare(!O.compare)}}}})},"./frontend/src/scenes/experiments/Experiment.tsx":function(Oe,Q,n){"use strict";n.r(Q),n.d(Q,"scene",function(){return dn}),n.d(Q,"Experiment",function(){return un}),n.d(Q,"CodeLanguageSelect",function(){return An});var Ne=n("./node_modules/core-js/modules/es.symbol.js"),he=n("./node_modules/core-js/modules/es.symbol.description.js"),Qe=n("./node_modules/core-js/modules/es.array.concat.js"),Le=n("./node_modules/core-js/modules/es.array.filter.js"),Ve=n("./node_modules/core-js/modules/es.array.map.js"),Yt=n("./node_modules/core-js/modules/es.array.reduce.js"),et=n("./node_modules/core-js/modules/es.function.name.js"),Me=n("./node_modules/core-js/modules/es.number.constructor.js"),e=n("./node_modules/core-js/modules/es.number.to-fixed.js"),g=n("./node_modules/core-js/modules/es.object.keys.js"),it=n("./node_modules/core-js/modules/es.object.to-string.js"),ye=n("./node_modules/core-js/modules/es.regexp.to-string.js"),Ue=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),We=n.n(Ue),ne=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),se=n.n(ne),P=n("./node_modules/antd/es/form/index.js"),x=n("./node_modules/antd/es/row/index.js"),O=n("./node_modules/antd/es/col/index.js"),ce=n("./node_modules/antd/es/input/index.js"),s=n("./node_modules/antd/es/tooltip/index.js"),M=n("./node_modules/antd/es/select/index.js"),z=n("./node_modules/antd/es/card/index.js"),xe=n("./node_modules/antd/es/tag/index.js"),H=n("./node_modules/antd/es/collapse/index.js"),be=n("./node_modules/antd/es/skeleton/index.js"),_e=n("./node_modules/antd/es/progress/index.js"),Ce=n("./node_modules/kea/lib/index.esm.js"),zt=n("./frontend/src/lib/components/PageHeader.tsx"),jt=n("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),en=n("./frontend/src/lib/components/PropertyFilters/utils.ts"),le=n("./frontend/src/lib/components/TaxonomicFilter/types.ts"),lt=n("./node_modules/react/index.js"),t=n.n(lt),tn=n("./frontend/src/scenes/funnels/funnelLogic.ts"),Pt=n("./frontend/src/scenes/insights/ActionFilter/ActionFilter.tsx"),wt=n("./frontend/src/scenes/insights/insightLogic.ts"),S=n("./frontend/src/types.ts"),On=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),Cn=n.n(On),nn=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/experiments/Experiment.scss"),jn=n.n(nn),St={};St.insert="head",St.singleton=!1;var Oa=Cn()(jn.a,St),Ca=jn.a.locals||{},Gn=n("./node_modules/core-js/modules/es.array.fill.js"),Jn=n("./node_modules/core-js/modules/es.array.find.js"),ja=n("./node_modules/core-js/modules/es.array.find-index.js"),$e=n("./node_modules/core-js/modules/es.array.iterator.js"),Sa=n("./node_modules/core-js/modules/es.array.splice.js"),Na=n("./node_modules/core-js/modules/es.number.epsilon.js"),Xn=n("./node_modules/core-js/modules/es.object.values.js"),Ta=n("./node_modules/core-js/modules/es.promise.js"),an=n("./node_modules/core-js/modules/es.string.iterator.js"),Ia=n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Qn=n("./node_modules/@babel/runtime/regenerator/index.js"),oe=n.n(Qn),Fa=n("./node_modules/regenerator-runtime/runtime.js"),$t=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),Fe=n.n($t),Zn=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),Ze=n.n(Zn),me=n("./frontend/src/lib/api.ts"),Ee=n("./frontend/src/lib/dayjs.ts"),vt=n("./frontend/src/scenes/insights/utils/cleanFilters.ts"),Sn=n("./frontend/src/scenes/teamLogic.ts"),gt=n("./frontend/src/scenes/urls.ts"),Lt=n("./node_modules/kea-router/lib/index.js"),Pa=n("./frontend/src/scenes/experiments/experimentsLogic.ts"),ht=n("./frontend/src/lib/constants.tsx"),Dt=n("./frontend/src/scenes/trends/trendsLogic.ts"),Mt=n("./frontend/src/lib/utils/eventUsageLogic.ts"),Ht=n("./frontend/src/scenes/userLogic.ts"),rn=n("./frontend/src/lib/components/Tooltip.tsx"),mt=n("./node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),Nn=n("./frontend/src/models/groupsModel.ts"),Ge=n("./frontend/src/lib/components/lemonToast.tsx");function qn(a,r){var i=Object.keys(a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(a);r&&(l=l.filter(function(v){return Object.getOwnPropertyDescriptor(a,v).enumerable})),i.push.apply(i,l)}return i}function K(a){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?qn(Object(i),!0).forEach(function(l){We()(a,l,i[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):qn(Object(i)).forEach(function(l){Object.defineProperty(a,l,Object.getOwnPropertyDescriptor(i,l))})}return a}var Rt=14,He=Object(Ce.kea)({props:{},key:function(r){return r.experimentId||"new"},path:function(r){return["scenes","experiment","experimentLogic",r]},connect:{values:[Sn.a,["currentTeamId"],Ht.a,["hasAvailableFeature"],Nn.a,["groupTypes","groupsTaxonomicTypes","aggregationLabel"]],actions:[Pa.a,["updateExperiments","addToExperiments"]]},actions:{setExperiment:function(r){return{experiment:r}},createExperiment:function(r,i,l){return{draft:r,runningTime:i,sampleSize:l}},setExperimentInsightId:function(r){return{shortId:r}},createNewExperimentInsight:function(r){return{filters:r}},setFilters:function(r){return{filters:r}},setNewExperimentData:function(r){return{experimentData:r}},updateExperimentGroup:function(r,i){return{variant:r,idx:i}},removeExperimentGroup:function(r){return{idx:r}},setExperimentInsightType:function(r){return{insightType:r}},setEditExperiment:function(r){return{editing:r}},setSecondaryMetrics:function(r){return{secondaryMetrics:r}},resetNewExperiment:!0,launchExperiment:!0,endExperiment:!0,addExperimentGroup:!0,archiveExperiment:!0},reducers:{newExperimentData:[null,{setNewExperimentData:function(r,i){var l=i.experimentData;if(l.filters){var v=K(K({},r==null?void 0:r.filters),l.filters);return K(K(K({},r),l),{},{filters:v})}if(l.parameters){var y=K(K({},r==null?void 0:r.parameters),l.parameters);return K(K(K({},r),l),{},{parameters:y})}return K(K({},r),l)},updateExperimentGroup:function(r,i){var l,v=i.variant,y=i.idx,E=Ze()((r==null||(l=r.parameters)===null||l===void 0?void 0:l.feature_flag_variants)||[]);return E[y]=K(K({},E[y]),v),K(K({},r),{},{parameters:K(K({},r==null?void 0:r.parameters),{},{feature_flag_variants:E})})},addExperimentGroup:function(r){var i;if(!(r==null||(i=r.parameters)===null||i===void 0)&&i.feature_flag_variants){var l=Tn(r.parameters.feature_flag_variants.length+1),v=r.parameters.feature_flag_variants.map(function(y,E){return K(K({},y),{},{rollout_percentage:l[E]})});return K(K({},r),{},{parameters:K(K({},r.parameters),{},{feature_flag_variants:[].concat(Ze()(v),[{key:"test_group_".concat(r.parameters.feature_flag_variants.length),rollout_percentage:l[l.length-1]}])})})}return r},removeExperimentGroup:function(r,i){var l,v,y=i.idx;if(!r)return r;var E=Ze()(((l=r.parameters)===null||l===void 0?void 0:l.feature_flag_variants)||[]);E.splice(y,1);var d=Tn(((r==null||(v=r.parameters)===null||v===void 0?void 0:v.feature_flag_variants)||[]).length-1),u=E.map(function(F,G){return K(K({},F),{},{rollout_percentage:d[G]})});return K(K({},r),{},{parameters:K(K({},r.parameters),{},{feature_flag_variants:u})})},setSecondaryMetrics:function(r,i){var l=i.secondaryMetrics,v=l.map(function(y){return y});return K(K({},r),{},{secondary_metrics:v})},resetNewExperiment:function(){return{parameters:{feature_flag_variants:[{key:"control",rollout_percentage:50},{key:"test",rollout_percentage:50}]}}}}],experimentInsightType:[S.y.TRENDS,{setExperimentInsightType:function(r,i){var l=i.insightType;return l}}],experimentInsightId:[null,{setExperimentInsightId:function(r,i){var l=i.shortId;return l}}],editingExistingExperiment:[!1,{setEditExperiment:function(r,i){var l=i.editing;return l}}]},listeners:function(r){var i=r.values,l=r.actions;return{createExperiment:function(){var v=Fe()(oe.a.mark(function E(d){var u,F,G,L,q,k,m,pe,Je,qe;return oe.a.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(F=d.draft,G=d.runningTime,L=d.sampleSize,q=null,k=!!i.experimentId&&i.experimentId!=="new",B.prev=3,!k){B.next=14;break}return B.next=7,me.b.update("api/projects/".concat(i.currentTeamId,"/experiments/").concat(i.experimentId),K(K({},i.newExperimentData),{},{parameters:K(K({},(m=i.newExperimentData)===null||m===void 0?void 0:m.parameters),{},{recommended_running_time:G,recommended_sample_size:L})},!F&&{start_date:Object(Ee.a)()}));case 7:if(q=B.sent,!(!((pe=q)===null||pe===void 0)&&pe.id)){B.next=12;break}return l.updateExperiments(q),Lt.router.actions.push(gt.a.experiment(q.id)),B.abrupt("return");case 12:B.next=18;break;case 14:return B.next=16,me.b.create("api/projects/".concat(i.currentTeamId,"/experiments"),K(K({},i.newExperimentData),{},{parameters:K(K({},(Je=i.newExperimentData)===null||Je===void 0?void 0:Je.parameters),{},{recommended_running_time:G,recommended_sample_size:L})},!F&&{start_date:Object(Ee.a)()}));case 16:q=B.sent,q&&Mt.f.actions.reportExperimentCreated(q);case 18:B.next=24;break;case 20:return B.prev=20,B.t0=B.catch(3),Ge.a.error(B.t0.detail||"Failed to create experiment"),B.abrupt("return");case 24:!((u=q)===null||u===void 0)&&u.id&&(qe=q.id,Lt.router.actions.push(gt.a.experiment(qe)),l.addToExperiments(q),Ge.a.success("Experiment ".concat(k?"updated":"created"),{button:{label:"View it",action:function(){Lt.router.actions.push(gt.a.experiment(qe))}}}));case 25:case"end":return B.stop()}},E,null,[[3,20]])}));function y(E){return v.apply(this,arguments)}return y}(),createNewExperimentInsight:function(){var v=Fe()(oe.a.mark(function E(d){var u,F,G,L;return oe.a.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return u=d.filters,i.experimentInsightType===S.y.FUNNELS?F=Object(vt.a)(K({insight:S.y.FUNNELS,funnel_viz_type:S.u.Steps,display:S.i.FunnelViz,date_from:Object(Ee.a)().subtract(Rt,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(Ee.a)().endOf("d").format("YYYY-MM-DDTHH:mm"),layout:ht.j.horizontal},u)):F=Object(vt.a)(K({insight:S.y.TRENDS,date_from:Object(Ee.a)().subtract(Rt,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(Ee.a)().endOf("d").format("YYYY-MM-DDTHH:mm")},u)),G={name:"",description:"",tags:[],filters:F,result:null},k.next=5,me.b.create("api/projects/".concat(i.currentTeamId,"/insights"),G);case 5:L=k.sent,l.setExperimentInsightId(L.short_id),l.setNewExperimentData({filters:K({},G.filters)});case 8:case"end":return k.stop()}},E)}));function y(E){return v.apply(this,arguments)}return y}(),setFilters:function(y){var E=y.filters;if(i.experimentInsightType===S.y.FUNNELS){var d;(d=tn.a.findMounted({dashboardItemId:i.experimentInsightId}))===null||d===void 0||d.actions.setFilters(E)}else{var u;(u=Dt.a.findMounted({dashboardItemId:i.experimentInsightId}))===null||u===void 0||u.actions.setFilters(E)}},loadExperimentSuccess:function(){var v=Fe()(oe.a.mark(function E(d){var u;return oe.a.wrap(function(G){for(;;)switch(G.prev=G.next){case 0:u=d.experimentData,u&&Mt.f.actions.reportExperimentViewed(u),l.setExperimentInsightType((u==null?void 0:u.filters.insight)||S.y.FUNNELS),u!=null&&u.start_date?(l.resetNewExperiment(),l.loadExperimentResults(),l.loadSecondaryMetricResults()):(l.setNewExperimentData(K({},u)),l.createNewExperimentInsight(u==null?void 0:u.filters));case 4:case"end":return G.stop()}},E)}));function y(E){return v.apply(this,arguments)}return y}(),launchExperiment:function(){var v=Fe()(oe.a.mark(function E(){var d;return oe.a.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:d=Object(Ee.a)(),l.updateExperiment({start_date:d.format("YYYY-MM-DDTHH:mm")}),i.experimentData&&Mt.f.actions.reportExperimentLaunched(i.experimentData,d);case 3:case"end":return F.stop()}},E)}));function y(){return v.apply(this,arguments)}return y}(),endExperiment:function(){var v=Fe()(oe.a.mark(function E(){var d,u,F;return oe.a.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:u=Object(Ee.a)(),l.updateExperiment({end_date:u.format("YYYY-MM-DDTHH:mm")}),F=u.diff((d=i.experimentData)===null||d===void 0?void 0:d.start_date,"second"),i.experimentData&&Mt.f.actions.reportExperimentCompleted(i.experimentData,u,F,i.areResultsSignificant);case 4:case"end":return L.stop()}},E)}));function y(){return v.apply(this,arguments)}return y}(),archiveExperiment:function(){var v=Fe()(oe.a.mark(function E(){return oe.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:l.updateExperiment({archived:!0}),i.experimentData&&Mt.f.actions.reportExperimentArchived(i.experimentData);case 2:case"end":return u.stop()}},E)}));function y(){return v.apply(this,arguments)}return y}(),setExperimentInsightType:function(){if(i.experimentId==="new"||i.editingExistingExperiment)l.createNewExperimentInsight();else{var y;l.createNewExperimentInsight((y=i.experimentData)===null||y===void 0?void 0:y.filters)}},updateExperimentSuccess:function(){var v=Fe()(oe.a.mark(function E(d){var u;return oe.a.wrap(function(G){for(;;)switch(G.prev=G.next){case 0:u=d.experimentData,l.updateExperiments(u);case 2:case"end":return G.stop()}},E)}));function y(E){return v.apply(this,arguments)}return y}()}},loaders:function(r){var i=r.values;return{experimentData:[null,{loadExperiment:function(){var l=Fe()(oe.a.mark(function y(){var E;return oe.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(i.experimentId&&i.experimentId!=="new")){u.next=16;break}return u.prev=1,u.next=4,me.b.get("api/projects/".concat(i.currentTeamId,"/experiments/").concat(i.experimentId));case 4:return E=u.sent,u.abrupt("return",E);case 8:if(u.prev=8,u.t0=u.catch(1),u.t0.status!==404){u.next=14;break}Lt.router.actions.push(gt.a.experiments()),u.next=16;break;case 14:throw Ge.a.error("Failed to load experiment ".concat(i.experimentId)),new Error("Failed to load experiment ".concat(i.experimentId));case 16:return u.abrupt("return",null);case 17:case"end":return u.stop()}},y,null,[[1,8]])}));function v(){return l.apply(this,arguments)}return v}(),updateExperiment:function(){var l=Fe()(oe.a.mark(function y(E){var d;return oe.a.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,me.b.update("api/projects/".concat(i.currentTeamId,"/experiments/").concat(i.experimentId),E);case 2:return d=F.sent,F.abrupt("return",d);case 4:case"end":return F.stop()}},y)}));function v(y){return l.apply(this,arguments)}return v}()}],experimentResults:[null,{loadExperimentResults:function(){var l=Fe()(oe.a.mark(function y(){var E;return oe.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,me.b.get("api/projects/".concat(i.currentTeamId,"/experiments/").concat(i.experimentId,"/results"));case 3:return E=u.sent,u.abrupt("return",K(K({},E),{},{itemID:Math.random().toString(36).substring(2,15)}));case 7:if(u.prev=7,u.t0=u.catch(0),u.t0.code!=="no_data"){u.next=11;break}return u.abrupt("return",null);case 11:return Ge.a.error(u.t0.detail||"Failed to load experiment results"),u.abrupt("return",null);case 13:case"end":return u.stop()}},y,null,[[0,7]])}));function v(){return l.apply(this,arguments)}return v}()}],secondaryMetricResults:[null,{loadSecondaryMetricResults:function(){var l=Fe()(oe.a.mark(function y(){var E;return oe.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all((((E=i.experimentData)===null||E===void 0?void 0:E.secondary_metrics)||[]).map(function(){var F=Fe()(oe.a.mark(function G(L,q){var k;return oe.a.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.prev=0,pe.next=3,me.b.get("api/projects/".concat(i.currentTeamId,"/experiments/").concat(i.experimentId,"/secondary_results?id=").concat(q));case 3:return k=pe.sent,pe.abrupt("return",k.result);case 7:return pe.prev=7,pe.t0=pe.catch(0),pe.abrupt("return",{});case 10:case"end":return pe.stop()}},G,null,[[0,7]])}));return function(G,L){return F.apply(this,arguments)}}()));case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},y)}));function v(){return l.apply(this,arguments)}return v}()}]}},selectors:{experimentId:[function(){return[function(a,r){var i;return(i=r.experimentId)!==null&&i!==void 0?i:"new"}]},function(a){return a}],breadcrumbs:[function(a){return[a.experimentData,a.experimentId]},function(a,r){return[{name:"Experiments",path:gt.a.experiments()},{name:(a==null?void 0:a.name)||"New",path:gt.a.experiment(r||"new")}]}],variants:[function(a){return[a.newExperimentData,a.experimentData]},function(a,r){var i,l;if(r!=null&&r.start_date){var v;return(r==null||(v=r.parameters)===null||v===void 0?void 0:v.feature_flag_variants)||[]}return(a==null||(i=a.parameters)===null||i===void 0?void 0:i.feature_flag_variants)||(r==null||(l=r.parameters)===null||l===void 0?void 0:l.feature_flag_variants)||[]}],taxonomicGroupTypesForSelection:[function(a){return[a.newExperimentData,a.groupsTaxonomicTypes]},function(a,r){var i;return(a==null||(i=a.filters)===null||i===void 0?void 0:i.aggregation_group_type_index)!=null&&r.length>0?[r[a.filters.aggregation_group_type_index]]:[le.a.PersonProperties,le.a.Cohorts]}],parsedSecondaryMetrics:[function(a){return[a.newExperimentData,a.experimentData]},function(a,r){var i=(a==null?void 0:a.secondary_metrics)||(r==null?void 0:r.secondary_metrics)||[];return i}],minimumDetectableChange:[function(a){return[a.newExperimentData]},function(a){var r;return(a==null||(r=a.parameters)===null||r===void 0?void 0:r.minimum_detectable_effect)||5}],minimumSampleSizePerVariant:[function(a){return[a.minimumDetectableChange]},function(a){return function(r){return Math.ceil(1600*r*(1-r/100)/(a*a))}}],areResultsSignificant:[function(a){return[a.experimentResults]},function(a){return(a==null?void 0:a.significant)||!1}],significanceBannerDetails:[function(a){return[a.experimentResults]},function(a){if((a==null?void 0:a.significance_code)===S.M.HighLoss){var r;return t.a.createElement(t.a.Fragment,null,"This is because the expected loss in conversion is greater than 1%",t.a.createElement(rn.a,{placement:"right",title:t.a.createElement(t.a.Fragment,null,"Current value is ",(r=((a==null?void 0:a.expected_loss)||0)*100)===null||r===void 0?void 0:r.toFixed(2),"%")},t.a.createElement(mt.a,{style:{padding:"4px 2px"}})),".")}if((a==null?void 0:a.significance_code)===S.M.HighPValue){var i;return t.a.createElement(t.a.Fragment,null,"This is because the p value is greater than 0.05",t.a.createElement(rn.a,{placement:"right",title:t.a.createElement(t.a.Fragment,null,"Current value is ",(a==null||(i=a.p_value)===null||i===void 0?void 0:i.toFixed(3))||1,".")},t.a.createElement(mt.a,{style:{padding:"4px 2px"}})),".")}return(a==null?void 0:a.significance_code)===S.M.LowWinProbability?"This is because the win probability of all test variants combined is less than 90%.":(a==null?void 0:a.significance_code)===S.M.NotEnoughExposure?"This is because we need at least 100 people per variant to declare significance.":""}],recommendedExposureForCountData:[function(a){return[a.minimumDetectableChange]},function(a){return function(r){var i=r*a/100,l=r,v=i+r;return parseFloat((4/Math.pow(Math.sqrt(l/Rt)-Math.sqrt(v/Rt),2)).toFixed(1))}}],expectedRunningTime:[function(){return[]},function(){return function(a,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Rt;return parseFloat((r/(a/i)).toFixed(1))}}],conversionRateForVariant:[function(a){return[a.experimentResults]},function(a){return function(r){var i="Can't find variant";if(!a)return i;var l=(a==null?void 0:a.insight).find(function(v){var y,E;return((y=v[0])===null||y===void 0||(E=y.breakdown_value)===null||E===void 0?void 0:E[0])===r});return l?(l[l.length-1].count/l[0].count*100).toFixed(1):i}}],getIndexForVariant:[function(a){return[a.experimentResults]},function(a){return function(r,i){if(!a)return 0;var l=-1;return i===S.y.FUNNELS?l=Ze()(a==null?void 0:a.insight).sort(function(v,y){var E,d;return((E=y[0])===null||E===void 0?void 0:E.count)-((d=v[0])===null||d===void 0?void 0:d.count)}).findIndex(function(v){var y,E;return((y=v[0])===null||y===void 0||(E=y.breakdown_value)===null||E===void 0?void 0:E[0])===r}):l=(a==null?void 0:a.insight).findIndex(function(v){return v.breakdown_value===r}),l===-1?0:l}}],countDataForVariant:[function(a){return[a.experimentResults]},function(a){return function(r){var i="Can't find variant";if(!a)return i;var l=(a==null?void 0:a.insight).find(function(v){return v.breakdown_value===r});return l?l.count.toString():i}}],highestProbabilityVariant:[function(a){return[a.experimentResults]},function(a){if(a){var r=Math.max.apply(Math,Ze()(Object.values(a.probability)));return Object.keys(a.probability).find(function(i){return Math.abs(a.probability[i]-r)<Number.EPSILON})}}],areTrendResultsConfusing:[function(a){return[a.experimentResults,a.highestProbabilityVariant]},function(a,r){if(!a)return!1;var i=(a==null?void 0:a.insight).reduce(function(l,v){return v.count>l.count?v:l},{count:0,breakdown_value:""});return i.count?i.breakdown_value!==r:!1}]},urlToAction:function(r){var i=r.actions,l=r.values;return{"/experiments/:id":function(y,E,d,u,F){var G=y.id;if(!l.hasAvailableFeature(S.d.EXPERIMENTATION)){Lt.router.actions.push("/experiments");return}var L=u.initial||u.pathname!==(F==null?void 0:F.pathname);if(G&&L){var q=G==="new"?"new":parseInt(G);q==="new"&&(i.createNewExperimentInsight(),i.resetNewExperiment(),i.setSecondaryMetrics([])),i.setEditExperiment(!1),q!=="new"&&q===l.experimentId&&i.loadExperiment()}}}}});function Tn(a){var r=Math.round(100/a),i=r*a,l=i-100,v=new Array(a).fill(r);return v[a-1]=r-l,v}var At=n("./frontend/src/scenes/insights/InsightContainer.tsx"),st=n("./frontend/src/lib/components/icons.tsx"),In=n("./node_modules/@ant-design/icons/es/icons/ExclamationCircleFilled.js"),Gt=n("./node_modules/@ant-design/icons/es/icons/CaretDownOutlined.js"),ln=n("./node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),Jt=n("./frontend/src/lib/components/CopyToClipboard.tsx"),Te=n("./frontend/src/lib/utils.tsx"),ot=n("./frontend/src/scenes/funnels/funnelUtils.ts"),pt=n("./node_modules/antd/es/modal/index.js"),ea=n("./node_modules/antd/es/button/index.js"),ta=n("./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js");function Fn(a,r){var i=Object.keys(a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(a);r&&(l=l.filter(function(v){return Object.getOwnPropertyDescriptor(a,v).enumerable})),i.push.apply(i,l)}return i}function Et(a){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?Fn(Object(i),!0).forEach(function(l){We()(a,l,i[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):Fn(Object(i)).forEach(function(l){Object.defineProperty(a,l,Object.getOwnPropertyDescriptor(i,l))})}return a}var Pn=14,Nt={name:"",filters:{insight:S.y.TRENDS,events:[{id:"$pageview",name:"$pageview",type:"events",order:0}]}},yt={name:"",filters:{insight:S.y.FUNNELS,events:[{id:"$pageview",name:"$pageview",type:"events",order:0}],layout:ht.j.horizontal}},na=Object(Ce.kea)({props:{},path:["scenes","experiment","secondaryMetricsLogic"],connect:{values:[Sn.a,["currentTeamId"]]},actions:{setSecondaryMetrics:function(r){return{secondaryMetrics:r}},createNewMetric:!0,addNewMetric:function(r){return{metric:r}},updateMetricFilters:function(r){return{filters:r}},setFilters:function(r){return{filters:r}},setPreviewInsightId:function(r){return{shortId:r}},createPreviewInsight:function(r){return{filters:r}},showModal:!0,hideModal:!1,changeInsightType:function(r){return{type:r}},setCurrentMetricName:function(r){return{name:r}},deleteMetric:function(r){return{metricId:r}}},loaders:function(r){var i=r.values;return{experiments:[[],{loadExperiments:function(){var l=Fe()(oe.a.mark(function y(){var E;return oe.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,me.b.get("api/projects/".concat(i.currentTeamId,"/experiments"));case 2:return E=u.sent,u.abrupt("return",E.results);case 4:case"end":return u.stop()}},y)}));function v(){return l.apply(this,arguments)}return v}()}]}},reducers:function(r){var i=r.props;return{previewInsightId:[null,{setPreviewInsightId:function(v,y){var E=y.shortId;return E}}],metrics:[i.initialMetrics,{addNewMetric:function(v,y){var E=y.metric;return[].concat(Ze()(v),[Et({},E)])},deleteMetric:function(v,y){var E=y.metricId;return v.filter(function(d,u){return u!==E})}}],modalVisible:[!1,{showModal:function(){return!0},hideModal:function(){return!1}}],currentMetricName:["",{setCurrentMetricName:function(v,y){var E=y.name;return E}}],currentMetric:[Nt,{changeInsightType:function(v,y){var E=y.type;return E===S.y.TRENDS?Nt:v.filters.insight===S.y.TRENDS?yt:Nt},updateMetricFilters:function(v,y){var E=y.filters;return Et(Et({},v),{},{filters:E})}}]}},listeners:function(r){var i=r.actions,l=r.values,v=r.props;return{createPreviewInsight:function(){var y=Fe()(oe.a.mark(function d(u){var F,G,L,q;return oe.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return F=u.filters,(F==null?void 0:F.insight)===S.y.FUNNELS?G=Object(vt.a)(Et({insight:S.y.FUNNELS,funnel_viz_type:S.u.Steps,display:S.i.FunnelViz,date_from:Object(Ee.a)().subtract(Pn,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(Ee.a)().endOf("d").format("YYYY-MM-DDTHH:mm"),layout:ht.j.horizontal},F)):G=Object(vt.a)(Et({insight:S.y.TRENDS,date_from:Object(Ee.a)().subtract(Pn,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(Ee.a)().endOf("d").format("YYYY-MM-DDTHH:mm")},F)),L={description:"",tags:[],filters:G,result:null},m.next=5,me.b.create("api/projects/".concat(Sn.a.values.currentTeamId,"/insights"),L);case 5:q=m.sent,i.setPreviewInsightId(q.short_id);case 7:case"end":return m.stop()}},d)}));function E(d){return y.apply(this,arguments)}return E}(),setFilters:function(E){var d=E.filters;if(d.insight===S.y.FUNNELS){var u;(u=tn.a.findMounted({dashboardItemId:l.previewInsightId}))===null||u===void 0||u.actions.setFilters(d)}else{var F;(F=Dt.a.findMounted({dashboardItemId:l.previewInsightId}))===null||F===void 0||F.actions.setFilters(d)}},createNewMetric:function(){i.addNewMetric(Et(Et({},l.currentMetric),{},{name:l.currentMetricName})),v.onMetricsChange(l.metrics),i.changeInsightType(S.y.TRENDS),i.setCurrentMetricName("")},deleteMetric:function(){v.onMetricsChange(l.metrics)},changeInsightType:function(){return i.createPreviewInsight(l.currentMetric.filters)}}},events:function(r){var i=r.actions;return{afterMount:function(){i.createPreviewInsight()}}}}),ke=n("./frontend/src/lib/components/LemonButton/index.ts"),sn=n("./frontend/src/scenes/insights/ActionFilter/ActionFilterRow/ActionFilterRow.tsx");function on(a,r){var i=Object.keys(a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(a);r&&(l=l.filter(function(v){return Object.getOwnPropertyDescriptor(a,v).enumerable})),i.push.apply(i,l)}return i}function tt(a){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?on(Object(i),!0).forEach(function(l){We()(a,l,i[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):on(Object(i)).forEach(function(l){Object.defineProperty(a,l,Object.getOwnPropertyDescriptor(i,l))})}return a}function cn(a){var r=a.onMetricsChange,i=a.initialMetrics,l=na({onMetricsChange:r,initialMetrics:i}),v=Object(Ce.useValues)(l),y=v.previewInsightId,E=v.metrics,d=v.modalVisible,u=v.currentMetric,F=Object(Ce.useActions)(l),G=F.createNewMetric,L=F.updateMetricFilters,q=F.setFilters,k=F.showModal,m=F.hideModal,pe=F.changeInsightType,Je=F.setCurrentMetricName,qe=F.deleteMetric,xt=Object(Ce.useValues)(Object(wt.c)({dashboardItemId:y,syncWithUrl:!1})),B=xt.insightProps,Ot=Object(Ce.useValues)(Object(tn.a)(B)),nt=Ot.isStepsEmpty,fe=Ot.filterSteps;return t.a.createElement(t.a.Fragment,null,t.a.createElement(pt.a,{title:"Add secondary metric",visible:d,destroyOnClose:!0,onCancel:m,footer:null,style:{minWidth:600}},t.a.createElement(P.a,{layout:"vertical",initialValues:{type:S.y.TRENDS},onValuesChange:function(Pe){Pe.name&&Je(Pe.name)},onFinish:function(){G(),m()},scrollToFirstError:!0,requiredMark:!1},t.a.createElement(P.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"You have to enter a name."}]},t.a.createElement(ce.a,null)),t.a.createElement(P.a.Item,{name:"type",label:"Type"},t.a.createElement(M.a,{style:{display:"flex"},value:u.filters.insight,onChange:function(){pe()},suffixIcon:t.a.createElement(Gt.a,null),dropdownMatchSelectWidth:!1},t.a.createElement(M.a.Option,{value:S.y.TRENDS},t.a.createElement(O.a,null,t.a.createElement("span",null,t.a.createElement("b",null,"Trend")))),t.a.createElement(M.a.Option,{value:S.y.FUNNELS},t.a.createElement(O.a,null,t.a.createElement("span",null,t.a.createElement("b",null,"Conversion funnel")))))),t.a.createElement(P.a.Item,{name:"query",label:"Query"},t.a.createElement(z.a,{className:"action-filters-bordered",style:{width:"100%",marginRight:8},bodyStyle:{padding:0}},u.filters.insight===S.y.FUNNELS&&t.a.createElement(Pt.a,{filters:u.filters,setFilters:function(Pe){var Re=tt(tt({},u.filters),{},{insight:S.y.FUNNELS},Pe);L(Re),q(Re)},typeKey:"funnel-preview-metric",mathAvailability:sn.b.None,hideDeleteBtn:fe.length===1,buttonCopy:"Add funnel step",showSeriesIndicator:!nt,seriesIndicatorType:"numeric",fullWidth:!0,sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[le.a.EventProperties,le.a.PersonProperties,le.a.Cohorts,le.a.Elements],rowClassName:"action-filters-bordered"}),u.filters.insight===S.y.TRENDS&&t.a.createElement(Pt.a,{entitiesLimit:1,horizontalUI:!0,filters:u.filters,setFilters:function(Pe){var Re=tt(tt({},u.filters),{},{insight:S.y.TRENDS},Pe);L(Re),q(Re)},typeKey:"trend-preview-metric",buttonCopy:"Add graph series",showSeriesIndicator:!0,propertiesTaxonomicGroupTypes:[le.a.EventProperties,le.a.PersonProperties,le.a.Cohorts,le.a.Elements]}))),t.a.createElement(P.a.Item,{name:"metric-preview",label:"Metric preview"},t.a.createElement(Ce.BindLogic,{logic:wt.c,props:B},t.a.createElement(At.a,{disableHeader:!0,disableTable:!0}))),t.a.createElement(x.a,{justify:"end"},t.a.createElement(ke.a,{type:"secondary",className:"mr-05",onClick:function(){return m()}},"Cancel"),t.a.createElement(ke.a,{type:"primary",htmlType:"submit"},"Save")))),t.a.createElement(x.a,null,t.a.createElement(O.a,null,E.map(function(ae,Pe){return t.a.createElement(x.a,{key:Pe,className:"mt"},t.a.createElement(x.a,{align:"middle",className:"full-width border-all",style:{padding:8}},t.a.createElement("div",{style:{fontWeight:500}},"Name")," ",t.a.createElement("div",{className:"metric-name"},ae.name),t.a.createElement(ta.a,{className:"text-danger",style:{padding:8},onClick:function(){return qe(Pe)}})),t.a.createElement(z.a,{className:"full-width",style:{borderTop:"none"},bodyStyle:{padding:0}},ae.filters.insight===S.y.FUNNELS&&t.a.createElement(Pt.a,{filters:ae.filters,setFilters:function(ft){var ve=tt(tt({},ae.filters),{},{insight:S.y.FUNNELS},ft);L(ve),q(ve)},typeKey:"funnel-preview-".concat(Pe),mathAvailability:sn.b.None,hideDeleteBtn:fe.length===1,buttonCopy:"Add funnel step",showSeriesIndicator:!nt,seriesIndicatorType:"numeric",fullWidth:!0,sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[le.a.EventProperties,le.a.PersonProperties,le.a.Cohorts,le.a.Elements],rowClassName:"action-filters-bordered",readOnly:!0}),ae.filters.insight===S.y.TRENDS&&t.a.createElement(Pt.a,{horizontalUI:!0,filters:ae.filters,setFilters:function(ft){var ve=tt(tt({},ae.filters),{},{insight:S.y.TRENDS},ft);L(ve),q(ve)},typeKey:"trend-preview-".concat(Pe),buttonCopy:"Add graph series",showSeriesIndicator:!0,entitiesLimit:1,propertiesTaxonomicGroupTypes:[le.a.EventProperties,le.a.PersonProperties,le.a.Cohorts,le.a.Elements],readOnly:!0})))}),E&&!(E.length>2)&&t.a.createElement(O.a,null,t.a.createElement("div",{className:"mb-05 mt"},t.a.createElement(ea.a,{style:{color:"var(--primary)",minWidth:240},onClick:k},"Add metric"))))))}try{cn.displayName="SecondaryMetrics",cn.__docgenInfo={description:"",displayName:"SecondaryMetrics",props:{onMetricsChange:{defaultValue:null,description:"",name:"onMetricsChange",required:!0,type:{name:"(metrics: SecondaryExperimentMetric[]) => void"}},initialMetrics:{defaultValue:null,description:"",name:"initialMetrics",required:!0,type:{name:"SecondaryExperimentMetric[]"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/SecondaryMetrics.tsx#SecondaryMetrics"]={docgenInfo:cn.__docgenInfo,name:"SecondaryMetrics",path:"frontend/src/scenes/experiments/SecondaryMetrics.tsx#SecondaryMetrics"})}catch(a){}var aa=n("./frontend/src/lib/colors.ts"),Tt=n("./frontend/src/lib/components/EntityFilterInfo.tsx"),wa=n("./frontend/src/lib/components/EditableField/EditableField.tsx"),wn=n("./frontend/src/lib/components/Link.tsx"),Ln=n("./frontend/src/lib/logic/featureFlagLogic.ts"),ra=n("./node_modules/antd/es/slider/index.js"),ia=n("./node_modules/antd/es/input-number/index.js"),Dn=n("./frontend/src/lib/components/InsightLabel/index.tsx"),Mn=n("./frontend/src/lib/components/PropertyFilters/components/PropertyFilterButton.tsx");function Rn(){var a=Object(lt.useState)(!1),r=se()(a,2),i=r[0],l=r[1],v=Object(lt.useState)(!1),y=se()(v,2),E=y[0],d=y[1];return t.a.createElement(z.a,{className:"experiment-workflow",title:t.a.createElement("span",{className:"card-secondary"},"Experiment workflow")},t.a.createElement(x.a,null,t.a.createElement(O.a,{className:"exp-workflow-step step-completed full-width"},t.a.createElement(x.a,{align:"middle"},t.a.createElement(st.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}),t.a.createElement("b",{className:"ml-05"},"Create experiment")),t.a.createElement("div",{className:"ml-2"},"Set variants, select participants, and add secondary metrics"))),t.a.createElement(x.a,null,t.a.createElement(O.a,{className:"full-width exp-workflow-step ".concat(i?"step-completed":""),onClick:function(){return l(!i)}},t.a.createElement(x.a,{align:"middle"},i?t.a.createElement(st.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}):t.a.createElement(st.IconRadioButtonUnchecked,null),t.a.createElement("b",{className:"ml-05"},"Validate experiment")),t.a.createElement("div",{className:"ml-2"},"Once you've written your code, it's a good idea to test that each variant behaves as you'd expect."))),t.a.createElement(x.a,null,t.a.createElement(O.a,{className:"full-width exp-workflow-step ".concat(E?"step-completed":""),onClick:function(){return d(!E)}},t.a.createElement(x.a,{align:"middle"},E?t.a.createElement(st.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}):t.a.createElement(st.IconRadioButtonUnchecked,null),t.a.createElement("b",{className:"ml-05"},"Launch experiment")),t.a.createElement("div",{className:"ml-2"},"Run your experiment, monitor results, and decide when to terminate your experiment."))))}function bt(a){var r,i,l,v,y,E,d=a.experiment,u=a.trendCount,F=a.funnelConversionRate,G=a.trendExposure,L=a.funnelSampleSize,q=a.funnelEntrants,k=(d==null?void 0:d.id)||"new",m=Object(Ce.useValues)(He({experimentId:k})),pe=m.experimentInsightType,Je=m.editingExistingExperiment,qe=m.minimumDetectableChange,xt=m.expectedRunningTime,B=m.aggregationLabel,Ot=Object(Ce.useActions)(He({experimentId:k})),nt=Ot.setNewExperimentData,fe=pe===S.y.FUNNELS&&100-F<50?100-F:50,ae=Object(Ee.a)().diff(Object(Ee.a)(d==null?void 0:d.start_date),"hour"),Pe=0;d!=null&&d.start_date?Pe=xt(q||1,L||0,ae):Pe=xt(q||1,L||0);var Re=Object(Ee.a)(d==null?void 0:d.start_date).add(Pe,"hour"),ft=!(d!=null&&d.end_date)&&ae>=24&&q&&L,ve=Object(Te.r)(d==null||(r=d.filters)===null||r===void 0?void 0:r.properties);return t.a.createElement(x.a,null,t.a.createElement(O.a,{span:!(d!=null&&d.start_date)&&k!=="new"&&!Je?12:24},k==="new"&&t.a.createElement(x.a,{className:"experiment-preview-row"},t.a.createElement("div",null,t.a.createElement("div",null,t.a.createElement("b",null,"Experiment preview")),t.a.createElement("div",{className:"text-muted"},"Here are the baseline metrics for your experiment. Adjust your minimum detectible threshold to adjust for the smallest conversion value you\u2019ll accept, and the experiment duration."," "))),(k==="new"||Je)&&t.a.createElement(x.a,{className:"mb"},t.a.createElement(O.a,{span:24},t.a.createElement("div",null,t.a.createElement("b",null,"Minimum acceptable improvement"),t.a.createElement(s.a,{title:"Minimum acceptable improvement is a calculation that estimates the smallest significant improvement you are willing to accept."},t.a.createElement(mt.a,{style:{marginLeft:4}}))),t.a.createElement(x.a,{className:"mde-slider"},t.a.createElement(O.a,{span:8},t.a.createElement(ra.a,{defaultValue:5,value:qe,min:1,max:fe,trackStyle:{background:"var(--primary)"},handleStyle:{background:"var(--primary)"},onChange:function(we){nt({parameters:{minimum_detectable_effect:we}})},tipFormatter:function(we){return"".concat(we,"%")}})),t.a.createElement(ia.a,{min:1,max:fe,defaultValue:5,formatter:function(we){return"".concat(we,"%")},style:{margin:"0 16px"},value:qe,onChange:function(we){nt({parameters:{minimum_detectable_effect:we}})}})))),t.a.createElement(x.a,{className:"experiment-preview-row ".concat(d!=null&&d.start_date?"mr":"")},pe===S.y.TRENDS?t.a.createElement(t.a.Fragment,null,!(d!=null&&d.start_date)&&t.a.createElement(t.a.Fragment,null,t.a.createElement(O.a,{span:6},t.a.createElement("div",{className:"card-secondary"},"Baseline Count"),t.a.createElement("div",{className:"l4"},Object(Te.N)(u||0))),t.a.createElement(O.a,{span:6},t.a.createElement("div",{className:"card-secondary"},"Minimum Acceptable Count"),t.a.createElement("div",{className:"l4"},Object(Te.N)(u+Math.ceil(u*(qe/100))||0)))),t.a.createElement(O.a,{span:12},t.a.createElement("div",{className:"card-secondary"},"Recommended running time"),t.a.createElement("div",null,t.a.createElement("span",{className:"l4"},"~",Object(Te.N)(G||0))," days"))):t.a.createElement(t.a.Fragment,null,!(d!=null&&d.start_date)&&t.a.createElement(t.a.Fragment,null,t.a.createElement(O.a,{span:12},t.a.createElement("div",{className:"card-secondary"},"Baseline Conversion Rate"),t.a.createElement("div",{className:"l4"},F.toFixed(1),"%")),t.a.createElement(O.a,{span:12},t.a.createElement("div",{className:"card-secondary"},"Minimum Acceptable Conversion Rate"),t.a.createElement("div",{className:"l4"},(F+qe).toFixed(1),"%"))),t.a.createElement(O.a,{span:12},t.a.createElement("div",{className:"card-secondary"},"Recommended Sample Size"),t.a.createElement("div",{className:"pb"},t.a.createElement("span",{className:"l4"},"~",Object(Te.N)(L||0))," persons")),!(d!=null&&d.start_date)&&t.a.createElement(O.a,{span:12},t.a.createElement("div",{className:"card-secondary"},"Recommended running time"),t.a.createElement("div",null,t.a.createElement("span",{className:"l4"},"~",Object(Te.N)(Pe||0))," days"))),t.a.createElement(x.a,{className:"full-width mt"},t.a.createElement(O.a,{span:12},t.a.createElement("div",{className:"card-secondary"},"Experiment variants"),t.a.createElement("ul",{className:"variants-list"},d==null||(i=d.parameters)===null||i===void 0||(l=i.feature_flag_variants)===null||l===void 0?void 0:l.map(function(Be,we){return t.a.createElement("li",{key:we},Be.key)}))),t.a.createElement(O.a,{span:12},t.a.createElement("div",{className:"card-secondary"},"Participants"),t.a.createElement("div",null,ve!=null&&ve.length?t.a.createElement("div",null,ve==null?void 0:ve.map(function(Be){return t.a.createElement(Mn.c,{key:Be.key,item:Be,style:{margin:2,cursor:"default"}})})):t.a.createElement(t.a.Fragment,null,"100% of"," ",(d==null||(v=d.filters)===null||v===void 0?void 0:v.aggregation_group_type_index)!=null?Object(Te.i)(B(d.filters.aggregation_group_type_index).plural):"users")))),t.a.createElement(x.a,{className:"full-width"},k!=="new"&&!Je&&t.a.createElement(O.a,{span:12},t.a.createElement("div",{className:"card-secondary mt"},"Start date"),d!=null&&d.start_date?t.a.createElement("span",null,Object(Ee.a)(d==null?void 0:d.start_date).format("D MMM YYYY")):t.a.createElement("span",{className:"description"},"Not started yet")),pe===S.y.FUNNELS&&ft?t.a.createElement(O.a,{span:12},t.a.createElement("div",{className:"card-secondary mt"},"Expected end date"),t.a.createElement("span",null,Re.isAfter(Object(Ee.a)())?Re.format("D MMM YYYY"):Object(Ee.a)().format("D MMM YYYY"))):null,(d==null?void 0:d.end_date)&&t.a.createElement(O.a,{span:12},t.a.createElement("div",{className:"card-secondary mt"},"Completed date"),t.a.createElement("span",null,Object(Ee.a)(d==null?void 0:d.end_date).format("D MMM YYYY"))))),k!=="new"&&!Je&&t.a.createElement(x.a,{className:"experiment-preview-row"},t.a.createElement(O.a,null,t.a.createElement("div",{className:"card-secondary mb-05"},pe===S.y.FUNNELS?"Conversion goal steps":"Trend goal"),[].concat(Ze()((d==null||(y=d.filters)===null||y===void 0?void 0:y.events)||[]),Ze()((d==null||(E=d.filters)===null||E===void 0?void 0:E.actions)||[])).sort(function(Be,we){return(Be.order||0)-(we.order||0)}).map(function(Be,we){var at;return t.a.createElement(O.a,{key:we,className:"mb-05"},t.a.createElement(x.a,{style:{marginBottom:4}},t.a.createElement("div",{className:"preview-conversion-goal-num"},pe===S.y.FUNNELS?(Be.order||0)+1:we+1),t.a.createElement("b",null,t.a.createElement(Dn.b,{action:Be,showCountedByTag:pe===S.y.TRENDS,hideIcon:!0}))),(at=Be.properties)===null||at===void 0?void 0:at.map(function(ut){return t.a.createElement(Mn.c,{key:ut.key,item:ut})}))})))),k!=="new"&&!Je&&!(d!=null&&d.start_date)&&t.a.createElement(O.a,{span:12,className:"pl"},t.a.createElement(Rn,null)))}try{bt.displayName="ExperimentPreview",bt.__docgenInfo={description:"",displayName:"ExperimentPreview",props:{experiment:{defaultValue:null,description:"",name:"experiment",required:!0,type:{name:"Partial<Experiment> | null"}},trendCount:{defaultValue:null,description:"",name:"trendCount",required:!0,type:{name:"number"}},trendExposure:{defaultValue:null,description:"",name:"trendExposure",required:!1,type:{name:"number"}},funnelSampleSize:{defaultValue:null,description:"",name:"funnelSampleSize",required:!1,type:{name:"number"}},funnelConversionRate:{defaultValue:null,description:"",name:"funnelConversionRate",required:!0,type:{name:"number"}},funnelEntrants:{defaultValue:null,description:"",name:"funnelEntrants",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentPreview.tsx#ExperimentPreview"]={docgenInfo:bt.__docgenInfo,name:"ExperimentPreview",path:"frontend/src/scenes/experiments/ExperimentPreview.tsx#ExperimentPreview"})}catch(a){}var Xt=n("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx");function ct(a){var r,i,l,v=a.experiment,y=Object(lt.useState)("control"),E=se()(y,2),d=E[0],u=E[1];return t.a.createElement(z.a,{title:t.a.createElement("span",{className:"card-secondary"},"Feature flag usage and implementation"),className:"experiment-implementation-details"},t.a.createElement(x.a,{justify:"space-between",className:"mb-05"},t.a.createElement("div",null,t.a.createElement("span",{className:"mr-05"},"Variant group"),t.a.createElement(M.a,{onChange:u,defaultValue:"control",suffixIcon:t.a.createElement(Gt.a,null)},v==null||(r=v.parameters)===null||r===void 0||(i=r.feature_flag_variants)===null||i===void 0?void 0:i.map(function(F,G){return t.a.createElement(M.a.Option,{key:G,value:F.key},F.key)}))),t.a.createElement("div",null,t.a.createElement(An,null))),t.a.createElement("b",null,"Implement your experiment in code"),t.a.createElement(Xt.a,{language:Xt.b.JavaScript,wrap:!0},"if (posthog.getFeatureFlag('".concat((l=v==null?void 0:v.feature_flag_key)!==null&&l!==void 0?l:"","') === '").concat(d,`') {
    // where '`).concat(d,`' is the variant, run your code here
}`)),t.a.createElement("b",null,"Test that it works"),t.a.createElement(Xt.a,{language:Xt.b.JavaScript},"posthog.feature_flags.override({'".concat(v==null?void 0:v.feature_flag_key,"': '").concat(d,"'})")),t.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://posthog.com/docs/user-guides/feature-flags"},t.a.createElement(x.a,{align:"middle"},"Experiment implementation guide",t.a.createElement(st.IconOpenInNew,{className:"ml-05"}))))}try{ct.displayName="ExperimentImplementationDetails",ct.__docgenInfo={description:"",displayName:"ExperimentImplementationDetails",props:{experiment:{defaultValue:null,description:"",name:"experiment",required:!0,type:{name:"Partial<Experiment> | null"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#ExperimentImplementationDetails"]={docgenInfo:ct.__docgenInfo,name:"ExperimentImplementationDetails",path:"frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#ExperimentImplementationDetails"})}catch(a){}function Vt(a,r){var i=Object.keys(a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(a);r&&(l=l.filter(function(v){return Object.getOwnPropertyDescriptor(a,v).enumerable})),i.push.apply(i,l)}return i}function dt(a){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?Vt(Object(i),!0).forEach(function(l){We()(a,l,i[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):Vt(Object(i)).forEach(function(l){Object.defineProperty(a,l,Object.getOwnPropertyDescriptor(i,l))})}return a}var dn={component:un,logic:He,paramsToProps:function(r){var i=r.params.id;return{experimentId:i==="new"?"new":parseInt(i)}}};function un(){var a,r,i,l,v,y,E,d,u,F,G,L=Object(Ce.useValues)(He),q=L.experimentId,k=L.newExperimentData,m=L.experimentData,pe=L.experimentInsightId,Je=L.minimumSampleSizePerVariant,qe=L.recommendedExposureForCountData,xt=L.variants,B=L.experimentResults,Ot=L.countDataForVariant,nt=L.editingExistingExperiment,fe=L.experimentInsightType,ae=L.experimentResultsLoading,Pe=L.parsedSecondaryMetrics,Re=L.areResultsSignificant,ft=L.conversionRateForVariant,ve=L.getIndexForVariant,Be=L.significanceBannerDetails,we=L.areTrendResultsConfusing,at=L.taxonomicGroupTypesForSelection,ut=L.groupTypes,la=L.aggregationLabel,rt=L.secondaryMetricResults,mn=L.experimentDataLoading,La=L.secondaryMetricResultsLoading,Xe=Object(Ce.useActions)(He),_t=Xe.setNewExperimentData,kt=Xe.createExperiment,Ct=Xe.launchExperiment,Bt=Xe.setFilters,sa=Xe.setEditExperiment,Vn=Xe.endExperiment,oa=Xe.addExperimentGroup,ca=Xe.updateExperiment,da=Xe.updateExperimentGroup,_n=Xe.removeExperimentGroup,pn=Xe.setSecondaryMetrics,Da=Xe.setExperimentInsightType,Ma=Xe.archiveExperiment,ua=Object(Ce.useValues)(Ln.a),Qt=ua.featureFlags,ma=P.a.useForm(),pa=se()(ma,1),fa=pa[0],kn=Object(lt.useState)(!0),Bn=se()(kn,2),fn=Bn[0],vn=Bn[1],Kn=Object(Ce.useValues)(Object(wt.c)({dashboardItemId:pe})),gn=Kn.insightProps,Kt=Object(Ce.useValues)(Object(tn.a)(gn)),va=Kt.isStepsEmpty,Ra=Kt.filterSteps,Un=Kt.filters,Zt=Kt.results,hn=Kt.conversionMetrics,ga=Object(Ce.useValues)(Object(Dt.a)(gn)),Wn=ga.filters,ha=ga.results,En=hn.totalRate*100,yn=Je(En),Yn=yn*xt.length,bn=(a=ha[0])===null||a===void 0?void 0:a.count,Ea=Zt==null||(r=Zt[0])===null||r===void 0?void 0:r.count,ya=qe(bn),Ut=Math.floor(24/(xt.length+2)),xn=fe===S.y.FUNNELS&&(B==null?void 0:B.insight)?B.insight.reduce(function(V,R){var Ae;return((Ae=R[0])===null||Ae===void 0?void 0:Ae.count)+V},0):0,Aa=fe===S.y.FUNNELS?(xn||0)/((m==null||(i=m.parameters)===null||i===void 0?void 0:i.recommended_sample_size)||1)*100:Object(Ee.a)().diff(m==null?void 0:m.start_date,"day")/((m==null||(l=m.parameters)===null||l===void 0?void 0:l.recommended_running_time)||1)*100,ba={running:"green",draft:"default",complete:"purple"},qt=function(){if(m!=null&&m.start_date){if(!(m!=null&&m.end_date))return"running"}else return"draft";return"complete"},xa=[{background:"#35416b",color:"#fff"},{background:"#C278CE66",color:"#35416B"},{background:"#FFE6AE",color:"#35416B"},{background:"#8DA9E74D",color:"#35416B"}];return t.a.createElement(t.a.Fragment,null,q==="new"||nt?t.a.createElement(t.a.Fragment,null,t.a.createElement(x.a,{align:"middle",justify:"space-between",style:{borderBottom:"1px solid var(--border)",marginBottom:"1rem",paddingBottom:8}},t.a.createElement(zt.a,{title:"New experiment"}),t.a.createElement(x.a,null,t.a.createElement(ke.a,{type:"secondary",className:"mr-05",onClick:function(){return Lt.router.actions.push(gt.a.experiments())}},"Cancel"),t.a.createElement(ke.a,{type:"primary",htmlType:"submit",form:"new-experiment"},"Save"))),t.a.createElement(P.a,{name:"new-experiment",layout:"vertical",className:"experiment-form",form:fa,onValuesChange:function(R){return _t(R)},initialValues:{name:k==null?void 0:k.name,feature_flag_key:k==null?void 0:k.feature_flag_key,description:k==null?void 0:k.description},onFinish:function(){return kt(!0,ya,Yn)},requiredMark:!1,scrollToFirstError:!0},t.a.createElement("div",null,t.a.createElement(Ce.BindLogic,{logic:wt.c,props:gn},t.a.createElement(x.a,null,t.a.createElement(O.a,{span:12,style:{paddingRight:24}},t.a.createElement(x.a,{className:"full-width"},t.a.createElement(P.a.Item,{style:{marginRight:16},label:"Name",name:"name",rules:[{required:!0,message:"You have to enter a name."}]},t.a.createElement(ce.a,{"data-attr":"experiment-name",className:"ph-ignore-input"})),t.a.createElement(P.a.Item,{style:{marginBottom:"1rem"},label:t.a.createElement("div",null,"Feature flag key"," ",t.a.createElement(s.a,{title:"Enter a unique key. This will create a new feature flag which will be associated with this experiment."},t.a.createElement(mt.a,null))),name:"feature_flag_key",rules:[{required:!0,message:"You have to enter a feature flag key name."}]},t.a.createElement(ce.a,{"data-attr":"experiment-feature-flag-key",disabled:nt}))),t.a.createElement(P.a.Item,{label:t.a.createElement("div",null,"Description ",t.a.createElement("span",{className:"text-muted"},"(optional)")),name:"description"},t.a.createElement(ce.a.TextArea,{"data-attr":"experiment-description",className:"ph-ignore-input",placeholder:"Adding a helpful description can ensure others know what this experiment is about."})),(k==null||(v=k.parameters)===null||v===void 0?void 0:v.feature_flag_variants)&&t.a.createElement(O.a,null,t.a.createElement("label",null,t.a.createElement("b",null,"Experiment variants")),t.a.createElement("div",{className:"text-muted"},"Participants are divided into variant groups evenly. All experiments must consist of a control group and at least one test group. Experiments may have at most 3 test groups. Variant names can only contain letters, numbers, hyphens, and underscores."),t.a.createElement(O.a,{className:"variants"},k.parameters.feature_flag_variants.map(function(V,R){return t.a.createElement(P.a,{key:"".concat(V,"-").concat(R),initialValues:{key:V.key},onValuesChange:function(Ie){da(Ie,R)}},t.a.createElement(x.a,{key:"".concat(V,"-").concat(R),className:"feature-flag-variant ".concat(R===0?"border-top":R>=3?"border-bottom":"")},t.a.createElement("div",{className:"variant-label",style:dt({},xa[R])},R===0?"Control":"Test"),t.a.createElement(P.a.Item,{name:"key",rules:[{required:!0,message:"Key should not be empty."},{required:!0,pattern:/^([A-z]|[a-z]|[0-9]|-|_)+$/,message:t.a.createElement(t.a.Fragment,null,t.a.createElement(In.a,{style:{color:"#F96132"}})," ","Variant names can only contain letters, numbers, hyphens, and underscores.")}],style:{display:"contents"}},t.a.createElement(ce.a,{disabled:R===0,"data-attr":"feature-flag-variant-key","data-key-index":R.toString(),className:"ph-ignore-input",placeholder:"example-variant-".concat(R+1),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})),t.a.createElement("div",{className:"float-right"},!(R===0||R===1)&&t.a.createElement(s.a,{title:"Delete this variant",placement:"bottomLeft"},t.a.createElement(ke.a,{type:"primary-alt",size:"small",icon:t.a.createElement(st.IconDelete,null),onClick:function(){return _n(R)}})))))}),k.parameters.feature_flag_variants.length<4&&t.a.createElement("div",{className:"feature-flag-variant border-bottom"},t.a.createElement(ke.a,{onClick:function(){return oa()},fullWidth:!0,icon:t.a.createElement(st.IconPlusMini,null)},"Add test variant")))),t.a.createElement(x.a,{className:"person-selection"},t.a.createElement("div",{className:"mb-05"},t.a.createElement("strong",null,"Select participants")),t.a.createElement(O.a,null,t.a.createElement("div",{className:"text-muted"},"Select the entities who will participate in this experiment. If no filters are set, 100% of participants will be targeted."),t.a.createElement("div",{className:"mt mb-05"},t.a.createElement("strong",null,"Participant type")),t.a.createElement(M.a,{value:(k==null||(y=k.filters)===null||y===void 0?void 0:y.aggregation_group_type_index)!=null?k.filters.aggregation_group_type_index:-1,onChange:function(R){var Ae,Ie=R!==-1?R:void 0;Ie!=(k==null||(Ae=k.filters)===null||Ae===void 0?void 0:Ae.aggregation_group_type_index)&&(Bt({properties:[],aggregation_group_type_index:Ie}),_t({filters:{aggregation_group_type_index:Ie,properties:[]}}))},"data-attr":"participant-aggregation-filter",dropdownMatchSelectWidth:!1},t.a.createElement(M.a.Option,{key:-1,value:-1},"Persons"),ut.map(function(V){return t.a.createElement(M.a.Option,{key:V.group_type_index,value:V.group_type_index},Object(Te.i)(la(V.group_type_index).plural))})),t.a.createElement("div",{className:"mt"},t.a.createElement("strong",null,"Filters")),t.a.createElement(jt.a,{pageKey:"experiment-participants-property",propertyFilters:fe===S.y.FUNNELS?Object(Te.r)(Un.properties):Object(Te.r)(Wn.properties),onChange:function(R){_t({filters:{properties:R}}),Bt({properties:R.filter(en.b)})},taxonomicGroupTypes:at})))),t.a.createElement(x.a,{className:"metrics-selection"},t.a.createElement(O.a,{span:12},t.a.createElement("div",{className:"mb-05"},t.a.createElement("b",null,"Goal type"),t.a.createElement("div",{className:"text-muted"},fe===S.y.TRENDS?"Track counts of a specific event or action":"Track how many persons complete a sequence of actions and or events")),t.a.createElement(M.a,{style:{display:"flex"},value:fe,onChange:Da,suffixIcon:t.a.createElement(Gt.a,null),dropdownMatchSelectWidth:!1},t.a.createElement(M.a.Option,{value:S.y.TRENDS},t.a.createElement(O.a,null,t.a.createElement("span",null,t.a.createElement("b",null,"Trend")))),t.a.createElement(M.a.Option,{value:S.y.FUNNELS},t.a.createElement(O.a,null,t.a.createElement("span",null,t.a.createElement("b",null,"Conversion funnel"))))),t.a.createElement("div",{className:"mb mt"},t.a.createElement("b",null,"Experiment goal"),fe===S.y.TRENDS&&t.a.createElement("div",{className:"text-muted"},"Trend-based experiments can have at most one graph series. This metric is used to track the progress of your experiment.")),t.a.createElement(x.a,null,t.a.createElement(z.a,{className:"action-filters-bordered",style:{width:"100%",marginRight:8},bodyStyle:{padding:0}},fe===S.y.FUNNELS&&t.a.createElement(Pt.a,{filters:Un,setFilters:function(R){_t({filters:R}),Bt(R)},typeKey:"EditFunnel-action",mathAvailability:sn.b.None,hideDeleteBtn:Ra.length===1,buttonCopy:"Add funnel step",buttonType:"link",showSeriesIndicator:!va,seriesIndicatorType:"numeric",fullWidth:!0,sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[le.a.EventProperties,le.a.PersonProperties,le.a.Cohorts,le.a.Elements],rowClassName:"action-filters-bordered"}),fe===S.y.TRENDS&&t.a.createElement(Pt.a,{horizontalUI:!0,filters:Wn,setFilters:function(R){_t({filters:R}),Bt(R)},typeKey:"experiment-trends",buttonCopy:"Add graph series",showSeriesIndicator:!0,entitiesLimit:1,propertiesTaxonomicGroupTypes:[le.a.EventProperties,le.a.PersonProperties,le.a.Cohorts,le.a.Elements],customRowPrefix:Wn.insight===S.y.LIFECYCLE?t.a.createElement(t.a.Fragment,null,"Showing ",t.a.createElement("b",null,"Unique users")," who did"):void 0}))),Qt[ht.h.EXPERIMENTS_SECONDARY_METRICS]&&t.a.createElement(O.a,{className:"secondary-metrics"},t.a.createElement("div",null,t.a.createElement("b",null,"Secondary metrics"),t.a.createElement("span",{className:"text-muted ml-05"},"(optional)")),t.a.createElement("div",{className:"text-muted",style:{marginTop:4}},"Use secondary metrics to monitor metrics related to your experiment goal. You can add up to three secondary metrics."," "),t.a.createElement(cn,{onMetricsChange:function(R){return pn(R)},initialMetrics:Pe}))),t.a.createElement(O.a,{span:12,className:"pl"},t.a.createElement("div",{className:"card-secondary mb"},"Goal preview"),t.a.createElement(At.a,{disableHeader:fe===S.y.TRENDS,disableTable:!0})))),t.a.createElement(x.a,null,t.a.createElement(z.a,{className:"experiment-preview"},t.a.createElement(bt,{experiment:k,trendCount:bn,trendExposure:ya,funnelSampleSize:Yn,funnelEntrants:Ea,funnelConversionRate:En}))))),t.a.createElement(ke.a,{className:"float-right",type:"primary",htmlType:"submit"},"Save"))):!mn&&m?t.a.createElement("div",{className:"view-experiment"},t.a.createElement(x.a,{className:"draft-header"},t.a.createElement(x.a,{justify:"space-between",align:"middle",className:"full-width pb"},t.a.createElement(O.a,null,t.a.createElement(x.a,null,t.a.createElement(zt.a,{style:{paddingRight:8},title:"".concat(m==null?void 0:m.name),buttons:t.a.createElement(t.a.Fragment,null,t.a.createElement(Jt.a,{explicitValue:m.feature_flag_key,iconStyle:{color:"var(--text-muted-alt)"}},t.a.createElement("span",{className:"text-muted"},m.feature_flag_key)),t.a.createElement(xe.a,{style:{alignSelf:"center"},color:ba[qt()]},t.a.createElement("b",{className:"uppercase"},qt())),B&&m.end_date&&t.a.createElement(xe.a,{style:{alignSelf:"center"},color:Re?"green":"geekblue"},t.a.createElement("b",{className:"uppercase"},Re?"Significant Results":"Results not significant")))})),t.a.createElement("span",{className:"exp-description"},m.start_date?t.a.createElement(wa.a,{multiline:!0,name:"description",value:m.description||"",placeholder:"Description (optional)",onSave:function(R){return ca({description:R})},maxLength:400,"data-attr":"experiment-description",compactButtons:!0}):t.a.createElement(t.a.Fragment,null,m.description||"There is no description for this experiment."))),m&&!m.start_date&&t.a.createElement("div",{className:"flex-center"},t.a.createElement(ke.a,{type:"secondary",className:"mr-05",onClick:function(){return sa(!0)}},"Edit"),t.a.createElement(ke.a,{type:"primary",onClick:function(){return Ct()}},"Launch")),m&&m.start_date&&!m.end_date&&t.a.createElement(ke.a,{type:"secondary",status:"danger",onClick:function(){return Vn()}},"Stop"),(m==null?void 0:m.end_date)&&Object(Ee.a)().isSameOrAfter(Object(Ee.a)(m.end_date),"day")&&!m.archived&&t.a.createElement(ke.a,{type:"secondary",status:"danger",onClick:function(){return Ma()}},t.a.createElement("b",null,"Archive")))),t.a.createElement(x.a,null,fn&&B&&Re&&!m.end_date&&t.a.createElement(x.a,{align:"middle",className:"significant-results"},t.a.createElement(O.a,{span:20,style:{fontWeight:500,color:"#497342"}},t.a.createElement("div",null,"Experiment results are significant."," ",m.end_date?"":"You can end your experiment now or let it run until complete.")),t.a.createElement(O.a,{span:4},m.end_date?t.a.createElement(ln.a,{className:"close-button",onClick:function(){return vn(!1)}}):t.a.createElement(ke.a,{type:"highlighted",className:"end-experiment-btn",onClick:function(){return Vn()}},"End experiment"))),fn&&B&&!Re&&!m.end_date&&t.a.createElement(x.a,{align:"top",className:"not-significant-results"},t.a.createElement(O.a,{span:23,style:{fontWeight:500,color:"#2D2D2D"}},t.a.createElement("strong",null,"Your results are not statistically significant"),"."," ",Be," ",m!=null&&m.end_date?"":"We don't recommend ending this experiment yet."," ","See our"," ",t.a.createElement("a",{href:"https://posthog.com/docs/user-guides/experimentation#funnel-experiment-calculations"}," ","experimentation guide"," "),"for more information."," "),t.a.createElement(O.a,{span:1},t.a.createElement(ln.a,{className:"close-button",onClick:function(){return vn(!1)}}))),fn&&m.end_date&&t.a.createElement(x.a,{align:"top",className:"feature-flag-mods"},t.a.createElement(O.a,{span:23,style:{fontWeight:500}},t.a.createElement("strong",null,"Your experiment is complete.")," We recommend removing the feature flag from your code completely, instead of relying on this distribution."," ",t.a.createElement(wn.a,{to:m.feature_flag?gt.a.featureFlag(m.feature_flag):void 0},t.a.createElement("b",null,"Adjust feature flag distribution"))),t.a.createElement(O.a,{span:1},t.a.createElement(ln.a,{className:"close-button",onClick:function(){return vn(!1)}})))),t.a.createElement(x.a,null,t.a.createElement(H.a,{className:"full-width",defaultActiveKey:"experiment-details"},t.a.createElement(H.a.Panel,{header:t.a.createElement("b",null,"Experiment details"),key:"experiment-details"},t.a.createElement(x.a,null,t.a.createElement(O.a,{span:m!=null&&m.start_date?12:24},t.a.createElement(bt,{experiment:m,trendCount:bn,trendExposure:m==null?void 0:m.parameters.recommended_running_time,funnelSampleSize:m==null?void 0:m.parameters.recommended_sample_size,funnelConversionRate:En,funnelEntrants:m!=null&&m.start_date?xn:Ea})),!ae&&!B&&m.start_date&&t.a.createElement(O.a,{span:12},t.a.createElement(ct,{experiment:m})),(B||((E=m.secondary_metrics)===null||E===void 0?void 0:E.length)>0)&&t.a.createElement(O.a,{className:"secondary-progress",span:m!=null&&m.start_date?12:24},Qt[ht.h.EXPERIMENTS_SECONDARY_METRICS]&&!!(m!=null&&m.secondary_metrics.length)&&t.a.createElement(O.a,{className:"border-bottom"},t.a.createElement(x.a,{align:"middle",justify:"space-between",className:"mb-05"},t.a.createElement(O.a,{className:"card-secondary",span:2*Ut},"Secondary metrics"),m==null||(d=m.parameters)===null||d===void 0||(u=d.feature_flag_variants)===null||u===void 0?void 0:u.map(function(V,R){return t.a.createElement(O.a,{key:R,span:Ut,style:{color:"".concat(fe===S.y.FUNNELS?Object(ot.k)(ve(V.key,S.y.FUNNELS)+1):Object(aa.c)("white")[ve(V.key,S.y.TRENDS)])}},t.a.createElement("span",{className:"text-default"},Object(Te.i)(V.key)))})),Qt[ht.h.EXPERIMENTS_SECONDARY_METRICS]&&(m.start_date?La?t.a.createElement(be.a,{active:!0,paragraph:!1}):t.a.createElement(t.a.Fragment,null,m.secondary_metrics.map(function(V,R){var Ae,Ie;return t.a.createElement(x.a,{className:"border-top",key:R,justify:"space-between",style:{paddingTop:8,paddingBottom:8}},t.a.createElement(O.a,{span:2*Ut},Object(Te.i)(V.name)),m==null||(Ae=m.parameters)===null||Ae===void 0||(Ie=Ae.feature_flag_variants)===null||Ie===void 0?void 0:Ie.map(function(Wt,It){return t.a.createElement(O.a,{key:It,span:Ut},rt!=null&&rt[R][Wt.key]?V.filters.insight===S.y.FUNNELS?t.a.createElement(t.a.Fragment,null,((rt==null?void 0:rt[R][Wt.key])*100).toFixed(1),"%"):t.a.createElement(t.a.Fragment,null,Object(Te.N)(rt==null?void 0:rt[R][Wt.key])):t.a.createElement(t.a.Fragment,null,"--"))}))})):t.a.createElement(t.a.Fragment,null,m.secondary_metrics.map(function(V,R){var Ae,Ie;return t.a.createElement(x.a,{className:"border-top",key:R,justify:"space-between",style:{paddingTop:8,paddingBottom:8}},t.a.createElement(O.a,{span:2*Ut},Object(Te.i)(V.name)),m==null||(Ae=m.parameters)===null||Ae===void 0||(Ie=Ae.feature_flag_variants)===null||Ie===void 0?void 0:Ie.map(function(Wt,It){return t.a.createElement(O.a,{key:It,span:Ut},"--")}))})))),B&&t.a.createElement(O.a,{className:"mt"},t.a.createElement("div",{className:"mb-05"},t.a.createElement("b",null,"Experiment progress")),t.a.createElement(_e.a,{strokeWidth:20,showInfo:!1,percent:Aa,strokeColor:"var(--success)"}),fe===S.y.TRENDS&&m.start_date&&t.a.createElement(x.a,{justify:"space-between",className:"mt-05"},m.end_date?t.a.createElement("div",null,"Ran for"," ",t.a.createElement("b",null,Object(Ee.a)(m.end_date).diff(m.start_date,"day"))," ","days"):t.a.createElement("div",null,t.a.createElement("b",null,Object(Ee.a)().diff(m.start_date,"day"))," ","days running"),t.a.createElement("div",null,"Goal:"," ",t.a.createElement("b",null,m==null||(F=m.parameters)===null||F===void 0?void 0:F.recommended_running_time)," ","days")),fe===S.y.FUNNELS&&t.a.createElement(x.a,{justify:"space-between",className:"mt-05"},m.end_date?t.a.createElement("div",null,"Saw"," ",t.a.createElement("b",null,Object(Te.N)(xn))," ","participants"):t.a.createElement("div",null,t.a.createElement("b",null,Object(Te.N)(xn))," ","participants seen"),t.a.createElement("div",null,"Goal:"," ",t.a.createElement("b",null,Object(Te.N)((m==null||(G=m.parameters)===null||G===void 0?void 0:G.recommended_sample_size)||0))," ","participants"))))))),!(m!=null&&m.start_date)&&t.a.createElement("div",{className:"mt full-width"},t.a.createElement(ct,{experiment:m}))),t.a.createElement("div",{className:"experiment-result"},B?t.a.createElement(t.a.Fragment,null,t.a.createElement(x.a,{justify:"space-around",style:{flexFlow:"nowrap"}},Object.keys(B.probability).sort(function(V,R){return B.probability[R]-B.probability[V]}).map(function(V,R){return t.a.createElement(O.a,{key:R,className:"pr"},t.a.createElement("div",null,t.a.createElement("b",null,Object(Te.i)(V))),fe===S.y.TRENDS?t.a.createElement(x.a,null,t.a.createElement("b",{style:{paddingRight:4}},t.a.createElement(x.a,null,"action"in B.insight[0]&&t.a.createElement(Tt.a,{filter:B.insight[0].action}),t.a.createElement("span",{style:{paddingLeft:4}},"count:")))," ",Ot(V)," ",we&&R===0&&t.a.createElement(s.a,{placement:"right",title:"It might seem confusing that the best variant has lower absolute count, but this can happen when fewer people are exposed to this variant, so its relative count is higher."},t.a.createElement(mt.a,{style:{padding:"4px 2px"}}))):t.a.createElement(x.a,null,t.a.createElement("b",{style:{paddingRight:4}},"Conversion rate:")," ",ft(V),"%"),t.a.createElement(_e.a,{percent:Number((B.probability[V]*100).toFixed(1)),size:"small",showInfo:!1,strokeColor:fe===S.y.FUNNELS?Object(ot.k)(ve(V,S.y.FUNNELS)+1):Object(aa.c)("white")[ve(V,S.y.TRENDS)]}),t.a.createElement("div",null,"Probability that this variant is the best:"," ",t.a.createElement("b",null,(B.probability[V]*100).toFixed(1),"%")))}))):ae&&t.a.createElement("div",{className:"text-center"},t.a.createElement(be.a,{active:!0})),B?t.a.createElement(Ce.BindLogic,{logic:wt.c,props:{dashboardItemId:B.itemID,cachedInsight:{short_id:B.itemID,filters:dt(dt(dt({},B.filters),{},{insight:fe,display:m.filters.display},fe===S.y.FUNNELS&&{layout:ht.j.vertical,funnel_viz_type:S.u.Steps}),fe===S.y.TRENDS&&{display:S.i.ActionsLineGraphCumulative}),result:B.insight},doNotLoad:!0}},t.a.createElement("div",{className:"mt"},t.a.createElement(At.a,{disableHeader:fe===S.y.TRENDS,disableTable:fe===S.y.FUNNELS}))):m.start_date&&t.a.createElement(t.a.Fragment,null,t.a.createElement("div",{className:"no-experiment-results"},!ae&&t.a.createElement("div",{className:"text-center"},t.a.createElement("b",null,"There are no results for this experiment yet."),t.a.createElement("div",{className:"text-default"},"Double check your feature flag implementation if you're still not seeing results.")))))):t.a.createElement(be.a,{active:!0}))}function An(){return t.a.createElement(M.a,{defaultValue:"JavaScript",suffixIcon:t.a.createElement(Gt.a,null)},t.a.createElement(M.a.Option,{value:"JavaScript"},t.a.createElement(x.a,{align:"middle"},t.a.createElement(st.IconJavascript,{style:{marginRight:6}})," JavaScript")))}},"./frontend/src/scenes/insights/InsightContainer.tsx":function(Oe,Q,n){"use strict";n.d(Q,"a",function(){return It});var Ne=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),he=n.n(Ne),Qe=n("./node_modules/antd/es/card/index.js"),Le=n("./node_modules/antd/es/row/index.js"),Ve=n("./node_modules/antd/es/col/index.js"),Yt=n("./node_modules/core-js/modules/es.array.includes.js"),et=n("./node_modules/core-js/modules/es.string.includes.js"),Me=n("./node_modules/react/index.js"),e=n.n(Me),g=n("./node_modules/kea/lib/index.esm.js"),it=n("./node_modules/antd/es/tag/index.js"),ye=n("./node_modules/antd/es/select/index.js"),Ue=n("./frontend/src/lib/components/ChartFilter/chartFilterLogic.ts"),We=n("./node_modules/@ant-design/icons/es/icons/OrderedListOutlined.js"),ne=n("./node_modules/@ant-design/icons/es/icons/LineChartOutlined.js"),se=n("./node_modules/@ant-design/icons/es/icons/AreaChartOutlined.js"),P=n("./node_modules/@ant-design/icons/es/icons/BarChartOutlined.js"),x=n("./node_modules/@ant-design/icons/es/icons/TableOutlined.js"),O=n("./node_modules/@ant-design/icons/es/icons/PieChartOutlined.js"),ce=n("./node_modules/@ant-design/icons/es/icons/GlobalOutlined.js"),s=n("./frontend/src/types.ts"),M=n("./frontend/src/lib/utils.tsx"),z=n("./frontend/src/scenes/insights/insightLogic.ts"),xe=n("./frontend/src/scenes/insights/ActionFilter/entityFilterLogic.ts"),H=n("./frontend/src/lib/components/Tooltip.tsx");function be(f){var o=f.filters,c=f.onChange,p=f.disabled,C=Object(g.useValues)(z.c),h=C.insightProps,b=Object(g.useValues)(Object(Ue.a)(h)),T=b.chartFilter,I=Object(g.useActions)(Object(Ue.a)(h)),w=I.setChartFilter,N=o.insight===s.y.STICKINESS||o.insight===s.y.RETENTION,j=o.insight===s.y.RETENTION||o.insight===s.y.STICKINESS,_=o.insight===s.y.RETENTION||o.insight===s.y.STICKINESS||!!o.breakdown&&o.breakdown!=="$geoip_country_code"&&o.breakdown!=="$geoip_country_name"||Object(xe.c)(o).length>1,D=o.insight===s.y.RETENTION,Y=D||o.insight===s.y.STICKINESS||o.insight===s.y.RETENTION,J=o.insight===s.y.RETENTION?s.i.ActionsTable:o.insight===s.y.FUNNELS?s.i.FunnelViz:s.i.ActionsLineGraph;function A(W){var X=W.icon,ee=W.tooltip,$=W.children,Z=$===void 0?null:$;return e.a.createElement(H.a,{title:ee,placement:"left"},e.a.createElement("div",{style:{width:"100%"}},X," ",Z))}function de(W){var X=W.children,ee=X===void 0?null:X;return e.a.createElement(it.a,{color:"orange",style:{marginLeft:8,fontSize:10}},ee)}var U=o.insight===s.y.FUNNELS?[{value:s.u.Steps,label:e.a.createElement(A,{icon:e.a.createElement(We.a,null)},"Steps")},{value:s.u.Trends,label:e.a.createElement(A,{icon:e.a.createElement(ne.a,null)},"Trends",e.a.createElement(de,null,"BETA"))}]:[{label:"Line Chart",options:[{value:s.i.ActionsLineGraph,label:e.a.createElement(A,{icon:e.a.createElement(ne.a,null)},"Linear")},{value:s.i.ActionsLineGraphCumulative,label:e.a.createElement(A,{icon:e.a.createElement(se.a,null)},"Cumulative"),disabled:N}]},{label:"Bar Chart",options:[{value:s.i.ActionsBar,label:e.a.createElement(A,{icon:e.a.createElement(P.a,null)},"Time"),disabled:D},{value:s.i.ActionsBarValue,label:e.a.createElement(A,{icon:e.a.createElement(P.a,null)},"Value"),disabled:Y}]},{value:s.i.ActionsTable,label:e.a.createElement(A,{icon:e.a.createElement(x.a,null)},"Table")},{value:s.i.ActionsPie,label:e.a.createElement(A,{icon:e.a.createElement(O.a,null)},"Pie"),disabled:j},{value:s.i.WorldMap,label:e.a.createElement(A,{icon:e.a.createElement(ce.a,null),tooltip:"Visualize data by country. Only works with one series at a time."},"World Map"),disabled:_}];return e.a.createElement(ye.a,{key:"2",defaultValue:o.display||J,value:T||J,onChange:function(X){w(X),c==null||c(X)},bordered:!0,dropdownAlign:M.a.bottomRight,dropdownMatchSelectWidth:!1,listHeight:288,"data-attr":"chart-filter",disabled:p,options:U})}try{be.displayName="ChartFilter",be.__docgenInfo={description:"",displayName:"ChartFilter",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((chartFilter: ChartDisplayType | FunnelVizType) => void)"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/ChartFilter/ChartFilter.tsx#ChartFilter"]={docgenInfo:be.__docgenInfo,name:"ChartFilter",path:"frontend/src/lib/components/ChartFilter/ChartFilter.tsx#ChartFilter"})}catch(f){}var _e=n("./node_modules/antd/es/checkbox/index.js"),Ce=n("./frontend/src/lib/components/CompareFilter/compareFilterLogic.ts");function zt(){var f=Object(g.useValues)(z.c),o=f.insightProps,c=Object(g.useValues)(Object(Ce.a)(o)),p=c.compare,C=c.disabled,h=Object(g.useActions)(Object(Ce.a)(o)),b=h.setCompare;return C?null:e.a.createElement(_e.a,{onChange:function(I){b(I.target.checked)},checked:p,style:{marginLeft:8,marginRight:6},disabled:C},"Compare",e.a.createElement("span",{className:"hide-lte-md"}," to previous"))}var jt=n("./node_modules/core-js/modules/es.array.map.js"),en=n("./node_modules/core-js/modules/es.object.entries.js"),le=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),lt=n.n(le),t=n("./node_modules/core-js/modules/es.array.iterator.js"),tn=n("./node_modules/core-js/modules/es.object.to-string.js"),Pt=n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),wt=n("./frontend/src/scenes/insights/sharedUtils.ts");function S(f,o){var c=Object.keys(f);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(f);o&&(p=p.filter(function(C){return Object.getOwnPropertyDescriptor(f,C).enumerable})),c.push.apply(c,p)}return c}function On(f){for(var o=1;o<arguments.length;o++){var c=arguments[o]!=null?arguments[o]:{};o%2?S(Object(c),!0).forEach(function(p){he()(f,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(c)):S(Object(c)).forEach(function(p){Object.defineProperty(f,p,Object.getOwnPropertyDescriptor(c,p))})}return f}var Cn=Object(g.kea)({props:{},key:Object(wt.c)("new"),path:function(o){return["lib","components","IntervalFilter","intervalFilterLogic",o]},connect:function(o){return{actions:[Object(z.c)(o),["setFilters"]],values:[Object(z.c)(o),["filters"]]}},actions:function(){return{setInterval:function(c){return{interval:c}}}},listeners:function(o){var c=o.values,p=o.actions;return{setInterval:function(h){var b=h.interval;Object(M.lb)(b,c.filters.interval)||p.setFilters(On(On({},c.filters),{},{interval:b}))}}},selectors:{interval:[function(f){return[f.filters]},function(f){return f==null?void 0:f.interval}]}}),nn=n("./node_modules/@ant-design/icons/es/icons/CalendarOutlined.js"),jn={hour:{label:"Hour",newDateFrom:"dStart"},day:{label:"Day",newDateFrom:void 0},week:{label:"Week",newDateFrom:"-30d"},month:{label:"Month",newDateFrom:"-90d"}};function St(f){var o=f.disabled,c=Object(g.useValues)(z.c),p=c.insightProps,C=Object(g.useValues)(Cn(p)),h=C.interval,b=Object(g.useActions)(Cn(p)),T=b.setInterval,I=Object.entries(jn).map(function(w){var N=lt()(w,2),j=N[0],_=N[1].label;return{key:j,value:j,label:j===h?e.a.createElement(e.a.Fragment,null,e.a.createElement(nn.a,null)," ",_):_}});return e.a.createElement(ye.a,{bordered:!0,disabled:o,defaultValue:h||"day",value:h||void 0,dropdownMatchSelectWidth:!1,onChange:T,"data-attr":"interval-filter",options:I})}try{St.displayName="IntervalFilter",St.__docgenInfo={description:"",displayName:"IntervalFilter",props:{view:{defaultValue:null,description:"",name:"view",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/IntervalFilter/IntervalFilter.tsx#IntervalFilter"]={docgenInfo:St.__docgenInfo,name:"IntervalFilter",path:"frontend/src/lib/components/IntervalFilter/IntervalFilter.tsx#IntervalFilter"})}catch(f){}var Oa=n("./node_modules/@ant-design/icons/es/icons/FundOutlined.js"),Ca=n("./frontend/src/lib/components/SmoothingFilter/smoothings.ts");function Gn(f,o){var c=Object.keys(f);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(f);o&&(p=p.filter(function(C){return Object.getOwnPropertyDescriptor(f,C).enumerable})),c.push.apply(c,p)}return c}function Jn(f){for(var o=1;o<arguments.length;o++){var c=arguments[o]!=null?arguments[o]:{};o%2?Gn(Object(c),!0).forEach(function(p){he()(f,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(c)):Gn(Object(c)).forEach(function(p){Object.defineProperty(f,p,Object.getOwnPropertyDescriptor(c,p))})}return f}function ja(){var f=Object(g.useValues)(z.c),o=f.filters,c=Object(g.useActions)(z.c),p=c.setFilters,C=o.interval,h=o.smoothing_intervals;if(!C)return null;var b=Ca.a[C].map(function(T){var I=T.value,w=T.label;return{value:I,label:I===h?e.a.createElement(e.a.Fragment,null,e.a.createElement(Oa.a,null)," ",w):w}});return b.length?e.a.createElement(ye.a,{key:C,bordered:!0,value:h||1,dropdownMatchSelectWidth:!1,onChange:function(I){p(Jn(Jn({},o),{},{smoothing_intervals:I}))},"data-attr":"smoothing-filter",options:b}):e.a.createElement(e.a.Fragment,null)}var $e=n("./frontend/src/lib/constants.tsx"),Sa=n("./node_modules/@babel/runtime/helpers/extends.js"),Na=n.n(Sa),Xn=n("./frontend/src/scenes/insights/InsightDateFilter/insightDateFilterLogic.ts"),Ta=n("./frontend/src/lib/components/DateFilter/DateFilter.tsx");function an(f){var o=Object(g.useValues)(z.c),c=o.insightProps,p=Object(g.useValues)(Object(Xn.a)(c)),C=p.dates,h=C.dateFrom,b=C.dateTo,T=Object(g.useActions)(Object(Xn.a)(c)),I=T.setDates;return e.a.createElement(Ta.a,Na()({},f,{dateFrom:h!=null?h:void 0,dateTo:b!=null?b:void 0,onChange:function(N,j){var _;I(N,j),(_=f.onChange)===null||_===void 0||_.call(f,N,j)}}))}try{an.displayName="InsightDateFilter",an.__docgenInfo={description:"",displayName:"InsightDateFilter",props:{defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!0,type:{name:"string"}},showCustom:{defaultValue:null,description:"",name:"showCustom",required:!1,type:{name:"boolean"}},bordered:{defaultValue:null,description:"",name:"bordered",required:!1,type:{name:"boolean"}},makeLabel:{defaultValue:null,description:"",name:"makeLabel",required:!1,type:{name:"((key: ReactNode) => ReactNode)"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((fromDate: string, toDate: string) => void)"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},getPopupContainer:{defaultValue:null,description:"",name:"getPopupContainer",required:!1,type:{name:"((props: any) => HTMLElement)"}},dateOptions:{defaultValue:null,description:"",name:"dateOptions",required:!1,type:{name:"Record<string, dateMappingOption>"}},isDateFormatted:{defaultValue:null,description:"",name:"isDateFormatted",required:!1,type:{name:"boolean"}},selectProps:{defaultValue:null,description:"",name:"selectProps",required:!1,type:{name:"SelectProps<any>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightDateFilter/InsightDateFilter.tsx#InsightDateFilter"]={docgenInfo:an.__docgenInfo,name:"InsightDateFilter",path:"frontend/src/scenes/insights/InsightDateFilter/InsightDateFilter.tsx#InsightDateFilter"})}catch(f){}var Ia=n("./node_modules/rc-picker/lib/generate/dayjs.js"),Qn=n.n(Ia),oe=n("./node_modules/antd/lib/date-picker/generatePicker/index.js"),Fa=n.n(oe),$t=n("./frontend/src/scenes/retention/retentionTableLogic.ts"),Fe=n("./frontend/src/lib/dayjs.ts"),Zn=Fa()(Qn.a);function Ze(f){var o=f.disabled,c=Object(g.useValues)(z.c),p=c.insightProps,C=Object(g.useValues)(Object($t.e)(p)),h=C.filters,b=Object(g.useActions)(Object($t.e)(p)),T=b.setFilters,I=h.date_to&&Object(Fe.a)(h.date_to).year()!==Object(Fe.a)().year()?", YYYY":"";return e.a.createElement(e.a.Fragment,null,e.a.createElement(H.a,{title:"Cohorts up to this end date"},e.a.createElement("span",{style:{maxWidth:100,display:"inline-flex",alignItems:"center"}},e.a.createElement(nn.a,null),e.a.createElement(Zn,{showTime:h.period==="Hour",use12Hours:!0,format:h.period==="Hour"?"MMM D".concat(I,", h a"):"MMM D".concat(I),value:h.date_to?Object(Fe.a)(h.date_to):void 0,onChange:function(N){return T({date_to:N&&Object(Fe.a)(N).toISOString()})},allowClear:!0,placeholder:"Today",className:"retention-date-picker",suffixIcon:null,disabled:o}))))}try{Ze.displayName="RetentionDatePicker",Ze.__docgenInfo={description:"",displayName:"RetentionDatePicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/RetentionDatePicker.tsx#RetentionDatePicker"]={docgenInfo:Ze.__docgenInfo,name:"RetentionDatePicker",path:"frontend/src/scenes/insights/RetentionDatePicker.tsx#RetentionDatePicker"})}catch(f){}var me=n("./frontend/src/scenes/funnels/funnelLogic.ts"),Ee=n("./node_modules/@ant-design/icons/es/icons/FunnelPlotOutlined.js");function vt(f){var o=f.disabled,c=Object(g.useValues)(z.c),p=c.insightProps,C=Object(g.useValues)(Object(me.a)(p)),h=C.barGraphLayout,b=Object(g.useActions)(Object(me.a)(p)),T=b.setFilters,I=[{value:$e.j.vertical,icon:e.a.createElement(P.a,null),label:"Left to right"},{value:$e.j.horizontal,icon:e.a.createElement(Ee.a,null),label:"Top to bottom"}];return e.a.createElement(ye.a,{defaultValue:$e.j.vertical,value:h||$e.j.vertical,onChange:function(N){return T({layout:N})},bordered:!0,dropdownMatchSelectWidth:!1,"data-attr":"funnel-bar-layout-selector",optionLabelProp:"label",disabled:o},e.a.createElement(ye.a.OptGroup,{label:"Graph display options"},I.map(function(w){return e.a.createElement(ye.a.Option,{key:w.value,value:w.value,label:e.a.createElement(e.a.Fragment,null,w.icon," ",w.label)},w.label)})))}try{vt.displayName="FunnelDisplayLayoutPicker",vt.__docgenInfo={description:"",displayName:"FunnelDisplayLayoutPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightTabs/FunnelTab/FunnelDisplayLayoutPicker.tsx#FunnelDisplayLayoutPicker"]={docgenInfo:vt.__docgenInfo,name:"FunnelDisplayLayoutPicker",path:"frontend/src/scenes/insights/InsightTabs/FunnelTab/FunnelDisplayLayoutPicker.tsx#FunnelDisplayLayoutPicker"})}catch(f){}var Sn=n("./node_modules/core-js/modules/es.array.filter.js"),gt=n("./node_modules/core-js/modules/es.array.from.js"),Lt=n("./node_modules/core-js/modules/es.array.slice.js"),Pa=n("./node_modules/core-js/modules/es.string.iterator.js"),ht=n("./node_modules/@ant-design/icons/es/icons/BarsOutlined.js"),Dt=n("./frontend/src/scenes/paths/pathsLogic.ts"),Mt=n("./frontend/src/scenes/userLogic.ts");function Ht(f){var o,c=f.disabled,p=Object(g.useValues)(z.c),C=p.insightProps,h=Object(g.useValues)(Object(Dt.b)(C)),b=h.filter,T=Object(g.useActions)(Object(Dt.b)(C)),I=T.setFilter,w=Object(g.useValues)(Mt.a),N=w.user,j=2,_=!(N==null||(o=N.organization)===null||o===void 0)&&o.available_features.includes(s.d.PATHS_ADVANCED)?20:5,D=Array.from(Array.from(Array.from(Array(_+1).keys()).slice(j)),function(Y){return{label:"".concat(Y," Steps"),value:Y}});return e.a.createElement(ye.a,{id:"path-step-filter","data-attr":"path-step-filter",defaultValue:5,value:b.step_limit||Dt.a,onSelect:function(J){return I({step_limit:J})},listHeight:440,bordered:!1,dropdownMatchSelectWidth:!0,dropdownAlign:M.a.bottomRight,optionLabelProp:"label",disabled:c},D.map(function(Y){return e.a.createElement(ye.a.Option,{key:Y.value,value:Y.value,label:e.a.createElement(e.a.Fragment,null,e.a.createElement(ht.a,null)," ",Y.label)},Y.label)}))}try{Ht.displayName="PathStepPicker",Ht.__docgenInfo={description:"",displayName:"PathStepPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightTabs/PathTab/PathStepPicker.tsx#PathStepPicker"]={docgenInfo:Ht.__docgenInfo,name:"PathStepPicker",path:"frontend/src/scenes/insights/InsightTabs/PathTab/PathStepPicker.tsx#PathStepPicker"})}catch(f){}var rn=n("./node_modules/@ant-design/icons/es/icons/PercentageOutlined.js");function mt(f){var o=f.disabled,c=Object(g.useValues)(z.c),p=c.insightProps,C=Object(g.useValues)(Object($t.e)(p)),h=C.retentionReference,b=Object(g.useActions)(Object($t.e)(p)),T=b.setRetentionReference;return e.a.createElement(ye.a,{value:h,onChange:T,bordered:!1,dropdownMatchSelectWidth:!1,"data-attr":"reference-selector",optionLabelProp:"label",disabled:o},[{value:"total",icon:e.a.createElement(rn.a,null),label:"Overall cohort"},{value:"previous",icon:e.a.createElement(rn.a,null),label:"Relative to previous period"}].map(function(I){return e.a.createElement(ye.a.Option,{key:I.value,value:I.value,label:e.a.createElement(e.a.Fragment,null,I.icon," ",I.label)},I.label)}))}try{mt.displayName="ReferencePicker",mt.__docgenInfo={description:"",displayName:"ReferencePicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightTabs/RetentionTab/ReferencePicker.tsx#ReferencePicker"]={docgenInfo:mt.__docgenInfo,name:"ReferencePicker",path:"frontend/src/scenes/insights/InsightTabs/RetentionTab/ReferencePicker.tsx#ReferencePicker"})}catch(f){}var Nn=n("./node_modules/antd/es/tooltip/index.js"),Ge=n("./node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),qn=n("./node_modules/core-js/modules/es.array.concat.js"),K=n("./node_modules/core-js/modules/es.set.js"),Rt=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),He=n.n(Rt),Tn=n("./node_modules/antd/es/input-number/index.js"),At=n("./node_modules/clsx/dist/clsx.m.js"),st=0,In=90,Gt=new Set([5,15,25,50,90]),ln=[{label:"Auto bins",value:$e.a,display:!0}].concat(He()(Array.from(Array.from(Array(In+1).keys()),function(f){return{label:"".concat(f," bins"),value:f,display:Gt.has(f)}})),[{label:"Custom",value:"custom",display:!0}]);function Jt(f){var o=f.disabled,c=Object(g.useValues)(z.c),p=c.insightProps,C=Object(g.useValues)(Object(me.a)(p)),h=C.filters,b=C.numericBinCount,T=Object(g.useActions)(Object(me.a)(p)),I=T.setBinCount;return e.a.createElement(ye.a,{id:"funnel-bin-filter",dropdownClassName:"funnel-bin-filter-dropdown","data-attr":"funnel-bin-filter",defaultValue:$e.a,value:h.bin_count||$e.a,onSelect:function(N){return I(N)},dropdownRender:function(N){return e.a.createElement(e.a.Fragment,null,N,e.a.createElement("div",null,e.a.createElement(Tn.a,{className:"funnel-bins-custom-picker",size:"middle",min:st,max:In,value:b,onChange:function(_){var D=typeof _=="string"?parseInt(_):_;D&&I(D)}})," ","bins"))},listHeight:440,bordered:!1,dropdownMatchSelectWidth:!1,dropdownAlign:M.a.bottomRight,optionLabelProp:"label",disabled:o},e.a.createElement(ye.a.OptGroup,{label:"Bin Count"},ln.map(function(w){return w.value==="custom"?null:e.a.createElement(ye.a.Option,{className:Object(At.a)({"select-option-hidden":!w.display}),key:w.value,value:w.value,label:e.a.createElement(e.a.Fragment,null,e.a.createElement(P.a,null)," ",w.label)},w.label)})))}try{Jt.displayName="FunnelBinsPicker",Jt.__docgenInfo={description:"",displayName:"FunnelBinsPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightTabs/FunnelTab/FunnelBinsPicker.tsx#FunnelBinsPicker"]={docgenInfo:Jt.__docgenInfo,name:"FunnelBinsPicker",path:"frontend/src/scenes/insights/InsightTabs/FunnelTab/FunnelBinsPicker.tsx#FunnelBinsPicker"})}catch(f){}var Te=n("./frontend/src/lib/logic/featureFlagLogic.ts"),ot,pt,ea=function(o,c){switch(o){case s.y.FUNNELS:return c.funnel_viz_type===s.u.Trends;case s.y.RETENTION:case s.y.PATHS:return!1;case s.y.TRENDS:case s.y.STICKINESS:case s.y.LIFECYCLE:default:return!c.display||!$e.l.includes(c.display)}},ta=function(o){switch(o){case s.y.TRENDS:case s.y.STICKINESS:return!0;case s.y.RETENTION:case s.y.FUNNELS:return!1;case s.y.LIFECYCLE:case s.y.PATHS:return!1;default:return!0}},Fn=(ot={},he()(ot,"".concat(s.y.TRENDS),!0),he()(ot,"".concat(s.y.STICKINESS),!0),he()(ot,"".concat(s.y.LIFECYCLE),!0),he()(ot,"".concat(s.y.FUNNELS),!0),he()(ot,"".concat(s.y.RETENTION),!1),he()(ot,"".concat(s.y.PATHS),!0),ot),Et=(pt={},he()(pt,"".concat(s.y.TRENDS),!0),he()(pt,"".concat(s.y.STICKINESS),!0),he()(pt,"".concat(s.y.LIFECYCLE),!1),he()(pt,"".concat(s.y.FUNNELS),!1),he()(pt,"".concat(s.y.RETENTION),!1),he()(pt,"".concat(s.y.PATHS),!1),pt),Pn=function(o){var c,p;return!o.actions&&!o.events||((c=o.actions)===null||c===void 0?void 0:c.length)===0&&((p=o.events)===null||p===void 0?void 0:p.length)===0};function Nt(f){var o=f.filters,c=f.activeView,p=f.disableTable,C=c===s.y.FUNNELS,h=c===s.y.PATHS,b=Object(g.useValues)(Te.a),T=b.featureFlags;return e.a.createElement("div",{className:"display-config-inner"},e.a.createElement("div",{className:"display-config-inner-row"},Fn[c]&&!p&&e.a.createElement("span",{className:"filter"},e.a.createElement("span",{className:"head-title-item"},"Date range"),e.a.createElement(an,{defaultValue:"Last 7 days",disabled:C&&Pn(o),bordered:!0,makeLabel:function(w){return e.a.createElement(e.a.Fragment,null,e.a.createElement(nn.a,null)," ",w,w=="All time"&&e.a.createElement(Nn.a,{title:"Only events dated after 2015 will be shown"},e.a.createElement(Ge.a,{className:"info-indicator"})))}})),ea(c,o)&&e.a.createElement("span",{className:"filter"},e.a.createElement("span",{className:"head-title-item"},e.a.createElement("span",{className:"hide-lte-md"},"grouped "),"by"),e.a.createElement(St,{view:c})),c===s.y.TRENDS&&!o.breakdown_type&&!o.compare&&(!o.display||o.display===s.i.ActionsLineGraph)&&T[$e.h.SMOOTHING_INTERVAL]?e.a.createElement(ja,null):null,c===s.y.RETENTION&&e.a.createElement(e.a.Fragment,null,e.a.createElement(Ze,null),e.a.createElement(mt,null)),h&&e.a.createElement("span",{className:"filter"},e.a.createElement(Ht,null)),Et[c]&&e.a.createElement("span",{className:"filter"},e.a.createElement(zt,null))),e.a.createElement("div",{className:"display-config-inner-row"},ta(c)&&e.a.createElement("span",{className:"filter"},e.a.createElement("span",{className:"head-title-item"},"Chart type"),e.a.createElement(be,{filters:o,disabled:o.insight===s.y.LIFECYCLE})),C&&o.funnel_viz_type===s.u.Steps&&e.a.createElement(e.a.Fragment,null,e.a.createElement("span",{className:"filter"},e.a.createElement(vt,null))),C&&o.funnel_viz_type===s.u.TimeToConvert&&e.a.createElement("span",{className:"filter"},e.a.createElement(Jt,null))))}try{Nt.displayName="InsightDisplayConfig",Nt.__docgenInfo={description:"",displayName:"InsightDisplayConfig",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},activeView:{defaultValue:null,description:"",name:"activeView",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}},insightMode:{defaultValue:null,description:"",name:"insightMode",required:!0,type:{name:"enum",value:[{value:'"edit"'},{value:'"view"'}]}},disableTable:{defaultValue:null,description:"",name:"disableTable",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightTabs/InsightDisplayConfig.tsx#InsightDisplayConfig"]={docgenInfo:Nt.__docgenInfo,name:"InsightDisplayConfig",path:"frontend/src/scenes/insights/InsightTabs/InsightDisplayConfig.tsx#InsightDisplayConfig"})}catch(f){}var yt=n("./node_modules/antd/es/button/index.js"),na=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),ke=n.n(na),sn=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/funnels/FunnelCanvasLabel.scss"),on=n.n(sn),tt={};tt.insert="head",tt.singleton=!1;var cn=ke()(on.a,tt),aa=on.a.locals||{},Tt=n("./frontend/src/scenes/funnels/funnelUtils.ts"),wa=n("./node_modules/core-js/modules/es.array.find.js"),wn=n("./frontend/src/lib/components/EntityFilterInfo.tsx");function Ln(){var f,o=Object(g.useValues)(z.c),c=o.insightProps,p=Object(g.useValues)(Object(me.a)(c)),C=p.filters,h=p.numberOfSeries,b=p.areFiltersValid,T=p.filterSteps,I=Object(g.useActions)(Object(me.a)(c)),w=I.changeStepRange;if(C.funnel_viz_type===s.u.Steps)return null;var N=function(J,A){w(J,A)},j=b?Array.from(Array(Math.max(h)).keys()).slice(0,-1):[0],_=b?Array.from(Array(Math.max(h)).keys()).slice(((f=C.funnel_from_step)!==null&&f!==void 0?f:0)+1):[1],D=function(J){return J.map(function(A){var de=T.find(function(U){return U.order===A});return de?e.a.createElement(ye.a.Option,{key:A,value:A,label:"Step ".concat(A+1)},e.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},e.a.createElement("span",{style:{marginRight:4}},"Step ",A+1,":"),e.a.createElement(wn.a,{filter:de}))):null})};return e.a.createElement(Le.a,{className:"funnel-options-inputs"},e.a.createElement("span",{className:"text-muted-alt"},"from"),e.a.createElement(ye.a,{disabled:!b,dropdownMatchSelectWidth:!1,dropdownAlign:M.a.bottomLeft,"data-attr":"funnel-header-steps-funnel_from_step-selector",optionLabelProp:"label",value:C.funnel_from_step||0,onChange:function(J){return N(J,C.funnel_to_step)},style:{marginLeft:4,marginRight:4}},D(j)),e.a.createElement("span",{className:"text-muted-alt"},"to"),e.a.createElement(ye.a,{disabled:!b,dropdownMatchSelectWidth:!1,dropdownAlign:M.a.bottomLeft,"data-attr":"funnel-header-steps-funnel_to_step-selector",optionLabelProp:"label",value:C.funnel_to_step||Math.max(h-1,1),onChange:function(J){return N(C.funnel_from_step,J)},style:{marginLeft:4,marginRight:4}},D(_)))}function ra(){var f=Object(g.useValues)(z.c),o=f.insightProps,c=f.filters,p=f.activeView,C=Object(g.useValues)(Object(me.a)(o)),h=C.conversionMetrics,b=C.aggregationTargetLabel,T=Object(g.useActions)(Object(Ue.a)(o)),I=T.setChartFilter;if(p!==s.y.FUNNELS)return null;var w=[].concat(He()(c.funnel_viz_type===s.u.Steps?[e.a.createElement(e.a.Fragment,null,e.a.createElement("span",{className:"text-muted-alt"},e.a.createElement(H.a,{title:"Overall conversion rate for all ".concat(b.plural," on the entire funnel.")},e.a.createElement(Ge.a,{className:"info-indicator left"})),"Total conversion rate"),e.a.createElement("span",{className:"text-muted-alt mr-025"},":"),e.a.createElement("span",{className:"l4"},Object(Tt.c)(h.totalRate),"%"))]:[]),He()(c.funnel_viz_type!==s.u.Trends?[e.a.createElement(e.a.Fragment,null,e.a.createElement("span",{className:"text-muted-alt"},e.a.createElement(H.a,{title:"Average (arithmetic mean) of the total time each ".concat(b.singular," spent in the entire funnel.")},e.a.createElement(Ge.a,{className:"info-indicator left"})),"Average time to convert"," "),c.funnel_viz_type===s.u.TimeToConvert&&e.a.createElement(Ln,null),e.a.createElement("span",{className:"text-muted-alt mr-025"},":"),e.a.createElement(yt.a,{type:"link",onClick:function(){return I(s.u.TimeToConvert)},disabled:c.funnel_viz_type===s.u.TimeToConvert},e.a.createElement("span",{className:"l4"},Object(M.M)(h.averageTime))))]:[]),He()(c.funnel_viz_type===s.u.Trends?[e.a.createElement(e.a.Fragment,null,e.a.createElement("span",{className:"text-muted-alt"},"Conversion rate "),e.a.createElement(Ln,null))]:[]));return e.a.createElement(Le.a,{className:"funnel-canvas-label",align:"middle"},w.map(function(N,j){return e.a.createElement(e.a.Fragment,{key:j},j>0&&e.a.createElement("span",{style:{margin:"2px 8px",borderLeft:"1px solid var(--border)",height:14}}),N)}))}var ia=n("./frontend/src/lib/hooks/usePeriodicRerender.ts"),Dn=3;function Mn(){var f=Object(g.useValues)(z.c),o=f.lastRefresh,c=Object(g.useActions)(z.c),p=c.loadResults;return Object(ia.a)(15e3),e.a.createElement("div",{className:"text-muted-alt",style:{height:32,display:"flex",alignItems:"center"}},"Computed ",o?Object(Fe.a)(o).fromNow():"a while ago",e.a.createElement("span",{style:{padding:"0 4px"}},"\u2022"),e.a.createElement(Nn.a,{title:e.a.createElement(e.a.Fragment,null,"Insights can be refreshed",e.a.createElement("br",null),"every ",Dn," minutes.")},e.a.createElement(yt.a,{size:"small",type:"link",onClick:function(){return p(!0)},disabled:!!o&&Object(Fe.a)().subtract(Dn-.5,"minutes").isBefore(o),style:{padding:0}},e.a.createElement("span",{style:{fontSize:14}},"Refresh"))))}var Rn=n("./frontend/src/scenes/trends/PersonsModal.tsx"),bt=n("./frontend/src/scenes/trends/viz/index.ts"),Xt=n("./frontend/src/scenes/trends/SaveCohortModal.tsx"),ct=n("./frontend/src/scenes/trends/trendsLogic.ts"),Vt=n("./frontend/src/scenes/insights/InsightsTable/InsightsTable.tsx");try{InsightsTable.displayName="InsightsTable",InsightsTable.__docgenInfo={description:"",displayName:"InsightsTable",props:{isLegend:{defaultValue:{value:"false"},description:"Whether this is just a legend instead of standalone insight viz. Default: false.",name:"isLegend",required:!1,type:{name:"boolean"}},embedded:{defaultValue:{value:"false"},description:"Whether this is table is embedded in another card or whether it should be a card of its own. Default: false.",name:"embedded",required:!1,type:{name:"boolean"}},showTotalCount:{defaultValue:{value:"false"},description:"",name:"showTotalCount",required:!1,type:{name:"boolean"}},filterKey:{defaultValue:null,description:"Key for the entityFilterLogic",name:"filterKey",required:!0,type:{name:"string"}},canEditSeriesNameInline:{defaultValue:{value:"false"},description:"",name:"canEditSeriesNameInline",required:!1,type:{name:"boolean"}},canCheckUncheckSeries:{defaultValue:{value:"true"},description:"(Un)checking series updates the insight via the API, so it should be disabled if updates aren't desired.",name:"canCheckUncheckSeries",required:!1,type:{name:"boolean"}},isMainInsightView:{defaultValue:{value:"false"},description:"",name:"isMainInsightView",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightsTable/index.tsx#InsightsTable"]={docgenInfo:InsightsTable.__docgenInfo,name:"InsightsTable",path:"frontend/src/scenes/insights/InsightsTable/index.tsx#InsightsTable"})}catch(f){}var dt=n("./frontend/src/scenes/trends/personsModalLogic.ts"),dn=n("./frontend/src/lib/utils/eventUsageLogic.ts"),un=n("./frontend/src/scenes/insights/insightSceneLogic.tsx"),An=n("./frontend/src/scenes/insights/WorldMap/index.ts");function a(f){var o=f.view,c=Object(g.useValues)(un.a),p=c.insightMode,C=Object(g.useValues)(z.c),h=C.insightProps,b=Object(g.useValues)(dt.b),T=b.cohortModalVisible,I=Object(g.useActions)(dt.b),w=I.setCohortModalVisible,N=Object(g.useValues)(Object(ct.a)(h)),j=N.filters,_=N.loadMoreBreakdownUrl,D=N.breakdownValuesLoading,Y=N.showModalActions,J=N.aggregationTargetLabel,A=Object(g.useActions)(Object(ct.a)(h)),de=A.loadMoreBreakdownValues,U=Object(g.useValues)(dt.b),W=U.showingPeople,X=Object(g.useActions)(dt.b),ee=X.saveCohortWithUrl,$=Object(g.useActions)(dn.f),Z=$.reportCohortCreatedFromPersonsModal,re=function(){if(!j.display||j.display===s.i.ActionsLineGraph||j.display===s.i.ActionsLineGraphCumulative||j.display===s.i.ActionsBar)return e.a.createElement(bt.b,null);if(j.display===s.i.ActionsTable)return e.a.createElement(g.BindLogic,{logic:ct.a,props:{dashboardItemId:null,view:o,filters:null}},e.a.createElement(Vt.b,{embedded:!0,showTotalCount:!0,filterKey:"trends_".concat(o),canEditSeriesNameInline:p===s.z.Edit,isMainInsightView:!0}));if(j.display===s.i.ActionsPie)return e.a.createElement(bt.c,null);if(j.display===s.i.ActionsBarValue)return e.a.createElement(bt.a,null);if(j.display===s.i.WorldMap)return e.a.createElement(An.a,null)};return e.a.createElement(e.a.Fragment,null,(j.actions||j.events)&&e.a.createElement("div",{className:j.display!==s.i.ActionsTable&&j.display!==s.i.WorldMap?"trends-insights-container":void 0},re()),j.breakdown&&_&&e.a.createElement("div",{className:"mt text-center"},e.a.createElement("div",{className:"text-muted mb"},"For readability, ",e.a.createElement("b",null,"not all breakdown values are displayed"),". Click below to load them."),e.a.createElement("div",null,e.a.createElement(yt.a,{style:{textAlign:"center",marginBottom:16},onClick:de,loading:D},"Load more breakdown values"))),e.a.createElement(Rn.a,{visible:W&&!T,view:o,filters:j,onSaveCohort:function(){w(!0)},showModalActions:Y,aggregationTargetLabel:J}),e.a.createElement(Xt.a,{visible:T,onOk:function(Ye){ee(Ye),w(!1),Z(j)},onCancel:function(){return w(!1)}}))}try{a.displayName="TrendInsight",a.__docgenInfo={description:"",displayName:"TrendInsight",props:{view:{defaultValue:null,description:"",name:"view",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/trends/Trends.tsx#TrendInsight"]={docgenInfo:a.__docgenInfo,name:"TrendInsight",path:"frontend/src/scenes/trends/Trends.tsx#TrendInsight"})}catch(f){}var r=n("./frontend/src/scenes/funnels/Funnel.tsx");function i(){var f=Object(g.useValues)(z.c),o=f.insightProps,c=Object(g.useValues)(Object(me.a)(o)),p=c.isValidFunnel,C=c.insightLoading,h=c.filters,b=c.areFiltersValid,T=c.barGraphLayout,I=c.aggregationTargetLabel,w=Object(g.useValues)(dt.b),N=w.showingPeople,j=w.cohortModalVisible,_=Object(g.useActions)(dt.b),D=_.setCohortModalVisible,Y=p&&b||C,J=h.funnel_viz_type==s.u.Steps&&T===$e.j.vertical;return e.a.createElement(e.a.Fragment,null,e.a.createElement(Rn.a,{visible:N&&!j,view:s.y.FUNNELS,filters:h,onSaveCohort:function(){D(!0)},showModalActions:h.aggregation_group_type_index==null,aggregationTargetLabel:I}),e.a.createElement("div",{className:Object(At.a)("funnel-insights-container",{"non-empty-state":Y,"no-padding":J})},e.a.createElement(r.a,null)))}var l=n("./frontend/src/scenes/retention/RetentionContainer.tsx"),v=n("./frontend/src/scenes/paths/Paths.tsx"),y=n("./frontend/src/scenes/insights/EmptyStates/index.ts");function E(){var f=Object(g.useValues)(z.c),o=f.activeView;return o!==s.y.PATHS?null:e.a.createElement(Le.a,{className:"funnel-canvas-label",align:"middle"},e.a.createElement(e.a.Fragment,null,e.a.createElement("span",{className:"text-muted-alt"},"Large path items are shown by default. View smaller items by hovering over a node")))}var d=n("./node_modules/@ant-design/icons/es/icons/CommentOutlined.js"),u=n("./node_modules/antd/lib/input/TextArea.js"),F=n.n(u),G=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/FunnelCorrelation.scss"),L=n.n(G),q={};q.insert="head",q.singleton=!1;var k=ke()(L.a,q),m=L.a.locals||{},pe=n("./node_modules/core-js/modules/es.number.constructor.js"),Je=n("./node_modules/core-js/modules/es.number.is-integer.js"),qe=n("./node_modules/core-js/modules/es.number.to-fixed.js"),xt=n("./node_modules/core-js/modules/es.regexp.exec.js"),B=n("./node_modules/core-js/modules/es.string.split.js"),Ot=n("./node_modules/antd/es/spin/index.js"),nt=n("./node_modules/antd/es/table/index.js"),fe=n("./node_modules/antd/lib/table/Column.js"),ae=n.n(fe),Pe=n("./node_modules/@ant-design/icons/es/icons/RiseOutlined.js"),Re=n("./node_modules/@ant-design/icons/es/icons/FallOutlined.js"),ft=n("./node_modules/@ant-design/icons/es/icons/EllipsisOutlined.js"),ve=n("./frontend/src/lib/components/icons.tsx"),Be=n("./node_modules/antd/lib/checkbox/Checkbox.js"),we=n.n(Be),at=n("./frontend/src/scenes/funnels/FunnelBarGraph.tsx"),ut=n("./frontend/src/lib/components/PropertyKeyInfo.tsx"),la=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/InsightTabs/FunnelTab/FunnelCorrelationTable.scss"),rt=n.n(la),mn={};mn.insert="head",mn.singleton=!1;var La=ke()(rt.a,mn),Xe=rt.a.locals||{},_t=n("./frontend/src/lib/components/VisibilitySensor/visibilitySensorLogic.tsx");function kt(f){var o=f.id,c=f.offset,p=f.children,C=Object(g.useActions)(Object(_t.a)({id:o,offset:c})),h=C.scrolling,b=Object(Me.useRef)(null);return Object(Me.useEffect)(function(){var T=b.current;return document.addEventListener("scroll",function(){return h(T)}),function(){return document.removeEventListener("scroll",function(){return h(T)})}},[b.current]),e.a.createElement("div",{ref:b},p)}try{kt.displayName="VisibilitySensor",kt.__docgenInfo={description:"",displayName:"VisibilitySensor",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},offset:{defaultValue:null,description:"",name:"offset",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/VisibilitySensor/VisibilitySensor.tsx#VisibilitySensor"]={docgenInfo:kt.__docgenInfo,name:"VisibilitySensor",path:"frontend/src/lib/components/VisibilitySensor/VisibilitySensor.tsx#VisibilitySensor"})}catch(f){}var Ct=n("./frontend/src/lib/components/LemonButton/index.ts"),Bt=n("./frontend/src/lib/components/Popup/Popup.tsx"),sa=n("./node_modules/antd/es/modal/index.js"),Vn=n("./node_modules/@ant-design/icons/es/icons/CheckCircleFilled.js"),oa=n("./node_modules/@ant-design/icons/es/icons/MinusCircleOutlined.js"),ca=n("./node_modules/@ant-design/icons/es/icons/CloseCircleOutlined.js"),da=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/InsightTabs/FunnelTab/CorrelationMatrix.scss"),_n=n.n(da),pn={};pn.insert="head",pn.singleton=!1;var Da=ke()(_n.a,pn),Ma=_n.a.locals||{},ua=n("./frontend/src/lib/components/Spinner/Spinner.tsx"),Qt=n("./frontend/src/lib/components/Link.tsx"),ma=n("./frontend/src/lib/components/InlineMessage/InlineMessage.tsx");function pa(){var f=Object(g.useValues)(z.c),o=f.insightProps,c=Object(me.a)(o),p=Object(g.useValues)(c),C=p.correlationsLoading,h=p.funnelCorrelationDetails,b=p.parseDisplayNameForCorrelation,T=p.correlationMatrixAndScore,I=Object(g.useActions)(c),w=I.setFunnelCorrelationDetails,N=I.openCorrelationPersonsModal,j=(h==null?void 0:h.result_type)===s.q.Events?"event":"property",_=(h==null?void 0:h.result_type)===s.q.Events?"performed event":"have property",D=e.a.createElement(e.a.Fragment,null);if(h){var Y=b(h),J=Y.first_value,A=Y.second_value;D=e.a.createElement(e.a.Fragment,null,e.a.createElement(ut.a,{value:J}),A!==void 0&&e.a.createElement(e.a.Fragment,null," :: ",e.a.createElement(ut.a,{value:A,disablePopover:!0})))}var de=T.correlationScore,U=T.truePositive,W=T.falsePositive,X=T.trueNegative,ee=T.falseNegative,$=T.correlationScoreStrength,Z=$==="strong"?e.a.createElement(Vn.a,{style:{color:"var(--success)"}}):$==="moderate"?e.a.createElement(oa.a,{style:{color:"var(--warning)"}}):e.a.createElement(ca.a,{style:{color:"var(--danger)"}}),re=function(){return w(null)};return e.a.createElement(sa.a,{className:"correlation-matrix",visible:!!h,onCancel:re,destroyOnClose:!0,footer:e.a.createElement(yt.a,{onClick:re},"Dismiss"),width:600,title:"Correlation details"},e.a.createElement("div",{className:"correlation-table-wrapper"},C?e.a.createElement("div",{className:"mt text-center"},e.a.createElement(ua.a,{size:"lg"})):h?e.a.createElement(e.a.Fragment,null,e.a.createElement("p",{className:"text-muted-alt mb"},"The table below displays the correlation details for users who ",_," ",e.a.createElement("b",null,D),"."),e.a.createElement("table",null,e.a.createElement("thead",null,e.a.createElement("tr",{className:"table-title"},e.a.createElement("td",{colSpan:3},"Results matrix")),e.a.createElement("tr",null,e.a.createElement("td",null,(h==null?void 0:h.result_type)===s.q.Events?"Performed event":"Has property"),e.a.createElement("td",null,"Success"),e.a.createElement("td",null,"Dropped off"))),e.a.createElement("tbody",null,e.a.createElement("tr",null,e.a.createElement("td",{className:"horizontal-header"},"Yes"),e.a.createElement("td",null,e.a.createElement(H.a,{title:"True positive (TP) - Percentage of users who ".concat(_," and completed the funnel.")},e.a.createElement("div",{className:"percentage"},U?Object(M.nb)(U/(U+W)):"0.00%")),U===0?"0 users":e.a.createElement(Qt.a,{onClick:function(){N(h,!0)}},Object(M.pb)(U,"user",void 0,!0))),e.a.createElement("td",null,e.a.createElement("div",{className:"percentage"},e.a.createElement(H.a,{title:"False negative (FN) - Percentage of users who ".concat(_," and did not complete the funnel.")},ee?Object(M.nb)(ee/(ee+X)):"0.00%")),ee===0?"0 users":e.a.createElement(Qt.a,{onClick:function(){N(h,!1)}},Object(M.pb)(ee,"user",void 0,!0)))),e.a.createElement("tr",null,e.a.createElement("td",{className:"horizontal-header"},"No"),e.a.createElement("td",null,e.a.createElement("div",{className:"percentage"},e.a.createElement(H.a,{title:"False positive (FP) - Percentage of users who did not ".concat(_," and completed the funnel.")},W?Object(M.nb)(W/(U+W)):"0.00%")),Object(M.pb)(W,"user",void 0,!0)),e.a.createElement("td",null,e.a.createElement("div",{className:"percentage"},e.a.createElement(H.a,{title:"True negative (TN) - Percentage of users who did not ".concat(_," and did not complete the funnel.")},X?Object(M.nb)(X/(ee+X)):"0.00%")),Object(M.pb)(X,"user",void 0,!0))),e.a.createElement("tr",null,e.a.createElement("td",{className:"horizontal-header"}),e.a.createElement("td",null,e.a.createElement("b",null,"100%")),e.a.createElement("td",null,e.a.createElement("b",null,"100%"))))),e.a.createElement("div",{className:"mt text-center"},Object(M.i)((h==null?void 0:h.result_type)||"")," ",e.a.createElement("b",null,D)," ","has a"," ",(h==null?void 0:h.correlation_type)===s.r.Success?e.a.createElement("b",{className:"text-success"},"positive"," ",e.a.createElement(H.a,{title:"Positive correlation means this ".concat(j," is correlated with a successful conversion.")},e.a.createElement(Ge.a,{className:"cursor-pointer"}))):e.a.createElement("b",{className:"text-danger"},"negative"," ",e.a.createElement(H.a,{title:"Negative correlation means this ".concat(j," is correlated with an unsuccessful conversion (user dropped off).")},e.a.createElement(Ge.a,{className:"cursor-pointer"})))," ","correlation score of"," ",e.a.createElement("b",{style:{color:$==="strong"?"var(--success)":$==="moderate"?"var(--warning)":"var(--danger)"}},e.a.createElement(H.a,{title:"This ".concat(j," has ").concat($," correlation.")},e.a.createElement("span",{style:{cursor:"pointer"}},Z," ",de.toFixed(3)))))):e.a.createElement("div",null,e.a.createElement(ma.a,{type:"danger"},"We could not load the details for this correlation value. Please recreate your funnel and try again."))))}function fa(){var f=Object(g.useValues)(z.c),o=f.insightProps,c=Object(me.a)(o),p=Object(g.useValues)(c),C=p.stepsWithCount,h=p.correlationValues,b=p.correlationTypes,T=p.eventHasPropertyCorrelations,I=p.eventWithPropertyCorrelationsValues,w=p.parseDisplayNameForCorrelation,N=p.correlationsLoading,j=p.eventWithPropertyCorrelationsLoading,_=p.nestedTableExpandedKeys,D=p.correlationPropKey,Y=p.filters,J=p.aggregationTargetLabel,A=Object(g.useActions)(c),de=A.setCorrelationTypes,U=A.loadEventWithPropertyCorrelations,W=A.addNestedTableExpandedKey,X=A.removeNestedTableExpandedKey,ee=A.openCorrelationPersonsModal,$=A.loadCorrelations,Z=Object(g.useActions)(dn.f),re=Z.reportCorrelationInteraction;Object(Me.useEffect)(function(){$({})},[Y]);var ge=function(ie){b?b.includes(ie)?de(b.filter(function(Se){return Se!==ie})):de([].concat(He()(b),[ie])):de([ie])},Ye=function(ie){var Se=function(Hn){return Hn<10&&!Number.isInteger(Hn)?Hn.toFixed(1):Hn.toFixed()},ze=ie.correlation_type===s.r.Success,De=w(ie),Ft=De.first_value,zn=De.second_value;return e.a.createElement(e.a.Fragment,null,e.a.createElement("h4",null,ze?e.a.createElement(Pe.a,{style:{color:"green"}}):e.a.createElement(Re.a,{style:{color:"red"}})," ",e.a.createElement(ut.a,{value:Ft}),zn!==void 0&&e.a.createElement(e.a.Fragment,null," :: ",e.a.createElement(ut.a,{value:zn,disablePopover:!0}))),e.a.createElement("div",null,Object(M.i)(J.plural)," ",Y.aggregation_group_type_index!=null?"that":"who"," converted were"," ",e.a.createElement("mark",null,e.a.createElement("b",null,Se(ie.odds_ratio),"x ",ze?"more":"less"," likely"))," ","to"," ",ie.result_type===s.q.EventWithProperties?"have this event property":"do this event"),e.a.createElement(pa,null))},je=function(ie){return e.a.createElement(at.c,{onClick:function(){ee(ie,!0)}},ie.success_count)},te=function(ie){return e.a.createElement(at.c,{onClick:function(){ee(ie,!1)}},ie.failure_count)},ue=function(ie){return j?e.a.createElement("div",{className:"nested-properties-loading"},e.a.createElement(Ot.a,null),e.a.createElement("h3",null,"Loading correlation results"),e.a.createElement("p",null,"This process can take up to 20 seconds. ")):e.a.createElement("div",null,e.a.createElement("h4",{style:{paddingLeft:16}},"Correlated properties"),e.a.createElement(nt.a,{dataSource:I[ie],rowKey:function(ze){return ze.event.event},className:"nested-properties-table",scroll:{x:"max-content"},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(ze,De){return re(s.q.EventWithProperties,"pagination change",{page:ze,page_size:De})}}},e.a.createElement(ae.a,{title:"Property",key:"eventName",render:function(ze,De){return Ye(De)},align:"left"}),e.a.createElement(ae.a,{title:"Completed",key:"success_count",render:function(ze,De){return je(De)},width:90,align:"center"}),e.a.createElement(ae.a,{title:"Dropped off",key:"failure_count",render:function(ze,De){return te(De)},width:120,align:"center"}),e.a.createElement(ae.a,{title:"",key:"actions",render:function(ze,De){return e.a.createElement(kn,{record:De})},align:"center",width:30})))};return C.length>1?e.a.createElement(kt,{id:D,offset:152},e.a.createElement("div",{className:"funnel-correlation-table"},e.a.createElement("span",{className:"funnel-correlation-header"},e.a.createElement("span",{className:"table-header"},e.a.createElement(ve.IconSelectEvents,{style:{marginRight:4,fontSize:24,opacity:.5}}),"CORRELATED EVENTS"),e.a.createElement("span",{className:"table-options"},e.a.createElement("p",{className:"title"},"CORRELATION"),e.a.createElement("div",{className:"tab-btn ant-btn",style:{paddingTop:"1px",paddingBottom:"1px",borderTopRightRadius:0,borderBottomRightRadius:0},onClick:function(){return ge(s.r.Success)}},e.a.createElement(we.a,{checked:b.includes(s.r.Success),style:{pointerEvents:"none"}},"Success")),e.a.createElement("div",{className:"tab-btn ant-btn",style:{marginRight:"8px",paddingTop:"1px",paddingBottom:"1px",borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:function(){return ge(s.r.Failure)}},e.a.createElement(we.a,{checked:b.includes(s.r.Failure),style:{pointerEvents:"none"}},"Dropoff")))),e.a.createElement(nt.a,{dataSource:h,loading:N,size:"small",scroll:{x:"max-content"},rowKey:function(ie){return ie.event.event},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(){return re(s.q.Events,"load more")}},expandable:{expandedRowRender:function(ie){return ue(ie.event.event)},expandedRowKeys:_,rowExpandable:function(){return Y.aggregation_group_type_index===void 0},expandIcon:function(ie){var Se=ie.expanded,ze=ie.onExpand,De=ie.record,Ft=ie.expandable;return Ft?Se?e.a.createElement(H.a,{title:"Collapse"},e.a.createElement("div",{style:{cursor:"pointer",opacity:.5,fontSize:24},onClick:function($n){X(De.event.event),ze(De,$n)}},e.a.createElement(ve.IconUnfoldLess,null))):e.a.createElement(H.a,{title:"Expand to see correlated properties for this event"},e.a.createElement("div",{style:{cursor:"pointer",opacity:.5,fontSize:24},onClick:function($n){!T(De.event.event)&&U(De.event.event),W(De.event.event),ze(De,$n)}},e.a.createElement(ve.IconUnfoldMore,null))):null}}},e.a.createElement(ae.a,{title:"Event",key:"eventName",render:function(ie,Se){return Ye(Se)},align:"left",ellipsis:!0}),e.a.createElement(ae.a,{title:e.a.createElement("div",{className:"flex-center"},"Completed",e.a.createElement(H.a,{title:"".concat(Object(M.i)(J.plural)," ").concat(Y.aggregation_group_type_index!=null?"that":"who"," performed the event and completed the entire funnel.")},e.a.createElement(Ge.a,{className:"column-info"}))),key:"success_count",render:function(ie,Se){return je(Se)},width:90,align:"center"}),e.a.createElement(ae.a,{title:e.a.createElement("div",{className:"flex-center"},"Dropped off",e.a.createElement(H.a,{title:e.a.createElement(e.a.Fragment,null,Object(M.i)(J.plural)," ",Y.aggregation_group_type_index!=null?"that":"who"," ","performed the event and did ",e.a.createElement("b",null,"not complete")," the entire funnel.")},e.a.createElement(Ge.a,{className:"column-info"}))),key:"failure_count",render:function(ie,Se){return te(Se)},width:120,align:"center"}),e.a.createElement(ae.a,{title:"",key:"actions",render:function(ie,Se){return e.a.createElement(kn,{record:Se})},width:30})))):null}var kn=function(o){var c=o.record,p=Object(g.useValues)(z.c),C=p.insightProps,h=Object(me.a)(C),b=Object(g.useActions)(h),T=b.excludeEventPropertyFromProject,I=b.excludeEventFromProject,w=b.setFunnelCorrelationDetails,N=Object(g.useValues)(h),j=N.isEventPropertyExcluded,_=N.isEventExcluded,D=c.event.event.split("::"),Y=Object(Me.useState)(!1),J=lt()(Y,2),A=J[0],de=J[1];return e.a.createElement(Le.a,{style:{justifyContent:"flex-end"}},e.a.createElement(Bt.a,{visible:A,actionable:!0,onClickOutside:function(){return de(!1)},overlay:e.a.createElement(e.a.Fragment,null,c.result_type===s.q.Events&&e.a.createElement(Ct.a,{onClick:function(){return w(c)},fullWidth:!0,type:"stealth"},"View correlation details"),e.a.createElement(Ct.a,{disabled:c.result_type===s.q.EventWithProperties?j(D[1]):_(D[0]),onClick:function(){return c.result_type===s.q.EventWithProperties?T(D[0],D[1]):I(D[0])},fullWidth:!0,title:"Remove this event from any correlation analysis report in this project.",type:"stealth"},"Exclude event from project"))},e.a.createElement(Ct.a,{type:"stealth",onClick:function(){return de(!A)}},e.a.createElement(ft.a,{style:{color:"var(--primary)",fontSize:24},className:"insight-dropdown-actions"}))))},Bn=n("./frontend/src/lib/components/PropertyNamesSelect/PropertyNamesSelect.tsx");function fn(){var f=Object(g.useValues)(z.c),o=f.insightProps,c=Object(me.a)(o),p=Object(g.useValues)(c),C=p.stepsWithCount,h=p.propertyCorrelationValues,b=p.propertyCorrelationTypes,T=p.excludedPropertyNames,I=p.parseDisplayNameForCorrelation,w=p.propertyCorrelationsLoading,N=p.inversePropertyNames,j=p.propertyNames,_=p.correlationPropKey,D=p.allProperties,Y=p.filters,J=p.aggregationTargetLabel,A=Object(g.useActions)(c),de=A.setPropertyCorrelationTypes,U=A.setPropertyNames,W=A.openCorrelationPersonsModal,X=A.loadPropertyCorrelations,ee=Object(g.useActions)(dn.f),$=ee.reportCorrelationInteraction;Object(Me.useEffect)(function(){j.length===0&&U(D),X({})},[Y]);var Z=function(te){b?b.includes(te)?de(b.filter(function(ue){return ue!==te})):de([].concat(He()(b),[te])):de([te])},re=function(te){return e.a.createElement(at.c,{onClick:function(){W(te,!0)}},te.success_count)},ge=function(te){return e.a.createElement(at.c,{onClick:function(){W(te,!1)}},te.failure_count)},Ye=function(te){var ue=function(Ft){return Ft<10&&!Number.isInteger(Ft)?Ft.toFixed(1):Ft.toFixed()},Ke=te.correlation_type===s.r.Success,ie=I(te),Se=ie.first_value,ze=ie.second_value;return e.a.createElement(e.a.Fragment,null,e.a.createElement("h4",null,Ke?e.a.createElement(Pe.a,{style:{color:"green"}}):e.a.createElement(Re.a,{style:{color:"red"}})," ",e.a.createElement(ut.a,{value:Se}),ze!==void 0&&e.a.createElement(e.a.Fragment,null," :: ",e.a.createElement(ut.a,{value:ze,disablePopover:!0}))),e.a.createElement("div",null,Object(M.i)(J.plural)," ",Y.aggregation_group_type_index!=null?"that":"who"," converted were"," ",e.a.createElement("mark",null,e.a.createElement("b",null,ue(te.odds_ratio),"x ",Ke?"more":"less"," likely"))," ","to have this property value"))};return C.length>1?e.a.createElement(kt,{offset:150,id:"".concat(_,"-properties")},e.a.createElement("div",{className:"funnel-correlation-table"},e.a.createElement(Le.a,{className:"funnel-correlation-header"},e.a.createElement(Ve.a,{className:"table-header"},e.a.createElement(ve.IconSelectProperties,{style:{marginRight:4,opacity:.5,fontSize:24}}),"CORRELATED PROPERTIES"),e.a.createElement(Ve.a,{className:"table-options"},e.a.createElement(Le.a,{style:{display:"contents"}},D.length>0&&e.a.createElement(e.a.Fragment,null,e.a.createElement("p",{className:"title"},"PROPERTIES "),e.a.createElement(Bn.a,{value:new Set(j),onChange:function(te){return U(te)},allProperties:N(T||[])}))),e.a.createElement(Le.a,{style:{display:"contents"}},e.a.createElement("p",{className:"title",style:{marginLeft:8}},"CORRELATION"),e.a.createElement("div",{className:"tab-btn ant-btn",style:{paddingTop:"1px",paddingBottom:"1px",borderTopRightRadius:0,borderBottomRightRadius:0},onClick:function(){return Z(s.r.Success)}},e.a.createElement(we.a,{checked:b.includes(s.r.Success),style:{pointerEvents:"none"}},"Success")),e.a.createElement("div",{className:"tab-btn ant-btn",style:{marginRight:"8px",paddingTop:"1px",paddingBottom:"1px",borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:function(){return Z(s.r.Failure)}},e.a.createElement(we.a,{checked:b.includes(s.r.Failure),style:{pointerEvents:"none"}},"Dropoff"))))),e.a.createElement(nt.a,{dataSource:h,loading:w,scroll:{x:"max-content"},size:"small",rowKey:function(te){return te.event.event},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(te,ue){return $(s.q.Properties,"pagination change",{page:te,page_size:ue})}}},e.a.createElement(ae.a,{title:"".concat(Object(M.i)(J.singular)," property"),key:"propertName",render:function(te,ue){return Ye(ue)},align:"left"}),e.a.createElement(ae.a,{title:e.a.createElement("div",{className:"flex-center"},"Completed",e.a.createElement(H.a,{title:"".concat(Object(M.i)(J.plural)," ").concat(Y.aggregation_group_type_index!=null?"that":"who"," have this property and completed the entire funnel.")},e.a.createElement(Ge.a,{className:"column-info"}))),key:"success_count",render:function(te,ue){return re(ue)},width:90,align:"center"}),e.a.createElement(ae.a,{title:e.a.createElement("div",{className:"flex-center"},"Dropped off",e.a.createElement(H.a,{title:e.a.createElement(e.a.Fragment,null,Object(M.i)(J.plural)," ",Y.aggregation_group_type_index!=null?"that":"who"," have this property and did ",e.a.createElement("b",null,"not complete")," the entire funnel.")},e.a.createElement(Ge.a,{className:"column-info"}))),key:"failure_count",render:function(te,ue){return ge(ue)},width:120,align:"center"}),e.a.createElement(ae.a,{title:"",key:"actions",render:function(te,ue){return e.a.createElement(vn,{record:ue})},align:"center",width:30})))):null}var vn=function(o){var c=o.record,p=Object(g.useValues)(z.c),C=p.insightProps,h=Object(me.a)(C),b=Object(g.useActions)(h),T=b.excludePropertyFromProject,I=b.setFunnelCorrelationDetails,w=Object(g.useValues)(h),N=w.isPropertyExcludedFromProject,j=(c.event.event||"").split("::")[0],_=Object(Me.useState)(!1),D=lt()(_,2),Y=D[0],J=D[1];return e.a.createElement(Le.a,{style:{justifyContent:"flex-end"}},e.a.createElement(Bt.a,{visible:Y,actionable:!0,onClickOutside:function(){return J(!1)},overlay:e.a.createElement(e.a.Fragment,null,e.a.createElement(Ct.a,{onClick:function(){return I(c)},fullWidth:!0,type:"stealth"},"View correlation details"),e.a.createElement(Ct.a,{disabled:N(j),onClick:function(){return T(j)},fullWidth:!0,title:"Remove this property from any correlation analysis report in this project.",type:"stealth"},"Exclude property from project"))},e.a.createElement(Ct.a,{type:"stealth",onClick:function(){return J(!Y)}},e.a.createElement(ft.a,{style:{color:"var(--primary)",fontSize:24},className:"insight-dropdown-actions"}))))},Kn=n("./node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),gn=n("./frontend/src/lib/components/PayCard/PayCard.tsx"),Kt=n("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),va=function(){var o,c=Object(g.useValues)(z.c),p=c.insightProps,C=Object(g.useValues)(Object(me.a)(p)),h=C.isSkewed,b=C.stepsWithCount,T=C.correlationFeedbackHidden,I=C.correlationDetailedFeedbackVisible,w=C.correlationFeedbackRating,N=C.correlationAnalysisAvailable,j=C.aggregationTargetLabel,_=Object(g.useActions)(Object(me.a)(p)),D=_.sendCorrelationAnalysisFeedback,Y=_.hideSkewWarning,J=_.hideCorrelationAnalysisFeedback,A=_.setCorrelationFeedbackRating,de=_.setCorrelationDetailedFeedback,U=Object(g.useValues)(Kt.a),W=U.preflight,X=Object(Me.useRef)(null);return b.length<=1?null:!N&&!(!(W==null||(o=W.instance_preferences)===null||o===void 0)&&o.disable_paid_fs)?e.a.createElement(gn.a,{identifier:s.d.CORRELATION_ANALYSIS,title:"Get a deeper understanding of why your ".concat(j.plural," are not converting"),caption:"Correlation analysis automatically finds signals for why ".concat(j.plural," are converting or dropping off.")}):e.a.createElement(e.a.Fragment,null,e.a.createElement("h2",{style:{margin:"1rem 0"}},"Correlation analysis"),e.a.createElement("div",{className:"funnel-correlation"},h&&e.a.createElement(Qe.a,{className:"skew-warning"},e.a.createElement("h4",null,e.a.createElement(ve.IconFeedbackWarning,{style:{fontSize:24,marginRight:4,color:"var(--warning)"}})," ","Adjust your funnel definition to improve correlation analysis",e.a.createElement(Kn.a,{className:"close-button",onClick:Y})),e.a.createElement("div",null,e.a.createElement("b",null,"Tips for adjusting your funnel:"),e.a.createElement("ol",null,e.a.createElement("li",null,"Adjust your first funnel step to be more specific. For example, choose a page or an event that occurs less frequently."),e.a.createElement("li",null,"Choose an event that happens more frequently for subsequent funnels steps.")))),e.a.createElement(fa,null),!T&&e.a.createElement(Qe.a,{className:"correlation-feedback"},e.a.createElement(Le.a,{className:"row-initial"},e.a.createElement(Ve.a,{span:14},e.a.createElement("h4",null,e.a.createElement(d.a,{style:{marginRight:4}}),"Was this correlation analysis report useful?")),e.a.createElement(Ve.a,{span:9,style:{alignContent:"right"}},!!w&&e.a.createElement("i",{style:{color:"var(--success)",marginRight:8}},"Thanks for your feedback!"),[[5,"\u{1F60D}"],[4,"\u{1F600}"],[3,"\u{1F634}"],[2,"\u{1F614}"],[1,"\u{1F44E}"]].map(function(ee,$){return e.a.createElement(yt.a,{key:$,className:"emoji-button",style:w===ee[0]?{background:"#5375FF"}:w?{display:"none"}:{},onClick:function(){w===ee[0]?A(0):(A(ee[0]),setTimeout(function(){var re;return(re=X.current)===null||re===void 0?void 0:re.focus()},100))}},ee[1])})),e.a.createElement(Ve.a,{span:1},e.a.createElement(Kn.a,{className:"close-button",onClick:J}))),e.a.createElement("div",{style:{display:I?void 0:"none"}},e.a.createElement("form",{onSubmit:D},e.a.createElement(F.a,{onBlur:function($){return de($.target.value)},placeholder:"Optional. Help us by sharing details around your experience...",style:{marginTop:16},ref:X,onKeyDown:function($){if($.key==="Enter"&&$.metaKey){var Z;(Z=X.current)===null||Z===void 0||Z.blur(),D()}}}),e.a.createElement("div",{className:"text-right"},e.a.createElement(yt.a,{className:"feedback-button","data-attr":"correlation-analysis-share-feedback",type:"primary",htmlType:"submit"},"Share feedback"))))),e.a.createElement(fn,null)))},Ra=n("./node_modules/core-js/modules/es.regexp.to-string.js"),Un=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/lib/components/InsightLegend/InsightLegend.scss"),Zt=n.n(Un),hn={};hn.insert="head",hn.singleton=!1;var ga=ke()(Zt.a,hn),Wn=Zt.a.locals||{},ha=n("./frontend/src/lib/components/InsightLabel/index.tsx"),En=n("./frontend/src/lib/colors.ts"),yn=n("./frontend/src/lib/components/LemonCheckbox/index.ts");function Yn(){var f=Object(g.useValues)(z.c),o=f.filters,c=f.activeView,p=Object(g.useActions)(z.c),C=p.toggleInsightLegend,h=Object(g.useValues)(Te.a),b=h.featureFlags;return(c===s.y.TRENDS&&o.display!==s.i.WorldMap&&o.display!==s.i.ActionsTable||c===s.y.STICKINESS)&&b[$e.h.INSIGHT_LEGENDS]?e.a.createElement(yt.a,{className:"insight-legend-button",onClick:C},e.a.createElement(ve.IconLegend,null),e.a.createElement("span",{className:"insight-legend-button-title"},o.show_legend?"Hide":"Show"," legend")):null}function bn(){var f=Object(g.useValues)(z.c),o=f.insightProps,c=f.filters,p=Object(ct.a)(o),C=Object(g.useValues)(p),h=C.indexedResults,b=C.hiddenLegendKeys,T=Object(g.useActions)(p),I=T.toggleVisibility,w=Object(En.c)("white",h.length,!!c.compare);return e.a.createElement("div",{className:"insight-legend-menu"},e.a.createElement("div",{className:"insight-legend-menu-scroll"},h&&h.map(function(N){var j,_;return e.a.createElement(Le.a,{key:N.id,className:"insight-legend-menu-item",wrap:!1},e.a.createElement(yn.a,{className:"insight-legend-menu-item-inner",color:w[N.id],checked:!b[N.id],onChange:function(){return I(N.id)},rowProps:{fullWidth:!0},label:e.a.createElement(ha.b,{key:N.id,seriesColor:w[N.id],action:N.action,fallbackName:N.breakdown_value===""?"None":N.label,hasMultipleSeries:h.length>1,breakdownValue:N.breakdown_value===""?"None":(j=N.breakdown_value)===null||j===void 0?void 0:j.toString(),compareValue:c.compare?Object(Vt.d)(N):void 0,pillMidEllipsis:(N==null||(_=N.filter)===null||_===void 0?void 0:_.breakdown)==="$current_url",hideIcon:!0})}))})))}var Ea=n("./node_modules/core-js/modules/es.array.every.js"),ya=n("./node_modules/core-js/modules/es.array.flat-map.js"),Ut=n("./node_modules/core-js/modules/es.array.some.js"),xn=n("./node_modules/core-js/modules/es.array.unscopables.flat-map.js"),Aa=n("./node_modules/core-js/modules/es.object.from-entries.js"),ba=n("./frontend/src/lib/components/LemonTable/index.ts"),qt=n("./frontend/src/scenes/insights/InsightTabs/FunnelTab/funnelStepTableUtils.tsx"),xa=n("./frontend/src/models/cohortsModel.ts"),V=n("./frontend/src/lib/components/Lettermark/Lettermark.tsx"),R=n("./frontend/src/lib/components/LemonRow/index.ts");function Ae(){var f=Object(g.useValues)(z.c),o=f.insightProps,c=Object(me.a)(o),p=Object(g.useValues)(c),C=p.insightLoading,h=p.steps,b=p.flattenedBreakdowns,T=p.hiddenLegendKeys,I=p.visibleStepsWithConversionMetrics,w=Object(g.useActions)(c),N=w.setHiddenById,j=w.toggleVisibilityByBreakdown,_=w.openPersonsModalForSeries,D=Object(g.useValues)(xa.a),Y=D.cohorts,J=b.length===1,A=b==null?void 0:b.every(function(U){return!T[Object(Tt.m)(I==null?void 0:I[0],U.breakdown_value)]}),de=[{children:[{title:J?"Breakdown":e.a.createElement(yn.a,{checked:A||(b!=null&&b.some(function(U){return!T[Object(Tt.m)(I==null?void 0:I[0],U.breakdown_value)]})?"indeterminate":!1),onChange:function(){N(Object.fromEntries(I.flatMap(function(W){return b.map(function(X){return[Object(Tt.m)(W,X.breakdown_value),A]})})))},label:"Breakdown",rowProps:{size:"small",style:{padding:0,marginLeft:"-0.5rem",font:"inherit"}}}),dataIndex:"breakdown_value",render:function(W){var X=Object(Vt.c)(Y,W);return J?e.a.createElement("span",{style:{fontWeight:500}},X):e.a.createElement(yn.a,{checked:!T[Object(Tt.m)(I==null?void 0:I[0],W)],onChange:function(){return j(W)},label:X,rowProps:{size:"small",style:{padding:0,marginLeft:"-0.5rem",maxWidth:"16rem"},title:X}})}},{title:"Total conversion",render:function(W,X){var ee,$;return Object(M.nb)((ee=X==null||($=X.conversionRates)===null||$===void 0?void 0:$.total)!==null&&ee!==void 0?ee:0,1,!0)},align:"right"}]}].concat(He()(h.map(function(U,W){return{title:e.a.createElement(R.a,{icon:e.a.createElement(V.a,{name:W+1,color:V.b.Gray}),style:{font:"inherit",padding:0},size:"small"},e.a.createElement(wn.a,{filter:Object(qt.b)(U)})),children:[{title:W===0?"Entered":"Converted",render:function(ee,$){var Z,re,ge=(Z=$.steps)===null||Z===void 0?void 0:Z[W];return ge&&e.a.createElement(at.c,{onClick:function(){return _({step:U,series:ge,converted:!0})},style:{padding:0}},Object(M.N)((re=ge.count)!==null&&re!==void 0?re:0))},align:"right"}].concat(He()(W===0?[]:[{title:"Dropped\xA0off",render:function(ee,$){var Z,re,ge=(Z=$.steps)===null||Z===void 0?void 0:Z[W];return ge&&e.a.createElement(at.c,{onClick:function(){return _({step:U,series:ge,converted:!1})},style:{padding:0}},Object(M.N)((re=ge.droppedOffFromPrevious)!==null&&re!==void 0?re:0))},align:"right"}]),[{title:"Conversion so\xA0far",render:function(ee,$){var Z,re,ge,Ye,je,te,ue=Object(qt.c)($,U.order);return ue!=null&&ue.total?e.a.createElement(R.a,{className:"significance-highlight",tooltip:"Significantly different from other breakdown values",icon:e.a.createElement(ve.IconFlag,null),size:"small"},Object(M.nb)((Z=(re=$.steps)===null||re===void 0||(ge=re[U.order])===null||ge===void 0?void 0:ge.conversionRates.total)!==null&&Z!==void 0?Z:0,1,!0)):Object(M.nb)((Ye=(je=$.steps)===null||je===void 0||(te=je[U.order])===null||te===void 0?void 0:te.conversionRates.total)!==null&&Ye!==void 0?Ye:0,1,!0)},align:"right"}],He()(W===0?[]:[{title:"Conversion from\xA0previous",render:function(ee,$){var Z,re,ge,Ye,je,te,ue=Object(qt.c)($,U.order);return!(ue!=null&&ue.total)&&(ue==null?void 0:ue.fromPrevious)?e.a.createElement(R.a,{className:"significance-highlight",tooltip:"Significantly different from other breakdown values",icon:e.a.createElement(ve.IconFlag,null),size:"small"},Object(M.nb)((Z=(re=$.steps)===null||re===void 0||(ge=re[U.order])===null||ge===void 0?void 0:ge.conversionRates.fromPrevious)!==null&&Z!==void 0?Z:0,1,!0)):Object(M.nb)((Ye=(je=$.steps)===null||je===void 0||(te=je[U.order])===null||te===void 0?void 0:te.conversionRates.fromPrevious)!==null&&Ye!==void 0?Ye:0,1,!0)},align:"right"},{title:"Avg.\xA0time",render:function(ee,$){var Z,re;return((Z=$.steps)===null||Z===void 0||(re=Z[U.order])===null||re===void 0?void 0:re.average_conversion_time)!=null?Object(M.M)($.steps[U.order].average_conversion_time,3):"\u2013"},align:"right",width:0,className:"no-wrap"}]))}})));return e.a.createElement(ba.a,{dataSource:b,columns:de,loading:C,rowKey:"breakdownIndex",rowStatus:function(W){return W.significant?"highlighted":void 0},rowRibbonColor:function(W){return Object(Tt.k)(W==null?void 0:W.breakdownIndex,b.length===1,void 0,b.length)}})}var Ie,Wt=(Ie={},he()(Ie,"".concat(s.y.TRENDS),e.a.createElement(a,{view:s.y.TRENDS})),he()(Ie,"".concat(s.y.STICKINESS),e.a.createElement(a,{view:s.y.STICKINESS})),he()(Ie,"".concat(s.y.LIFECYCLE),e.a.createElement(a,{view:s.y.LIFECYCLE})),he()(Ie,"".concat(s.y.FUNNELS),e.a.createElement(i,null)),he()(Ie,"".concat(s.y.RETENTION),e.a.createElement(l.a,null)),he()(Ie,"".concat(s.y.PATHS),e.a.createElement(v.a,null)),Ie);function It(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{disableHeader:!1,disableTable:!1},o=f.disableHeader,c=f.disableTable,p=Object(g.useValues)(Te.a),C=p.featureFlags,h=Object(g.useValues)(un.a),b=h.insightMode,T=Object(g.useValues)(z.c),I=T.insightProps,w=T.canEditInsight,N=T.insightLoading,j=T.activeView,_=T.loadedView,D=T.filters,Y=T.showTimeoutMessage,J=T.showErrorMessage,A=T.csvExportUrl,de=Object(g.useValues)(Object(me.a)(I)),U=de.areFiltersValid,W=de.isValidFunnel,X=de.areExclusionFiltersValid,ee=de.correlationAnalysisAvailable,$=function(){if(j!==_||N&&!Y)return e.a.createElement(e.a.Fragment,null,D.display!==s.i.ActionsTable&&D.display!==s.i.WorldMap&&e.a.createElement("div",{className:"trends-insights-container"}),e.a.createElement(M.b,null));if(_===s.y.FUNNELS){if(!U)return e.a.createElement(y.b,{actionable:b===s.z.Edit||c});if(!X)return e.a.createElement(y.a,null);if(!W&&!N)return e.a.createElement(y.c,null)}return J?e.a.createElement(y.d,null):Y?e.a.createElement(y.e,{isLoading:N}):null}();function Z(){return j===s.y.FUNNELS&&!J&&!Y&&U&&W&&D.funnel_viz_type===s.u.Steps&&!c&&(C[$e.h.LEMON_FUNNEL_VIZ]||(D==null?void 0:D.layout)===$e.j.horizontal)?e.a.createElement(e.a.Fragment,null,e.a.createElement("h2",{style:{margin:"1rem 0"}},"Detailed results"),e.a.createElement(Ae,null)):(!D.display||(D==null?void 0:D.display)!==s.i.ActionsTable&&(D==null?void 0:D.display)!==s.i.ActionsBarValue)&&j===s.y.TRENDS&&!c?e.a.createElement(e.a.Fragment,null,A&&e.a.createElement("div",{className:"flex-center space-between-items",style:{margin:"1rem 0"}},e.a.createElement("h2",null,"Detailed results"),e.a.createElement(H.a,{title:"Export this table in CSV format",placement:"left"},e.a.createElement(Ct.a,{type:"secondary",icon:e.a.createElement(ve.IconExport,{style:{color:"var(--primary)"}}),href:A},"Export"))),e.a.createElement(g.BindLogic,{logic:ct.a,props:I},e.a.createElement(Vt.b,{isLegend:!0,showTotalCount:!0,filterKey:j===s.y.TRENDS?"trends_".concat(j):"",canEditSeriesNameInline:j===s.y.TRENDS&&b===s.z.Edit,canCheckUncheckSeries:w}))):null}return e.a.createElement(e.a.Fragment,null,e.a.createElement(Qe.a,{title:o?null:e.a.createElement(Nt,{activeView:j,insightMode:b,filters:D,disableTable:!!c}),"data-attr":"insights-graph",className:"insights-graph-container"},e.a.createElement("div",null,e.a.createElement(Le.a,{className:Object(At.a)("insights-graph-header",{funnels:j===s.y.FUNNELS}),align:"middle",justify:"space-between"},e.a.createElement(Ve.a,null,e.a.createElement(Mn,null)),e.a.createElement(Ve.a,null,j===s.y.FUNNELS?e.a.createElement(ra,null):null,j===s.y.PATHS?e.a.createElement(E,null):null,e.a.createElement(Yn,null))),$||(C[$e.h.INSIGHT_LEGENDS]&&(j===s.y.TRENDS||j===s.y.STICKINESS)&&D.show_legend?e.a.createElement(Le.a,{className:"insights-graph-container-row",wrap:!1},e.a.createElement(Ve.a,{className:"insights-graph-container-row-left"},Wt[j]),e.a.createElement(Ve.a,{className:"insights-graph-container-row-right"},e.a.createElement(bn,null))):Wt[j]))),Z(),!c&&ee&&j===s.y.FUNNELS&&e.a.createElement(va,null))}try{It.displayName="InsightContainer",It.__docgenInfo={description:"",displayName:"InsightContainer",props:{disableHeader:{defaultValue:null,description:"",name:"disableHeader",required:!1,type:{name:"boolean"}},disableTable:{defaultValue:null,description:"",name:"disableTable",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightContainer.tsx#InsightContainer"]={docgenInfo:It.__docgenInfo,name:"InsightContainer",path:"frontend/src/scenes/insights/InsightContainer.tsx#InsightContainer"})}catch(f){}},"./frontend/src/scenes/insights/InsightDateFilter/insightDateFilterLogic.ts":function(Oe,Q,n){"use strict";n.d(Q,"a",function(){return We});var Ne=n("./node_modules/core-js/modules/es.array.iterator.js"),he=n.n(Ne),Qe=n("./node_modules/core-js/modules/es.object.to-string.js"),Le=n.n(Qe),Ve=n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Yt=n.n(Ve),et=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),Me=n.n(et),e=n("./node_modules/kea/lib/index.esm.js"),g=n("./frontend/src/scenes/insights/insightLogic.ts"),it=n("./frontend/src/scenes/insights/sharedUtils.ts");function ye(ne,se){var P=Object.keys(ne);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(ne);se&&(x=x.filter(function(O){return Object.getOwnPropertyDescriptor(ne,O).enumerable})),P.push.apply(P,x)}return P}function Ue(ne){for(var se=1;se<arguments.length;se++){var P=arguments[se]!=null?arguments[se]:{};se%2?ye(Object(P),!0).forEach(function(x){Me()(ne,x,P[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(P)):ye(Object(P)).forEach(function(x){Object.defineProperty(ne,x,Object.getOwnPropertyDescriptor(P,x))})}return ne}var We=Object(e.kea)({props:{},key:Object(it.c)("new"),path:function(se){return["scenes","insights","InsightDateFilter","insightDateFilterLogic",se]},connect:function(se){return{actions:[Object(g.c)(se),["setFilters"]],values:[Object(g.c)(se),["filters"]]}},actions:function(){return{setDates:function(P,x){return{dateFrom:P,dateTo:x}}}},selectors:{dates:[function(ne){return[ne.filters]},function(ne){return{dateFrom:(ne==null?void 0:ne.date_from)||null,dateTo:(ne==null?void 0:ne.date_to)||null}}]},listeners:function(se){var P=se.actions,x=se.values;return{setDates:function(ce){var s=ce.dateFrom,M=ce.dateTo;P.setFilters(Ue(Ue({},x.filters),{},{date_from:s||null,date_to:M||null}))}}}})},"./frontend/src/scenes/trends/SaveCohortModal.tsx":function(Oe,Q,n){"use strict";n.d(Q,"a",function(){return et});var Ne=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),he=n.n(Ne),Qe=n("./node_modules/react/index.js"),Le=n.n(Qe),Ve=n("./node_modules/antd/es/modal/index.js"),Yt=n("./node_modules/antd/es/input/index.js");function et(Me){var e=Me.onOk,g=Me.onCancel,it=Me.visible,ye=Object(Qe.useState)(""),Ue=he()(ye,2),We=Ue[0],ne=Ue[1];return Le.a.createElement(Ve.a,{title:"New Cohort",okText:"Save",cancelText:"Cancel",onOk:function(){e(We),ne("")},onCancel:g,visible:it},Le.a.createElement("div",{className:"mb"},Le.a.createElement(Yt.a,{required:!0,autoFocus:!0,placeholder:"Cohort name...",value:We,"data-attr":"cohort-name",onChange:function(P){return ne(P.target.value)}})))}try{et.displayName="SaveCohortModal",et.__docgenInfo={description:"",displayName:"SaveCohortModal",props:{onOk:{defaultValue:null,description:"",name:"onOk",required:!0,type:{name:"(title: string) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}},visible:{defaultValue:null,description:"",name:"visible",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/trends/SaveCohortModal.tsx#SaveCohortModal"]={docgenInfo:et.__docgenInfo,name:"SaveCohortModal",path:"frontend/src/scenes/trends/SaveCohortModal.tsx#SaveCohortModal"})}catch(Me){}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/lib/components/InsightLegend/InsightLegend.scss":function(Oe,Q,n){var Ne=n("./node_modules/css-loader/dist/runtime/api.js");Q=Ne(!1),Q.push([Oe.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.insight-legend-button{display:flex;align-items:center}.insight-legend-button .insight-legend-button-title{margin-left:.5rem;font-size:14px;font-weight:500}.insight-legend-menu{box-shadow:none!important;border:1px solid rgba(0,0,0,.15);background-color:#fff;border-radius:4px;max-width:300px;width:100%;max-height:100%;overflow-y:auto;overflow-x:auto;display:flex;flex-direction:column}.insight-legend-menu .insight-legend-menu-scroll .insight-legend-menu-item{width:100%}.insight-legend-menu .insight-legend-menu-scroll .insight-legend-menu-item .insight-legend-menu-item-inner{cursor:pointer;display:flex;align-items:center}.insight-legend-menu .insight-legend-menu-scroll .insight-legend-menu-item .insight-legend-menu-item-inner .insights-label{width:100%;font-size:.75rem}",""]),Oe.exports=Q},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/experiments/Experiment.scss":function(Oe,Q,n){var Ne=n("./node_modules/css-loader/dist/runtime/api.js");Q=Ne(!1),Q.push([Oe.i,'.text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.experiment-form .metrics-selection{border-top:1px solid rgba(0,0,0,.15);padding-top:1rem;width:100%}.experiment-form .metrics-selection .action-filters-bordered .draggable-action-filter{border-bottom:1px solid rgba(0,0,0,.15);padding:1rem .25rem;margin-top:0}.experiment-form .metrics-selection .action-filters-bordered .row-action-btn{color:#35416b}.experiment-form .person-selection{width:100%;border-top:1px solid rgba(0,0,0,.15);padding-top:1rem;align-items:center;justify-content:space-between}.experiment-form .insights-graph-container{margin-bottom:1rem;background-color:#fff}.experiment-form .insights-graph-container .ant-card-head{border-bottom:1px solid rgba(0,0,0,.15);min-height:unset;background-color:#fff;padding-left:1rem;padding-right:1rem}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title{padding:.5rem 0}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter{font-size:14px}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter:not(:last-child),.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter span.head-title-item{margin-right:.5rem}.experiment-form .insights-graph-container .display-config-inner{display:flex;align-items:center;justify-content:space-between;overflow-x:auto}.experiment-form .insights-graph-container .ant-card-body{padding:0}.experiment-form .insights-graph-container .insights-graph-container-row .insights-graph-container-row-left{width:100%}.experiment-form .insights-graph-container .insights-graph-container-row .insights-graph-container-row-right{width:100%;height:min(calc(90vh - 16rem),36rem);max-width:300px;padding:0 1rem 1rem 0;display:flex;align-items:center}.experiment-form .insights-graph-container .graph-container{width:calc(100% - 2rem);height:calc(100% - 3rem)}.experiment-form .insights-graph-header{margin-top:0!important;margin-bottom:0!important;padding-left:1rem;padding-right:1rem;min-height:48px}.experiment-form .experiment-preview{margin-bottom:1rem;border-bottom:1px solid rgba(0,0,0,.15)}.experiment-form .experiment-preview .mde-slider .ant-slider-handle{border:none}.experiment-form .experiment-preview .mde-slider .ant-slider-rail{background-color:#e5ebff}.experiment-form .variants{margin-top:.5rem;padding-bottom:1rem}.experiment-form .variants .ant-form-horizontal{min-height:32px}.experiment-form .variants .border-top{border-top-left-radius:4px;border-top-right-radius:4px}.experiment-form .variants .border-bottom{border-bottom-left-radius:4px;border-bottom-right-radius:4px}.experiment-form .variants .feature-flag-variant{display:flex;align-items:center;height:3.5rem;padding:0 .5rem;background:#fff;border-bottom-width:1px;border-bottom-color:rgba(0,0,0,.15);border-top:1px solid rgba(0,0,0,.15);border-left:1px solid rgba(0,0,0,.15);border-right:1px solid rgba(0,0,0,.15)}.experiment-form .variants .feature-flag-variant .ant-form-item-explain-error{margin-top:.5rem;color:#bf411a}.experiment-form .variants .feature-flag-variant .ant-form-item-label{padding:0}.experiment-form .variants .variant-label{display:flex;flex-direction:row;justify-content:center;align-items:center;border-radius:4px;color:#fff;min-width:52px;padding:2px 6px;margin-right:8px;font-size:12px;font-weight:500;letter-spacing:.01em}.experiment-form .secondary-metrics{margin-top:1rem;padding-top:1rem;border-top:1px solid rgba(0,0,0,.15);margin-bottom:1rem}.experiment-form .ant-input-number-disabled,.experiment-form .ant-input[disabled]{color:#000}.view-experiment .draft-header{margin-bottom:1rem;border-bottom:1px solid rgba(0,0,0,.15)}.view-experiment .exp-description{font-style:italic;color:rgba(0,0,0,.5)}.view-experiment .participants{background-color:#fff}.view-experiment .participants .ant-collapse-header{padding-top:.5rem;padding-bottom:.5rem;padding-left:.75rem}.view-experiment .variants-list{list-style:none;margin:0;padding:0}.view-experiment .variants-list li{display:inline}.view-experiment .variants-list li:after{content:", "}.view-experiment .variants-list li:last-child:after{content:""}.view-experiment .experiment-result{padding-top:1rem}.view-experiment .significant-results{padding:.5rem;width:100%;background:rgba(119,185,108,.1);border-radius:4px;text-align:center;margin-bottom:1rem}.view-experiment .not-significant-results{padding:.5rem;width:100%;background:rgba(83,117,255,.1);border-radius:4px;margin-bottom:1rem}.view-experiment .feature-flag-mods{padding:.5rem;width:100%;background:#f6ebf8;border-radius:4px;margin-bottom:1rem}.view-experiment .ant-collapse-content-box{display:flex;flex-flow:column}.view-experiment .secondary-progress{margin-top:.5rem}.view-experiment .secondary-progress li:before{content:"\u2022";display:inline-block;font-weight:900;margin-right:4px}.view-experiment .secondary-progress .ant-progress-inner,.view-experiment .secondary-progress .ant-progress-inner .ant-progress-bg{border-radius:4px}.view-experiment .no-experiment-results{display:flex;justify-content:center;align-items:center;margin-top:1rem;background-color:#fafaf9;border:1px solid rgba(0,0,0,.15);width:100%;min-height:320px;font-size:24px}.view-experiment .end-experiment-btn{background:#77b96c;color:#fff}.view-experiment .end-experiment-btn:hover{color:#000}.preview-conversion-goal-num{height:24px;width:24px;text-align:center;background-color:#fafaf9;color:#35416b;font-weight:700;margin-right:.5rem}.experiment-preview-row{border-bottom:1px solid rgba(0,0,0,.15);padding-bottom:1rem;margin-bottom:1rem}.experiment-preview-row:last-child{border-bottom:none;padding-bottom:0;margin-bottom:0}.metric-name{border:1px solid rgba(0,0,0,.15);border-radius:4px;padding:8px 8px 8px 16px;margin-left:.5rem;flex:1}.experiment-implementation-details,.experiment-workflow{border-color:#d9d9d9}.experiment-implementation-details .ant-card-head,.experiment-workflow .ant-card-head{padding-left:1rem;padding-right:1rem;border:none}.experiment-implementation-details .ant-card-head-title,.experiment-workflow .ant-card-head-title{border-bottom:1px solid rgba(0,0,0,.15)}.experiment-implementation-details .exp-workflow-step,.experiment-workflow .exp-workflow-step{margin-bottom:.5rem;padding:.5rem;border-radius:4px}.experiment-implementation-details .exp-workflow-step:hover,.experiment-workflow .exp-workflow-step:hover{cursor:pointer}.experiment-implementation-details .step-completed,.experiment-workflow .step-completed{background-color:#e5ebff}',""]),Oe.exports=Q},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/funnels/FunnelCanvasLabel.scss":function(Oe,Q,n){var Ne=n("./node_modules/css-loader/dist/runtime/api.js");Q=Ne(!1),Q.push([Oe.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.insights-graph-header.funnels{border-bottom:1px solid rgba(0,0,0,.15)}.insights-graph-header.funnels .funnel-canvas-label .ant-btn-link{padding:0}.insights-graph-header.funnels .funnel-canvas-label .ant-btn-link:disabled{cursor:default;color:#2d2d2d}.insights-graph-header.funnels .funnel-canvas-label .funnel-options-label{padding:4px}.insights-graph-header.funnels .funnel-canvas-label .funnel-options-inputs{align-items:center;padding:4px}",""]),Oe.exports=Q},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/FunnelCorrelation.scss":function(Oe,Q,n){var Ne=n("./node_modules/css-loader/dist/runtime/api.js");Q=Ne(!1),Q.push([Oe.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.funnel-correlation{margin-bottom:3rem}.funnel-correlation .skew-warning{margin-top:1rem;line-height:2em;border:1px solid #f7a501}.funnel-correlation .skew-warning .ant-card-body{padding:.5rem 1rem}.funnel-correlation .skew-warning h4{font-size:1.1em;display:flex;align-items:center;border-bottom:1px solid rgba(0,0,0,.15);padding:.5rem 1rem;margin-left:-1rem;margin-right:-1rem;position:relative}.funnel-correlation .skew-warning h4 .close-button{position:absolute;right:16px;color:rgba(0,0,0,.5)!important;cursor:pointer}.funnel-correlation .skew-warning b{padding-bottom:.5rem;font-weight:500}.funnel-correlation .correlation-feedback{margin-top:1rem}.funnel-correlation .correlation-feedback .ant-card-body{padding:.5rem 1rem}.funnel-correlation .correlation-feedback h4{padding:0;margin:0;font-weight:700;color:#747ea1}.funnel-correlation .correlation-feedback .emoji-button{margin-right:4px}.funnel-correlation .correlation-feedback .emoji-button:last-of-type{margin-right:0}.funnel-correlation .correlation-feedback .row-initial{display:flex;align-items:center}.funnel-correlation .correlation-feedback .row-initial .ant-col{text-align:right}.funnel-correlation .correlation-feedback .row-initial .ant-col:first-of-type{text-align:left}.funnel-correlation .correlation-feedback .close-button{color:rgba(0,0,0,.5)!important;cursor:pointer;z-index:5}.funnel-correlation .correlation-feedback .feedback-button{margin:1rem 0}",""]),Oe.exports=Q},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/InsightTabs/FunnelTab/CorrelationMatrix.scss":function(Oe,Q,n){var Ne=n("./node_modules/css-loader/dist/runtime/api.js");Q=Ne(!1),Q.push([Oe.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.correlation-matrix .ant-modal-body{display:flex;justify-content:center}.correlation-matrix .correlation-table-wrapper table{border-radius:4px;border:1px solid rgba(0,0,0,.15);border-collapse:separate;border-spacing:0;margin:0 auto}.correlation-matrix .correlation-table-wrapper table td{padding:.5rem 1rem;border-left:1px solid rgba(0,0,0,.15);border-top:1px solid rgba(0,0,0,.15);text-align:center}.correlation-matrix .correlation-table-wrapper table td .percentage{font-weight:700;padding-bottom:.25rem}.correlation-matrix .correlation-table-wrapper table td:first-child{border-left:none}.correlation-matrix .correlation-table-wrapper table .table-title{color:#747ea1}.correlation-matrix .correlation-table-wrapper table .table-title td{border-top:none}.correlation-matrix .correlation-table-wrapper table .horizontal-header,.correlation-matrix .correlation-table-wrapper table thead{font-weight:700;background-color:#fafafa;text-transform:uppercase;color:rgba(0,0,0,.5)}.correlation-matrix .correlation-table-wrapper table tbody td:not(.horizontal-header){text-align:right}",""]),Oe.exports=Q},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/InsightTabs/FunnelTab/FunnelCorrelationTable.scss":function(Oe,Q,n){var Ne=n("./node_modules/css-loader/dist/runtime/api.js");Q=Ne(!1),Q.push([Oe.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.funnel-correlation-table{margin-top:1rem;border:1px solid rgba(0,0,0,.15);border-radius:4px}.funnel-correlation-table .ant-table thead th{border-bottom:1px solid rgba(0,0,0,.15)}.funnel-correlation-table .funnel-correlation-header{background:#f2f2f2;display:flex;align-self:stretch;justify-content:space-between;align-content:space-between;border-top-left-radius:4px;border-top-right-radius:4px;padding-bottom:5px;overflow:auto}.funnel-correlation-table .funnel-correlation-header .table-header{font-style:normal;font-weight:700;font-size:11px;line-height:16px;padding-bottom:4px;display:flex;align-items:center;letter-spacing:.02em;text-transform:uppercase;color:#2d2d2d;margin-left:1rem;margin-top:.5rem}.funnel-correlation-table .funnel-correlation-header .table-options{display:flex;flex-grow:1;justify-content:flex-end;align-items:center;margin-top:5px}.funnel-correlation-table .funnel-correlation-header .table-options .title{font-family:Inter;font-style:normal;font-weight:600;font-size:11px;line-height:16px;display:flex;align-items:center;letter-spacing:.02em;text-transform:uppercase;margin:5px;color:rgba(0,0,0,.5)}.funnel-correlation-table .column-info{color:#747ea1;cursor:pointer;padding-left:4px}.funnel-correlation-table .nested-properties-table{margin:1rem;border:1px solid rgba(0,0,0,.15);border-radius:4px}.funnel-correlation-table .nested-properties-table thead th{border-bottom:1px solid rgba(0,0,0,.15)}.funnel-correlation-table .nested-properties-loading{text-align:center;padding:2rem 0}.funnel-correlation-table .nested-properties-loading h3{font-size:1rem;font-weight:700;margin-bottom:0}.funnel-correlation-table .nested-properties-loading h3 p{color:#747ea1}",""]),Oe.exports=Q}}]);
