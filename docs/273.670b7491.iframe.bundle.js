var ds=Object.defineProperty,us=Object.defineProperties;var ps=Object.getOwnPropertyDescriptors;var De=Object.getOwnPropertySymbols;var Ot=Object.prototype.hasOwnProperty,_t=Object.prototype.propertyIsEnumerable;var ht=(S,j,n)=>j in S?ds(S,j,{enumerable:!0,configurable:!0,writable:!0,value:n}):S[j]=n,x=(S,j)=>{for(var n in j||(j={}))Ot.call(j,n)&&ht(S,n,j[n]);if(De)for(var n of De(j))_t.call(j,n)&&ht(S,n,j[n]);return S},A=(S,j)=>us(S,ps(j));var vt=(S,j)=>{var n={};for(var m in S)Ot.call(S,m)&&j.indexOf(m)<0&&(n[m]=S[m]);if(S!=null&&De)for(var m of De(S))j.indexOf(m)<0&&_t.call(S,m)&&(n[m]=S[m]);return n};var K=(S,j,n)=>new Promise((m,w)=>{var Z=D=>{try{O(n.next(D))}catch(z){w(z)}},g=D=>{try{O(n.throw(D))}catch(z){w(z)}},O=D=>D.done?m(D.value):Promise.resolve(D.value).then(Z,g);O((n=n.apply(S,j)).next())});(window.webpackJsonp=window.webpackJsonp||[]).push([[273],{"./frontend/src/scenes/feature-flags/FeatureFlag.tsx":function(S,j,n){"use strict";n.r(j),n.d(j,"scene",function(){return ls}),n.d(j,"FeatureFlag",function(){return _e});var m=n("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),w=n("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.0/node_modules/kea-forms/lib/index.js"),Z=n("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/divider/index.js"),g=n("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/row/index.js"),O=n("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/col/index.js"),D=n("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/card/index.js"),z=n("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/skeleton/index.js"),d=n("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/tabs/index.js"),b=n("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/popconfirm/index.js"),E=n("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/radio/index.js"),I=n("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/input-number/index.js"),y=n("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/select/index.js"),c=n("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),p=n("./frontend/src/lib/utils.tsx"),B=n("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),R=n("./node_modules/.pnpm/@ant-design+icons@4.7.0_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/@ant-design/icons/es/icons/LockOutlined.js"),f=n("./frontend/src/types.ts"),L=n("./frontend/src/lib/api.ts"),X=n("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.0/node_modules/kea-router/lib/index.js"),P=n("./frontend/src/scenes/urls.ts"),J=n("./frontend/src/scenes/teamLogic.tsx"),ne=n("./frontend/src/scenes/feature-flags/featureFlagsLogic.ts"),ue=n("./frontend/src/models/groupsModel.ts"),oe=n("./frontend/src/lib/components/TaxonomicFilter/types.ts"),Ke=n("./frontend/src/lib/components/lemonToast.tsx"),xt=n("./frontend/src/lib/utils/eventUsageLogic.ts"),st=n("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js"),yt=n("./frontend/src/scenes/insights/utils/cleanFilters.ts"),nt=n("./frontend/src/lib/dayjs.ts"),Rt=n("./frontend/src/scenes/insights/sharedUtils.ts");const we=Object(c.kea)([Object(c.path)(["scenes","feature-flags","featureFlagPermissionsLogic"]),Object(c.props)({}),Object(c.key)(t=>`${t.flagId}`),Object(c.actions)({setModalOpen:t=>({visible:t}),setRolesToAdd:t=>({roleIds:t})}),Object(c.reducers)({permissionModalVisible:[!1,{setModalOpen:(t,s)=>{let{visible:a}=s;return a}}],rolesToAdd:[[],{setRolesToAdd:(t,s)=>{let{roleIds:a}=s;return a}}]}),Object(st.loaders)(t=>{let{props:s,values:a,actions:r}=t;return{unfilteredAddableRoles:[[],{loadPossibleRolesToAdd:()=>K(this,null,function*(){return(yield L.b.roles.list({feature_flags_access_level:f.a.READ})).results||[]})}],associatedRoles:[[],{loadAssociatedRoles:()=>K(this,null,function*(){return s.flagId?(yield L.b.resourceAccessPermissions.featureFlags.list(s.flagId)).results||[]:[]}),addAssociatedRoles:o=>K(this,null,function*(){const{rolesToAdd:l}=a,i=s.flagId||o;if(i){const u=yield Promise.all(l.map(_=>K(this,null,function*(){return yield L.b.resourceAccessPermissions.featureFlags.create(i,_)})));return r.setRolesToAdd([]),[...a.associatedRoles,...u]}return a.associatedRoles}),deleteAssociatedRole:o=>K(this,null,function*(){var l;let{roleId:i}=o;const u=(l=a.associatedRoles.find(_=>_.role.id===i))===null||l===void 0?void 0:l.id;return s.flagId&&u&&(yield L.b.resourceAccessPermissions.featureFlags.delete(s.flagId,u)),a.associatedRoles.filter(_=>_.id!==u)})}]}}),Object(c.selectors)({derivedRoles:[t=>[t.associatedRoles],t=>t.map(s=>s.role)],addableRoles:[t=>[t.unfilteredAddableRoles,t.associatedRoles],(t,s)=>{const a=[];for(const r of t)s.some(o=>o.role.id===r.id)||a.push(r);return a}]}),Object(c.afterMount)(t=>{let{actions:s}=t;s.loadPossibleRolesToAdd(),s.loadAssociatedRoles()})]);var Be=n("./frontend/src/scenes/userLogic.ts");const Ft=()=>({operator:"gt",threshold_type:f.U.Sentry,threshold:50,threshold_metric:x({},Object(yt.a)({insight:f.F.TRENDS,date_from:Object(nt.a)().subtract(7,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(nt.a)().endOf("d").format("YYYY-MM-DDTHH:mm")}))}),ke={id:null,created_at:null,key:"",name:"",filters:{groups:[{properties:[],rollout_percentage:null,variant:null}],multivariate:null},deleted:!1,active:!0,created_by:null,is_simple_flag:!1,rollout_percentage:null,ensure_experience_continuity:!1,experiment_set:null,rollback_conditions:[],performed_rollback:!1,can_edit:!0},Et={key:"",name:"",rollout_percentage:0},St={variants:[{key:"",name:"",rollout_percentage:100}]},At=t=>({events:[{id:"$feature_flag_called",name:"$feature_flag_called",type:"events",properties:Ue(t)}]}),Ue=t=>[{key:"$feature/"+t,type:f.N.Event,value:["false"],operator:f.P.IsNot},{key:"$feature/"+t,type:f.N.Event,value:"is_set",operator:f.P.IsSet},{key:"$feature_flag",type:f.N.Event,value:t,operator:f.P.Exact}],ae=Object(c.kea)([Object(c.path)(["scenes","feature-flags","featureFlagLogic"]),Object(c.props)({}),Object(c.key)(t=>{let{id:s}=t;return s!=null?s:"unknown"}),Object(c.connect)({values:[J.a,["currentTeamId"],ue.a,["groupTypes","groupsTaxonomicTypes","aggregationLabel"],Be.a,["hasAvailableFeature"]]}),Object(c.actions)({setFeatureFlag:t=>({featureFlag:t}),setFeatureFlagMissing:!0,addConditionSet:!0,addRollbackCondition:!0,setAggregationGroupTypeIndex:t=>({value:t}),removeConditionSet:t=>({index:t}),removeRollbackCondition:t=>({index:t}),duplicateConditionSet:t=>({index:t}),updateConditionSet:(t,s,a,r)=>({index:t,newRolloutPercentage:s,newProperties:a,newVariant:r}),deleteFeatureFlag:t=>({featureFlag:t}),setMultivariateEnabled:t=>({enabled:t}),setMultivariateOptions:t=>({multivariateOptions:t}),addVariant:!0,duplicateVariant:t=>({index:t}),removeVariant:t=>({index:t}),editFeatureFlag:t=>({editing:t}),distributeVariantsEqually:!0,setFilters:t=>({filters:t}),loadInsightAtIndex:(t,s)=>({index:t,filters:s}),setInsightResultAtIndex:(t,s)=>({index:t,average:s}),loadAllInsightsForFlag:!0,setAffectedUsers:(t,s)=>({index:t,count:s}),setTotalUsers:t=>({count:t})}),Object(w.forms)(t=>{let{actions:s,values:a}=t;return{featureFlag:{defaults:x({},ke),errors:r=>{var o,l,i;let{key:u,filters:_}=r;return{key:u?(o=u.match)!==null&&o!==void 0&&o.call(u,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key",filters:{multivariate:{variants:_==null||(l=_.multivariate)===null||l===void 0||(i=l.variants)===null||i===void 0?void 0:i.map(C=>{var h;let{key:v}=C;return{key:v?(h=v.match)!==null&&h!==void 0&&h.call(v,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key"}})},groups:a.propertySelectErrors}}},submit:r=>{s.saveFeatureFlag(r)}}}}),Object(c.reducers)({featureFlag:[x({},ke),{setFeatureFlag:(t,s)=>{let{featureFlag:a}=s;if(a.filters.groups){const r=a.filters.groups.map(o=>o.properties?A(x({},o),{properties:Object(p.r)(o.properties)}):o);return A(x({},a),{filters:A(x({},a==null?void 0:a.filters),{groups:r})})}return a},addConditionSet:t=>{if(!t)return t;const s=[...t==null?void 0:t.filters.groups,{properties:[],rollout_percentage:null,variant:null}];return A(x({},t),{filters:A(x({},t.filters),{groups:s})})},addRollbackCondition:t=>t&&A(x({},t),{rollback_conditions:[...t.rollback_conditions,Ft()]}),removeRollbackCondition:(t,s)=>{let{index:a}=s;if(!t)return t;const r=[...t.rollback_conditions];return r.splice(a,1),A(x({},t),{rollback_conditions:r})},updateConditionSet:(t,s)=>{let{index:a,newRolloutPercentage:r,newProperties:o,newVariant:l}=s;if(!t)return t;const i=[...t==null?void 0:t.filters.groups];return r!==void 0&&(i[a]=A(x({},i[a]),{rollout_percentage:r})),o!==void 0&&(i[a]=A(x({},i[a]),{properties:o})),l!==void 0&&(i[a]=A(x({},i[a]),{variant:l})),A(x({},t),{filters:A(x({},t.filters),{groups:i})})},removeConditionSet:(t,s)=>{let{index:a}=s;if(!t)return t;const r=[...t.filters.groups];return r.splice(a,1),A(x({},t),{filters:A(x({},t.filters),{groups:r})})},duplicateConditionSet:(t,s)=>{let{index:a}=s;if(!t)return t;const r=t.filters.groups.concat([t.filters.groups[a]]);return A(x({},t),{filters:A(x({},t.filters),{groups:r})})},setMultivariateOptions:(t,s)=>{let{multivariateOptions:a}=s;return t&&A(x({},t),{filters:A(x({},t.filters),{multivariate:a})})},addVariant:t=>{var s;if(!t)return t;const a=[...((s=t.filters.multivariate)===null||s===void 0?void 0:s.variants)||[]];return A(x({},t),{filters:A(x({},t.filters),{multivariate:A(x({},t.filters.multivariate||{}),{variants:[...a,Et]})})})},removeVariant:(t,s)=>{var a;let{index:r}=s;if(!t)return t;const o=[...((a=t.filters.multivariate)===null||a===void 0?void 0:a.variants)||[]];return o.splice(r,1),A(x({},t),{filters:A(x({},t.filters),{multivariate:A(x({},t.filters.multivariate),{variants:o})})})},distributeVariantsEqually:t=>{var s;if(!t)return t;const a=[...((s=t.filters.multivariate)===null||s===void 0?void 0:s.variants)||[]],r=a.length;if(r>0&&r<=100){const o=Math.round(100/r),i=o*r-100;a.forEach((u,_)=>{a[_]=A(x({},u),{rollout_percentage:o})}),a[r-1]=A(x({},a[r-1]),{rollout_percentage:o-i})}return A(x({},t),{filters:A(x({},t.filters),{multivariate:A(x({},t.filters.multivariate),{variants:a})})})},setAggregationGroupTypeIndex:(t,s)=>{let{value:a}=s;return!t||t.filters.aggregation_group_type_index==a?t:A(x({},t),{filters:A(x({},t.filters),{aggregation_group_type_index:a,groups:[{properties:[],rollout_percentage:null,variant:null}]})})}}],featureFlagMissing:[!1,{setFeatureFlagMissing:()=>!0}],isEditingFlag:[!1,{editFeatureFlag:(t,s)=>{let{editing:a}=s;return a}}],insightRollingAverages:[{},{setInsightResultAtIndex:(t,s)=>{let{index:a,average:r}=s;return A(x({},t),{[`${a}`]:r})}}],affectedUsers:[{},{setAffectedUsers:(t,s)=>{let{index:a,count:r}=s;return A(x({},t),{[a]:r})},resetFeatureFlag:()=>({0:-1}),loadFeatureFlag:()=>({0:-1})}],totalUsers:[null,{setTotalUsers:(t,s)=>{let{count:a}=s;return a}}]}),Object(st.loaders)(t=>{let{values:s,props:a,actions:r}=t;return{featureFlag:{loadFeatureFlag:()=>K(this,null,function*(){if(a.id&&a.id!=="new")try{return yield L.b.get(`api/projects/${s.currentTeamId}/feature_flags/${a.id}`)}catch(o){throw r.setFeatureFlagMissing(),o}return ke}),saveFeatureFlag:o=>K(this,null,function*(){const C=o,{created_at:l,id:i}=C,u=vt(C,["created_at","id"]);try{if(o.id)return yield L.b.update(`api/projects/${s.currentTeamId}/feature_flags/${o.id}`,u);{const h=yield L.b.create(`api/projects/${s.currentTeamId}/feature_flags`,u);if(s.roleBasedAccessEnabled){var _;(_=we({flagId:null}))===null||_===void 0||_.actions.addAssociatedRoles(h.id)}return h}}catch(h){throw(h.code==="behavioral_cohort_found"||h.code==="cohort_does_not_exist")&&xt.e.actions.reportFailedToCreateFeatureFlagWithCohort(h.code,h.detail),h}})},recentInsights:[[],{loadRecentInsights:()=>K(this,null,function*(){return a.id&&a.id!=="new"&&s.featureFlag.key?(yield L.b.get(`api/projects/${s.currentTeamId}/insights/?feature_flag=${s.featureFlag.key}&order=-created_at`)).results:[]})}],sentryStats:[{},{loadSentryStats:()=>K(this,null,function*(){return yield L.b.get("api/sentry_stats/")})}]}}),Object(c.listeners)(t=>{let{actions:s,values:a}=t;return{saveFeatureFlagSuccess:r=>{var o;let{featureFlag:l}=r;Ke.d.success("Feature flag saved"),(o=ne.b.findMounted())===null||o===void 0||o.actions.updateFlag(l),X.router.actions.replace(P.a.featureFlag(l.id)),s.editFeatureFlag(!1)},deleteFeatureFlag:r=>K(this,null,function*(){let{featureFlag:o}=r;Object(p.x)({endpoint:`projects/${a.currentTeamId}/feature_flags`,object:{name:o.name,id:o.id},callback:()=>{var l,i;o.id&&((l=ne.b.findMounted())===null||l===void 0||l.actions.deleteFlag(o.id)),(i=ne.b.findMounted())===null||i===void 0||i.actions.loadFeatureFlags(),X.router.actions.push(P.a.featureFlags())}})}),setMultivariateEnabled:r=>K(this,null,function*(){let{enabled:o}=r;o?s.setMultivariateOptions(St):s.setMultivariateOptions(null)}),loadFeatureFlagSuccess:()=>K(this,null,function*(){s.loadRecentInsights(),s.loadAllInsightsForFlag()}),loadInsightAtIndex:r=>K(this,null,function*(){let{index:o,filters:l}=r;if(l){var i,u;const C=(i=(yield L.b.get(`api/projects/${a.currentTeamId}/insights/trend/?${Object(p.Gb)(Object(Rt.a)(l))}`)).result)===null||i===void 0||(u=i[0])===null||u===void 0?void 0:u.data,h=Math.round(Object(p.Fb)(C)/7);s.setInsightResultAtIndex(o,h)}}),loadAllInsightsForFlag:()=>{var r;(r=a.featureFlag.rollback_conditions)===null||r===void 0||r.forEach((o,l)=>{o.threshold_metric&&s.loadInsightAtIndex(l,o.threshold_metric)})},addRollbackCondition:()=>{const r=a.featureFlag.rollback_conditions.length-1;s.loadInsightAtIndex(r,a.featureFlag.rollback_conditions[r].threshold_metric)},updateConditionSet:(r,o)=>K(this,null,function*(){var l,i,u;let{index:_,newProperties:C}=r;if(C&&s.setAffectedUsers(_,void 0),!C||C.some(v=>v.value===null||v.value===void 0||Array.isArray(v.value)&&v.value.length===0))return;yield o(1e3);const h=yield L.b.create(`api/projects/${a.currentTeamId}/feature_flags/user_blast_radius`,{condition:{properties:C},group_type_index:(l=(i=a.featureFlag)===null||i===void 0||(u=i.filters)===null||u===void 0?void 0:u.aggregation_group_type_index)!==null&&l!==void 0?l:null});s.setAffectedUsers(_,h.users_affected),s.setTotalUsers(h.total_users)}),addConditionSet:()=>{s.setAffectedUsers(a.featureFlag.filters.groups.length-1,-1)},editFeatureFlag:r=>K(this,null,function*(){var o,l,i;let{editing:u}=r;if(!u)return;const _=[];(o=a.featureFlag)===null||o===void 0||(l=o.filters)===null||l===void 0||(i=l.groups)===null||i===void 0||i.forEach((h,v)=>{s.setAffectedUsers(v,void 0);const T=h.properties;if(!T||(T==null?void 0:T.length)===0||T.some(Y=>Y.value===null||Y.value===void 0||Array.isArray(Y.value)&&Y.value.length===0))_.push(Promise.resolve({users_affected:-1,total_users:-1}));else{var M,N,Q;const Y=L.b.create(`api/projects/${a.currentTeamId}/feature_flags/user_blast_radius`,{condition:h,group_type_index:(M=(N=a.featureFlag)===null||N===void 0||(Q=N.filters)===null||Q===void 0?void 0:Q.aggregation_group_type_index)!==null&&M!==void 0?M:null});_.push(Y)}}),(yield Promise.all(_)).forEach((h,v)=>{s.setAffectedUsers(v,h.users_affected),h.total_users!==-1&&s.setTotalUsers(h.total_users)})})}}),Object(c.selectors)({sentryErrorCount:[t=>[t.sentryStats],t=>t.total_count],sentryIntegrationEnabled:[t=>[t.sentryStats],t=>!!t.sentry_integration_enabled],props:[()=>[(t,s)=>s],t=>t],multivariateEnabled:[t=>[t.featureFlag],t=>!!(t!=null&&t.filters.multivariate)],roleBasedAccessEnabled:[t=>[t.hasAvailableFeature],t=>t(f.e.ROLE_BASED_ACCESS)],variants:[t=>[t.featureFlag],t=>{var s;return(t==null||(s=t.filters.multivariate)===null||s===void 0?void 0:s.variants)||[]}],nonEmptyVariants:[t=>[t.variants],t=>t.filter(s=>{let{key:a}=s;return!!a})],variantRolloutSum:[t=>[t.variants],t=>t.reduce((s,a)=>{let{rollout_percentage:r}=a;return s+r},0)],areVariantRolloutsValid:[t=>[t.variants,t.variantRolloutSum],(t,s)=>t.every(a=>{let{rollout_percentage:r}=a;return r>=0&&r<=100})&&s===100],aggregationTargetName:[t=>[t.featureFlag,t.groupTypes,t.aggregationLabel],(t,s,a)=>t&&t.filters.aggregation_group_type_index!=null&&s.length>0?a(t.filters.aggregation_group_type_index).plural:"users"],taxonomicGroupTypes:[t=>[t.featureFlag,t.groupsTaxonomicTypes],(t,s)=>t&&t.filters.aggregation_group_type_index!=null&&s.length>0?[s[t.filters.aggregation_group_type_index]]:[oe.a.PersonProperties,oe.a.Cohorts]],breadcrumbs:[t=>[t.featureFlag],t=>[{name:"Feature Flags",path:P.a.featureFlags()},...t?[{name:t.key||"Unnamed"}]:[]]],propertySelectErrors:[t=>[t.featureFlag],t=>{var s,a;return t==null||(s=t.filters)===null||s===void 0||(a=s.groups)===null||a===void 0?void 0:a.map(r=>{let{properties:o}=r;return{properties:o==null?void 0:o.map(l=>({value:l.value===null||l.value===void 0||Array.isArray(l.value)&&l.value.length===0?"Property filters can't be empty":void 0}))}})}],computeBlastRadiusPercentage:[t=>[t.affectedUsers,t.totalUsers],(t,s)=>(a,r)=>{let o=a;if(a==null&&(o=100),t[r]===-1||s===-1||!s)return o;let l=s;return l===0&&(l=1),o*(t[r]/l)}],approximateTotalBlastRadius:[t=>[t.computeBlastRadiusPercentage,t.featureFlag],(t,s)=>{if(!s||!s.filters.groups)return 0;let a=0;return s.filters.groups.forEach((r,o)=>{a+=t(r.rollout_percentage,o)}),Math.min(a,100)}]}),Object(X.urlToAction)(t=>{var s;let{actions:a,props:r}=t;return{[P.a.featureFlag((s=r.id)!==null&&s!==void 0?s:"new")]:(o,l,i,u)=>{let{method:_}=u;_==="PUSH"&&(r.id?a.loadFeatureFlag():a.resetFeatureFlag())}}}),Object(c.afterMount)(t=>{var s;let{props:a,actions:r}=t;const o=(s=ne.b.findMounted())===null||s===void 0?void 0:s.values.featureFlags.find(l=>l.id===a.id);o?(r.setFeatureFlag(o),r.loadRecentInsights(),r.loadAllInsightsForFlag()):a.id!=="new"&&r.loadFeatureFlag(),r.loadSentryStats()})]);var $e=n("./frontend/src/lib/logic/featureFlagLogic.ts"),$=n("./frontend/src/lib/components/icons.tsx"),le=n("./frontend/src/lib/components/LemonDivider/index.ts"),ee=n("./frontend/src/lib/components/CodeSnippet/index.tsx"),e=n("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");const ie="?utm_medium=in-product&utm_campaign=feature-flag";function ve(t){let{flagKey:s}=t;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(ee.a,{language:ee.b.JavaScript,wrap:!0,children:`const isMyFlagEnabledForUser = await client.isFeatureEnabled('${s}', 'user distinct id')

if (isMyFlagEnabledForUser) {
    // Do something differently for this user
}`})})}function xe(t){let{flagKey:s}=t;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(ee.a,{language:ee.b.JavaScript,wrap:!0,children:`if\xA0(posthog.isFeatureEnabled('${s!=null?s:""}')) {
    // run your activation code here
}`})})}function ye(t){let{flagKey:s}=t;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(ee.a,{language:ee.b.PHP,wrap:!0,children:`if (PostHog::isFeatureEnabled('${s}', 'some distinct id')) {
    // do something here
}`})})}function Re(t){let{flagKey:s}=t;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(ee.a,{language:ee.b.Go,wrap:!0,children:`isFlagEnabledForUser, err := client.IsFeatureEnabled(
                    FeatureFlagPayload{
                        Key:        '${s}',
                        DistinctId: "distinct-id",
                    })

if (isFlagEnabledForUser) {
  // Do something differently for this user
}`})})}function Fe(t){let{flagKey:s}=t;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(ee.a,{language:ee.b.Ruby,wrap:!0,children:`is_my_flag_enabled = posthog.is_feature_enabled('${s}', 'user distinct id')

if is_my_flag_enabled
  # Do something differently for this user
end`})})}function Ee(t){let{flagKey:s}=t;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(ee.a,{language:ee.b.Python,wrap:!0,children:`if posthog.feature_enabled("${s}", "user_distinct_id"):
    runAwesomeFeature()
`})})}function It(){const{currentTeam:t}=Object(c.useValues)(J.a);return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(ee.a,{language:ee.b.Bash,wrap:!0,children:`curl ${window.location.origin}/decide/ \\
-X POST -H 'Content-Type: application/json' \\
-d '{
    "api_key": "${t?t.api_token:"[project_api_key]"}",
    "distinct_id": "[user distinct id]"
}'
                `})})}try{ve.displayName="NodeJSSnippet",ve.__docgenInfo={description:"",displayName:"NodeJSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#NodeJSSnippet"]={docgenInfo:ve.__docgenInfo,name:"NodeJSSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#NodeJSSnippet"})}catch(t){}try{xe.displayName="JSSnippet",xe.__docgenInfo={description:"",displayName:"JSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"]={docgenInfo:xe.__docgenInfo,name:"JSSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"})}catch(t){}try{ye.displayName="PHPSnippet",ye.__docgenInfo={description:"",displayName:"PHPSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PHPSnippet"]={docgenInfo:ye.__docgenInfo,name:"PHPSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PHPSnippet"})}catch(t){}try{Re.displayName="GolangSnippet",Re.__docgenInfo={description:"",displayName:"GolangSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#GolangSnippet"]={docgenInfo:Re.__docgenInfo,name:"GolangSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#GolangSnippet"})}catch(t){}try{Fe.displayName="RubySnippet",Fe.__docgenInfo={description:"",displayName:"RubySnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#RubySnippet"]={docgenInfo:Fe.__docgenInfo,name:"RubySnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#RubySnippet"})}catch(t){}try{Ee.displayName="PythonSnippet",Ee.__docgenInfo={description:"",displayName:"PythonSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"]={docgenInfo:Ee.__docgenInfo,name:"PythonSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"})}catch(t){}var Tt=n("./node_modules/.pnpm/style-loader@2.0.0_webpack@4.46.0/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),at=n.n(Tt),Lt=n("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlagInstructions.scss"),rt=n.n(Lt),Ve={};Ve.insert="head",Ve.singleton=!1;var ms=at()(rt.a,Ve),gs=rt.a.locals||{};const de="https://posthog.com/docs/",pe="#feature-flags",We=[{value:"JavaScript",documentationLink:`${de}integrations/js-integration${ie}${pe}`,Icon:$.IconJavascript,Snippet:xe},{value:"Node.js",documentationLink:`${de}integrations/node-integration${ie}${pe}`,Icon:$.IconNodeJS,Snippet:ve},{value:"PHP",documentationLink:`${de}integrations/php-integration${ie}${pe}`,Icon:$.IconPHP,Snippet:ye},{value:"Ruby",documentationLink:`${de}integrations/ruby-integration${ie}${pe}`,Icon:$.IconRuby,Snippet:Fe},{value:"Golang",documentationLink:`${de}integrations/go-integration${ie}${pe}`,Icon:$.IconGolang,Snippet:Re},{value:"Python",documentationLink:`${de}integrations/python-integration${ie}${pe}`,Icon:$.IconPython,Snippet:Ee},{value:"API",documentationLink:`${de}api/feature-flags${ie}`,Icon:$.IconOpenInNew,Snippet:It}];function Pt(t){let{selectedOptionValue:s,selectOption:a}=t;return Object(e.jsxs)(g.a,{className:"FeatureFlagInstructionsHeader",justify:"space-between",align:"middle",children:[Object(e.jsxs)("div",{className:"FeatureFlagInstructionsHeader__header-title",children:[Object(e.jsx)($.IconFlag,{className:"FeatureFlagInstructionsHeader__header-title__icon"}),Object(e.jsx)("b",{children:"Learn how to use feature flags in your code"})]}),Object(e.jsx)(y.a,{"data-attr":"feature-flag-instructions-select",value:s,style:{width:140},onChange:a,children:We.map((r,o)=>{let{value:l,Icon:i}=r;return Object(e.jsx)(y.a.Option,{"data-attr":"feature-flag-instructions-select-option-"+l,value:l,children:Object(e.jsxs)("div",{className:"FeatureFlagInstructionsHeader__option",children:[Object(e.jsx)("div",{className:"FeatureFlagInstructionsHeader__option__icon",children:Object(e.jsx)(i,{})}),Object(e.jsx)("div",{children:l})]})},o)})})]})}function Ct(t){let{documenrationLink:s}=t;return Object(e.jsxs)("div",{className:"mt-4",children:["Need more information?"," ",Object(e.jsxs)("a",{"data-attr":"feature-flag-doc-link",target:"_blank",rel:"noopener",href:s,children:["Check the docs ",Object(e.jsx)($.IconOpenInNew,{})]})]})}function be(t){let{featureFlagKey:s}=t;const[a]=We,[r,o]=Object(m.useState)(a),l=i=>{const u=We.find(_=>_.value===i);u&&o(u)};return Object(e.jsxs)(D.a,{size:"small",children:[Object(e.jsx)(Pt,{selectedOptionValue:r.value,selectOption:l}),Object(e.jsx)(le.a,{}),Object(e.jsx)("div",{className:"mt mb",children:Object(e.jsx)(r.Snippet,{"data-attr":"feature-flag-instructions-snippet",flagKey:s})}),Object(e.jsx)(le.a,{}),Object(e.jsx)(Ct,{documenrationLink:r.documentationLink})]})}try{be.displayName="FeatureFlagInstructions",be.__docgenInfo={description:"",displayName:"FeatureFlagInstructions",props:{featureFlagKey:{defaultValue:null,description:"",name:"featureFlagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagInstructions.tsx#FeatureFlagInstructions"]={docgenInfo:be.__docgenInfo,name:"FeatureFlagInstructions",path:"frontend/src/scenes/feature-flags/FeatureFlagInstructions.tsx#FeatureFlagInstructions"})}catch(t){}var ot=n("./frontend/src/lib/components/PageHeader.tsx"),Mt=n("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss"),lt=n.n(Mt),ze={};ze.insert="head",ze.singleton=!1;var fs=at()(lt.a,ze),js=lt.a.locals||{},Nt=n("./frontend/src/lib/components/Tooltip.tsx"),Dt=n("./node_modules/.pnpm/rc-select@13.1.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/rc-select/es/index.js"),Se=n("./frontend/src/lib/components/Link.tsx"),Ae=n("./frontend/src/lib/introductions/groupsAccessLogic.ts");function Ie(t){let{value:s}=t;const{groupsAccessStatus:a}=Object(c.useValues)(Ae.b);return[Ae.a.HasAccess,Ae.a.HasGroupTypes,Ae.a.NoAccess].includes(a)?Object(e.jsxs)(Dt.c.Option,{value:s,disabled:!0,style:{height:"100%",width:"100%",overflow:"hidden",textOverflow:"ellipsis",backgroundColor:"var(--side)",color:"var(--muted)"},children:[Object(e.jsx)(R.a,{style:{marginRight:6,color:"var(--warning)"}}),"Unique groups \u2013"," ",Object(e.jsx)(Se.a,{to:"https://posthog.com/docs/user-guides/group-analytics?utm_medium=in-product&utm_campaign=group-analytics-learn-more",target:"_blank","data-attr":"group-analytics-learn-more",className:"font-semibold",children:"Learn more"})]},"groups"):null}try{Ie.displayName="GroupsIntroductionOption",Ie.__docgenInfo={description:"",displayName:"GroupsIntroductionOption",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"]={docgenInfo:Ie.__docgenInfo,name:"GroupsIntroductionOption",path:"frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"})}catch(t){}var q=n("./frontend/src/lib/components/LemonButton/index.ts"),te=n("./frontend/src/lib/forms/Field.tsx"),Kt=n("./frontend/src/lib/components/LemonTextArea/LemonTextArea.tsx"),He=n("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),it=n("./frontend/src/lib/components/LemonCheckbox/index.ts"),wt=n("./frontend/src/scenes/events/EventBufferNotice.tsx"),ct=n("./frontend/src/lib/components/AlertMessage/index.ts"),he=n("./frontend/src/lib/components/Spinner/Spinner.tsx"),dt=n("./frontend/src/lib/components/CopyToClipboard.tsx"),Te=n("./frontend/src/lib/components/Lettermark/Lettermark.tsx"),re=n("./frontend/src/lib/constants.tsx"),ut=n("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),Bt=n("./frontend/src/lib/components/ActivityLog/ActivityLog.tsx"),kt=n("./frontend/src/lib/components/ActivityLog/humanizeActivity.tsx"),Ut=n("./frontend/src/lib/components/DefinitionPopup/utils.ts"),pt=n("./frontend/src/lib/components/CompactList/CompactList.tsx"),$t=n("./frontend/src/scenes/project-homepage/RecentInsights.tsx");function Vt(){const{recentInsights:t,recentInsightsLoading:s,featureFlag:a}=Object(c.useValues)(ae);return Object(e.jsx)(pt.a,{title:"Insights that use this feature flag",loading:s,emptyMessage:{title:"You have no insights that use this feature flag",description:"Explore this feature flag's insights by creating one below.",buttonText:"Create insight",buttonTo:P.a.insightNew({events:[{id:"$pageview",name:"$pageview",type:"events",math:"dau"}],breakdown_type:"event",breakdown:`$feature/${a.key}`})},items:t.slice(0,5),renderRow:(r,o)=>Object(e.jsx)($t.a,{insight:r},o)})}var Wt=n("./frontend/src/lib/components/NotFound/index.tsx"),zt=n("./frontend/src/models/cohortsModel.ts"),G=n("./frontend/@posthog/lemon-ui/src/index.ts"),Ht=n("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilter.tsx"),Gt=n("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilterRow/ActionFilterRow.tsx");function Oe(t){let{readOnly:s}=t;const{featureFlag:a,sentryIntegrationEnabled:r,sentryErrorCount:o,insightRollingAverages:l}=Object(c.useValues)(ae),{addRollbackCondition:i,removeRollbackCondition:u,loadInsightAtIndex:_}=Object(c.useActions)(ae),{user:C}=Object(c.useValues)(Be.a);return Object(e.jsxs)("div",{children:[Object(e.jsxs)("div",{className:"mb-2",children:[Object(e.jsx)("b",{children:"Auto rollback"}),Object(e.jsx)(G.LemonTag,{type:"warning",className:"uppercase ml-2",children:"Beta"}),!s&&Object(e.jsx)("div",{className:"mt-2",children:"Specify the conditions in which this feature flag will automatically roll back."})]}),s&&a.rollback_conditions&&a.rollback_conditions.map((h,v)=>{var T,M,N;return Object(e.jsxs)(e.Fragment,{children:[v>0&&Object(e.jsx)("div",{className:"condition-set-separator",children:"OR"}),h.threshold_type==="insight"&&(T=h.threshold_metric)!==null&&T!==void 0&&(M=T.events)!==null&&M!==void 0&&(N=M[0])!==null&&N!==void 0&&N.name?Object(e.jsxs)("div",{className:"mb-4 border rounded p-4",children:[Object(e.jsx)("b",{children:`${Object(p.i)(h.threshold_type)} based rollback`}),Object(e.jsx)(G.LemonDivider,{className:"my-3"}),Object(e.jsxs)(g.a,{align:"middle",children:[l[v]&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("b",{children:h.threshold_metric.events[0].name}),"\xA0 trailing average is ",l[v],"."]}),"\xA0Trigger when trailing average of \xA0",Object(e.jsx)("b",{children:h.threshold_metric.events[0].name}),"\xA0 is\xA0",h.operator&&p.J[h.operator]," ",h.threshold]})]}):Object(e.jsxs)("div",{className:"mb-4 border rounded p-4",children:[Object(e.jsx)("b",{children:`${Object(p.i)(h.threshold_type)} based rollback`}),Object(e.jsx)(G.LemonDivider,{className:"my-3"}),Object(e.jsxs)(g.a,{align:"middle",children:["Trigger when there is a\xA0",Object(e.jsxs)("b",{children:[h.threshold,"%"]}),"\xA0increase in errors"]})]})]})}),!s&&a.rollback_conditions&&a.rollback_conditions.map((h,v)=>Object(e.jsxs)(e.Fragment,{children:[v>0&&Object(e.jsx)("div",{className:"condition-set-separator",children:"OR"}),Object(e.jsx)("div",{className:"mb-4 border rounded p-4",children:Object(e.jsxs)(w.Group,{name:["rollback_conditions",v],children:[Object(e.jsxs)(g.a,{align:"middle",justify:"space-between",children:[Object(e.jsxs)(g.a,{children:[Object(e.jsx)("div",{className:"mt-3 mr-3",children:Object(e.jsx)("b",{children:"Rollback Condition Type"})}),Object(e.jsx)(te.a,{name:"threshold_type",children:T=>{let{value:M,onChange:N}=T;return Object(e.jsx)(G.LemonSelect,{value:M,onChange:N,options:[{value:f.U.Sentry,label:"Error Based"},{value:f.U.Insight,label:"Metric Based"}]})}})]}),Object(e.jsx)(G.LemonButton,{icon:Object(e.jsx)($.IconDelete,{}),status:"muted",noPadding:!0,onClick:()=>{u(v)}})]}),Object(e.jsx)(G.LemonDivider,{className:"my-3"}),a.rollback_conditions[v].threshold_type=="insight"?Object(e.jsxs)("div",{className:"flex gap-2 items-center mt-4",children:[Object(e.jsx)(te.a,{name:"threshold_metric",children:T=>{let{value:M,onChange:N}=T;return Object(e.jsx)(Ht.a,{filters:M,setFilters:Q=>{N(x({},Q)),_(v,Q)},typeKey:"feature-flag-rollback-trends-"+v,buttonCopy:"Add graph series",showSeriesIndicator:!1,showNestedArrow:!0,hideRename:!0,entitiesLimit:1,mathAvailability:Gt.b.None,propertiesTaxonomicGroupTypes:[oe.a.EventProperties,oe.a.PersonProperties,oe.a.EventFeatureFlags,oe.a.Cohorts,oe.a.Elements]})}}),Object(e.jsxs)("span",{children:["trailing 7 day average is\xA0",l[v]!==void 0?Object(e.jsx)("b",{children:l[v]}):Object(e.jsx)(he.a,{}),". Trigger when trailing average is"]}),Object(e.jsx)(te.a,{name:"operator",children:T=>{let{value:M,onChange:N}=T;return Object(e.jsx)(G.LemonSelect,{value:M,onChange:N,options:[{label:"greater than",value:"gt"},{label:"less than",value:"lt"}]})}}),Object(e.jsx)(te.a,{name:"threshold",children:Object(e.jsx)(G.LemonInput,{min:0,type:"number"})})]}):r?Object(e.jsx)("div",{children:Object(e.jsxs)(g.a,{align:"middle",children:[o?Object(e.jsxs)("span",{children:[Object(e.jsxs)("b",{children:[Object(p.Q)(o)," "]})," sentry errors in the past 24 hours."," "]}):Object(e.jsx)(he.a,{}),Object(e.jsx)("span",{children:"\xA0Trigger when there is a"}),Object(e.jsx)(te.a,{name:"threshold",className:"ml-3 mr-3",children:T=>{let{value:M,onChange:N}=T;return Object(e.jsx)(G.LemonInput,{value:M,suffix:Object(e.jsx)(e.Fragment,{children:"%"}),type:"number",min:0,onChange:N})}}),Object(e.jsx)(te.a,{name:"operator",className:"mr-3",children:T=>{let{value:M,onChange:N}=T;return Object(e.jsx)(G.LemonSelect,{options:[{label:"increase",value:"gt"},{label:"decrease",value:"lt"}],value:M,onChange:N})}}),Object(e.jsxs)("span",{children:["to"," ",o?Object(e.jsx)("b",{children:Object(p.Q)(Math.round(o*(1+(a.rollback_conditions[v].threshold||0)/100)))}):Object(e.jsx)(he.a,{})," ","errors."]}),Object(e.jsx)("div",{})]})}):C!=null&&C.is_staff?Object(e.jsxs)("div",{className:"mt-4",children:[Object(e.jsx)("b",{children:"This feature requires an active Sentry integration."}),Object(e.jsx)("br",{}),Object(e.jsx)(G.Link,{to:P.a.instanceSettings(),children:"Go to Instance Settings"})," and update the"," ",Object(e.jsx)("code",{children:'"SENTRY_"'})," properties from your Sentry account to enable."]}):Object(e.jsx)("p",{className:"text-muted",children:"This PostHog instance is not configured for Sentry. Please contact the instance owner to configure it."})]})})]})),!s&&Object(e.jsx)(G.LemonButton,{type:"secondary",onClick:()=>{i()},children:"Add condition"})]})}try{Oe.displayName="FeatureFlagAutoRollback",Oe.__docgenInfo={description:"",displayName:"FeatureFlagAutoRollback",props:{readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagAutoRollout.tsx#FeatureFlagAutoRollback"]={docgenInfo:Oe.__docgenInfo,name:"FeatureFlagAutoRollback",path:"frontend/src/scenes/feature-flags/FeatureFlagAutoRollout.tsx#FeatureFlagAutoRollback"})}catch(t){}var Yt=n("./frontend/src/scenes/project-homepage/RecentRecordings.tsx"),Jt=n("./frontend/src/scenes/session-recordings/player/modal/SessionPlayerModal.tsx"),Qt=n("./frontend/src/scenes/session-recordings/playlist/sessionRecordingsListLogic.ts");const Le=t=>({events:At(t).events});function Pe(t){let{flagKey:s}=t;const{currentTeam:a}=Object(c.useValues)(J.a),r=Object(Qt.e)({key:`feature-flag-${s}`,filters:Le(s)}),{sessionRecordings:o,sessionRecordingsResponseLoading:l,filters:i}=Object(c.useValues)(r);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Jt.a,{}),Object(e.jsx)(pt.a,{title:"Recordings with current feature flag",viewAllURL:P.a.sessionRecordings(void 0,i),loading:l,emptyMessage:a!=null&&a.session_recording_opt_in?{title:"There are no recordings for this project",description:"Make sure you have the javascript snippet setup in your website.",buttonText:"Learn more",buttonTo:"https://posthog.com/docs/user-guides/recordings"}:{title:"Recordings are not enabled for this project",description:"Once recordings are enabled, new recordings will display here.",buttonText:"Enable recordings",buttonTo:P.a.projectSettings()+"#recordings"},items:o.slice(0,5),renderRow:(u,_)=>Object(e.jsx)(Yt.b,{recording:u},_)})]})}try{Pe.displayName="FeatureFlagRecordings",Pe.__docgenInfo={description:"",displayName:"FeatureFlagRecordings",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagRecordingsCard.tsx#FeatureFlagRecordings"]={docgenInfo:Pe.__docgenInfo,name:"FeatureFlagRecordings",path:"frontend/src/scenes/feature-flags/FeatureFlagRecordingsCard.tsx#FeatureFlagRecordings"})}catch(t){}try{Le.displayName="filtersForFlag",Le.__docgenInfo={description:"",displayName:"filtersForFlag",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagRecordingsCard.tsx#filtersForFlag"]={docgenInfo:Le.__docgenInfo,name:"filtersForFlag",path:"frontend/src/scenes/feature-flags/FeatureFlagRecordingsCard.tsx#filtersForFlag"})}catch(t){}var Xt=n("./frontend/src/scenes/billing/billingLogic.ts"),Zt=n("./frontend/src/scenes/events/index.ts"),qt=n("./frontend/src/lib/components/PropertyFilters/utils.ts"),es=n("./frontend/src/lib/components/LemonSelectMultiple/LemonSelectMultiple.tsx"),mt=n("./frontend/src/scenes/organization/Settings/Permissions/permissionsLogic.tsx"),ts=n("./frontend/src/scenes/organization/Settings/Permissions/Roles/rolesLogic.tsx");function Ce(t){return t.map(s=>({key:s.id,label:`${s.name}`,labelComponent:Object(e.jsx)("span",{children:Object(e.jsx)("b",{children:`${s.name}`})})}))}function Ge(t){let{title:s,visible:a,onClose:r,rolesToAdd:o,addableRoles:l,onChange:i,addableRolesLoading:u,onAdd:_,roles:C,deleteAssociatedRole:h,isNewResource:v,canEdit:T}=t;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(G.LemonModal,{title:s,isOpen:a,onClose:r,children:Object(e.jsx)(me,{resourceType:f.T.FEATURE_FLAGS,isNewResource:v,onChange:i,rolesToAdd:o,addableRoles:l,addableRolesLoading:u,onAdd:_,roles:C,deleteAssociatedRole:h,canEdit:T})})})}function me(t){let{rolesToAdd:s,addableRoles:a,onChange:r,addableRolesLoading:o,onAdd:l,roles:i,deleteAssociatedRole:u,isNewResource:_,resourceType:C,canEdit:h}=t;const{allPermissions:v,shouldShowPermissionsTable:T}=Object(c.useValues)(mt.b),{roles:M}=Object(c.useValues)(ts.a),N=v.find(U=>U.resource===C),Q=M.filter(U=>U.feature_flags_access_level===f.a.WRITE),Y=[{title:"Role",dataIndex:"name",key:"name",render:function(V,se){return Object(e.jsx)(e.Fragment,{children:se.name==="Organization default"?Object(e.jsx)(G.Link,{to:`${P.a.organizationSettings()}?tab=role_access`,children:se.name}):se.name})}},{title:"Access",dataIndex:"feature_flags_access_level",key:"feature_flags_access_level",render:function(V,se){return Object(e.jsxs)("div",{className:"flex flex-row justify-between",children:[se.feature_flags_access_level===f.a.WRITE?"Edit":"View",se.deletable&&Object(e.jsx)(G.LemonButton,{icon:Object(e.jsx)($.IconDelete,{}),onClick:()=>u(se.id),tooltip:"Remove custom role from feature flag",status:"primary-alt",type:"tertiary",size:"small"})]})}}],ce=[{id:"",name:"Organization default",feature_flags_access_level:N?N.access_level:f.a.WRITE,created_by:null,created_at:""},...Q,...i.map(U=>A(x({},U),{feature_flags_access_level:f.a.WRITE,deletable:!0}))];return Object(e.jsxs)(e.Fragment,{children:[!T&&Object(e.jsxs)(e.Fragment,{children:[N&&Object(e.jsx)(ss,{resourceLevel:N}),Object(e.jsx)(ns,{roles:Q})]}),(_||h)&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h5",{className:"mt-4",children:"Custom edit roles"}),Object(e.jsxs)("div",{className:"flex gap-2",children:[Object(e.jsx)("div",{className:"flex-1",children:Object(e.jsx)(es.a,{placeholder:"Search for roles to add\u2026",loading:o,onChange:r,value:s,filterOption:!0,mode:"multiple","data-attr":"resource-permissioning-select",options:Ce(a)})}),!_&&Object(e.jsx)(G.LemonButton,{type:"primary",loading:!1,disabled:s.length===0,onClick:l,children:"Add"})]})]}),T&&Object(e.jsx)(G.LemonTable,{dataSource:ce,columns:Y,className:"mt-4"}),!T&&!_&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h5",{className:"mt-4",children:"Roles"}),i.length>0?Object(e.jsx)("div",{className:"pb-2 rounded overflow-y-auto",style:{maxHeight:300},children:i.map(U=>Object(e.jsx)(as,{role:U,deleteRole:V=>u(V)},U.id))}):Object(e.jsx)("div",{className:"text-muted mb-2",children:"No roles added yet"})]})]})}function ss(t){let{resourceLevel:s}=t;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h5",{children:"Organization Default"}),Object(e.jsx)(G.Link,{to:`${P.a.organizationSettings()}?tab=role_access`,children:Object(e.jsx)("b",{children:mt.a[s.access_level]})})]})}function ns(t){let{roles:s}=t;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h5",{className:"mt-4",children:"Roles with edit access"}),Object(e.jsx)(g.a,{children:s.map(a=>Object(e.jsxs)("span",{className:"simple-tag tag-light-blue text-primary-alt mr-2",children:[Object(e.jsx)("b",{children:a.name})," "]},a.id))})]})}function as(t){let{role:s,deleteRole:a}=t;return Object(e.jsxs)("div",{className:"flex items-center justify-between h-8",children:[Object(e.jsx)("b",{children:s.name}),a&&Object(e.jsx)(G.LemonButton,{icon:Object(e.jsx)($.IconDelete,{}),onClick:()=>a(s.id),tooltip:"Remove role from permission",status:"primary-alt",type:"tertiary",size:"small"})]})}try{Ce.displayName="roleLemonSelectOptions",Ce.__docgenInfo={description:"",displayName:"roleLemonSelectOptions",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/ResourcePermissionModal.tsx#roleLemonSelectOptions"]={docgenInfo:Ce.__docgenInfo,name:"roleLemonSelectOptions",path:"frontend/src/scenes/ResourcePermissionModal.tsx#roleLemonSelectOptions"})}catch(t){}try{Ge.displayName="ResourcePermissionModal",Ge.__docgenInfo={description:"",displayName:"ResourcePermissionModal",props:{title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},visible:{defaultValue:null,description:"",name:"visible",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},addableRoles:{defaultValue:null,description:"",name:"addableRoles",required:!0,type:{name:"RoleType[]"}},addableRolesLoading:{defaultValue:null,description:"",name:"addableRolesLoading",required:!0,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(newValue: string[]) => void"}},rolesToAdd:{defaultValue:null,description:"",name:"rolesToAdd",required:!0,type:{name:"string[]"}},onAdd:{defaultValue:null,description:"",name:"onAdd",required:!0,type:{name:"() => void"}},roles:{defaultValue:null,description:"",name:"roles",required:!0,type:{name:"RoleType[]"}},deleteAssociatedRole:{defaultValue:null,description:"",name:"deleteAssociatedRole",required:!0,type:{name:"(id: string) => void"}},isNewResource:{defaultValue:null,description:"",name:"isNewResource",required:!0,type:{name:"boolean"}},resourceType:{defaultValue:null,description:"",name:"resourceType",required:!0,type:{name:"Resource"}},canEdit:{defaultValue:null,description:"",name:"canEdit",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/ResourcePermissionModal.tsx#ResourcePermissionModal"]={docgenInfo:Ge.__docgenInfo,name:"ResourcePermissionModal",path:"frontend/src/scenes/ResourcePermissionModal.tsx#ResourcePermissionModal"})}catch(t){}try{me.displayName="ResourcePermission",me.__docgenInfo={description:"",displayName:"ResourcePermission",props:{addableRoles:{defaultValue:null,description:"",name:"addableRoles",required:!0,type:{name:"RoleType[]"}},addableRolesLoading:{defaultValue:null,description:"",name:"addableRolesLoading",required:!0,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(newValue: string[]) => void"}},rolesToAdd:{defaultValue:null,description:"",name:"rolesToAdd",required:!0,type:{name:"string[]"}},onAdd:{defaultValue:null,description:"",name:"onAdd",required:!0,type:{name:"() => void"}},roles:{defaultValue:null,description:"",name:"roles",required:!0,type:{name:"RoleType[]"}},deleteAssociatedRole:{defaultValue:null,description:"",name:"deleteAssociatedRole",required:!0,type:{name:"(id: string) => void"}},isNewResource:{defaultValue:null,description:"",name:"isNewResource",required:!0,type:{name:"boolean"}},resourceType:{defaultValue:null,description:"",name:"resourceType",required:!0,type:{name:"Resource"}},canEdit:{defaultValue:null,description:"",name:"canEdit",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/ResourcePermissionModal.tsx#ResourcePermission"]={docgenInfo:me.__docgenInfo,name:"ResourcePermission",path:"frontend/src/scenes/ResourcePermissionModal.tsx#ResourcePermission"})}catch(t){}var gt=n("./frontend/src/lib/components/PayGateMini/PayGateMini.tsx"),Ye=n("./frontend/src/queries/schema.ts"),rs=n("./frontend/src/queries/Query/Query.tsx"),os=n("./frontend/src/queries/nodes/DataTable/utils.ts");const ls={component:_e,logic:ae,paramsToProps:t=>{let{params:{id:s}}=t;return{id:s&&s!=="new"?parseInt(s):"new"}}};function ft(t){setTimeout(()=>{var s;return(s=document.querySelector(`.variant-form-list input[data-key-index="${t}"]`))===null||s===void 0?void 0:s.focus()},50)}function _e(){var t;let{id:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{props:a,featureFlag:r,featureFlagLoading:o,featureFlagMissing:l,isEditingFlag:i}=Object(c.useValues)(ae),{featureFlags:u}=Object(c.useValues)($e.a),{deleteFeatureFlag:_,editFeatureFlag:C,loadFeatureFlag:h}=Object(c.useActions)(ae),{addableRoles:v,unfilteredAddableRolesLoading:T,rolesToAdd:M,derivedRoles:N}=Object(c.useValues)(we({flagId:r.id})),{setRolesToAdd:Q,addAssociatedRoles:Y,deleteAssociatedRole:ce}=Object(c.useActions)(we({flagId:r.id})),[U,V]=Object(m.useState)(!1),[se,ge]=Object(m.useState)(ne.a.OVERVIEW),fe=s==="new"||s===void 0;return l?Object(e.jsx)(Wt.a,{object:"feature flag"}):o?Object(e.jsx)(he.b,{}):Object(e.jsx)(e.Fragment,{children:Object(e.jsx)("div",{className:"feature-flag",children:fe||i?Object(e.jsxs)(w.Form,{logic:ae,props:a,formKey:"featureFlag",enableFormOnSubmit:!0,className:"space-y-4",children:[Object(e.jsx)(ot.a,{title:fe?"New feature flag":r.key||"Untitled",buttons:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)(q.a,{"data-attr":"cancel-feature-flag",type:"secondary",onClick:()=>{i?(C(!1),h()):X.router.actions.push(P.a.featureFlags())},disabled:o,children:"Cancel"}),Object(e.jsx)(q.a,{type:"primary","data-attr":"save-feature-flag",htmlType:"submit",loading:o,disabled:o,children:"Save"})]})}),Object(e.jsx)(Z.a,{}),r.experiment_set&&((t=r.experiment_set)===null||t===void 0?void 0:t.length)>0&&Object(e.jsxs)(ct.a,{type:"warning",children:["This feature flag is linked to an experiment. It's recommended to only make changes to this flag"," ",Object(e.jsx)(Se.a,{to:P.a.experiment(r.experiment_set[0]),children:"using the experiment creation screen."})]}),Object(e.jsx)(wt.a,{additionalInfo:", meaning it can take around 60 seconds for some flags to update for recently-identified persons. To sidestep this, you can choose to override server properties when requesting the feature flag"}),Object(e.jsxs)(g.a,{gutter:16,style:{marginBottom:32},children:[Object(e.jsxs)(O.a,{span:12,className:"space-y-4",children:[Object(e.jsx)(te.a,{name:"key",label:"Key",help:U&&s!=="new"?Object(e.jsxs)("span",{className:"text-warning",children:[Object(e.jsx)("b",{children:"Warning! "}),"Changing this key will",Object(e.jsxs)("a",{href:`https://posthog.com/docs/features/feature-flags${ie}#feature-flag-persistence`,target:"_blank",rel:"noopener",children:[" ","affect the persistence of your flag ",Object(e.jsx)($.IconOpenInNew,{})]})]}):void 0,children:H=>{let{value:F,onChange:k}=H;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(He.a,{value:F,onChange:je=>{je!==F&&V(!0),k(je)},"data-attr":"feature-flag-key",className:"ph-ignore-input",autoFocus:!0,placeholder:"examples: new-landing-page, betaFeature, ab_test_1",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}),Object(e.jsx)("span",{style:{fontSize:13},className:"text-muted",children:"Feature flag keys must be unique"})]})}}),Object(e.jsx)(te.a,{name:"name",label:"Description",children:Object(e.jsx)(Kt.a,{className:"ph-ignore-input","data-attr":"feature-flag-description",defaultValue:r.name||""})}),Object(e.jsx)(te.a,{name:"ensure_experience_continuity",children:H=>{let{value:F,onChange:k}=H;return Object(e.jsxs)("div",{className:"border rounded p-4",children:[Object(e.jsx)(it.a,{id:"continuity-checkbox",label:"Persist flag across authentication steps",onChange:()=>k(!F),fullWidth:!0,checked:F}),Object(e.jsxs)("div",{className:"text-muted text-sm pl-7",children:["If your feature flag is applied prior to an identify or authentication event, use this to ensure that feature flags are not reset after a person is identified. This ensures the experience for the anonymous person is carried forward to the authenticated person."," ",Object(e.jsxs)(Se.a,{to:"https://posthog.com/manual/feature-flags#persisting-feature-flags-across-authentication-steps",target:"_blank",children:["Learn more ",Object(e.jsx)($.IconOpenInNew,{})]})]})]})}}),Object(e.jsx)(te.a,{name:"active",children:H=>{let{value:F,onChange:k}=H;return Object(e.jsx)("div",{className:"border rounded p-4",children:Object(e.jsx)(it.a,{id:"flag-enabled-checkbox",label:"Enable feature flag",onChange:()=>k(!F),checked:F})})}})]}),Object(e.jsx)(O.a,{span:12,children:Object(e.jsx)(be,{featureFlagKey:r.key||"my-flag"})})]}),Object(e.jsx)(Z.a,{}),Object(e.jsx)(jt,{}),Object(e.jsx)(Z.a,{}),Object(e.jsx)(bt,{}),Object(e.jsx)(Z.a,{}),u[re.i.AUTO_ROLLBACK_FEATURE_FLAGS]&&Object(e.jsx)(Oe,{}),u[re.i.ROLE_BASED_ACCESS]&&Object(e.jsx)(D.a,{title:"Permissions",className:"mb-4",children:Object(e.jsx)(gt.a,{feature:f.e.ROLE_BASED_ACCESS,children:Object(e.jsx)(me,{resourceType:f.T.FEATURE_FLAGS,isNewResource:s==="new",onChange:H=>Q(H),rolesToAdd:M,addableRoles:v,addableRolesLoading:T,onAdd:()=>Y(),roles:N,deleteAssociatedRole:H=>ce({roleId:H}),canEdit:r.can_edit})})}),Object(e.jsx)(le.a,{className:"mt-8"}),Object(e.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[Object(e.jsx)(q.a,{"data-attr":"cancel-feature-flag",type:"secondary",onClick:()=>{i?(C(!1),h()):X.router.actions.push(P.a.featureFlags())},disabled:o,children:"Cancel"}),Object(e.jsx)(q.a,{type:"primary","data-attr":"save-feature-flag",htmlType:"submit",loading:o,disabled:o,children:"Save"})]})]}):Object(e.jsx)(e.Fragment,{children:o?Object(e.jsx)(z.a,{active:!0}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(ot.a,{title:Object(e.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[r.key||"Untitled",Object(e.jsx)(dt.a,{explicitValue:r.key,iconStyle:{color:"var(--muted-alt)"}}),Object(e.jsx)("div",{className:"flex",children:r.active?Object(e.jsx)(ut.a,{type:"success",className:"uppercase",children:"Enabled"}):Object(e.jsx)(ut.a,{type:"default",className:"uppercase",children:"Disabled"})})]}),description:Object(e.jsx)(e.Fragment,{children:r.name?Object(e.jsx)("span",{style:{fontStyle:"normal"},children:r.name}):"There is no description for this feature flag."}),buttons:Object(e.jsx)(e.Fragment,{children:Object(e.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[Object(e.jsx)(q.a,{"data-attr":"delete-feature-flag",status:"danger",type:"secondary",onClick:()=>{_(r)},disabled:o||!r.can_edit,children:"Delete feature flag"}),Object(e.jsx)(q.a,{"data-attr":"edit-feature-flag",type:"secondary",tooltip:u[re.i.ROLE_BASED_ACCESS]&&!r.can_edit&&"You have only 'View' access for this feature flag. To make changes, please contact the flag's creator.",onClick:()=>{C(!0)},disabled:o||!r.can_edit,children:"Edit"})]})})}),Object(e.jsxs)(d.a,{activeKey:se,destroyInactiveTabPane:!0,onChange:H=>ge(H),children:[Object(e.jsx)(d.a.TabPane,{tab:"Overview",children:Object(e.jsxs)(g.a,{children:[Object(e.jsxs)(O.a,{span:13,children:[Object(e.jsx)(jt,{readOnly:!0}),Object(e.jsx)(bt,{readOnly:!0}),u[re.i.AUTO_ROLLBACK_FEATURE_FLAGS]&&Object(e.jsx)(Oe,{readOnly:!0})]}),Object(e.jsxs)(O.a,{span:11,className:"pl-4",children:[Object(e.jsx)(Vt,{}),Object(e.jsx)("div",{className:"my-4"}),u[re.i.RECORDINGS_ON_FEATURE_FLAGS]?Object(e.jsx)(Pe,{flagKey:r.key||"my-flag"}):Object(e.jsx)(be,{featureFlagKey:r.key||"my-flag"})]})]})},"overview"),u[re.i.EXPOSURES_ON_FEATURE_FLAGS]&&r.key&&s&&Object(e.jsx)(d.a.TabPane,{tab:"Exposures",children:Object(e.jsx)(is,{id:s,featureFlagKey:r.key})},"exposure"),r.id&&Object(e.jsx)(d.a.TabPane,{tab:"History",children:Object(e.jsx)(Bt.a,{scope:kt.a.FEATURE_FLAG,id:r.id})},"history"),u[re.i.ROLE_BASED_ACCESS]&&r.can_edit&&Object(e.jsx)(d.a.TabPane,{tab:"Permissions",children:Object(e.jsx)(gt.a,{feature:f.e.ROLE_BASED_ACCESS,children:Object(e.jsx)(me,{resourceType:f.T.FEATURE_FLAGS,isNewResource:s==="new",onChange:H=>Q(H),rolesToAdd:M,addableRoles:v,addableRolesLoading:T,onAdd:()=>Y(),roles:N,deleteAssociatedRole:H=>ce({roleId:H}),canEdit:r.can_edit})})},"permissions")]})]})})})})}function is(t){let{id:s,featureFlagKey:a}=t;const{featureFlags:r}=Object(c.useValues)($e.a);return r[re.i.DATA_EXPLORATION_LIVE_EVENTS]?Object(e.jsx)(rs.a,{query:{kind:Ye.a.DataTableNode,source:{kind:Ye.a.EventsQuery,select:Object(os.a)(Ye.a.EventsQuery),event:"$feature_flag_called",properties:Ue(a)},full:!0,showEventFilter:!1,showPropertyFilter:!1}}):Object(e.jsx)(Zt.b,{fixedFilters:{event_filter:"$feature_flag_called",properties:Ue(a)},sceneUrl:P.a.featureFlag(s),fetchMonths:3,pageKey:`feature-flag-${a}}`,showEventFilter:!1,showPropertyFilter:!1})}function jt(t){let{readOnly:s}=t;const{multivariateEnabled:a,variants:r,areVariantRolloutsValid:o,featureFlagLoading:l,variantRolloutSum:i,nonEmptyVariants:u,aggregationTargetName:_,featureFlag:C}=Object(c.useValues)(ae),{distributeVariantsEqually:h,addVariant:v,removeVariant:T,setMultivariateEnabled:M}=Object(c.useActions)(ae),[N,Q]=Object(m.useState)(!1),{hasAvailableFeature:Y}=Object(c.useValues)(Be.a),{upgradeLink:ce}=Object(c.useValues)(Xt.b);return Object(e.jsxs)(e.Fragment,{children:[s?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"flex flex-col mb-4",children:[Object(e.jsx)("span",{className:"card-secondary",children:"Type"}),Object(e.jsx)("span",{children:C.filters.multivariate?"Multiple variants with rollout percentages (A/B/C test)":"Release toggle (boolean)"}),Object(e.jsx)("span",{className:"card-secondary mt-4",children:"Flag persistence"}),Object(e.jsxs)("span",{children:["This flag"," ",Object(e.jsxs)("b",{children:[C.ensure_experience_continuity?"persists":"does not persist"," "]}),"across authentication events."]})]}),Object(e.jsx)(le.a,{className:"my-3"}),C.filters.multivariate&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)("b",{children:"Variant keys"})}),Object(e.jsxs)("div",{className:"border rounded p-4 mb-4",children:[Object(e.jsxs)(g.a,{className:"font-semibold",children:[Object(e.jsx)(O.a,{span:10,children:"Key"}),Object(e.jsx)(O.a,{span:11,children:"Description"}),Object(e.jsx)(O.a,{span:3,children:"Rollout"})]}),Object(e.jsx)(le.a,{className:"my-3"}),r.map((U,V)=>Object(e.jsxs)("div",{children:[Object(e.jsxs)(g.a,{children:[Object(e.jsxs)(O.a,{span:10,children:[Object(e.jsx)(Te.a,{name:p.c[V],color:Te.b.Gray}),Object(e.jsx)(dt.a,{tooltipMessage:null,description:"key",style:{marginLeft:"0.5rem"},iconStyle:{color:"var(--muted-alt)"},children:U.key})]}),Object(e.jsx)(O.a,{span:12,children:U.name||"There is no description for this variant key"}),Object(e.jsxs)(O.a,{span:2,children:[U.rollout_percentage,"%"]})]}),V!==r.length-1&&Object(e.jsx)(le.a,{className:"my-3"})]},V))]})]})]}):Object(e.jsxs)("div",{className:"mb-8",children:[Object(e.jsx)("h3",{className:"l4",children:"Served value"}),Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)(b.a,{placement:"top",title:"Change value type? The variants below will be lost.",disabled:l,visible:N,onConfirm:()=>{M(!1),Q(!1)},onCancel:()=>Q(!1),okText:"OK",cancelText:"Cancel",children:Object(e.jsx)(E.a.Group,{options:[{label:"Release toggle (boolean)",value:!1},{label:Object(e.jsx)(Nt.a,{title:Y(f.e.MULTIVARIATE_FLAGS)?"":"This feature is not available on your current plan.",children:Object(e.jsxs)("div",{children:[!Y(f.e.MULTIVARIATE_FLAGS)&&Object(e.jsx)(Se.a,{to:ce,target:"_blank",children:Object(e.jsx)(R.a,{style:{marginRight:4,color:"var(--warning)"}})}),"Multiple variants with rollout percentages (A/B test)"]})}),value:!0,disabled:!Y(f.e.MULTIVARIATE_FLAGS)}],onChange:U=>{const{value:V}=U.target;V===!1&&u.length?Q(!0):(M(V),ft(0))},value:a,optionType:"button"})})}),Object(e.jsxs)("div",{className:"text-muted mb-4",children:[Object(p.i)(_)," will be served"," ",a?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("strong",{children:"a variant key"})," according to the below distribution"]}):Object(e.jsx)("strong",{children:Object(e.jsx)("code",{children:"true"})})," ","if they match one or more release condition groups."]})]}),!s&&a&&Object(e.jsxs)("div",{className:"feature-flag-variants",children:[Object(e.jsx)("h3",{className:"l4",children:"Variant keys"}),Object(e.jsx)("span",{children:"The rollout percentage of feature flag variants must add up to 100%"}),Object(e.jsxs)("div",{className:"variant-form-list space-y-2",children:[Object(e.jsxs)(g.a,{gutter:8,className:"label-row",children:[Object(e.jsx)(O.a,{span:1}),Object(e.jsx)(O.a,{span:6,children:"Variant key"}),Object(e.jsx)(O.a,{span:12,children:"Description"}),Object(e.jsxs)(O.a,{span:4,children:["Rollout",Object(e.jsx)(q.a,{type:"tertiary",onClick:h,children:"(Redistribute)"})]})]}),r.map((U,V)=>Object(e.jsx)(w.Group,{name:["filters","multivariate","variants",V],children:Object(e.jsxs)(g.a,{gutter:8,align:"middle",children:[Object(e.jsx)(O.a,{span:1,children:Object(e.jsx)(Te.a,{name:p.c[V],color:Te.b.Gray})}),Object(e.jsx)(O.a,{span:6,children:Object(e.jsx)(te.a,{name:"key",children:Object(e.jsx)(He.a,{"data-attr":"feature-flag-variant-key","data-key-index":V.toString(),className:"ph-ignore-input",placeholder:`example-variant-${V+1}`,autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})})}),Object(e.jsx)(O.a,{span:12,children:Object(e.jsx)(te.a,{name:"name",children:Object(e.jsx)(He.a,{"data-attr":"feature-flag-variant-name",className:"ph-ignore-input",placeholder:"Description"})})}),Object(e.jsx)(O.a,{span:3,children:Object(e.jsx)(te.a,{name:"rollout_percentage",children:se=>{let{value:ge,onChange:fe}=se;return Object(e.jsx)(I.a,{min:0,max:100,value:ge,onChange:H=>{if(H!=null){const F=parseInt(H.toString());isNaN(F)||fe(F)}},style:{width:"100%",borderColor:o?void 0:"var(--danger)"}})}})}),Object(e.jsx)(O.a,{span:2,children:Object(e.jsx)(g.a,{children:r.length>1&&Object(e.jsx)(q.a,{icon:Object(e.jsx)($.IconDelete,{}),status:"primary-alt","data-attr":`delete-prop-filter-${V}`,noPadding:!0,onClick:()=>T(V)})})})]})},V)),r.length>0&&!o&&Object(e.jsxs)("p",{className:"text-danger",children:["Percentage rollouts for variants must sum to 100 (currently ",i,")."]}),Object(e.jsx)(q.a,{type:"secondary",onClick:()=>{const U=r.length;v(),ft(U)},icon:Object(e.jsx)($.IconPlus,{}),center:!0,children:"Add variant"})]})]})]})}function bt(t){var s,a;let{readOnly:r}=t;const{showGroupsOptions:o,aggregationLabel:l}=Object(c.useValues)(ue.a),{aggregationTargetName:i,featureFlag:u,groupTypes:_,taxonomicGroupTypes:C,nonEmptyVariants:h,propertySelectErrors:v,computeBlastRadiusPercentage:T,affectedUsers:M,totalUsers:N}=Object(c.useValues)(ae),{setAggregationGroupTypeIndex:Q,updateConditionSet:Y,duplicateConditionSet:ce,removeConditionSet:U,addConditionSet:V}=Object(c.useActions)(ae),{cohortsById:se}=Object(c.useValues)(zt.a),{featureFlags:ge}=Object(c.useValues)($e.a),fe=Ie({value:-2}),H=F=>!!F.find(k=>k.type==="cohort"||!re.l.includes(k.key||""));return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"feature-flag-form-row",children:[Object(e.jsx)("div",{"data-attr":"feature-flag-release-conditions",children:r?Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)("b",{children:"Release conditions"})}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h3",{className:"l4",children:"Release conditions"}),Object(e.jsxs)("div",{className:"text-muted mb-4",children:["Specify the ",i," to which you want to release this flag. Note that condition sets are rolled out independently of each other."]})]})}),!r&&o&&Object(e.jsxs)("div",{className:"centered",children:["Match by",Object(e.jsxs)(y.a,{value:((s=u.filters)===null||s===void 0?void 0:s.aggregation_group_type_index)!=null?(a=u.filters)===null||a===void 0?void 0:a.aggregation_group_type_index:-1,onChange:F=>{Q(F!==-1?F:null)},style:{marginLeft:8},"data-attr":"feature-flag-aggregation-filter",dropdownMatchSelectWidth:!1,dropdownAlign:{points:["tr","br"]},children:[Object(e.jsx)(y.a.Option,{value:-1,children:"Users"},-1),_.map(F=>Object(e.jsx)(y.a.Option,{value:F.group_type_index,children:Object(p.i)(l(F.group_type_index).plural)},F.group_type_index)),fe]})]})]}),Object(e.jsx)(g.a,{gutter:16,children:u.filters.groups.map((F,k)=>{var je,Je,Qe,Xe,Ze,qe,et;return Object(e.jsxs)(O.a,{span:24,md:24,children:[k>0&&Object(e.jsx)("div",{className:"condition-set-separator",children:"OR"}),Object(e.jsxs)("div",{className:"mb-4 border rounded p-4",children:[Object(e.jsxs)(g.a,{align:"middle",justify:"space-between",children:[Object(e.jsxs)(g.a,{align:"middle",children:[Object(e.jsxs)("span",{className:"simple-tag tag-light-blue font-medium mr-2",children:["Set ",k+1]}),Object(e.jsx)("div",{children:(je=F.properties)!==null&&je!==void 0&&je.length?Object(e.jsx)(e.Fragment,{children:r?Object(e.jsxs)(e.Fragment,{children:["Match ",Object(e.jsx)("b",{children:i})," against ",Object(e.jsx)("b",{children:"all"})," criteria"]}):Object(e.jsxs)(e.Fragment,{children:["Matching ",Object(e.jsx)("b",{children:i})," against the criteria"]})}):Object(e.jsxs)(e.Fragment,{children:["Condition set will match ",Object(e.jsxs)("b",{children:["all ",i]})]})})]}),!r&&Object(e.jsxs)(g.a,{children:[Object(e.jsx)(q.a,{icon:Object(e.jsx)($.IconCopy,{}),status:"muted",noPadding:!0,onClick:()=>ce(k)}),u.filters.groups.length>1&&Object(e.jsx)(q.a,{icon:Object(e.jsx)($.IconDelete,{}),status:"muted",noPadding:!0,onClick:()=>U(k)})]})]}),Object(e.jsx)(le.a,{className:"my-3"}),!r&&H(F.properties)&&Object(e.jsxs)(ct.a,{type:"info",className:"mt-3 mb-3",children:["These properties aren't immediately available on first page load for unidentified persons. This feature flag requires that at least one event is sent prior to becoming available to your product or website."," ",Object(e.jsxs)("a",{href:"https://posthog.com/docs/integrate/client/js#bootstrapping-flags",target:"_blank",children:[" ","Learn more about how to make feature flags available instantly."]})]}),r?Object(e.jsx)(e.Fragment,{children:F.properties.map((W,Me)=>Object(e.jsx)(e.Fragment,{children:Object(e.jsxs)("div",{className:"feature-flag-property-display",children:[Me===0?Object(e.jsx)(q.a,{icon:Object(e.jsx)($.IconSubArrowRight,{className:"arrow-right"}),status:"muted",size:"small"}):Object(e.jsx)(q.a,{icon:Object(e.jsx)("span",{className:"text-sm",children:"&"}),status:"muted",size:"small"}),Object(e.jsxs)("span",{className:"simple-tag tag-light-blue text-primary-alt",children:[W.type==="cohort"?"Cohort":W.key," "]}),Object(qt.d)(W)?Object(e.jsxs)("span",{children:[Object(Ut.a)(W.operator)," "]}):null,[...Array.isArray(W.value)?W.value:[W.value]].map((Ne,cs)=>{var tt;return Object(e.jsx)("span",{className:"simple-tag tag-light-blue text-primary-alt display-value",children:W.type==="cohort"?Ne&&((tt=se[Ne])===null||tt===void 0?void 0:tt.name)||`ID ${Ne}`:Ne},cs)})]},Me)}))}):Object(e.jsx)("div",{children:Object(e.jsx)(B.a,{orFiltering:!0,pageKey:`feature-flag-${u.id}-${k}-${u.filters.groups.length}-${(Je=u.filters.aggregation_group_type_index)!==null&&Je!==void 0?Je:""}`,propertyFilters:F==null?void 0:F.properties,logicalRowDivider:!0,addButton:Object(e.jsx)(q.a,{icon:Object(e.jsx)($.IconPlusMini,{}),noPadding:!0,children:"Add condition"}),onChange:W=>Y(k,void 0,W),taxonomicGroupTypes:C,hasRowOperator:!1,sendAllKeyUpdates:!0,errorMessages:v!=null&&(Qe=v[k])!==null&&Qe!==void 0&&(Xe=Qe.properties)!==null&&Xe!==void 0&&Xe.some(W=>!!W.value)?v[k].properties.map((W,Me)=>W.value?Object(e.jsxs)("div",{className:"text-danger flex items-center gap-1 text-sm",children:[Object(e.jsx)($.IconErrorOutline,{className:"text-xl"})," ",W.value]},Me):Object(e.jsx)(e.Fragment,{})):null})}),(!r||r&&((Ze=F.properties)===null||Ze===void 0?void 0:Ze.length)>0)&&Object(e.jsx)(le.a,{className:"my-3"}),r?Object(e.jsxs)("div",{children:["Rolled out to"," ",Object(e.jsxs)("b",{children:[F.rollout_percentage!=null?F.rollout_percentage:100,"%"]})," of"," ",Object(e.jsx)("b",{children:i})," in this set."," "]}):Object(e.jsx)("div",{className:"feature-flag-form-row",children:Object(e.jsxs)("div",{className:"centered",children:["Roll out to"," ",Object(e.jsx)(I.a,{style:{width:100,marginLeft:8,marginRight:8},onChange:W=>{Y(k,W)},value:F.rollout_percentage!=null?F.rollout_percentage:100,min:0,max:100,addonAfter:"%"})," ","of ",Object(e.jsx)("b",{children:i})," in this set."," ",ge[re.i.FEATURE_FLAG_ROLLOUT_UX]&&Object(e.jsxs)(e.Fragment,{children:["Will match approximately"," ",M[k]!==void 0?Object(e.jsx)("b",{children:`${Object(p.Q)(T(F.rollout_percentage,k))}% `}):Object(e.jsx)(he.a,{className:"mr-1"})," ",M[k]&&M[k]>=0&&N?`(${Object(p.Q)(Math.floor(M[k]*((qe=F.rollout_percentage)!==null&&qe!==void 0?qe:100)/100))} / ${Object(p.Q)(N)})`:""," ","of total ",i,"."]})]})}),ge[re.i.VARIANT_OVERRIDES]&&h.length>0&&Object(e.jsxs)(e.Fragment,{children:[(!r||r&&((et=F.properties)===null||et===void 0?void 0:et.length)>0)&&Object(e.jsx)(le.a,{className:"my-3"}),r?Object(e.jsxs)("div",{children:["All ",Object(e.jsx)("b",{children:i})," in this set"," ",F.variant?Object(e.jsxs)(e.Fragment,{children:[" ","will be in variant ",Object(e.jsx)("b",{children:F.variant})]}):Object(e.jsx)(e.Fragment,{children:"have no variant override"})]}):Object(e.jsx)("div",{className:"feature-flag-form-row",children:Object(e.jsxs)("div",{className:"centered",children:[Object(e.jsx)("b",{children:"Optional override:"})," Set variant for all"," ",Object(e.jsx)("b",{children:i})," in this set to"," ",Object(e.jsx)(G.LemonSelect,{placeholder:"Select variant",allowClear:!0,value:F.variant,onChange:W=>Y(k,void 0,void 0,W),options:h.map(W=>({label:W.key,value:W.key})),"data-attr":"feature-flags-variant-override-select"})]})})]})]})]},`${k}-${u.filters.groups.length}`)})}),!r&&Object(e.jsx)(q.a,{type:"secondary",className:"mt-0",onClick:V,icon:Object(e.jsx)($.IconPlus,{}),children:"Add condition set"})]})}try{_e.displayName="FeatureFlag",_e.__docgenInfo={description:"",displayName:"FeatureFlag",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"]={docgenInfo:_e.__docgenInfo,name:"FeatureFlag",path:"frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"})}catch(t){}},"./frontend/src/scenes/organization/Settings/Permissions/Roles/rolesLogic.tsx":function(S,j,n){"use strict";n.d(j,"a",function(){return z});var m=n("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),w=n("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js"),Z=n.n(w),g=n("./frontend/src/lib/api.ts"),O=n("./frontend/src/scenes/project/Settings/teamMembersLogic.tsx"),D=n("./frontend/src/types.ts");const z=Object(m.kea)([Object(m.path)(["scenes","organization","rolesLogic"]),Object(m.connect)({values:[O.b,["allMembers"]]}),Object(m.actions)({setCreateRoleModalShown:d=>({shown:d}),setRoleInFocus:d=>({role:d}),setRoleMembersInFocus:d=>({roleMembers:d}),setRoleMembersToAdd:d=>({uuids:d}),openCreateRoleModal:!0,setPermission:(d,b)=>({resource:d,access:b}),clearPermission:!0,updateRole:d=>({role:d})}),Object(m.reducers)({createRoleModalShown:[!1,{setCreateRoleModalShown:(d,b)=>{let{shown:E}=b;return E}}],roleInFocus:[null,{setRoleInFocus:(d,b)=>{let{role:E}=b;return E}}],roleMembersInFocus:[[],{setRoleMembersInFocus:(d,b)=>{let{roleMembers:E}=b;return E}}],roleMembersToAdd:[[],{setRoleMembersToAdd:(d,b)=>{let{uuids:E}=b;return E}}],roles:[[],{updateRole:(d,b)=>{let{role:E}=b;return d.map(I=>I.id==E.id?E:I)}}]}),Object(w.loaders)(d=>{let{values:b,actions:E}=d;return{roles:{loadRoles:()=>K(this,null,function*(){const I=yield g.b.roles.list();return(I==null?void 0:I.results)||[]}),createRole:I=>K(this,null,function*(){const{roles:y,roleMembersToAdd:c}=b,p=yield g.b.roles.create(I);return yield E.addRoleMembers({role:p,membersToAdd:c}),E.setRoleMembersInFocus([]),E.setRoleMembersToAdd([]),E.clearPermission(),E.setCreateRoleModalShown(!1),[p,...y]}),deleteRole:I=>K(this,null,function*(){return yield g.b.roles.delete(I.id),b.roles.filter(y=>y.id!==I.id)})},roleMembersInFocus:[[],{loadRoleMembers:I=>K(this,null,function*(){let{roleId:y}=I;const c=yield g.b.roles.members.list(y);return(c==null?void 0:c.results)||[]}),addRoleMembers:I=>K(this,null,function*(){let{role:y,membersToAdd:c}=I;const p=yield Promise.all(c.map(B=>K(this,null,function*(){return yield g.b.roles.members.create(y.id,B)})));return E.setRoleMembersToAdd([]),[...b.roleMembersInFocus,...p]}),deleteRoleMember:I=>K(this,null,function*(){let{roleMemberUuid:y}=I;return b.roleInFocus&&(yield g.b.roles.members.delete(b.roleInFocus.id,y)),b.roleMembersInFocus.filter(c=>c.id!==y)})}]}}),Object(m.listeners)(d=>{let{actions:b,values:E}=d;return{setRoleInFocus:I=>{let{role:y}=I;y&&b.loadRoleMembers({roleId:y.id}),b.setCreateRoleModalShown(!0)},openCreateRoleModal:()=>{b.setRoleInFocus(null),b.setRoleMembersInFocus([]),b.setCreateRoleModalShown(!0)},setCreateRoleModalShown:()=>{E.roleInFocus?b.setPermission(D.T.FEATURE_FLAGS,E.roleInFocus.feature_flags_access_level):b.setPermission(D.T.FEATURE_FLAGS,D.a.WRITE)},deleteRoleSuccess:()=>{b.setCreateRoleModalShown(!1)}}}),Object(m.selectors)({addableMembers:[d=>[d.allMembers,d.roleMembersInFocus],(d,b)=>{const E=[];for(const I of d)b.some(y=>y.user.uuid===I.user.uuid)||E.push(I.user);return E.sort((I,y)=>I.first_name.localeCompare(y.first_name)),E}]}),Object(m.afterMount)(d=>{let{actions:b}=d;b.loadRoles()})])},"./frontend/src/scenes/organization/Settings/Permissions/permissionsLogic.tsx":function(S,j,n){"use strict";n.d(j,"a",function(){return I}),n.d(j,"b",function(){return c});var m=n("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),w=n("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js"),Z=n.n(w),g=n("./frontend/src/lib/api.ts"),O=n("./frontend/src/types.ts"),D=n("./frontend/src/lib/logic/featureFlagLogic.ts"),z=n("./frontend/src/lib/constants.tsx"),d=n("./frontend/src/scenes/organization/Settings/Permissions/Roles/rolesLogic.tsx"),b=n("./frontend/@posthog/lemon-ui/src/index.ts");const E={[O.T.FEATURE_FLAGS]:"Feature Flags"},I={[O.a.WRITE]:"View & Edit",[O.a.READ]:"View Only"},y={[O.T.FEATURE_FLAGS]:"feature_flags_access_level"},c=Object(m.kea)([Object(m.path)(["scenes","organization","Settings","Permissions","permissionsLogic"]),Object(m.connect)({values:[D.a,["featureFlags"],d.a,["roles"]],actions:[d.a,["updateRole"]]}),Object(m.actions)({updatePermission:(p,B,R,f)=>({checked:p,role:B,resourceId:R,resourceType:f})}),Object(w.loaders)(p=>{let{values:B}=p;return{organizationResourcePermissions:[[],{loadOrganizationResourcePermissions:()=>K(this,null,function*(){const R=yield g.b.resourcePermissions.list();return(R==null?void 0:R.results)||[]}),updateOrganizationResourcePermission:R=>K(this,null,function*(){let{id:f,resource:L,access_level:X}=R;if(f){const P=yield g.b.resourcePermissions.update(f,{access_level:X});return B.organizationResourcePermissions.map(J=>J.id==P.id?P:J)}else{const P=yield g.b.resourcePermissions.create({resource:L,access_level:X});return[...B.organizationResourcePermissions,P]}})}]}}),Object(m.listeners)(p=>{let{actions:B}=p;return{updatePermission:R=>K(this,null,function*(){let{checked:f,role:L,resourceId:X,resourceType:P}=R;const J=f?O.a.WRITE:O.a.READ;if(L.id){const ne=yield g.b.roles.update(L.id,{[y[P]]:J});ne&&(B.updateRole(ne),b.lemonToast.success(`${L.name} role ${P} edit access updated`))}else B.updateOrganizationResourcePermission({id:X,access_level:J})}),updateOrganizationResourcePermissionSuccess:()=>{b.lemonToast.success("Organizational edit access updated")}}}),Object(m.selectors)({organizationResourcePermissionsMap:[p=>[p.organizationResourcePermissions],p=>p.reduce((B,R)=>A(x({},B),{[R.resource]:R}),{})],allPermissions:[p=>[p.organizationResourcePermissionsMap],p=>Object.keys(E).map(B=>{var R,f;return{id:((R=p[B])===null||R===void 0?void 0:R.id)||null,resource:B,name:E[B],access_level:((f=p[B])===null||f===void 0?void 0:f.access_level)||O.a.WRITE}})],shouldShowPermissionsTable:[p=>[p.featureFlags],p=>p[z.i.ROLE_BASED_ACCESS]==="control"],resourceRolesAccess:[p=>[p.allPermissions,p.roles],(p,B)=>{const R=p.map(f=>({[f.resource]:{organization_default:f.access_level,id:f.id}}));for(const f of B)for(const L of R){const X=Object.keys(L)[0];L[X][`${f.name}`]=f[y[X]]}return R}]}),Object(m.afterMount)(p=>{let{actions:B}=p;B.loadOrganizationResourcePermissions()})])},"./frontend/src/scenes/project-homepage/ProjectHomePageCompactListItem.tsx":function(S,j,n){"use strict";n.d(j,"a",function(){return D});var m=n("./frontend/@posthog/lemon-ui/src/index.ts"),w=n("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),Z=n.n(w),g=n("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js"),O=n.n(g);function D(z){let{to:d,onClick:b,title:E,subtitle:I,prefix:y,suffix:c}=z;return Object(g.jsx)(m.LemonButton,{fullWidth:!0,to:d,onClick:b,children:Object(g.jsxs)("div",{className:"flex items-center justify-between h-10 overflow-hidden gap-2 flex-1",children:[y?Object(g.jsx)("span",{className:"shrink-0",children:y}):null,Object(g.jsxs)("div",{className:"truncate space-y-1 flex-1",children:[Object(g.jsx)("div",{className:"text-primary font-semibold truncate",children:E}),Object(g.jsx)("div",{className:"truncate text-default font-normal",children:I})]}),c?Object(g.jsx)("span",{className:"shrink-0",children:c}):null]})})}try{D.displayName="ProjectHomePageCompactListItem",D.__docgenInfo={description:"",displayName:"ProjectHomePageCompactListItem",props:{to:{defaultValue:null,description:"URL to link to.",name:"to",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},subtitle:{defaultValue:null,description:"",name:"subtitle",required:!0,type:{name:"string"}},prefix:{defaultValue:null,description:"",name:"prefix",required:!1,type:{name:"ReactNode"}},suffix:{defaultValue:null,description:"",name:"suffix",required:!1,type:{name:"ReactNode"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/project-homepage/ProjectHomePageCompactListItem.tsx#ProjectHomePageCompactListItem"]={docgenInfo:D.__docgenInfo,name:"ProjectHomePageCompactListItem",path:"frontend/src/scenes/project-homepage/ProjectHomePageCompactListItem.tsx#ProjectHomePageCompactListItem"})}catch(z){}},"./frontend/src/scenes/project-homepage/ProjectHomepage.scss":function(S,j,n){"use strict";var m=n("./node_modules/.pnpm/style-loader@2.0.0_webpack@4.46.0/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),w=n.n(m),Z=n("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/project-homepage/ProjectHomepage.scss"),g=n.n(Z),O={};O.insert="head",O.singleton=!1;var D=w()(g.a,O),z=g.a.locals||{}},"./frontend/src/scenes/project-homepage/RecentInsights.tsx":function(S,j,n){"use strict";n.d(j,"a",function(){return p}),n.d(j,"b",function(){return B});var m=n("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),w=n.n(m),Z=n("./frontend/src/scenes/project-homepage/ProjectHomepage.scss"),g=n("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),O=n("./frontend/src/lib/dayjs.ts"),D=n("./frontend/src/lib/components/CompactList/CompactList.tsx"),z=n("./frontend/src/scenes/urls.ts"),d=n("./frontend/src/scenes/saved-insights/SavedInsights.tsx"),b=n("./frontend/src/scenes/project-homepage/projectHomepageLogic.tsx"),E=n("./frontend/src/lib/utils/eventUsageLogic.ts"),I=n("./frontend/src/scenes/project-homepage/ProjectHomePageCompactListItem.tsx"),y=n("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js"),c=n.n(y);function p(R){let{insight:f}=R;const{reportInsightOpenedFromRecentInsightList:L}=Object(g.useActions)(E.e);return Object(y.jsx)(I.a,{title:f.name||f.derived_name||"Insight",subtitle:`Last modified ${Object(O.a)(f.last_modified_at).fromNow()}`,prefix:Object(y.jsx)(d.InsightIcon,{insight:f}),to:z.a.insightView(f.short_id),onClick:()=>{L()}})}function B(){const{recentInsights:R,recentInsightsLoading:f}=Object(g.useValues)(b.a),{loadRecentInsights:L}=Object(g.useActions)(b.a);return Object(m.useEffect)(()=>{L()},[]),Object(y.jsx)(y.Fragment,{children:Object(y.jsx)(D.a,{title:"Your recently viewed insights",viewAllURL:z.a.savedInsights(),loading:f,emptyMessage:{title:"You have no recently viewed insights",description:"Explore this project's insights by clicking below.",buttonText:"View insights",buttonTo:z.a.savedInsights()},items:R.slice(0,5),renderRow:(X,P)=>Object(y.jsx)(p,{insight:X},P)})})}try{p.displayName="InsightRow",p.__docgenInfo={description:"",displayName:"InsightRow",props:{insight:{defaultValue:null,description:"",name:"insight",required:!0,type:{name:"InsightModel"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/project-homepage/RecentInsights.tsx#InsightRow"]={docgenInfo:p.__docgenInfo,name:"InsightRow",path:"frontend/src/scenes/project-homepage/RecentInsights.tsx#InsightRow"})}catch(R){}},"./frontend/src/scenes/project-homepage/RecentRecordings.tsx":function(S,j,n){"use strict";n.d(j,"b",function(){return L}),n.d(j,"a",function(){return X});var m=n("./frontend/src/lib/dayjs.ts"),w=n("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),Z=n("./frontend/src/scenes/project-homepage/ProjectHomepage.scss"),g=n("./frontend/src/lib/components/CompactList/CompactList.tsx"),O=n("./frontend/src/lib/components/ProfilePicture/index.ts"),D=n("./frontend/src/scenes/persons/PersonHeader.tsx"),z=n("./frontend/src/scenes/session-recordings/playlist/sessionRecordingsListLogic.ts"),d=n("./frontend/src/scenes/urls.ts"),b=n("./frontend/src/lib/utils/eventUsageLogic.ts"),E=n("./frontend/src/lib/utils.tsx"),I=n("./frontend/src/lib/components/icons.tsx"),y=n("./frontend/src/scenes/session-recordings/player/modal/SessionPlayerModal.tsx"),c=n("./frontend/src/scenes/teamLogic.tsx"),p=n("./frontend/src/scenes/session-recordings/player/modal/sessionPlayerModalLogic.ts"),B=n("./frontend/src/scenes/project-homepage/ProjectHomePageCompactListItem.tsx"),R=n("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js"),f=n.n(R);function L(P){let{recording:J}=P;const{openSessionPlayer:ne}=Object(w.useActions)(p.a),{reportRecordingOpenedFromRecentRecordingList:ue}=Object(w.useActions)(b.e);return Object(R.jsx)(B.a,{title:Object(D.b)(J.person),subtitle:`Recorded ${Object(m.a)(J.start_time).fromNow()}`,prefix:Object(R.jsx)(O.b,{name:Object(D.b)(J.person)}),suffix:Object(R.jsxs)("div",{className:"flex items-center justify-end text-default",children:[Object(R.jsx)("span",{children:Object(E.P)(J.recording_duration)}),Object(R.jsx)(I.IconPlayCircle,{className:"text-2xl ml-2"})]}),onClick:()=>{ne({id:J.id,matching_events:J.matching_events}),ue()}})}function X(){const{currentTeam:P}=Object(w.useValues)(c.a),J=Object(z.e)({key:"projectHomepage"}),{sessionRecordings:ne,sessionRecordingsResponseLoading:ue}=Object(w.useValues)(J);return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(y.a,{}),Object(R.jsx)(g.a,{title:"Recent recordings",viewAllURL:d.a.sessionRecordings(),loading:ue,emptyMessage:P!=null&&P.session_recording_opt_in?{title:"There are no recordings for this project",description:"Make sure you have the javascript snippet setup in your website.",buttonText:"Learn more",buttonTo:"https://posthog.com/docs/user-guides/recordings"}:{title:"Recordings are not enabled for this project",description:"Once recordings are enabled, new recordings will display here.",buttonText:"Enable recordings",buttonTo:d.a.projectSettings()+"#recordings"},items:ne.slice(0,5),renderRow:(oe,Ke)=>Object(R.jsx)(L,{recording:oe},Ke)})]})}try{L.displayName="RecordingRow",L.__docgenInfo={description:"",displayName:"RecordingRow",props:{recording:{defaultValue:null,description:"",name:"recording",required:!0,type:{name:"SessionRecordingType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/project-homepage/RecentRecordings.tsx#RecordingRow"]={docgenInfo:L.__docgenInfo,name:"RecordingRow",path:"frontend/src/scenes/project-homepage/RecentRecordings.tsx#RecordingRow"})}catch(P){}},"./frontend/src/scenes/project-homepage/projectHomepageLogic.tsx":function(S,j,n){"use strict";n.d(j,"a",function(){return z});var m=n("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),w=n("./frontend/src/scenes/teamLogic.tsx"),Z=n("./frontend/src/types.ts"),g=n("./frontend/src/lib/api.ts"),O=n("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js"),D=n.n(O);const z=Object(m.kea)([Object(m.path)(["scenes","project-homepage","projectHomepageLogic"]),Object(m.connect)({values:[w.a,["currentTeamId","currentTeam"]]}),Object(m.selectors)({primaryDashboardId:[()=>[w.a.selectors.currentTeam],d=>d==null?void 0:d.primary_dashboard],dashboardLogicProps:[d=>[d.primaryDashboardId],d=>({id:d!=null?d:void 0,placement:Z.n.ProjectHomepage})]}),Object(O.loaders)(d=>{let{values:b}=d;return{recentInsights:[[],{loadRecentInsights:()=>K(this,null,function*(){return(yield g.b.get(`api/projects/${b.currentTeamId}/insights/?my_last_viewed=true&order=-my_last_viewed_at`)).results})}],persons:[[],{loadPersons:()=>K(this,null,function*(){return(yield g.b.persons.list()).results})}]}}),Object(m.afterMount)(d=>{let{actions:b}=d;b.loadRecentInsights(),b.loadPersons()})])},"./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss":function(S,j,n){var m=n("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/runtime/api.js");j=m(!1),j.push([S.i,".variant-form-list{font-size:13px;border:1px solid var(--border);border-radius:var(--radius);padding:16px;margin-top:16px}.variant-form-list .ant-form-item{min-height:32px}.variant-form-list .label-row{font-weight:700}.variant-form-list .label-row .ant-col{min-height:32px;display:flex;justify-content:space-between;align-items:center}.feature-flag-property-display{display:flex;flex-direction:row;align-items:center;flex-wrap:wrap;gap:.5rem;margin-top:.5rem}.feature-flag-property-display .arrow-right{margin-right:-8px;margin-top:.25rem}.feature-flag-property-display .display-value{word-break:break-all}.condition-set-separator{color:var(--primary-alt);font-size:12px;font-weight:var(--font-semibold);margin-left:.5rem;margin-bottom:.5rem}.feature-flag-form-row{display:flex;justify-content:space-between;align-items:center;width:100%}.feature-flag-form-row .centered{display:flex;align-items:center;white-space:pre-wrap}",""]),S.exports=j},"./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlagInstructions.scss":function(S,j,n){var m=n("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/runtime/api.js");j=m(!1),j.push([S.i,".FeatureFlagInstructionsHeader{flex-wrap:nowrap}.FeatureFlagInstructionsHeader .FeatureFlagInstructionsHeader__header-title{display:flex;justify-items:center}.FeatureFlagInstructionsHeader .FeatureFlagInstructionsHeader__header-title .FeatureFlagInstructionsHeader__header-title__icon{color:var(--text-muted-alt);margin-right:12px;font-size:1.6em}.FeatureFlagInstructionsHeader__option{display:flex;justify-items:center}.FeatureFlagInstructionsHeader__option .FeatureFlagInstructionsHeader__option__icon{margin-top:2px;margin-right:8px}",""]),S.exports=j},"./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/project-homepage/ProjectHomepage.scss":function(S,j,n){var m=n("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/runtime/api.js");j=m(!1),j.push([S.i,".project-homepage .homepage-dashboard-header{display:flex;justify-content:space-between;align-items:center}.project-homepage .homepage-dashboard-header .dashboard-title-container{display:flex;flex-direction:row;align-items:center}.project-homepage .homepage-dashboard-header .dashboard-title-container .ant-skeleton{width:300px}.project-homepage .homepage-dashboard-header .dashboard-title-container .ant-skeleton h3{margin:0}.project-homepage .top-list-container-horizontal{display:flex}.project-homepage .top-list-container-horizontal .top-list{margin-bottom:1.5rem;width:33%}.project-homepage .top-list-container-horizontal .spacer{width:1rem}.project-homepage .top-list-container-vertical{margin-bottom:1.5rem}.project-homepage .top-list-container-vertical .spacer{height:1rem}.project-homepage .empty-state-container{background-color:var(--side);width:100%;justify-content:center;align-items:center;padding:4rem;display:flex;flex-direction:column}",""]),S.exports=j}}]);
