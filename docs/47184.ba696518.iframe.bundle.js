"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[47184],{"../../frontend/src/scenes/new-tab/NewTabScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{NewTabScene:()=>NewTabScene,scene:()=>scene});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),react=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),ScrollableShadows=__webpack_require__("../../frontend/src/lib/components/ScrollableShadows/ScrollableShadows.tsx"),ListBox=__webpack_require__("../../frontend/src/lib/ui/ListBox/ListBox.tsx"),newTabSceneLogic=__webpack_require__("../../frontend/src/scenes/new-tab/newTabSceneLogic.tsx"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.35.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),dayjs=__webpack_require__("../../frontend/src/lib/dayjs.ts"),Link=__webpack_require__("../../frontend/src/lib/lemon-ui/Link/index.ts"),ButtonPrimitives=__webpack_require__("../../frontend/src/lib/ui/Button/ButtonPrimitives.tsx"),ContextMenu=__webpack_require__("../../frontend/src/lib/ui/ContextMenu/ContextMenu.tsx"),DropdownMenu=__webpack_require__("../../frontend/src/lib/ui/DropdownMenu/DropdownMenu.tsx"),Label=__webpack_require__("../../frontend/src/lib/ui/Label/Label.tsx"),WrappingLoadingSkeleton=__webpack_require__("../../frontend/src/lib/ui/WrappingLoadingSkeleton/WrappingLoadingSkeleton.tsx"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),SearchHighlight=__webpack_require__("../../frontend/src/layout/navigation-3000/components/SearchHighlight.tsx"),MenuItems=__webpack_require__("../../frontend/src/layout/panel-layout/ProjectTree/menus/MenuItems.tsx"),groupsModel=__webpack_require__("../../frontend/src/models/groupsModel.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function NoResultsFound(_ref){let{handleAskAi}=_ref,{setSearch}=(0,index_esm.useActions)(newTabSceneLogic.c);return(0,jsx_runtime.jsx)("div",{className:"flex flex-col gap-4 px-2 py-2 bg-glass-bg-3000 rounded-lg",children:(0,jsx_runtime.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,jsx_runtime.jsxs)("p",{className:"text-tertiary mb-2",children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconInfo,{})," No results found"]}),(0,jsx_runtime.jsxs)("div",{className:"flex gap-1",children:[(0,jsx_runtime.jsxs)(ListBox.w.Item,{asChild:!0,className:"list-none",children:[(0,jsx_runtime.jsx)(ButtonPrimitives.hL,{size:"sm",onClick:()=>setSearch(""),variant:"panel",children:"Clear search"})," "]}),"or"," ",(0,jsx_runtime.jsx)(ListBox.w.Item,{asChild:!0,children:(0,jsx_runtime.jsx)(ButtonPrimitives.hL,{size:"sm",onClick:()=>handleAskAi(),variant:"panel",children:"Ask Posthog AI"})})]})]})})}let getCategoryDisplayName=category=>({"create-new":"Create new",apps:"Apps","data-management":"Data management",recents:"Recents",persons:"Persons",groups:"Groups",eventDefinitions:"Events",propertyDefinitions:"Properties",askAI:"Posthog AI"})[category]||category,formatRelativeTimeShort=date=>{if(!date)return"";let parsedDate=(0,dayjs.Bv)(date);if(!parsedDate.isValid())return"";let now=(0,dayjs.Bv)();if(60>Math.max(0,now.diff(parsedDate,"second")))return"just now";let minutes=now.diff(parsedDate,"minute");if(minutes<60)return`${minutes} min ago`;let hours=now.diff(parsedDate,"hour");if(hours<24)return`${hours} hr${1===hours?"":"s"} ago`;let days=now.diff(parsedDate,"day");if(days<30)return`${days} day${1===days?"":"s"} ago`;let months=now.diff(parsedDate,"month")||1;if(months<12)return`${months} mo${1===months?"":"s"} ago`;let years=now.diff(parsedDate,"year")||1;return`${years} yr${1===years?"":"s"} ago`};function convertToTreeDataItem(item){return{...item,record:{...item.record,href:item.href,path:item.name}}}function Category(_ref){let{tabId,items,category,columnIndex,isFirstCategoryWithResults,isLoading}=_ref,groupRef=(0,react.useRef)(null),pendingFocusIndexRef=(0,react.useRef)(null),isFirstCategory=0===columnIndex,{filteredItemsGrid,search,newTabSceneDataGroupedItemsFullData,getSectionItemLimit,newTabSceneDataInclude,recents,recentsLoading}=(0,index_esm.useValues)((0,newTabSceneLogic.c)({tabId})),{showMoreInSection,logCreateNewItem,loadMoreRecents}=(0,index_esm.useActions)((0,newTabSceneLogic.c)({tabId})),{groupTypes}=(0,index_esm.useValues)(groupsModel.$),previousRecentsLoadingRef=(0,react.useRef)(recentsLoading);return(0,react.useEffect)(()=>{let wasLoading=previousRecentsLoadingRef.current;if(previousRecentsLoadingRef.current=recentsLoading,"recents"!==category){pendingFocusIndexRef.current=null;return}if(wasLoading&&!recentsLoading&&null!==pendingFocusIndexRef.current){let indexToFocus=pendingFocusIndexRef.current;pendingFocusIndexRef.current=null;let restoreFocus=()=>{groupRef.current?.resumeFocus(indexToFocus)||setTimeout(()=>{groupRef.current?.resumeFocus(indexToFocus)},50)};"function"==typeof requestAnimationFrame?requestAnimationFrame(restoreFocus):setTimeout(restoreFocus,0)}},[category,recentsLoading]),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"mb-0 @xl/main-content:flex @xl/main-content:flex-row @xl/main-content:gap-x-4",children:[(0,jsx_runtime.jsx)("div",{className:"mb-2 @xl/main-content:min-w-[200px]",children:(0,jsx_runtime.jsxs)("div",{className:"flex items-baseline gap-0 sticky top-0",children:[(0,jsx_runtime.jsx)(Label._,{intent:"menu",className:"px-2",children:getCategoryDisplayName(category)}),isLoading&&(0,jsx_runtime.jsx)(src.$j,{size:"small"}),!["persons","groups","eventDefinitions","propertyDefinitions"].includes(category)&&0===items.length&&!newTabSceneDataInclude.includes("all")&&(0,jsx_runtime.jsx)(src.oe,{className:"text-xs text-tertiary",size:"small",children:"No results found"})]})}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-col @xl/main-content:grow min-w-0 empty:hidden gap-1",children:[0===items.length?"recents"===category&&isLoading?(0,jsx_runtime.jsx)("div",{className:"flex flex-col gap-2 text-tertiary text-balance",children:(0,jsx_runtime.jsx)(WrappingLoadingSkeleton.x,{children:(0,jsx_runtime.jsx)(ButtonPrimitives.hL,{size:"sm",children:"Loading items..."})})}):null:(0,jsx_runtime.jsxs)(ListBox.w.Group,{ref:groupRef,groupId:`category-${category}`,children:[items.map((item,index)=>{var _ref2,_item$lastViewedAt,_item$icon;let isCreateNew="create-new"===item.category,focusFirst=isFirstCategoryWithResults&&0===index||filteredItemsGrid.length>0&&isFirstCategory&&0===index,lastViewedAt=null!==(_ref2=null!==(_item$lastViewedAt=item.lastViewedAt)&&void 0!==_item$lastViewedAt?_item$lastViewedAt:item.record?.last_viewed_at)&&void 0!==_ref2?_ref2:null,record=item.record,groupNoun="groups"===item.category?record?.groupNoun||item.name.split(":")[0]:null,groupDisplayName="groups"===item.category?"string"==typeof item.displayName?item.displayName:item.name.split(":").slice(1).join(":").trim():null,highlightText=text=>search?(0,jsx_runtime.jsx)(SearchHighlight.r,{string:text,substring:search}):text;return(0,jsx_runtime.jsxs)(ButtonPrimitives.HL,{className:"group w-full border-0",children:[(0,jsx_runtime.jsxs)(ContextMenu.xV,{children:[(0,jsx_runtime.jsx)(ContextMenu.W4,{asChild:!0,children:(0,jsx_runtime.jsx)(ListBox.w.Item,{asChild:!0,focusFirst:focusFirst,row:index,column:columnIndex,focusKey:item.id,index:index,children:(0,jsx_runtime.jsxs)(Link.r,{to:item.href||"#",className:"w-full",buttonProps:{size:"sm",hasSideActionRight:!0},onClick:e=>{e.preventDefault(),item.href&&(isCreateNew&&logCreateNewItem(item.href),lib.router.actions.push(item.href))},children:[(0,jsx_runtime.jsx)("span",{className:"text-sm",children:null!==(_item$icon=item.icon)&&void 0!==_item$icon?_item$icon:item.name[0]}),(0,jsx_runtime.jsxs)("span",{className:"flex min-w-0 items-center gap-2",children:[groupNoun?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("span",{className:"text-sm truncate text-primary",children:highlightText(groupDisplayName&&groupDisplayName.length>0?groupDisplayName:item.name)}),(0,jsx_runtime.jsx)(src.oe,{size:"small",type:"muted",className:"shrink-0",children:highlightText((0,utils.fm)(groupNoun.trim()))})]}):(0,jsx_runtime.jsx)("span",{className:"text-sm truncate text-primary",children:search?(0,jsx_runtime.jsx)(SearchHighlight.r,{string:item.name,substring:search}):item.displayName||item.name}),lastViewedAt?(0,jsx_runtime.jsx)("span",{className:"text-xs text-muted whitespace-nowrap",children:formatRelativeTimeShort(lastViewedAt)}):null]})]})})}),(0,jsx_runtime.jsx)(ContextMenu.h_,{loop:!0,className:"max-w-[250px]",children:(0,jsx_runtime.jsx)(ContextMenu.Xl,{children:(0,jsx_runtime.jsx)(MenuItems.s,{item:convertToTreeDataItem(item),type:"context",root:"project://",onlyTree:!1,showSelectMenuOption:!1})})})]}),(0,jsx_runtime.jsxs)(DropdownMenu.h_,{children:[(0,jsx_runtime.jsx)(DropdownMenu.$F,{asChild:!0,children:(0,jsx_runtime.jsx)(ButtonPrimitives.hL,{size:"xs",iconOnly:!0,isSideActionRight:!0,className:"opacity-0 group-hover:opacity-100 group-has-[button[data-state=open]]:opacity-100 mt-px",children:(0,jsx_runtime.jsx)(posthog_icons_es.IconEllipsis,{className:"size-3"})})}),(0,jsx_runtime.jsx)(DropdownMenu.AW,{loop:!0,align:"end",side:"bottom",className:"max-w-[250px]",children:(0,jsx_runtime.jsx)(DropdownMenu.Qk,{children:(0,jsx_runtime.jsx)(MenuItems.s,{item:convertToTreeDataItem(item),type:"dropdown",root:"project://",onlyTree:!1,showSelectMenuOption:!1})})})]})]},item.id)}),(()=>{let currentLimit=getSectionItemLimit(category),fullCount=newTabSceneDataGroupedItemsFullData[category]||0,isRecentsSection="recents"===category;return(isRecentsSection&&recents.hasMore||fullCount>currentLimit)&&(0,jsx_runtime.jsx)(ListBox.w.Item,{asChild:!0,focusKey:`show-all-${category}`,index:items.length,children:(0,jsx_runtime.jsxs)(ButtonPrimitives.hL,{size:"sm",disabled:isRecentsSection&&recentsLoading,onClick:()=>{let showAllIndex=items.length;isRecentsSection?(pendingFocusIndexRef.current=showAllIndex,loadMoreRecents()):(showMoreInSection(category),setTimeout(()=>{groupRef.current?.resumeFocus(showAllIndex)},0))},className:"w-full text-tertiary data-[focused=true]:text-primary",children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconArrowRight,{className:"rotate-90"}),isRecentsSection?" Load more...":` Show all (${fullCount-currentLimit} more)`]})})})()]}),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["persons"===category&&(0,jsx_runtime.jsx)(ListBox.w.Item,{asChild:!0,children:(0,jsx_runtime.jsxs)(Link.r,{to:urls.j.persons(),buttonProps:{size:"sm",className:"w-full text-tertiary data-[focused=true]:text-primary"},children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconExternal,{})," See all persons"]})}),"eventDefinitions"===category&&(0,jsx_runtime.jsx)(ListBox.w.Item,{asChild:!0,children:(0,jsx_runtime.jsxs)(Link.r,{to:urls.j.eventDefinitions(),buttonProps:{size:"sm",className:"w-full text-tertiary data-[focused=true]:text-primary"},children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconExternal,{})," See all events"]})}),"groups"===category&&groupTypes.size>0&&(0,jsx_runtime.jsx)(ListBox.w.Item,{asChild:!0,children:(0,jsx_runtime.jsxs)(Link.r,{to:urls.j.groups(Array.from(groupTypes.keys())[0]),buttonProps:{size:"sm",className:"w-full text-tertiary data-[focused=true]:text-primary"},children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconExternal,{})," See all groups"]})}),"propertyDefinitions"===category&&(0,jsx_runtime.jsx)(ListBox.w.Item,{asChild:!0,children:(0,jsx_runtime.jsxs)(Link.r,{to:urls.j.propertyDefinitions(),buttonProps:{size:"sm",className:"w-full text-tertiary data-[focused=true]:text-primary"},children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconExternal,{})," See all properties"]})})]})]})]},category),(0,jsx_runtime.jsx)("div",{className:"h-px w-full bg-border-primary"})]})}function Results(_ref3){let{tabId,listboxRef,handleAskAi}=_ref3,{search,isSearching,newTabSceneDataInclude,allCategories,firstCategoryWithResults}=(0,index_esm.useValues)((0,newTabSceneLogic.c)({tabId})),hasResults=allCategories.some(category=>category.items.length>0),shouldShowGlobalNoResults=newTabSceneDataInclude.includes("all")&&""!==search.trim()&&!hasResults&&!isSearching;return(0,react.useEffect)(()=>{!isSearching&&hasResults&&firstCategoryWithResults&&listboxRef.current?.focusFirstItem()},[isSearching,hasResults,firstCategoryWithResults,listboxRef]),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[allCategories.map((_ref4,columnIndex)=>{let{key:category,items,isLoading}=_ref4;return(0,jsx_runtime.jsx)(Category,{tabId:tabId,items:items,category:category,columnIndex:columnIndex,isFirstCategoryWithResults:category===firstCategoryWithResults,isLoading:isLoading},category)}),shouldShowGlobalNoResults&&(0,jsx_runtime.jsx)(NoResultsFound,{handleAskAi:handleAskAi})]})}var icons=__webpack_require__("../../frontend/src/lib/lemon-ui/icons/index.ts"),TextInputPrimitive=__webpack_require__("../../frontend/src/lib/ui/TextInputPrimitive/TextInputPrimitive.tsx"),css_classes=__webpack_require__("../../frontend/src/lib/utils/css-classes.ts"),KeyboardShortcut=__webpack_require__("../../frontend/src/layout/navigation-3000/components/KeyboardShortcut.tsx"),navigationLogic=__webpack_require__("../../frontend/src/layout/navigation-3000/navigationLogic.tsx");let SearchInput=(0,react.forwardRef)(function SearchInput(_ref,ref){let{commands,placeholder="Type / to see commands...",value="",onChange,onCommandSelect,selectedCommands=[],onSelectedCommandsChange,activeCommands=[],onClearAll}=_ref,[inputValue,setInputValue]=(0,react.useState)(value),[showDropdown,setShowDropdown]=(0,react.useState)(!1),[filteredCommands,setFilteredCommands]=(0,react.useState)(commands),inputRef=(0,react.useRef)(null),[focusedTagIndex,setFocusedTagIndex]=(0,react.useState)(null),[expandedTags,setExpandedTags]=(0,react.useState)(!1),[isFocused,setIsFocused]=(0,react.useState)(!1),{mobileLayout:isMobileLayout}=(0,index_esm.useValues)(navigationLogic.f);(0,react.useImperativeHandle)(ref,()=>({focus:()=>{inputRef.current&&inputRef.current.focus()},getInputRef:()=>inputRef}),[]),(0,react.useEffect)(()=>{setInputValue(value)},[value]),(0,react.useEffect)(()=>{setFilteredCommands(commands)},[commands]);let handleInputChange=newValue=>{if(setInputValue(newValue),onChange?.(newValue),null!==focusedTagIndex&&setFocusedTagIndex(null),expandedTags&&setExpandedTags(!1),"/"===newValue)setFilteredCommands(commands),setShowDropdown(!0);else if(showDropdown&&newValue.startsWith("/")&&newValue.length>1){let searchTerm=newValue.substring(1).toLowerCase();setFilteredCommands(commands.filter(cmd=>cmd.displayName.toLowerCase().includes(searchTerm)))}else showDropdown&&!newValue.startsWith("/")&&setShowDropdown(!1)},selectCommand=command=>{let newSelectedCommands=selectedCommands.some(cmd=>cmd.value===command.value)?selectedCommands.filter(cmd=>cmd.value!==command.value):[...selectedCommands,command];onSelectedCommandsChange?.(newSelectedCommands),onCommandSelect?.(command),inputValue.startsWith("/")&&(setInputValue(""),onChange?.("")),setExpandedTags(!1),setFocusedTagIndex(null),setShowDropdown(!1),setTimeout(()=>{inputRef.current&&inputRef.current.focus()},150)};return(0,jsx_runtime.jsx)("div",{className:"relative w-full",children:(0,jsx_runtime.jsxs)("div",{className:(0,css_classes.cn)((0,TextInputPrimitive.G)({variant:"default",size:"lg"}),"flex gap-1 focus-within:border-secondary items-center h-8 rounded-lg",isFocused&&"animate-input-focus-pulse"),children:[(0,jsx_runtime.jsxs)(DropdownMenu.h_,{open:showDropdown,onOpenChange:open=>{setShowDropdown(open)},children:[(0,jsx_runtime.jsxs)("div",{className:"relative",children:[(0,jsx_runtime.jsx)(DropdownMenu.$F,{asChild:!0,children:(0,jsx_runtime.jsx)(ButtonPrimitives.hL,{variant:"outline",className:`ml-[calc(var(--button-padding-x-sm)+1px)] font-mono text-tertiary hover:border-secondary data-[state=open]:border-secondary ${-1===focusedTagIndex?"ring-2 ring-accent":""}`,iconOnly:!0,size:"sm",tooltip:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Click to show commands/filters, or type ",(0,jsx_runtime.jsx)(KeyboardShortcut.e,{forwardslash:!0})]}),tooltipPlacement:"bottom",tooltipCloseDelayMs:0,tabIndex:-1,children:"/"})}),isMobileLayout&&(1===selectedCommands.length||expandedTags)&&(0,jsx_runtime.jsx)("div",{className:"absolute -top-0.5 -right-0.5 size-2 bg-accent rounded-full pointer-events-none"})]}),(0,jsx_runtime.jsx)(DropdownMenu.AW,{align:"start",className:"min-w-[200px]",onCloseAutoFocus:e=>{e.preventDefault(),setTimeout(()=>{inputRef.current&&inputRef.current.focus()},100)},children:(0,jsx_runtime.jsxs)(DropdownMenu.Qk,{children:[(0,jsx_runtime.jsx)(Label._,{intent:"menu",className:"px-2",children:"Filters"}),(0,jsx_runtime.jsx)(DropdownMenu.VD,{}),filteredCommands.map(command=>{let isActive=activeCommands.includes(command.value);return(0,jsx_runtime.jsx)(DropdownMenu.Xi,{asChild:!0,children:(0,jsx_runtime.jsxs)(ButtonPrimitives.hL,{className:"group flex items-center text-left",onClick:()=>selectCommand(command),fullWidth:!0,menuItem:!0,children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-center",children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconCheck,{className:(0,css_classes.cn)("hidden size-4 group-hover:block group-hover:opacity-10",{"opacity-10":!isActive,"block text-success group-hover:opacity-100":isActive})}),(0,jsx_runtime.jsx)(icons.R1,{className:(0,css_classes.cn)("hidden size-4 group-hover:hidden",{block:!isActive})})]}),(0,jsx_runtime.jsx)("div",{className:"font-medium text-primary",children:command.displayName})]})},command.value)})]})})]}),0===selectedCommands.length||isMobileLayout?null:1===selectedCommands.length||expandedTags?selectedCommands.map((command,index)=>(0,jsx_runtime.jsxs)(ButtonPrimitives.hL,{className:`text-primary ${focusedTagIndex===index?"ring-2 ring-accent":""}`,size:"sm",variant:"outline",onClick:e=>{e.preventDefault(),e.stopPropagation(),selectCommand(command),setShowDropdown(!1),setExpandedTags(!1),setFocusedTagIndex(null)},tabIndex:-1,children:[command.displayName,(0,jsx_runtime.jsx)(posthog_icons_es.IconX,{className:"size-3 ml-1 text-tertiary"})]},command.value)):(0,jsx_runtime.jsxs)(ButtonPrimitives.hL,{className:"text-primary",size:"sm",variant:"outline",onClick:()=>setShowDropdown(!0),children:[selectedCommands.length," filters",(0,jsx_runtime.jsx)(posthog_icons_es.IconChevronRight,{className:"ml-1 rotate-90 text-tertiary"})]}),(0,jsx_runtime.jsx)(TextInputPrimitive.w,{id:"command-input",ref:inputRef,value:inputValue,onChange:e=>handleInputChange(e.target.value),onKeyDown:e=>{if(!e.metaKey&&!e.ctrlKey)switch(e.key){case"/":if(!showDropdown&&""===inputValue){e.preventDefault(),setFilteredCommands(commands),setShowDropdown(!0);return}break;case"Backspace":""===inputValue&&(e.preventDefault(),e.stopPropagation(),0===selectedCommands.length?setShowDropdown(!0):expandedTags?null!==focusedTagIndex&&(selectCommand(selectedCommands[focusedTagIndex]),setExpandedTags(!1),setFocusedTagIndex(null)):(setExpandedTags(!0),setFocusedTagIndex(selectedCommands.length-1)));break;case"ArrowLeft":let cursorPosition=inputRef.current?.selectionStart||0;""===inputValue?(e.preventDefault(),e.stopPropagation(),0===selectedCommands.length?setShowDropdown(!0):!expandedTags&&selectedCommands.length>0?(setExpandedTags(!0),setFocusedTagIndex(selectedCommands.length-1)):expandedTags&&null!==focusedTagIndex&&(focusedTagIndex>0?setFocusedTagIndex(focusedTagIndex-1):setFocusedTagIndex(-1))):""!==inputValue&&0===cursorPosition&&(e.preventDefault(),e.stopPropagation(),setExpandedTags(!0),setFocusedTagIndex(-1),setShowDropdown(!0));break;case"ArrowRight":""===inputValue&&expandedTags&&null!==focusedTagIndex&&(e.preventDefault(),e.stopPropagation(),-1===focusedTagIndex?setFocusedTagIndex(0):focusedTagIndex<selectedCommands.length-1?setFocusedTagIndex(focusedTagIndex+1):(setFocusedTagIndex(null),setExpandedTags(!1)));break;case"Enter":""===inputValue&&expandedTags&&null!==focusedTagIndex&&(e.preventDefault(),e.stopPropagation(),-1===focusedTagIndex?setShowDropdown(!0):(selectCommand(selectedCommands[focusedTagIndex]),setExpandedTags(!1),setFocusedTagIndex(null)));break;case"ArrowDown":""===inputValue&&expandedTags&&-1===focusedTagIndex&&(e.preventDefault(),e.stopPropagation(),setShowDropdown(!0));break;case"Escape":(showDropdown||expandedTags)&&(e.preventDefault(),e.stopPropagation(),setExpandedTags(!1),setFocusedTagIndex(null),setShowDropdown(!1))}},placeholder:placeholder,autoFocus:!0,autoComplete:"off",className:"pl-1 w-full border-none flex-1 h-full min-h-full rounded-r-lg",onFocus:()=>{setIsFocused(!0)},onBlur:()=>{setIsFocused(!1)},size:"lg",suffix:(""!==inputValue||selectedCommands.length>0)&&(0,jsx_runtime.jsx)(ListBox.w.Item,{asChild:!0,children:(0,jsx_runtime.jsx)(ButtonPrimitives.hL,{iconOnly:!0,onClick:()=>{setInputValue(""),onChange?.(""),setExpandedTags(!1),setFocusedTagIndex(null),setShowDropdown(!1),onClearAll?.(),inputRef.current?.focus()},"aria-label":"Clear input and filters",size:"sm",children:(0,jsx_runtime.jsx)(posthog_icons_es.IconX,{})})})})]})})}),scene={component:NewTabScene,logic:newTabSceneLogic.c};function NewTabScene(){let{tabId}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},commandInputRef=(0,react.useRef)(null),listboxRef=(0,react.useRef)(null),{search,newTabSceneDataInclude}=(0,index_esm.useValues)((0,newTabSceneLogic.c)({tabId})),{setSearch,toggleNewTabSceneDataInclude,refreshDataAfterToggle,setNewTabSearchInputRef}=(0,index_esm.useActions)((0,newTabSceneLogic.c)({tabId})),selectedCommands=newTabSceneDataInclude.filter(commandValue=>"all"!==commandValue).map(commandValue=>newTabSceneLogic.L.find(cmd=>cmd.value===commandValue)||{value:commandValue,displayName:commandValue});return(0,react.useEffect)(()=>{setNewTabSearchInputRef(commandInputRef)},[setNewTabSearchInputRef]),(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)(ListBox.w,{ref:listboxRef,className:"w-full grid grid-rows-[auto_1fr] flex-col h-[calc(100vh-var(--scene-layout-header-height))]",virtualFocus:!0,autoSelectFirst:!0,children:[(0,jsx_runtime.jsx)("div",{className:"sr-only",children:(0,jsx_runtime.jsx)("p",{children:"Welcome to the new tab, type / to see commands... or type a search term, you can navigate all interactive elements with the keyboard"})}),(0,jsx_runtime.jsx)("div",{className:"flex flex-col gap-2 border-b",children:(0,jsx_runtime.jsx)("div",{className:"px-2 @lg/main-content:px-8 pt-2 @lg/main-content:py-4 mx-auto w-full max-w-[1200px]",children:(0,jsx_runtime.jsx)(SearchInput,{ref:commandInputRef,commands:newTabSceneLogic.L,value:search,onChange:value=>{"/"!==value&&setSearch(value)},placeholder:"Search or ask an AI question",activeCommands:newTabSceneDataInclude,selectedCommands:selectedCommands,onCommandSelect:command=>{"all"===command.value?newTabSceneDataInclude.includes("all")?newTabSceneDataInclude.forEach(selectedCommand=>{toggleNewTabSceneDataInclude(selectedCommand)}):toggleNewTabSceneDataInclude("all"):toggleNewTabSceneDataInclude(command.value),refreshDataAfterToggle()},onClearAll:()=>{newTabSceneDataInclude.forEach(command=>{toggleNewTabSceneDataInclude(command)}),refreshDataAfterToggle()}})})}),(0,jsx_runtime.jsx)(ScrollableShadows.D,{direction:"vertical",className:"flex flex-col gap-4 overflow-auto h-full",innerClassName:"pt-4",styledScrollbars:!0,children:(0,jsx_runtime.jsx)("div",{className:"flex flex-col flex-1 max-w-[1200px] mx-auto w-full gap-4 px-4 @lg/main-content:px-8 group/colorful-product-icons colorful-product-icons-true",children:(0,jsx_runtime.jsx)("div",{className:"flex flex-col gap-2 mb-32",children:(0,jsx_runtime.jsx)(Results,{tabId:tabId||"",listboxRef:listboxRef,handleAskAi:question=>{let nextQuestion=(null!=question?question:search).trim();lib.router.actions.push(urls.j.max(void 0,nextQuestion))}})})})})]})})}}}]);