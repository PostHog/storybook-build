(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"./frontend/src/lib/components/ChartFilter/chartFilterLogic.ts":function(Q,B,t){"use strict";t.d(B,"a",function(){return we});var Z=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=t.n(Z),pe=t("./node_modules/core-js/modules/es.array.includes.js"),re=t.n(pe),ce=t("./node_modules/core-js/modules/es.string.includes.js"),Ue=t.n(ce),_e=t("./node_modules/core-js/modules/es.object.values.js"),c=t.n(_e),ve=t("./node_modules/core-js/modules/es.array.iterator.js"),H=t.n(ve),i=t("./node_modules/core-js/modules/es.object.to-string.js"),D=t.n(i),q=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),T=t.n(q),e=t("./node_modules/core-js/modules/es.object.keys.js"),oe=t.n(e),he=t("./node_modules/core-js/modules/es.symbol.js"),Re=t.n(he),Oe=t("./node_modules/core-js/modules/es.array.filter.js"),je=t.n(Oe),Ce=t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Fe=t.n(Ce),ge=t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),de=t.n(ge),xe=t("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Pe=t.n(xe),K=t("./node_modules/kea/lib/index.esm.js"),G=t("./frontend/src/lib/utils.tsx"),O=t("./frontend/src/types.ts"),E=t("./frontend/src/scenes/insights/sharedUtils.ts"),$=t("./frontend/src/scenes/insights/insightLogic.ts");function J(Y,ee){var ae=Object.keys(Y);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(Y);ee&&(h=h.filter(function(ie){return Object.getOwnPropertyDescriptor(Y,ie).enumerable})),ae.push.apply(ae,h)}return ae}function ue(Y){for(var ee=1;ee<arguments.length;ee++){var ae=arguments[ee]!=null?arguments[ee]:{};ee%2?J(Object(ae),!0).forEach(function(h){k()(Y,h,ae[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Y,Object.getOwnPropertyDescriptors(ae)):J(Object(ae)).forEach(function(h){Object.defineProperty(Y,h,Object.getOwnPropertyDescriptor(ae,h))})}return Y}function Me(Y){return Object.values(O.B).includes(Y)}var we=Object(K.kea)({props:{},key:Object(E.l)("new"),path:function(ee){return["lib","components","ChartFilter","chartFilterLogic",ee]},connect:function(ee){return{actions:[Object($.c)(ee),["setFilters"]],values:[Object($.c)(ee),["filters"]]}},actions:function(){return{setChartFilter:function(ae){return{chartFilter:ae}}}},selectors:{chartFilter:[function(Y){return[Y.filters]},function(Y){return(Object(E.e)(Y)?Y.funnel_viz_type:Object(E.c)(Y)?Y.display:null)||null}]},listeners:function(ee){var ae=ee.actions,h=ee.values;return{setChartFilter:function(ze){var De=ze.chartFilter;if(Me(De)){var ut=Object(E.e)(h.filters)?h.filters.funnel_viz_type:null;if(ut!==De){var $e=ue(ue({},h.filters),{},{funnel_viz_type:De});ae.setFilters($e)}}else if((Object(E.j)(h.filters)||Object(E.i)(h.filters))&&!Object(G.pb)(h.filters.display,De)){var Ye=ue(ue({},h.filters),{},{display:De});ae.setFilters(Ye)}}}}})},"./frontend/src/lib/components/CompareFilter/compareFilterLogic.ts":function(Q,B,t){"use strict";t.d(B,"a",function(){return G});var Z=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=t.n(Z),pe=t("./node_modules/core-js/modules/es.array.iterator.js"),re=t.n(pe),ce=t("./node_modules/core-js/modules/es.object.to-string.js"),Ue=t.n(ce),_e=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),c=t.n(_e),ve=t("./node_modules/core-js/modules/es.object.keys.js"),H=t.n(ve),i=t("./node_modules/core-js/modules/es.symbol.js"),D=t.n(i),q=t("./node_modules/core-js/modules/es.array.filter.js"),T=t.n(q),e=t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),oe=t.n(e),he=t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Re=t.n(he),Oe=t("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),je=t.n(Oe),Ce=t("./node_modules/kea/lib/index.esm.js"),Fe=t("./frontend/src/lib/utils.tsx"),ge=t("./frontend/src/types.ts"),de=t("./frontend/src/scenes/insights/sharedUtils.ts"),xe=t("./frontend/src/scenes/insights/insightLogic.ts");function Pe(O,E){var $=Object.keys(O);if(Object.getOwnPropertySymbols){var J=Object.getOwnPropertySymbols(O);E&&(J=J.filter(function(ue){return Object.getOwnPropertyDescriptor(O,ue).enumerable})),$.push.apply($,J)}return $}function K(O){for(var E=1;E<arguments.length;E++){var $=arguments[E]!=null?arguments[E]:{};E%2?Pe(Object($),!0).forEach(function(J){k()(O,J,$[J])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors($)):Pe(Object($)).forEach(function(J){Object.defineProperty(O,J,Object.getOwnPropertyDescriptor($,J))})}return O}var G=Object(Ce.kea)({props:{},key:Object(de.l)("new"),path:function(E){return["lib","components","CompareFilter","compareFilterLogic",E]},connect:function(E){return{actions:[Object(xe.c)(E),["setFilters"]],values:[Object(xe.c)(E),["filters as inflightFilters","canEditInsight"]]}},actions:function(){return{setCompare:function($){return{compare:$}},toggleCompare:!0}},selectors:{filters:[function(O){return[O.inflightFilters]},function(O){return O&&(Object(de.j)(O)||Object(de.i)(O))?O:{}}],compare:[function(O){return[O.filters]},function(O){return O&&(Object(de.j)(O)||Object(de.i)(O))&&!!O.compare}],disabled:[function(O){return[O.filters,O.canEditInsight]},function(O,E){var $=O.insight,J=O.date_from,ue=O.display;return!E||$===ge.F.LIFECYCLE||ue===ge.k.WorldMap||J==="all"}]},listeners:function(E){var $=E.values,J=E.actions;return{setCompare:function(Me){var we=Me.compare;if(!Object(Fe.pb)(we,$.compare)){var Y=K(K({},$.filters),{},{compare:we});J.setFilters(Y)}},toggleCompare:function(){J.setCompare(!$.compare)}}}})},"./frontend/src/lib/components/InlineMessage/InlineMessage.tsx":function(Q,B,t){"use strict";t.d(B,"a",function(){return e});var Z=t("./node_modules/@babel/runtime/helpers/slicedToArray.js"),k=t.n(Z),pe=t("./node_modules/react/index.js"),re=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),ce=t.n(re),Ue=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/lib/components/InlineMessage/InlineMessage.scss"),_e=t.n(Ue),c={};c.insert="head",c.singleton=!1;var ve=ce()(_e.a,c),H=_e.a.locals||{},i=t("./node_modules/@ant-design/icons/es/icons/ExclamationCircleFilled.js"),D=t("./node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),q=t("./node_modules/clsx/dist/clsx.m.js"),T=t("./node_modules/react/jsx-runtime.js");function e(oe){var he=oe.children,Re=oe.style,Oe=oe.icon,je=Oe===void 0?Object(T.jsx)(i.a,{}):Oe,Ce=oe.type,Fe=Ce===void 0?"info":Ce,ge=oe.closable,de=oe.onClose,xe=Object(pe.useState)(!0),Pe=k()(xe,2),K=Pe[0],G=Pe[1],O=function(){G(!1),de==null||de()};return Object(T.jsxs)("div",{className:Object(q.a)("inline-message",Fe,ge&&"closable",!K&&"hidden"),style:Re,children:[Object(T.jsx)("div",{className:"inline-icon",children:je}),Object(T.jsx)("div",{className:"inline-main",children:he}),ge&&Object(T.jsx)("div",{className:"closable",onClick:O,children:Object(T.jsx)(D.a,{})})]})}try{e.displayName="InlineMessage",e.__docgenInfo={description:"",displayName:"InlineMessage",props:{style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},icon:{defaultValue:{value:"<ExclamationCircleFilled />"},description:"",name:"icon",required:!1,type:{name:"Element"}},type:{defaultValue:{value:"info"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"danger"'},{value:'"info"'},{value:'"warning"'}]}},closable:{defaultValue:null,description:"",name:"closable",required:!1,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"(() => void)"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/InlineMessage/InlineMessage.tsx#InlineMessage"]={docgenInfo:e.__docgenInfo,name:"InlineMessage",path:"frontend/src/lib/components/InlineMessage/InlineMessage.tsx#InlineMessage"})}catch(oe){}},"./frontend/src/scenes/insights/InsightContainer.tsx":function(Q,B,t){"use strict";t.d(B,"a",function(){return it});var Z=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=t.n(Z),pe=t("./node_modules/antd/es/card/index.js"),re=t("./node_modules/antd/es/row/index.js"),ce=t("./node_modules/antd/es/col/index.js"),Ue=t("./node_modules/core-js/modules/es.array.includes.js"),_e=t("./node_modules/core-js/modules/es.string.includes.js"),c=t("./node_modules/kea/lib/index.esm.js"),ve=t("./frontend/src/lib/components/ChartFilter/chartFilterLogic.ts"),H=t("./frontend/src/lib/components/icons.tsx"),i=t("./frontend/src/types.ts"),D=t("./frontend/src/scenes/insights/insightLogic.ts"),q=t("./frontend/@posthog/lemon-ui/src/index.ts"),T=t("./frontend/src/scenes/insights/sharedUtils.ts"),e=t("./node_modules/react/jsx-runtime.js");function oe(s){var n=s.filters,o=s.onChange,r=s.disabled,d=Object(c.useValues)(D.c),a=d.insightProps,l=d.isSingleSeries,j=Object(c.useValues)(Object(ve.a)(a)),m=j.chartFilter,f=Object(c.useActions)(Object(ve.a)(a)),b=f.setChartFilter,p=Object(T.j)(n),u=p?void 0:"This type isn't available for this insight type.",x=l?void 0:"This type isn't available, because there are multiple trend series.",y=[{title:"Time Series",options:[{value:i.k.ActionsLineGraph,icon:Object(e.jsx)(H.IconShowChart,{}),label:"Line"},{value:i.k.ActionsBar,icon:Object(e.jsx)(H.IconBarChart,{}),label:"Bar"},{value:i.k.ActionsAreaGraph,icon:Object(e.jsx)(H.IconAreaChart,{}),label:"Area"}]},{title:"Cumulative Time Series",options:[{value:i.k.ActionsLineGraphCumulative,icon:Object(e.jsx)(H.IconCumulativeChart,{}),label:"Line",disabledReason:u}]},{title:"Total Value",options:[{value:i.k.BoldNumber,icon:Object(e.jsx)(H.Icon123,{}),label:"Number",disabledReason:u||x},{value:i.k.ActionsPie,icon:Object(e.jsx)(H.IconPieChart,{}),label:"Pie",disabledReason:u},{value:i.k.ActionsBarValue,icon:Object(e.jsx)(H.IconBarChart,{className:"rotate-90"}),label:"Bar",disabledReason:u},{value:i.k.ActionsTable,icon:Object(e.jsx)(H.IconTableChart,{}),label:"Table"},{value:i.k.WorldMap,icon:Object(e.jsx)(H.IconPublic,{}),label:"World Map",tooltip:"Visualize data by country.",disabledReason:u||x||(p&&n.formula?"This type isn't available, because it doesn't support formulas.":!!n.breakdown&&n.breakdown!=="$geoip_country_code"&&n.breakdown!=="$geoip_country_name"?"This type isn't available, because there's a breakdown other than by Country Code or Country Name properties.":void 0)}]}];return Object(e.jsx)(q.LemonSelect,{value:m||i.k.ActionsLineGraph,onChange:function(_){b(_),o==null||o(_)},dropdownPlacement:"bottom-end",optionTooltipPlacement:"left",dropdownMatchSelectWidth:!1,"data-attr":"chart-filter",disabled:r,options:y,size:"small"},"2")}try{oe.displayName="ChartFilter",oe.__docgenInfo={description:"",displayName:"ChartFilter",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((chartFilter: ChartDisplayType | FunnelVizType) => void)"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/ChartFilter/ChartFilter.tsx#ChartFilter"]={docgenInfo:oe.__docgenInfo,name:"ChartFilter",path:"frontend/src/lib/components/ChartFilter/ChartFilter.tsx#ChartFilter"})}catch(s){}var he=t("./frontend/src/lib/components/CompareFilter/compareFilterLogic.ts");function Re(){var s=Object(c.useValues)(D.c),n=s.insightProps,o=Object(c.useValues)(Object(he.a)(n)),r=o.compare,d=o.disabled,a=Object(c.useActions)(Object(he.a)(n)),l=a.setCompare;return d?null:Object(e.jsx)(q.LemonCheckbox,{onChange:l,checked:r,disabled:d,label:Object(e.jsx)("span",{className:"font-normal",children:"Compare to previous time period"}),bordered:!0,size:"small"})}var Oe=t("./node_modules/@babel/runtime/helpers/slicedToArray.js"),je=t.n(Oe),Ce=t("./node_modules/core-js/modules/es.array.map.js"),Fe=t("./node_modules/core-js/modules/es.object.entries.js"),ge=t("./node_modules/core-js/modules/es.array.iterator.js"),de=t("./node_modules/core-js/modules/es.object.to-string.js"),xe=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Pe=t("./node_modules/core-js/modules/es.object.keys.js"),K=t("./node_modules/core-js/modules/es.symbol.js"),G=t("./node_modules/core-js/modules/es.array.filter.js"),O=t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),E=t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),$=t("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),J=t("./node_modules/core-js/modules/es.array.slice.js"),ue=t("./node_modules/core-js/modules/es.function.name.js"),Me=t("./node_modules/core-js/modules/es.array.from.js"),we=t("./node_modules/core-js/modules/es.string.iterator.js"),Y=t("./node_modules/core-js/modules/es.regexp.exec.js"),ee=t("./node_modules/core-js/modules/es.symbol.description.js"),ae=t("./node_modules/core-js/modules/es.symbol.iterator.js"),h=t("./frontend/src/lib/utils.tsx"),ie=t("./frontend/src/lib/dayjs.ts"),ze=t("./frontend/src/lib/logic/featureFlagLogic.ts");function De(s,n){var o=typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(!o){if(Array.isArray(s)||(o=ut(s))||n&&s&&typeof s.length=="number"){o&&(s=o);var r=0,d=function(){};return{s:d,n:function(){return r>=s.length?{done:!0}:{done:!1,value:s[r++]}},e:function(f){throw f},f:d}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,l=!1,j;return{s:function(){o=o.call(s)},n:function(){var f=o.next();return a=f.done,f},e:function(f){l=!0,j=f},f:function(){try{!a&&o.return!=null&&o.return()}finally{if(l)throw j}}}}function ut(s,n){if(!!s){if(typeof s=="string")return $e(s,n);var o=Object.prototype.toString.call(s).slice(8,-1);if(o==="Object"&&s.constructor&&(o=s.constructor.name),o==="Map"||o==="Set")return Array.from(s);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return $e(s,n)}}function $e(s,n){(n==null||n>s.length)&&(n=s.length);for(var o=0,r=new Array(n);o<n;o++)r[o]=s[o];return r}function Ye(s,n){var o=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);n&&(r=r.filter(function(d){return Object.getOwnPropertyDescriptor(s,d).enumerable})),o.push.apply(o,r)}return o}function Pt(s){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?Ye(Object(o),!0).forEach(function(r){k()(s,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(o)):Ye(Object(o)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(o,r))})}return s}var Et=Object(c.kea)({props:{},key:Object(T.l)("new"),path:function(n){return["lib","components","IntervalFilter","intervalFilterLogic",n]},connect:function(n){return{actions:[Object(D.c)(n),["setFilters"]],values:[Object(D.c)(n),["filters"],ze.a,["featureFlags"]]}},actions:function(){return{setInterval:function(o){return{interval:o}}}},listeners:function(n){var o=n.values,r=n.actions,d=n.selectors;return{setInterval:function(l){var j=l.interval;Object(h.pb)(j,o.filters.interval)||r.setFilters(Pt(Pt({},o.filters),{},{interval:j}))},setFilters:function(l,j,m,f){var b=l.filters,p=b.date_from,u=b.date_to,x=d.filters(f);if(!(!p||Object(h.pb)(p,x.date_from)&&Object(h.pb)(u,x.date_to))){if(p&&u&&Object(ie.a)(b.date_from).isValid()&&Object(ie.a)(b.date_to).isValid()){Object(ie.a)(u).diff(Object(ie.a)(p),"day")<=3?r.setInterval("hour"):Object(ie.a)(u).diff(Object(ie.a)(p),"month")<=3?r.setInterval("day"):r.setInterval("month");return}var y="day",P=De(h.u),_;try{for(P.s();!(_=P.n()).done;){var R=_.value,U=R.key,z=R.values,A=R.defaultInterval;if(z[0]===p&&z[1]===(u||void 0)&&U!=="Custom"&&A){y=A;break}}}catch(v){P.e(v)}finally{P.f()}r.setInterval(y)}}}},selectors:{interval:[function(s){return[s.filters]},function(s){return s==null?void 0:s.interval}]}}),sn={hour:{label:"Hour",newDateFrom:"dStart"},day:{label:"Day",newDateFrom:void 0},week:{label:"Week",newDateFrom:"-30d"},month:{label:"Month",newDateFrom:"-90d"}};function He(s){var n=s.disabled,o=Object(c.useValues)(D.c),r=o.insightProps,d=Object(c.useValues)(Et(r)),a=d.interval,l=Object(c.useActions)(Et(r)),j=l.setInterval;return Object(e.jsx)(q.LemonSelect,{size:"small",disabled:n,value:a||void 0,dropdownMatchSelectWidth:!1,onChange:function(f){f&&j(String(f))},"data-attr":"interval-filter",options:Object.entries(sn).map(function(m){var f=je()(m,2),b=f[0],p=f[1].label;return{value:b,label:p}})})}try{He.displayName="IntervalFilter",He.__docgenInfo={description:"",displayName:"IntervalFilter",props:{view:{defaultValue:null,description:"",name:"view",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/IntervalFilter/IntervalFilter.tsx#IntervalFilter"]={docgenInfo:He.__docgenInfo,name:"IntervalFilter",path:"frontend/src/lib/components/IntervalFilter/IntervalFilter.tsx#IntervalFilter"})}catch(s){}var me=t("./node_modules/antd/es/select/index.js"),rn=t("./node_modules/@ant-design/icons/es/icons/FundOutlined.js"),on=t("./frontend/src/lib/components/SmoothingFilter/smoothings.ts"),Ne=t("./frontend/src/scenes/trends/trendsLogic.ts");function St(s,n){var o=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);n&&(r=r.filter(function(d){return Object.getOwnPropertyDescriptor(s,d).enumerable})),o.push.apply(o,r)}return o}function Ft(s){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?St(Object(o),!0).forEach(function(r){k()(s,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(o)):St(Object(o)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(o,r))})}return s}function an(){var s=Object(c.useValues)(D.c),n=s.insightProps,o=Object(c.useValues)(Object(Ne.a)(n)),r=o.filters,d=Object(c.useActions)(Object(Ne.a)(n)),a=d.setFilters;if(!r.interval||!Object(T.j)(r))return null;var l=r.interval,j=r.smoothing_intervals,m=on.a[l].map(function(f){var b=f.value,p=f.label;return{value:b,label:b===j?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(rn.a,{})," ",p]}):p}});return m.length?Object(e.jsx)(me.a,{bordered:!0,value:j||1,dropdownMatchSelectWidth:!1,onChange:function(b){a(Ft(Ft({},r),{},{smoothing_intervals:b}))},"data-attr":"smoothing-filter",options:m},l):Object(e.jsx)(e.Fragment,{})}var Te=t("./frontend/src/lib/constants.tsx"),ln=t("./node_modules/@ant-design/icons/es/icons/CalendarOutlined.js"),Ee=t("./node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),Tt=t("./frontend/src/scenes/insights/filters/InsightDateFilter/insightDateFilterLogic.ts"),cn=t("./frontend/src/lib/components/DateFilter/DateFilter.tsx");function It(s,n){var o=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);n&&(r=r.filter(function(d){return Object.getOwnPropertyDescriptor(s,d).enumerable})),o.push.apply(o,r)}return o}function At(s){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?It(Object(o),!0).forEach(function(r){k()(s,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(o)):It(Object(o)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(o,r))})}return s}function Ge(s){var n,o=Object(c.useValues)(D.c),r=o.insightProps,d=Object(c.useValues)(Object(Tt.a)(r)),a=d.dates,l=a.dateFrom,j=a.dateTo,m=Object(c.useActions)(Object(Tt.a)(r)),f=m.setDates;return Object(e.jsx)(cn.a,At(At({},s),{},{dateFrom:(n=l!=null?l:"-7d")!==null&&n!==void 0?n:void 0,dateTo:j!=null?j:void 0,onChange:function(p,u){var x;f(p,u),(x=s.onChange)===null||x===void 0||x.call(s,p,u)}}))}try{Ge.displayName="InsightDateFilter",Ge.__docgenInfo={description:"",displayName:"InsightDateFilter",props:{showCustom:{defaultValue:null,description:"",name:"showCustom",required:!1,type:{name:"boolean"}},showRollingRangePicker:{defaultValue:null,description:"",name:"showRollingRangePicker",required:!1,type:{name:"boolean"}},makeLabel:{defaultValue:null,description:"",name:"makeLabel",required:!1,type:{name:"((key: ReactNode) => ReactNode)"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((fromDate: string | null, toDate: string | null) => void)"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},getPopupContainer:{defaultValue:null,description:"",name:"getPopupContainer",required:!1,type:{name:"(() => HTMLElement)"}},dateOptions:{defaultValue:null,description:"",name:"dateOptions",required:!1,type:{name:"DateMappingOption[]"}},isDateFormatted:{defaultValue:null,description:"",name:"isDateFormatted",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/filters/InsightDateFilter/InsightDateFilter.tsx#InsightDateFilter"]={docgenInfo:Ge.__docgenInfo,name:"InsightDateFilter",path:"frontend/src/scenes/insights/filters/InsightDateFilter/InsightDateFilter.tsx#InsightDateFilter"})}catch(s){}var Je=t("./frontend/src/scenes/retention/retentionTableLogic.ts"),te=t("./frontend/src/lib/components/Tooltip.tsx"),dn=t("./frontend/src/lib/components/DatePicker.tsx");function Xe(s){var n=s.disabled,o=Object(c.useValues)(D.c),r=o.insightProps,d=Object(c.useValues)(Object(Je.e)(r)),a=d.filters,l=Object(c.useActions)(Object(Je.e)(r)),j=l.setFilters,m=a.date_to&&Object(ie.a)(a.date_to).year()!==Object(ie.a)().year()?", YYYY":"";return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(te.a,{title:"Cohorts up to this end date",children:Object(e.jsx)("span",{style:{maxWidth:100},className:"flex inline-flex items-center pl-2",children:Object(e.jsx)(dn.a,{showTime:a.period==="Hour",use12Hours:!0,format:a.period==="Hour"?"MMM D".concat(m,", h a"):"MMM D".concat(m),value:a.date_to?Object(ie.a)(a.date_to):void 0,onChange:function(b){return j({date_to:b&&Object(ie.a)(b).toISOString()})},allowClear:!0,placeholder:"Today",className:"retention-date-picker",disabled:n})})})})}try{Xe.displayName="RetentionDatePicker",Xe.__docgenInfo={description:"",displayName:"RetentionDatePicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/RetentionDatePicker.tsx#RetentionDatePicker"]={docgenInfo:Xe.__docgenInfo,name:"RetentionDatePicker",path:"frontend/src/scenes/insights/RetentionDatePicker.tsx#RetentionDatePicker"})}catch(s){}var ne=t("./frontend/src/scenes/funnels/funnelLogic.ts");function Qe(s){var n=s.disabled,o=Object(c.useValues)(D.c),r=o.insightProps,d=Object(c.useValues)(Object(ne.a)(r)),a=d.barGraphLayout,l=Object(c.useActions)(Object(ne.a)(r)),j=l.setFilters,m=[{title:"Graph Display Options",options:[{value:Te.k.vertical,icon:Object(e.jsx)(H.IconFunnelVertical,{}),label:"Left to right"},{value:Te.k.horizontal,icon:Object(e.jsx)(H.IconFunnelHorizontal,{}),label:"Top to bottom"}]}];return Object(e.jsx)(q.LemonSelect,{value:a||Te.k.vertical,onChange:function(b){return b&&j({layout:b})},dropdownMatchSelectWidth:!1,"data-attr":"funnel-bar-layout-selector",disabled:n,options:m,size:"small"})}try{Qe.displayName="FunnelDisplayLayoutPicker",Qe.__docgenInfo={description:"",displayName:"FunnelDisplayLayoutPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/views/Funnels/FunnelDisplayLayoutPicker.tsx#FunnelDisplayLayoutPicker"]={docgenInfo:Qe.__docgenInfo,name:"FunnelDisplayLayoutPicker",path:"frontend/src/scenes/insights/views/Funnels/FunnelDisplayLayoutPicker.tsx#FunnelDisplayLayoutPicker"})}catch(s){}var un=t("./node_modules/@ant-design/icons/es/icons/BarsOutlined.js"),jt=t("./frontend/src/scenes/paths/pathsLogic.ts"),jn=t("./frontend/src/scenes/userLogic.ts");function Ze(s){var n,o=s.disabled,r=Object(c.useValues)(D.c),d=r.insightProps,a=Object(c.useValues)(Object(jt.b)(d)),l=a.filter,j=Object(c.useActions)(Object(jt.b)(d)),m=j.setFilter,f=Object(c.useValues)(jn.a),b=f.user,p=2,u=b!=null&&(n=b.organization)!==null&&n!==void 0&&n.available_features.includes(i.e.PATHS_ADVANCED)?20:5,x=Array.from(Array.from(Array.from(Array(u+1).keys()).slice(p)),function(y){return{label:"".concat(y," Steps"),value:y}});return Object(e.jsx)(me.a,{id:"path-step-filter","data-attr":"path-step-filter",defaultValue:5,value:l.step_limit||jt.a,onSelect:function(P){return m({step_limit:P})},listHeight:440,bordered:!1,dropdownMatchSelectWidth:!0,dropdownAlign:h.a.bottomRight,optionLabelProp:"label",disabled:o,children:x.map(function(y){return Object(e.jsx)(me.a.Option,{value:y.value,label:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(un.a,{})," ",y.label]}),children:y.label},y.value)})})}try{Ze.displayName="PathStepPicker",Ze.__docgenInfo={description:"",displayName:"PathStepPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/views/Paths/PathStepPicker.tsx#PathStepPicker"]={docgenInfo:Ze.__docgenInfo,name:"PathStepPicker",path:"frontend/src/scenes/insights/views/Paths/PathStepPicker.tsx#PathStepPicker"})}catch(s){}var Lt=t("./node_modules/@ant-design/icons/es/icons/PercentageOutlined.js");function qe(s){var n=s.disabled,o=Object(c.useValues)(D.c),r=o.insightProps,d=Object(c.useValues)(Object(Je.e)(r)),a=d.retentionReference,l=Object(c.useActions)(Object(Je.e)(r)),j=l.setRetentionReference;return Object(e.jsx)(me.a,{value:a,onChange:j,bordered:!1,dropdownMatchSelectWidth:!1,"data-attr":"reference-selector",optionLabelProp:"label",disabled:n,children:[{value:"total",icon:Object(e.jsx)(Lt.a,{}),label:"Overall cohort"},{value:"previous",icon:Object(e.jsx)(Lt.a,{}),label:"Relative to previous period"}].map(function(m){return Object(e.jsx)(me.a.Option,{value:m.value,label:Object(e.jsxs)(e.Fragment,{children:[m.icon," ",m.label]}),children:m.label},m.value)})})}try{qe.displayName="ReferencePicker",qe.__docgenInfo={description:"",displayName:"ReferencePicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/filters/ReferencePicker.tsx#ReferencePicker"]={docgenInfo:qe.__docgenInfo,name:"ReferencePicker",path:"frontend/src/scenes/insights/filters/ReferencePicker.tsx#ReferencePicker"})}catch(s){}var Dt=t("./node_modules/antd/es/tooltip/index.js"),fn=t("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),Se=t.n(fn),xs=t("./node_modules/core-js/modules/es.set.js"),ys=t("./node_modules/core-js/modules/es.array.concat.js"),bn=t("./node_modules/antd/es/input-number/index.js"),mn=t("./node_modules/@ant-design/icons/es/icons/BarChartOutlined.js"),ft=t("./node_modules/clsx/dist/clsx.m.js"),pn=1,Rt=90,vn=new Set([5,15,25,50,90]),hn=[{label:"Auto bins",value:Te.b,display:!0}].concat(Se()(Array.from(Array.from(Array(Rt+1).keys()),function(s){return{label:"".concat(s," bins"),value:s,display:vn.has(s)}})),[{label:"Custom",value:"custom",display:!0}]);function et(s){var n=s.disabled,o=Object(c.useValues)(D.c),r=o.insightProps,d=Object(c.useValues)(Object(ne.a)(r)),a=d.filters,l=d.numericBinCount,j=Object(c.useActions)(Object(ne.a)(r)),m=j.setBinCount;return Object(e.jsx)(me.a,{id:"funnel-bin-filter",dropdownClassName:"funnel-bin-filter-dropdown","data-attr":"funnel-bin-filter",defaultValue:Te.b,value:a.bin_count||Te.b,onSelect:function(b){return m(b)},dropdownRender:function(b){return Object(e.jsxs)(e.Fragment,{children:[b,Object(e.jsxs)("div",{children:[Object(e.jsx)(bn.a,{className:"funnel-bins-custom-picker",size:"middle",min:pn,max:Rt,value:l,onChange:function(u){var x=typeof u=="string"?parseInt(u):u;x&&m(x)}})," ","bins"]})]})},listHeight:440,bordered:!1,dropdownMatchSelectWidth:!1,dropdownAlign:h.a.bottomRight,optionLabelProp:"label",disabled:n,children:Object(e.jsx)(me.a.OptGroup,{label:"Bin Count",children:hn.map(function(f){return f.value==="custom"?null:Object(e.jsx)(me.a.Option,{className:Object(ft.a)({hidden:!f.display}),value:f.value,label:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(mn.a,{})," ",f.label]}),children:f.label},f.value)})})})}try{et.displayName="FunnelBinsPicker",et.__docgenInfo={description:"",displayName:"FunnelBinsPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/views/Funnels/FunnelBinsPicker.tsx#FunnelBinsPicker"]={docgenInfo:et.__docgenInfo,name:"FunnelBinsPicker",path:"frontend/src/scenes/insights/views/Funnels/FunnelBinsPicker.tsx#FunnelBinsPicker"})}catch(s){}var bt=t("./frontend/src/scenes/insights/aggregationAxisFormat.ts"),fe=t("./frontend/src/lib/components/LemonButton/index.ts"),On=t("./frontend/src/lib/components/LemonDivider/index.ts"),le=t("./node_modules/react/index.js"),Mt=t.n(le),gn=t("./frontend/src/lib/hooks/useKeyboardHotkeys.tsx"),mt=t("./frontend/src/lib/utils/eventUsageLogic.ts"),xn=t("./frontend/src/lib/components/LemonModal/index.ts"),yn=t("./frontend/src/lib/forms/Field.tsx"),_n=t("./frontend/src/lib/components/LemonInput/LemonInput.tsx");function Nt(s,n){return s==="prefix"?n.aggregation_axis_prefix||"":s==="postfix"&&n.aggregation_axis_postfix||""}function tt(s){var n=s.isOpen,o=s.onSave,r=s.formativeElement,d=s.filters,a=s.onClose,l=s.overlayRef,j=Object(le.useState)(Nt(r,d)),m=je()(j,2),f=m[0],b=m[1];return Object(le.useEffect)(function(){b(Nt(r,d))},[r]),r===null?null:Object(e.jsx)(xn.a,{overlayRef:l,isOpen:n,onClose:a,forceAbovePopups:!0,title:"Custom ".concat(r),footer:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(fe.a,{type:"secondary","data-attr":"custom-prefix-cancel",onClick:a,children:"Cancel"}),Object(e.jsx)(fe.a,{type:"primary",onClick:function(){return o(k()({},r,f))},children:"Apply"})]}),children:Object(e.jsx)(yn.b,{label:"".concat(Object(h.i)(r),":"),help:Object(e.jsxs)(e.Fragment,{children:["With a ",r,' of "',Object(e.jsx)("strong",{children:f||"$"}),'", 123.45 will be displayed as "',Object(e.jsxs)("strong",{children:[r==="prefix"?f||"$":"","123.45",r==="postfix"?f||"$":""]}),'"']}),children:Object(e.jsx)(_n.a,{value:f,onChange:b,autoFocus:!0})})})}try{tt.displayName="CustomUnitModal",tt.__docgenInfo={description:"",displayName:"CustomUnitModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!0,type:{name:"(hx: HandleUnitChange) => void"}},formativeElement:{defaultValue:null,description:"",name:"formativeElement",required:!0,type:{name:'"prefix" | "postfix" | null'}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"Partial<FilterType>"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},overlayRef:{defaultValue:null,description:"",name:"overlayRef",required:!0,type:{name:"(instance: HTMLDivElement | null) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/UnitPicker/CustomUnitModal.tsx#CustomUnitModal"]={docgenInfo:tt.__docgenInfo,name:"CustomUnitModal",path:"frontend/src/lib/components/UnitPicker/CustomUnitModal.tsx#CustomUnitModal"})}catch(s){}function Vt(s,n){var o=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);n&&(r=r.filter(function(d){return Object.getOwnPropertyDescriptor(s,d).enumerable})),o.push.apply(o,r)}return o}function Bt(s){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?Vt(Object(o),!0).forEach(function(r){k()(s,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(o)):Vt(Object(o)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(o,r))})}return s}var Cn=bt.a.reduce(function(s,n){return s[n.value]=n.label,s},{});function nt(s){var n=s.filters,o=s.setFilters,r=Object(c.useActions)(mt.e),d=r.reportAxisUnitsChanged,a=Object(le.useState)(!1),l=je()(a,2),j=l[0],m=l[1],f=Object(le.useState)(n.aggregation_axis_format||void 0),b=je()(f,2),p=b[0],u=b[1],x=Object(le.useState)(null),y=je()(x,2),P=y[0],_=y[1],R=Object(le.useRef)(null);Object(gn.a)({escape:{action:function(){_(null),m(!1)}}},[]);var U=function(v){var g=v.format,I=v.prefix,V=v.postfix;u(g),o(Bt(Bt({},n),{},{aggregation_axis_format:g,aggregation_axis_prefix:I,aggregation_axis_postfix:V})),d({format:g,prefix:I,postfix:V,display:n.display,unitIsSet:!!I||!!V||g&&g!=="numeric"}),m(!1),_(null)},z=Object(le.useMemo)(function(){var A,v,g="None";return p&&(g=Cn[p]),(A=n.aggregation_axis_prefix)!==null&&A!==void 0&&A.length&&(g="Prefix: ".concat(n.aggregation_axis_prefix)),(v=n.aggregation_axis_postfix)!==null&&v!==void 0&&v.length&&(g="Postfix: ".concat(n.aggregation_axis_postfix)),g},[p,n]);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("span",{children:Object(bt.b)(n.display)}),Object(e.jsx)(tt,{formativeElement:P,isOpen:P!==null,onSave:U,filters:n,onClose:function(){return _(null)},overlayRef:function(v){return R.current=v}}),Object(e.jsx)(fe.b,{onClick:function(){return m(!j)},size:"small",type:"secondary",status:"stealth","data-attr":"chart-aggregation-axis-format",popup:{onClickOutside:function(){return m(!1)},additionalRefs:[R],visible:j,overlay:Object(e.jsxs)(e.Fragment,{children:[bt.a.map(function(A,v){var g=A.value,I=A.label;return Object(e.jsx)(fe.a,{onClick:function(){return U({format:g})},status:"stealth",active:g===p,fullWidth:!0,children:I},v)}),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(On.a,{}),Object(e.jsxs)(fe.a,{onClick:function(){return _("prefix")},status:"stealth",active:!!n.aggregation_axis_prefix,fullWidth:!0,children:["Custom prefix",n.aggregation_axis_prefix?": ".concat(n.aggregation_axis_prefix,"..."):"..."]}),Object(e.jsxs)(fe.a,{onClick:function(){return _("postfix")},status:"stealth",active:!!n.aggregation_axis_postfix,fullWidth:!0,children:["Custom postfix",n.aggregation_axis_postfix?": ".concat(n.aggregation_axis_postfix,"..."):"..."]})]})]}),placement:"bottom-start",actionable:!0,closeOnClickInside:!1},children:z})]})}try{nt.displayName="UnitPicker",nt.__docgenInfo={description:"",displayName:"UnitPicker",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"TrendsFilterType"}},setFilters:{defaultValue:null,description:"",name:"setFilters",required:!0,type:{name:"(filters: Partial<TrendsFilterType>, insightMode?: ItemMode | undefined) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/UnitPicker/UnitPicker.tsx#UnitPicker"]={docgenInfo:nt.__docgenInfo,name:"UnitPicker",path:"frontend/src/lib/components/UnitPicker/UnitPicker.tsx#UnitPicker"})}catch(s){}var Ie,Pn=function(n){return Object(T.e)(n)?n.funnel_viz_type===i.B.Trends:Object(T.h)(n)||Object(T.g)(n)?!1:(Object(T.j)(n)||Object(T.i)(n))&&(!n.display||!Te.o.includes(n.display))},En=(Ie={},k()(Ie,"".concat(i.F.TRENDS),!0),k()(Ie,"".concat(i.F.STICKINESS),!0),k()(Ie,"".concat(i.F.LIFECYCLE),!0),k()(Ie,"".concat(i.F.FUNNELS),!0),k()(Ie,"".concat(i.F.RETENTION),!1),k()(Ie,"".concat(i.F.PATHS),!0),Ie),Sn=function(n){return Object(T.j)(n)?!Object(T.b)(n):!!Object(T.i)(n)},Fn=function(n){var o,r;return!n.actions&&!n.events||((o=n.actions)===null||o===void 0?void 0:o.length)===0&&((r=n.events)===null||r===void 0?void 0:r.length)===0};function ye(s){return Object(e.jsx)("span",{className:"space-x-2 flex items-center text-sm",children:s.children})}function st(s){var n=s.filters,o=s.disableTable,r=Object(T.e)(n),d=Object(T.g)(n),a=Object(c.useValues)(ze.a),l=a.featureFlags,j=Object(c.useActions)(D.c),m=j.setFilters;return Object(e.jsxs)("div",{className:"flex justify-between items-center flex-wrap","data-attr":"insight-filters",children:[Object(e.jsxs)("div",{className:"flex items-center space-x-2 flex-wrap my-2",children:[n.insight&&En[n.insight]&&!o&&Object(e.jsxs)(ye,{children:[Object(e.jsx)("span",{children:"Date range"}),Object(e.jsx)(Ge,{disabled:r&&Fn(n),makeLabel:function(b){return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(ln.a,{})," ",b,b=="All time"&&Object(e.jsx)(Dt.a,{title:"Only events dated after 2015 will be shown",children:Object(e.jsx)(Ee.a,{className:"info-indicator"})})]})}})]}),Pn(n)&&Object(e.jsxs)(ye,{children:[Object(e.jsxs)("span",{children:[Object(e.jsx)("span",{className:"hide-lte-md",children:"grouped "}),"by"]}),Object(e.jsx)(He,{view:n.insight||i.F.TRENDS})]}),Object(T.j)(n)&&!n.breakdown_type&&!n.compare&&(!n.display||n.display===i.k.ActionsLineGraph)&&l[Te.i.SMOOTHING_INTERVAL]?Object(e.jsx)(ye,{children:Object(e.jsx)(an,{})}):null,Object(T.h)(n)&&Object(e.jsxs)(ye,{children:[Object(e.jsx)(Xe,{}),Object(e.jsx)(qe,{})]}),d&&Object(e.jsx)(ye,{children:Object(e.jsx)(Ze,{})}),Sn(n)&&Object(e.jsx)(ye,{children:Object(e.jsx)(Re,{})})]}),Object(e.jsxs)("div",{className:"flex items-center space-x-4 flex-wrap my-2",children:[Object(T.c)(n)&&Object(e.jsxs)(e.Fragment,{children:[Object(T.j)(n)&&Object(e.jsx)(ye,{children:Object(e.jsx)(nt,{filters:n,setFilters:m})}),Object(e.jsxs)(ye,{children:[Object(e.jsx)("span",{children:"Chart type"}),Object(e.jsx)(oe,{filters:n})]})]}),r&&n.funnel_viz_type===i.B.Steps&&Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(ye,{children:Object(e.jsx)(Qe,{})})}),r&&n.funnel_viz_type===i.B.TimeToConvert&&Object(e.jsx)(ye,{children:Object(e.jsx)(et,{})})]})]})}try{st.displayName="InsightDisplayConfig",st.__docgenInfo={description:"",displayName:"InsightDisplayConfig",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},activeView:{defaultValue:null,description:"",name:"activeView",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}},insightMode:{defaultValue:null,description:"",name:"insightMode",required:!0,type:{name:"enum",value:[{value:'"edit"'},{value:'"view"'},{value:'"subscriptions"'},{value:'"sharing"'}]}},disableTable:{defaultValue:null,description:"",name:"disableTable",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightDisplayConfig.tsx#InsightDisplayConfig"]={docgenInfo:st.__docgenInfo,name:"InsightDisplayConfig",path:"frontend/src/scenes/insights/InsightDisplayConfig.tsx#InsightDisplayConfig"})}catch(s){}var pt=t("./node_modules/antd/es/button/index.js"),Tn=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),rt=t.n(Tn),In=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/funnels/FunnelCanvasLabel.scss"),Kt=t.n(In),vt={};vt.insert="head",vt.singleton=!1;var _s=rt()(Kt.a,vt),Cs=Kt.a.locals||{},Ps=t("./node_modules/core-js/modules/es.array.find.js"),Ut=t("./frontend/src/lib/components/EntityFilterInfo.tsx");function wt(){var s,n=Object(c.useValues)(D.c),o=n.insightProps,r=Object(c.useValues)(Object(ne.a)(o)),d=r.filters,a=r.numberOfSeries,l=r.areFiltersValid,j=r.filterSteps,m=Object(c.useActions)(Object(ne.a)(o)),f=m.changeStepRange;if(d.funnel_viz_type===i.B.Steps)return null;var b=function(P,_){f(P,_)},p=l?Array.from(Array(Math.max(a)).keys()).slice(0,-1):[0],u=l?Array.from(Array(Math.max(a)).keys()).slice(((s=d.funnel_from_step)!==null&&s!==void 0?s:0)+1):[1],x=function(P){return P.map(function(_){var R=j.find(function(U){return U.order===_});return R?Object(e.jsx)(me.a.Option,{value:_,label:"Step ".concat(_+1),children:Object(e.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(e.jsxs)("span",{style:{marginRight:4},children:["Step ",_+1,":"]}),Object(e.jsx)(Ut.a,{filter:R})]})},_):null})};return Object(e.jsxs)(re.a,{className:"funnel-options-inputs",children:[Object(e.jsx)("span",{className:"text-muted-alt",children:"from"}),Object(e.jsx)(me.a,{disabled:!l,dropdownMatchSelectWidth:!1,dropdownAlign:h.a.bottomLeft,"data-attr":"funnel-header-steps-funnel_from_step-selector",optionLabelProp:"label",value:d.funnel_from_step||0,onChange:function(P){return b(P,d.funnel_to_step)},style:{marginLeft:4,marginRight:4},children:x(p)}),Object(e.jsx)("span",{className:"text-muted-alt",children:"to"}),Object(e.jsx)(me.a,{disabled:!l,dropdownMatchSelectWidth:!1,dropdownAlign:h.a.bottomLeft,"data-attr":"funnel-header-steps-funnel_to_step-selector",optionLabelProp:"label",value:d.funnel_to_step||Math.max(a-1,1),onChange:function(P){return b(d.funnel_from_step,P)},style:{marginLeft:4,marginRight:4},children:x(u)})]})}function An(){var s=Object(c.useValues)(D.c),n=s.insightProps,o=s.activeView,r=Object(c.useValues)(Object(ne.a)(n)),d=r.conversionMetrics,a=r.filters,l=r.aggregationTargetLabel,j=Object(c.useActions)(Object(ve.a)(n)),m=j.setChartFilter;if(o!==i.F.FUNNELS)return null;var f=[].concat(Se()(a.funnel_viz_type===i.B.Steps?[Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("span",{className:"text-muted-alt mr-1",children:[Object(e.jsx)(te.a,{title:"Overall conversion rate for all ".concat(l.plural," on the entire funnel."),children:Object(e.jsx)(Ee.a,{className:"info-indicator left"})}),"Total conversion rate:"]}),Object(e.jsx)("span",{className:"l4",children:Object(h.rb)(d.totalRate,2,!0)})]})]:[]),Se()(a.funnel_viz_type!==i.B.Trends?[Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("span",{className:"text-muted-alt",children:[Object(e.jsx)(te.a,{title:"Average (arithmetic mean) of the total time each ".concat(l.singular," spent in the entire funnel."),children:Object(e.jsx)(Ee.a,{className:"info-indicator left"})}),"Average time to convert"," "]}),a.funnel_viz_type===i.B.TimeToConvert&&Object(e.jsx)(wt,{}),Object(e.jsx)("span",{className:"text-muted-alt mr-1",children:":"}),Object(e.jsx)(pt.a,{type:"link",onClick:function(){return m(i.B.TimeToConvert)},disabled:a.funnel_viz_type===i.B.TimeToConvert,children:Object(e.jsx)("span",{className:"l4",children:Object(h.O)(d.averageTime)})})]})]:[]),Se()(a.funnel_viz_type===i.B.Trends?[Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("span",{className:"text-muted-alt",children:"Conversion rate "}),Object(e.jsx)(wt,{})]})]:[]));return Object(e.jsx)(re.a,{className:"funnel-canvas-label",align:"middle",children:f.map(function(b,p){return Object(e.jsxs)(Mt.a.Fragment,{children:[p>0&&Object(e.jsx)("span",{style:{margin:"2px 8px",borderLeft:"1px solid var(--border)",height:14}}),b]},p)})})}var Ln=t("./frontend/src/lib/hooks/usePeriodicRerender.ts"),Wt=3;function Dn(){var s=Object(c.useValues)(D.c),n=s.lastRefresh,o=Object(c.useActions)(D.c),r=o.loadResults;return Object(Ln.a)(15e3),Object(e.jsxs)("div",{className:"text-muted-alt",style:{height:32,display:"flex",alignItems:"center"},children:["Computed ",n?Object(ie.a)(n).fromNow():"a while ago",Object(e.jsx)("span",{style:{padding:"0 4px"},children:"\u2022"}),Object(e.jsx)(Dt.a,{title:Object(e.jsxs)(e.Fragment,{children:["Insights can be refreshed",Object(e.jsx)("br",{}),"every ",Wt," minutes."]}),children:Object(e.jsx)(pt.a,{size:"small",type:"link",onClick:function(){return r(!0)},disabled:!!n&&Object(ie.a)().subtract(Wt-.5,"minutes").isBefore(n),style:{padding:0},children:Object(e.jsx)("span",{style:{fontSize:14},children:"Refresh"})})})]})}var ht=t("./frontend/src/scenes/trends/viz/index.ts"),kt=t("./frontend/src/scenes/insights/views/InsightsTable/InsightsTable.tsx");try{InsightsTable.displayName="InsightsTable",InsightsTable.__docgenInfo={description:"",displayName:"InsightsTable",props:{isLegend:{defaultValue:{value:"false"},description:"Whether this is just a legend instead of standalone insight viz. Default: false.",name:"isLegend",required:!1,type:{name:"boolean"}},embedded:{defaultValue:{value:"false"},description:"Whether this is table is embedded in another card or whether it should be a card of its own. Default: false.",name:"embedded",required:!1,type:{name:"boolean"}},filterKey:{defaultValue:null,description:"Key for the entityFilterLogic",name:"filterKey",required:!0,type:{name:"string"}},canEditSeriesNameInline:{defaultValue:{value:"false"},description:"",name:"canEditSeriesNameInline",required:!1,type:{name:"boolean"}},canCheckUncheckSeries:{defaultValue:{value:"true"},description:"(Un)checking series updates the insight via the API, so it should be disabled if updates aren't desired.",name:"canCheckUncheckSeries",required:!1,type:{name:"boolean"}},isMainInsightView:{defaultValue:{value:"false"},description:"",name:"isMainInsightView",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/views/InsightsTable/index.tsx#InsightsTable"]={docgenInfo:InsightsTable.__docgenInfo,name:"InsightsTable",path:"frontend/src/scenes/insights/views/InsightsTable/index.tsx#InsightsTable"})}catch(s){}var Rn=t("./frontend/src/scenes/insights/insightSceneLogic.tsx"),Mn=t("./frontend/src/scenes/insights/views/WorldMap/index.ts"),Nn=t("./frontend/src/scenes/insights/views/BoldNumber/index.ts");function Ve(s){var n=s.view,o=Object(c.useValues)(Rn.a),r=o.insightMode,d=Object(c.useValues)(D.c),a=d.insightProps,l=Object(c.useValues)(Object(Ne.a)(a)),j=l.filters,m=l.loadMoreBreakdownUrl,f=l.breakdownValuesLoading,b=Object(c.useActions)(Object(Ne.a)(a)),p=b.loadMoreBreakdownValues,u=Object(T.j)(j)||Object(T.i)(j)?j.display:null,x=function(){if(!u||u===i.k.ActionsLineGraph||u===i.k.ActionsLineGraphCumulative||u===i.k.ActionsAreaGraph||u===i.k.ActionsBar)return Object(e.jsx)(ht.b,{});if(u===i.k.BoldNumber)return Object(e.jsx)(Nn.a,{});if(u===i.k.ActionsTable)return Object(e.jsx)(c.BindLogic,{logic:Ne.a,props:{dashboardItemId:null,view:n,filters:null},children:Object(e.jsx)(kt.b,{embedded:!0,filterKey:"trends_".concat(n),canEditSeriesNameInline:r===i.G.Edit,isMainInsightView:!0})});if(u===i.k.ActionsPie)return Object(e.jsx)(ht.c,{});if(u===i.k.ActionsBarValue)return Object(e.jsx)(ht.a,{});if(u===i.k.WorldMap)return Object(e.jsx)(Mn.a,{})};return Object(e.jsxs)(e.Fragment,{children:[(j.actions||j.events)&&Object(e.jsx)("div",{className:u!==i.k.ActionsTable&&u!==i.k.WorldMap&&u!==i.k.BoldNumber?"trends-insights-container":void 0,children:x()}),j.breakdown&&m&&Object(e.jsxs)("div",{className:"my-4 flex flex-col items-center",children:[Object(e.jsxs)("div",{className:"text-muted mb-2",children:["For readability, ",Object(e.jsx)("b",{children:"not all breakdown values are displayed"}),". Click below to load them."]}),Object(e.jsx)(q.LemonButton,{onClick:p,loading:f,size:"small",type:"secondary",children:"Load more breakdown values"})]})]})}try{Ve.displayName="TrendInsight",Ve.__docgenInfo={description:"",displayName:"TrendInsight",props:{view:{defaultValue:null,description:"",name:"view",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/trends/Trends.tsx#TrendInsight"]={docgenInfo:Ve.__docgenInfo,name:"TrendInsight",path:"frontend/src/scenes/trends/Trends.tsx#TrendInsight"})}catch(s){}var Vn=t("./frontend/src/scenes/retention/RetentionContainer.tsx"),Bn=t("./frontend/src/scenes/paths/Paths.tsx"),We=t("./frontend/src/scenes/insights/EmptyStates/index.ts");function Kn(){var s=Object(c.useValues)(D.c),n=s.activeView;return n!==i.F.PATHS?null:Object(e.jsx)(re.a,{className:"funnel-canvas-label",align:"middle",children:Object(e.jsx)(Mt.a.Fragment,{children:Object(e.jsx)("span",{className:"text-muted-alt",children:"Large path items are shown by default. View smaller items by hovering over a node"})})})}var zt=t("./frontend/src/lib/components/InsightLegend/InsightLegend.tsx"),Es=t("./node_modules/core-js/modules/es.object.from-entries.js"),Ss=t("./node_modules/core-js/modules/es.array.flat-map.js"),Fs=t("./node_modules/core-js/modules/es.array.unscopables.flat-map.js"),Un=t("./frontend/src/lib/components/LemonTable/index.ts"),ot=t("./frontend/src/scenes/funnels/funnelUtils.ts"),Ot=t("./frontend/src/scenes/insights/views/Funnels/funnelStepTableUtils.tsx"),wn=t("./frontend/src/models/cohortsModel.ts"),$t=t("./frontend/src/lib/components/LemonCheckbox/index.ts"),Yt=t("./frontend/src/lib/components/Lettermark/Lettermark.tsx"),gt=t("./frontend/src/lib/components/LemonRow/index.ts"),Be=t("./frontend/src/scenes/funnels/ValueInspectorButton.tsx"),Wn=t("./frontend/src/lib/colors.ts"),kn=t("./frontend/src/models/propertyDefinitionsModel.ts"),zn=t("./frontend/src/scenes/insights/utils.tsx");function $n(){var s=Object(c.useValues)(D.c),n=s.insightProps,o=Object(ne.a)(n),r=Object(c.useValues)(o),d=r.insightLoading,a=r.filters,l=r.steps,j=r.flattenedBreakdowns,m=r.hiddenLegendKeys,f=r.visibleStepsWithConversionMetrics,b=r.isOnlySeries,p=Object(c.useActions)(o),u=p.setHiddenById,x=p.toggleVisibilityByBreakdown,y=p.openPersonsModalForSeries,P=Object(c.useValues)(wn.a),_=P.cohorts,R=Object(c.useValues)(kn.a),U=R.formatPropertyValueForDisplay,z=j==null?void 0:j.every(function(v){return!m[Object(ot.l)(v.breakdown_value)]}),A=[{children:[{title:b?"Breakdown":Object(e.jsx)($t.a,{checked:z||(j!=null&&j.some(function(v){return!m[Object(ot.l)(v.breakdown_value)]})?"indeterminate":!1),onChange:function(){u(Object.fromEntries(f.flatMap(function(){return j.map(function(g){return[Object(ot.l)(g.breakdown_value),z]})})))},label:Object(e.jsx)("span",{className:"font-bold",children:"Breakdown"}),size:"small"}),dataIndex:"breakdown_value",render:function(g,I){var V,M=((V=I.breakdown_value)===null||V===void 0?void 0:V.length)==1?I.breakdown_value[0]:I.breakdown_value,N=Object(zn.d)(_,U,M,I.breakdown,a.breakdown_type);return b?Object(e.jsx)("span",{className:"font-medium",children:N}):Object(e.jsx)($t.a,{checked:!m[Object(ot.l)(I.breakdown_value)],onChange:function(){return x(I.breakdown_value)},label:N})}},{title:Object(e.jsxs)(e.Fragment,{children:["Total",Object(e.jsx)("br",{}),"conversion"]}),render:function(g,I){var V,M;return Object(h.rb)((V=I==null||(M=I.conversionRates)===null||M===void 0?void 0:M.total)!==null&&V!==void 0?V:0,2,!0)},align:"right"}]}].concat(Se()(l.map(function(v,g){return{title:Object(e.jsx)(gt.a,{icon:Object(e.jsx)(Yt.a,{name:g+1,color:Yt.b.Gray}),style:{font:"inherit",padding:0},size:"small",children:Object(e.jsx)(Ut.a,{filter:Object(Ot.a)(v)})}),children:[{title:g===0?"Entered":"Converted",render:function(V,M){var N,F,C=(N=M.steps)===null||N===void 0?void 0:N[g];return C&&Object(e.jsx)(Be.a,{onClick:function(){return y({step:v,series:C,converted:!0})},style:{padding:0},children:Object(h.P)((F=C.count)!==null&&F!==void 0?F:0)})},align:"right"}].concat(Se()(g===0?[]:[{title:"Dropped\xA0off",render:function(V,M){var N,F,C=(N=M.steps)===null||N===void 0?void 0:N[g];return C&&Object(e.jsx)(Be.a,{onClick:function(){return y({step:v,series:C,converted:!1})},style:{padding:0},children:Object(h.P)((F=C.droppedOffFromPrevious)!==null&&F!==void 0?F:0)})},align:"right"}]),[{title:Object(e.jsxs)(e.Fragment,{children:["Conversion",Object(e.jsx)("br",{}),"so\xA0far"]}),render:function(V,M){var N,F,C,w,W,S,L=Object(Ot.b)(M,v.order);return L!=null&&L.total?Object(e.jsx)(gt.a,{className:"significance-highlight",tooltip:"Significantly different from other breakdown values",icon:Object(e.jsx)(H.IconFlag,{}),size:"small",children:Object(h.rb)((N=(F=M.steps)===null||F===void 0||(C=F[v.order])===null||C===void 0?void 0:C.conversionRates.total)!==null&&N!==void 0?N:0,2,!0)}):Object(h.rb)((w=(W=M.steps)===null||W===void 0||(S=W[v.order])===null||S===void 0?void 0:S.conversionRates.total)!==null&&w!==void 0?w:0,2,!0)},align:"right"}],Se()(g===0?[]:[{title:Object(e.jsxs)(e.Fragment,{children:["Conversion",Object(e.jsx)("br",{}),"from\xA0previous"]}),render:function(V,M){var N,F,C,w,W,S,L=Object(Ot.b)(M,v.order);return!(L!=null&&L.total)&&L!==null&&L!==void 0&&L.fromPrevious?Object(e.jsx)(gt.a,{className:"significance-highlight",tooltip:"Significantly different from other breakdown values",icon:Object(e.jsx)(H.IconFlag,{}),size:"small",children:Object(h.rb)((N=(F=M.steps)===null||F===void 0||(C=F[v.order])===null||C===void 0?void 0:C.conversionRates.fromPrevious)!==null&&N!==void 0?N:0,2,!0)}):Object(h.rb)((w=(W=M.steps)===null||W===void 0||(S=W[v.order])===null||S===void 0?void 0:S.conversionRates.fromPrevious)!==null&&w!==void 0?w:0,2,!0)},align:"right"},{title:Object(e.jsxs)(e.Fragment,{children:["Median",Object(e.jsx)("br",{}),"time"]}),render:function(V,M){var N,F;return((N=M.steps)===null||N===void 0||(F=N[v.order])===null||F===void 0?void 0:F.median_conversion_time)!=null?Object(h.O)(M.steps[v.order].median_conversion_time,3):"\u2013"},align:"right",width:0,className:"whitespace-nowrap"},{title:Object(e.jsxs)(e.Fragment,{children:["Average",Object(e.jsx)("br",{}),"time"]}),render:function(V,M){var N,F;return((N=M.steps)===null||N===void 0||(F=N[v.order])===null||F===void 0?void 0:F.average_conversion_time)!=null?Object(h.O)(M.steps[v.order].average_conversion_time,3):"\u2013"},align:"right",width:0,className:"whitespace-nowrap"}]))}})));return Object(e.jsx)(Un.a,{dataSource:j,columns:A,loading:d,rowKey:"breakdownIndex",rowStatus:function(g){return g.significant?"highlighted":null},rowRibbonColor:function(g){var I;return Object(Wn.d)((I=g==null?void 0:g.breakdownIndex)!==null&&I!==void 0?I:0)}})}var Yn=t("./frontend/src/lib/components/Animation/Animation.tsx"),Hn=t("./frontend/src/lib/animations/animations.ts"),Gn=t("./node_modules/@ant-design/icons/es/icons/CommentOutlined.js"),Jn=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/FunnelCorrelation.scss"),Ht=t.n(Jn),xt={};xt.insert="head",xt.singleton=!1;var Ts=rt()(Ht.a,xt),Is=Ht.a.locals||{},Xn=t("./node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),Qn=t("./frontend/src/lib/components/PayCard/PayCard.tsx"),Zn=t("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),As=t("./node_modules/core-js/modules/es.number.is-integer.js"),Ls=t("./node_modules/core-js/modules/es.number.constructor.js"),Ds=t("./node_modules/core-js/modules/es.number.to-fixed.js"),Rs=t("./node_modules/core-js/modules/es.string.split.js"),qn=t("./node_modules/antd/es/spin/index.js"),yt=t("./node_modules/antd/es/table/index.js"),es=t("./node_modules/antd/lib/table/Column.js"),be=t.n(es),Gt=t("./node_modules/@ant-design/icons/es/icons/RiseOutlined.js"),Jt=t("./node_modules/@ant-design/icons/es/icons/FallOutlined.js"),Xt=t("./node_modules/@ant-design/icons/es/icons/EllipsisOutlined.js"),ts=t("./node_modules/antd/lib/checkbox/Checkbox.js"),at=t.n(ts),Ke=t("./frontend/src/lib/components/PropertyKeyInfo.tsx"),ns=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/FunnelCorrelationTable.scss"),Qt=t.n(ns),_t={};_t.insert="head",_t.singleton=!1;var Ms=rt()(Qt.a,_t),Ns=Qt.a.locals||{},ss=t("./frontend/src/lib/components/VisibilitySensor/visibilitySensorLogic.tsx");function ke(s){var n=s.id,o=s.offset,r=s.children,d=Object(c.useActions)(Object(ss.a)({id:n,offset:o})),a=d.scrolling,l=Object(le.useRef)(null);return Object(le.useEffect)(function(){var j=l.current;return document.addEventListener("scroll",function(){return j&&a(j)}),function(){return document.removeEventListener("scroll",function(){return j&&a(j)})}},[l.current]),Object(e.jsx)("div",{ref:l,children:r})}try{ke.displayName="VisibilitySensor",ke.__docgenInfo={description:"",displayName:"VisibilitySensor",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},offset:{defaultValue:null,description:"",name:"offset",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/VisibilitySensor/VisibilitySensor.tsx#VisibilitySensor"]={docgenInfo:ke.__docgenInfo,name:"VisibilitySensor",path:"frontend/src/lib/components/VisibilitySensor/VisibilitySensor.tsx#VisibilitySensor"})}catch(s){}var Zt=t("./frontend/src/lib/components/Popup/Popup.tsx"),rs=t("./node_modules/antd/es/modal/index.js"),os=t("./node_modules/@ant-design/icons/es/icons/CheckCircleFilled.js"),as=t("./node_modules/@ant-design/icons/es/icons/MinusCircleOutlined.js"),is=t("./node_modules/@ant-design/icons/es/icons/CloseCircleOutlined.js"),ls=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/CorrelationMatrix.scss"),qt=t.n(ls),Ct={};Ct.insert="head",Ct.singleton=!1;var Vs=rt()(qt.a,Ct),Bs=qt.a.locals||{},cs=t("./frontend/src/lib/components/Spinner/Spinner.tsx"),en=t("./frontend/src/lib/components/Link.tsx"),ds=t("./frontend/src/lib/components/InlineMessage/InlineMessage.tsx");function us(){var s=Object(c.useValues)(D.c),n=s.insightProps,o=Object(ne.a)(n),r=Object(c.useValues)(o),d=r.correlationsLoading,a=r.funnelCorrelationDetails,l=r.parseDisplayNameForCorrelation,j=r.correlationMatrixAndScore,m=Object(c.useActions)(o),f=m.setFunnelCorrelationDetails,b=m.openCorrelationPersonsModal,p=(a==null?void 0:a.result_type)===i.x.Events?"event":"property",u=(a==null?void 0:a.result_type)===i.x.Events?"performed event":"have property",x=Object(e.jsx)(e.Fragment,{});if(a){var y=l(a),P=y.first_value,_=y.second_value;x=Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Ke.a,{value:P}),_!==void 0&&Object(e.jsxs)(e.Fragment,{children:[" :: ",Object(e.jsx)(Ke.a,{value:_,disablePopover:!0})]})]})}var R=j.correlationScore,U=j.truePositive,z=j.falsePositive,A=j.trueNegative,v=j.falseNegative,g=j.correlationScoreStrength,I=g==="strong"?Object(e.jsx)(os.a,{style:{color:"var(--success)"}}):g==="moderate"?Object(e.jsx)(as.a,{style:{color:"var(--warning)"}}):Object(e.jsx)(is.a,{style:{color:"var(--danger)"}}),V=function(){return f(null)};return Object(e.jsx)(rs.a,{className:"correlation-matrix",visible:!!a,onCancel:V,destroyOnClose:!0,footer:Object(e.jsx)(pt.a,{onClick:V,children:"Dismiss"}),width:600,title:"Correlation details",children:Object(e.jsx)("div",{className:"correlation-table-wrapper",children:d?Object(e.jsx)("div",{className:"mt-4 text-center",children:Object(e.jsx)(cs.a,{className:"text-4xl"})}):a?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("p",{className:"text-muted-alt mb-4",children:["The table below displays the correlation details for users who ",u," ",Object(e.jsx)("b",{children:x}),"."]}),Object(e.jsxs)("table",{children:[Object(e.jsxs)("thead",{children:[Object(e.jsx)("tr",{className:"table-title",children:Object(e.jsx)("td",{colSpan:3,children:"Results matrix"})}),Object(e.jsxs)("tr",{children:[Object(e.jsx)("td",{children:(a==null?void 0:a.result_type)===i.x.Events?"Performed event":"Has property"}),Object(e.jsx)("td",{children:"Success"}),Object(e.jsx)("td",{children:"Dropped off"})]})]}),Object(e.jsxs)("tbody",{children:[Object(e.jsxs)("tr",{children:[Object(e.jsx)("td",{className:"horizontal-header",children:"Yes"}),Object(e.jsxs)("td",{children:[Object(e.jsx)(te.a,{title:"True positive (TP) - Percentage of users who ".concat(u," and completed the funnel."),children:Object(e.jsx)("div",{className:"percentage",children:U?Object(h.rb)(U/(U+z)):"0.00%"})}),U===0?"0 users":Object(e.jsx)(en.a,{onClick:function(){b(a,!0)},children:Object(h.sb)(U,"user",void 0,!0)})]}),Object(e.jsxs)("td",{children:[Object(e.jsx)("div",{className:"percentage",children:Object(e.jsx)(te.a,{title:"False negative (FN) - Percentage of users who ".concat(u," and did not complete the funnel."),children:v?Object(h.rb)(v/(v+A)):"0.00%"})}),v===0?"0 users":Object(e.jsx)(en.a,{onClick:function(){b(a,!1)},children:Object(h.sb)(v,"user",void 0,!0)})]})]}),Object(e.jsxs)("tr",{children:[Object(e.jsx)("td",{className:"horizontal-header",children:"No"}),Object(e.jsxs)("td",{children:[Object(e.jsx)("div",{className:"percentage",children:Object(e.jsx)(te.a,{title:"False positive (FP) - Percentage of users who did not ".concat(u," and completed the funnel."),children:z?Object(h.rb)(z/(U+z)):"0.00%"})}),Object(h.sb)(z,"user",void 0,!0)]}),Object(e.jsxs)("td",{children:[Object(e.jsx)("div",{className:"percentage",children:Object(e.jsx)(te.a,{title:"True negative (TN) - Percentage of users who did not ".concat(u," and did not complete the funnel."),children:A?Object(h.rb)(A/(v+A)):"0.00%"})}),Object(h.sb)(A,"user",void 0,!0)]})]}),Object(e.jsxs)("tr",{children:[Object(e.jsx)("td",{className:"horizontal-header"}),Object(e.jsx)("td",{children:Object(e.jsx)("b",{children:"100%"})}),Object(e.jsx)("td",{children:Object(e.jsx)("b",{children:"100%"})})]})]})]}),Object(e.jsxs)("div",{className:"mt-4 text-center",children:[Object(h.i)((a==null?void 0:a.result_type)||"")," ",Object(e.jsx)("b",{children:x})," ","has a"," ",(a==null?void 0:a.correlation_type)===i.y.Success?Object(e.jsxs)("b",{className:"text-success",children:["positive"," ",Object(e.jsx)(te.a,{title:"Positive correlation means this ".concat(p," is correlated with a successful conversion."),children:Object(e.jsx)(Ee.a,{className:"cursor-pointer"})})]}):Object(e.jsxs)("b",{className:"text-danger",children:["negative"," ",Object(e.jsx)(te.a,{title:"Negative correlation means this ".concat(p," is correlated with an unsuccessful conversion (user dropped off)."),children:Object(e.jsx)(Ee.a,{className:"cursor-pointer"})})]})," ","correlation score of"," ",Object(e.jsx)("b",{style:{color:g==="strong"?"var(--success)":g==="moderate"?"var(--warning)":"var(--danger)"},children:Object(e.jsx)(te.a,{title:"This ".concat(p," has ").concat(g," correlation."),children:Object(e.jsxs)("span",{style:{cursor:"pointer"},children:[I," ",R.toFixed(3)]})})})]})]}):Object(e.jsx)("div",{children:Object(e.jsx)(ds.a,{type:"danger",children:"We could not load the details for this correlation value. Please recreate your funnel and try again."})})})})}function js(){var s=Object(c.useValues)(D.c),n=s.insightProps,o=Object(ne.a)(n),r=Object(c.useValues)(o),d=r.steps,a=r.correlationValues,l=r.correlationTypes,j=r.eventHasPropertyCorrelations,m=r.eventWithPropertyCorrelationsValues,f=r.parseDisplayNameForCorrelation,b=r.correlationsLoading,p=r.eventWithPropertyCorrelationsLoading,u=r.nestedTableExpandedKeys,x=r.correlationPropKey,y=r.filters,P=r.aggregationTargetLabel,_=Object(c.useActions)(o),R=_.setCorrelationTypes,U=_.loadEventWithPropertyCorrelations,z=_.addNestedTableExpandedKey,A=_.removeNestedTableExpandedKey,v=_.openCorrelationPersonsModal,g=_.loadCorrelations,I=Object(c.useActions)(mt.e),V=I.reportCorrelationInteraction;Object(le.useEffect)(function(){g({})},[y]);var M=function(S){l?l.includes(S)?R(l.filter(function(L){return L!==S})):R([].concat(Se()(l),[S])):R([S])},N=function(S){var L=function(dt){return dt<10&&!Number.isInteger(dt)?dt.toFixed(1):dt.toFixed()},se=S.correlation_type===i.y.Success,X=f(S),Le=X.first_value,lt=X.second_value;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("h4",{children:[se?Object(e.jsx)(Gt.a,{style:{color:"green"}}):Object(e.jsx)(Jt.a,{style:{color:"red"}})," ",Object(e.jsx)(Ke.a,{value:Le}),lt!==void 0&&Object(e.jsxs)(e.Fragment,{children:[" :: ",Object(e.jsx)(Ke.a,{value:lt,disablePopover:!0})]})]}),Object(e.jsxs)("div",{children:[Object(h.i)(P.plural)," ",y.aggregation_group_type_index!=null?"that":"who"," converted were"," ",Object(e.jsx)("mark",{children:Object(e.jsxs)("b",{children:[L(S.odds_ratio),"x ",se?"more":"less"," likely"]})})," ","to"," ",S.result_type===i.x.EventWithProperties?"have this event property":"do this event"]}),Object(e.jsx)(us,{})]})},F=function(S){return Object(e.jsx)(Be.a,{onClick:function(){v(S,!0)},children:S.success_count})},C=function(S){return Object(e.jsx)(Be.a,{onClick:function(){v(S,!1)},children:S.failure_count})},w=function(S){return p?Object(e.jsxs)("div",{className:"nested-properties-loading",children:[Object(e.jsx)(qn.a,{}),Object(e.jsx)("h3",{children:"Loading correlation results"}),Object(e.jsx)("p",{children:"This process can take up to 20 seconds. "})]}):Object(e.jsxs)("div",{children:[Object(e.jsx)("h4",{style:{paddingLeft:16},children:"Correlated properties"}),Object(e.jsxs)(yt.a,{dataSource:m[S],rowKey:function(se){return se.event.event},className:"nested-properties-table",scroll:{x:"max-content"},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(se,X){return V(i.x.EventWithProperties,"pagination change",{page:se,page_size:X})}},children:[Object(e.jsx)(be.a,{title:"Property",render:function(se,X){return N(X)},align:"left"},"eventName"),Object(e.jsx)(be.a,{title:"Completed",render:function(se,X){return F(X)},width:90,align:"center"},"success_count"),Object(e.jsx)(be.a,{title:"Dropped off",render:function(se,X){return C(X)},width:120,align:"center"},"failure_count"),Object(e.jsx)(be.a,{title:"",render:function(se,X){return Object(e.jsx)(tn,{record:X})},align:"center",width:30},"actions")]})]})};return d.length>1?Object(e.jsx)(ke,{id:x,offset:152,children:Object(e.jsxs)("div",{className:"funnel-correlation-table",children:[Object(e.jsxs)("span",{className:"funnel-correlation-header",children:[Object(e.jsxs)("span",{className:"table-header",children:[Object(e.jsx)(H.IconSelectEvents,{style:{marginRight:4,fontSize:24,opacity:.5}}),"CORRELATED EVENTS"]}),Object(e.jsxs)("span",{className:"table-options",children:[Object(e.jsx)("p",{className:"title",children:"CORRELATION"}),Object(e.jsx)("div",{className:"tab-btn ant-btn",style:{paddingTop:"1px",paddingBottom:"1px",borderTopRightRadius:0,borderBottomRightRadius:0},onClick:function(){return M(i.y.Success)},children:Object(e.jsx)(at.a,{checked:l.includes(i.y.Success),style:{pointerEvents:"none"},children:"Success"})}),Object(e.jsx)("div",{className:"tab-btn ant-btn",style:{marginRight:"8px",paddingTop:"1px",paddingBottom:"1px",borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:function(){return M(i.y.Failure)},children:Object(e.jsx)(at.a,{checked:l.includes(i.y.Failure),style:{pointerEvents:"none"},children:"Dropoff"})})]})]}),Object(e.jsxs)(yt.a,{dataSource:a,loading:b,size:"small",scroll:{x:"max-content"},rowKey:function(S){return S.event.event},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(){return V(i.x.Events,"load more")}},expandable:{expandedRowRender:function(S){return w(S.event.event)},expandedRowKeys:u,rowExpandable:function(){return y.aggregation_group_type_index===void 0},expandIcon:function(S){var L=S.expanded,se=S.onExpand,X=S.record,Le=S.expandable;return Le?L?Object(e.jsx)(te.a,{title:"Collapse",children:Object(e.jsx)("div",{style:{cursor:"pointer",opacity:.5,fontSize:24},onClick:function(ct){A(X.event.event),se(X,ct)},children:Object(e.jsx)(H.IconUnfoldLess,{})})}):Object(e.jsx)(te.a,{title:"Expand to see correlated properties for this event",children:Object(e.jsx)("div",{style:{cursor:"pointer",opacity:.5,fontSize:24},onClick:function(ct){!j(X.event.event)&&U(X.event.event),z(X.event.event),se(X,ct)},children:Object(e.jsx)(H.IconUnfoldMore,{})})}):null}},children:[Object(e.jsx)(be.a,{title:"Event",render:function(S,L){return N(L)},align:"left",ellipsis:!0},"eventName"),Object(e.jsx)(be.a,{title:Object(e.jsxs)("div",{className:"flex items-center",children:["Completed",Object(e.jsx)(te.a,{title:"".concat(Object(h.i)(P.plural)," ").concat(y.aggregation_group_type_index!=null?"that":"who"," performed the event and completed the entire funnel."),children:Object(e.jsx)(Ee.a,{className:"column-info"})})]}),render:function(S,L){return F(L)},width:90,align:"center"},"success_count"),Object(e.jsx)(be.a,{title:Object(e.jsxs)("div",{className:"flex items-center",children:["Dropped off",Object(e.jsx)(te.a,{title:Object(e.jsxs)(e.Fragment,{children:[Object(h.i)(P.plural)," ",y.aggregation_group_type_index!=null?"that":"who"," ","performed the event and did ",Object(e.jsx)("b",{children:"not complete"})," the entire funnel."]}),children:Object(e.jsx)(Ee.a,{className:"column-info"})})]}),render:function(S,L){return C(L)},width:120,align:"center"},"failure_count"),Object(e.jsx)(be.a,{title:"",render:function(S,L){return Object(e.jsx)(tn,{record:L})},width:30},"actions")]})]})}):null}var tn=function(n){var o=n.record,r=Object(c.useValues)(D.c),d=r.insightProps,a=Object(ne.a)(d),l=Object(c.useActions)(a),j=l.excludeEventPropertyFromProject,m=l.excludeEventFromProject,f=l.setFunnelCorrelationDetails,b=Object(c.useValues)(a),p=b.isEventPropertyExcluded,u=b.isEventExcluded,x=o.event.event.split("::"),y=Object(le.useState)(!1),P=je()(y,2),_=P[0],R=P[1];return Object(e.jsx)(re.a,{style:{justifyContent:"flex-end"},children:Object(e.jsx)(Zt.a,{visible:_,actionable:!0,onClickOutside:function(){return R(!1)},overlay:Object(e.jsxs)(e.Fragment,{children:[o.result_type===i.x.Events&&Object(e.jsx)(fe.a,{onClick:function(){return f(o)},fullWidth:!0,status:"stealth",children:"View correlation details"}),Object(e.jsx)(fe.a,{disabled:o.result_type===i.x.EventWithProperties?p(x[1]):u(x[0]),onClick:function(){return o.result_type===i.x.EventWithProperties?j(x[0],x[1]):m(x[0])},fullWidth:!0,title:"Remove this event from any correlation analysis report in this project.",status:"stealth",children:"Exclude event from project"})]}),children:Object(e.jsx)(fe.a,{status:"stealth",onClick:function(){return R(!_)},children:Object(e.jsx)(Xt.a,{style:{color:"var(--primary)",fontSize:24},className:"insight-dropdown-actions"})})})})},fs=t("./frontend/src/lib/components/PropertyNamesSelect/PropertyNamesSelect.tsx");function bs(){var s=Object(c.useValues)(D.c),n=s.insightProps,o=Object(ne.a)(n),r=Object(c.useValues)(o),d=r.steps,a=r.propertyCorrelationValues,l=r.propertyCorrelationTypes,j=r.excludedPropertyNames,m=r.parseDisplayNameForCorrelation,f=r.propertyCorrelationsLoading,b=r.inversePropertyNames,p=r.propertyNames,u=r.correlationPropKey,x=r.allProperties,y=r.filters,P=r.aggregationTargetLabel,_=Object(c.useActions)(o),R=_.setPropertyCorrelationTypes,U=_.setPropertyNames,z=_.openCorrelationPersonsModal,A=_.loadPropertyCorrelations,v=Object(c.useActions)(mt.e),g=v.reportCorrelationInteraction;Object(le.useEffect)(function(){p.length===0&&U(x),A({})},[y]);var I=function(C){l?l.includes(C)?R(l.filter(function(w){return w!==C})):R([].concat(Se()(l),[C])):R([C])},V=function(C){return Object(e.jsx)(Be.a,{onClick:function(){z(C,!0)},children:C.success_count})},M=function(C){return Object(e.jsx)(Be.a,{onClick:function(){z(C,!1)},children:C.failure_count})},N=function(C){var w=function(Le){return Le<10&&!Number.isInteger(Le)?Le.toFixed(1):Le.toFixed()},W=C.correlation_type===i.y.Success,S=m(C),L=S.first_value,se=S.second_value;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("h4",{children:[W?Object(e.jsx)(Gt.a,{style:{color:"green"}}):Object(e.jsx)(Jt.a,{style:{color:"red"}})," ",Object(e.jsx)(Ke.a,{value:L}),se!==void 0&&Object(e.jsxs)(e.Fragment,{children:[" :: ",Object(e.jsx)(Ke.a,{value:se,disablePopover:!0})]})]}),Object(e.jsxs)("div",{children:[Object(h.i)(P.plural)," ",y.aggregation_group_type_index!=null?"that":"who"," converted were"," ",Object(e.jsx)("mark",{children:Object(e.jsxs)("b",{children:[w(C.odds_ratio),"x ",W?"more":"less"," likely"]})})," ","to have this property value"]})]})};return d.length>1?Object(e.jsx)(ke,{offset:150,id:"".concat(u,"-properties"),children:Object(e.jsxs)("div",{className:"funnel-correlation-table",children:[Object(e.jsxs)(re.a,{className:"funnel-correlation-header",children:[Object(e.jsxs)(ce.a,{className:"table-header",children:[Object(e.jsx)(H.IconSelectProperties,{style:{marginRight:4,opacity:.5,fontSize:24}}),"CORRELATED PROPERTIES"]}),Object(e.jsxs)(ce.a,{className:"table-options",children:[Object(e.jsx)(re.a,{style:{display:"contents"},children:x.length>0&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("p",{className:"title",children:"PROPERTIES "}),Object(e.jsx)(fs.a,{value:new Set(p),onChange:function(C){return U(C)},allProperties:b(j||[])})]})}),Object(e.jsxs)(re.a,{style:{display:"contents"},children:[Object(e.jsx)("p",{className:"title",style:{marginLeft:8},children:"CORRELATION"}),Object(e.jsx)("div",{className:"tab-btn ant-btn",style:{paddingTop:"1px",paddingBottom:"1px",borderTopRightRadius:0,borderBottomRightRadius:0},onClick:function(){return I(i.y.Success)},children:Object(e.jsx)(at.a,{checked:l.includes(i.y.Success),style:{pointerEvents:"none"},children:"Success"})}),Object(e.jsx)("div",{className:"tab-btn ant-btn",style:{marginRight:"8px",paddingTop:"1px",paddingBottom:"1px",borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:function(){return I(i.y.Failure)},children:Object(e.jsx)(at.a,{checked:l.includes(i.y.Failure),style:{pointerEvents:"none"},children:"Dropoff"})})]})]})]}),Object(e.jsxs)(yt.a,{dataSource:a,loading:f,scroll:{x:"max-content"},size:"small",rowKey:function(C){return C.event.event},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(C,w){return g(i.x.Properties,"pagination change",{page:C,page_size:w})}},children:[Object(e.jsx)(be.a,{title:"".concat(Object(h.i)(P.singular)," property"),render:function(C,w){return N(w)},align:"left"},"propertName"),Object(e.jsx)(be.a,{title:Object(e.jsxs)("div",{className:"flex items-center",children:["Completed",Object(e.jsx)(te.a,{title:"".concat(Object(h.i)(P.plural)," ").concat(y.aggregation_group_type_index!=null?"that":"who"," have this property and completed the entire funnel."),children:Object(e.jsx)(Ee.a,{className:"column-info"})})]}),render:function(C,w){return V(w)},width:90,align:"center"},"success_count"),Object(e.jsx)(be.a,{title:Object(e.jsxs)("div",{className:"flex items-center",children:["Dropped off",Object(e.jsx)(te.a,{title:Object(e.jsxs)(e.Fragment,{children:[Object(h.i)(P.plural)," ",y.aggregation_group_type_index!=null?"that":"who"," have this property and did ",Object(e.jsx)("b",{children:"not complete"})," the entire funnel."]}),children:Object(e.jsx)(Ee.a,{className:"column-info"})})]}),render:function(C,w){return M(w)},width:120,align:"center"},"failure_count"),Object(e.jsx)(be.a,{title:"",render:function(C,w){return Object(e.jsx)(ms,{record:w})},align:"center",width:30},"actions")]})]})}):null}var ms=function(n){var o=n.record,r=Object(c.useValues)(D.c),d=r.insightProps,a=Object(ne.a)(d),l=Object(c.useActions)(a),j=l.excludePropertyFromProject,m=l.setFunnelCorrelationDetails,f=Object(c.useValues)(a),b=f.isPropertyExcludedFromProject,p=(o.event.event||"").split("::")[0],u=Object(le.useState)(!1),x=je()(u,2),y=x[0],P=x[1];return Object(e.jsx)(re.a,{style:{justifyContent:"flex-end"},children:Object(e.jsx)(Zt.a,{visible:y,actionable:!0,onClickOutside:function(){return P(!1)},overlay:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(fe.a,{onClick:function(){return m(o)},fullWidth:!0,status:"stealth",children:"View correlation details"}),Object(e.jsx)(fe.a,{disabled:b(p),onClick:function(){return j(p)},fullWidth:!0,title:"Remove this property from any correlation analysis report in this project.",status:"stealth",children:"Exclude property from project"})]}),children:Object(e.jsx)(fe.a,{status:"stealth",onClick:function(){return P(!y)},children:Object(e.jsx)(Xt.a,{style:{color:"var(--primary)",fontSize:24},className:"insight-dropdown-actions"})})})})},ps=function(){var n,o=Object(c.useValues)(D.c),r=o.insightProps,d=Object(c.useValues)(Object(ne.a)(r)),a=d.isSkewed,l=d.steps,j=d.correlationFeedbackHidden,m=d.correlationDetailedFeedbackVisible,f=d.correlationFeedbackRating,b=d.correlationAnalysisAvailable,p=d.aggregationTargetLabel,u=Object(c.useActions)(Object(ne.a)(r)),x=u.sendCorrelationAnalysisFeedback,y=u.hideSkewWarning,P=u.hideCorrelationAnalysisFeedback,_=u.setCorrelationFeedbackRating,R=u.setCorrelationDetailedFeedback,U=Object(c.useValues)(Zn.a),z=U.preflight,A=Object(le.useRef)(null);return l.length<=1?null:!b&&!(z!=null&&(n=z.instance_preferences)!==null&&n!==void 0&&n.disable_paid_fs)?Object(e.jsx)(Qn.a,{identifier:i.e.CORRELATION_ANALYSIS,title:"Get a deeper understanding of why your ".concat(p.plural," are not converting"),caption:"Correlation analysis automatically finds signals for why ".concat(p.plural," are converting or dropping off.")}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h2",{style:{margin:"1rem 0"},children:"Correlation analysis"}),Object(e.jsxs)("div",{className:"funnel-correlation",children:[a&&Object(e.jsxs)(pe.a,{className:"skew-warning",children:[Object(e.jsxs)("h4",{children:[Object(e.jsx)(H.IconFeedbackWarning,{style:{fontSize:24,marginRight:4,color:"var(--warning)"}})," ","Adjust your funnel definition to improve correlation analysis",Object(e.jsx)(Xn.a,{className:"close-button",onClick:y})]}),Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:"Tips for adjusting your funnel:"}),Object(e.jsxs)("ol",{children:[Object(e.jsx)("li",{children:"Adjust your first funnel step to be more specific. For example, choose a page or an event that occurs less frequently."}),Object(e.jsx)("li",{children:"Choose an event that happens more frequently for subsequent funnels steps."})]})]})]}),Object(e.jsx)(js,{}),!j&&Object(e.jsxs)("div",{className:"border rounded p-4 space-y-2 mt-4",children:[Object(e.jsxs)("div",{className:"flex items-center justify-between",children:[Object(e.jsxs)("h4",{className:"text-muted-alt",children:[Object(e.jsx)(Gn.a,{style:{marginRight:4}}),"Was this correlation analysis report useful?"]}),Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[!!f&&Object(e.jsx)("i",{className:"text-success mr-2",children:"Thanks for your feedback!"}),[[5,"\u{1F60D}"],[4,"\u{1F600}"],[3,"\u{1F634}"],[2,"\u{1F614}"],[1,"\u{1F44E}"]].map(function(v,g){return Object(e.jsx)(q.LemonButton,{active:f===v[0],onClick:function(){f===v[0]?_(0):(_(v[0]),setTimeout(function(){var V;return(V=A.current)===null||V===void 0?void 0:V.focus()},100))},children:v[1]},g)}),Object(e.jsx)(q.LemonButton,{icon:Object(e.jsx)(H.IconClose,{}),onClick:P,status:"stealth"})]})]}),m?Object(e.jsx)(e.Fragment,{children:Object(e.jsxs)("form",{onSubmit:x,className:"space-y-2",children:[Object(e.jsx)(q.LemonTextArea,{onBlur:function(g){return R(g.target.value)},placeholder:"Optional. Help us by sharing details around your experience...",ref:A,onPressCmdEnter:function(){var g;(g=A.current)===null||g===void 0||g.blur(),x()}}),Object(e.jsx)("div",{className:"flex justify-end",children:Object(e.jsx)(q.LemonButton,{"data-attr":"correlation-analysis-share-feedback",type:"primary",htmlType:"submit",children:"Share feedback"})})]})}):null]}),Object(e.jsx)(bs,{})]})]})},vs=t("./frontend/src/scenes/funnels/Funnel.tsx");function hs(){var s=Object(c.useValues)(D.c),n=s.insightProps,o=Object(c.useValues)(Object(ne.a)(n)),r=o.isValidFunnel,d=o.insightLoading,a=o.areFiltersValid,l=r&&a||d;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)("div",{className:Object(ft.a)("funnel-insights-container",{"non-empty-state":l}),children:Object(e.jsx)(vs.a,{})})})}var Os=t("./frontend/src/lib/components/ExportButton/ExportButton.tsx"),gs=t("./frontend/src/lib/components/AlertMessage/index.ts"),Ae,nn=(Ae={},k()(Ae,"".concat(i.F.TRENDS),Object(e.jsx)(Ve,{view:i.F.TRENDS})),k()(Ae,"".concat(i.F.STICKINESS),Object(e.jsx)(Ve,{view:i.F.STICKINESS})),k()(Ae,"".concat(i.F.LIFECYCLE),Object(e.jsx)(Ve,{view:i.F.LIFECYCLE})),k()(Ae,"".concat(i.F.FUNNELS),Object(e.jsx)(hs,{})),k()(Ae,"".concat(i.F.RETENTION),Object(e.jsx)(Vn.a,{})),k()(Ae,"".concat(i.F.PATHS),Object(e.jsx)(Bn.a,{})),Ae);function it(s){var n=s.disableHeader,o=s.disableTable,r=s.disableCorrelationTable,d=s.disableLastComputation,a=s.insightMode,l=Object(c.useValues)(D.c),j=l.insightProps,m=l.canEditInsight,f=l.insightLoading,b=l.activeView,p=l.loadedView,u=l.filters,x=l.showTimeoutMessage,y=l.showErrorMessage,P=l.exporterResourceParams,_=l.isUsingSessionAnalysis,R=Object(c.useValues)(Object(ne.a)(j)),U=R.areFiltersValid,z=R.isValidFunnel,A=R.areExclusionFiltersValid,v=R.correlationAnalysisAvailable,g=function(){if(b!==p||f&&!x)return Object(e.jsx)("div",{className:"text-center",children:Object(e.jsx)(Yn.a,{type:Hn.a.LaptopHog})});if(p===i.F.FUNNELS){if(!U)return Object(e.jsx)(We.b,{actionable:a===i.G.Edit||o});if(!A)return Object(e.jsx)(We.a,{});if(!z&&!f)return Object(e.jsx)(We.c,{})}return y?Object(e.jsx)(We.d,{}):x?Object(e.jsx)(We.e,{isLoading:f}):null}();function I(){return Object(T.e)(u)&&!y&&!x&&U&&z&&u.funnel_viz_type===i.B.Steps&&!o?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h2",{className:"my-4 mx-0",children:"Detailed results"}),Object(e.jsx)($n,{})]}):Object(T.j)(u)&&(!u.display||(u==null?void 0:u.display)!==i.k.ActionsTable&&(u==null?void 0:u.display)!==i.k.ActionsBarValue)&&!o?Object(e.jsxs)(e.Fragment,{children:[P&&Object(e.jsxs)("div",{className:"flex items-center justify-between my-4 mx-0",children:[Object(e.jsx)("h2",{className:"m-0",children:"Detailed results"}),Object(e.jsx)(te.a,{title:"Export this table in CSV format",placement:"left",children:Object(e.jsx)(Os.a,{type:"secondary",status:"primary",items:[{export_format:i.t.CSV,export_context:P}]})})]}),Object(e.jsx)(c.BindLogic,{logic:Ne.a,props:j,children:Object(e.jsx)(kt.b,{isLegend:!0,filterKey:Object(T.j)(u)?"trends_".concat(b):"",canEditSeriesNameInline:Object(T.j)(u)&&!u.formula&&a===i.G.Edit,canCheckUncheckSeries:m})})]}):null}return Object(e.jsxs)(e.Fragment,{children:[_?Object(e.jsx)("div",{className:"mb-4",children:Object(e.jsxs)(gs.a,{type:"info",children:["When using sessions and session properties, events without session IDs will be excluded from the set of results."," ",Object(e.jsx)("a",{href:"https://posthog.com/docs/user-guides/sessions",children:"Learn more about sessions."})]})}):null,Object(e.jsx)(pe.a,{title:n?null:Object(e.jsx)(st,{activeView:b,insightMode:a||i.G.View,filters:u,disableTable:!!o}),"data-attr":"insights-graph",className:"insights-graph-container",children:Object(e.jsxs)("div",{children:[Object(e.jsxs)(re.a,{className:Object(ft.a)("insights-graph-header",{funnels:Object(T.e)(u)}),align:"middle",justify:"space-between",children:[!d&&Object(e.jsx)(ce.a,{children:Object(e.jsx)(Dn,{})}),Object(e.jsxs)(ce.a,{children:[Object(T.e)(u)?Object(e.jsx)(An,{}):null,Object(T.g)(u)?Object(e.jsx)(Kn,{}):null,Object(e.jsx)(zt.b,{})]})]}),g||(Object(T.c)(u)&&u.show_legend?Object(e.jsxs)(re.a,{className:"insights-graph-container-row",wrap:!1,children:[Object(e.jsx)(ce.a,{className:"insights-graph-container-row-left",children:nn[b]}),Object(e.jsx)(ce.a,{className:"insights-graph-container-row-right",children:Object(e.jsx)(zt.a,{})})]}):nn[b])]})}),I(),!r&&v&&b===i.F.FUNNELS&&Object(e.jsx)(ps,{})]})}try{it.displayName="InsightContainer",it.__docgenInfo={description:"",displayName:"InsightContainer",props:{disableHeader:{defaultValue:null,description:"",name:"disableHeader",required:!1,type:{name:"boolean"}},disableTable:{defaultValue:null,description:"",name:"disableTable",required:!1,type:{name:"boolean"}},disableCorrelationTable:{defaultValue:null,description:"",name:"disableCorrelationTable",required:!1,type:{name:"boolean"}},disableLastComputation:{defaultValue:null,description:"",name:"disableLastComputation",required:!1,type:{name:"boolean"}},insightMode:{defaultValue:null,description:"",name:"insightMode",required:!1,type:{name:"enum",value:[{value:'"edit"'},{value:'"view"'},{value:'"subscriptions"'},{value:'"sharing"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightContainer.tsx#InsightContainer"]={docgenInfo:it.__docgenInfo,name:"InsightContainer",path:"frontend/src/scenes/insights/InsightContainer.tsx#InsightContainer"})}catch(s){}},"./frontend/src/scenes/insights/filters/InsightDateFilter/insightDateFilterLogic.ts":function(Q,B,t){"use strict";t.d(B,"a",function(){return Pe});var Z=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=t.n(Z),pe=t("./node_modules/core-js/modules/es.array.iterator.js"),re=t.n(pe),ce=t("./node_modules/core-js/modules/es.object.to-string.js"),Ue=t.n(ce),_e=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),c=t.n(_e),ve=t("./node_modules/core-js/modules/es.object.keys.js"),H=t.n(ve),i=t("./node_modules/core-js/modules/es.symbol.js"),D=t.n(i),q=t("./node_modules/core-js/modules/es.array.filter.js"),T=t.n(q),e=t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),oe=t.n(e),he=t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Re=t.n(he),Oe=t("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),je=t.n(Oe),Ce=t("./node_modules/kea/lib/index.esm.js"),Fe=t("./frontend/src/scenes/insights/insightLogic.ts"),ge=t("./frontend/src/scenes/insights/sharedUtils.ts");function de(K,G){var O=Object.keys(K);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(K);G&&(E=E.filter(function($){return Object.getOwnPropertyDescriptor(K,$).enumerable})),O.push.apply(O,E)}return O}function xe(K){for(var G=1;G<arguments.length;G++){var O=arguments[G]!=null?arguments[G]:{};G%2?de(Object(O),!0).forEach(function(E){k()(K,E,O[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(K,Object.getOwnPropertyDescriptors(O)):de(Object(O)).forEach(function(E){Object.defineProperty(K,E,Object.getOwnPropertyDescriptor(O,E))})}return K}var Pe=Object(Ce.kea)({props:{},key:Object(ge.l)("new"),path:function(G){return["scenes","insights","InsightDateFilter","insightDateFilterLogic",G]},connect:function(G){return{actions:[Object(Fe.c)(G),["setFilters"]],values:[Object(Fe.c)(G),["filters"]]}},actions:function(){return{setDates:function(O,E){return{dateFrom:O,dateTo:E}}}},selectors:{dates:[function(K){return[K.filters]},function(K){return{dateFrom:(K==null?void 0:K.date_from)||null,dateTo:(K==null?void 0:K.date_to)||null}}]},listeners:function(G){var O=G.actions,E=G.values;return{setDates:function(J){var ue=J.dateFrom,Me=J.dateTo;O.setFilters(xe(xe({},E.filters),{},{date_from:ue||null,date_to:Me||null}))}}}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/lib/components/InlineMessage/InlineMessage.scss":function(Q,B,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");B=Z(!1),B.push([Q.i,".inline-message{background-color:var(--bg-mid);border-radius:var(--radius);padding:.5rem 1rem;font-weight:var(--font-medium);display:flex;align-items:center;color:var(--primary-alt)}.inline-message.danger{background-color:var(--danger-highlight);color:var(--danger)}.inline-message.closable{padding-right:.5rem}.inline-message.hidden{display:none}.inline-message .inline-icon{margin-right:6px;display:flex;align-items:center}.inline-message .inline-main{flex-grow:1}.inline-message .closable{color:var(--muted);align-self:flex-start;padding-left:1rem;cursor:pointer}",""]),Q.exports=B},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/funnels/FunnelCanvasLabel.scss":function(Q,B,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");B=Z(!1),B.push([Q.i,".insights-graph-header.funnels{border-bottom:1px solid var(--border)}.insights-graph-header.funnels .funnel-canvas-label .ant-btn-link{padding:0}.insights-graph-header.funnels .funnel-canvas-label .ant-btn-link:disabled{cursor:default;color:var(--default)}.insights-graph-header.funnels .funnel-canvas-label .funnel-options-label{padding:4px}.insights-graph-header.funnels .funnel-canvas-label .funnel-options-inputs{align-items:center;padding:4px}",""]),Q.exports=B},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/CorrelationMatrix.scss":function(Q,B,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");B=Z(!1),B.push([Q.i,".correlation-matrix .ant-modal-body{display:flex;justify-content:center}.correlation-matrix .correlation-table-wrapper table{border-radius:var(--radius);border:1px solid var(--border);border-collapse:separate;border-spacing:0;margin:0 auto}.correlation-matrix .correlation-table-wrapper table td{padding:.5rem 1rem;border-left:1px solid var(--border);border-top:1px solid var(--border);text-align:center}.correlation-matrix .correlation-table-wrapper table td .percentage{font-weight:700;padding-bottom:.25rem}.correlation-matrix .correlation-table-wrapper table td:first-child{border-left:none}.correlation-matrix .correlation-table-wrapper table .table-title{color:var(--muted-alt)}.correlation-matrix .correlation-table-wrapper table .table-title td{border-top:none}.correlation-matrix .correlation-table-wrapper table .horizontal-header,.correlation-matrix .correlation-table-wrapper table thead{font-weight:700;background-color:var(--antd-table-background-dark);text-transform:uppercase;color:var(--muted)}.correlation-matrix .correlation-table-wrapper table tbody td:not(.horizontal-header){text-align:right}",""]),Q.exports=B},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/FunnelCorrelation.scss":function(Q,B,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");B=Z(!1),B.push([Q.i,".funnel-correlation{margin-bottom:3rem}.funnel-correlation .skew-warning{margin-top:1rem;line-height:2em;border:1px solid var(--warning)}.funnel-correlation .skew-warning .ant-card-body{padding:.5rem 1rem}.funnel-correlation .skew-warning h4{font-size:1.1em;display:flex;align-items:center;border-bottom:1px solid var(--border);padding:.5rem 1rem;margin-left:-1rem;margin-right:-1rem;position:relative}.funnel-correlation .skew-warning h4 .close-button{position:absolute;right:16px;color:var(--muted)!important;cursor:pointer}.funnel-correlation .skew-warning b{padding-bottom:.5rem;font-weight:var(--font-medium)}",""]),Q.exports=B},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/FunnelCorrelationTable.scss":function(Q,B,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");B=Z(!1),B.push([Q.i,".funnel-correlation-table{margin-top:1rem;border:1px solid var(--border);border-radius:var(--radius)}.funnel-correlation-table .ant-table thead th{border-bottom:1px solid var(--border)}.funnel-correlation-table .funnel-correlation-header{background:#f2f2f2;display:flex;align-self:stretch;justify-content:space-between;align-content:space-between;border-top-left-radius:var(--radius);border-top-right-radius:var(--radius);padding-bottom:5px}.funnel-correlation-table .funnel-correlation-header .table-header{font-style:normal;font-weight:700;font-size:11px;line-height:16px;padding-bottom:4px;display:flex;align-items:center;letter-spacing:.02em;text-transform:uppercase;color:var(--default);margin-left:1rem;margin-top:.5rem}.funnel-correlation-table .funnel-correlation-header .table-options{display:flex;flex-grow:1;justify-content:flex-end;align-items:center;margin-top:5px}.funnel-correlation-table .funnel-correlation-header .table-options .title{font-family:Inter;font-style:normal;font-weight:600;font-size:11px;line-height:16px;display:flex;align-items:center;letter-spacing:.02em;text-transform:uppercase;margin:5px;color:rgba(0,0,0,.5)}.funnel-correlation-table .column-info{color:var(--muted-alt);cursor:pointer;padding-left:4px}.funnel-correlation-table .nested-properties-table{margin:1rem;border:1px solid var(--border);border-radius:var(--radius)}.funnel-correlation-table .nested-properties-table thead th{border-bottom:1px solid var(--border)}.funnel-correlation-table .nested-properties-loading{text-align:center;padding:2rem 0}.funnel-correlation-table .nested-properties-loading h3{font-size:1rem;font-weight:700;margin-bottom:0}.funnel-correlation-table .nested-properties-loading h3 p{color:var(--muted-alt)}",""]),Q.exports=B}}]);
