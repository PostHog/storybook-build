(window.webpackJsonp=window.webpackJsonp||[]).push([[232],{"./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx":function(p,d,e){"use strict";e.d(d,"a",function(){return R});var D=e("./node_modules/core-js/modules/es.array.index-of.js"),de=e("./node_modules/core-js/modules/es.regexp.exec.js"),X=e("./node_modules/core-js/modules/es.string.match.js"),Z=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),I=e.n(Z),o=e("./node_modules/react/index.js"),s=e.n(o),w=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),S=e.n(w),B=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.scss"),j=e.n(B),W={};W.insert="head",W.singleton=!1;var ie=S()(j.a,W),ce=j.a.locals||{},z=e("./node_modules/clsx/dist/clsx.m.js"),N=e("./node_modules/kea/lib/index.esm.js"),M=e("./frontend/src/lib/components/LemonTable/index.ts"),k=e("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),F=e("./node_modules/@ant-design/icons/es/icons/CheckCircleFilled.js"),H=e("./node_modules/@ant-design/icons/es/icons/PlusOutlined.js"),$=e("./node_modules/@ant-design/icons/es/icons/EditOutlined.js"),q=e("./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js"),O=e("./frontend/src/lib/components/LemonButton/index.ts"),v=e("./node_modules/antd/es/input/index.js"),g=e("./node_modules/antd/es/button/index.js"),L=e("./frontend/src/scenes/toolbar-launch/authorizedUrlsLogic.ts"),C=e("./frontend/src/lib/utils.tsx"),ve=e("./frontend/src/lib/components/LemonButton/More.tsx");function R(ee){var te=ee.pageKey,ge=ee.actionId,ne=Object(L.c)({actionId:ge}),A=Object(N.useValues)(ne),me=A.appUrlsKeyed,G=A.suggestionsLoading,re=A.searchTerm,U=A.launchUrl,V=A.appUrls,pe=A.editUrlIndex,y=Object(N.useActions)(ne),Y=y.addUrl,se=y.removeUrl,b=y.setSearchTerm,_e=y.updateUrl,fe=y.newUrl,he=y.setEditUrlIndex,K=[{title:"URLs",dataIndex:"url",key:"url",render:function(x,u){var oe=Object(o.useState)(u.url),P=I()(oe,2),f=P[0],J=P[1],Q=Object(o.useState)(""),le=I()(Q,2),l=le[0],r=le[1];Object(o.useEffect)(function(){return J(u.url)},[u]);var t=function(){if(r(""),f===L.a&&se(u.originalIndex),f.indexOf("*")>-1&&!f.match(/^(.*)\*[^\*]*\.[^\*]+\.[^\*]+$/)){r("You can only wildcard subdomains. If you wildcard the domain or TLD, people might be able to gain access to your PostHog data.");return}if(!Object(C.ab)(f)){r("Please type a valid URL or domain.");return}if(V.indexOf(f)>-1&&V.indexOf(f,u.originalIndex)!==u.originalIndex&&V.indexOf(f,u.originalIndex+1)!==u.originalIndex){r("This URL is already registered.");return}_e(u.originalIndex,f)};return u.type==="suggestion"||x!==L.a&&pe!==u.originalIndex?s.a.createElement("div",{className:Object(z.a)("authorized-url-col",u.type)},u.type==="authorized"&&s.a.createElement(F.a,{style:{marginRight:4}}),x,u.type==="suggestion"&&s.a.createElement(k.a,null,"Suggestion")):s.a.createElement("div",null,s.a.createElement("div",{style:{display:"flex"}},s.a.createElement(v.a,{value:f,onChange:function(a){return J(a.target.value)},onPressEnter:t,autoFocus:!0,placeholder:"Enter a URL or wildcard subdomain (e.g. https://*.posthog.com)"}),s.a.createElement(g.a,{type:"primary",onClick:t},"Save")),l&&s.a.createElement("span",{className:"text-small text-danger"},l))}},{title:"",key:"actions",render:function(x,u,oe){return s.a.createElement("div",{className:"actions-col"},u.type==="suggestion"?s.a.createElement(O.a,{type:"default",onClick:function(){return Y(u.url)}},s.a.createElement(H.a,null)," Add as authorized"):s.a.createElement(s.a.Fragment,null,s.a.createElement("a",{href:U(u.url),style:{marginRight:4}},s.a.createElement(O.a,{type:"highlighted"},"Launch toolbar")),s.a.createElement(ve.a,{overlay:s.a.createElement(s.a.Fragment,null,s.a.createElement(O.a,{fullWidth:!0,type:"stealth",onClick:function(){return he(u.originalIndex)}},s.a.createElement($.a,{style:{marginRight:4}}),"Edit authorized URL"),s.a.createElement(O.a,{fullWidth:!0,style:{color:"var(--danger)"},type:"stealth",onClick:function(){return se(oe)}},s.a.createElement(q.a,{style:{marginRight:4}}),"Remove authorized URL"))})))}}];return s.a.createElement("div",null,s.a.createElement("div",{className:"flex-center mb"},s.a.createElement("div",{style:{flexGrow:1}},s.a.createElement(v.a.Search,{allowClear:!0,enterButton:!0,placeholder:"Search for authorized URLs",style:{maxWidth:480},value:re,onChange:function(x){b(x.target.value)},autoFocus:te==="toolbar-launch"&&!Object(C.U)()})),s.a.createElement(g.a,{type:"primary",icon:s.a.createElement(H.a,null),onClick:fe},"Add",te==="toolbar-launch"&&" authorized domain")),s.a.createElement(M.a,{className:"authorized-urls-table",columns:K,dataSource:me,emptyState:re?"There are no authorized URLs that match your search.":"There are no authorized URLs or domains. Add one to get started.",loading:G}))}try{R.displayName="AuthorizedUrlsTable",R.__docgenInfo={description:"",displayName:"AuthorizedUrlsTable",props:{pageKey:{defaultValue:null,description:"",name:"pageKey",required:!1,type:{name:"string"}},actionId:{defaultValue:null,description:"",name:"actionId",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx#AuthorizedUrlsTable"]={docgenInfo:R.__docgenInfo,name:"AuthorizedUrlsTable",path:"frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx#AuthorizedUrlsTable"})}catch(ee){}},"./frontend/src/scenes/toolbar-launch/ToolbarLaunch.tsx":function(p,d,e){"use strict";e.r(d),e.d(d,"scene",function(){return $});var D=e("./node_modules/core-js/modules/es.array.map.js"),de=e("./node_modules/@babel/runtime/helpers/extends.js"),X=e.n(de),Z=e("./frontend/src/lib/components/PageHeader.tsx"),I=e("./node_modules/react/index.js"),o=e.n(I),s=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),w=e.n(s),S=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/ToolbarLaunch.scss"),B=e.n(S),j={};j.insert="head",j.singleton=!1;var W=w()(B.a,j),ie=B.a.locals||{},ce=e("./node_modules/@ant-design/icons/es/icons/SearchOutlined.js"),z=e("./frontend/src/lib/components/Link.tsx"),N=e("./frontend/src/scenes/urls.ts"),M=e("./frontend/src/lib/components/icons.tsx"),k=e("./node_modules/antd/es/row/index.js"),F=e("./node_modules/antd/es/col/index.js"),H=e("./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx"),$={component:q};function q(){var v=[{title:"Heatmaps",caption:"Understand where your users interact the most.",icon:o.a.createElement(M.IconHeatmap,null)},{title:"Actions",caption:"Create actions visually from elements in your website.",icon:o.a.createElement(M.IconGroupedEvents,null)},{title:"Feature Flags",caption:"Toggle feature flags on/off right on your app.",icon:o.a.createElement(M.IconFlag,null)},{title:"Inspect",caption:"Inspect clickable elements on your website.",icon:o.a.createElement(ce.a,null)}];return o.a.createElement("div",{className:"toolbar-launch-page"},o.a.createElement(Z.a,{title:"Toolbar",caption:"The toolbar launches PostHog right in your app or website."}),o.a.createElement(H.a,{pageKey:"toolbar-launch"}),o.a.createElement("div",{className:"footer-caption"},"Make sure you're using the ",o.a.createElement(z.a,{to:"".concat(N.a.projectSettings(),"#snippet")},"HTML snippet")," or the latest ",o.a.createElement("code",null,"posthog-js")," version."),o.a.createElement(k.a,{className:"feature-highlight-list"},v.map(function(g){return o.a.createElement(O,X()({key:g.title},g))})))}function O(v){var g=v.title,L=v.caption,C=v.icon;return o.a.createElement(F.a,{sm:12,className:"fh-item"},o.a.createElement("div",{className:"fh-icon"},C),o.a.createElement("div",null,o.a.createElement("h4",null,g),o.a.createElement("div",{className:"caption"},L)))}},"./frontend/src/scenes/toolbar-launch/authorizedUrlsLogic.ts":function(p,d,e){"use strict";e.d(d,"b",function(){return J}),e.d(d,"a",function(){return Q}),e.d(d,"c",function(){return le});var D=e("./node_modules/core-js/modules/es.array.concat.js"),de=e.n(D),X=e("./node_modules/core-js/modules/es.array.filter.js"),Z=e.n(X),I=e("./node_modules/core-js/modules/es.array.includes.js"),o=e.n(I),s=e("./node_modules/core-js/modules/es.array.index-of.js"),w=e.n(s),S=e("./node_modules/core-js/modules/es.array.iterator.js"),B=e.n(S),j=e("./node_modules/core-js/modules/es.array.map.js"),W=e.n(j),ie=e("./node_modules/core-js/modules/es.array.slice.js"),ce=e.n(ie),z=e("./node_modules/core-js/modules/es.array.splice.js"),N=e.n(z),M=e("./node_modules/core-js/modules/es.object.assign.js"),k=e.n(M),F=e("./node_modules/core-js/modules/es.object.to-string.js"),H=e.n(F),$=e("./node_modules/core-js/modules/es.regexp.exec.js"),q=e.n($),O=e("./node_modules/core-js/modules/es.regexp.to-string.js"),v=e.n(O),g=e("./node_modules/core-js/modules/es.string.includes.js"),L=e.n(g),C=e("./node_modules/core-js/modules/es.string.iterator.js"),ve=e.n(C),R=e("./node_modules/core-js/modules/es.string.search.js"),ee=e.n(R),te=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),ge=e.n(te),ne=e("./node_modules/core-js/modules/web.url.js"),A=e.n(ne),me=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),G=e.n(me),re=e("./node_modules/@babel/runtime/regenerator/index.js"),U=e.n(re),V=e("./node_modules/regenerator-runtime/runtime.js"),pe=e.n(V),y=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),Y=e.n(y),se=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=e.n(se),_e=e("./node_modules/kea/lib/index.esm.js"),fe=e("./frontend/src/lib/api.ts"),he=e("./frontend/src/lib/utils.tsx"),K=e("./frontend/src/scenes/teamLogic.ts"),ae=e("./frontend/src/lib/dayjs.ts"),x=e("./node_modules/fuse.js/dist/fuse.esm.js"),u=e("./node_modules/kea-router/lib/index.js"),oe=e.n(u);function P(l,r){var t=Object.keys(l);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(l);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(l,a).enumerable})),t.push.apply(t,n)}return t}function f(l){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?P(Object(t),!0).forEach(function(n){b()(l,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(t)):P(Object(t)).forEach(function(n){Object.defineProperty(l,n,Object.getOwnPropertyDescriptor(t,n))})}return l}function J(l,r,t){var n=f(f({userIntent:t?void 0:r?"edit-action":"add-action"},r?{actionId:r}:{}),l?{appUrl:l}:{});return"/api/user/redirect_to_site/"+Object(u.encodeParams)(n,"?")}var Q="https://",le=Object(_e.kea)({path:function(r){return["lib","components","AppEditorLink","appUrlsLogic",r]},key:function(r){return"".concat(r.pageKey).concat(r.actionId)||"global"},props:{},connect:{values:[K.a,["currentTeam","currentTeamId"]],actions:[K.a,["updateCurrentTeam"]]},actions:function(){return{setAppUrls:function(t){return{appUrls:t}},addUrl:function(t,n){return{url:t,launch:n}},newUrl:!0,removeUrl:function(t){return{index:t}},updateUrl:function(t,n){return{index:t,url:n}},launchAtUrl:function(t){return{url:t}},setSearchTerm:function(t){return{term:t}},setEditUrlIndex:function(t){return{originalIndex:t}}}},loaders:function(r){var t=r.values;return{suggestions:{__default:[],loadSuggestions:function(){var n=Y()(U.a.mark(function c(){var h,i,m,E;return U.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return i={events:[{id:"$pageview",name:"$pageview",type:"events"}],breakdown:"$current_url",date_from:Object(ae.a)().subtract(3,"days").toISOString()},_.next=3,fe.a.get("api/projects/".concat(t.currentTeamId,"/insights/trend/?").concat(Object(he.xb)(i)));case 3:if(m=_.sent.result,!(m&&((h=m[0])===null||h===void 0?void 0:h.count)===0)){_.next=6;break}return _.abrupt("return",[]);case 6:return E=[],_.abrupt("return",(m||[]).filter(function(T){if(!T.breakdown_value)return!1;try{var Ee=new URL(T.breakdown_value.toString()).hostname;return E.indexOf(Ee)>-1||t.appUrls.filter(function(je){return je.indexOf(Ee)>-1}).length>0?void 0:(E.push(Ee),!0)}catch(je){return!1}}).map(function(T){return T.breakdown_value}).slice(0,20));case 8:case"end":return _.stop()}},c)}));function a(){return n.apply(this,arguments)}return a}()}}},events:function(r){var t=r.actions,n=r.values;return{afterMount:function(){t.loadSuggestions(),n.currentTeam&&t.setAppUrls(n.currentTeam.app_urls)}}},reducers:function(){return{appUrls:[[],{setAppUrls:function(t,n){var a=n.appUrls;return a},addUrl:function(t,n){var a=n.url;return t.concat([a])},newUrl:function(t){return t.includes(Q)?t:[Q].concat(t)},updateUrl:function(t,n){var a=n.index,c=n.url;return Object.assign(G()(t),b()({},a,c))},removeUrl:function(t,n){var a=n.index,c=G()(t);return c.splice(a,1),c}}],suggestions:[[],{addUrl:function(t,n){var a=n.url;return G()(t).filter(function(c){return a!==c})}}],searchTerm:["",{setSearchTerm:function(t,n){var a=n.term;return a}}],editUrlIndex:[null,{setEditUrlIndex:function(t,n){var a=n.originalIndex;return a},removeUrl:function(t,n){var a=n.index;return t&&a<t?t-1:a===t?null:t}}]}},listeners:function(r){var t,n=r.sharedListeners,a=r.values,c=r.actions;return t={addUrl:[n.saveAppUrls,function(){var h=Y()(U.a.mark(function i(m){var E,ue;return U.a.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:E=m.url,ue=m.launch,ue&&c.launchAtUrl(E);case 2:case"end":return T.stop()}},i)}));return function(i){return h.apply(this,arguments)}}()],removeUrl:n.saveAppUrls,updateUrl:[n.saveAppUrls,function(){return c.setEditUrlIndex(null)}]},b()(t,K.a.actionTypes.loadCurrentTeamSuccess,function(){var h=Y()(U.a.mark(function i(m){var E;return U.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:E=m.currentTeam,E&&c.setAppUrls(E.app_urls);case 2:case"end":return _.stop()}},i)}));return function(i){return h.apply(this,arguments)}}()),b()(t,"launchAtUrl",function(i){var m=i.url;window.location.href=a.launchUrl(m)}),t},sharedListeners:function(r){var t=r.values;return{saveAppUrls:function(){K.a.actions.updateCurrentTeam({app_urls:t.appUrls})}}},selectors:function(r){var t=r.props;return{appUrlsKeyed:[function(n){return[n.appUrls,n.suggestions,n.searchTerm]},function(n,a,c){var h=n.map(function(i,m){return{url:i,type:"authorized",originalIndex:m}}).concat(a.map(function(i,m){return{url:i,type:"suggestion",originalIndex:m}}));return c?new x.a(h,{keys:["url"],threshold:.3}).search(c).map(function(i){return i.item}):h}],launchUrl:[function(){return[]},function(){return function(n){return J(n,t.actionId,!t.actionId)}}]}}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.scss":function(p,d,e){var D=e("./node_modules/css-loader/dist/runtime/api.js");d=D(!1),d.push([p.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.authorized-urls-table .authorized-url-col{display:flex;align-items:center}.authorized-urls-table .authorized-url-col .lemon-tag{margin-left:4px}.authorized-urls-table .authorized-url-col.suggestion{color:#747ea1}.authorized-urls-table .authorized-url-col.authorized{color:var(--success)}.authorized-urls-table .actions-col{display:flex;align-items:center;justify-content:flex-end}",""]),p.exports=d},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/ToolbarLaunch.scss":function(p,d,e){var D=e("./node_modules/css-loader/dist/runtime/api.js");d=D(!1),d.push([p.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.toolbar-launch-page{margin-bottom:48px}.toolbar-launch-page .footer-caption{text-align:center;color:var(--muted);margin-top:1rem}.toolbar-launch-page .feature-highlight-list{max-width:800px;margin:2rem auto 0}.toolbar-launch-page .feature-highlight-list .fh-item{display:flex;align-items:center;margin-top:1rem}.toolbar-launch-page .feature-highlight-list .fh-item .fh-icon{color:#747ea1;margin-right:8px;font-size:1.6em}.toolbar-launch-page .feature-highlight-list .fh-item h4{color:#747ea1;margin-bottom:0;font-size:1.2em}",""]),p.exports=d}}]);
