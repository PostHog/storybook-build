var xn=Object.defineProperty,jn=Object.defineProperties;var fn=Object.getOwnPropertyDescriptors;var kt=Object.getOwnPropertySymbols;var gn=Object.prototype.hasOwnProperty,hn=Object.prototype.propertyIsEnumerable;var Rt=(V,_,c)=>_ in V?xn(V,_,{enumerable:!0,configurable:!0,writable:!0,value:c}):V[_]=c,j=(V,_)=>{for(var c in _||(_={}))gn.call(_,c)&&Rt(V,c,_[c]);if(kt)for(var c of kt(_))hn.call(_,c)&&Rt(V,c,_[c]);return V},M=(V,_)=>jn(V,fn(_));var I=(V,_,c)=>new Promise((ie,x)=>{var g=J=>{try{ae(c.next(J))}catch(ve){x(ve)}},be=J=>{try{ae(c.throw(J))}catch(ve){x(ve)}},ae=J=>J.done?ie(J.value):Promise.resolve(J.value).then(g,be);ae((c=c.apply(V,_)).next())});(window.webpackJsonp=window.webpackJsonp||[]).push([[295],{"./frontend/src/scenes/experiments/Experiment.tsx":function(V,_,c){"use strict";c.r(_),c.d(_,"scene",function(){return Xt}),c.d(_,"Experiment",function(){return Nt});var ie=c("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/skeleton/index.js"),x=c("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/col/index.js"),g=c("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/row/index.js"),be=c("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/tooltip/index.js"),ae=c("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/card/index.js"),J=c("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/tag/index.js"),ve=c("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/popconfirm/index.js"),ct=c("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/collapse/index.js"),dt=c("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/progress/index.js"),b=c("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),pt=c("./frontend/src/lib/components/PageHeader.tsx"),$t=c("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),mt=c("./frontend/src/lib/components/PropertyFilters/utils.ts"),O=c("./frontend/src/lib/components/TaxonomicFilter/types.ts"),je=c("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),_e=c("./frontend/src/scenes/funnels/funnelLogic.ts"),fe=c("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilter.tsx"),ye=c("./frontend/src/scenes/insights/insightLogic.ts"),u=c("./frontend/src/types.ts"),Lt=c("./node_modules/.pnpm/style-loader@2.0.0_webpack@4.46.0/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),At=c.n(Lt),Pt=c("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/experiments/Experiment.scss"),ut=c.n(Pt),Ge={};Ge.insert="head",Ge.singleton=!1;var bn=At()(ut.a,Ge),vn=ut.a.locals||{},X=c("./frontend/src/lib/api.ts"),N=c("./frontend/src/lib/dayjs.ts"),Ce=c("./frontend/src/scenes/insights/utils/cleanFilters.ts"),We=c("./frontend/src/scenes/teamLogic.tsx"),ee=c("./frontend/src/scenes/urls.ts"),ge=c("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.0/node_modules/kea-router/lib/index.js"),xt=c("./frontend/src/scenes/experiments/experimentsLogic.ts"),Te=c("./frontend/src/lib/constants.tsx"),Me=c("./frontend/src/scenes/trends/trendsLogic.ts"),jt=c("./frontend/src/lib/utils/eventUsageLogic.ts"),Dt=c("./frontend/src/scenes/userLogic.ts"),ft=c("./frontend/src/lib/components/Tooltip.tsx"),Vt=c("./frontend/src/models/groupsModel.ts"),Ue=c("./frontend/src/lib/components/lemonToast.tsx"),$=c("./frontend/src/lib/utils.tsx"),se=c("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.0/node_modules/kea-forms/lib/index.js"),gt=c("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js"),T=c("./frontend/src/lib/components/icons.tsx"),e=c("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");const Oe=14,He={id:"new",name:"",feature_flag_key:"",filters:{},parameters:{feature_flag_variants:[{key:"control",rollout_percentage:50},{key:"test",rollout_percentage:50}]},secondary_metrics:[],created_at:"",created_by:null},te=Object(b.kea)([Object(b.props)({}),Object(b.key)(t=>t.experimentId||"new"),Object(b.path)(t=>["scenes","experiment","experimentLogic",t]),Object(b.connect)({values:[We.a,["currentTeamId"],Dt.a,["hasAvailableFeature"],Vt.a,["groupTypes","groupsTaxonomicTypes","aggregationLabel"]],actions:[xt.a,["updateExperiments","addToExperiments"],jt.e,["reportExperimentCreated","reportExperimentViewed","reportExperimentLaunched","reportExperimentCompleted","reportExperimentArchived","reportExperimentReset"]]}),Object(b.actions)({setExperiment:t=>({experiment:t}),createExperiment:(t,n,r)=>({draft:t,runningTime:n,sampleSize:r}),setExperimentInsightId:t=>({shortId:t}),createNewExperimentInsight:t=>({filters:t}),setFilters:t=>({filters:t}),removeExperimentGroup:t=>({idx:t}),setEditExperiment:t=>({editing:t}),setExperimentResultCalculationError:t=>({error:t}),setFlagImplementationWarning:t=>({warning:t}),setFlagAvailabilityWarning:t=>({warning:t}),setExposureAndSampleSize:(t,n)=>({exposure:t,sampleSize:n}),updateExperimentGoal:t=>({filters:t}),updateExperimentSecondaryMetrics:t=>({metrics:t}),launchExperiment:!0,endExperiment:!0,addExperimentGroup:!0,archiveExperiment:!0,resetRunningExperiment:!0,checkFlagImplementationWarning:!0,checkFlagAvailabilityWarning:!0,openExperimentGoalModal:!0,closeExperimentGoalModal:!0}),Object(b.reducers)({experiment:[j({},He),{setExperiment:(t,n)=>{let{experiment:r}=n;if(r.filters){const i=j(j({},t.filters),r.filters);return M(j(j({},t),r),{filters:i})}if(r.parameters){const i=j(j({},t==null?void 0:t.parameters),r.parameters);return M(j(j({},t),r),{parameters:i})}return j(j({},t),r)},addExperimentGroup:t=>{var n;if(t!=null&&(n=t.parameters)!==null&&n!==void 0&&n.feature_flag_variants){const r=ht(t.parameters.feature_flag_variants.length+1),i=t.parameters.feature_flag_variants.map((a,o)=>M(j({},a),{rollout_percentage:r[o]}));return M(j({},t),{parameters:M(j({},t.parameters),{feature_flag_variants:[...i,{key:`test_group_${t.parameters.feature_flag_variants.length}`,rollout_percentage:r[r.length-1]}]})})}return t},removeExperimentGroup:(t,n)=>{var r,i;let{idx:a}=n;if(!t)return t;const o=[...((r=t.parameters)===null||r===void 0?void 0:r.feature_flag_variants)||[]];o.splice(a,1);const l=ht(((t==null||(i=t.parameters)===null||i===void 0?void 0:i.feature_flag_variants)||[]).length-1),d=o.map((m,S)=>M(j({},m),{rollout_percentage:l[S]}));return M(j({},t),{parameters:M(j({},t.parameters),{feature_flag_variants:d})})}}],experimentInsightId:[null,{setExperimentInsightId:(t,n)=>{let{shortId:r}=n;return r}}],editingExistingExperiment:[!1,{setEditExperiment:(t,n)=>{let{editing:r}=n;return r}}],changingGoalMetric:[!1,{updateExperimentGoal:()=>!0,loadExperimentResults:()=>!1}],changingSecondaryMetrics:[!1,{updateExperimentSecondaryMetrics:()=>!0,loadSecondaryMetricResults:()=>!1}],experimentResultCalculationError:[null,{setExperimentResultCalculationError:(t,n)=>{let{error:r}=n;return r}}],flagImplementationWarning:[!1,{setFlagImplementationWarning:(t,n)=>{let{warning:r}=n;return r}}],flagAvailabilityWarning:[!1,{setFlagAvailabilityWarning:(t,n)=>{let{warning:r}=n;return r}}],exposureAndSampleSize:[{exposure:0,sampleSize:0},{setExposureAndSampleSize:(t,n)=>{let{exposure:r,sampleSize:i}=n;return{exposure:r,sampleSize:i}}}],isExperimentGoalModalOpen:[!1,{openExperimentGoalModal:()=>!0,closeExperimentGoalModal:()=>!1}]}),Object(b.listeners)(t=>{let{values:n,actions:r}=t;return{createExperiment:i=>I(this,null,function*(){var a;let{draft:o,runningTime:l,sampleSize:d}=i,m=null;const S=!!n.experimentId&&n.experimentId!=="new";try{if(S){var v,E;if(m=yield X.b.update(`api/projects/${n.currentTeamId}/experiments/${n.experimentId}`,j(M(j({},n.experiment),{parameters:M(j({},(v=n.experiment)===null||v===void 0?void 0:v.parameters),{recommended_running_time:l,recommended_sample_size:d})}),!o&&{start_date:Object(N.a)()})),(E=m)!==null&&E!==void 0&&E.id){r.updateExperiments(m),r.setEditExperiment(!1),r.setExperiment(m);return}}else{var s;m=yield X.b.create(`api/projects/${n.currentTeamId}/experiments`,j(M(j({},n.experiment),{parameters:M(j({},(s=n.experiment)===null||s===void 0?void 0:s.parameters),{recommended_running_time:l,recommended_sample_size:d})}),!o&&{start_date:Object(N.a)()})),m&&r.reportExperimentCreated(m)}}catch(R){Ue.d.error(R.detail||"Failed to create experiment");return}if((a=m)!==null&&a!==void 0&&a.id){const R=m.id;ge.router.actions.push(ee.a.experiment(R)),r.addToExperiments(m),Ue.d.success(`Experiment ${S?"updated":"created"}`,{button:{label:"View it",action:()=>{ge.router.actions.push(ee.a.experiment(R))}}})}}),createNewExperimentInsight:i=>I(this,null,function*(){let{filters:a}=i,o;(a==null?void 0:a.insight)===u.F.FUNNELS?o=Object(Ce.a)(j({insight:u.F.FUNNELS,funnel_viz_type:u.B.Steps,date_from:Object(N.a)().subtract(Oe,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(N.a)().endOf("d").format("YYYY-MM-DDTHH:mm"),layout:Te.k.horizontal},a)):o=Object(Ce.a)(j({insight:u.F.TRENDS,date_from:Object(N.a)().subtract(Oe,"day").format("YYYY-MM-DDTHH:mm"),date_to:Object(N.a)().endOf("d").format("YYYY-MM-DDTHH:mm")},a));const l={name:"",description:"",tags:[],filters:o,result:null},d=yield X.b.create(`api/projects/${n.currentTeamId}/insights`,l);r.setExperimentInsightId(d.short_id),r.setExperiment({filters:j({},l.filters)})}),setFilters:i=>{let{filters:a}=i;if(n.experimentInsightType===u.F.FUNNELS){var o;(o=_e.a.findMounted({dashboardItemId:n.experimentInsightId}))===null||o===void 0||o.actions.setFilters(a)}else{var l;(l=Me.a.findMounted({dashboardItemId:n.experimentInsightId}))===null||l===void 0||l.actions.setFilters(a)}},loadExperimentSuccess:i=>I(this,null,function*(){let{experiment:a}=i;a&&r.reportExperimentViewed(a),a!=null&&a.start_date?(r.loadExperimentResults(),r.loadSecondaryMetricResults()):r.createNewExperimentInsight(a==null?void 0:a.filters)}),launchExperiment:()=>I(this,null,function*(){const i=Object(N.a)();r.updateExperiment({start_date:i.toISOString()}),n.experiment&&jt.e.actions.reportExperimentLaunched(n.experiment,i)}),endExperiment:()=>I(this,null,function*(){var i;const a=Object(N.a)();r.updateExperiment({end_date:a.toISOString()});const o=a.diff((i=n.experiment)===null||i===void 0?void 0:i.start_date,"second");n.experiment&&r.reportExperimentCompleted(n.experiment,a,o,n.areResultsSignificant)}),archiveExperiment:()=>I(this,null,function*(){r.updateExperiment({archived:!0}),n.experiment&&r.reportExperimentArchived(n.experiment)}),updateExperimentGoal:i=>I(this,null,function*(){let{filters:a}=i;r.updateExperiment({filters:a}),r.closeExperimentGoalModal()}),updateExperimentSecondaryMetrics:i=>I(this,null,function*(){let{metrics:a}=i;r.updateExperiment({secondary_metrics:a})}),closeExperimentGoalModal:()=>{n.experimentChanged&&r.loadExperiment()},resetRunningExperiment:()=>I(this,null,function*(){r.updateExperiment({start_date:null,end_date:null}),n.experiment&&r.reportExperimentReset(n.experiment)}),updateExperimentSuccess:i=>I(this,null,function*(){let{experiment:a}=i;r.updateExperiments(a),n.changingGoalMetric&&r.loadExperimentResults(),n.changingSecondaryMetrics&&r.loadSecondaryMetricResults()}),setExperiment:i=>I(this,null,function*(){var a,o;let{experiment:l}=i;const d=((a=l.filters)===null||a===void 0?void 0:a.events)&&l.filters.events.length>0||((o=l.filters)===null||o===void 0?void 0:o.actions)&&l.filters.actions.length>0;!l.filters||Object.keys(l.filters).length===0||(d&&r.checkFlagImplementationWarning(),r.checkFlagAvailabilityWarning())}),setExperimentValue:(i,a)=>I(this,null,function*(){let{name:o,value:l}=i;if(yield a(100),o==="filters"){const d=(l==null?void 0:l.events)&&l.events.length>0||(l==null?void 0:l.actions)&&l.actions.length>0;if(!l||Object.keys(l).length===0)return;d&&r.checkFlagImplementationWarning(),r.checkFlagAvailabilityWarning()}}),setExperimentValues:(i,a)=>I(this,null,function*(){var o,l;let{values:d}=i;yield a(100);const m=d,S=((o=m.filters)===null||o===void 0?void 0:o.events)&&m.filters.events.length>0||((l=m.filters)===null||l===void 0?void 0:l.actions)&&m.filters.actions.length>0;!m.filters||Object.keys(m.filters).length===0||(S&&r.checkFlagImplementationWarning(),r.checkFlagAvailabilityWarning())}),checkFlagImplementationWarning:(i,a)=>I(this,null,function*(){var o,l;const d=n.experiment,m=((o=d.filters)===null||o===void 0?void 0:o.events)&&d.filters.events.length>0||((l=d.filters)===null||l===void 0?void 0:l.actions)&&d.filters.actions.length>0;if(!(!d.filters||Object.keys(d.filters).length===0)&&m){const S=`/api/projects/${n.currentTeamId}/experiments/requires_flag_implementation?${Object($.Ib)(d.filters||{})}`;yield a(100);try{const v=yield X.b.get(S);r.setFlagImplementationWarning(v.result)}catch(v){r.setFlagImplementationWarning(!1)}}}),checkFlagAvailabilityWarning:()=>I(this,null,function*(){var i;if((i=n.experiment.filters)!==null&&i!==void 0&&i.properties){const a=Object($.r)(n.experiment.filters.properties)||[];if(a.length>0){const o=!!a.find(l=>l.type==="cohort"||!Te.l.includes(l.key||""));r.setFlagAvailabilityWarning(o)}else r.setFlagAvailabilityWarning(!1)}}),openExperimentGoalModal:()=>I(this,null,function*(){var i;r.createNewExperimentInsight((i=n.experiment)===null||i===void 0?void 0:i.filters)})}}),Object(gt.loaders)(t=>{let{actions:n,props:r,values:i}=t;return{experiment:{loadExperiment:()=>I(this,null,function*(){if(r.experimentId&&r.experimentId!=="new")try{return yield X.b.get(`api/projects/${i.currentTeamId}/experiments/${r.experimentId}`)}catch(a){throw a.status===404?a:(Ue.d.error(`Failed to load experiment ${r.experimentId}`),new Error(`Failed to load experiment ${r.experimentId}`))}return He}),updateExperiment:a=>I(this,null,function*(){return yield X.b.update(`api/projects/${i.currentTeamId}/experiments/${i.experimentId}`,a)})},experimentResults:[null,{loadExperimentResults:()=>I(this,null,function*(){try{const a=yield X.b.get(`api/projects/${i.currentTeamId}/experiments/${i.experimentId}/results`);return M(j({},a),{itemID:Math.random().toString(36).substring(2,15)})}catch(a){return n.setExperimentResultCalculationError(a.detail),null}})}],secondaryMetricResults:[null,{loadSecondaryMetricResults:()=>I(this,null,function*(){var a;return yield Promise.all((((a=i.experiment)===null||a===void 0?void 0:a.secondary_metrics)||[]).map((o,l)=>I(this,null,function*(){try{return(yield X.b.get(`api/projects/${i.currentTeamId}/experiments/${i.experimentId}/secondary_results?id=${l}`)).result}catch(d){return{}}})))})}]}}),Object(b.selectors)({props:[()=>[(t,n)=>n],t=>t],experimentId:[()=>[(t,n)=>{var r;return(r=n.experimentId)!==null&&r!==void 0?r:"new"}],t=>t],experimentInsightType:[t=>[t.experiment],t=>{var n;return(t==null||(n=t.filters)===null||n===void 0?void 0:n.insight)||u.F.TRENDS}],isExperimentRunning:[t=>[t.experiment],t=>!!(t!=null&&t.start_date)],breadcrumbs:[t=>[t.experiment,t.experimentId],(t,n)=>[{name:"Experiments",path:ee.a.experiments()},{name:(t==null?void 0:t.name)||"New",path:ee.a.experiment(n||"new")}]],variants:[t=>[t.experiment],t=>{var n;return(t==null||(n=t.parameters)===null||n===void 0?void 0:n.feature_flag_variants)||[]}],taxonomicGroupTypesForSelection:[t=>[t.experiment,t.groupsTaxonomicTypes],(t,n)=>{var r;return(t==null||(r=t.filters)===null||r===void 0?void 0:r.aggregation_group_type_index)!=null&&n.length>0?[n[t.filters.aggregation_group_type_index]]:[O.a.PersonProperties,O.a.Cohorts]}],minimumDetectableChange:[t=>[t.experiment],t=>{var n;return(t==null||(n=t.parameters)===null||n===void 0?void 0:n.minimum_detectable_effect)||5}],minimumSampleSizePerVariant:[t=>[t.minimumDetectableChange],t=>n=>Math.ceil(1600*n*(1-n/100)/(t*t))],areResultsSignificant:[t=>[t.experimentResults],t=>(t==null?void 0:t.significant)||!1],significanceBannerDetails:[t=>[t.experimentResults],t=>{if((t==null?void 0:t.significance_code)===u.ab.HighLoss){var n;return Object(e.jsxs)(e.Fragment,{children:["This is because the expected loss in conversion is greater than 1%",Object(e.jsx)(ft.a,{placement:"right",title:Object(e.jsxs)(e.Fragment,{children:["Current value is ",(n=((t==null?void 0:t.expected_loss)||0)*100)===null||n===void 0?void 0:n.toFixed(2),"%"]}),children:Object(e.jsx)(T.IconInfo,{className:"ml-1 text-muted text-xl"})}),"."]})}if((t==null?void 0:t.significance_code)===u.ab.HighPValue){var r;return Object(e.jsxs)(e.Fragment,{children:["This is because the p value is greater than 0.05",Object(e.jsx)(ft.a,{placement:"right",title:Object(e.jsxs)(e.Fragment,{children:["Current value is ",(t==null||(r=t.p_value)===null||r===void 0?void 0:r.toFixed(3))||1,"."]}),children:Object(e.jsx)(T.IconInfo,{className:"ml-1 text-muted text-xl"})}),"."]})}return(t==null?void 0:t.significance_code)===u.ab.LowWinProbability?"This is because the win probability of all test variants combined is less than 90%.":(t==null?void 0:t.significance_code)===u.ab.NotEnoughExposure?"This is because we need at least 100 people per variant to declare significance.":""}],recommendedExposureForCountData:[t=>[t.minimumDetectableChange],t=>n=>{const r=n*t/100,i=n,a=r+n;return parseFloat((4/Math.pow(Math.sqrt(i/Oe)-Math.sqrt(a/Oe),2)).toFixed(1))}],expectedRunningTime:[()=>[],()=>function(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Oe;return parseFloat((n/(t/r)).toFixed(1))}],conversionRateForVariant:[t=>[t.experimentResults],t=>n=>{const r="--";if(!t)return r;const i=(t==null?void 0:t.insight).find(a=>{var o,l;return((o=a[0])===null||o===void 0||(l=o.breakdown_value)===null||l===void 0?void 0:l[0])===n});return i?(i[i.length-1].count/i[0].count*100).toFixed(1):r}],getIndexForVariant:[t=>[t.experimentResults],t=>(n,r)=>{let i;if(!t)i=0;else{let a=-1;r===u.F.FUNNELS?a=[...t==null?void 0:t.insight].sort((o,l)=>{var d,m;return((d=l[0])===null||d===void 0?void 0:d.count)-((m=o[0])===null||m===void 0?void 0:m.count)}).findIndex(o=>{var l,d;return((l=o[0])===null||l===void 0||(d=l.breakdown_value)===null||d===void 0?void 0:d[0])===n}):a=(t==null?void 0:t.insight).findIndex(o=>o.breakdown_value===n),i=a===-1?0:a}return r===u.F.FUNNELS&&i++,i}],countDataForVariant:[t=>[t.experimentResults],t=>n=>{const r="--";if(!t)return r;const i=(t==null?void 0:t.insight).find(a=>a.breakdown_value===n);return i?i.count.toString():r}],highestProbabilityVariant:[t=>[t.experimentResults],t=>{if(t){const n=Math.max(...Object.values(t.probability));return Object.keys(t.probability).find(r=>Math.abs(t.probability[r]-n)<Number.EPSILON)}}],areTrendResultsConfusing:[t=>[t.experimentResults,t.highestProbabilityVariant],(t,n)=>{if(!t)return!1;const r=(t==null?void 0:t.insight).reduce((i,a)=>a.count>i.count?a:i,{count:0,breakdown_value:""});return r.count?r.breakdown_value!==n:!1}],sortedExperimentResultVariants:[t=>[t.experimentResults,t.experiment],(t,n)=>{if(t){var r,i;const a=Object.keys(t.probability).sort((o,l)=>t.probability[l]-t.probability[o]);return n==null||(r=n.parameters)===null||r===void 0||(i=r.feature_flag_variants)===null||i===void 0||i.forEach(o=>{a.includes(o.key)||a.push(o.key)}),a}return[]}],tabularSecondaryMetricResults:[t=>[t.experiment,t.secondaryMetricResults],(t,n)=>{var r,i;const a=[];return t==null||(r=t.parameters)===null||r===void 0||(i=r.feature_flag_variants)===null||i===void 0||i.forEach(o=>{var l;const d=[];t==null||(l=t.secondary_metrics)===null||l===void 0||l.forEach((m,S)=>{var v;d.push({insightType:m.filters.insight||u.F.TRENDS,result:n==null||(v=n[S])===null||v===void 0?void 0:v[o.key]})}),a.push({variant:o.key,results:d})}),a}]}),Object(se.forms)(t=>{let{actions:n,values:r}=t;return{experiment:{defaults:j({},He),errors:i=>{var a,o;let{name:l,feature_flag_key:d,parameters:m}=i;return{name:!l&&"You have to enter a name.",feature_flag_key:d?(a=d.match)!==null&&a!==void 0&&a.call(d,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You have to enter a feature flag key.",parameters:{feature_flag_variants:(o=m.feature_flag_variants)===null||o===void 0?void 0:o.map(S=>{var v;let{key:E}=S;return{key:(v=E.match)!==null&&v!==void 0&&v.call(E,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed."}})}}},submit:()=>{const{exposure:i,sampleSize:a}=r.exposureAndSampleSize;n.createExperiment(!0,i,a)}}}}),Object(ge.urlToAction)(t=>{let{actions:n,values:r}=t;return{"/experiments/:id":(i,a,o,l,d)=>{let{id:m}=i;if(!r.hasAvailableFeature(u.e.EXPERIMENTATION)){ge.router.actions.push("/experiments");return}const S=l.initial||l.pathname!==(d==null?void 0:d.pathname);if(n.setEditExperiment(!1),m&&S){const v=m==="new"?"new":parseInt(m);v==="new"&&(n.createNewExperimentInsight(),n.resetExperiment()),v!=="new"&&v===r.experimentId&&n.loadExperiment()}}}}),Object(b.afterMount)(t=>{var n;let{props:r,actions:i}=t;const a=(n=xt.a.findMounted())===null||n===void 0?void 0:n.values.experiments.find(o=>o.id===r.experimentId);a?i.setExperiment(a):r.experimentId!=="new"&&i.loadExperiment()})]);function ht(t){const n=Math.round(100/t),i=n*t-100,a=new Array(t).fill(n);return a[t-1]=n-i,a}var Je=c("./frontend/src/scenes/insights/InsightContainer.tsx"),Xe=c("./node_modules/.pnpm/@ant-design+icons@4.7.0_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),Yt=c("./node_modules/.pnpm/@ant-design+icons@4.7.0_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),zt=c("./frontend/src/lib/components/CopyToClipboard.tsx");const bt=14,vt={name:"",filters:{insight:u.F.TRENDS,events:[{id:"$pageview",name:"$pageview",type:"events",order:0}]}},yt=Object(b.kea)([Object(b.props)({}),Object(b.key)(t=>t.experimentId||"new"),Object(b.path)(t=>["scenes","experiment","secondaryMetricsLogic",t]),Object(b.connect)({values:[We.a,["currentTeamId"]]}),Object(b.actions)({openModalToCreateSecondaryMetric:!0,openModalToEditSecondaryMetric:(t,n)=>({metric:t,metricId:n}),closeModal:!0,addNewMetric:t=>({metric:t}),setFilters:t=>({filters:t}),setPreviewInsightId:t=>({shortId:t}),createPreviewInsight:t=>({filters:t}),deleteMetric:t=>({metricId:t}),updateMetric:(t,n)=>({metric:t,metricId:n}),setMetricId:t=>({metricId:t}),saveSecondaryMetric:!0}),Object(gt.loaders)(t=>{let{values:n}=t;return{experiments:[[],{loadExperiments:()=>I(this,null,function*(){return(yield X.b.get(`api/projects/${n.currentTeamId}/experiments`)).results})}]}}),Object(b.reducers)(t=>{let{props:n}=t;return{isModalOpen:[!1,{openModalToCreateSecondaryMetric:()=>!0,openModalToEditSecondaryMetric:()=>!0,closeModal:()=>!1}],existingModalSecondaryMetric:[null,{openModalToCreateSecondaryMetric:()=>null,openModalToEditSecondaryMetric:(r,i)=>{let{metric:a}=i;return a}}],previewInsightId:[null,{setPreviewInsightId:(r,i)=>{let{shortId:a}=i;return a}}],metrics:[n.initialMetrics,{addNewMetric:(r,i)=>{let{metric:a}=i;return[...r,j({},a)]},deleteMetric:(r,i)=>{let{metricId:a}=i;return r.filter((o,l)=>l!==a)},updateMetric:(r,i)=>{let{metric:a,metricId:o}=i;const l=[...r];return l[o]=a,l}}],metricId:[0,{setMetricId:(r,i)=>{let{metricId:a}=i;return a}}]}}),Object(se.forms)(()=>({secondaryMetricModal:{defaults:vt,errors:()=>({}),submit:()=>I(this,null,function*(){})}})),Object(b.listeners)(t=>{let{props:n,actions:r,values:i}=t;return{openModalToEditSecondaryMetric:a=>{let{metric:{name:o,filters:l},metricId:d}=a;r.setSecondaryMetricModalValue("name",o),r.createPreviewInsight(l),r.setMetricId(d)},openModalToCreateSecondaryMetric:()=>{r.resetSecondaryMetricModal(),r.createPreviewInsight(vt.filters)},createPreviewInsight:a=>I(this,null,function*(){let{filters:o}=a,l;(o==null?void 0:o.insight)===u.F.FUNNELS?l=Object(Ce.a)(j({insight:u.F.FUNNELS,funnel_viz_type:u.B.Steps,date_from:Object(N.a)().subtract(bt,"day").format("YYYY-MM-DD"),date_to:Object(N.a)().endOf("d").format("YYYY-MM-DDTHH:mm"),layout:Te.k.horizontal},o)):l=Object(Ce.a)(j({insight:u.F.TRENDS,date_from:Object(N.a)().subtract(bt,"day").format("YYYY-MM-DD"),date_to:Object(N.a)().endOf("d").format("YYYY-MM-DDTHH:mm")},o));const d={description:"",tags:[],filters:l,result:null},m=yield X.b.create(`api/projects/${We.a.values.currentTeamId}/insights`,d);r.setPreviewInsightId(m.short_id),r.setSecondaryMetricModalValue("filters",d.filters)}),setFilters:a=>{let{filters:o}=a;if(o.insight===u.F.FUNNELS){var l;(l=_e.a.findMounted({dashboardItemId:i.previewInsightId}))===null||l===void 0||l.actions.setFilters(o)}else{var d;(d=Me.a.findMounted({dashboardItemId:i.previewInsightId}))===null||d===void 0||d.actions.setFilters(o)}},saveSecondaryMetric:()=>{i.existingModalSecondaryMetric?r.updateMetric(i.secondaryMetricModal,i.metricId):r.addNewMetric(i.secondaryMetricModal),n.onMetricsChange(i.metrics),r.closeModal()},deleteMetric:()=>{n.onMetricsChange(i.metrics)}}}),Object(b.events)(t=>{let{actions:n}=t;return{afterMount:()=>{n.createPreviewInsight()}}})]);var k=c("./frontend/src/lib/components/LemonButton/index.ts"),Qe=c("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilterRow/ActionFilterRow.tsx"),P=c("./frontend/@posthog/lemon-ui/src/index.ts"),oe=c("./frontend/src/lib/forms/Field.tsx");function Se(t){let{createPreviewInsight:n,previewInsightId:r,filters:i,setFilters:a}=t;const{insightProps:o}=Object(b.useValues)(Object(ye.c)({dashboardItemId:r,syncWithUrl:!1})),{isStepsEmpty:l,filterSteps:d,filters:m}=Object(b.useValues)(Object(_e.a)(o)),{filters:S}=Object(b.useValues)(Object(Me.a)(o)),v=i.insight;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"flex items-center w-full gap-2 mb-4",children:[Object(e.jsx)("span",{children:"Insight Type"}),Object(e.jsx)(P.LemonSelect,{value:v,onChange:E=>{E&&n({insight:E})},options:[{value:u.F.TRENDS,label:Object(e.jsx)("b",{children:"Trends"})},{value:u.F.FUNNELS,label:Object(e.jsx)("b",{children:"Funnels"})}]})]}),v===u.F.FUNNELS&&Object(e.jsx)(fe.a,{bordered:!0,filters:m,setFilters:E=>{a(j(M(j({},i),{insight:u.F.FUNNELS}),E))},typeKey:`experiment-funnel-goal-${JSON.stringify(i)}`,mathAvailability:Qe.b.None,hideDeleteBtn:d.length===1,buttonCopy:"Add funnel step",showSeriesIndicator:!l,seriesIndicatorType:"numeric",sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[O.a.EventProperties,O.a.PersonProperties,O.a.EventFeatureFlags,O.a.Cohorts,O.a.Elements]}),v===u.F.TRENDS&&Object(e.jsx)(fe.a,{bordered:!0,filters:S,setFilters:E=>{a(j(M(j({},i),{insight:u.F.TRENDS}),E))},typeKey:`experiment-trends-goal-${JSON.stringify(i)}`,buttonCopy:"Add graph series",showSeriesIndicator:!0,entitiesLimit:1,hideDeleteBtn:!0,propertiesTaxonomicGroupTypes:[O.a.EventProperties,O.a.PersonProperties,O.a.EventFeatureFlags,O.a.Cohorts,O.a.Elements]}),Object(e.jsx)("div",{className:"mt-4",children:Object(e.jsx)(b.BindLogic,{logic:ye.c,props:o,children:Object(e.jsx)(Je.a,{disableHeader:!0,disableTable:!0,disableCorrelationTable:!0})})})]})}try{Se.displayName="MetricSelector",Se.__docgenInfo={description:"",displayName:"MetricSelector",props:{createPreviewInsight:{defaultValue:null,description:"",name:"createPreviewInsight",required:!0,type:{name:"(filters?: Partial<FilterType> | undefined) => void"}},setFilters:{defaultValue:null,description:"",name:"setFilters",required:!0,type:{name:"(filters: Partial<FilterType>) => void"}},previewInsightId:{defaultValue:null,description:"",name:"previewInsightId",required:!0,type:{name:"InsightShortId | null"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"Partial<FilterType>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/MetricSelector.tsx#MetricSelector"]={docgenInfo:Se.__docgenInfo,name:"MetricSelector",path:"frontend/src/scenes/experiments/MetricSelector.tsx#MetricSelector"})}catch(t){}var Ze=c("./frontend/src/lib/colors.ts");function Ee(t){var n;let{onMetricsChange:r,initialMetrics:i,experimentId:a}=t;const o=yt({onMetricsChange:r,initialMetrics:i,experimentId:a}),{previewInsightId:l,metrics:d,isModalOpen:m,isSecondaryMetricModalSubmitting:S,existingModalSecondaryMetric:v,metricId:E}=Object(b.useValues)(o),{setFilters:s,deleteMetric:R,openModalToCreateSecondaryMetric:W,openModalToEditSecondaryMetric:H,closeModal:B,saveSecondaryMetric:y,createPreviewInsight:p}=Object(b.useActions)(o),{secondaryMetricResultsLoading:Z,isExperimentRunning:w,getIndexForVariant:pe,experiment:G,editingExistingExperiment:ne,tabularSecondaryMetricResults:me}=Object(b.useValues)(te({experimentId:a})),ue=[{key:"variant",title:"Variant",render:function(F,z){var K;return Object(e.jsx)("div",{style:{color:Object(Ze.d)(pe(z.variant,((K=G.filters)===null||K===void 0?void 0:K.insight)||u.F.TRENDS))},children:Object(e.jsx)("span",{className:"text-sm",children:Object($.i)(z.variant)})})},sorter:(L,F)=>String(L.variant).localeCompare(String(F.variant))}];return(n=G.secondary_metrics)===null||n===void 0||n.forEach((L,F)=>{ue.push({key:`results_${F}`,title:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("div",{children:Object(e.jsx)("b",{children:Object($.i)(L.name)})}),Object(e.jsx)("div",{className:"flex",onClick:z=>z.stopPropagation(),children:Object(e.jsx)(k.a,{icon:Object(e.jsx)(T.IconEdit,{}),size:"small",status:"muted",onClick:()=>H(L,F)})})]}),align:"right",render:function(K,Y){var A;return Object(e.jsx)("div",{children:(A=Y.results)!==null&&A!==void 0&&A[F].result?Y.results[F].insightType===u.F.FUNNELS?Object(e.jsxs)(e.Fragment,{children:[(Y.results[F].result*100).toFixed(1),"%"]}):Object(e.jsx)(e.Fragment,{children:Object($.R)(Y.results[F].result)}):Object(e.jsx)(e.Fragment,{children:"--"})})},sorter:(z,K)=>{var Y,A,re,U;return((Y=(A=z.results)===null||A===void 0?void 0:A[F].result)!==null&&Y!==void 0?Y:0)-((re=(U=K.results)===null||U===void 0?void 0:U[F].result)!==null&&re!==void 0?re:0)}})}),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(P.LemonModal,{isOpen:m,onClose:B,width:650,title:v?"Edit secondary metric":"New secondary metric",footer:Object(e.jsxs)(e.Fragment,{children:[v&&Object(e.jsx)(k.a,{className:"mr-auto",form:"secondary-metric-modal-form",type:"secondary",status:"danger",onClick:()=>R(E),children:"Delete"}),Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)(k.a,{form:"secondary-metric-modal-form",type:"secondary",onClick:B,children:"Cancel"}),Object(e.jsx)(k.a,{form:"secondary-metric-modal-form",onClick:y,type:"primary",loading:S,"data-attr":"create-annotation-submit",children:v?"Save":"Create"})]})]}),children:Object(e.jsxs)(se.Form,{logic:yt,props:{onMetricsChange:r,initialMetrics:i,experimentId:a},formKey:"secondaryMetricModal",id:"secondary-metric-modal-form",className:"space-y-4",children:[Object(e.jsx)(oe.a,{name:"name",label:"Name",children:Object(e.jsx)(P.LemonInput,{})}),Object(e.jsx)(oe.a,{name:"filters",label:"Query",children:L=>{let{value:F,onChange:z}=L;return Object(e.jsx)(Se,{createPreviewInsight:p,setFilters:K=>{s(K),z(K)},previewInsightId:l,filters:F})}})]})}),a=="new"||ne?Object(e.jsx)(g.a,{children:Object(e.jsxs)(x.a,{children:[d.map((L,F)=>Object(e.jsxs)(g.a,{className:"mt-4 border rounded p-4",children:[Object(e.jsxs)(g.a,{align:"middle",justify:"space-between",className:"w-full mb-3 pb-2 border-b",children:[Object(e.jsx)("div",{children:Object(e.jsx)("b",{children:L.name})}),Object(e.jsxs)("div",{className:"flex",children:[Object(e.jsx)(k.a,{icon:Object(e.jsx)(T.IconEdit,{}),size:"small",status:"muted",onClick:()=>H(L,F)}),Object(e.jsx)(k.a,{icon:Object(e.jsx)(T.IconDelete,{}),size:"small",status:"muted",onClick:()=>R(F)})]})]}),L.filters.insight===u.F.FUNNELS&&Object(e.jsx)(fe.a,{bordered:!0,filters:L.filters,setFilters:()=>{},typeKey:`funnel-preview-${F}`,mathAvailability:Qe.b.None,buttonCopy:"Add funnel step",seriesIndicatorType:"numeric",sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[O.a.EventProperties,O.a.PersonProperties,O.a.EventFeatureFlags,O.a.Cohorts,O.a.Elements],readOnly:!0}),L.filters.insight===u.F.TRENDS&&Object(e.jsx)(fe.a,{bordered:!0,filters:L.filters,setFilters:()=>{},typeKey:`trend-preview-${F}`,buttonCopy:"Add graph series",showSeriesIndicator:!0,entitiesLimit:1,propertiesTaxonomicGroupTypes:[O.a.EventProperties,O.a.PersonProperties,O.a.EventFeatureFlags,O.a.Cohorts,O.a.Elements],readOnly:!0})]},F)),d&&!(d.length>2)&&Object(e.jsx)(x.a,{children:Object(e.jsx)("div",{className:"mb-2 mt-4",children:Object(e.jsx)(k.a,{type:"secondary",onClick:W,children:"Add metric"})})})]})}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("div",{className:"card-secondary mt-4 mb-1",children:"Secondary metrics"}),d&&d.length>0?Object(e.jsx)(P.LemonTable,{loading:Z,columns:ue,dataSource:me}):w?Object(e.jsx)(e.Fragment,{}):Object(e.jsx)(e.Fragment,{children:"--"}),d&&!(d.length>2)&&w&&Object(e.jsx)("div",{className:"mb-2 mt-4 justify-end",children:Object(e.jsx)(k.a,{type:"secondary",size:"small",onClick:W,children:"Add metric"})})]})]})}try{Ee.displayName="SecondaryMetrics",Ee.__docgenInfo={description:"",displayName:"SecondaryMetrics",props:{onMetricsChange:{defaultValue:null,description:"",name:"onMetricsChange",required:!0,type:{name:"(metrics: SecondaryExperimentMetric[]) => void"}},initialMetrics:{defaultValue:null,description:"",name:"initialMetrics",required:!0,type:{name:"SecondaryExperimentMetric[]"}},experimentId:{defaultValue:null,description:"",name:"experimentId",required:!0,type:{name:'number | "new"'}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/SecondaryMetrics.tsx#SecondaryMetrics"]={docgenInfo:Ee.__docgenInfo,name:"SecondaryMetrics",path:"frontend/src/scenes/experiments/SecondaryMetrics.tsx#SecondaryMetrics"})}catch(t){}var Kt=c("./frontend/src/lib/components/EntityFilterInfo.tsx"),Bt=c("./frontend/src/lib/components/EditableField/EditableField.tsx"),Ot=c("./frontend/src/lib/components/Link.tsx"),Gt=c("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/slider/index.js"),Wt=c("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/input-number/index.js"),Ut=c("./frontend/src/lib/components/InsightLabel/index.tsx"),St=c("./frontend/src/lib/components/PropertyFilters/components/PropertyFilterButton.tsx");function Ht(){const[t,n]=Object(je.useState)(!1),[r,i]=Object(je.useState)(!1);return Object(e.jsxs)(ae.a,{className:"experiment-workflow",title:Object(e.jsx)("span",{className:"card-secondary",children:"Experiment workflow"}),children:[Object(e.jsx)(g.a,{children:Object(e.jsxs)(x.a,{className:"exp-workflow-step step-completed w-full",children:[Object(e.jsxs)(g.a,{align:"middle",children:[Object(e.jsx)(T.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}),Object(e.jsx)("b",{className:"ml-2",children:"Create experiment"})]}),Object(e.jsx)("div",{className:"ml-8",children:"Set variants, select participants, and add secondary metrics"})]})}),Object(e.jsx)(g.a,{children:Object(e.jsxs)(x.a,{className:`w-full exp-workflow-step ${t?"step-completed":""}`,onClick:()=>n(!t),children:[Object(e.jsxs)(g.a,{align:"middle",children:[t?Object(e.jsx)(T.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}):Object(e.jsx)(T.IconRadioButtonUnchecked,{}),Object(e.jsx)("b",{className:"ml-2",children:"Validate experiment"})]}),Object(e.jsx)("div",{className:"ml-8",children:"Once you've written your code, it's a good idea to test that each variant behaves as you'd expect."})]})}),Object(e.jsx)(g.a,{children:Object(e.jsxs)(x.a,{className:`w-full exp-workflow-step ${r?"step-completed":""}`,onClick:()=>i(!r),children:[Object(e.jsxs)(g.a,{align:"middle",children:[r?Object(e.jsx)(T.IconCheckmark,{style:{color:"var(--primary)",fontSize:24}}):Object(e.jsx)(T.IconRadioButtonUnchecked,{}),Object(e.jsx)("b",{className:"ml-2",children:"Launch experiment"})]}),Object(e.jsx)("div",{className:"ml-8",children:"Run your experiment, monitor results, and decide when to terminate your experiment."})]})})]})}function Ie(t){var n,r,i,a,o,l;let{experimentId:d,trendCount:m,funnelConversionRate:S,trendExposure:v,funnelSampleSize:E,funnelEntrants:s}=t;const{experimentInsightType:R,editingExistingExperiment:W,minimumDetectableChange:H,expectedRunningTime:B,aggregationLabel:y,experiment:p,isExperimentGoalModalOpen:Z,experimentLoading:w,experimentInsightId:pe}=Object(b.useValues)(te({experimentId:d})),{setExperiment:G,openExperimentGoalModal:ne,closeExperimentGoalModal:me,updateExperimentGoal:ue,setFilters:L,createNewExperimentInsight:F}=Object(b.useActions)(te({experimentId:d})),z=R===u.F.FUNNELS&&100-S<50?100-S:50,K=Object(N.a)().diff(Object(N.a)(p==null?void 0:p.start_date),"hour");let Y=0;p!=null&&p.start_date?Y=B(s||1,E||0,K):Y=B(s||1,E||0);const A=Object(N.a)(p==null?void 0:p.start_date).add(Y,"hour"),re=!(p!=null&&p.end_date)&&K>=24&&s&&E,U=Object($.r)(p==null||(n=p.filters)===null||n===void 0?void 0:n.properties);return Object(e.jsxs)(g.a,{children:[Object(e.jsxs)(x.a,{span:!(p!=null&&p.start_date)&&d!=="new"&&!W?12:24,children:[d==="new"&&Object(e.jsx)(g.a,{className:"experiment-preview-row",children:Object(e.jsxs)("div",{children:[Object(e.jsx)("div",{children:Object(e.jsx)("b",{children:"Experiment preview"})}),Object(e.jsxs)("div",{className:"text-muted",children:["Here are the baseline metrics for your experiment. Adjust your minimum detectible threshold to adjust for the smallest conversion value you'll accept, and the experiment duration."," "]})]})}),(d==="new"||W)&&Object(e.jsx)(g.a,{className:"mb-4",children:Object(e.jsxs)(x.a,{span:24,children:[Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:"Minimum acceptable improvement"}),Object(e.jsx)(be.a,{title:"Minimum acceptable improvement is a calculation that estimates the smallest significant improvement you are willing to accept.",children:Object(e.jsx)(T.IconInfo,{className:"ml-1 text-muted text-xl"})})]}),Object(e.jsxs)(g.a,{className:"mde-slider",children:[Object(e.jsx)(x.a,{span:8,children:Object(e.jsx)(Gt.a,{defaultValue:5,value:H,min:1,max:z,trackStyle:{background:"var(--primary)"},handleStyle:{background:"var(--primary)"},onChange:C=>{G({parameters:M(j({},p.parameters),{minimum_detectable_effect:C})})},tipFormatter:C=>`${C}%`})}),Object(e.jsx)(Wt.a,{min:1,max:z,defaultValue:5,formatter:C=>`${C}%`,style:{margin:"0 16px"},value:H,onChange:C=>{G({parameters:M(j({},p.parameters),{minimum_detectable_effect:C})})}})]})]})}),Object(e.jsxs)(g.a,{className:`experiment-preview-row ${p!=null&&p.start_date?"mr":""}`,children:[R===u.F.TRENDS?Object(e.jsxs)(e.Fragment,{children:[!(p!=null&&p.start_date)&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)(x.a,{span:6,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Baseline Count"}),Object(e.jsx)("div",{className:"l4",children:Object($.R)(m||0)})]}),Object(e.jsxs)(x.a,{span:6,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Minimum Acceptable Count"}),Object(e.jsx)("div",{className:"l4",children:Object($.R)(m+Math.ceil(m*(H/100))||0)})]})]}),Object(e.jsxs)(x.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Recommended running time"}),Object(e.jsxs)("div",{children:[Object(e.jsxs)("span",{className:"l4",children:["~",Object($.R)(v||0)]})," days"]})]})]}):Object(e.jsxs)(e.Fragment,{children:[!(p!=null&&p.start_date)&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)(x.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Baseline Conversion Rate"}),Object(e.jsxs)("div",{className:"l4",children:[S.toFixed(1),"%"]})]}),Object(e.jsxs)(x.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Minimum Acceptable Conversion Rate"}),Object(e.jsxs)("div",{className:"l4",children:[(S+H).toFixed(1),"%"]})]})]}),Object(e.jsxs)(x.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Recommended Sample Size"}),Object(e.jsxs)("div",{className:"pb-4",children:[Object(e.jsxs)("span",{className:"l4",children:["~",Object($.R)(E||0)]})," persons"]})]}),!(p!=null&&p.start_date)&&Object(e.jsxs)(x.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Recommended running time"}),Object(e.jsxs)("div",{children:[Object(e.jsxs)("span",{className:"l4",children:["~",Object($.R)(Y||0)]})," days"]})]})]}),Object(e.jsxs)(g.a,{className:"w-full mt-4",children:[Object(e.jsxs)(x.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Experiment variants"}),Object(e.jsx)("ul",{className:"variants-list",children:p==null||(r=p.parameters)===null||r===void 0||(i=r.feature_flag_variants)===null||i===void 0?void 0:i.map((C,Q)=>Object(e.jsx)("li",{children:C.key},Q))})]}),Object(e.jsxs)(x.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary",children:"Participants"}),Object(e.jsx)("div",{children:U!=null&&U.length?Object(e.jsx)("div",{children:U==null?void 0:U.map(C=>Object(e.jsx)(St.a,{item:C,style:{margin:2,cursor:"default"}},C.key))}):Object(e.jsxs)(e.Fragment,{children:["100% of"," ",(p==null||(a=p.filters)===null||a===void 0?void 0:a.aggregation_group_type_index)!=null?Object($.i)(y(p.filters.aggregation_group_type_index).plural):"users"]})})]})]}),Object(e.jsxs)(g.a,{className:"w-full",children:[d!=="new"&&!W&&Object(e.jsxs)(x.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary mt-4",children:"Start date"}),p!=null&&p.start_date?Object(e.jsx)("span",{children:Object(N.a)(p==null?void 0:p.start_date).format("D MMM YYYY")}):Object(e.jsx)("span",{className:"description",children:"Not started yet"})]}),R===u.F.FUNNELS&&re?Object(e.jsxs)(x.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary mt-4",children:"Expected end date"}),Object(e.jsx)("span",{children:A.isAfter(Object(N.a)())?A.format("D MMM YYYY"):Object(N.a)().format("D MMM YYYY")})]}):null,(p==null?void 0:p.end_date)&&Object(e.jsxs)(x.a,{span:12,children:[Object(e.jsx)("div",{className:"card-secondary mt-4",children:"Completed date"}),Object(e.jsx)("span",{children:Object(N.a)(p==null?void 0:p.end_date).format("D MMM YYYY")})]})]})]}),d!=="new"&&!W&&Object(e.jsx)(g.a,{className:"experiment-preview-row",children:Object(e.jsxs)(x.a,{children:[Object(e.jsx)("div",{className:"card-secondary mb-2",children:R===u.F.FUNNELS?"Conversion goal steps":"Trend goal"}),[...(p==null||(o=p.filters)===null||o===void 0?void 0:o.events)||[],...(p==null||(l=p.filters)===null||l===void 0?void 0:l.actions)||[]].sort((C,Q)=>(C.order||0)-(Q.order||0)).map((C,Q)=>{var q;return Object(e.jsxs)(x.a,{className:"mb-2",children:[Object(e.jsxs)(g.a,{style:{marginBottom:4},children:[Object(e.jsx)("div",{className:"preview-conversion-goal-num",children:R===u.F.FUNNELS?(C.order||0)+1:Q+1}),Object(e.jsx)("b",{children:Object(e.jsx)(Ut.a,{action:C,showCountedByTag:R===u.F.TRENDS,hideIcon:!0})})]}),(q=C.properties)===null||q===void 0?void 0:q.map(xe=>Object(e.jsx)(St.a,{item:xe},xe.key))]},Q)}),(p==null?void 0:p.start_date)&&Object(e.jsx)("div",{className:"mb-2 mt-4",children:Object(e.jsx)(P.LemonButton,{type:"secondary",onClick:ne,children:"Change experiment goal"})})]})})]}),d!=="new"&&!W&&!(p!=null&&p.start_date)&&Object(e.jsx)(x.a,{span:12,className:"pl-4",children:Object(e.jsx)(Ht,{})}),Object(e.jsx)(P.LemonModal,{isOpen:Z,onClose:me,width:650,title:"Change experiment goal",footer:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)(P.LemonButton,{form:"edit-experiment-goal-form",type:"secondary",onClick:me,children:"Cancel"}),Object(e.jsx)(P.LemonButton,{form:"edit-experiment-goal-form",onClick:()=>{ue(p.filters)},type:"primary",loading:w,"data-attr":"create-annotation-submit",children:"Save"})]}),children:Object(e.jsx)(se.Form,{logic:te,props:{experimentId:d},formKey:"experiment",id:"edit-experiment-goal-form",className:"space-y-4",children:Object(e.jsx)(se.Field,{name:"filters",children:C=>{let{value:Q,onChange:q}=C;return Object(e.jsx)(Se,{createPreviewInsight:F,setFilters:xe=>{L(xe),q(xe)},previewInsightId:pe,filters:Q})}})})})]})}try{Ie.displayName="ExperimentPreview",Ie.__docgenInfo={description:"",displayName:"ExperimentPreview",props:{experimentId:{defaultValue:null,description:"",name:"experimentId",required:!0,type:{name:'number | "new"'}},trendCount:{defaultValue:null,description:"",name:"trendCount",required:!0,type:{name:"number"}},trendExposure:{defaultValue:null,description:"",name:"trendExposure",required:!1,type:{name:"number"}},funnelSampleSize:{defaultValue:null,description:"",name:"funnelSampleSize",required:!1,type:{name:"number"}},funnelConversionRate:{defaultValue:null,description:"",name:"funnelConversionRate",required:!0,type:{name:"number"}},funnelEntrants:{defaultValue:null,description:"",name:"funnelEntrants",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentPreview.tsx#ExperimentPreview"]={docgenInfo:Ie.__docgenInfo,name:"ExperimentPreview",path:"frontend/src/scenes/experiments/ExperimentPreview.tsx#ExperimentPreview"})}catch(t){}var ke=c("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/select/index.js"),Et=c("./node_modules/.pnpm/@ant-design+icons@4.7.0_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/@ant-design/icons/es/icons/CaretDownOutlined.js"),D=c("./frontend/src/lib/components/CodeSnippet/index.tsx");function Ne(){return Object(e.jsx)("div",{className:"warning",children:Object(e.jsxs)("p",{children:[Object(e.jsx)("b",{children:"Warning:"})," Server side experiment metrics require you to manually send the feature flag information."," ",Object(e.jsx)(P.Link,{to:"https://posthog.com/tutorials/experiments#step-2-sending-the-right-events",target:"_blank",children:"See this tutorial for more information."})]})})}function Re(t){let{flagKey:n,variant:r}=t;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(D.a,{language:D.b.JavaScript,wrap:!0,children:`const experimentFlagValue = await client.getFeatureFlag('${n}', 'user distinct id')

if (experimentFlagValue === '${r}' ) {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`}),Object(e.jsx)(Ne,{})]})}function $e(t){let{flagKey:n,variant:r}=t;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(D.a,{language:D.b.JavaScript,wrap:!0,children:`if (posthog.getFeatureFlag('${n}') === '${r}') {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`}),Object(e.jsx)("b",{children:"Test that it works"}),Object(e.jsx)(D.a,{language:D.b.JavaScript,wrap:!0,children:`posthog.feature_flags.override({'${n}': '${r}'})`})]})}function Le(t){let{flagKey:n,variant:r}=t;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(D.a,{language:D.b.JavaScript,wrap:!0,children:`if (posthog.getFeatureFlag('${n}') === '${r}') {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`})})}function Ae(t){let{flagKey:n,variant:r}=t;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(D.a,{language:D.b.PHP,wrap:!0,children:`if (PostHog::getFeatureFlag('${n}', 'user distinct id') == '${r}') {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`}),Object(e.jsx)(Ne,{})]})}function Pe(t){let{flagKey:n,variant:r}=t;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(D.a,{language:D.b.Go,wrap:!0,children:`experimentFlagValue, err := client.GetFeatureFlag(
                    FeatureFlagPayload{
                        Key:        '${n}',
                        DistinctId: "distinct-id",
                    })

if (experimentFlagValue == '${r}' ) {
    // Do something differently for this user
} else {
    // It's a good idea to let control variant always be the default behaviour,
    // so if something goes wrong with flag evaluation, you don't break your app.
}`}),Object(e.jsx)(Ne,{})]})}function De(t){let{flagKey:n,variant:r}=t;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(D.a,{language:D.b.Ruby,wrap:!0,children:`experimentFlagValue = posthog.get_feature_flag('${n}', 'user distinct id')


if experimentFlagValue == '${r}'
    # Do something differently for this user
else
    # It's a good idea to let control variant always be the default behaviour,
    # so if something goes wrong with flag evaluation, you don't break your app.
end
`}),Object(e.jsx)(Ne,{})]})}function Ve(t){let{flagKey:n,variant:r}=t;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(D.a,{language:D.b.Python,wrap:!0,children:`experiment_flag_value = posthog.get_feature_flag("${n}", "user_distinct_id"):

if experiment_flag_value == '${r}':
    # Do something differently for this user
else:
    # It's a good idea to let control variant always be the default behaviour,
    # so if something goes wrong with flag evaluation, you don't break your app.
`}),Object(e.jsx)(Ne,{})]})}try{Re.displayName="NodeJSSnippet",Re.__docgenInfo={description:"",displayName:"NodeJSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#NodeJSSnippet"]={docgenInfo:Re.__docgenInfo,name:"NodeJSSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#NodeJSSnippet"})}catch(t){}try{$e.displayName="JSSnippet",$e.__docgenInfo={description:"",displayName:"JSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#JSSnippet"]={docgenInfo:$e.__docgenInfo,name:"JSSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#JSSnippet"})}catch(t){}try{Le.displayName="RNSnippet",Le.__docgenInfo={description:"",displayName:"RNSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RNSnippet"]={docgenInfo:Le.__docgenInfo,name:"RNSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RNSnippet"})}catch(t){}try{Ae.displayName="PHPSnippet",Ae.__docgenInfo={description:"",displayName:"PHPSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PHPSnippet"]={docgenInfo:Ae.__docgenInfo,name:"PHPSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PHPSnippet"})}catch(t){}try{Pe.displayName="GolangSnippet",Pe.__docgenInfo={description:"",displayName:"GolangSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#GolangSnippet"]={docgenInfo:Pe.__docgenInfo,name:"GolangSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#GolangSnippet"})}catch(t){}try{De.displayName="RubySnippet",De.__docgenInfo={description:"",displayName:"RubySnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RubySnippet"]={docgenInfo:De.__docgenInfo,name:"RubySnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#RubySnippet"})}catch(t){}try{Ve.displayName="PythonSnippet",Ve.__docgenInfo={description:"",displayName:"PythonSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PythonSnippet"]={docgenInfo:Ve.__docgenInfo,name:"PythonSnippet",path:"frontend/src/scenes/experiments/ExperimentCodeSnippets.tsx#PythonSnippet"})}catch(t){}const le="?utm_medium=in-product&utm_campaign=experiment",ce="https://posthog.com/docs/integrate/",de="#feature-flags",qe=[{value:"JavaScript",documentationLink:`${ce}client/js${le}${de}`,Icon:T.IconJavascript,Snippet:$e},{value:"ReactNative",documentationLink:`${ce}client/react-native${le}${de}`,Icon:T.IconJavascript,Snippet:Le},{value:"Node.js",documentationLink:`${ce}server/node${le}${de}`,Icon:T.IconNodeJS,Snippet:Re},{value:"PHP",documentationLink:`${ce}server/php${le}${de}`,Icon:T.IconPHP,Snippet:Ae},{value:"Ruby",documentationLink:`${ce}server/ruby${le}${de}`,Icon:T.IconRuby,Snippet:De},{value:"Golang",documentationLink:`${ce}server/go${le}${de}`,Icon:T.IconGolang,Snippet:Pe},{value:"Python",documentationLink:`${ce}server/python${le}${de}`,Icon:T.IconPython,Snippet:Ve}];function Ye(t){let{selectedOptionValue:n,selectOption:r}=t;return Object(e.jsx)(ke.a,{value:n,onChange:r,style:{minWidth:120},suffixIcon:Object(e.jsx)(Et.a,{}),children:qe.map((i,a)=>{let{value:o,Icon:l}=i;return Object(e.jsx)(ke.a.Option,{"data-attr":"experiment-instructions-select-option-"+o,value:o,children:Object(e.jsxs)("div",{className:"flex items-center",children:[Object(e.jsx)(l,{className:"mr-1"})," ",o]})},a)})})}function we(t){var n,r,i,a,o,l,d;let{experiment:m}=t;const S=(n=m==null||(r=m.parameters)===null||r===void 0||(i=r.feature_flag_variants)===null||i===void 0||(a=i[1])===null||a===void 0?void 0:a.key)!==null&&n!==void 0?n:"test",[v,E]=Object(je.useState)(S),[s]=qe,[R,W]=Object(je.useState)(s),H=B=>{const y=qe.find(p=>p.value===B);y&&W(y)};return Object(e.jsxs)(ae.a,{title:Object(e.jsx)("span",{className:"card-secondary",children:"Feature flag usage and implementation"}),className:"experiment-implementation-details",children:[Object(e.jsxs)("div",{style:{justifyContent:"space-between"},className:"flex mb-2",children:[Object(e.jsxs)("div",{children:[Object(e.jsx)("span",{className:"mr-2",children:"Variant group"}),Object(e.jsx)(ke.a,{onChange:E,value:v,style:{minWidth:80},suffixIcon:Object(e.jsx)(Et.a,{}),children:m==null||(o=m.parameters)===null||o===void 0||(l=o.feature_flag_variants)===null||l===void 0?void 0:l.map((B,y)=>Object(e.jsx)(ke.a.Option,{value:B.key,children:B.key},y))})]}),Object(e.jsx)("div",{children:Object(e.jsx)(Ye,{selectOption:H,selectedOptionValue:R.value})})]}),Object(e.jsx)("b",{children:"Implement your experiment in code"}),Object(e.jsx)(R.Snippet,{variant:v,flagKey:(d=m==null?void 0:m.feature_flag_key)!==null&&d!==void 0?d:""}),Object(e.jsx)(P.Link,{to:R.documentationLink,target:"_blank",children:Object(e.jsxs)("div",{className:"flex items-center",children:["See the docs for more implementation information. ",Object(e.jsx)(T.IconOpenInNew,{className:"ml-1"})]})})]})}try{Ye.displayName="CodeLanguageSelect",Ye.__docgenInfo={description:"",displayName:"CodeLanguageSelect",props:{selectedOptionValue:{defaultValue:null,description:"",name:"selectedOptionValue",required:!0,type:{name:"string"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(selectedValue: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#CodeLanguageSelect"]={docgenInfo:Ye.__docgenInfo,name:"CodeLanguageSelect",path:"frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#CodeLanguageSelect"})}catch(t){}try{we.displayName="ExperimentImplementationDetails",we.__docgenInfo={description:"",displayName:"ExperimentImplementationDetails",props:{experiment:{defaultValue:null,description:"",name:"experiment",required:!0,type:{name:"Partial<Experiment> | null"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#ExperimentImplementationDetails"]={docgenInfo:we.__docgenInfo,name:"ExperimentImplementationDetails",path:"frontend/src/scenes/experiments/ExperimentImplementationDetails.tsx#ExperimentImplementationDetails"})}catch(t){}var Jt=c("./frontend/src/lib/components/NotFound/index.tsx"),It=c("./frontend/src/lib/components/AlertMessage/index.ts");const Xt={component:Nt,logic:te,paramsToProps:t=>{let{params:{id:n}}=t;return{experimentId:n==="new"?"new":parseInt(n)}}};function Nt(){var t,n,r,i,a,o,l,d,m,S,v;const{experimentId:E,experiment:s,experimentInsightId:R,minimumSampleSizePerVariant:W,recommendedExposureForCountData:H,variants:B,experimentResults:y,countDataForVariant:p,editingExistingExperiment:Z,experimentInsightType:w,experimentResultsLoading:pe,experimentLoading:G,areResultsSignificant:ne,conversionRateForVariant:me,getIndexForVariant:ue,significanceBannerDetails:L,areTrendResultsConfusing:F,taxonomicGroupTypesForSelection:z,groupTypes:K,aggregationLabel:Y,isExperimentRunning:A,experimentResultCalculationError:re,flagImplementationWarning:U,flagAvailabilityWarning:C,props:Q,sortedExperimentResultVariants:q}=Object(b.useValues)(te),{launchExperiment:xe,setFilters:ze,setEditExperiment:et,endExperiment:wt,addExperimentGroup:Qt,updateExperiment:Zt,removeExperimentGroup:qt,createNewExperimentInsight:en,archiveExperiment:tn,resetRunningExperiment:nn,loadExperiment:Ft,setExposureAndSampleSize:rn,setExperimentValue:Ke,updateExperimentSecondaryMetrics:an}=Object(b.useActions)(te),[tt,nt]=Object(je.useState)(!0),{insightProps:rt}=Object(b.useValues)(Object(ye.c)({dashboardItemId:R})),{isStepsEmpty:sn,filterSteps:on,filters:ln,results:it,conversionMetrics:cn}=Object(b.useValues)(Object(_e.a)(rt)),{filters:dn,results:pn}=Object(b.useValues)(Object(Me.a)(rt)),at=cn.totalRate*100,st=W(at)*B.length,ot=(t=pn[0])===null||t===void 0?void 0:t.count,_t=it==null||(n=it[0])===null||n===void 0?void 0:n.count,lt=H(ot),he=Math.floor(24/(B.length+2));Object(je.useEffect)(()=>{rn(lt,st)},[lt,st]);const Be=w===u.F.FUNNELS&&y!==null&&y!==void 0&&y.insight?y.insight.reduce((f,h)=>{var Fe;return((Fe=h[0])===null||Fe===void 0?void 0:Fe.count)+f},0):0,mn=w===u.F.FUNNELS?(Be||0)/((s==null||(r=s.parameters)===null||r===void 0?void 0:r.recommended_sample_size)||1)*100:Object(N.a)().diff(s==null?void 0:s.start_date,"day")/((s==null||(i=s.parameters)===null||i===void 0?void 0:i.recommended_running_time)||1)*100,un={running:"green",draft:"default",complete:"purple"},Ct=()=>{if(A){if(!(s!=null&&s.end_date))return"running"}else return"draft";return"complete"},Tt=10,Mt=[{background:"#35416b",color:"#fff"},{background:"#C278CE66",color:"#35416B"},{background:"#FFE6AE",color:"#35416B"},{background:"#8DA9E74D",color:"#35416B"}];return G?Object(e.jsx)(ie.a,{active:!0}):!s&&E!=="new"?Object(e.jsx)(Jt.a,{object:"experiment"}):Object(e.jsx)(e.Fragment,{children:E==="new"||Z?Object(e.jsx)(e.Fragment,{children:Object(e.jsxs)(se.Form,{logic:te,formKey:"experiment",props:Q,id:"experiment-form",enableFormOnSubmit:!0,className:"space-y-4 experiment-form",children:[Object(e.jsx)(pt.a,{title:Z?"Edit experiment":"New experiment",buttons:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)(k.a,{"data-attr":"cancel-experiment",type:"secondary",onClick:()=>{Z?(et(!1),Ft()):ge.router.actions.push(ee.a.experiments())},disabled:G,children:"Cancel"}),Object(e.jsx)(k.a,{type:"primary","data-attr":"save-experiment",htmlType:"submit",loading:G,disabled:G,children:"Save"})]})}),Object(e.jsx)(P.LemonDivider,{}),Object(e.jsx)(b.BindLogic,{logic:ye.c,props:rt,children:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"flex flex-col gap-2",style:{maxWidth:"50%"},children:[Object(e.jsx)(oe.a,{name:"name",label:"Name",children:Object(e.jsx)(P.LemonInput,{"data-attr":"experiment-name"})}),Object(e.jsx)(oe.a,{name:"feature_flag_key",label:"Feature flag key",children:Object(e.jsx)(P.LemonInput,{"data-attr":"experiment-feature-flag-key",disabled:Z})}),Object(e.jsx)(oe.a,{name:"description",label:Object(e.jsxs)("div",{children:["Description ",Object(e.jsx)("span",{className:"text-muted",children:"(optional)"})]}),children:Object(e.jsx)(P.LemonTextArea,{"data-attr":"experiment-description",className:"ph-ignore-input",placeholder:"Adding a helpful description can ensure others know what this experiment is about."})}),s.parameters.feature_flag_variants&&Object(e.jsxs)(x.a,{children:[Object(e.jsx)("label",{children:Object(e.jsx)("b",{children:"Experiment variants"})}),Object(e.jsx)("div",{className:"text-muted",children:"Participants are divided into variant groups evenly. All experiments must consist of a control group and at least one test group. Experiments may have at most 3 test groups. Variant names can only contain letters, numbers, hyphens, and underscores."}),Object(e.jsxs)(x.a,{className:"variants",children:[(a=s.parameters.feature_flag_variants)===null||a===void 0?void 0:a.map((f,h)=>Object(e.jsx)(se.Group,{name:["parameters","feature_flag_variants",h],children:Object(e.jsxs)(g.a,{className:`feature-flag-variant ${h===0?"border-t":h>=Tt?"border-b":""}`,children:[Object(e.jsx)("div",{className:"variant-label",style:h===0?j({},Mt[h]):j({},Mt[h%3+1]),children:h===0?"Control":"Test"}),Object(e.jsx)(oe.a,{name:"key",className:"extend-variant-fully",children:Object(e.jsx)(P.LemonInput,{disabled:h===0||E!=="new","data-attr":"experiment-variant-key","data-key-index":h.toString(),className:"ph-ignore-input",fullWidth:!0,placeholder:`example-variant-${h+1}`,autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})}),Object(e.jsx)("div",{className:"float-right",children:E==="new"&&!(h===0||h===1)&&Object(e.jsx)(be.a,{title:"Delete this variant",placement:"bottomLeft",children:Object(e.jsx)(k.a,{status:"primary-alt",size:"small",icon:Object(e.jsx)(T.IconDelete,{}),onClick:()=>qt(h)})})})]},`${f}-${h}`)},h)),((o=s.parameters.feature_flag_variants.length)!==null&&o!==void 0?o:0)<Tt&&E==="new"&&Object(e.jsx)("div",{className:"feature-flag-variant border-b",children:Object(e.jsx)(k.a,{onClick:()=>Qt(),icon:Object(e.jsx)(T.IconPlusMini,{}),children:"Add test variant"})})]})]})]}),Object(e.jsx)(g.a,{className:"person-selection",children:Object(e.jsxs)(x.a,{span:12,children:[Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)("strong",{children:"Select participants"})}),Object(e.jsx)("div",{className:"text-muted",children:"Select the entities who will participate in this experiment. If no filters are set, 100% of participants will be targeted."}),Object(e.jsx)("div",{className:"mt-4 mb-2",children:Object(e.jsx)("strong",{children:"Participant type"})}),Object(e.jsx)(P.LemonSelect,{value:s.filters.aggregation_group_type_index!=null?s.filters.aggregation_group_type_index:-1,"data-attr":"participant-aggregation-filter",dropdownMatchSelectWidth:!1,onChange:f=>{const h=f!==-1?f:void 0;ze({properties:[],aggregation_group_type_index:h!=null?h:void 0}),Ke("filters",M(j({},s.filters),{aggregation_group_type_index:h,properties:[]}))},options:[{value:-1,label:"Persons"},...K.map(f=>({value:f.group_type_index,label:Object($.i)(Y(f.group_type_index).plural)}))]}),Object(e.jsx)("div",{className:"mt-4 mb-2",children:Object(e.jsx)("strong",{children:"Filters"})}),Object(e.jsx)("div",{className:"mb-4",children:Object(e.jsx)($t.a,{pageKey:`experiment-participants-property-${JSON.stringify(s.filters)}`,propertyFilters:Object($.r)(s.filters.properties),onChange:f=>{ze({properties:f.filter(mt.h)}),Ke("filters",M(j({},s.filters),{properties:f.filter(mt.h)}))},taxonomicGroupTypes:z})}),C&&Object(e.jsxs)(It.a,{type:"info",className:"mt-3 mb-3",children:["These properties aren't immediately available on first page load for unidentified persons. This experiment requires that at least one event is sent prior to becoming available to your product or website."," ",Object(e.jsxs)("a",{href:"https://posthog.com/docs/integrate/client/js#bootstrapping-flags",target:"_blank",children:[" ","Learn more about how to make feature flags available instantly."]})]}),Object(e.jsx)("div",{className:"mt-4 mb-2",children:Object(e.jsx)("strong",{children:"Advanced Options"})}),Object(e.jsxs)("div",{className:"mb-4",children:["For more advanced options like changing the rollout percentage and persisting feature flags, you can"," ",E==="new"?"change settings on the feature flag after creation.":Object(e.jsx)(Ot.a,{to:s.feature_flag?ee.a.featureFlag(s.feature_flag):void 0,children:"change settings on the feature flag."})]})]})}),Object(e.jsxs)(g.a,{className:"metrics-selection",children:[Object(e.jsxs)(x.a,{span:12,children:[Object(e.jsxs)("div",{className:"mb-2","data-attr":"experiment-goal-type",children:[Object(e.jsx)("b",{children:"Goal type"}),Object(e.jsx)("div",{className:"text-muted",children:w===u.F.TRENDS?"Track counts of a specific event or action":"Track how many persons complete a sequence of actions and or events"})]}),Object(e.jsx)(P.LemonSelect,{value:w,onChange:f=>{var h;f&&en({insight:f,properties:s==null||(h=s.filters)===null||h===void 0?void 0:h.properties})},dropdownMatchSelectWidth:!1,options:[{value:u.F.TRENDS,label:"Trend"},{value:u.F.FUNNELS,label:"Conversion funnel"}]}),Object(e.jsxs)("div",{className:"my-4",children:[Object(e.jsx)("b",{children:"Experiment goal"}),w===u.F.TRENDS&&Object(e.jsx)("div",{className:"text-muted",children:"Trend-based experiments can have at most one graph series. This metric is used to track the progress of your experiment."})]}),U&&Object(e.jsxs)(It.a,{type:"info",className:"mt-3 mb-3",children:["We can't detect any feature flag information for this target metric. Ensure that you're using the latest PostHog client libraries, and make sure you manually send feature flag information for server-side libraries if necessary."," ",Object(e.jsxs)("a",{href:"https://posthog.com/docs/integrate/server/python#capture",target:"_blank",children:[" ","Read the docs for how to do this for server-side libraries."]})]}),w===u.F.FUNNELS&&Object(e.jsx)(fe.a,{bordered:!0,filters:ln,setFilters:f=>{ze(f),Ke("filters",j(j({},s.filters),f))},typeKey:`experiment-funnel-goal-${JSON.stringify(s.filters)}`,mathAvailability:Qe.b.None,hideDeleteBtn:on.length===1,buttonCopy:"Add funnel step",showSeriesIndicator:!sn,seriesIndicatorType:"numeric",sortable:!0,showNestedArrow:!0,propertiesTaxonomicGroupTypes:[O.a.EventProperties,O.a.PersonProperties,O.a.EventFeatureFlags,O.a.Cohorts,O.a.Elements]}),w===u.F.TRENDS&&Object(e.jsx)(fe.a,{bordered:!0,filters:dn,setFilters:f=>{ze(f),Ke("filters",j(j({},s.filters),f))},typeKey:`experiment-trends-goal-${JSON.stringify(s.filters)}`,buttonCopy:"Add graph series",showSeriesIndicator:!0,entitiesLimit:1,hideDeleteBtn:!0,propertiesTaxonomicGroupTypes:[O.a.EventProperties,O.a.PersonProperties,O.a.EventFeatureFlags,O.a.Cohorts,O.a.Elements]})]}),Object(e.jsxs)(x.a,{span:12,className:"pl-4",children:[Object(e.jsx)("div",{className:"card-secondary mb-4","data-attr":"experiment-preview",children:"Goal preview"}),Object(e.jsx)(Je.a,{disableHeader:w===u.F.TRENDS,disableTable:!0,disableCorrelationTable:!0})]})]}),Object(e.jsx)(oe.a,{name:"secondary_metrics",children:f=>{let{value:h,onChange:Fe}=f;return Object(e.jsx)(g.a,{className:"secondary-metrics",children:Object(e.jsxs)("div",{className:"flex flex-col",children:[Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:"Secondary metrics"}),Object(e.jsx)("span",{className:"text-muted ml-2",children:"(optional)"})]}),Object(e.jsxs)("div",{className:"text-muted",style:{marginTop:4},children:["Use secondary metrics to monitor metrics related to your experiment goal. You can add up to three secondary metrics."," "]}),Object(e.jsx)(Ee,{onMetricsChange:Fe,initialMetrics:h,experimentId:s.id})]})})}}),Object(e.jsx)(ae.a,{className:"experiment-preview",children:Object(e.jsx)(Ie,{experimentId:s.id,trendCount:ot,trendExposure:lt,funnelSampleSize:st,funnelEntrants:_t,funnelConversionRate:at})}),Object(e.jsx)(g.a,{})]})}),Object(e.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[Object(e.jsx)(k.a,{"data-attr":"cancel-experiment",type:"secondary",onClick:()=>{Z?(et(!1),Ft()):ge.router.actions.push(ee.a.experiments())},disabled:G,children:"Cancel"}),Object(e.jsx)(k.a,{type:"primary","data-attr":"save-experiment",htmlType:"submit",loading:G,disabled:G,children:"Save"})]})]})}):s?Object(e.jsxs)("div",{className:"view-experiment",children:[Object(e.jsx)(g.a,{className:"draft-header",children:Object(e.jsxs)(g.a,{justify:"space-between",align:"middle",className:"w-full pb-4",children:[Object(e.jsxs)(x.a,{children:[Object(e.jsx)(g.a,{children:Object(e.jsx)(pt.a,{style:{paddingRight:8},title:`${s==null?void 0:s.name}`,buttons:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(zt.a,{explicitValue:s.feature_flag_key,iconStyle:{color:"var(--muted-alt)"},children:Object(e.jsx)("span",{className:"text-muted",children:s.feature_flag_key})}),Object(e.jsx)(J.a,{style:{alignSelf:"center"},color:un[Ct()],children:Object(e.jsx)("b",{className:"uppercase",children:Ct()})}),y&&s.end_date&&Object(e.jsx)(J.a,{style:{alignSelf:"center"},color:ne?"green":"geekblue",children:Object(e.jsx)("b",{className:"uppercase",children:ne?"Significant Results":"Results not significant"})})]})})}),Object(e.jsx)("span",{className:"exp-description",children:A?Object(e.jsx)(Bt.a,{multiline:!0,name:"description",value:s.description||"",placeholder:"Description (optional)",onSave:f=>Zt({description:f}),maxLength:400,"data-attr":"experiment-description",compactButtons:!0}):Object(e.jsx)(e.Fragment,{children:s.description||"There is no description for this experiment."})})]}),s&&!A&&Object(e.jsxs)("div",{className:"flex items-center",children:[Object(e.jsx)(k.a,{type:"secondary",className:"mr-2",onClick:()=>et(!0),children:"Edit"}),Object(e.jsx)(k.a,{type:"primary",onClick:()=>xe(),children:"Launch"})]}),s&&A&&!s.end_date&&Object(e.jsxs)("div",{className:"flex flex-row gap-2",children:[Object(e.jsx)(ve.a,{placement:"topLeft",title:Object(e.jsxs)("div",{children:["Reset this experiment and go back to draft mode?",Object(e.jsx)("div",{className:"text-sm text-muted",children:"All collected data so far will be discarded."})]}),onConfirm:()=>nn(),children:Object(e.jsx)(k.a,{type:"secondary",status:"primary",children:"Reset"})}),Object(e.jsx)(k.a,{type:"secondary",status:"danger",onClick:()=>wt(),children:"Stop"})]}),(s==null?void 0:s.end_date)&&Object(N.a)().isSameOrAfter(Object(N.a)(s.end_date),"day")&&!s.archived&&Object(e.jsx)(k.a,{type:"secondary",status:"danger",onClick:()=>tn(),children:Object(e.jsx)("b",{children:"Archive"})})]})}),Object(e.jsxs)(g.a,{children:[tt&&y&&ne&&!s.end_date&&Object(e.jsxs)(g.a,{align:"middle",className:"significant-results",children:[Object(e.jsx)(x.a,{span:20,style:{fontWeight:500,color:"#497342"},children:Object(e.jsxs)("div",{children:["Experiment results are significant."," ",s.end_date?"":"You can end your experiment now or let it run until complete."]})}),Object(e.jsx)(x.a,{span:4,children:s.end_date?Object(e.jsx)(Xe.a,{className:"close-button",onClick:()=>nt(!1)}):Object(e.jsx)(k.a,{type:"primary",onClick:()=>wt(),children:"End experiment"})})]}),tt&&y&&!ne&&!s.end_date&&Object(e.jsxs)(g.a,{align:"top",className:"not-significant-results",children:[Object(e.jsxs)(x.a,{span:23,style:{fontWeight:500,color:"#2D2D2D"},children:[Object(e.jsx)("strong",{children:"Your results are not statistically significant"}),"."," ",L," ",s!=null&&s.end_date?"":"We don't recommend ending this experiment yet."," See our"," ",Object(e.jsxs)("a",{href:"https://posthog.com/docs/user-guides/experimentation#funnel-experiment-calculations",children:[" ","experimentation guide"," "]}),"for more information."," "]}),Object(e.jsx)(x.a,{span:1,children:Object(e.jsx)(Xe.a,{className:"close-button",onClick:()=>nt(!1)})})]}),tt&&s.end_date&&Object(e.jsxs)(g.a,{align:"top",className:"feature-flag-mods",children:[Object(e.jsxs)(x.a,{span:23,style:{fontWeight:500},children:[Object(e.jsx)("strong",{children:"Your experiment is complete, but the feature flag is still enabled."})," ","We recommend removing the feature flag from your code completely, instead of relying on this distribution."," ",Object(e.jsx)(Ot.a,{to:s.feature_flag?ee.a.featureFlag(s.feature_flag):void 0,children:Object(e.jsx)("b",{children:"Adjust feature flag distribution"})})]}),Object(e.jsx)(x.a,{span:1,children:Object(e.jsx)(Xe.a,{className:"close-button",onClick:()=>nt(!1)})})]})]}),Object(e.jsxs)(g.a,{children:[Object(e.jsx)(ct.a,{className:"w-full",defaultActiveKey:"experiment-details",children:Object(e.jsx)(ct.a.Panel,{header:Object(e.jsx)("b",{children:"Experiment details"}),children:Object(e.jsxs)(g.a,{children:[Object(e.jsx)(x.a,{span:A?12:24,children:Object(e.jsx)(Ie,{experimentId:s.id,trendCount:ot,trendExposure:s==null?void 0:s.parameters.recommended_running_time,funnelSampleSize:s==null?void 0:s.parameters.recommended_sample_size,funnelConversionRate:at,funnelEntrants:A?Be:_t})}),!pe&&!y&&A&&Object(e.jsx)(x.a,{span:12,children:Object(e.jsx)(we,{experiment:s})}),y&&Object(e.jsxs)(x.a,{span:12,className:"mt-4",children:[Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)("b",{children:"Experiment progress"})}),Object(e.jsx)(dt.a,{strokeWidth:20,showInfo:!1,percent:mn,strokeColor:"var(--success)"}),w===u.F.TRENDS&&s.start_date&&Object(e.jsxs)(g.a,{justify:"space-between",className:"mt-2",children:[s.end_date?Object(e.jsxs)("div",{children:["Ran for"," ",Object(e.jsx)("b",{children:Object(N.a)(s.end_date).diff(s.start_date,"day")})," ","days"]}):Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:Object(N.a)().diff(s.start_date,"day")})," days running"]}),Object(e.jsxs)("div",{children:["Goal:"," ",Object(e.jsx)("b",{children:(l=s==null||(d=s.parameters)===null||d===void 0?void 0:d.recommended_running_time)!==null&&l!==void 0?l:"Unknown"})," ","days"]})]}),w===u.F.FUNNELS&&Object(e.jsxs)(g.a,{justify:"space-between",className:"mt-2",children:[s.end_date?Object(e.jsxs)("div",{children:["Saw ",Object(e.jsx)("b",{children:Object($.R)(Be)})," ","participants"]}):Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:Object($.R)(Be)})," ","participants seen"]}),Object(e.jsxs)("div",{children:["Goal:"," ",Object(e.jsx)("b",{children:Object($.R)((s==null||(m=s.parameters)===null||m===void 0?void 0:m.recommended_sample_size)||0)})," ","participants"]})]})]}),Object(e.jsx)(x.a,{children:Object(e.jsx)(Ee,{experimentId:s.id,onMetricsChange:f=>an(f),initialMetrics:s.secondary_metrics})})]})},"experiment-details")}),!(s!=null&&s.start_date)&&Object(e.jsx)("div",{className:"mt-4 w-full",children:Object(e.jsx)(we,{experiment:s})})]}),Object(e.jsxs)("div",{className:"experiment-result",children:[y?((s==null||(S=s.parameters)===null||S===void 0||(v=S.feature_flag_variants)===null||v===void 0?void 0:v.length)||0)>4?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)(g.a,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[Object(e.jsx)(x.a,{span:2*he,children:"Variant"}),q.map((f,h)=>Object(e.jsx)(x.a,{span:he,style:{color:Object(Ze.d)(ue(f,w))},children:Object(e.jsx)("b",{children:Object($.i)(f)})},h))]}),Object(e.jsxs)(g.a,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[Object(e.jsx)(x.a,{span:2*he,children:w===u.F.TRENDS?"Count":"Conversion Rate"}),q.map((f,h)=>Object(e.jsx)(x.a,{span:he,children:w===u.F.TRENDS?p(f):`${me(f)}%`},h))]}),Object(e.jsxs)(g.a,{className:"border-t",justify:"space-between",style:{paddingTop:8,paddingBottom:8},children:[Object(e.jsx)(x.a,{span:2*he,children:"Probability to be the best"}),q.map((f,h)=>Object(e.jsx)(x.a,{span:he,children:Object(e.jsx)("b",{children:y.probability[f]?`${(y.probability[f]*100).toFixed(1)}%`:"--"})},h))]})]}):Object(e.jsx)(g.a,{justify:"space-around",style:{flexFlow:"nowrap"},children:Object.keys(y.probability).sort((f,h)=>y.probability[h]-y.probability[f]).map((f,h)=>Object(e.jsxs)(x.a,{className:"pr-4",children:[Object(e.jsx)("div",{children:Object(e.jsx)("b",{children:Object($.i)(f)})}),w===u.F.TRENDS?Object(e.jsxs)(g.a,{children:[Object(e.jsx)("b",{style:{paddingRight:4},children:Object(e.jsxs)(g.a,{children:["action"in y.insight[0]&&Object(e.jsx)(Kt.a,{filter:y.insight[0].action}),Object(e.jsx)("span",{style:{paddingLeft:4},children:"count:"})]})})," ",p(f)," ",F&&h===0&&Object(e.jsx)(be.a,{placement:"right",title:"It might seem confusing that the best variant has lower absolute count, but this can happen when fewer people are exposed to this variant, so its relative count is higher.",children:Object(e.jsx)(Yt.a,{style:{padding:"4px 2px"}})})]}):Object(e.jsxs)(g.a,{children:[Object(e.jsx)("b",{style:{paddingRight:4},children:"Conversion rate:"})," ",me(f),"%"]}),Object(e.jsx)(dt.a,{percent:Number((y.probability[f]*100).toFixed(1)),size:"small",showInfo:!1,strokeColor:Object(Ze.d)(ue(f,w))}),Object(e.jsxs)("div",{children:["Probability that this variant is the best:"," ",Object(e.jsxs)("b",{children:[(y.probability[f]*100).toFixed(1),"%"]})]})]},h))}):pe&&Object(e.jsx)("div",{className:"text-center",children:Object(e.jsx)(ie.a,{active:!0})}),y?Object(e.jsx)(b.BindLogic,{logic:ye.c,props:{dashboardItemId:y.itemID,cachedInsight:{short_id:y.itemID,filters:j(j(M(j({},y.filters),{insight:w}),w===u.F.FUNNELS&&{layout:Te.k.vertical,funnel_viz_type:u.B.Steps}),w===u.F.TRENDS&&{display:u.k.ActionsLineGraphCumulative}),result:y.insight,disable_baseline:!0},doNotLoad:!0},children:Object(e.jsx)("div",{className:"mt-4",children:Object(e.jsx)(Je.a,{disableHeader:!0,disableCorrelationTable:w===u.F.FUNNELS,disableLastComputation:!0})})}):s.start_date&&Object(e.jsx)(e.Fragment,{children:Object(e.jsx)("div",{className:"no-experiment-results",children:!pe&&Object(e.jsxs)("div",{className:"text-center",children:[Object(e.jsx)("b",{children:"There are no results for this experiment yet."}),Object(e.jsxs)("div",{className:"text-sm ",children:[!!re&&`${re}. `," ","Wait a bit longer for your users to be exposed to the experiment. Double check your feature flag implementation if you're still not seeing results."]})]})})})]})]}):Object(e.jsx)(ie.a,{active:!0})})}},"./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/experiments/Experiment.scss":function(V,_,c){var ie=c("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/runtime/api.js");_=ie(!1),_.push([V.i,'.experiment-form .metrics-selection,.experiment-form .person-selection{border-top:1px solid var(--border);padding-top:1rem;width:100%}.experiment-form .person-selection{align-items:center;justify-content:space-between}.experiment-form .insights-graph-container{margin-bottom:1rem;background-color:#fff}.experiment-form .insights-graph-container .ant-card-head{border-bottom:1px solid var(--border);min-height:unset;background-color:var(--bg-light);padding-left:1rem;padding-right:1rem}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title{padding:.5rem 0}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter{font-size:14px}.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter:not(:last-child),.experiment-form .insights-graph-container .ant-card-head .ant-card-head-title span.filter span.head-title-item{margin-right:.5rem}.experiment-form .insights-graph-container .display-config-inner{display:flex;align-items:center;justify-content:space-between;overflow-x:auto}.experiment-form .insights-graph-container .ant-card-body{padding:0}.experiment-form .insights-graph-container .insights-graph-container-row .insights-graph-container-row-left{width:100%}.experiment-form .insights-graph-container .insights-graph-container-row .insights-graph-container-row-right{width:100%;height:min(90vh - 16rem,36rem);max-width:300px;padding:0 1rem 1rem 0;display:flex;align-items:center}.experiment-form .insights-graph-container .LineGraph{width:calc(100% - 2rem);height:calc(100% - 3rem)}.experiment-form .insights-graph-header{margin-top:0!important;margin-bottom:0!important;padding-left:1rem;padding-right:1rem;min-height:48px}.experiment-form .experiment-preview{margin-bottom:1rem;border-bottom:1px solid var(--border)}.experiment-form .experiment-preview .mde-slider .ant-slider-handle{border:none}.experiment-form .experiment-preview .mde-slider .ant-slider-rail{background-color:#e5ebff}.experiment-form .variants{margin-top:.5rem;padding-bottom:1rem}.experiment-form .variants .ant-form-horizontal{min-height:32px}.experiment-form .variants .border-top{border-top-left-radius:4px;border-top-right-radius:4px}.experiment-form .variants .border-bottom{border-bottom-left-radius:4px;border-bottom-right-radius:4px}.experiment-form .variants .feature-flag-variant{display:flex;align-items:center;padding:.5rem;background:#fff;border-bottom-width:1px;border-bottom-color:var(--border);border-top:1px solid var(--border);border-left:1px solid var(--border);border-right:1px solid var(--border)}.experiment-form .variants .feature-flag-variant .extend-variant-fully{flex:1}.experiment-form .variants .variant-label{display:flex;flex-direction:row;justify-content:center;align-items:center;border-radius:4px;color:#fff;min-width:52px;padding:2px 6px;margin-right:8px;font-size:12px;font-weight:500;letter-spacing:.01em}.experiment-form .secondary-metrics{margin-top:1rem;padding-top:1rem;border-top:1px solid var(--border);margin-bottom:1rem;width:100%}.experiment-form .ant-input-number-disabled,.experiment-form .ant-input[disabled]{color:#000}.view-experiment .draft-header{margin-bottom:1rem;border-bottom:1px solid var(--border)}.view-experiment .exp-description{font-style:italic;color:var(--muted)}.view-experiment .participants{background-color:#fff}.view-experiment .participants .ant-collapse-header{padding-top:.5rem;padding-bottom:.5rem;padding-left:.75rem}.view-experiment .variants-list li{display:inline}.view-experiment .variants-list li:after{content:", "}.view-experiment .variants-list li:last-child:after{content:""}.view-experiment .experiment-result{padding-top:1rem}.view-experiment .significant-results{padding:.5rem;width:100%;background:rgba(119,185,108,.1);border-radius:4px;text-align:center;margin-bottom:1rem}.view-experiment .not-significant-results{padding:.5rem;width:100%;background:rgba(83,117,255,.1);border-radius:4px;margin-bottom:1rem}.view-experiment .feature-flag-mods{padding:.5rem;width:100%;background:#f6ebf8;border-radius:4px;margin-bottom:1rem}.view-experiment .ant-collapse-content-box{display:flex;flex-flow:column}.view-experiment .secondary-progress{margin-top:.5rem}.view-experiment .secondary-progress li:before{content:"\u2022";display:inline-block;font-weight:900;margin-right:4px}.view-experiment .secondary-progress .ant-progress-inner,.view-experiment .secondary-progress .ant-progress-inner .ant-progress-bg{border-radius:4px}.view-experiment .no-experiment-results{display:flex;justify-content:center;align-items:center;margin-top:1rem;background-color:var(--side);border:1px solid var(--border);width:100%;min-height:320px;font-size:24px}.preview-conversion-goal-num{height:24px;width:24px;text-align:center;background-color:var(--side);color:var(--primary-alt);font-weight:700;margin-right:.5rem}.experiment-preview-row{border-bottom:1px solid var(--border);padding-bottom:1rem;margin-bottom:1rem}.experiment-preview-row:last-child{border-bottom:none;padding-bottom:0;margin-bottom:0}.metric-name{border:1px solid var(--border);border-radius:4px;padding:8px 8px 8px 16px;margin-left:.5rem;flex:1}.experiment-implementation-details,.experiment-workflow{border-color:var(--dark-grey)}.experiment-implementation-details .ant-card-head,.experiment-workflow .ant-card-head{padding-left:1rem;padding-right:1rem;border:none}.experiment-implementation-details .ant-card-head-title,.experiment-workflow .ant-card-head-title{border-bottom:1px solid var(--border)}.experiment-implementation-details .exp-workflow-step,.experiment-workflow .exp-workflow-step{margin-bottom:.5rem;padding:.5rem;border-radius:4px}.experiment-implementation-details .exp-workflow-step:hover,.experiment-workflow .exp-workflow-step:hover{cursor:pointer}.experiment-implementation-details .step-completed,.experiment-workflow .step-completed{background-color:#e5ebff}',""]),V.exports=_}}]);
