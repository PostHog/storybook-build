"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[14471],{"../../frontend/src/scenes/data-warehouse/DataWarehouseScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DataWarehouseScene:()=>DataWarehouseScene,scene:()=>scene});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.35.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),NotFound=__webpack_require__("../../frontend/src/lib/components/NotFound/index.tsx"),constants=__webpack_require__("../../frontend/src/lib/constants.tsx"),LemonTabs=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTabs/index.ts"),featureFlagLogic=__webpack_require__("../../frontend/src/lib/logic/featureFlagLogic.ts"),sceneTypes=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),scenes=__webpack_require__("../../frontend/src/scenes/scenes.ts"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),SceneContent=__webpack_require__("../../frontend/src/layout/scenes/components/SceneContent.tsx"),SceneTitleSection=__webpack_require__("../../frontend/src/layout/scenes/components/SceneTitleSection.tsx"),lib=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.7_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),kea_router_lib=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),dist_module=__webpack_require__("../../node_modules/.pnpm/posthog-js@1.288.1/node_modules/posthog-js/dist/module.js"),api=__webpack_require__("../../frontend/src/lib/api.ts"),dayjs=__webpack_require__("../../frontend/src/lib/dayjs.ts"),billingLogic=__webpack_require__("../../frontend/src/scenes/billing/billingLogic.tsx"),databaseTableListLogic=__webpack_require__("../../frontend/src/scenes/data-management/database/databaseTableListLogic.ts"),externalDataSourcesLogic=__webpack_require__("../../frontend/src/scenes/data-warehouse/externalDataSourcesLogic.ts"),dataWarehouseViewsLogic=__webpack_require__("../../frontend/src/scenes/data-warehouse/saved_queries/dataWarehouseViewsLogic.tsx");let DataWarehouseTab=function(DataWarehouseTab){return DataWarehouseTab.OVERVIEW="overview",DataWarehouseTab.SOURCES="sources",DataWarehouseTab}({}),dataWarehouseSceneLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","data-warehouse","dataWarehouseSceneLogic"]),(0,index_esm.connect)(()=>({values:[databaseTableListLogic.A,["dataWarehouseTables","views","databaseLoading"],externalDataSourcesLogic.W,["dataWarehouseSources","dataWarehouseSourcesLoading"],billingLogic.billingLogic,["billingPeriodUTC"],dataWarehouseViewsLogic.$,["dataWarehouseSavedQueryMapById"]],actions:[databaseTableListLogic.A,["loadDatabase"],externalDataSourcesLogic.W,["loadSources","loadSourcesSuccess"]]})),(0,index_esm.actions)({loadMoreRecentActivity:!0,setActivityCurrentPage:page=>({page}),checkAutoLoadMore:!0,setActiveTab:tab=>({tab})}),(0,lib.loaders)(()=>({totalRowsStats:[{},{loadTotalRowsStats:async()=>await api.ZP.dataWarehouse.totalRowsStats()}],recentActivityResponse:[null,{loadRecentActivityResponse:async()=>await api.ZP.dataWarehouse.recentActivity({limit:20,offset:0})}],jobStats:[null,{loadJobStats:async _ref=>{let{days}=_ref;return await api.ZP.dataWarehouse.jobStats({days})}}]})),(0,index_esm.reducers)(()=>({activeTab:[DataWarehouseTab.OVERVIEW,{setActiveTab:(_,_ref2)=>{let{tab}=_ref2;return tab}}],activityCurrentPage:[1,{setActivityCurrentPage:(_,_ref3)=>{let{page}=_ref3;return page},loadRecentActivityResponse:()=>1}],recentActivityMoreLoading:[!1,{loadMoreRecentActivity:()=>!0,loadRecentActivityResponseSuccess:()=>!1}]})),(0,index_esm.selectors)({recentActivity:[s=>[s.recentActivityResponse],response=>response?.results||[]],recentActivityHasMore:[s=>[s.recentActivityResponse],response=>!!response?.next],selfManagedTables:[s=>[s.dataWarehouseTables],dataWarehouseTables=>dataWarehouseTables.filter(table=>!table.source)],computedAllSources:[s=>[s.dataWarehouseSources,s.recentActivity,s.selfManagedTables,s.billingPeriodUTC,s.totalRowsStats],(dataWarehouseSources,recentActivity,selfManagedTables,billingPeriodUTC,totalRowsStats)=>{let billingPeriodStart=billingPeriodUTC?.start,billingPeriodEnd=billingPeriodUTC?.end;return[...(dataWarehouseSources?.results||[]).map(source=>{var _totalRowsStats$break;let sourceActivities=(recentActivity||[]).filter(a=>!billingPeriodStart||!billingPeriodEnd||(0,dayjs.Bv)(a.created_at).isAfter(billingPeriodStart.subtract(1,"millisecond"))&&(0,dayjs.Bv)(a.created_at).isBefore(billingPeriodEnd)),totalRows=null!==(_totalRowsStats$break=totalRowsStats?.breakdown_of_rows_by_source?.[source.id])&&void 0!==_totalRowsStats$break?_totalRowsStats$break:0,sortedActivities=sourceActivities.sort((a,b)=>(0,dayjs.Bv)(b.created_at).valueOf()-(0,dayjs.Bv)(a.created_at).valueOf()),lastSync=sortedActivities.length>0?sortedActivities[0].created_at:null;return{id:source.id,name:source.source_type,status:source.status,lastSync,rowCount:totalRows,url:urls.j.dataWarehouseSource(`managed-${source.id}`)}}),...(selfManagedTables||[]).map(table=>{var _table$row_count;return{id:table.id,name:table.name,status:null,lastSync:null,rowCount:null!==(_table$row_count=table.row_count)&&void 0!==_table$row_count?_table$row_count:null,url:urls.j.dataWarehouseSource(`self-managed-${table.id}`)}})]}],activityPaginationState:[s=>[s.recentActivity,s.activityCurrentPage],(recentActivity,activityCurrentPage)=>{let totalData=recentActivity.length,pageCount=Math.ceil(totalData/8),startIndex=(activityCurrentPage-1)*8,endIndex=Math.min(startIndex+8,totalData),dataSourcePage=recentActivity.slice(startIndex,endIndex);return{currentPage:activityCurrentPage,pageCount,dataSourcePage,currentStartIndex:startIndex,currentEndIndex:endIndex,entryCount:totalData,isOnLastPage:activityCurrentPage===pageCount,hasDataOnCurrentPage:dataSourcePage.length>0}}],tablesLoading:[s=>[s.databaseLoading,s.dataWarehouseSourcesLoading],(databaseLoading,dataWarehouseSourcesLoading)=>databaseLoading||dataWarehouseSourcesLoading]}),(0,index_esm.listeners)(_ref4=>{let{values,actions,cache}=_ref4;return{setActivityCurrentPage:()=>{actions.checkAutoLoadMore()},checkAutoLoadMore:()=>{let{isOnLastPage,hasDataOnCurrentPage}=values.activityPaginationState,{recentActivityHasMore,recentActivityResponseLoading}=values;isOnLastPage&&hasDataOnCurrentPage&&recentActivityHasMore&&!recentActivityResponseLoading&&actions.loadMoreRecentActivity()},loadMoreRecentActivity:async()=>{try{let currentData=values.recentActivity,response=await api.ZP.dataWarehouse.recentActivity({limit:20,offset:currentData.length}),newData=[...currentData,...response.results||[]],newResponse={...response,results:newData};actions.loadRecentActivityResponseSuccess(newResponse)}catch(error){dist_module.ZP.captureException(error)}},loadSourcesSuccess:()=>{cache.disposables.dispose("refreshTimeout"),kea_router_lib.router.values.location.pathname.includes("data-warehouse")&&cache.disposables.add(()=>{let timerId=setTimeout(()=>{actions.loadSources(null)},1e4);return()=>clearTimeout(timerId)},"refreshTimeout")}}}),(0,index_esm.afterMount)(_ref5=>{let{actions}=_ref5;actions.loadSources(null),actions.loadRecentActivityResponse(),actions.loadTotalRowsStats(),actions.loadJobStats({days:7})})]);var TZLabel=__webpack_require__("../../frontend/src/lib/components/TZLabel/index.tsx"),LemonTable=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/index.ts"),PaginationControl=__webpack_require__("../../frontend/src/lib/lemon-ui/PaginationControl/index.ts"),react=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),LineGraph=__webpack_require__("../../frontend/src/queries/nodes/DataVisualization/Components/Charts/LineGraph.tsx"),types=__webpack_require__("../../frontend/src/types.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function JobStatsChart(_ref){let{jobStats}=_ref,{xData,yData}=(0,react.useMemo)(()=>{if(!jobStats?.breakdown)return{xData:null,yData:[]};let timestamps=Object.keys(jobStats.breakdown).sort(),successData=timestamps.map(ts=>jobStats.breakdown[ts].successful),failedData=timestamps.map(ts=>jobStats.breakdown[ts].failed),isHourly=1===jobStats.days,labels=timestamps.map(ts=>{let d=new Date(ts);return isHourly?d.toLocaleTimeString("en-US",{hour:"numeric",hour12:!0}):d.toLocaleDateString("en-US",{month:"short",day:"numeric"})});return{xData:{column:{name:"timestamp",type:{name:"STRING",isNumerical:!1},label:"Time",dataIndex:0},data:labels},yData:[{column:{name:"successful",type:{name:"INTEGER",isNumerical:!0},label:"Successful",dataIndex:0},data:successData,settings:{display:{color:getComputedStyle(document.body).getPropertyValue("--success").trim()||"#388600",displayType:"bar"}}},{column:{name:"failed",type:{name:"INTEGER",isNumerical:!0},label:"Failed",dataIndex:1},data:failedData,settings:{display:{color:getComputedStyle(document.body).getPropertyValue("--danger").trim()||"#db3707",displayType:"bar"}}}]}},[jobStats]);return jobStats?.breakdown?(0,jsx_runtime.jsx)(LineGraph.x,{className:"h-64",xData:xData,yData:yData,visualizationType:types.Qb.ActionsStackedBar,chartSettings:{stackBars100:!1}}):(0,jsx_runtime.jsx)("div",{className:"relative h-64 flex items-center justify-center",children:"No data available"})}var icons=__webpack_require__("../../frontend/src/lib/lemon-ui/icons/index.ts"),utils=__webpack_require__("../../frontend/src/scenes/data-warehouse/utils.ts");function StatusIcon(_ref){let{status}=_ref;return status?status===types.mZ.Failed?(0,jsx_runtime.jsx)(icons.uR,{className:"text-danger"}):status===types.mZ.BillingLimits||status===types.mZ.BillingLimitTooLow?(0,jsx_runtime.jsx)(icons.qV,{className:"text-warning"}):status===types.mZ.Running?(0,jsx_runtime.jsx)(icons.JK,{className:"animate-spin"}):status===types.mZ.Completed?(0,jsx_runtime.jsx)(posthog_icons_es.IconCheckCircle,{className:"text-success"}):(0,jsx_runtime.jsx)(icons.i4,{className:"text-muted"}):(0,jsx_runtime.jsx)(icons.i4,{className:"text-muted"})}function StatusTag(_ref2){let{status}=_ref2;if(!status)return(0,jsx_runtime.jsx)(src.oe,{size:"small",type:"muted",className:"px-1 rounded-lg",children:"â€”"});let type=utils.IM[status]||"muted";return(0,jsx_runtime.jsx)(src.oe,{size:"medium",type:type,className:"px-1 rounded-lg",children:status})}function OverviewTab(){var _totalRowsStats$total,_jobStats$external_da,_jobStats$modeling_jo,_jobStats$days;let{activityPaginationState,totalRowsStats,totalRowsStatsLoading,tablesLoading,jobStats,jobStatsLoading}=(0,index_esm.useValues)(dataWarehouseSceneLogic),{setActivityCurrentPage,loadJobStats}=(0,index_esm.useActions)(dataWarehouseSceneLogic),activityPagination={currentPage:activityPaginationState.currentPage,pageCount:activityPaginationState.pageCount,dataSourcePage:activityPaginationState.dataSourcePage,currentStartIndex:activityPaginationState.currentStartIndex,currentEndIndex:activityPaginationState.currentEndIndex,entryCount:activityPaginationState.entryCount,setCurrentPage:setActivityCurrentPage,pagination:{pageSize:8}},activityColumns=[{title:"Activity",key:"name",render:(_,activity)=>(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1",children:[(0,jsx_runtime.jsx)(StatusIcon,{status:activity.status}),(0,jsx_runtime.jsx)("span",{children:activity.name}),(0,jsx_runtime.jsx)(src.oe,{size:"medium",type:"muted",className:"px-1 rounded-lg ml-1",children:activity.type})]})},{title:"When",key:"created_at",tooltip:"Time when this job was created",render:(_,activity)=>(0,jsx_runtime.jsx)(TZLabel.w,{time:activity.created_at})},{title:"Rows",key:"rows",align:"right",tooltip:"Number of rows processed in this job",render:(_,activity)=>null!==activity.rows?activity.rows.toLocaleString():"0"},{title:"Status",key:"status",align:"right",render:(_,activity)=>(0,jsx_runtime.jsx)(StatusTag,{status:activity.status})}];return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-6 gap-4",children:[(0,jsx_runtime.jsx)(src.Mi,{className:"p-4 hover:transform-none",children:(0,jsx_runtime.jsxs)("div",{className:"space-y-6",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-start gap-1",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm text-muted",children:"Rows Processed"}),(0,jsx_runtime.jsx)(src.u,{title:"Total rows processed this month by all data sources and materialized views",placement:"bottom",children:(0,jsx_runtime.jsx)(posthog_icons_es.IconInfo,{className:"text-muted mt-0.5"})})]}),(0,jsx_runtime.jsx)("div",{className:"text-2xl font-semibold mt-1 flex items-center gap-2",children:totalRowsStatsLoading&&!totalRowsStats?.total_rows?(0,jsx_runtime.jsx)(src.$j,{className:"text-muted"}):(null!==(_totalRowsStats$total=totalRowsStats?.total_rows)&&void 0!==_totalRowsStats$total?_totalRowsStats$total:0).toLocaleString()})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{className:"text-sm text-muted",children:"Currently running source syncs"}),(0,jsx_runtime.jsx)("div",{className:"text-2xl font-semibold mt-1 flex items-center gap-2",children:jobStatsLoading&&!jobStats?(0,jsx_runtime.jsx)(src.$j,{className:"text-muted"}):null!==(_jobStats$external_da=jobStats?.external_data_jobs.running)&&void 0!==_jobStats$external_da?_jobStats$external_da:0})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{className:"text-sm text-muted",children:"Currently running materialized views"}),(0,jsx_runtime.jsx)("div",{className:"text-2xl font-semibold mt-1 flex items-center gap-2",children:jobStatsLoading&&!jobStats?(0,jsx_runtime.jsx)(src.$j,{className:"text-muted"}):null!==(_jobStats$modeling_jo=jobStats?.modeling_jobs.running)&&void 0!==_jobStats$modeling_jo?_jobStats$modeling_jo:0})]})]})}),(0,jsx_runtime.jsxs)(src.Mi,{className:"p-4 hover:transform-none lg:col-span-5",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-start gap-1",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm text-muted",children:"Sync Success Rate"}),(0,jsx_runtime.jsx)(src.u,{title:"Success and failure rate of data warehouse syncs",placement:"bottom",children:(0,jsx_runtime.jsx)(posthog_icons_es.IconInfo,{className:"text-muted mt-0.5"})})]}),jobStatsLoading&&(0,jsx_runtime.jsx)(src.$j,{className:"text-muted"})]}),(0,jsx_runtime.jsx)(src.P4,{size:"xsmall",value:null!==(_jobStats$days=jobStats?.days)&&void 0!==_jobStats$days?_jobStats$days:7,onChange:value=>loadJobStats({days:value}),options:[{value:1,label:"24h"},{value:7,label:"7d"},{value:30,label:"30d"}]})]}),jobStats&&(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{className:"text-xs text-muted",children:"Total Jobs"}),(0,jsx_runtime.jsx)("div",{className:"text-xl font-semibold",children:jobStats.total_jobs.toLocaleString()})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{className:"text-xs text-muted",children:"Successful"}),(0,jsx_runtime.jsx)("div",{className:"text-xl font-semibold text-success flex items-center gap-1",children:jobStats.successful_jobs.toLocaleString()})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{className:"text-xs text-muted",children:"Failed"}),(0,jsx_runtime.jsx)("div",{className:"text-xl font-semibold text-danger flex items-center gap-1",children:jobStats.failed_jobs.toLocaleString()})]})]}),jobStats.total_jobs>0&&(0,jsx_runtime.jsx)("div",{className:"pt-2",children:(0,jsx_runtime.jsx)(JobStatsChart,{jobStats:jobStats})})]})]})]}),(0,jsx_runtime.jsxs)(src.Mi,{className:"hover:transform-none mt-4",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2 pb-2",children:[(0,jsx_runtime.jsx)("span",{className:"font-semibold text-xl",children:"Recent Activity"}),tablesLoading&&0!==activityPagination.dataSourcePage.length&&(0,jsx_runtime.jsx)(src.$j,{className:"text-muted"})]}),(0,jsx_runtime.jsx)(LemonTable.g,{dataSource:activityPagination.dataSourcePage,columns:activityColumns,rowKey:r=>`${r.type}-${r.name}-${r.created_at}`,loading:tablesLoading&&0===activityPagination.dataSourcePage.length,loadingSkeletonRows:3}),(0,jsx_runtime.jsx)("div",{className:"px-4 pb-4",children:(0,jsx_runtime.jsx)(PaginationControl.R,{...activityPagination,nouns:["activity","activities"]})})]})]})}var SceneDivider=__webpack_require__("../../frontend/src/layout/scenes/components/SceneDivider.tsx"),SceneSection=__webpack_require__("../../frontend/src/layout/scenes/components/SceneSection.tsx"),DataWarehouseManagedSourcesTable=__webpack_require__("../../frontend/src/scenes/data-warehouse/settings/DataWarehouseManagedSourcesTable.tsx"),DataWarehouseSelfManagedSourcesTable=__webpack_require__("../../frontend/src/scenes/data-warehouse/settings/DataWarehouseSelfManagedSourcesTable.tsx");function SourcesTab(){return(0,jsx_runtime.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,jsx_runtime.jsx)(SceneSection.S,{title:"Managed data warehouse sources",description:"PostHog can connect to external sources and automatically import data from them into the PostHog data warehouse",children:(0,jsx_runtime.jsx)(DataWarehouseManagedSourcesTable.l,{})}),(0,jsx_runtime.jsx)(SceneDivider.V,{}),(0,jsx_runtime.jsx)(SceneSection.S,{title:"Self-managed data warehouse sources",description:"Connect to your own data sources, making them queryable in PostHog",children:(0,jsx_runtime.jsx)(DataWarehouseSelfManagedSourcesTable.T,{})})]})}let scene={component:DataWarehouseScene,logic:dataWarehouseSceneLogic};function DataWarehouseScene(){let{featureFlags}=(0,index_esm.useValues)(featureFlagLogic.featureFlagLogic),{activeTab}=(0,index_esm.useValues)(dataWarehouseSceneLogic),{setActiveTab}=(0,index_esm.useActions)(dataWarehouseSceneLogic);return featureFlags[constants.y8.DATA_WAREHOUSE_SCENE]?(0,jsx_runtime.jsxs)(SceneContent._,{children:[(0,jsx_runtime.jsx)(SceneTitleSection.s,{name:scenes.lc[sceneTypes.x.DataWarehouse].name,description:scenes.lc[sceneTypes.x.DataWarehouse].description,resourceType:{type:scenes.lc[sceneTypes.x.DataWarehouse].iconType||"default_icon_type"},actions:(0,jsx_runtime.jsxs)("div",{className:"flex gap-2",children:[(0,jsx_runtime.jsx)(src.Jp,{type:"secondary",to:urls.j.sqlEditor(),size:"small",children:"Create view"}),(0,jsx_runtime.jsx)(src.Jp,{type:"primary",to:urls.j.dataWarehouseSourceNew(),icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconPlusSmall,{}),size:"small",children:"New source"})]})}),(0,jsx_runtime.jsx)(LemonTabs.T,{activeKey:activeTab,onChange:newKey=>setActiveTab(newKey),sceneInset:!0,tabs:[{key:DataWarehouseTab.OVERVIEW,label:"Overview",content:(0,jsx_runtime.jsx)(OverviewTab,{})},{key:DataWarehouseTab.SOURCES,label:"Sources",content:(0,jsx_runtime.jsx)(SourcesTab,{})}]})]}):(0,jsx_runtime.jsx)(NotFound.T,{object:"Data Warehouse"})}},"../../frontend/src/scenes/data-warehouse/settings/DataWarehouseSelfManagedSourcesTable.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{T:()=>DataWarehouseSelfManagedSourcesTable});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),lib_lemon_ui_LemonTable_LemonTableLink__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/LemonTableLink.tsx"),scenes_data_warehouse_settings_DataWarehouseSourceIcon__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/scenes/data-warehouse/settings/DataWarehouseSourceIcon.tsx"),scenes_urls__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/scenes/urls.ts"),_dataWarehouseSettingsLogic__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/scenes/data-warehouse/settings/dataWarehouseSettingsLogic.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function DataWarehouseSelfManagedSourcesTable(){let{filteredSelfManagedTables,searchTerm}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(_dataWarehouseSettingsLogic__WEBPACK_IMPORTED_MODULE_5__.T),{deleteSelfManagedTable,refreshSelfManagedTableSchema,setSearchTerm}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(_dataWarehouseSettingsLogic__WEBPACK_IMPORTED_MODULE_5__.T);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"flex gap-2 justify-between items-center mb-4",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.DF,{type:"search",placeholder:"Search...",onChange:setSearchTerm,value:searchTerm})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.g3,{id:"self-managed-sources",dataSource:filteredSelfManagedTables,pagination:{pageSize:10},columns:[{width:0,render:(_,item)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(scenes_data_warehouse_settings_DataWarehouseSourceIcon__WEBPACK_IMPORTED_MODULE_3__.Ug,{type:(0,scenes_data_warehouse_settings_DataWarehouseSourceIcon__WEBPACK_IMPORTED_MODULE_3__.Zi)(item.url_pattern)})},{title:"Source",dataIndex:"name",key:"name",render:(_,item)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(lib_lemon_ui_LemonTable_LemonTableLink__WEBPACK_IMPORTED_MODULE_2__.i,{to:scenes_urls__WEBPACK_IMPORTED_MODULE_4__.j.dataWarehouseSource(`self-managed-${item.id}`),title:item.name})},{key:"actions",render:(_,item)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"flex flex-row justify-end",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{"data-attr":`refresh-data-warehouse-${item.name}`,onClick:()=>refreshSelfManagedTableSchema(item.id),children:"Update schema from source"},`refresh-data-warehouse-${item.name}`),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{status:"danger","data-attr":`delete-data-warehouse-${item.name}`,onClick:()=>{_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.dn.open({title:"Delete table?",description:"Table deletion cannot be undone. All views and joins related to this table will be deleted.",primaryButton:{children:"Delete",status:"danger",onClick:()=>{deleteSelfManagedTable(item.id)}},secondaryButton:{children:"Cancel"}})},children:"Delete"},`delete-data-warehouse-${item.name}`)]})}]})]})}}}]);