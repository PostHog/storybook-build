(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"./frontend/src/lib/components/ExportButton/ExportButton.tsx":function(J,_,e){"use strict";e.d(_,"a",function(){return s});var F=e("./node_modules/@babel/runtime/helpers/extends.js"),De=e.n(F),R=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),t=e.n(R),i=e("./node_modules/core-js/modules/es.array.map.js"),O=e.n(i),k=e("./node_modules/core-js/modules/es.regexp.exec.js"),pe=e.n(k),oe=e("./node_modules/core-js/modules/es.string.split.js"),Be=e.n(oe),q=e("./node_modules/react/index.js"),N=e.n(q),X=e("./frontend/src/lib/components/LemonButton/index.ts"),w=e("./node_modules/kea/lib/index.esm.js"),B=e("./frontend/src/lib/components/ExportButton/exporterLogic.ts"),ne=e("./frontend/src/lib/components/LemonDivider/index.ts"),H=e("./frontend/src/scenes/insights/insightLogic.ts"),U=["dashboardId","insightShortId"];function s(v){var P=v.dashboardId,G=v.insightShortId,A=t()(v,U),ee={dashboardItemId:G,doNotLoad:!0},l=Object(w.useValues)(Object(H.c)(ee)),b=l.supportsCsvExport,T=l.csvExportUrl,m=l.insight,te=Object(w.useActions)(Object(B.b)({dashboardId:P,insightId:m==null?void 0:m.id})),_e=te.exportItem,de=Object(w.useValues)(Object(B.b)({dashboardId:P,insightId:m==null?void 0:m.id})),Se=de.exportInProgress,E=[];(P||G)&&E.push(B.a.PNG),b&&E.push(B.a.CSV);var le=function(Q){if(Q===B.a.CSV){window.open(T,"_blank");return}_e(Q)};return N.a.createElement(X.b,De()({type:"stealth",loading:Se,"data-attr":"export-button"},A,{popup:{actionable:!0,placement:"right-start",overlay:N.a.createElement(N.a.Fragment,null,N.a.createElement("h5",null,"File type"),N.a.createElement(ne.a,null),E.map(function(ie){return N.a.createElement(X.a,{key:ie,fullWidth:!0,type:"stealth",onClick:function(){return le(ie)},"data-attr":"export-button-".concat(ie.split("/").pop())},".",ie.split("/").pop())}))}}),"Export")}try{s.displayName="ExportButton",s.__docgenInfo={description:"",displayName:"ExportButton",props:{dashboardId:{defaultValue:null,description:"",name:"dashboardId",required:!1,type:{name:"number"}},insightShortId:{defaultValue:null,description:"",name:"insightShortId",required:!1,type:{name:"InsightShortId"}},icon:{defaultValue:null,description:"",name:"icon",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>> | null"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"alt"'},{value:'"default"'},{value:'"primary"'},{value:'"secondary"'},{value:'"tertiary"'},{value:'"stealth"'},{value:'"highlighted"'}]}},fullWidth:{defaultValue:null,description:"Whether the row should take up the parent's full width.",name:"fullWidth",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/ExportButton/ExportButton.tsx#ExportButton"]={docgenInfo:s.__docgenInfo,name:"ExportButton",path:"frontend/src/lib/components/ExportButton/ExportButton.tsx#ExportButton"})}catch(v){}},"./frontend/src/lib/components/ExportButton/exporterLogic.ts":function(J,_,e){"use strict";e.d(_,"a",function(){return W}),e.d(_,"b",function(){return He});var F=e("./node_modules/core-js/modules/es.object.keys.js"),De=e.n(F),R=e("./node_modules/core-js/modules/es.symbol.js"),t=e.n(R),i=e("./node_modules/core-js/modules/es.array.filter.js"),O=e.n(i),k=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),pe=e.n(k),oe=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Be=e.n(oe),q=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),N=e.n(q),X=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),w=e.n(X),B=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),ne=e.n(B),H=e("./node_modules/@babel/runtime/regenerator/index.js"),U=e.n(H),s=e("./node_modules/core-js/modules/es.array.concat.js"),v=e.n(s),P=e("./node_modules/core-js/modules/es.array.iterator.js"),G=e.n(P),A=e("./node_modules/core-js/modules/es.object.to-string.js"),ee=e.n(A),l=e("./node_modules/core-js/modules/es.string.iterator.js"),b=e.n(l),T=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),m=e.n(T),te=e("./node_modules/core-js/modules/web.url.js"),_e=e.n(te),de=e("./node_modules/core-js/modules/web.url-search-params.js"),Se=e.n(de),E=e("./node_modules/kea/lib/index.esm.js"),le=e("./frontend/src/lib/api.ts"),ie=e("./frontend/src/lib/utils.tsx"),Q=e("./node_modules/posthog-js/dist/es.js"),ce=e("./frontend/src/lib/components/lemonToast.tsx");function Y(c,f){var h=Object.keys(c);if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(c);f&&(M=M.filter(function(me){return Object.getOwnPropertyDescriptor(c,me).enumerable})),h.push.apply(h,M)}return h}function S(c){for(var f=1;f<arguments.length;f++){var h=arguments[f]!=null?arguments[f]:{};f%2?Y(Object(h),!0).forEach(function(M){w()(c,M,h[M])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(h)):Y(Object(h)).forEach(function(M){Object.defineProperty(c,M,Object.getOwnPropertyDescriptor(h,M))})}return c}var We=1e3,ue=10,W;(function(c){c.PNG="image/png",c.CSV="text/csv",c.PDF="application/pdf"})(W||(W={}));function Ue(c){return Ce.apply(this,arguments)}function Ce(){return Ce=ne()(U.a.mark(function c(f){var h,M,me,ve,$;return U.a.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return h=le.b.exports.determineExportUrl(f.id),K.next=3,le.b.getRaw(h);case 3:return M=K.sent,K.next=6,M.blob();case 6:me=K.sent,ve=window.URL.createObjectURL(me),$=document.createElement("a"),$.style.display="none",$.href=ve,$.download=f.filename,document.body.appendChild($),$.click(),window.URL.revokeObjectURL(ve);case 15:case"end":return K.stop()}},c)})),Ce.apply(this,arguments)}var He=Object(E.kea)([Object(E.path)(["lib","components","ExportButton","ExporterLogic"]),Object(E.props)({}),Object(E.key)(function(c){var f=c.dashboardId,h=c.insightId;return"dash:".concat(f,"::insight:").concat(h)}),Object(E.actions)({exportItem:function(f,h,M){return{exportFormat:f,exportContext:h,successCallback:M}},exportItemSuccess:!0,exportItemFailure:!0}),Object(E.reducers)({exportInProgress:[!1,{exportItem:function(){return!0},exportItemSuccess:function(){return!1},exportItemFailure:function(){return!1}}]}),Object(E.listeners)(function(c){var f=c.actions,h=c.props;return{exportItem:function(){var M=ne()(U.a.mark(function ve($){var ye,K,xe,he,Ie,Ee,Le;return U.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return ye=$.exportFormat,K=$.exportContext,xe=$.successCallback,ce.d.info("Export started..."),he={export_format:ye,dashboard:h.dashboardId,insight:h.insightId,total_time_ms:0},Ie=performance.now(),p.prev=4,p.next=7,le.b.exports.create(S({export_format:ye,dashboard:h.dashboardId,insight:h.insightId},K||{}));case 7:if(Ee=p.sent,Ee.id){p.next=10;break}throw new Error("Missing export_id from response");case 10:Le=0;case 11:if(!(Le<ue)){p.next=29;break}if(Le++,!Ee.has_content){p.next=22;break}return f.exportItemSuccess(),ce.d.success("Export complete."),xe==null||xe(),p.next=19,Ue(Ee);case 19:return he.total_time_ms=performance.now()-Ie,Q.a.capture("export succeeded",he),p.abrupt("return");case 22:return p.next=24,Object(ie.w)(We);case 24:return p.next=26,le.b.exports.get(Ee.id);case 26:Ee=p.sent,p.next=11;break;case 29:throw new Error("Content not loaded in time...");case 32:p.prev=32,p.t0=p.catch(4),f.exportItemFailure(),he.total_time_ms=performance.now()-Ie,Q.a.capture("export failed",he),ce.d.error("Export failed: ".concat(JSON.stringify(p.t0)));case 38:case"end":return p.stop()}},ve,null,[[4,32]])}));function me(ve){return M.apply(this,arguments)}return me}()}})])},"./frontend/src/lib/hooks/useKeyboardHotkeys.tsx":function(J,_,e){"use strict";e.d(_,"a",function(){return ne});var F=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),De=e.n(F),R=e("./node_modules/core-js/modules/es.array.includes.js"),t=e.n(R),i=e("./node_modules/core-js/modules/es.string.includes.js"),O=e.n(i),k=e("./node_modules/core-js/modules/es.object.to-string.js"),pe=e.n(k),oe=e("./node_modules/core-js/modules/es.object.keys.js"),Be=e.n(oe),q=e("./node_modules/core-js/modules/es.array.concat.js"),N=e.n(q),X=e("./frontend/src/lib/hooks/useEventListener.ts"),w=function(U,s){var v=U.composedPath()||U.path;if(!v)return!1;var P=v[0],G=P.tagName||"not an html element";return s.includes(G.toLowerCase())},B=[".hotkey-block",".hotkey-block *"];function ne(H,U){var s=["input","textarea"];Object(X.a)("keydown",function(v){var P=v.key;if(!(v.metaKey||v.ctrlKey||v.altKey)&&!B.some(function(T){return v.target.matches(T)})){var G=s.includes(v.target.tagName.toLowerCase());if(!(P!=="Escape"&&(G||w(v,s))))for(var A=0,ee=Object.keys(H);A<ee.length;A++){var l=ee[A],b=H[l];if(!(!b||b.disabled)&&P.toLowerCase()===l){v.preventDefault(),b.action();break}}}},void 0,[H].concat(De()(U||[])))}},"./frontend/src/scenes/dashboard/Dashboard.tsx":function(J,_,e){"use strict";e.r(_),e.d(_,"scene",function(){return jt}),e.d(_,"Dashboard",function(){return Ne});var F=e("./node_modules/core-js/modules/es.array.includes.js"),De=e("./node_modules/core-js/modules/es.string.includes.js"),R=e("./node_modules/react/index.js"),t=e.n(R),i=e("./node_modules/kea/lib/index.esm.js"),O=e("./frontend/src/scenes/dashboard/dashboardLogic.ts"),k=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),pe=e.n(k),oe=e("./node_modules/core-js/modules/es.array.map.js"),Be=e("./node_modules/core-js/modules/es.function.name.js"),q=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),N=e.n(q),X=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/DashboardItems.scss"),w=e.n(X),B={};B.insert="head",B.singleton=!1;var ne=N()(w.a,B),H=w.a.locals||{},U=e("./node_modules/react-grid-layout/index.js"),s=e("./frontend/src/types.ts"),v=e("./frontend/src/models/insightsModel.tsx"),P=e("./node_modules/clsx/dist/clsx.m.js"),G=e("./frontend/src/lib/components/InsightCard/index.tsx"),A=e("./frontend/src/lib/hooks/useResizeObserver.ts");function ee(){var r=Object(i.useValues)(O.c),a=r.dashboard,n=r.items,d=r.layouts,o=r.dashboardMode,I=r.placement,D=r.isRefreshing,y=r.highlightedInsightId,x=r.refreshStatus,C=Object(i.useActions)(O.c),ae=C.updateLayouts,L=C.updateContainerWidth,u=C.updateItemColor,z=C.removeItem,be=C.refreshAllDashboardItems,se=Object(i.useActions)(v.a),Pe=se.duplicateInsight,Ae=se.renameInsight,ge=se.moveToDashboard,Me=Object(R.useState)(null),ze=pe()(Me,2),Te=ze[0],Ve=ze[1],Re=Object(R.useRef)(!1),je=Object(R.useRef)(null),Ye=Object(P.a)({"dashboard-view-mode":o!==s.k.Edit,"dashboard-edit-mode":o===s.k.Edit}),we=Object(A.b)(),fe=we.width,g=we.ref,re=!fe||fe>O.a.sm;return t.a.createElement("div",{className:"dashboard-items-wrapper",ref:g},t.a.createElement(U.Responsive,{width:fe||0,className:Ye,isDraggable:o===s.k.Edit,isResizable:o===s.k.Edit,layouts:d,rowHeight:80,margin:[16,16],containerPadding:[0,0],onLayoutChange:function(Oe,Z){o===s.k.Edit&&ae(Z)},onWidthChange:function(Oe,Z,V){L(Oe,V)},breakpoints:O.a,resizeHandles:re?["s","e","se"]:["s"],cols:O.b,onResize:function(Oe,Z,V){(!Te||Te.w!==V.w||Te.h!==V.h)&&Ve(V)},onResizeStop:function(){Ve(null)},onDrag:function(){Re.current=!0,je.current&&window.clearTimeout(je.current)},onDragStop:function(){je.current&&window.clearTimeout(je.current),je.current=window.setTimeout(function(){Re.current=!1},250)},draggableCancel:".anticon,.ant-dropdown,table,.ant-popover-content,button,.Popup"},n==null?void 0:n.map(function(j){var Oe;return t.a.createElement(G.a,{key:j.short_id,insight:j,dashboardId:a==null?void 0:a.id,loading:D(j.short_id),apiErrored:((Oe=x[j.short_id])===null||Oe===void 0?void 0:Oe.error)||!1,highlighted:y&&j.short_id===y,showResizeHandles:o===s.k.Edit,canResizeWidth:re,updateColor:function(V){return u(j.id,V)},removeFromDashboard:function(){return z(j)},refresh:function(){return be([j])},rename:function(){return Ae(j)},duplicate:function(){return Pe(j)},moveToDashboardOld:function(V){return Pe(j,V,!0)},moveToDashboard:function(V){var Ot=V.id,Dt=V.name;if(!a)throw new Error("must be on a dashboard to move an insight");ge(j,a.id,Ot,Dt)},showEditingControls:[s.l.Dashboard,s.l.ProjectHomepage].includes(I),showDetailsControls:I!=s.l.Export})})))}var l=e("./frontend/src/lib/components/DateFilter/DateFilter.tsx"),b=e("./node_modules/@ant-design/icons/es/icons/CalendarOutlined.js"),T=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/Dashboard.scss"),m=e.n(T),te={};te.insert="head",te.singleton=!1;var _e=N()(m.a,te),de=m.a.locals||{},Se=e("./frontend/src/lib/hooks/useKeyboardHotkeys.tsx"),E=e("./frontend/src/lib/utils/eventUsageLogic.ts"),le=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),ie=e("./node_modules/core-js/modules/es.array.fill.js"),Q=e("./node_modules/antd/es/card/index.js"),ce=e("./node_modules/antd/es/row/index.js"),Y=e("./node_modules/antd/es/col/index.js"),S=e("./node_modules/antd/es/skeleton/index.js"),We=e("./frontend/src/lib/components/Link.tsx"),ue=e("./frontend/src/scenes/urls.ts"),W=e("./frontend/src/lib/components/LemonButton/index.ts");function Ue(r){var a=r.active;return t.a.createElement(Q.a,{className:"hide-lte-lg"},t.a.createElement(ce.a,null,t.a.createElement(Y.a,{span:12},t.a.createElement(S.a,{paragraph:{rows:1},active:a}),t.a.createElement("div",{className:"mt"},t.a.createElement("div",{className:"mt"},t.a.createElement(S.a.Button,{active:a}),t.a.createElement(S.a.Button,{active:a,style:{marginLeft:4,width:140}})),t.a.createElement("div",{className:"mt"},t.a.createElement(S.a.Button,{active:a}),t.a.createElement(S.a.Button,{active:a,style:{marginLeft:4,width:140}})),t.a.createElement("div",{className:"mt"},t.a.createElement(S.a.Button,{active:a}),t.a.createElement(S.a.Button,{active:a,style:{marginLeft:4,width:140}})))),t.a.createElement(Y.a,{span:12},t.a.createElement("div",{className:"skeleton-actions"},t.a.createElement(S.a.Avatar,{active:a,shape:"circle",size:"small"}),t.a.createElement(S.a.Avatar,{active:a,shape:"circle",size:"small"})),t.a.createElement(S.a.Avatar,{active:a,shape:"circle",size:"large",className:"pie-chart"}))))}function Ce(){return t.a.createElement("div",{className:"bar-chart ant-skeleton-content"},Array(8).fill(0).map(function(r,a){var n=200,d=40,o=Math.floor(Math.random()*(n-d+1))+d;return t.a.createElement("div",{className:"bar-el ant-skeleton-title",key:a,style:{height:o}})}))}var He=t.a.memo(Ce);function c(r){var a=r.active;return t.a.createElement(Q.a,{className:Object(P.a)("ant-skeleton",a&&"ant-skeleton-active")},t.a.createElement(ce.a,null,t.a.createElement(Y.a,{span:12},t.a.createElement(S.a,{active:a,paragraph:{rows:1}})),t.a.createElement(Y.a,{span:12},t.a.createElement("div",{className:"skeleton-actions"},t.a.createElement(S.a.Avatar,{active:a,shape:"circle",size:"small"}),t.a.createElement(S.a.Avatar,{active:a,shape:"circle",size:"small"})))),t.a.createElement(He,null))}function f(r){var a=r.loading,n=Object(i.useValues)(O.c),d=n.dashboard;return t.a.createElement("div",{className:"empty-state"},!a&&t.a.createElement("div",{className:"cta"},t.a.createElement(Q.a,{className:"card-elevated"},t.a.createElement("h3",{className:"l3"},"Dashboard empty"),t.a.createElement("p",null,"This dashboard sure would look better with some graphs!"),t.a.createElement("div",{className:"mt text-center"},t.a.createElement(We.a,{to:ue.a.insightNew(void 0,d==null?void 0:d.id)},t.a.createElement(W.a,{"data-attr":"dashboard-add-graph-header"},"Add insight"))))),t.a.createElement(ce.a,{gutter:16},t.a.createElement(Y.a,{span:24,lg:12},t.a.createElement(Ue,{active:a})),t.a.createElement(Y.a,{span:24,lg:12},t.a.createElement(c,{active:a}))),t.a.createElement(ce.a,{gutter:16,className:"fade-out-graphs"},t.a.createElement(Y.a,{span:24,lg:12},t.a.createElement(Ue,{active:a})),t.a.createElement(Y.a,{span:24,lg:12},t.a.createElement(c,{active:a}))))}try{f.displayName="EmptyDashboardComponent",f.__docgenInfo={description:"",displayName:"EmptyDashboardComponent",props:{loading:{defaultValue:null,description:"",name:"loading",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/EmptyDashboardComponent.tsx#EmptyDashboardComponent"]={docgenInfo:f.__docgenInfo,name:"EmptyDashboardComponent",path:"frontend/src/scenes/dashboard/EmptyDashboardComponent.tsx#EmptyDashboardComponent"})}catch(r){}var h=e("./frontend/src/lib/components/NotFound/index.tsx"),M=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),me=e.n(M),ve=e("./node_modules/core-js/modules/es.array.from.js"),$=e("./node_modules/core-js/modules/es.string.iterator.js"),ye=e("./node_modules/antd/es/dropdown/index.js"),K=e("./node_modules/antd/es/menu/index.js"),xe=e("./node_modules/antd/es/checkbox/index.js"),he=e("./node_modules/antd/es/radio/index.js"),Ie=e("./node_modules/antd/es/space/index.js"),Ee=e("./node_modules/@ant-design/icons/es/icons/DownOutlined.js"),Le=e("./node_modules/@ant-design/icons/es/icons/LoadingOutlined.js"),$e=e("./node_modules/@ant-design/icons/es/icons/ReloadOutlined.js"),p=e("./frontend/src/lib/utils.tsx"),tt=e("./frontend/src/lib/components/Tooltip.tsx"),at=e("./frontend/src/lib/dayjs.ts"),Je=function(){var a=Object(i.useValues)(O.c),n=a.lastRefreshed;return t.a.createElement("span",null,"Last updated ",t.a.createElement("b",null,n?Object(at.a)(n).fromNow():"a while ago"))},st=me()(Array.from([60,120,300,900],function(r){return{label:Object(p.N)(r),value:r}}));function rt(){var r=Object(i.useValues)(O.c),a=r.itemsLoading,n=r.autoRefresh,d=r.refreshMetrics,o=Object(i.useActions)(O.c),I=o.refreshAllDashboardItemsManual,D=o.setAutoRefresh,y=Object(R.useState)(!1),x=pe()(y,2),C=x[0],ae=x[1];return t.a.createElement(t.a.Fragment,null,t.a.createElement(ye.a.Button,{overlay:t.a.createElement(K.a,{"data-attr":"auto-refresh-picker",id:"auto-refresh-picker"},t.a.createElement("div",{id:"auto-refresh-check",key:"auto-refresh-check",onClick:function(u){u.stopPropagation(),ae(!0),D(!n.enabled,n.interval)}},t.a.createElement(tt.a,{title:"Refresh dashboard automatically",placement:"bottomLeft"},t.a.createElement(xe.a,{onChange:function(u){u.stopPropagation(),u.preventDefault()},checked:n.enabled}),t.a.createElement("label",{style:{marginLeft:10,cursor:"pointer"}},"Auto refresh"))),t.a.createElement(K.a.Divider,null),t.a.createElement(K.a.ItemGroup,{title:"Refresh interval"},t.a.createElement(he.a.Group,{onChange:function(u){D(!0,parseInt(u.target.value))},value:n.interval,style:{width:"100%"}},t.a.createElement(Ie.b,{direction:"vertical",style:{width:"100%"}},st.map(function(L){var u=L.label,z=L.value;return t.a.createElement(he.a,{key:z,value:z,style:{width:"100%"}},u)}))))),trigger:["click"],onClick:function(){return I()},icon:t.a.createElement(Ee.a,null),disabled:a,buttonsRender:function(u){var z=pe()(u,2),be=z[0],se=z[1];return[t.a.cloneElement(be,{style:{paddingLeft:10}}),se]},visible:C,onVisibleChange:function(u){return ae(u)}},t.a.createElement("span",{className:"dashboard-items-action-icon"},a?t.a.createElement(Le.a,null):t.a.createElement($e.a,null)),t.a.createElement("span",{className:Object(P.a)("dashboard-items-action-refresh-text",{hidden:a})},t.a.createElement(Je,null)),t.a.createElement("span",{className:Object(P.a)("dashboard-items-action-refresh-text","completed",{hidden:!a})},"Refreshed ",d.completed," out of ",d.total)))}var ot=e("./frontend/src/scenes/insights/EmptyStates/index.ts"),yt=e("./node_modules/core-js/modules/es.symbol.js"),xt=e("./node_modules/core-js/modules/es.symbol.description.js"),Pt=e("./node_modules/core-js/modules/es.array.filter.js"),Mt=e("./node_modules/core-js/modules/es.object.to-string.js"),Ct=e("./node_modules/core-js/modules/es.array.concat.js"),It=e("./node_modules/core-js/modules/es.array.join.js"),Xe=e("./frontend/src/lib/components/EditableField/EditableField.tsx");function Ke(r){var a=r.onExit,n="aside.ant-layout-sider, .layout-top-content";return Object(R.useEffect)(function(){for(var d=window.document.querySelectorAll(n),o=0;o<d.length;o++)d[o].style.display="none";var I=function(){window.document.fullscreenElement===null&&(a==null||a())};try{window.document.body.requestFullscreen().then(function(){window.addEventListener("fullscreenchange",I,!1)})}catch(D){}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch(D){}return function(){for(var D=window.document.querySelectorAll(n),y=0;y<D.length;y++)D[y].style.display="block";try{window.removeEventListener("fullscreenchange",I,!1),window.document.fullscreenElement!==null&&window.document.exitFullscreen()}catch(x){}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch(x){}}},[]),null}try{Ke.displayName="FullScreen",Ke.__docgenInfo={description:"",displayName:"FullScreen",props:{onExit:{defaultValue:null,description:"",name:"onExit",required:!1,type:{name:"(() => any)"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/FullScreen.tsx#FullScreen"]={docgenInfo:Ke.__docgenInfo,name:"FullScreen",path:"frontend/src/lib/components/FullScreen.tsx#FullScreen"})}catch(r){}var nt=e("./frontend/src/lib/components/LemonButton/More.tsx"),dt=e("./frontend/src/lib/components/LemonRow/index.ts"),Ge=e("./frontend/src/lib/components/LemonDivider/index.ts"),Qe=e("./frontend/src/lib/components/ObjectTags/ObjectTags.tsx"),lt=e("./frontend/src/lib/components/PageHeader.tsx"),Ze=e("./frontend/src/models/dashboardsModel.tsx"),it=e("./frontend/src/scenes/dashboard/dashboardsLogic.ts"),ct=e("./frontend/src/scenes/dashboard/DashboardCollaborators.tsx"),ut=e("./frontend/src/scenes/userLogic.ts"),Fe=e("./frontend/src/lib/constants.tsx"),mt=e("./frontend/src/lib/components/ProfilePicture/ProfileBubbles.tsx"),ht=e("./frontend/src/scenes/dashboard/dashboardCollaboratorsLogic.ts"),Et=e("./frontend/src/lib/components/icons.tsx"),ke=e("./frontend/src/lib/logic/featureFlagLogic.ts"),ft=e("./frontend/src/lib/components/ExportButton/ExportButton.tsx"),qe=e("./frontend/src/lib/components/Subscriptions/SubscriptionsModal.tsx"),pt=e("./node_modules/kea-router/lib/index.js"),_t=e("./frontend/src/lib/components/Sharing/SharingModal.tsx");function vt(){var r=Object(i.useValues)(O.c),a=r.dashboard,n=r.allItemsLoading,d=r.dashboardMode,o=r.canEditDashboard,I=r.showSubscriptions,D=r.subscriptionId,y=Object(i.useActions)(O.c),x=y.setDashboardMode,C=y.triggerDashboardUpdate,ae=Object(i.useValues)(it.b),L=ae.dashboardTags,u=Object(i.useActions)(Ze.a),z=u.updateDashboard,be=u.pinDashboard,se=u.unpinDashboard,Pe=u.deleteDashboard,Ae=u.duplicateDashboard,ge=Object(i.useValues)(Ze.a),Me=ge.dashboardLoading,ze=Object(i.useValues)(ut.a),Te=ze.hasAvailableFeature,Ve=Object(i.useValues)(ke.a),Re=Ve.featureFlags,je=Re[Fe.h.EXPORT_DASHBOARD_INSIGHTS],Ye=Re[Fe.h.INSIGHT_SUBSCRIPTIONS],we=Object(i.useActions)(pt.router),fe=we.push;return a||n?t.a.createElement(t.a.Fragment,null,d===s.k.Fullscreen&&t.a.createElement(Ke,{onExit:function(){return x(null,E.a.Browser)}}),a&&t.a.createElement(t.a.Fragment,null,t.a.createElement(qe.c,{visible:I,closeModal:function(){return fe(ue.a.dashboard(a.id))},dashboardId:a.id,subscriptionId:D}),t.a.createElement(_t.b,{visible:d===s.k.Sharing,closeModal:function(){return fe(ue.a.dashboard(a.id))},dashboardId:a.id})),t.a.createElement(lt.a,{title:t.a.createElement("div",{style:{display:"flex",alignItems:"center"}},t.a.createElement(Xe.a,{name:"name",value:(a==null?void 0:a.name)||(n?"Loading\u2026":""),placeholder:"Name this dashboard",onSave:a?function(g){return z({id:a.id,name:g})}:void 0,minLength:1,maxLength:400,mode:o?void 0:"view",notice:a&&!o?{icon:t.a.createElement(Et.IconLock,null),tooltip:"You don't have edit permissions in this dashboard. Ask a dashboard collaborator with edit access to add you."}:void 0})),buttons:d===s.k.Edit?t.a.createElement(W.a,{"data-attr":"dashboard-edit-mode-save",type:"primary",onClick:function(){return x(null,E.a.DashboardHeader)},tabIndex:10,disabled:n},"Done editing"):d===s.k.Fullscreen?t.a.createElement(W.a,{type:"secondary",onClick:function(){return x(null,E.a.DashboardHeader)},"data-attr":"dashboard-exit-presentation-mode",disabled:n},"Exit full screen"):t.a.createElement(t.a.Fragment,null,t.a.createElement(nt.a,{overlay:a?t.a.createElement(t.a.Fragment,null,a.created_by&&t.a.createElement(t.a.Fragment,null,t.a.createElement(dt.a,{fullWidth:!0,style:{color:"var(--muted-alt)"}},"Created by"," ",a.created_by.first_name||a.created_by.email||"-"," ","on ",Object(p.M)(a.created_at)),t.a.createElement(Ge.a,null)),o&&t.a.createElement(W.a,{onClick:function(){return x(s.k.Edit,E.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Edit layout (E)"),t.a.createElement(W.a,{onClick:function(){return x(s.k.Fullscreen,E.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Go full screen (F)"),o&&(a.pinned?t.a.createElement(W.a,{onClick:function(){return se(a.id,E.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Unpin dashboard"):t.a.createElement(W.a,{onClick:function(){return be(a.id,E.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Pin dashboard")),Ye&&t.a.createElement(qe.a,{dashboardId:a.id}),je&&t.a.createElement(ft.a,{dashboardId:a.id,fullWidth:!0,type:"stealth"}),t.a.createElement(Ge.a,null),t.a.createElement(W.a,{onClick:function(){return Ae({id:a.id,name:a.name,show:!0})},type:"stealth",fullWidth:!0},"Duplicate dashboard"),o&&t.a.createElement(W.a,{onClick:function(){return Pe({id:a.id,redirect:!0})},status:"danger",type:"stealth",fullWidth:!0},"Delete dashboard")):void 0}),t.a.createElement(Ge.a,{vertical:!0}),a&&t.a.createElement(t.a.Fragment,null,t.a.createElement(bt,{dashboard:a,onClick:function(){return fe(ue.a.dashboardSharing(a.id))}}),t.a.createElement(W.a,{type:"secondary","data-attr":"dashboard-share-button",onClick:function(){return fe(ue.a.dashboardSharing(a.id))}},"Share")),o&&t.a.createElement(We.a,{to:ue.a.insightNew(void 0,a==null?void 0:a.id)},t.a.createElement(W.a,{type:"primary","data-attr":"dashboard-add-graph-header"},"Add insight"))),caption:t.a.createElement(t.a.Fragment,null,a&&!!(o||a.description)&&t.a.createElement(Xe.a,{multiline:!0,name:"description",value:a.description||"",placeholder:"Description (optional)",onSave:function(re){return z({id:a.id,description:re})},compactButtons:!0,mode:o?void 0:"view",paywall:!Te(s.d.DASHBOARD_COLLABORATION)}),(a==null?void 0:a.tags)&&t.a.createElement(t.a.Fragment,null,o?t.a.createElement(Qe.a,{tags:a.tags,onChange:function(re,j){return C({tags:j})},saving:Me,tagsAvailable:L.filter(function(g){var re;return!((re=a.tags)!==null&&re!==void 0&&re.includes(g))}),className:"insight-metadata-tags"}):a.tags.length?t.a.createElement(Qe.a,{tags:a.tags,saving:Me,staticOnly:!0,className:"insight-metadata-tags"}):null)),delimited:!0})):null}function bt(r){var a=r.dashboard,n=r.onClick,d=Object(i.useValues)(Object(ht.a)({dashboardId:a.id})),o=d.allCollaborators;if(!a)return null;var I=ct.a[a.effective_restriction_level],D=[];return I!=null&&I.label&&D.push(I.label),a.is_shared&&D.push("Shared publicly"),t.a.createElement(mt.a,{people:o.map(function(y){return{email:y.user.email,name:y.user.first_name,title:"".concat(y.user.first_name," (").concat(Fe.C[y.level],")")}}),tooltip:D.join(" \u2022 "),onClick:n})}var gt=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),jt={component:et,logic:O.c,paramsToProps:function(a){var n=a.params,d=n.id,o=n.placement;return{id:d?parseInt(d):void 0,placement:o}}};function Ne(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=r.id,n=r.dashboard,d=r.placement;return t.a.createElement(i.BindLogic,{logic:O.c,props:{id:a?parseInt(a):void 0,placement:d,dashboard:n}},t.a.createElement(et,null))}function et(){var r,a,n=Object(i.useValues)(O.c),d=n.placement,o=n.dashboard,I=n.canEditDashboard,D=n.items,y=n.itemsLoading,x=n.filters,C=n.dashboardMode,ae=n.receivedErrorsFromAPI,L=Object(i.useActions)(O.c),u=L.setDashboardMode,z=L.setDates,be=L.reportDashboardViewed,se=L.setProperties,Pe=Object(i.useValues)(ke.a),Ae=Pe.featureFlags;return Object(R.useEffect)(function(){be()},[]),Object(Se.a)([s.l.Public,s.l.InternalMetrics].includes(d)?{}:{e:{action:function(){return u(C===s.k.Edit?null:s.k.Edit,E.a.Hotkey)},disabled:!I||C!==null&&C!==s.k.Edit},f:{action:function(){return u(C===s.k.Fullscreen?null:s.k.Fullscreen,E.a.Hotkey)},disabled:C!==null&&C!==s.k.Fullscreen},escape:{action:function(){return u(null,E.a.Hotkey)},disabled:C!==s.k.Edit}},[u,C]),!o&&!y&&ae?t.a.createElement(h.a,{object:"dashboard"}):t.a.createElement("div",{className:"dashboard"},![s.l.ProjectHomepage,s.l.Public,s.l.Export,s.l.InternalMetrics].includes(d)&&t.a.createElement(vt,null),ae?t.a.createElement(ot.d,{title:"There was an error loading this dashboard"}):!D||D.length===0?t.a.createElement(f,{loading:y}):t.a.createElement("div",null,![s.l.Public,s.l.Export,s.l.InternalMetrics].includes(d)&&t.a.createElement("div",{className:"flex pb border-bottom space-x"},t.a.createElement("div",{className:"flex-grow flex",style:{height:30}},t.a.createElement(le.a,{style:{marginRight:8,fontWeight:"bold",lineHeight:"30px"}}),t.a.createElement(l.a,{defaultValue:"Custom",showCustom:!0,dateFrom:(r=x==null?void 0:x.date_from)!==null&&r!==void 0?r:void 0,dateTo:(a=x==null?void 0:x.date_to)!==null&&a!==void 0?a:void 0,onChange:z,disabled:!I,makeLabel:function(Me){return t.a.createElement(t.a.Fragment,null,t.a.createElement(b.a,null),t.a.createElement("span",{className:"hide-when-small"}," ",Me))}})),(Ae[Fe.h.PROPERTY_FILTER_ON_DASHBOARD]||(o==null?void 0:o.filters.properties))&&t.a.createElement(gt.a,{onChange:se,pageKey:"dashboard_"+(o==null?void 0:o.id),propertyFilters:o==null?void 0:o.filters.properties,useLemonButton:!0})),d!==s.l.Export&&t.a.createElement("div",{className:"flex pt pb space-x dashoard-items-actions"},t.a.createElement("div",{className:"left-item",style:d===s.l.Public?{textAlign:"right"}:void 0},[s.l.Public,s.l.InternalMetrics].includes(d)?t.a.createElement(Je,null):t.a.createElement(rt,null))),t.a.createElement(ee,null)))}try{Ne.displayName="Dashboard",Ne.__docgenInfo={description:"",displayName:"Dashboard",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},dashboard:{defaultValue:null,description:"",name:"dashboard",required:!1,type:{name:"DashboardType"}},placement:{defaultValue:null,description:"",name:"placement",required:!1,type:{name:"enum",value:[{value:'"dashboard"'},{value:'"internal-metrics"'},{value:'"project-homepage"'},{value:'"public"'},{value:'"export"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/Dashboard.tsx#Dashboard"]={docgenInfo:Ne.__docgenInfo,name:"Dashboard",path:"frontend/src/scenes/dashboard/Dashboard.tsx#Dashboard"})}catch(r){}},"./frontend/src/scenes/dashboard/dashboardsLogic.ts":function(J,_,e){"use strict";e.d(_,"a",function(){return A}),e.d(_,"b",function(){return ee});var F=e("./node_modules/core-js/modules/es.array.sort.js"),De=e.n(F),R=e("./node_modules/core-js/modules/es.array.filter.js"),t=e.n(R),i=e("./node_modules/core-js/modules/es.object.to-string.js"),O=e.n(i),k=e("./node_modules/core-js/modules/es.function.name.js"),pe=e.n(k),oe=e("./node_modules/core-js/modules/es.array.map.js"),Be=e.n(oe),q=e("./node_modules/core-js/modules/es.regexp.exec.js"),N=e.n(q),X=e("./node_modules/core-js/modules/es.string.search.js"),w=e.n(X),B=e("./node_modules/core-js/modules/es.array.flat-map.js"),ne=e.n(B),H=e("./node_modules/core-js/modules/es.array.unscopables.flat-map.js"),U=e.n(H),s=e("./node_modules/kea/lib/index.esm.js"),v=e("./node_modules/fuse.js/dist/fuse.esm.js"),P=e("./frontend/src/models/dashboardsModel.tsx"),G=e("./frontend/src/lib/utils.tsx"),A;(function(l){l.All="all",l.Pinned="pinned",l.Shared="shared"})(A||(A={}));var ee=Object(s.kea)({path:["scenes","dashboard","dashboardsLogic"],actions:{setSearchTerm:function(b){return{searchTerm:b}},setCurrentTab:function(b){return{tab:b}}},reducers:{searchTerm:{setSearchTerm:function(b,T){var m=T.searchTerm;return m}},currentTab:[A.All,{setCurrentTab:function(b,T){var m=T.tab;return m}}]},selectors:{dashboards:[function(l){return[P.a.selectors.nameSortedDashboards,l.searchTerm,l.currentTab]},function(l,b,T){return l=l.filter(function(m){return!m.deleted}).sort(function(m,te){var _e,de;return((_e=m.name)!==null&&_e!==void 0?_e:"Untitled").localeCompare((de=te.name)!==null&&de!==void 0?de:"Untitled")}),T===A.Pinned?l=l.filter(function(m){return m.pinned}):T===A.Shared&&(l=l.filter(function(m){return m.is_shared})),b?new v.a(l,{keys:["key","name"],threshold:.3}).search(b).map(function(m){return m.item}):l}],dashboardTags:[function(){return[P.a.selectors.nameSortedDashboards]},function(l){return Object(G.Db)(l.flatMap(function(b){var T=b.tags;return T||""}),function(b){return b}).sort()}]}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/Dashboard.scss":function(J,_,e){var F=e("./node_modules/css-loader/dist/runtime/api.js");_=F(!1),_.push([J.i,'.dashboard .empty-state .fade-out-graphs:after{content:"";width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent);position:absolute;pointer-events:none;bottom:0}.dashboard-header .dashboard-select{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.dashboard{margin-top:1rem}.dashboard .dashboard-items-action-icon{margin-right:6px}.dashboard .dashboard-items-action-refresh-text{visibility:visible}.dashboard .dashboard-items-action-refresh-text.hidden{visibility:hidden}.dashboard .dashboard-items-action-refresh-text.completed{position:absolute;left:30px}.dashboard .empty-state{position:relative}.dashboard .empty-state .skeleton-actions{text-align:right}.dashboard .empty-state .skeleton-actions .ant-skeleton-avatar{margin-right:8px}.dashboard .empty-state .pie-chart{height:200px;width:200px;max-width:100%;margin-top:1rem}@media(max-width:992px){.dashboard .empty-state .pie-chart{height:140px;width:140px}}.dashboard .empty-state .bar-chart{display:flex;margin-top:1rem;align-items:flex-end}.dashboard .empty-state .bar-chart .bar-el{width:12.5%;margin-left:4px;height:100px}.dashboard .empty-state .ant-col{flex-grow:1}.dashboard .empty-state .ant-col .ant-card{height:100%}.dashboard .empty-state .fade-out-graphs{margin-top:1rem;height:150px;overflow:hidden;position:relative}.dashboard .empty-state .fade-out-graphs:after{width:calc(100% - 16px);left:8px;height:150px}.dashboard .empty-state .cta{width:360px;max-width:calc(100% - 32px);position:absolute;top:16px;left:50%;transform:translateX(-50%);z-index:var(--z-content-overlay)}.dashboard-header{display:flex;justify-content:space-between;margin-bottom:1rem;width:100%}.dashboard-header.full-screen{margin-top:1rem}.dashboard-header .dashboard-select{flex:1;padding-right:2rem}.dashboard-header .dashboard-select .ant-select-single{max-width:100%;line-height:40px}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector{align-items:center;padding-left:0;padding-right:8px;line-height:40px;height:40px}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector .ant-select-selection-item{font-size:28px;font-weight:600;line-height:40px;width:100%;height:35px;display:flex;align-items:center}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector .ant-select-selection-item .anticon-share-alt{font-size:16px;margin-left:6px!important;margin-right:4px}.dashboard-header .dashboard-select .ant-select-single.ant-select-open .ant-select-arrow{color:var(--depr-rgba-text-default-0-4)}.dashboard-header .dashboard-select .ant-select-single .ant-select-arrow{color:var(--text-default);font-size:14px}.dashboard-header .dashboard-meta{white-space:nowrap;display:flex;align-items:center}.dashboard-header .dashboard-meta .ant-btn{margin-left:10px}.dashboard-header .dashboard-meta .ant-btn .anticon{vertical-align:baseline}.dashboard-header .dashboard-meta .ant-btn.button-box{padding:4px 8px}@media(max-width:768px){.dashboard-header{flex-direction:column}.dashboard-header .dashboard-meta{padding-top:1rem;justify-content:flex-end}}#auto-refresh-check{padding:5px 12px;cursor:pointer}.CollaboratorRow{justify-content:space-between;height:2rem;margin-top:.5rem;padding-left:.5rem}.CollaboratorRow,.CollaboratorRow__details{display:flex;align-items:center}.CollaboratorRow__details>span{margin-right:.5rem}',""]),J.exports=_},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/DashboardItems.scss":function(J,_,e){var F=e("./node_modules/css-loader/dist/runtime/api.js");_=F(!1),_.push([J.i,".dashboard-items-wrapper{width:100%}.react-grid-layout{position:relative;transition:height .1s ease;margin-bottom:2rem}.react-grid-layout.dashboard-view-mode .react-grid-item{transition:none}.react-grid-item{transition:all .1s ease;transition-property:left,top}.react-grid-item.cssTransforms{transition-property:transform}.react-grid-item.resizing{z-index:1;will-change:width,height}.react-grid-item.react-draggable{cursor:move}.react-grid-item.react-draggable-dragging{transition:none;z-index:105;will-change:transform}.react-grid-item.dropping{visibility:hidden}.react-grid-item.react-grid-placeholder{transition:.1s ease;max-width:100%;position:relative;border:1px solid var(--primary);outline:1px solid var(--primary);border-radius:var(--radius);z-index:2;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-resizable-hide>.react-resizable-handle{display:none}.react-grid-item>.react-resizable-handle{position:absolute;width:2rem;height:2rem;bottom:-.5rem;right:-.5rem;cursor:se-resize;z-index:10}.react-grid-item>.react-resizable-handle.react-resizable-handle-se{cursor:se-resize}.react-grid-item>.react-resizable-handle.react-resizable-handle-e{top:0;bottom:2rem;height:auto;cursor:ew-resize}.react-grid-item>.react-resizable-handle.react-resizable-handle-s{left:0;right:2rem;width:auto;cursor:ns-resize}.ant-dropdown{z-index:700}.dive-btn{margin-right:.5rem}.dive-btn.dive-btn-dive{border-color:var(--primary);color:var(--primary)}.dive-btn.dive-btn-dive:hover{border-color:var(--depr-darken-primary-30);color:var(--depr-darken-primary-30)}",""]),J.exports=_}}]);
