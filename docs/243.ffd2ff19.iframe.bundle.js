(window.webpackJsonp=window.webpackJsonp||[]).push([[243],{"./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx":function(j,d,e){"use strict";e.d(d,"a",function(){return y});var A=e("./node_modules/core-js/modules/es.array.index-of.js"),de=e("./node_modules/core-js/modules/es.regexp.exec.js"),Z=e("./node_modules/core-js/modules/es.string.match.js"),w=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),L=e.n(w),o=e("./node_modules/react/index.js"),s=e.n(o),k=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),S=e.n(k),B=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.scss"),U=e.n(B),W={};W.insert="head",W.singleton=!1;var ie=S()(U.a,W),ce=U.a.locals||{},z=e("./node_modules/clsx/dist/clsx.m.js"),N=e("./node_modules/kea/lib/index.esm.js"),x=e("./frontend/src/lib/components/LemonTable/index.ts"),q=e("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),F=e("./node_modules/@ant-design/icons/es/icons/CheckCircleFilled.js"),H=e("./node_modules/@ant-design/icons/es/icons/PlusOutlined.js"),O=e("./frontend/src/lib/components/LemonButton/index.ts"),$=e("./node_modules/antd/es/input/index.js"),C=e("./node_modules/antd/es/button/index.js"),h=e("./frontend/src/scenes/toolbar-launch/authorizedUrlsLogic.ts"),p=e("./frontend/src/lib/utils.tsx"),ee=e("./frontend/src/lib/components/LemonButton/More.tsx");function y(te){var ne=te.pageKey,ve=te.actionId,re=Object(h.c)({actionId:ve}),I=Object(N.useValues)(re),me=I.appUrlsKeyed,ge=I.suggestionsLoading,se=I.searchTerm,G=I.launchUrl,V=I.appUrls,P=I.editUrlIndex,T=Object(N.useActions)(re),pe=T.addUrl,ae=T.removeUrl,Y=T.setSearchTerm,_e=T.updateUrl,b=T.newUrl,fe=T.setEditUrlIndex,he=[{title:"URLs",dataIndex:"url",key:"url",render:function(E,u){var J=Object(o.useState)(u.url),M=L()(J,2),v=M[0],X=M[1],le=Object(o.useState)(""),Q=L()(le,2),R=Q[0],K=Q[1];Object(o.useEffect)(function(){return X(u.url)},[u]);var l=function(){if(K(""),v===h.a&&ae(u.originalIndex),v.indexOf("*")>-1&&!v.match(/^(.*)\*[^\*]*\.[^\*]+\.[^\*]+$/)){K("You can only wildcard subdomains. If you wildcard the domain or TLD, people might be able to gain access to your PostHog data.");return}if(!Object(p.eb)(v)){K("Please type a valid URL or domain.");return}if(V.indexOf(v)>-1&&V.indexOf(v,u.originalIndex)!==u.originalIndex&&V.indexOf(v,u.originalIndex+1)!==u.originalIndex){K("This URL is already registered.");return}_e(u.originalIndex,v)};return u.type==="suggestion"||E!==h.a&&P!==u.originalIndex?s.a.createElement("div",{className:Object(z.a)("authorized-url-col",u.type)},u.type==="authorized"&&s.a.createElement(F.a,{style:{marginRight:4}}),E,u.type==="suggestion"&&s.a.createElement(q.a,null,"Suggestion")):s.a.createElement("div",null,s.a.createElement("div",{style:{display:"flex"}},s.a.createElement($.a,{value:v,onChange:function(t){return X(t.target.value)},onPressEnter:l,autoFocus:!0,placeholder:"Enter a URL or wildcard subdomain (e.g. https://*.posthog.com)"}),s.a.createElement(C.a,{type:"primary",onClick:l},"Save")),R&&s.a.createElement("span",{className:"text-small text-danger"},R))}},{title:"",key:"actions",render:function(E,u,J){return s.a.createElement("div",{className:"actions-col"},u.type==="suggestion"?s.a.createElement(O.a,{type:"default",onClick:function(){return pe(u.url)}},s.a.createElement(H.a,null)," Add as authorized"):s.a.createElement(s.a.Fragment,null,s.a.createElement("a",{href:G(u.url),style:{marginRight:4}},s.a.createElement(O.a,{type:"highlighted"},"Launch toolbar")),s.a.createElement(ee.a,{overlay:s.a.createElement(s.a.Fragment,null,s.a.createElement(O.a,{fullWidth:!0,type:"stealth",onClick:function(){return fe(u.originalIndex)}},"Edit authorized URL"),s.a.createElement(O.a,{fullWidth:!0,style:{color:"var(--danger)"},type:"stealth",onClick:function(){return ae(J)}},"Remove authorized URL"))})))}}];return s.a.createElement("div",null,s.a.createElement("div",{className:"flex-center mb"},s.a.createElement("div",{style:{flexGrow:1}},s.a.createElement($.a.Search,{allowClear:!0,enterButton:!0,placeholder:"Search for authorized URLs",style:{maxWidth:480},value:se,onChange:function(E){Y(E.target.value)},autoFocus:ne==="toolbar-launch"&&!Object(p.X)()})),s.a.createElement(C.a,{type:"primary",icon:s.a.createElement(H.a,null),onClick:b},"Add",ne==="toolbar-launch"&&" authorized domain")),s.a.createElement(x.a,{className:"authorized-urls-table",columns:he,dataSource:me,emptyState:se?"There are no authorized URLs that match your search.":"There are no authorized URLs or domains. Add one to get started.",loading:ge}))}try{y.displayName="AuthorizedUrlsTable",y.__docgenInfo={description:"",displayName:"AuthorizedUrlsTable",props:{pageKey:{defaultValue:null,description:"",name:"pageKey",required:!1,type:{name:"string"}},actionId:{defaultValue:null,description:"",name:"actionId",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx#AuthorizedUrlsTable"]={docgenInfo:y.__docgenInfo,name:"AuthorizedUrlsTable",path:"frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx#AuthorizedUrlsTable"})}catch(te){}},"./frontend/src/scenes/toolbar-launch/ToolbarLaunch.tsx":function(j,d,e){"use strict";e.r(d),e.d(d,"scene",function(){return O});var A=e("./node_modules/core-js/modules/es.array.map.js"),de=e("./node_modules/@babel/runtime/helpers/extends.js"),Z=e.n(de),w=e("./frontend/src/lib/components/PageHeader.tsx"),L=e("./node_modules/react/index.js"),o=e.n(L),s=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),k=e.n(s),S=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/ToolbarLaunch.scss"),B=e.n(S),U={};U.insert="head",U.singleton=!1;var W=k()(B.a,U),ie=B.a.locals||{},ce=e("./node_modules/@ant-design/icons/es/icons/SearchOutlined.js"),z=e("./frontend/src/lib/components/Link.tsx"),N=e("./frontend/src/scenes/urls.ts"),x=e("./frontend/src/lib/components/icons.tsx"),q=e("./node_modules/antd/es/row/index.js"),F=e("./node_modules/antd/es/col/index.js"),H=e("./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx"),O={component:$};function $(){var h=[{title:"Heatmaps",caption:"Understand where your users interact the most.",icon:o.a.createElement(x.IconHeatmap,null)},{title:"Actions",caption:"Create actions visually from elements in your website.",icon:o.a.createElement(x.IconGroupedEvents,null)},{title:"Feature Flags",caption:"Toggle feature flags on/off right on your app.",icon:o.a.createElement(x.IconFlag,null)},{title:"Inspect",caption:"Inspect clickable elements on your website.",icon:o.a.createElement(ce.a,null)}];return o.a.createElement("div",{className:"toolbar-launch-page"},o.a.createElement(w.a,{title:"Toolbar",caption:"The toolbar launches PostHog right in your app or website."}),o.a.createElement(H.a,{pageKey:"toolbar-launch"}),o.a.createElement("div",{className:"footer-caption"},"Make sure you're using the ",o.a.createElement(z.a,{to:"".concat(N.a.projectSettings(),"#snippet")},"HTML snippet")," or the latest ",o.a.createElement("code",null,"posthog-js")," version."),o.a.createElement(q.a,{className:"feature-highlight-list"},h.map(function(p){return o.a.createElement(C,Z()({key:p.title},p))})))}function C(h){var p=h.title,ee=h.caption,y=h.icon;return o.a.createElement(F.a,{sm:12,className:"fh-item"},o.a.createElement("div",{className:"fh-icon"},y),o.a.createElement("div",null,o.a.createElement("h4",null,p),o.a.createElement("div",{className:"caption"},ee)))}},"./frontend/src/scenes/toolbar-launch/authorizedUrlsLogic.ts":function(j,d,e){"use strict";e.d(d,"b",function(){return Q}),e.d(d,"a",function(){return R}),e.d(d,"c",function(){return K});var A=e("./node_modules/core-js/modules/es.array.concat.js"),de=e.n(A),Z=e("./node_modules/core-js/modules/es.array.filter.js"),w=e.n(Z),L=e("./node_modules/core-js/modules/es.array.includes.js"),o=e.n(L),s=e("./node_modules/core-js/modules/es.array.index-of.js"),k=e.n(s),S=e("./node_modules/core-js/modules/es.array.iterator.js"),B=e.n(S),U=e("./node_modules/core-js/modules/es.array.map.js"),W=e.n(U),ie=e("./node_modules/core-js/modules/es.array.slice.js"),ce=e.n(ie),z=e("./node_modules/core-js/modules/es.array.splice.js"),N=e.n(z),x=e("./node_modules/core-js/modules/es.object.assign.js"),q=e.n(x),F=e("./node_modules/core-js/modules/es.object.to-string.js"),H=e.n(F),O=e("./node_modules/core-js/modules/es.regexp.exec.js"),$=e.n(O),C=e("./node_modules/core-js/modules/es.regexp.to-string.js"),h=e.n(C),p=e("./node_modules/core-js/modules/es.string.includes.js"),ee=e.n(p),y=e("./node_modules/core-js/modules/es.string.iterator.js"),te=e.n(y),ne=e("./node_modules/core-js/modules/es.string.search.js"),ve=e.n(ne),re=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),I=e.n(re),me=e("./node_modules/core-js/modules/web.url.js"),ge=e.n(me),se=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),G=e.n(se),V=e("./node_modules/@babel/runtime/regenerator/index.js"),P=e.n(V),T=e("./node_modules/regenerator-runtime/runtime.js"),pe=e.n(T),ae=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),Y=e.n(ae),_e=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=e.n(_e),fe=e("./node_modules/kea/lib/index.esm.js"),he=e("./frontend/src/lib/api.ts"),oe=e("./frontend/src/lib/utils.tsx"),E=e("./frontend/src/scenes/teamLogic.ts"),u=e("./frontend/src/lib/dayjs.ts"),J=e("./node_modules/fuse.js/dist/fuse.esm.js"),M=e("./node_modules/kea-router/lib/index.js"),v=e.n(M);function X(l,r){var t=Object.keys(l);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(l);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(l,a).enumerable})),t.push.apply(t,n)}return t}function le(l){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?X(Object(t),!0).forEach(function(n){b()(l,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(t)):X(Object(t)).forEach(function(n){Object.defineProperty(l,n,Object.getOwnPropertyDescriptor(t,n))})}return l}function Q(l,r,t){var n=le(le({userIntent:t?void 0:r?"edit-action":"add-action"},r?{actionId:r}:{}),l?{appUrl:l}:{});return"/api/user/redirect_to_site/"+Object(M.encodeParams)(n,"?")}var R="https://",K=Object(fe.kea)({path:function(r){return["lib","components","AppEditorLink","appUrlsLogic",r]},key:function(r){return"".concat(r.pageKey).concat(r.actionId)||"global"},props:{},connect:{values:[E.a,["currentTeam","currentTeamId"]],actions:[E.a,["updateCurrentTeam"]]},actions:function(){return{setAppUrls:function(t){return{appUrls:t}},addUrl:function(t,n){return{url:t,launch:n}},newUrl:!0,removeUrl:function(t){return{index:t}},updateUrl:function(t,n){return{index:t,url:n}},launchAtUrl:function(t){return{url:t}},setSearchTerm:function(t){return{term:t}},setEditUrlIndex:function(t){return{originalIndex:t}}}},loaders:function(r){var t=r.values;return{suggestions:{__default:[],loadSuggestions:function(){var n=Y()(P.a.mark(function c(){var f,i,m,g;return P.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return i={events:[{id:"$pageview",name:"$pageview",type:"events"}],breakdown:"$current_url",date_from:Object(u.a)().subtract(3,"days").toISOString()},_.next=3,he.b.get("api/projects/".concat(t.currentTeamId,"/insights/trend/?").concat(Object(oe.Ab)(i)));case 3:if(m=_.sent.result,!(m&&((f=m[0])===null||f===void 0?void 0:f.count)===0)){_.next=6;break}return _.abrupt("return",[]);case 6:return g=[],_.abrupt("return",(m||[]).filter(function(D){if(!D.breakdown_value)return!1;try{var Ee=new URL(D.breakdown_value.toString()).hostname;return g.indexOf(Ee)>-1||t.appUrls.filter(function(je){return je.indexOf(Ee)>-1}).length>0?void 0:(g.push(Ee),!0)}catch(je){return!1}}).map(function(D){return D.breakdown_value}).slice(0,20));case 8:case"end":return _.stop()}},c)}));function a(){return n.apply(this,arguments)}return a}()}}},events:function(r){var t=r.actions,n=r.values;return{afterMount:function(){t.loadSuggestions(),n.currentTeam&&t.setAppUrls(n.currentTeam.app_urls)}}},reducers:function(){return{appUrls:[[],{setAppUrls:function(t,n){var a=n.appUrls;return a},addUrl:function(t,n){var a=n.url;return t.concat([a])},newUrl:function(t){return t.includes(R)?t:[R].concat(t)},updateUrl:function(t,n){var a=n.index,c=n.url;return Object.assign(G()(t),b()({},a,c))},removeUrl:function(t,n){var a=n.index,c=G()(t);return c.splice(a,1),c}}],suggestions:[[],{addUrl:function(t,n){var a=n.url;return G()(t).filter(function(c){return a!==c})}}],searchTerm:["",{setSearchTerm:function(t,n){var a=n.term;return a}}],editUrlIndex:[null,{setEditUrlIndex:function(t,n){var a=n.originalIndex;return a},removeUrl:function(t,n){var a=n.index;return t&&a<t?t-1:a===t?null:t}}]}},listeners:function(r){var t,n=r.sharedListeners,a=r.values,c=r.actions;return t={addUrl:[n.saveAppUrls,function(){var f=Y()(P.a.mark(function i(m){var g,ue;return P.a.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:g=m.url,ue=m.launch,ue&&c.launchAtUrl(g);case 2:case"end":return D.stop()}},i)}));return function(i){return f.apply(this,arguments)}}()],removeUrl:n.saveAppUrls,updateUrl:[n.saveAppUrls,function(){return c.setEditUrlIndex(null)}]},b()(t,E.a.actionTypes.loadCurrentTeamSuccess,function(){var f=Y()(P.a.mark(function i(m){var g;return P.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:g=m.currentTeam,g&&c.setAppUrls(g.app_urls);case 2:case"end":return _.stop()}},i)}));return function(i){return f.apply(this,arguments)}}()),b()(t,"launchAtUrl",function(i){var m=i.url;window.location.href=a.launchUrl(m)}),t},sharedListeners:function(r){var t=r.values;return{saveAppUrls:function(){E.a.actions.updateCurrentTeam({app_urls:t.appUrls})}}},selectors:function(r){var t=r.props;return{appUrlsKeyed:[function(n){return[n.appUrls,n.suggestions,n.searchTerm]},function(n,a,c){var f=n.map(function(i,m){return{url:i,type:"authorized",originalIndex:m}}).concat(a.map(function(i,m){return{url:i,type:"suggestion",originalIndex:m}}));return c?new J.a(f,{keys:["url"],threshold:.3}).search(c).map(function(i){return i.item}):f}],launchUrl:[function(){return[]},function(){return function(n){return Q(n,t.actionId,!t.actionId)}}]}}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.scss":function(j,d,e){var A=e("./node_modules/css-loader/dist/runtime/api.js");d=A(!1),d.push([j.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.authorized-urls-table .authorized-url-col{display:flex;align-items:center}.authorized-urls-table .authorized-url-col .lemon-tag{margin-left:4px}.authorized-urls-table .authorized-url-col.suggestion{color:#747ea1}.authorized-urls-table .authorized-url-col.authorized{color:var(--success)}.authorized-urls-table .actions-col{display:flex;align-items:center;justify-content:flex-end}",""]),j.exports=d},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/toolbar-launch/ToolbarLaunch.scss":function(j,d,e){var A=e("./node_modules/css-loader/dist/runtime/api.js");d=A(!1),d.push([j.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.toolbar-launch-page{margin-bottom:48px}.toolbar-launch-page .footer-caption{text-align:center;color:var(--muted);margin-top:1rem}.toolbar-launch-page .feature-highlight-list{max-width:800px;margin:2rem auto 0}.toolbar-launch-page .feature-highlight-list .fh-item{display:flex;align-items:center;margin-top:1rem}.toolbar-launch-page .feature-highlight-list .fh-item .fh-icon{color:#747ea1;margin-right:8px;font-size:1.6em}.toolbar-launch-page .feature-highlight-list .fh-item h4{color:#747ea1;margin-bottom:0;font-size:1.2em}",""]),j.exports=d}}]);
