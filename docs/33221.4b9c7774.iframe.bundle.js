"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[33221],{"../../frontend/src/scenes/notebooks/NotebookScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{NotebookScene:()=>NotebookScene_NotebookScene,scene:()=>scene}),__webpack_require__("../../frontend/src/scenes/notebooks/NotebookScene.scss");var posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.11.1_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),AccessDenied=__webpack_require__("../../frontend/src/lib/components/AccessDenied/index.tsx"),NotFound=__webpack_require__("../../frontend/src/lib/components/NotFound/index.tsx"),UserActivityIndicator=__webpack_require__("../../frontend/src/lib/components/UserActivityIndicator/UserActivityIndicator.tsx"),react=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),types=__webpack_require__("../../frontend/src/types.ts"),Notebook=__webpack_require__("../../frontend/src/scenes/notebooks/Notebook/Notebook.tsx"),NotebookLoadingState=__webpack_require__("../../frontend/src/scenes/notebooks/Notebook/NotebookLoadingState.tsx"),notebookLogic=__webpack_require__("../../frontend/src/scenes/notebooks/Notebook/notebookLogic.ts"),NotebookMeta=__webpack_require__("../../frontend/src/scenes/notebooks/Notebook/NotebookMeta.tsx"),FlaggedFeature=__webpack_require__("../../frontend/src/lib/components/FlaggedFeature.tsx"),SharingModal=__webpack_require__("../../frontend/src/lib/components/Sharing/SharingModal.tsx"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),copyToClipboard=__webpack_require__("../../frontend/src/lib/utils/copyToClipboard.tsx"),dist_module=__webpack_require__("../../node_modules/.pnpm/posthog-js@1.223.3_@rrweb+types@2.0.0-alpha.17/node_modules/posthog-js/dist/module.js"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),AccessControlPopoutCTA=__webpack_require__("../../frontend/src/layout/navigation-3000/sidepanel/panels/access_control/AccessControlPopoutCTA.tsx"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function NotebookShareModal(_ref){let{shortId}=_ref,{content,isLocalOnly,isShareModalOpen}=(0,index_esm.useValues)((0,notebookLogic.T)({shortId})),{closeShareModal}=(0,index_esm.useActions)((0,notebookLogic.T)({shortId})),notebookUrl=urls.j.absolute(urls.j.currentProject(urls.j.notebook(shortId))),canvasUrl=urls.j.absolute(urls.j.canvas())+`#ðŸ¦”=${(0,utils.h$)(JSON.stringify(content))}`,[interestTracked,setInterestTracked]=(0,react.useState)(!1),trackInterest=()=>{dist_module.ZP.capture("pressed interested in notebook sharing",{url:notebookUrl})};return(0,jsx_runtime.jsx)(src.fQ,{title:"Share notebook",onClose:()=>closeShareModal(),isOpen:isShareModalOpen,width:SharingModal.Rg,footer:(0,jsx_runtime.jsx)(src.Jp,{type:"secondary",onClick:closeShareModal,children:"Done"}),children:(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsx)(FlaggedFeature.P,{flag:"role-based-access-control",children:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(AccessControlPopoutCTA._,{resourceType:types.qR.Notebook,callback:()=>{closeShareModal()}}),(0,jsx_runtime.jsx)(src.p2,{})]})}),(0,jsx_runtime.jsx)("h3",{children:"Internal Link"}),isLocalOnly?(0,jsx_runtime.jsx)(src.Vp,{type:"info",children:(0,jsx_runtime.jsx)("p",{children:"This Notebook cannot be shared directly with others as it is only visible to you."})}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("p",{children:[(0,jsx_runtime.jsx)("b",{children:"Click the button below"})," to copy a direct link to this Notebook. Make sure the person you share it with has access to this PostHog project."]}),(0,jsx_runtime.jsx)(src.Jp,{type:"secondary",fullWidth:!0,center:!0,sideIcon:(0,jsx_runtime.jsx)(posthog_icons_es.IconCopy,{}),onClick:()=>void(0,copyToClipboard.v)(notebookUrl,"notebook link"),title:notebookUrl,children:(0,jsx_runtime.jsx)("span",{className:"truncate",children:notebookUrl})}),(0,jsx_runtime.jsx)(src.p2,{className:"my-4"})]}),(0,jsx_runtime.jsx)("h3",{children:"Template Link"}),(0,jsx_runtime.jsx)("p",{children:"The link below will open a Canvas with the contents of this Notebook, allowing the receiver to view it, edit it or create their own Notebook without affecting this one."}),(0,jsx_runtime.jsx)(src.Jp,{type:"secondary",fullWidth:!0,center:!0,sideIcon:(0,jsx_runtime.jsx)(posthog_icons_es.IconCopy,{}),onClick:()=>void(0,copyToClipboard.v)(canvasUrl,"canvas link"),title:canvasUrl,children:(0,jsx_runtime.jsx)("span",{className:"truncate",children:canvasUrl})}),(0,jsx_runtime.jsx)(src.p2,{className:"my-4"}),(0,jsx_runtime.jsx)("h3",{children:"External Sharing"}),(0,jsx_runtime.jsx)(src.Vp,{type:"warning",action:{children:interestTracked?"Thanks!":"I would like this!",onClick:()=>{interestTracked||(trackInterest(),setInterestTracked(!0))}},children:"We donâ€™t currently support sharing notebooks externally, but itâ€™s on our roadmap!"})]})})}var NotebookMenu=__webpack_require__("../../frontend/src/scenes/notebooks/NotebookMenu.tsx"),notebookPanelLogic=__webpack_require__("../../frontend/src/scenes/notebooks/NotebookPanel/notebookPanelLogic.ts"),sceneTypes=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),sidepanel_types=__webpack_require__("../../frontend/src/layout/navigation-3000/sidepanel/types.ts"),notebooksModel=__webpack_require__("../../frontend/src/models/notebooksModel.ts");let notebookSceneLogic=(0,index_esm.kea)([(0,index_esm.path)(key=>["scenes","notebooks","notebookSceneLogic",key]),(0,index_esm.props)({}),(0,index_esm.key)(_ref=>{let{shortId}=_ref;return shortId}),(0,index_esm.connect)(props=>({values:[(0,notebookLogic.T)(props),["notebook","notebookLoading","isLocalOnly"],notebooksModel.L,["notebooksLoading"]],actions:[(0,notebookLogic.T)(props),["loadNotebook"],notebooksModel.L,["createNotebook"]]})),(0,index_esm.selectors)(()=>({notebookId:[()=>[(_,props)=>props],props=>props.shortId],loading:[s=>[s.notebookLoading,s.notebooksLoading],(notebookLoading,notebooksLoading)=>notebookLoading||notebooksLoading],breadcrumbs:[s=>[s.notebook,s.loading],(notebook,loading)=>[{key:sceneTypes.x.Notebooks,name:"Notebooks",path:urls.j.notebooks()},{key:[sceneTypes.x.Notebook,notebook?.short_id||"new"],name:notebook?notebook?.title||"Unnamed":loading?null:"Notebook not found"}]],[sidepanel_types.f]:[s=>[s.notebookId,s.isLocalOnly],(notebookId,isLocalOnly)=>notebookId&&!isLocalOnly?{activity_scope:types.jc.NOTEBOOK,activity_item_id:notebookId,access_control_resource:"notebook",access_control_resource_id:notebookId}:null]})),(0,index_esm.afterMount)(_ref2=>{let{actions,props}=_ref2;"new"!==props.shortId&&actions.loadNotebook()})]);var notebookTemplates=__webpack_require__("../../frontend/src/scenes/notebooks/NotebookTemplates/notebookTemplates.ts");let scene={component:NotebookScene_NotebookScene,logic:notebookSceneLogic,paramsToProps:_ref=>{let{params:{shortId}}=_ref;return{shortId:shortId||"missing"}}};function NotebookScene_NotebookScene(){let{notebookId,loading}=(0,index_esm.useValues)(notebookSceneLogic),{createNotebook}=(0,index_esm.useActions)(notebookSceneLogic),{notebook,conflictWarningVisible,accessDeniedToNotebook}=(0,index_esm.useValues)((0,notebookLogic.T)({shortId:notebookId,target:types.bZ.Scene})),{selectNotebook,closeSidePanel}=(0,index_esm.useActions)(notebookPanelLogic.F),{selectedNotebook,visibility}=(0,index_esm.useValues)(notebookPanelLogic.F);if((0,react.useEffect)(()=>{"new"===notebookId&&createNotebook(types.bZ.Scene)},[notebookId]),accessDeniedToNotebook)return(0,jsx_runtime.jsx)(AccessDenied.J,{object:"notebook"});if(!notebook&&!loading&&!conflictWarningVisible)return(0,jsx_runtime.jsx)(NotFound.T,{object:"notebook"});if("visible"===visibility&&selectedNotebook===notebookId)return(0,jsx_runtime.jsxs)("div",{className:"flex flex-col justify-center items-center h-full text-secondary mx-10 flex-1",children:[(0,jsx_runtime.jsxs)("h2",{className:"text-secondary",children:["This Notebook is open in the side panel ",(0,jsx_runtime.jsx)(posthog_icons_es.IconOpenSidebar,{})]}),(0,jsx_runtime.jsxs)("p",{children:["You can navigate around PostHog and ",(0,jsx_runtime.jsx)("b",{children:"drag and drop"})," thing into it. Or you can close the sidebar and it will be full screen here instead."]}),(0,jsx_runtime.jsx)(src.Jp,{type:"secondary",onClick:()=>closeSidePanel(),children:"Open it here instead"})]});let isTemplate=notebook?.is_template;return"new"===notebookId?(0,jsx_runtime.jsx)(NotebookLoadingState.C,{}):(0,jsx_runtime.jsxs)("div",{className:"NotebookScene",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between border-b py-2 mb-2 sticky top-0 bg-primary z-10",children:[(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 items-center",children:[isTemplate&&(0,jsx_runtime.jsx)(src.oe,{type:"highlight",children:"TEMPLATE"}),(0,jsx_runtime.jsx)(UserActivityIndicator.F,{at:notebook?.last_modified_at,by:notebook?.last_modified_by})]}),(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,jsx_runtime.jsx)(NotebookMeta.B,{shortId:notebookId}),(0,jsx_runtime.jsx)(NotebookMenu.z,{shortId:notebookId}),(0,jsx_runtime.jsxs)(src.Jp,{type:"secondary",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconInfo,{}),size:"small",onClick:()=>{selectedNotebook===notebookTemplates.D[0].short_id&&"visible"===visibility?closeSidePanel():selectNotebook(notebookTemplates.D[0].short_id)},children:[selectedNotebook===notebookTemplates.D[0].short_id&&"visible"===visibility?"Close ":"","Guide"]}),(0,jsx_runtime.jsx)(NotebookMeta.t,{type:"secondary",size:"small"}),(0,jsx_runtime.jsx)(src.Jp,{type:"secondary",size:"small",onClick:()=>{selectNotebook(notebookId)},tooltip:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"Opens the notebook in a side panel, that can be accessed from anywhere in the PostHog app. This is great for dragging and dropping elements like insights, recordings or even feature flags into your active notebook."}),sideIcon:(0,jsx_runtime.jsx)(posthog_icons_es.IconOpenSidebar,{}),children:"Open in side panel"})]})]}),(0,jsx_runtime.jsx)(Notebook.a,{shortId:notebookId,editable:!isTemplate},notebookId),(0,jsx_runtime.jsx)(NotebookShareModal,{shortId:notebookId})]})}}}]);