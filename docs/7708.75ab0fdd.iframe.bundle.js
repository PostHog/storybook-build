"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[7708],{"../../frontend/src/scenes/error-tracking/AssigneeSelect.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{i:()=>AssigneeSelect});var _posthog_icons__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.11.2_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),kea__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),scenes_urls__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/scenes/urls.ts"),_AssigneeDisplay__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/scenes/error-tracking/AssigneeDisplay.tsx"),_assigneeSelectLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/scenes/error-tracking/assigneeSelectLogic.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let AssigneeSelect=_ref=>{let{assignee,onChange,showName=!1,showIcon=!0,unassignedLabel="Unassigned",...buttonProps}=_ref,{search,groupOptions,memberOptions,userGroupsLoading,membersLoading}=(0,kea__WEBPACK_IMPORTED_MODULE_2__.useValues)(_assigneeSelectLogic__WEBPACK_IMPORTED_MODULE_6__.q),{setSearch,ensureAssigneeTypesLoaded}=(0,kea__WEBPACK_IMPORTED_MODULE_2__.useActions)(_assigneeSelectLogic__WEBPACK_IMPORTED_MODULE_6__.q),[showPopover,setShowPopover]=(0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(!1),_onChange=value=>{setSearch(""),setShowPopover(!1),onChange(value)};return(0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>{ensureAssigneeTypesLoaded()},[]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Qw,{closeOnClickInside:!1,visible:showPopover,matchWidth:!1,onVisibilityChange:visible=>setShowPopover(visible),overlay:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)("div",{className:"max-w-100 deprecated-space-y-2 overflow-hidden",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.DF,{type:"search",placeholder:"Search",autoFocus:!0,value:search,onChange:setSearch,fullWidth:!0}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)("ul",{className:"deprecated-space-y-2",children:[assignee&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("li",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{fullWidth:!0,role:"menuitem",size:"small",icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_0__.IconX,{}),onClick:()=>_onChange(null),children:"Remove assignee"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(Section,{title:"Groups",loading:userGroupsLoading,search:!!search,type:"user_group",items:groupOptions,onSelect:_onChange,activeId:assignee?.id,emptyState:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{fullWidth:!0,size:"small",icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_0__.IconPlusSmall,{}),to:scenes_urls__WEBPACK_IMPORTED_MODULE_4__.j.settings("environment-error-tracking","user-groups"),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("div",{className:"text-secondary",children:"Create user group"})})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(Section,{title:"Users",loading:membersLoading,search:!!search,type:"user",items:memberOptions,onSelect:_onChange,activeId:assignee?.id})]})]}),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("div",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_AssigneeDisplay__WEBPACK_IMPORTED_MODULE_5__.p,{assignee:assignee,children:_ref2=>{let{displayAssignee}=_ref2;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{tooltip:displayAssignee.displayName,icon:showIcon?displayAssignee.icon:null,...buttonProps,children:showName?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("span",{className:"pl-1",children:"unassigned"===displayAssignee.id?unassignedLabel:displayAssignee.displayName}):null})}})})})},Section=_ref3=>{let{loading,search,type,items,onSelect,activeId,emptyState,title}=_ref3;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("li",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)("section",{className:"deprecated-space-y-px",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("h5",{className:"mx-2 my-0.5",children:title}),items.map(item=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("li",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{fullWidth:!0,role:"menuitem",size:"small",icon:item.icon,onClick:()=>onSelect(activeId===item.id?null:{type,id:item.id}),active:activeId===item.id,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("span",{className:"flex items-center justify-between gap-2 flex-1",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("span",{children:item.displayName})})})},item.id)),loading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("div",{className:"p-2 text-secondary italic truncate border-t",children:"Loading..."}):0===items.length?search?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("div",{className:"p-2 text-secondary italic truncate border-t",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("span",{children:"No matches"})}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("div",{className:"border-t pt-1",children:emptyState}):null]})})}},"../../frontend/src/scenes/error-tracking/ErrorTrackingFilters.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>ErrorTrackingFilters});var _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),kea__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib_components_DateFilter_DateFilter__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/components/DateFilter/DateFilter.tsx"),lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/components/TaxonomicFilter/types.ts"),lib_components_UniversalFilters_UniversalFilters__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/components/UniversalFilters/UniversalFilters.tsx"),lib_components_UniversalFilters_universalFiltersLogic__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/lib/components/UniversalFilters/universalFiltersLogic.ts"),lib_components_UniversalFilters_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/lib/components/UniversalFilters/utils.ts"),lib_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/lib/utils.tsx"),react__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),scenes_insights_filters_TestAccountFilter__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../frontend/src/scenes/insights/filters/TestAccountFilter/index.ts"),_errorTrackingLogic__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../frontend/src/scenes/error-tracking/errorTrackingLogic.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let errorTrackingDateOptions=lib_utils__WEBPACK_IMPORTED_MODULE_7__.bE.filter(dm=>"Yesterday"!=dm.key),ErrorTrackingFilters=()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)("div",{className:"deprecated-space-y-1",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(DateRange,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(FilterGroup,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(UniversalSearch,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(InternalAccounts,{})]})}),FilterGroup=()=>{let{filterGroup}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useValues)(_errorTrackingLogic__WEBPACK_IMPORTED_MODULE_10__.HT),{setFilterGroup}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useActions)(_errorTrackingLogic__WEBPACK_IMPORTED_MODULE_10__.HT);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(lib_components_UniversalFilters_UniversalFilters__WEBPACK_IMPORTED_MODULE_4__.Z,{rootKey:"error-tracking",group:filterGroup,taxonomicGroupTypes:[lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__.t.EventProperties,lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__.t.PersonProperties,lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__.t.Cohorts],onChange:setFilterGroup,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(RecordingsUniversalFilterGroup,{})})},RecordingsUniversalFilterGroup=()=>{let{filterGroup}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useValues)(lib_components_UniversalFilters_universalFiltersLogic__WEBPACK_IMPORTED_MODULE_5__.d),{replaceGroupValue,removeGroupValue}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useActions)(lib_components_UniversalFilters_universalFiltersLogic__WEBPACK_IMPORTED_MODULE_5__.d),[allowInitiallyOpen,setAllowInitiallyOpen]=(0,react__WEBPACK_IMPORTED_MODULE_8__.useState)(!1);return(0,react__WEBPACK_IMPORTED_MODULE_8__.useEffect)(()=>{setAllowInitiallyOpen(!0)},[]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.Fragment,{children:filterGroup.values.map((filterOrGroup,index)=>(0,lib_components_UniversalFilters_utils__WEBPACK_IMPORTED_MODULE_6__.pU)(filterOrGroup)?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsxs)(lib_components_UniversalFilters_UniversalFilters__WEBPACK_IMPORTED_MODULE_4__.Z.Group,{index:index,group:filterOrGroup,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(RecordingsUniversalFilterGroup,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(lib_components_UniversalFilters_UniversalFilters__WEBPACK_IMPORTED_MODULE_4__.Z.AddFilterButton,{size:"small",type:"secondary"})]},index):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(lib_components_UniversalFilters_UniversalFilters__WEBPACK_IMPORTED_MODULE_4__.Z.Value,{index:index,filter:filterOrGroup,onRemove:()=>removeGroupValue(index),onChange:value=>replaceGroupValue(index,value),initiallyOpen:allowInitiallyOpen},index))})},DateRange=()=>{let{dateRange}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useValues)(_errorTrackingLogic__WEBPACK_IMPORTED_MODULE_10__.HT),{setDateRange}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useActions)(_errorTrackingLogic__WEBPACK_IMPORTED_MODULE_10__.HT);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(lib_components_DateFilter_DateFilter__WEBPACK_IMPORTED_MODULE_2__.f,{size:"small",dateFrom:dateRange.date_from,dateTo:dateRange.date_to,dateOptions:errorTrackingDateOptions,onChange:(changedDateFrom,changedDateTo)=>setDateRange({date_from:changedDateFrom,date_to:changedDateTo})})},UniversalSearch=()=>{let{searchQuery}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useValues)(_errorTrackingLogic__WEBPACK_IMPORTED_MODULE_10__.HT),{setSearchQuery}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useActions)(_errorTrackingLogic__WEBPACK_IMPORTED_MODULE_10__.HT);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.DF,{type:"search",placeholder:"Search...",value:searchQuery,onChange:setSearchQuery,className:"flex-grow max-w-none",size:"small"})},InternalAccounts=()=>{let{filterTestAccounts}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useValues)(_errorTrackingLogic__WEBPACK_IMPORTED_MODULE_10__.HT),{setFilterTestAccounts}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useActions)(_errorTrackingLogic__WEBPACK_IMPORTED_MODULE_10__.HT);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)("div",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(scenes_insights_filters_TestAccountFilter__WEBPACK_IMPORTED_MODULE_9__.z,{size:"small",filters:{filter_test_accounts:filterTestAccounts},onChange:_ref=>{let{filter_test_accounts}=_ref;return setFilterTestAccounts(filter_test_accounts||!1)}})})}},"../../frontend/src/scenes/error-tracking/ErrorTrackingSetupPrompt.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>ErrorTrackingSetupPrompt});var _posthog_icons__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.11.2_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),kea__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib_components_ProductIntroduction_ProductIntroduction__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/components/ProductIntroduction/ProductIntroduction.tsx"),lib_hooks_useFeatureFlag__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/hooks/useFeatureFlag.ts"),posthog_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/.pnpm/posthog-js@1.229.0_@rrweb+types@2.0.0-alpha.17/node_modules/posthog-js/dist/module.js"),scenes_teamLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/scenes/teamLogic.tsx"),_types__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/types.ts"),_errorTrackingLogic__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../frontend/src/scenes/error-tracking/errorTrackingLogic.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let ErrorTrackingSetupPrompt=_ref=>{let{children}=_ref,{hasSentExceptionEvent,hasSentExceptionEventLoading}=(0,kea__WEBPACK_IMPORTED_MODULE_2__.useValues)(_errorTrackingLogic__WEBPACK_IMPORTED_MODULE_8__.HT),{currentTeam,currentTeamLoading}=(0,kea__WEBPACK_IMPORTED_MODULE_2__.useValues)(scenes_teamLogic__WEBPACK_IMPORTED_MODULE_6__.teamLogic),hasErrorTracking=(0,lib_hooks_useFeatureFlag__WEBPACK_IMPORTED_MODULE_4__.y)("ERROR_TRACKING"),exceptionAutocaptureEnabled=currentTeam&&currentTeam.autocapture_exceptions_opt_in;return hasSentExceptionEventLoading||currentTeamLoading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"flex justify-center",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.$j,{})}):hasErrorTracking?hasSentExceptionEvent||exceptionAutocaptureEnabled?children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(IngestionStatusCheck,{}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(BetaAccessBanner,{})},IngestionStatusCheck=()=>{let{updateCurrentTeam}=(0,kea__WEBPACK_IMPORTED_MODULE_2__.useActions)(scenes_teamLogic__WEBPACK_IMPORTED_MODULE_6__.teamLogic);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(lib_components_ProductIntroduction_ProductIntroduction__WEBPACK_IMPORTED_MODULE_3__.C,{productName:"Error tracking",thingName:"issue",titleOverride:"You haven't captured any exceptions",description:"To start capturing exceptions you need to enable exception autocapture. Exception autocapture only applies to the JS SDK. Installation for other platforms are described in the docs.",isEmpty:!0,productKey:_types__WEBPACK_IMPORTED_MODULE_7__.Md.ERROR_TRACKING,actionElementOverride:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{type:"primary",onClick:()=>updateCurrentTeam({autocapture_exceptions_opt_in:!0}),children:"Enable exception autocapture"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{targetBlank:!0,sideIcon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_0__.IconExternal,{className:"w-5 h-5"}),to:"https://posthog.com/docs/error-tracking/installation",children:"Read the docs"})]})})},BetaAccessBanner=()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(lib_components_ProductIntroduction_ProductIntroduction__WEBPACK_IMPORTED_MODULE_3__.C,{productName:"Error tracking",thingName:"issue",titleOverride:"Welcome to Error Tracking",description:"Error tracking is in beta for our JS, Node and Python SDKs.",isEmpty:!0,docsURL:"https://posthog.com/docs/error-tracking",productKey:_types__WEBPACK_IMPORTED_MODULE_7__.Md.ERROR_TRACKING,actionElementOverride:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{type:"primary",onClick:()=>posthog_js__WEBPACK_IMPORTED_MODULE_5__.ZP.updateEarlyAccessFeatureEnrollment("error-tracking",!0),children:"Get started"})})},"../../frontend/src/scenes/error-tracking/errorTrackingIssueSceneLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F:()=>EventsMode,r:()=>errorTrackingIssueSceneLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),kea_router__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.2.1_kea@3.1.5_react@18.2.0_/node_modules/kea-router/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/api.ts"),lib_dayjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/dayjs.ts"),posthog_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/.pnpm/posthog-js@1.229.0_@rrweb+types@2.0.0-alpha.17/node_modules/posthog-js/dist/module.js"),scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/scenes/urls.ts"),_layout_navigation_3000_sidepanel_types__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../frontend/src/layout/navigation-3000/sidepanel/types.ts"),_types__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../frontend/src/types.ts"),_errorTrackingLogic__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../frontend/src/scenes/error-tracking/errorTrackingLogic.ts"),_queries__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../frontend/src/scenes/error-tracking/queries.ts");let EventsMode=function(EventsMode){return EventsMode.Latest="latest",EventsMode.Earliest="earliest",EventsMode.Recommended="recommended",EventsMode.All="all",EventsMode}({}),errorTrackingIssueSceneLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(key=>["scenes","error-tracking","errorTrackingIssueSceneLogic",key]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.key)(props=>props.id),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)({values:[_errorTrackingLogic__WEBPACK_IMPORTED_MODULE_9__.HT,["dateRange","filterTestAccounts","filterGroup","customSparklineConfig"]],actions:[_errorTrackingLogic__WEBPACK_IMPORTED_MODULE_9__.HT,["setDateRange","setFilterTestAccounts","setFilterGroup"]]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({initIssue:!0,setIssue:issue=>({issue}),setEventsMode:mode=>({mode}),updateIssue:issue=>({issue}),assignIssue:assignee=>({assignee})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({eventsMode:[EventsMode.Latest,{setEventsMode:(_,_ref)=>{let{mode}=_ref;return mode}}]}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)(_ref2=>{let{props,values}=_ref2;return{issue:[null,{loadRelationalIssue:async()=>{let response=await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.errorTracking.getIssue(props.id,props.fingerprint);return{...values.issue,...response}},loadClickHouseIssue:async first_seen=>{let lastSeen=values.issue&&values.issue.last_seen?(0,lib_dayjs__WEBPACK_IMPORTED_MODULE_4__.Bv)(values.issue?.last_seen).endOf("minute"):(0,lib_dayjs__WEBPACK_IMPORTED_MODULE_4__.Bv)(),firstSeen=(0,lib_dayjs__WEBPACK_IMPORTED_MODULE_4__.Bv)(first_seen).startOf("minute");return(await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.query((0,_queries__WEBPACK_IMPORTED_MODULE_10__.zx)({issueId:props.id,dateRange:{date_from:firstSeen.toISOString(),date_to:lastSeen.toISOString()},customVolume:values.customSparklineConfig}),{},void 0,!0)).results[0]},updateIssue:async _ref3=>{let{issue}=_ref3,response=await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.errorTracking.updateIssue(props.id,issue);return posthog_js__WEBPACK_IMPORTED_MODULE_5__.ZP.capture("error_tracking_issue_status_updated",{...issue,issue_id:props.id}),{...values.issue,...response}},assignIssue:async _ref4=>{let{assignee}=_ref4;return await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.errorTracking.assignIssue(props.id,assignee),posthog_js__WEBPACK_IMPORTED_MODULE_5__.ZP.capture("error_tracking_issue_assigned",{issue_id:props.id}),values.issue?{...values.issue,assignee}:values.issue},setIssue:_ref5=>{let{issue}=_ref5;return issue}}]}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({breadcrumbs:[s=>[s.issue],issue=>{let exceptionType=issue?.name||"Unknown Type";return[{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_6__.x.ErrorTracking,name:"Error tracking",path:scenes_urls__WEBPACK_IMPORTED_MODULE_7__.j.errorTracking()},{key:[scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_6__.x.ErrorTrackingIssue,exceptionType],name:exceptionType}]}],[_layout_navigation_3000_sidepanel_types__WEBPACK_IMPORTED_MODULE_11__.f]:[(_,p)=>[p.id],issueId=>({activity_scope:_types__WEBPACK_IMPORTED_MODULE_8__.jc.ERROR_TRACKING_ISSUE,activity_item_id:issueId})],eventsQuery:[s=>[s.issue,s.filterTestAccounts,s.filterGroup,s.dateRange],(issue,filterTestAccounts,filterGroup,dateRange)=>(0,_queries__WEBPACK_IMPORTED_MODULE_10__.QT)({issue,filterTestAccounts:filterTestAccounts,filterGroup:filterGroup,dateRange})],issueProperties:[s=>[s.issue],issue=>issue&&issue.earliest?JSON.parse(issue.earliest):{}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.listeners)(_ref6=>{let{values,actions}=_ref6,loadIssue=()=>{if(!values.issueLoading){let issue=values.issue;issue?actions.loadClickHouseIssue(values.dateRange.date_from||issue.first_seen):actions.loadRelationalIssue()}};return{setIssueSuccess:loadIssue,initIssue:loadIssue,loadRelationalIssueSuccess:loadIssue,loadRelationalIssueFailure:_ref7=>{let{errorObject:{status,data}}=_ref7;308==status&&"issue_id"in data&&kea_router__WEBPACK_IMPORTED_MODULE_2__.router.actions.replace(scenes_urls__WEBPACK_IMPORTED_MODULE_7__.j.errorTrackingIssue(data.issue_id))},setDateRange:loadIssue,setFilterTestAccounts:loadIssue,setFilterGroup:loadIssue}})])},"../../frontend/src/scenes/error-tracking/errorTrackingLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{HT:()=>errorTrackingLogic,Kg:()=>DEFAULT_ERROR_TRACKING_FILTER_GROUP,O3:()=>DEFAULT_ERROR_TRACKING_DATE_RANGE});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),kea_subscriptions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/kea-subscriptions@3.0.1_kea@3.1.5_react@18.2.0_/node_modules/kea-subscriptions/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/api.ts"),lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/logic/featureFlagLogic.ts"),lib_utils_definitions__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/lib/utils/definitions.ts"),_types__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/types.ts");let lastHour={value:"1h",label:"1h"},lastDay={value:"24h",label:"24h"},lastMonth={value:"mStart",label:"Month"},lastYear={value:"yStart",label:"Year"},customOptions={dStart:{default:lastDay,custom:lastHour},"-24h":{default:lastDay,custom:lastHour},mStart:{custom:lastMonth,default:lastDay},yStart:{custom:lastYear,default:lastMonth},all:{custom:lastYear,default:lastMonth}},DEFAULT_ERROR_TRACKING_DATE_RANGE={date_from:"-7d",date_to:null},DEFAULT_ERROR_TRACKING_FILTER_GROUP={type:_types__WEBPACK_IMPORTED_MODULE_6__.J2.And,values:[{type:_types__WEBPACK_IMPORTED_MODULE_6__.J2.And,values:[]}]},SPARKLINE_CONFIGURATIONS={"1h":{value:60,interval:"minute"},"24h":{value:24,interval:"hour"},"7d":{value:168,interval:"hour"},"14d":{value:336,interval:"hour"},"90d":{value:90,interval:"day"},"180d":{value:26,interval:"week"},mStart:{value:31,interval:"day"},yStart:{value:52,interval:"week"}};function constructSparklineConfig(selectedPeriod){if(selectedPeriod in SPARKLINE_CONFIGURATIONS)return SPARKLINE_CONFIGURATIONS[selectedPeriod];let[value,unit]=selectedPeriod.match(/\d+|\D+/g);return{value:Number(value)*("y"===unit?12:1),interval:"h"===unit?"hour":"d"===unit?"day":"w"===unit?"week":"month"}}let errorTrackingLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","error-tracking","errorTrackingLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)({values:[lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_4__.h,["featureFlags"]]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setDateRange:dateRange=>({dateRange}),setAssignee:assignee=>({assignee}),setSearchQuery:searchQuery=>({searchQuery}),setFilterGroup:filterGroup=>({filterGroup}),setFilterTestAccounts:filterTestAccounts=>({filterTestAccounts}),setSparklineSelectedPeriod:period=>({period})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({dateRange:[DEFAULT_ERROR_TRACKING_DATE_RANGE,{persist:!0},{setDateRange:(_,_ref)=>{let{dateRange}=_ref;return dateRange}}],assignee:[null,{setAssignee:(_,_ref2)=>{let{assignee}=_ref2;return assignee}}],filterGroup:[DEFAULT_ERROR_TRACKING_FILTER_GROUP,{persist:!0},{setFilterGroup:(_,_ref3)=>{let{filterGroup}=_ref3;return filterGroup}}],filterTestAccounts:[!1,{persist:!0},{setFilterTestAccounts:(_,_ref4)=>{let{filterTestAccounts}=_ref4;return filterTestAccounts}}],searchQuery:["",{setSearchQuery:(_,_ref5)=>{let{searchQuery}=_ref5;return searchQuery}}],sparklineSelectedPeriod:[lastDay.value,{persist:!0},{setSparklineSelectedPeriod:(_,_ref6)=>{let{period}=_ref6;return period}}]}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)({hasSentExceptionEvent:{__default:void 0,loadExceptionEventDefinition:async()=>{let definition=(await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.eventDefinitions.list({event_type:_types__WEBPACK_IMPORTED_MODULE_6__.uW.Event,search:"$exception"})).results.find(r=>"$exception"===r.name);return!!definition&&!(0,lib_utils_definitions__WEBPACK_IMPORTED_MODULE_5__.U)(definition)}}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({sparklineOptions:[s=>[s.dateRange],_ref7=>{let{date_from}=_ref7;if(!date_from)return null;let isRelative=date_from.match(/-\d+[hdmy]/);if(date_from in customOptions)return customOptions[date_from];if(isRelative){let value=date_from?.replace("-","");return{custom:{value:value,label:value},default:lastDay}}return null}],customSparklineConfig:[s=>[s.sparklineOptions],sparklineOptions=>sparklineOptions?constructSparklineConfig(sparklineOptions.custom.value):null]}),(0,kea_subscriptions__WEBPACK_IMPORTED_MODULE_2__.Vt)(_ref8=>{let{values,actions}=_ref8;return{sparklineOptions:sparklineOptions=>{if(sparklineOptions){let options=Object.values(sparklineOptions).map(o=>o.value);values.sparklineSelectedPeriod&&options.includes(values.sparklineSelectedPeriod)||actions.setSparklineSelectedPeriod(sparklineOptions.custom.value)}else actions.setSparklineSelectedPeriod(null)}}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.afterMount)(_ref9=>{let{actions}=_ref9;actions.loadExceptionEventDefinition()})])}}]);