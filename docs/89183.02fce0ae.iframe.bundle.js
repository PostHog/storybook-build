(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[89183],{"../../frontend/src/scenes/actions/NewActionButton.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{O:()=>NewActionButton});var _posthog_icons__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.27.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),kea_router__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.6_react@18.2.0_/node_modules/kea-router/lib/index.js"),lib_components_AuthorizedUrlList_AuthorizedUrlList__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/components/AuthorizedUrlList/AuthorizedUrlList.tsx"),lib_components_AuthorizedUrlList_authorizedUrlListLogic__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/components/AuthorizedUrlList/authorizedUrlListLogic.ts"),lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/index.ts"),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),scenes_urls__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/scenes/urls.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function NewActionButton(_ref){let{onSelectOption}=_ref,[visible,setVisible]=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)(!1),[appUrlsVisible,setAppUrlsVisible]=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)(!1);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_5__.J,{type:"primary",onClick:()=>setVisible(!0),"data-attr":"create-action",children:"New action"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.fQ,{isOpen:visible,onClose:()=>{setVisible(!1),setAppUrlsVisible(!1)},title:"Create new action",footer:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.Fragment,{children:[appUrlsVisible&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_5__.J,{type:"secondary",onClick:()=>setAppUrlsVisible(!1),children:"Back"},"back-button"),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_5__.J,{type:"secondary",onClick:()=>{setVisible(!1),setAppUrlsVisible(!1)},children:"Cancel"},"cancel-button")]}),children:appUrlsVisible?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{className:"max-w-160",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(lib_components_AuthorizedUrlList_AuthorizedUrlList__WEBPACK_IMPORTED_MODULE_3__.t,{type:lib_components_AuthorizedUrlList_authorizedUrlListLogic__WEBPACK_IMPORTED_MODULE_4__.uw.TOOLBAR_URLS})}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("div",{className:"deprecated-space-y-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_5__.J,{type:"secondary",icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_0__.IconSearch,{}),onClick:()=>setAppUrlsVisible(!0),size:"large",fullWidth:!0,center:!0,"data-attr":"new-action-inspect",children:"Inspect element on your site"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_5__.J,{type:"secondary",icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_0__.IconPencil,{}),onClick:()=>{onSelectOption?.(),kea_router__WEBPACK_IMPORTED_MODULE_2__.router.actions.push(scenes_urls__WEBPACK_IMPORTED_MODULE_7__.j.createAction())},size:"large",fullWidth:!0,center:!0,"data-attr":"new-action-pageview",children:"From event or pageview"})]})})]})}},"../../frontend/src/scenes/data-management/DataManagementScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DataManagementScene:()=>DataManagementScene,DataManagementTab:()=>DataManagementTab,scene:()=>scene});var posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.27.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.6_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.6_react@18.2.0_/node_modules/kea-router/lib/index.js"),ActivityLog=__webpack_require__("../../frontend/src/lib/components/ActivityLog/ActivityLog.tsx"),PageHeader=__webpack_require__("../../frontend/src/lib/components/PageHeader.tsx"),TitleWithIcon=__webpack_require__("../../frontend/src/lib/components/TitleWithIcon.tsx"),constants=__webpack_require__("../../frontend/src/lib/constants.tsx"),LemonTag=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTag/index.ts"),Tooltip=__webpack_require__("../../frontend/src/lib/lemon-ui/Tooltip/index.ts"),featureFlagLogic=__webpack_require__("../../frontend/src/lib/logic/featureFlagLogic.ts"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),BaseCurrency=__webpack_require__("../../frontend/src/lib/components/BaseCurrency/BaseCurrency.tsx"),ProductIntroduction=__webpack_require__("../../frontend/src/lib/components/ProductIntroduction/ProductIntroduction.tsx"),LemonButton=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/index.ts"),react=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),dataWarehouseSettingsLogic=__webpack_require__("../../frontend/src/scenes/data-warehouse/settings/dataWarehouseSettingsLogic.ts"),EventConfiguration=__webpack_require__("../../products/revenue_analytics/frontend/settings/EventConfiguration.tsx"),ExternalDataSourceConfiguration=__webpack_require__("../../products/revenue_analytics/frontend/settings/ExternalDataSourceConfiguration.tsx"),FilterTestAccountsConfiguration=__webpack_require__("../../products/revenue_analytics/frontend/settings/FilterTestAccountsConfiguration.tsx"),GoalsConfiguration=__webpack_require__("../../products/revenue_analytics/frontend/settings/GoalsConfiguration.tsx"),revenueAnalyticsSettingsLogic=__webpack_require__("../../products/revenue_analytics/frontend/settings/revenueAnalyticsSettingsLogic.ts"),Query=__webpack_require__("../../frontend/src/queries/Query/Query.tsx"),schema_general=__webpack_require__("../../frontend/src/queries/schema/schema-general.ts"),geography_currency=__webpack_require__("../../frontend/src/lib/utils/geography/currency.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let Revenue=_ref=>{let{value,currency}=_ref,{symbol,isPrefix}=(0,geography_currency.jK)(null!=currency?currency:schema_general.NE.USD);return(0,jsx_runtime.jsx)("div",{children:`${isPrefix?symbol:""}${(0,utils.Lc)(value,10,2)}${isPrefix?"":" "+symbol}`})},Currency=_ref2=>{let{currency}=_ref2;return(0,jsx_runtime.jsxs)("div",{children:[geography_currency.Bu[currency]," ",currency]})},queryContext={showOpenEditorButton:!0,columns:{original_currency:{render:_ref=>{let{value}=_ref;return(0,jsx_runtime.jsx)(Currency,{currency:value})}},original_revenue:{render:_ref2=>{let{value,record}=_ref2,originalCurrency=record[3];return(0,jsx_runtime.jsx)(Revenue,{value:value,currency:null!=originalCurrency?originalCurrency:schema_general.NE.USD})}},currency:{render:_ref3=>{let{value}=_ref3;return(0,jsx_runtime.jsx)(Currency,{currency:value})}},revenue:{render:_ref4=>{let{value,record}=_ref4,convertedCurrency=record[5];return(0,jsx_runtime.jsx)(Revenue,{value:value,currency:null!=convertedCurrency?convertedCurrency:schema_general.NE.USD})}}}};function RevenueExampleDataWarehouseTablesData(){let{exampleDataWarehouseTablesQuery}=(0,index_esm.useValues)(revenueAnalyticsSettingsLogic.m);return exampleDataWarehouseTablesQuery?(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h3",{children:"Data warehouse tables revenue data"}),(0,jsx_runtime.jsx)("p",{children:"The following rows of data were imported from your data warehouse tables. This is helpful when you're trying to debug what your revenue data looks like."}),(0,jsx_runtime.jsx)(Query.A,{query:exampleDataWarehouseTablesQuery,context:queryContext})]}):null}let RevenueExampleEventsTable_queryContext={showOpenEditorButton:!0,columns:{original_amount:{title:"Ingested amount"},currency_aware_amount:{title:"Parsed amount",render:_ref=>{let{value,record}=_ref,adjustedCurrency=record[4];return(0,jsx_runtime.jsx)(Revenue,{value:value,currency:null!=adjustedCurrency?adjustedCurrency:schema_general.NE.USD})}},original_currency:{title:"Ingested currency",render:_ref2=>{let{value}=_ref2;return(0,jsx_runtime.jsx)(Currency,{currency:value})}},currency:{render:_ref3=>{let{value}=_ref3;return(0,jsx_runtime.jsx)(Currency,{currency:value})}},amount:{render:_ref4=>{let{value,record}=_ref4,convertedCurrency=record[6];return(0,jsx_runtime.jsx)(Revenue,{value:value,currency:null!=convertedCurrency?convertedCurrency:schema_general.NE.USD})}}}};function RevenueExampleEventsTable(){let{exampleEventsQuery}=(0,index_esm.useValues)(revenueAnalyticsSettingsLogic.m);return exampleEventsQuery?(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h3",{children:"Revenue events"}),(0,jsx_runtime.jsx)("p",{children:"The following revenue events are available in your data. This is helpful when you're trying to debug what your revenue events look like."}),(0,jsx_runtime.jsx)(Query.A,{query:exampleEventsQuery,context:RevenueExampleEventsTable_queryContext})]}):null}function RevenueAnalyticsSettings(){let[activeTab,setActiveTab]=(0,react.useState)("events"),{events}=(0,index_esm.useValues)(revenueAnalyticsSettingsLogic.m),{dataWarehouseSources,dataWarehouseSourcesLoading}=(0,index_esm.useValues)(dataWarehouseSettingsLogic.T),{featureFlags}=(0,index_esm.useValues)(featureFlagLogic.featureFlagLogic),eventsButtonRef=(0,react.useRef)(null),dataWarehouseTablesButtonRef=(0,react.useRef)(null),product=featureFlags[constants.y8.REVENUE_ANALYTICS]?"Revenue analytics":"Web analytics",introductionDescription=`Revenue events are used to track revenue in ${product}. You can choose which custom events PostHog should consider as revenue events, and which event property corresponds to the value of the event.`;featureFlags[constants.y8.REVENUE_ANALYTICS]&&(introductionDescription+=" You can also import revenue data from your PostHog data warehouse tables.");let hasNoEvents=!events.length,hasNoDataWarehouseSources=!dataWarehouseSourcesLoading&&!dataWarehouseSources?.results.filter(source=>"Stripe"===source.source_type).length;return(0,jsx_runtime.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,jsx_runtime.jsx)(ProductIntroduction.C,{productName:"Revenue tracking",thingName:"revenue source",description:introductionDescription,isEmpty:hasNoEvents&&hasNoDataWarehouseSources,actionElementOverride:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,jsx_runtime.jsx)(LemonButton.J,{type:"primary",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconPlus,{}),onClick:()=>{eventsButtonRef.current?.scrollIntoView({behavior:"smooth"}),eventsButtonRef.current?.click()},"data-attr":"create-revenue-event",children:"Add revenue event"}),featureFlags[constants.y8.REVENUE_ANALYTICS]&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(LemonButton.J,{type:"primary",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconPlus,{}),onClick:()=>{dataWarehouseTablesButtonRef.current?.scrollIntoView({behavior:"smooth"}),dataWarehouseTablesButtonRef.current?.click()},"data-attr":"import-revenue-data-warehouse-tables",children:"Import revenue data from data warehouse"}),(0,jsx_runtime.jsxs)("span",{className:"text-xs text-muted-alt",children:["Only Stripe is supported currently. ",(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)(src.rU,{to:"https://github.com/PostHog/posthog/issues/new?assignees=&labels=enhancement,feature/revenue-analytics%2C+feature&projects=&template=feature_request.yml&title=New%20revenue%20source:%20%3Cinsert%20source%3E",children:"Request more revenue integrations."})]})]})]})})}),(0,jsx_runtime.jsx)(BaseCurrency.Y,{}),(0,jsx_runtime.jsx)(FilterTestAccountsConfiguration.Y,{}),featureFlags[constants.y8.REVENUE_ANALYTICS]&&(0,jsx_runtime.jsx)(GoalsConfiguration.K,{}),featureFlags[constants.y8.REVENUE_ANALYTICS]&&(0,jsx_runtime.jsx)(ExternalDataSourceConfiguration.S,{buttonRef:dataWarehouseTablesButtonRef}),(0,jsx_runtime.jsx)(EventConfiguration.C,{buttonRef:eventsButtonRef}),featureFlags[constants.y8.REVENUE_ANALYTICS]?(0,jsx_runtime.jsx)(src.TP,{activeKey:activeTab,onChange:key=>setActiveTab(key),tabs:[{key:"data-warehouse",label:"Data Warehouse revenue events",content:(0,jsx_runtime.jsx)(RevenueExampleDataWarehouseTablesData,{})},{key:"events",label:"Revenue events",content:(0,jsx_runtime.jsx)(RevenueExampleEventsTable,{})}]}):(0,jsx_runtime.jsx)(RevenueExampleEventsTable,{})]})}var NewActionButton=__webpack_require__("../../frontend/src/scenes/actions/NewActionButton.tsx"),hedgehogs=__webpack_require__("../../frontend/src/lib/components/hedgehogs.tsx"),LemonTable=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/index.ts"),columnUtils=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/columnUtils.tsx"),LemonTag_LemonTag=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTag/LemonTag.tsx"),ProfilePicture=__webpack_require__("../../frontend/src/lib/lemon-ui/ProfilePicture/index.ts"),organizationLogic=__webpack_require__("../../frontend/src/scenes/organizationLogic.tsx"),teamLogic=__webpack_require__("../../frontend/src/scenes/teamLogic.tsx"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),annotationsModel=__webpack_require__("../../frontend/src/models/annotationsModel.ts"),types=__webpack_require__("../../frontend/src/types.ts"),AnnotationModal=__webpack_require__("../../frontend/src/scenes/annotations/AnnotationModal.tsx"),annotationModalLogic=__webpack_require__("../../frontend/src/scenes/annotations/annotationModalLogic.ts");let isValidAnnotationScope=scope=>Object.values(types.dc).includes(scope),annotationScopesMenuOptions=()=>{let scopeOptions=Object.values(types.dc).map(scope=>({value:scope,label:annotationModalLogic.B3[scope]}));return scopeOptions.unshift({value:null,label:"Any"}),scopeOptions},annotationsLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","annotations","annotationsLogic"]),(0,index_esm.connect)(()=>({values:[annotationsModel.AT,["annotations","annotationsLoading","next","loadingNext"],teamLogic.teamLogic,["timezone"]]})),(0,index_esm.actions)({setScope:scope=>({scope})}),(0,index_esm.reducers)(()=>({scope:[null,{setScope:(_,_ref)=>{let{scope}=_ref;return scope}}]})),(0,index_esm.selectors)(()=>({shouldShowEmptyState:[s=>[s.annotations,s.annotationsLoading],(annotations,annotationsLoading)=>0===annotations.length&&!annotationsLoading],filteredAnnotations:[s=>[s.annotations,s.scope],(annotations,scope)=>scope?annotations.filter(annotation=>annotation.scope===scope):annotations]})),(0,lib.actionToUrl)(()=>({setScope:_ref2=>{let{scope}=_ref2;return[lib.router.values.location.pathname,{...lib.router.values.searchParams,scope:scope||void 0},lib.router.values.hashParams,{replace:!0}]}})),(0,lib.urlToAction)(_ref3=>{let{actions,values}=_ref3;return{[urls.j.annotations()]:(_,searchParams)=>{let scope=searchParams.scope;scope&&isValidAnnotationScope(scope)&&scope!==values.scope&&actions.setScope(scope),!scope&&values.scope&&actions.setScope(null)}}})]);var TextCard=__webpack_require__("../../frontend/src/lib/components/Cards/TextCard/TextCard.tsx"),TZLabel=__webpack_require__("../../frontend/src/lib/components/TZLabel/index.tsx");function Annotations(){let{currentTeam}=(0,index_esm.useValues)(teamLogic.teamLogic),{currentOrganization}=(0,index_esm.useValues)(organizationLogic.organizationLogic),{openModalToCreateAnnotation}=(0,index_esm.useActions)(annotationModalLogic.bE),{filteredAnnotations,shouldShowEmptyState,annotationsLoading,scope}=(0,index_esm.useValues)(annotationsLogic),{setScope}=(0,index_esm.useActions)(annotationsLogic),{loadingNext,next}=(0,index_esm.useValues)(annotationsModel.AT),{loadAnnotationsNext}=(0,index_esm.useActions)(annotationsModel.AT),columns=[{title:"Annotation",key:"annotation",width:"30%",render:function RenderAnnotation(_,annotation){var _annotation$content,_annotation$content2,_annotation$content3;let renderedContent=(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:null!==(_annotation$content=annotation.content)&&void 0!==_annotation$content?_annotation$content:""});return(annotation.content||"").trim().length>30&&(renderedContent=(0,jsx_runtime.jsx)(Tooltip.u,{title:(0,jsx_runtime.jsx)(TextCard.D7,{text:null!==(_annotation$content2=annotation.content)&&void 0!==_annotation$content2?_annotation$content2:"","data-attr":"annotation-scene-comment-title-rendered-content"}),children:(null!==(_annotation$content3=annotation.content)&&void 0!==_annotation$content3?_annotation$content3:"").slice(0,27)+"..."})),(0,jsx_runtime.jsx)("div",{className:"font-semibold",children:(0,jsx_runtime.jsx)(src.rU,{subtle:!0,to:urls.j.annotation(annotation.id),children:renderedContent})})}},{title:"Timestamp",dataIndex:"date_marker",render:function RenderDateMarker(_,annotation){return annotation.date_marker?(0,jsx_runtime.jsx)(TZLabel.w,{time:annotation.date_marker}):null},sorter:(a,b)=>a.date_marker?.diff(b.date_marker)||1},{title:"Scope",key:"scope",render:function RenderType(_,annotation){let scopeName=annotationModalLogic.B3[annotation.scope],tooltip=annotation.scope===types.dc.Insight?`This annotation only applies to the "${annotation.insight_name}" insight`:annotation.scope===types.dc.Dashboard?`This annotation applies to all insights on the ${annotation.dashboard_name} dashboard`:annotation.scope===types.dc.Project?`This annotation applies to all insights in the ${currentTeam?.name} project`:`This annotation applies to all insights in the ${currentOrganization?.name} organization`;return(0,jsx_runtime.jsx)(Tooltip.u,{title:tooltip,placement:"right",children:(0,jsx_runtime.jsx)(LemonTag_LemonTag.o,{className:"uppercase",children:annotation.scope===types.dc.Insight?(0,jsx_runtime.jsx)(src.rU,{to:urls.j.insightView(annotation.insight_short_id),className:"flex items-center",target:"_blank",targetBlankIcon:!0,children:scopeName}):scopeName})})},sorter:(a,b)=>annotationModalLogic.nO[a.scope]-annotationModalLogic.nO[b.scope]},{title:"Created by",dataIndex:"created_by",render:function Render(_,item){let{created_by,creation_type}=item;return(0,jsx_runtime.jsx)("div",{className:"flex flex-row items-center",children:(0,jsx_runtime.jsx)(ProfilePicture.Y,{user:"GIT"===creation_type?{first_name:"GitHub Actions"}:created_by,showName:!0,size:"md",type:"GIT"===creation_type?"bot":"person"})})},sorter:(a,b)=>(a.created_by?.first_name||a.created_by?.email||"").localeCompare(b.created_by?.first_name||b.created_by?.email||"")},(0,columnUtils.rw)(),{key:"actions",width:0,render:function RenderActions(_,annotation){return(0,jsx_runtime.jsx)(LemonButton.J,{icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconPencil,{}),size:"small",to:urls.j.annotation(annotation.id)})}}];return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-row items-center gap-2 justify-between",children:[(0,jsx_runtime.jsx)("div",{children:"Annotations allow you to mark when certain changes happened so you can easily see how they impacted your metrics."}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,jsx_runtime.jsx)("div",{children:"Scope: "}),(0,jsx_runtime.jsx)(src.Yv,{options:annotationScopesMenuOptions(),value:scope,onSelect:setScope})]})]}),(0,jsx_runtime.jsxs)("div",{"data-attr":"annotations-content",children:[(0,jsx_runtime.jsx)("div",{className:"mt-4",children:(0,jsx_runtime.jsx)(ProductIntroduction.C,{productName:"Annotations",productKey:types.Md.ANNOTATIONS,thingName:"annotation",description:"Annotations allow you to mark when certain changes happened so you can easily see how they impacted your metrics.",docsURL:"https://posthog.com/docs/data/annotations",action:()=>openModalToCreateAnnotation(),isEmpty:shouldShowEmptyState,customHog:hedgehogs.MicrophoneHog})}),!shouldShowEmptyState&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(LemonTable.g,{"data-attr":"annotations-table",rowKey:"id",dataSource:filteredAnnotations,columns:columns,defaultSorting:{columnKey:"date_marker",order:-1},noSortingCancellation:!0,loading:annotationsLoading,emptyState:"No annotations yet"}),next&&(0,jsx_runtime.jsx)("div",{className:"flex justify-center mt-6",children:(0,jsx_runtime.jsx)(LemonButton.J,{type:"primary",loading:loadingNext,onClick:()=>{loadAnnotationsNext()},children:"Load more annotations"})})]})]}),(0,jsx_runtime.jsx)(AnnotationModal.h,{})]})}var userLogic=__webpack_require__("../../frontend/src/scenes/userLogic.ts"),dayjs=__webpack_require__("../../frontend/src/lib/dayjs.ts"),kea_loaders_lib=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.6_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),api=__webpack_require__("../../frontend/src/lib/api.ts"),dist_module=__webpack_require__("../../node_modules/.pnpm/posthog-js@1.259.0_@rrweb+types@2.0.0-alpha.17/node_modules/posthog-js/dist/module.js");let SCOPE_OPTIONS=Object.values(types.jc).map(scope=>({value:scope,label:(0,utils.fm)(scope)}));SCOPE_OPTIONS.unshift({value:null,label:"Any"});let openUrls={[types.jc.INSIGHT]:c=>c.item_context?.short_id?urls.j.insightView(c.item_context?.short_id):null,[types.jc.REPLAY]:c=>c.item_id?urls.j.replaySingle(c.item_id):null,[types.jc.RECORDING]:c=>c.item_id?urls.j.replaySingle(c.item_id):null,[types.jc.DASHBOARD]:c=>c.item_id?urls.j.dashboard(c.item_id):null,[types.jc.FEATURE_FLAG]:c=>c.item_id?urls.j.featureFlag(c.item_id):null,[types.jc.EXPERIMENT]:c=>c.item_id?urls.j.experiment(c.item_id):null,[types.jc.COHORT]:c=>c.item_id?urls.j.cohort(c.item_id):null,[types.jc.PERSON]:c=>c.item_id?urls.j.personByUUID(c.item_id):null,[types.jc.ACTION]:c=>c.item_id?urls.j.action(c.item_id):null,[types.jc.EVENT_DEFINITION]:c=>c.item_id?urls.j.eventDefinition(c.item_id):null,[types.jc.PROPERTY_DEFINITION]:c=>c.item_id?urls.j.propertyDefinition(c.item_id):null,[types.jc.NOTEBOOK]:c=>c.item_id?urls.j.notebook(c.item_id):null,[types.jc.SURVEY]:c=>c.item_id?urls.j.survey(c.item_id):null,[types.jc.EARLY_ACCESS_FEATURE]:c=>c.item_id?urls.j.earlyAccessFeature(c.item_id):null,[types.jc.ERROR_TRACKING_ISSUE]:c=>c.item_id?urls.j.errorTrackingIssue(c.item_id):null,[types.jc.USER_INTERVIEW]:c=>c.item_id?urls.j.userInterview(c.item_id):null,[types.jc.GROUP]:c=>c.item_context?.group_type_index&&c.item_id?urls.j.group(c.item_context.group_type_index,c.item_id):null,[types.jc.PLUGIN]:c=>c.item_id?urls.j.legacyPlugin(c.item_id):null,[types.jc.HOG_FUNCTION]:c=>c.item_id?urls.j.hogFunction(c.item_id):null,[types.jc.TEAM]:()=>urls.j.settings("project"),[types.jc.DATA_MANAGEMENT]:()=>urls.j.eventDefinitions(),[types.jc.DATA_WAREHOUSE_SAVED_QUERY]:()=>urls.j.database(),[types.jc.PLUGIN_CONFIG]:()=>null,[types.jc.COMMENT]:()=>null},openURLFor=c=>{let commentURLFn=openUrls[c.scope];if(!commentURLFn)return null;let commentURL=commentURLFn(c);return c.scope===types.jc.RECORDING?commentURL:commentURL?`${commentURL}#panel=discussion`:null},commentsLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","data-management","comments","commentsLogic"]),(0,index_esm.connect)(()=>({values:[teamLogic.teamLogic,["currentTeam"],userLogic.userLogic,["user"]]})),(0,index_esm.actions)({setScope:scope=>({scope}),setFilterCreatedBy:createdBy=>({createdBy}),setSearchText:searchText=>({searchText}),deleteComment:id=>({id}),loadComments:!0}),(0,kea_loaders_lib.loaders)(_ref=>{let{values}=_ref;return{comments:[[],{loadComments:async(_,breakpoint)=>{await breakpoint(100);let params={};values.scope&&(params.scope=values.scope),values.filterCreatedBy&&(params.created_by=values.filterCreatedBy),values.searchText.trim()&&(params.search=values.searchText.trim());let response=await api.ZP.comments.list(params);return breakpoint(),response.results||[]},deleteComment:async(_ref2,breakpoint)=>{let{id}=_ref2;return await breakpoint(25),await api.ZP.comments.delete(id),values.comments.filter(c=>c.id!==id)}}]}}),(0,index_esm.reducers)(()=>({scope:[null,{setScope:(_,_ref3)=>{let{scope}=_ref3;return scope}}],filterCreatedBy:[null,{setFilterCreatedBy:(_,_ref4)=>{let{createdBy}=_ref4;return createdBy}}],searchText:["",{setSearchText:(_,_ref5)=>{let{searchText}=_ref5;return searchText}}]})),(0,index_esm.selectors)(()=>({hasAnySearch:[s=>[s.searchText,s.scope,s.filterCreatedBy],(searchText,scope,filterCreatedBy)=>!!searchText||!!scope||!!filterCreatedBy],shouldShowEmptyState:[s=>[s.comments,s.commentsLoading,s.hasAnySearch],(comments,commentsLoading,hasAnySearch)=>0===comments.length&&!commentsLoading&&!hasAnySearch]})),(0,index_esm.listeners)(_ref6=>{let{actions}=_ref6;return{setScope:actions.loadComments,setFilterCreatedBy:actions.loadComments,setSearchText:actions.loadComments,deleteCommentSuccess:()=>{src.UJ.success("Comment deleted")},deleteCommentFailure:e=>{dist_module.ZP.captureException(e,{action:"data management scene deleting comment"}),src.UJ.error("Could not delete comment, refresh and try again")}}})]);var MemberSelect=__webpack_require__("../../frontend/src/lib/components/MemberSelect.tsx"),icons=__webpack_require__("../../frontend/src/lib/lemon-ui/icons/index.ts");function Comments(){let{user}=(0,index_esm.useValues)(userLogic.userLogic),{comments,shouldShowEmptyState,commentsLoading,scope,filterCreatedBy,searchText}=(0,index_esm.useValues)(commentsLogic),{setScope,setFilterCreatedBy,setSearchText,deleteComment,loadComments}=(0,index_esm.useActions)(commentsLogic);(0,react.useEffect)(()=>{loadComments()},[loadComments]);let columns=[{title:"Comment",key:"content",width:"30%",render:function RenderComment(_,comment){var _comment$content,_comment$content2,_comment$content3;let renderedContent=(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:null!==(_comment$content=comment.content)&&void 0!==_comment$content?_comment$content:""});return(comment.content||"").trim().length>50&&(renderedContent=(0,jsx_runtime.jsx)(Tooltip.u,{title:(0,jsx_runtime.jsx)("div",{className:"whitespace-pre-wrap break-words","data-attr":"comment-scene-comment-title-rendered-content",children:null!==(_comment$content2=comment.content)&&void 0!==_comment$content2?_comment$content2:""}),children:(null!==(_comment$content3=comment.content)&&void 0!==_comment$content3?_comment$content3:"").slice(0,47)+"..."})),(0,jsx_runtime.jsx)("div",{className:"font-semibold",children:renderedContent})}},{title:"Timestamp",dataIndex:"created_at",render:function RenderCreatedAt(_,comment){return(0,jsx_runtime.jsx)(TZLabel.w,{time:(0,dayjs.Bv)(comment.created_at)})},sorter:(a,b)=>(0,dayjs.Bv)(a.created_at).diff((0,dayjs.Bv)(b.created_at))},{title:"Scope",key:"scope",render:function RenderScope(_,comment){return(0,jsx_runtime.jsx)(LemonTag_LemonTag.o,{className:"uppercase",children:comment.scope})}},{title:"Created by",dataIndex:"created_by",render:function RenderCreatedBy(_,comment){return(0,jsx_runtime.jsx)("div",{className:"flex flex-row items-center",children:(0,jsx_runtime.jsx)(ProfilePicture.Y,{user:comment.created_by,showName:!0,size:"md",type:"person"})})},sorter:(a,b)=>(a.created_by?.first_name||a.created_by?.email||"").localeCompare(b.created_by?.first_name||b.created_by?.email||"")},{key:"actions",width:0,render:function RenderActions(_,comment){let canEdit=user?.uuid===comment.created_by?.uuid;return(0,jsx_runtime.jsx)("div",{className:"flex",children:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(src.Jp,{icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconTrash,{}),size:"small",status:"danger",onClick:()=>deleteComment(comment.id),disabledReason:canEdit?void 0:"You can only delete your own comments","data-attr":"comment-management-scene-delete"}),(0,jsx_runtime.jsx)(src.Jp,{icon:(0,jsx_runtime.jsx)(icons.UE,{}),size:"small",to:openURLFor(comment)||"",disabledReason:openURLFor(comment)?void 0:"We are not able to link to this comment type 🙈tell us you want to be able to!","data-attr":"comment-management-scene-open"})]})})}}];return(0,jsx_runtime.jsxs)("div",{"data-attr":"comments-management-scene",children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-row gap-4 justify-between",children:[(0,jsx_runtime.jsx)("div",{className:"flex flex-row items-center gap-2",children:(0,jsx_runtime.jsx)(src.DF,{type:"search",placeholder:"Search comments...",value:searchText,onChange:setSearchText,size:"small"})}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsxs)("div",{className:"flex flex-row items-center gap-4 flex-wrap",children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,jsx_runtime.jsx)("div",{children:"Scope:"}),(0,jsx_runtime.jsx)(src.Yv,{options:SCOPE_OPTIONS,value:scope,onSelect:setScope,size:"small"})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)("span",{children:"Created by:"}),(0,jsx_runtime.jsx)(MemberSelect.a,{value:filterCreatedBy,onChange:user=>{var _user$uuid;setFilterCreatedBy(null!==(_user$uuid=user?.uuid)&&void 0!==_user$uuid?_user$uuid:null)}})]})]})})]}),(0,jsx_runtime.jsxs)("div",{"data-attr":"comments-content",children:[(0,jsx_runtime.jsx)("div",{className:"mt-4",children:(0,jsx_runtime.jsx)(ProductIntroduction.C,{productName:"Comments",productKey:types.Md.COMMENTS,thingName:"comment",description:"Comments allow you to provide context and discussions on various elements in PostHog.",isEmpty:shouldShowEmptyState,customHog:hedgehogs.MicrophoneHog})}),!shouldShowEmptyState&&(0,jsx_runtime.jsx)(LemonTable.g,{"data-attr":"comments-table",rowKey:"id",dataSource:comments,columns:columns,defaultSorting:{columnKey:"created_at",order:-1},noSortingCancellation:!0,loading:commentsLoading,emptyState:"No comments found"})]})]})}var sceneTypes=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),MarketingAnalyticsSettings=__webpack_require__("../../frontend/src/scenes/web-analytics/tabs/marketing-analytics/frontend/components/settings/MarketingAnalyticsSettings.tsx"),ObjectTags=__webpack_require__("../../frontend/src/lib/components/ObjectTags/ObjectTags.tsx"),More=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/More.tsx"),LemonDivider=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonDivider/index.ts"),LemonTableLink=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/LemonTableLink.tsx"),LemonToast=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonToast/LemonToast.tsx"),deleteWithUndo=__webpack_require__("../../frontend/src/lib/utils/deleteWithUndo.tsx"),product_intents=__webpack_require__("../../frontend/src/lib/utils/product-intents.ts"),fuse_esm=__webpack_require__("../../node_modules/.pnpm/fuse.js@6.6.2/node_modules/fuse.js/dist/fuse.esm.js"),kea_subscriptions_lib=__webpack_require__("../../node_modules/.pnpm/kea-subscriptions@3.0.1_kea@3.1.6_react@18.2.0_/node_modules/kea-subscriptions/lib/index.js"),actionsModel=__webpack_require__("../../frontend/src/models/actionsModel.ts");let actionsFuse=new fuse_esm.Z([],{keys:[{name:"name",weight:2},"description","tags"],threshold:.3,ignoreLocation:!0,includeMatches:!0}),actionsLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","actions","actionsLogic"]),(0,index_esm.connect)(()=>({values:[(0,actionsModel.D)({params:"include_count=1"}),["actions","actionsLoading"],userLogic.userLogic,["user"],featureFlagLogic.featureFlagLogic,["featureFlags"]]})),(0,index_esm.actions)({setFilterType:filterType=>({filterType}),setSearchTerm:searchTerm=>({searchTerm})}),(0,index_esm.reducers)({filterType:["all",{persist:!0},{setFilterType:(_,_ref)=>{let{filterType}=_ref;return filterType}}],searchTerm:["",{setSearchTerm:(_,_ref2)=>{let{searchTerm}=_ref2;return searchTerm}}]}),(0,index_esm.selectors)({actionsFiltered:[s=>[s.actions,s.filterType,s.searchTerm,s.user],(actions,filterType,searchTerm,user)=>{let data=actions;return searchTerm&&(data=actionsFuse.search(searchTerm).map(result=>result.item)),"me"===filterType&&(data=data.filter(item=>item.created_by?.uuid===user?.uuid)),data}],breadcrumbs:[()=>[],()=>[{key:sceneTypes.x.DataManagement,name:"Data management",path:urls.j.eventDefinitions()},{key:DataManagementTab.Actions,name:"Actions",path:urls.j.actions()}]],shouldShowEmptyState:[s=>[s.actionsFiltered,s.actionsLoading,s.searchTerm],(actionsFiltered,actionsLoading,searchTerm)=>0==actionsFiltered.length&&!actionsLoading&&!searchTerm.length]}),(0,kea_subscriptions_lib.Vt)({actions:actions=>{actionsFuse.setCollection(actions)}})]);function ActionsTable(){let{currentTeam}=(0,index_esm.useValues)(teamLogic.teamLogic),{actionsLoading}=(0,index_esm.useValues)((0,actionsModel.D)({params:"include_count=1"})),{loadActions,pinAction,unpinAction}=(0,index_esm.useActions)(actionsModel.D),{addProductIntentForCrossSell}=(0,index_esm.useActions)(teamLogic.teamLogic),{filterType,searchTerm,actionsFiltered,shouldShowEmptyState}=(0,index_esm.useValues)(actionsLogic),{setFilterType,setSearchTerm}=(0,index_esm.useActions)(actionsLogic),{hasAvailableFeature}=(0,index_esm.useValues)(userLogic.userLogic),{updateHasSeenProductIntroFor}=(0,index_esm.useActions)(userLogic.userLogic),tryInInsightsUrl=action=>{let query={kind:schema_general.OH.InsightVizNode,source:{kind:schema_general.OH.TrendsQuery,series:[{id:action.id,name:action.name||void 0,kind:schema_general.OH.ActionsNode}],interval:"day",trendsFilter:{display:types.Qb.ActionsLineGraph}}};return urls.j.insightNew({query})},columns=[{width:0,title:"Pinned",dataIndex:"pinned_at",sorter:(a,b)=>(b.pinned_at?new Date(b.pinned_at).getTime():0)-(a.pinned_at?new Date(a.pinned_at).getTime():0),render:function Render(pinned,action){return(0,jsx_runtime.jsx)(LemonButton.J,{size:"small",onClick:pinned?()=>unpinAction(action):()=>pinAction(action),tooltip:pinned?"Unpin action":"Pin action",icon:pinned?(0,jsx_runtime.jsx)(posthog_icons_es.IconPinFilled,{}):(0,jsx_runtime.jsx)(posthog_icons_es.IconPin,{})})}},{title:"Name",dataIndex:"name",width:"25%",sorter:(a,b)=>(a.name||"").localeCompare(b.name||""),render:function RenderName(_,action,index){return(0,jsx_runtime.jsx)(LemonTableLink.i,{"data-attr":"action-link-"+index,to:urls.j.action(action.id),title:action.name||(0,jsx_runtime.jsx)("i",{children:"Unnamed"}),description:action.description})}},{title:"Type",key:"type",render:function RenderType(_,action){return(0,jsx_runtime.jsx)("span",{children:action.steps?.length?action.steps.map((step,index)=>(0,jsx_runtime.jsx)("div",{children:(()=>{let url=(0,utils.VV)(step.url||"");switch(url=url.slice(0,40)+(url.length>40?"...":""),step.event){case"$autocapture":return"Autocapture";case"$pageview":switch(step.url_matching){case"regex":return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Page view URL matches regex ",(0,jsx_runtime.jsx)("strong",{children:url})]});case"exact":return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Page view URL matches exactly ",(0,jsx_runtime.jsx)("strong",{children:url})]});default:return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Page view URL contains ",(0,jsx_runtime.jsx)("strong",{children:url})]})}case"":case null:case void 0:return"Any event";default:return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Event: ",(0,jsx_runtime.jsx)("strong",{children:step.event})]})}})()},index)):(0,jsx_runtime.jsx)("i",{children:"Empty – set this action up"})})}},...hasAvailableFeature(types.P$.TAGGING)?[{title:"Tags",dataIndex:"tags",width:250,key:"tags",render:function renderTags(tags){return(0,jsx_runtime.jsx)(ObjectTags.D,{tags:tags,staticOnly:!0})}}]:[],(0,columnUtils.JB)(),(0,columnUtils.rw)(),...currentTeam?.slack_incoming_webhook?[{title:"Webhook",dataIndex:"post_to_slack",sorter:(a,b)=>Number(a.post_to_slack)-Number(b.post_to_slack),render:function RenderActions(post_to_slack){return post_to_slack?(0,jsx_runtime.jsx)(posthog_icons_es.IconCheckCircle,{}):null}}]:[],{width:0,render:function RenderActions(_,action){return(0,jsx_runtime.jsx)(More.T,{overlay:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(LemonButton.J,{to:urls.j.action(action.id),fullWidth:!0,children:"Edit"}),(0,jsx_runtime.jsx)(LemonButton.J,{to:urls.j.duplicateAction(action),fullWidth:!0,children:"Duplicate"}),(0,jsx_runtime.jsx)(LemonButton.J,{to:urls.j.replay(types.yd.Home,{filter_group:{type:types.J2.And,values:[{type:types.J2.And,values:[{id:action.id,type:"actions",order:0,name:action.name}]}]}}),onClick:()=>{addProductIntentForCrossSell({from:types.Md.ACTIONS,to:types.Md.SESSION_REPLAY,intent_context:product_intents.kp.ACTION_VIEW_RECORDINGS})},sideIcon:(0,jsx_runtime.jsx)(icons.Ud,{}),fullWidth:!0,"data-attr":"action-table-view-recordings",children:"View recordings"}),(0,jsx_runtime.jsx)(LemonButton.J,{to:tryInInsightsUrl(action),fullWidth:!0,children:"Try out in Insights"}),(0,jsx_runtime.jsx)(LemonDivider.p,{}),(0,jsx_runtime.jsx)(LemonButton.J,{status:"danger",onClick:()=>{(0,deleteWithUndo.S)({endpoint:api.ZP.actions.determineDeleteEndpoint(),object:action,callback:loadActions}).catch(e=>{LemonToast.UJ.error(`Error deleting action: ${e.detail}`)})},fullWidth:!0,children:"Delete action"})]})})}}];return(0,jsx_runtime.jsxs)("div",{"data-attr":"manage-events-table",children:[(0,jsx_runtime.jsx)(ProductIntroduction.C,{productName:"Actions",productKey:types.Md.ACTIONS,thingName:"action",isEmpty:shouldShowEmptyState,description:"Use actions to combine events that you want to have tracked together or to make detailed Autocapture events easier to reuse.",docsURL:"https://posthog.com/docs/data/actions",actionElementOverride:(0,jsx_runtime.jsx)(NewActionButton.O,{onSelectOption:()=>updateHasSeenProductIntroFor(types.Md.ACTIONS,!0)})}),shouldShowEmptyState&&"me"===filterType||!shouldShowEmptyState?(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-4",children:[(0,jsx_runtime.jsx)(src.DF,{type:"search",placeholder:"Search for actions",onChange:setSearchTerm,value:searchTerm}),(0,jsx_runtime.jsx)(src.P4,{value:filterType,onChange:setFilterType,options:[{value:"all",label:"All actions"},{value:"me",label:"My actions"}]})]}):null,(!shouldShowEmptyState||"me"===filterType)&&(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(LemonTable.g,{columns:columns,loading:actionsLoading,rowKey:"id",pagination:{pageSize:100},"data-attr":"actions-table",dataSource:actionsFiltered,defaultSorting:{columnKey:"created_by",order:-1},emptyState:"No results. Create a new action?"})})]})}var TaxonomicFilter_types=__webpack_require__("../../frontend/src/lib/components/TaxonomicFilter/types.ts"),LemonBanner=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonBanner/index.ts"),DefinitionHeader=__webpack_require__("../../frontend/src/scenes/data-management/events/DefinitionHeader.tsx"),EventDefinitionProperties=__webpack_require__("../../frontend/src/scenes/data-management/events/EventDefinitionProperties.tsx"),eventDefinitionsTableLogic=__webpack_require__("../../frontend/src/scenes/data-management/events/eventDefinitionsTableLogic.ts");let eventTypeOptions=[{value:types.uW.Event,label:"All events","data-attr":"event-type-option-event"},{value:types.uW.EventCustom,label:"Custom events","data-attr":"event-type-option-event-custom"},{value:types.uW.EventPostHog,label:"PostHog events","data-attr":"event-type-option-event-posthog"}];function EventDefinitionsTable(){var _eventDefinitions$pag,_eventDefinitions$cou;let{eventDefinitions,eventDefinitionsLoading,filters}=(0,index_esm.useValues)(eventDefinitionsTableLogic.qh),{loadEventDefinitions,setFilters}=(0,index_esm.useActions)(eventDefinitionsTableLogic.qh),{hasTagging}=(0,index_esm.useValues)(organizationLogic.organizationLogic),columns=[{key:"icon",width:0,render:function Render(_,definition){return(0,jsx_runtime.jsx)("span",{className:"text-xl text-secondary",children:(0,DefinitionHeader.Kw)(definition)})}},{title:"Name",key:"name",render:function Render(_,definition){return(0,jsx_runtime.jsx)(DefinitionHeader.JH,{definition:definition,to:urls.j.eventDefinition(definition.id),taxonomicGroupType:TaxonomicFilter_types.t.Events})},sorter:!0},{title:"Last seen",key:"last_seen_at",className:"definition-column-last_seen_at",render:function Render(_,definition){return definition.last_seen_at?(0,jsx_runtime.jsx)(TZLabel.w,{time:definition.last_seen_at}):null},sorter:!0},...hasTagging?[{title:"Tags",key:"tags",render:function Render(_,definition){var _definition$tags;return(0,jsx_runtime.jsx)(ObjectTags.D,{tags:null!==(_definition$tags=definition.tags)&&void 0!==_definition$tags?_definition$tags:[],staticOnly:!0})}}]:[],{key:"actions",width:0,render:function RenderActions(_,definition){return(0,jsx_runtime.jsx)(More.T,{"data-attr":`event-definitions-table-more-button-${definition.name}`,overlay:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(src.Jp,{to:urls.j.replay(types.yd.Home,{filter_group:{type:types.J2.And,values:[{type:types.J2.And,values:[{id:definition.name,type:"events",order:0,name:definition.name}]}]}}),fullWidth:!0,sideIcon:(0,jsx_runtime.jsx)(icons.Ud,{}),"data-attr":"event-definitions-table-view-recordings",children:"View recordings"})})})}}];return(0,jsx_runtime.jsxs)("div",{"data-attr":"manage-events-table",children:[(0,jsx_runtime.jsxs)(LemonBanner.V,{className:"mb-4",type:"info",children:["Looking for"," ","event_custom"===filters.event_type?"custom ":"event_posthog"===filters.event_type?"PostHog ":"","event usage statistics?"," ",(0,jsx_runtime.jsx)(src.rU,{to:urls.j.insightNewHogQL({query:"SELECT event, count()\nFROM events\nWHERE {filters}\n"+("event_custom"===filters.event_type?"AND event NOT LIKE '$%'\n":"event_posthog"===filters.event_type?"AND event LIKE '$%'\n":"")+"GROUP BY event\nORDER BY count() DESC",filters:{dateRange:{date_from:"-24h"}}}),children:"Query with SQL"})]}),(0,jsx_runtime.jsxs)("div",{className:"flex justify-between items-center gap-2 mb-4",children:[(0,jsx_runtime.jsx)(src.DF,{type:"search",placeholder:"Search for events",onChange:v=>setFilters({event:v||""}),value:filters.event}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)("span",{children:"Type:"}),(0,jsx_runtime.jsx)(src.Yv,{value:filters.event_type,options:eventTypeOptions,"data-attr":"event-type-filter",dropdownMatchSelectWidth:!1,onChange:value=>{setFilters({event_type:value})},size:"small"})]})]}),(0,jsx_runtime.jsx)(LemonTable.g,{columns:columns,"data-attr":"events-definition-table",loading:eventDefinitionsLoading,rowKey:"id",pagination:{controlled:!0,currentPage:null!==(_eventDefinitions$pag=eventDefinitions?.page)&&void 0!==_eventDefinitions$pag?_eventDefinitions$pag:1,entryCount:null!==(_eventDefinitions$cou=eventDefinitions?.count)&&void 0!==_eventDefinitions$cou?_eventDefinitions$cou:0,pageSize:constants.H$,onForward:eventDefinitions.next?()=>{loadEventDefinitions(eventDefinitions.next)}:void 0,onBackward:eventDefinitions.previous?()=>{loadEventDefinitions(eventDefinitions.previous)}:void 0},onSort:newSorting=>setFilters({ordering:newSorting?`${-1===newSorting.order?"-":""}${newSorting.columnKey}`:void 0}),expandable:{expandedRowRender:function RenderPropertiesTable(definition){return(0,jsx_runtime.jsx)("div",{className:"p-4",children:(0,jsx_runtime.jsx)(EventDefinitionProperties.Q,{definition:definition})})},rowExpandable:()=>!0,noIndent:!0},dataSource:eventDefinitions.results,useURLForSorting:!1,emptyState:"No event definitions",nouns:["event","events"]})]})}var Sparkline=__webpack_require__("../../frontend/src/lib/components/Sparkline.tsx"),ViewRecordingButton=__webpack_require__("../../frontend/src/lib/components/ViewRecordingButton/ViewRecordingButton.tsx"),Link=__webpack_require__("../../frontend/src/lib/lemon-ui/Link/index.ts"),projectLogic=__webpack_require__("../../frontend/src/scenes/projectLogic.ts");let ingestionWarningsLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","data-management","ingestion-warnings","ingestionWarningsLogic"]),(0,index_esm.connect)(()=>({values:[teamLogic.teamLogic,["timezone"],projectLogic.K,["currentProjectId"]]})),(0,index_esm.actions)({setSearchQuery:search=>({search})}),(0,index_esm.reducers)({searchQuery:["",{setSearchQuery:(_,_ref)=>{let{search}=_ref;return search}}]}),(0,kea_loaders_lib.loaders)(_ref2=>{let{values}=_ref2;return{data:[[],{loadData:async()=>{let q=values.searchQuery?`?q=${values.searchQuery}`:"",{results}=await api.ZP.get(`api/projects/${values.currentProjectId}/ingestion_warnings${q}`);return results}}]}}),(0,index_esm.selectors)({breadcrumbs:[()=>[],()=>[{key:sceneTypes.x.DataManagement,name:"Data management",path:urls.j.eventDefinitions()},{key:DataManagementTab.IngestionWarnings,name:"Ingestion warnings",path:urls.j.ingestionWarnings()}]],dates:[()=>[],()=>(0,utils.w6)(0,30).map(i=>(0,dayjs.Bv)().subtract(i,"days").format("D MMM YYYY")).reverse()],summaryDatasets:[s=>[s.data,s.timezone],(data,timezone)=>{let summaryDatasets={};return data.forEach(summary=>{let result=Array(30).fill(0);for(let spark of summary.sparkline){let date=(0,dayjs.fp)(spark[1],timezone);result[(0,dayjs.Bv)().diff(date,"days")]=spark[0]}summaryDatasets[summary.type]=result.reverse()}),summaryDatasets}],showProductIntro:[s=>[s.data,s.dataLoading,s.searchQuery],(data,dataLoading,searchQuery)=>0===data.length&&!dataLoading&&!searchQuery.trim().length]}),(0,index_esm.listeners)(_ref3=>{let{actions}=_ref3;return{setSearchQuery:async(_,breakpoint)=>{await breakpoint(100),actions.loadData()}}}),(0,index_esm.afterMount)(_ref4=>{let{actions}=_ref4;actions.loadData()})]),WARNING_TYPE_TO_DESCRIPTION={cannot_merge_already_identified:"Refused to merge an already identified user",cannot_merge_with_illegal_distinct_id:"Refused to merge with an illegal distinct id",skipping_event_invalid_uuid:"Refused to process event with invalid uuid",ignored_invalid_timestamp:"Ignored an invalid timestamp, event was still ingested",event_timestamp_in_future:"An event was sent more than 23 hours in the future",ingestion_capacity_overflow:"Event ingestion has overflowed capacity",message_size_too_large:"Discarded event exceeding 1MB limit",replay_timestamp_invalid:"Replay event timestamp is invalid",replay_timestamp_too_far:"Replay event timestamp was too far in the future",replay_message_too_large:"Replay data was dropped because it was too large to ingest",set_on_exception:"$set or $set_once is ignored on exception events and should not be sent"},WARNING_TYPE_RENDERER={cannot_merge_already_identified:function Render(warning){let details=warning.details;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Refused to merge already identified person"," ",(0,jsx_runtime.jsx)(Link.r,{to:urls.j.personByDistinctId(details.sourcePersonDistinctId),children:details.sourcePersonDistinctId})," ","into"," ",(0,jsx_runtime.jsx)(Link.r,{to:urls.j.personByDistinctId(details.targetPersonDistinctId),children:details.targetPersonDistinctId})," ","via an $identify or $create_alias call (event uuid: ",(0,jsx_runtime.jsx)("code",{children:details.eventUuid}),")."]})},cannot_merge_with_illegal_distinct_id:function Render(warning){let details=warning.details;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Refused to merge an illegal distinct_id"," ",(0,jsx_runtime.jsx)(Link.r,{to:urls.j.personByDistinctId(details.illegalDistinctId),children:details.illegalDistinctId})," with"," ",(0,jsx_runtime.jsx)(Link.r,{to:urls.j.personByDistinctId(details.otherDistinctId),children:details.otherDistinctId})," via an $identify or $create_alias call (event uuid: ",(0,jsx_runtime.jsx)("code",{children:details.eventUuid}),")."]})},skipping_event_invalid_uuid:function Render(warning){let details=warning.details;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Refused to process event with invalid uuid: ",(0,jsx_runtime.jsx)("code",{children:details.eventUuid}),"."]})},ignored_invalid_timestamp:function Render(warning){let details=warning.details;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Used server timestamp when ingesting event due to invalid input:",(0,jsx_runtime.jsxs)("ul",{children:[details.eventUuid?(0,jsx_runtime.jsxs)("li",{children:["Event UUID: ",details.eventUuid]}):"",details.field?(0,jsx_runtime.jsxs)("li",{children:["Invalid field: ",details.field]}):"",details.value?(0,jsx_runtime.jsxs)("li",{children:["Invalid value: ",details.value]}):"",details.reason?(0,jsx_runtime.jsxs)("li",{children:["Error: ",details.reason]}):""]})]})},event_timestamp_in_future:function Render(warning){let details=warning.details;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["The event timestamp computed too far in the future, so the capture time was used instead. Event values:",(0,jsx_runtime.jsxs)("ul",{children:[(0,jsx_runtime.jsxs)("li",{children:["Computed timestamp: ",details.result]}),details.eventUuid?(0,jsx_runtime.jsxs)("li",{children:["Event UUID: ",details.eventUuid]}):"",details.timestamp?(0,jsx_runtime.jsxs)("li",{children:["Client provided timestamp: ",details.timestamp]}):"",details.sentAt?(0,jsx_runtime.jsxs)("li",{children:["Client provided sent_at: ",details.sentAt]}):"",details.offset?(0,jsx_runtime.jsxs)("li",{children:["Client provided time offset: ",details.offset]}):"",(0,jsx_runtime.jsxs)("li",{children:["PostHog server capture time: ",details.now]})]})]})},ingestion_capacity_overflow:function Render(warning){let details=warning.details;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Event ingestion has overflowed capacity for distinct_id"," ",(0,jsx_runtime.jsx)(Link.r,{to:urls.j.personByDistinctId(details.overflowDistinctId),children:details.overflowDistinctId}),". Events will still be processed, but are likely to be delayed longer than usual."]})},message_size_too_large:function Render(warning){let details=warning.details;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Discarded event for distinct_id"," ",(0,jsx_runtime.jsx)(Link.r,{to:urls.j.personByDistinctId(details.distinctId),children:details.distinctId})," that exceeded 1MB in size after processing (event uuid: ",(0,jsx_runtime.jsx)("code",{children:details.eventUuid}),")"]})},replay_timestamp_invalid:function Render(warning){let details={timestamp:warning.details.timestamp,session_id:warning.details.replayRecord.session_id};return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Session replay data dropped due to invalid timestamp:",(0,jsx_runtime.jsxs)("ul",{children:[(0,jsx_runtime.jsxs)("li",{children:["invalid timestamp: ",details.timestamp]}),(0,jsx_runtime.jsxs)("li",{children:["session_id: ",details.session_id]})]}),(0,jsx_runtime.jsx)("div",{className:"max-w-30 mt-2",children:(0,jsx_runtime.jsx)(ViewRecordingButton.Z,{sessionId:details.session_id,timestamp:details.timestamp,type:"primary",size:"xsmall","data-attr":"skewed-timestamp-view-recording"})})]})},replay_timestamp_too_far:function Render(warning){let details={timestamp:warning.details.timestamp,session_id:warning.details.replayRecord.session_id,daysFromNow:warning.details.daysFromNow};return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["The session replay data timestamp was too different from the capture time, so the data was dropped. Event values:",(0,jsx_runtime.jsxs)("ul",{children:[(0,jsx_runtime.jsxs)("li",{children:["invalid timestamp: ",details.timestamp]}),(0,jsx_runtime.jsxs)("li",{children:["session_id: ",details.session_id]}),(0,jsx_runtime.jsxs)("li",{children:["skew: ",details.daysFromNow," days"]})]}),(0,jsx_runtime.jsx)("div",{className:"max-w-30 mt-2",children:(0,jsx_runtime.jsx)(ViewRecordingButton.Z,{sessionId:details.session_id,timestamp:details.timestamp,type:"primary",size:"xsmall","data-attr":"skewed-timestamp-view-recording"})})]})},replay_message_too_large:function Render(warning){let details={timestamp:warning.details.timestamp,session_id:warning.details.replayRecord.session_id};return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Session replay data dropped due to its size, this can cause playback problems:",(0,jsx_runtime.jsx)("ul",{children:(0,jsx_runtime.jsxs)("li",{children:["session_id: ",details.session_id]})}),(0,jsx_runtime.jsx)("div",{className:"max-w-30 mt-2",children:(0,jsx_runtime.jsx)(ViewRecordingButton.Z,{sessionId:details.session_id,timestamp:details.timestamp,type:"primary",size:"xsmall","data-attr":"message-too-large-view-recording"})})]})},set_on_exception:function Render(warning){let details={event_uuid:warning.details.event_uuid};return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[" ","Exception ",details.event_uuid," contained $set or $set_once properties, which are ignored on exception events"]})}};function IngestionWarningsView(){let{data,dataLoading,summaryDatasets,dates,searchQuery,showProductIntro}=(0,index_esm.useValues)(ingestionWarningsLogic),{setSearchQuery}=(0,index_esm.useActions)(ingestionWarningsLogic);return(0,jsx_runtime.jsxs)("div",{"data-attr":"manage-events-table",children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-col deprecated-space-y-2",children:[(0,jsx_runtime.jsx)("div",{children:"Data ingestion related warnings from past 30 days."}),(0,jsx_runtime.jsx)(src.DF,{fullWidth:!0,value:searchQuery,onChange:setSearchQuery,type:"search",placeholder:"Try pasting a person or session id or an ingestion warning type"}),(0,jsx_runtime.jsx)(LemonTable.g,{dataSource:data,loading:dataLoading,columns:[{title:"Warning",dataIndex:"type",render:function Render(_,summary){let type=WARNING_TYPE_TO_DESCRIPTION[summary.type]||summary.type;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[type," (",(0,jsx_runtime.jsx)(Link.r,{to:`https://posthog.com/docs/data#${type.toLowerCase().replace(",","").split(" ").join("-")}`,children:"docs)"})]})}},{title:"Graph",render:function Render(_,summary){return(0,jsx_runtime.jsx)(Sparkline.b,{className:"h-8",labels:dates,data:summaryDatasets[summary.type]})}},{title:"Events",dataIndex:"count",align:"right",sorter:(a,b)=>a.count-b.count},{title:"Last Seen",dataIndex:"lastSeen",render:function Render(_,summary){return(0,jsx_runtime.jsx)(TZLabel.w,{time:summary.lastSeen,showSeconds:!0})},align:"right",sorter:(a,b)=>new Date(a.lastSeen)>new Date(b.lastSeen)?1:-1}],expandable:{expandedRowRender:RenderNestedWarnings},defaultSorting:{columnKey:"lastSeen",order:-1},noSortingCancellation:!0})]}),showProductIntro&&(0,jsx_runtime.jsx)(ProductIntroduction.C,{productName:"Ingestion warnings",thingName:"ingestion warning",productKey:types.Md.INGESTION_WARNINGS,isEmpty:!0,description:"Nice! You've had no ingestion warnings in the past 30 days. If we detect any issues with your data, we'll show them here.",docsURL:"https://posthog.com/docs/data/data-management#ingestion-warnings",customHog:hedgehogs.ReadingHog})]})}function RenderNestedWarnings(warningSummary){return(0,jsx_runtime.jsx)(LemonTable.g,{dataSource:warningSummary.warnings,columns:[{title:"Description",key:"description",render:function Render(_,warning){let renderer=WARNING_TYPE_RENDERER[warning.type];return renderer?renderer(warning):(0,jsx_runtime.jsx)("pre",{children:JSON.stringify(warning.details,null,2)})}},{title:"Time",dataIndex:"timestamp",render:function Render(_,warning){return(0,jsx_runtime.jsx)(TZLabel.w,{time:warning.timestamp,showSeconds:!0})},align:"right"}],embedded:!0,showHeader:!1,pagination:{pageSize:20}})}var injectStylesIntoStyleTag=__webpack_require__("../../node_modules/.pnpm/style-loader@2.0.0_webpack@5.88.2/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),PropertyDefinitionsTable=__webpack_require__("../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!../../node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.5.6_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!../../node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!../../frontend/src/scenes/data-management/properties/PropertyDefinitionsTable.scss"),PropertyDefinitionsTable_default=__webpack_require__.n(PropertyDefinitionsTable),options={};options.insert="head",options.singleton=!1,injectStylesIntoStyleTag_default()(PropertyDefinitionsTable_default(),options),PropertyDefinitionsTable_default().locals;var propertyDefinitionsTableLogic=__webpack_require__("../../frontend/src/scenes/data-management/properties/propertyDefinitionsTableLogic.ts");function PropertyDefinitionsTable_PropertyDefinitionsTable(){var _filters$group_type_i,_propertyDefinitions$,_propertyDefinitions$2;let{propertyDefinitions,propertyDefinitionsLoading,filters,propertyTypeOptions}=(0,index_esm.useValues)(propertyDefinitionsTableLogic.T),{loadPropertyDefinitions,setFilters,setPropertyType}=(0,index_esm.useActions)(propertyDefinitionsTableLogic.T),{hasTagging}=(0,index_esm.useValues)(organizationLogic.organizationLogic),columns=[{key:"icon",width:0,render:function Render(_,definition){return(0,jsx_runtime.jsx)("span",{className:"text-xl text-secondary",children:(0,DefinitionHeader.Jf)(definition)})}},{title:"Name",key:"name",render:function Render(_,definition){return(0,jsx_runtime.jsx)(DefinitionHeader.JH,{definition:definition,to:urls.j.propertyDefinition(definition.id),taxonomicGroupType:TaxonomicFilter_types.t.EventProperties})},sorter:(a,b)=>a.name.localeCompare(b.name)},{title:"Type",key:"type",render:function RenderType(_,definition){return definition.property_type?(0,jsx_runtime.jsx)(src.oe,{type:"success",className:"uppercase",children:definition.property_type}):(0,jsx_runtime.jsx)("span",{className:"text-secondary",children:"—"})}},...hasTagging?[{title:"Tags",key:"tags",render:function Render(_,definition){var _definition$tags;return(0,jsx_runtime.jsx)(ObjectTags.D,{tags:null!==(_definition$tags=definition.tags)&&void 0!==_definition$tags?_definition$tags:[],staticOnly:!0})}}]:[]];return(0,jsx_runtime.jsxs)("div",{"data-attr":"manage-events-table",children:[(0,jsx_runtime.jsxs)(LemonBanner.V,{className:"mb-4",type:"info",children:["Looking for ","person"===filters.type?"person ":"","property usage statistics?"," ",(0,jsx_runtime.jsx)(src.rU,{to:urls.j.insightNewHogQL({query:"SELECT arrayJoin(JSONExtractKeys(properties)) AS property_key, count()\n"+("person"===filters.type?"FROM persons\n":"FROM events\n")+("person"===filters.type?"":"WHERE {filters}\n")+"GROUP BY property_key\nORDER BY count() DESC",filters:{dateRange:{date_from:"-24h"}}}),children:"Query with SQL"})]}),(0,jsx_runtime.jsxs)("div",{className:"flex mb-4 gap-2 flex-wrap",children:[(0,jsx_runtime.jsx)(src.DF,{type:"search",placeholder:"Search for properties",onChange:e=>setFilters({property:e||""}),value:filters.property}),(0,jsx_runtime.jsx)(src.Yv,{options:propertyTypeOptions,value:`${filters.type}::${null!==(_filters$group_type_i=filters.group_type_index)&&void 0!==_filters$group_type_i?_filters$group_type_i:""}`,onSelect:setPropertyType})]}),(0,jsx_runtime.jsx)(LemonTable.g,{columns:columns,className:"event-properties-definition-table","data-attr":"event-properties-definition-table",loading:propertyDefinitionsLoading,rowKey:"id",pagination:{controlled:!0,currentPage:null!==(_propertyDefinitions$=propertyDefinitions?.page)&&void 0!==_propertyDefinitions$?_propertyDefinitions$:1,entryCount:null!==(_propertyDefinitions$2=propertyDefinitions?.count)&&void 0!==_propertyDefinitions$2?_propertyDefinitions$2:0,pageSize:constants.ld,onForward:propertyDefinitions.next?()=>{loadPropertyDefinitions(propertyDefinitions.next)}:void 0,onBackward:propertyDefinitions.previous?()=>{loadPropertyDefinitions(propertyDefinitions.previous)}:void 0},dataSource:propertyDefinitions.results,emptyState:"No property definitions",nouns:["property","properties"]})]})}let DataManagementTab=function(DataManagementTab){return DataManagementTab.Actions="actions",DataManagementTab.EventDefinitions="events",DataManagementTab.PropertyDefinitions="properties",DataManagementTab.Annotations="annotations",DataManagementTab.Comments="comments",DataManagementTab.History="history",DataManagementTab.IngestionWarnings="warnings",DataManagementTab.Revenue="revenue",DataManagementTab.MarketingAnalytics="marketing-analytics",DataManagementTab}({}),tabs={[DataManagementTab.EventDefinitions]:{url:urls.j.eventDefinitions(),label:"Events",content:(0,jsx_runtime.jsx)(EventDefinitionsTable,{}),tooltipDocLink:"https://posthog.com/docs/data/events"},[DataManagementTab.Actions]:{url:urls.j.actions(),label:(0,jsx_runtime.jsx)(TitleWithIcon.H,{icon:(0,jsx_runtime.jsx)(Tooltip.u,{title:"Actions consist of one or more events that you have decided to put into a deliberately-labeled bucket. They're used in insights and dashboards.",children:(0,jsx_runtime.jsx)(posthog_icons_es.IconInfo,{})}),children:"Actions"}),buttons:(0,jsx_runtime.jsx)(NewActionButton.O,{}),content:(0,jsx_runtime.jsx)(ActionsTable,{}),tooltipDocLink:"https://posthog.com/docs/data/actions"},[DataManagementTab.PropertyDefinitions]:{url:urls.j.propertyDefinitions(),label:(0,jsx_runtime.jsx)(TitleWithIcon.H,{icon:(0,jsx_runtime.jsx)(Tooltip.u,{title:"Properties are additional data sent along with an event capture. Use properties to understand additional information about events and the actors that generate them.",children:(0,jsx_runtime.jsx)(posthog_icons_es.IconInfo,{})}),children:"Properties"}),content:(0,jsx_runtime.jsx)(PropertyDefinitionsTable_PropertyDefinitionsTable,{}),tooltipDocLink:"https://posthog.com/docs/new-to-posthog/understand-posthog#properties"},[DataManagementTab.Annotations]:{url:urls.j.annotations(),content:(0,jsx_runtime.jsx)(Annotations,{}),label:"Annotations",buttons:(0,jsx_runtime.jsx)(AnnotationModal.i,{}),tooltipDocLink:"https://posthog.com/docs/data/annotations"},[DataManagementTab.Comments]:{url:urls.j.comments(),content:(0,jsx_runtime.jsx)(Comments,{}),label:"Comments",buttons:void 0,tooltipDocLink:"https://posthog.com/docs/data/comments"},[DataManagementTab.History]:{url:urls.j.dataManagementHistory(),label:"History",content:(0,jsx_runtime.jsx)(ActivityLog.DA,{scope:types.jc.DATA_MANAGEMENT,caption:"Only actions taken in the UI are captured in History. Automatic creation of definitions by ingestion is not shown here."}),tooltipDocLink:"https://posthog.com/docs/data#history"},[DataManagementTab.Revenue]:{url:urls.j.revenueSettings(),label:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Revenue"," ",(0,jsx_runtime.jsx)(LemonTag.o,{type:"warning",size:"small",className:"ml-2",children:"BETA"})]}),content:(0,jsx_runtime.jsx)(RevenueAnalyticsSettings,{})},[DataManagementTab.IngestionWarnings]:{url:urls.j.ingestionWarnings(),label:"Ingestion warnings",content:(0,jsx_runtime.jsx)(IngestionWarningsView,{}),flag:constants.y8.INGESTION_WARNINGS_ENABLED,tooltipDocLink:"https://posthog.com/docs/data/ingestion-warnings"},[DataManagementTab.MarketingAnalytics]:{url:urls.j.marketingAnalytics(),label:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Marketing"," ",(0,jsx_runtime.jsx)(LemonTag.o,{type:"warning",size:"small",className:"ml-2",children:"BETA"})]}),content:(0,jsx_runtime.jsx)(MarketingAnalyticsSettings.U,{}),flag:constants.y8.WEB_ANALYTICS_MARKETING}},dataManagementSceneLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","events","dataManagementSceneLogic"]),(0,index_esm.connect)(()=>({values:[featureFlagLogic.featureFlagLogic,["featureFlags"]]})),(0,index_esm.actions)({setTab:tab=>({tab})}),(0,index_esm.reducers)({tab:[DataManagementTab.EventDefinitions,{setTab:(_,_ref)=>{let{tab}=_ref;return tab}}]}),(0,index_esm.selectors)({breadcrumbs:[s=>[s.tab],tab=>[{key:sceneTypes.x.DataManagement,name:"Data management",path:tabs.events.url},{key:tab,name:(0,utils.fm)(tab),path:tabs[tab].url}]],enabledTabs:[s=>[s.featureFlags],featureFlags=>Object.entries(tabs).filter(_ref2=>{let[_,tab]=_ref2;return!tab.flag||!!featureFlags[tab.flag]}).map(_ref3=>{let[tabName,_]=_ref3;return tabName})]}),(0,lib.actionToUrl)(()=>({setTab:_ref4=>{let{tab}=_ref4,tabUrl=tabs[tab]?.url||tabs.events.url;if((0,lib.combineUrl)(tabUrl).pathname!==lib.router.values.location.pathname)return[tabUrl,lib.router.values.searchParams,lib.router.values.hashParams]}})),(0,lib.urlToAction)(_ref5=>{let{actions,values}=_ref5;return Object.fromEntries(Object.entries(tabs).map(_ref6=>{let[key,tab]=_ref6;return[tab.url,()=>{values.tab!==key&&actions.setTab(key)}]}))})]);function DataManagementScene(){let{enabledTabs,tab}=(0,index_esm.useValues)(dataManagementSceneLogic);return enabledTabs.includes(tab)?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(PageHeader.m,{buttons:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:tabs[tab].buttons})}),tabs[tab].content]}):null}let scene={component:DataManagementScene,logic:dataManagementSceneLogic}},"../../frontend/src/scenes/data-management/events/EventDefinitionProperties.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Q:()=>EventDefinitionProperties});var _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),kea__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.6_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib_components_ObjectTags_ObjectTags__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/components/ObjectTags/ObjectTags.tsx"),lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/components/TaxonomicFilter/types.ts"),lib_constants__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/constants.tsx"),lib_lemon_ui_LemonTable__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/index.ts"),scenes_data_management_events_eventDefinitionsTableLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/scenes/data-management/events/eventDefinitionsTableLogic.ts"),scenes_organizationLogic__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/scenes/organizationLogic.tsx"),scenes_urls__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../frontend/src/scenes/urls.ts"),_DefinitionHeader__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../frontend/src/scenes/data-management/events/DefinitionHeader.tsx"),lib_hooks_useOnMountEffect__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../frontend/src/lib/hooks/useOnMountEffect.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function EventDefinitionProperties(_ref){var _eventPropertiesCache,_eventPropertiesCache2,_eventPropertiesCache3;let{definition}=_ref,{loadPropertiesForEvent}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useActions)(scenes_data_management_events_eventDefinitionsTableLogic__WEBPACK_IMPORTED_MODULE_6__.qh),{eventPropertiesCacheMap,eventDefinitionPropertiesLoading}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useValues)(scenes_data_management_events_eventDefinitionsTableLogic__WEBPACK_IMPORTED_MODULE_6__.qh),{hasTagging}=(0,kea__WEBPACK_IMPORTED_MODULE_1__.useValues)(scenes_organizationLogic__WEBPACK_IMPORTED_MODULE_7__.organizationLogic);(0,lib_hooks_useOnMountEffect__WEBPACK_IMPORTED_MODULE_10__.x)(()=>loadPropertiesForEvent(definition));let columns=[{title:"Property",key:"property",render:function Render(_,_definition){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_DefinitionHeader__WEBPACK_IMPORTED_MODULE_9__.JH,{definition:_definition,to:scenes_urls__WEBPACK_IMPORTED_MODULE_8__.j.propertyDefinition(_definition.id),taxonomicGroupType:lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_3__.t.EventProperties})}},{title:"Type",key:"type",render:function Render(_,_definition){var _definition$property_;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.oe,{type:"muted",children:null!==(_definition$property_=_definition.property_type)&&void 0!==_definition$property_?_definition$property_:"-"})}},...hasTagging?[{title:"Tags",key:"tags",render:function Render(_,_definition){var _definition$tags;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(lib_components_ObjectTags_ObjectTags__WEBPACK_IMPORTED_MODULE_2__.D,{tags:null!==(_definition$tags=_definition.tags)&&void 0!==_definition$tags?_definition$tags:[],staticOnly:!0})}}]:[],{title:"Example",key:"example",align:"right",render:function Render(_,_definition){var _definition$example;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.oe,{className:"font-mono",type:"muted",children:null!==(_definition$example=_definition.example)&&void 0!==_definition$example?_definition$example:"-"})}}];return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)("h3",{children:"Top properties"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)("p",{children:"Please note that description and tags are shared across events. PostHog properties are excluded from this list."}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(lib_lemon_ui_LemonTable__WEBPACK_IMPORTED_MODULE_5__.g,{id:`event-properties-definition-table-${definition.id}`,"data-attr":"event-properties-definition-nested-table",columns:columns,dataSource:null!==(_eventPropertiesCache=eventPropertiesCacheMap?.[definition.id]?.results)&&void 0!==_eventPropertiesCache?_eventPropertiesCache:[],emptyState:"This event has no properties",nouns:["property definition","property definitions"],pagination:{controlled:!0,pageSize:lib_constants__WEBPACK_IMPORTED_MODULE_4__.N6,currentPage:null!==(_eventPropertiesCache2=eventPropertiesCacheMap?.[definition.id]?.page)&&void 0!==_eventPropertiesCache2?_eventPropertiesCache2:1,entryCount:null!==(_eventPropertiesCache3=eventPropertiesCacheMap?.[definition.id]?.count)&&void 0!==_eventPropertiesCache3?_eventPropertiesCache3:0,onForward:eventPropertiesCacheMap?.[definition.id]?.next?()=>{loadPropertiesForEvent(definition,eventPropertiesCacheMap[definition.id].next)}:void 0,onBackward:eventPropertiesCacheMap?.[definition.id]?.previous?()=>{loadPropertiesForEvent(definition,eventPropertiesCacheMap[definition.id].previous)}:void 0},loading:eventDefinitionPropertiesLoading.includes(definition.id)})]})}},"../../frontend/src/scenes/data-management/events/eventDefinitionsTableLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{oq:()=>normalizePropertyDefinitionEndpointUrl,qh:()=>eventDefinitionsTableLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.6_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.6_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),kea_router__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.6_react@18.2.0_/node_modules/kea-router/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/api.ts"),lib_components_PropertyFilters_utils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/components/PropertyFilters/utils.ts"),lib_constants__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/lib/constants.tsx"),lib_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/lib/utils.tsx"),lib_utils_eventUsageLogic__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/lib/utils/eventUsageLogic.ts"),_types__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../frontend/src/types.ts");function cleanFilters(filter){return{event:"",properties:[],event_type:_types__WEBPACK_IMPORTED_MODULE_8__.uW.Event,ordering:"event",...filter}}function normalizePropertyDefinitionEndpointUrl(url){let searchParams=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},full=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return full||url?lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.propertyDefinitions.determineListEndpoint({...url?(0,kea_router__WEBPACK_IMPORTED_MODULE_2__.combineUrl)(url).searchParams:{},...searchParams}):null}function normalizeEventDefinitionEndpointUrl(_ref){let{url,searchParams={},full=!1,eventTypeFilter=_types__WEBPACK_IMPORTED_MODULE_8__.uW.Event}=_ref;if(!full&&!url)return null;let params={...url?{...(0,kea_router__WEBPACK_IMPORTED_MODULE_2__.combineUrl)(url).searchParams,event_type:eventTypeFilter}:{},...searchParams};return lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.eventDefinitions.determineListEndpoint(params)}let eventDefinitionsTableLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(key=>["scenes","data-management","events","eventDefinitionsTableLogic",key]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.key)(props=>props.key||"scene"),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({loadEventDefinitions:function(){let url=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{url}},loadEventExample:definition=>({definition}),loadPropertiesForEvent:function(definition){let url=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{definition,url}},setFilters:filters=>({filters}),setLocalEventDefinition:definition=>({definition}),setLocalPropertyDefinition:(event,definition)=>({event,definition}),setEventDefinitionPropertiesLoading:ids=>({ids})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({filters:[cleanFilters({}),{setFilters:(state,_ref2)=>{var _convertPropertyGroup;let{filters}=_ref2;return{...state,...filters,properties:null!==(_convertPropertyGroup=(0,lib_components_PropertyFilters_utils__WEBPACK_IMPORTED_MODULE_4__.Y4)(filters.properties))&&void 0!==_convertPropertyGroup?_convertPropertyGroup:[]}}}],eventDefinitionPropertiesLoading:[[],{setEventDefinitionPropertiesLoading:(_,_ref3)=>{let{ids}=_ref3;return null!=ids?ids:[]}}]}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)(_ref4=>{let{values,cache,actions}=_ref4;return{eventDefinitions:[{count:0,next:void 0,current:void 0,previous:void 0,results:[]},{loadEventDefinitions:async(_ref5,breakpoint)=>{var _cache$apiCache,_combineUrl$searchPar;let{url:_url}=_ref5,url=normalizeEventDefinitionEndpointUrl({url:_url,eventTypeFilter:values.filters.event_type});if(url&&url in(null!==(_cache$apiCache=cache.apiCache)&&void 0!==_cache$apiCache?_cache$apiCache:{}))return cache.apiCache[url];url||(url=lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.eventDefinitions.determineListEndpoint({event_type:values.filters.event_type})),await breakpoint(200),cache.eventsStartTime=performance.now();let response=await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.get(url);return breakpoint(),cache.apiCache={...cache.apiCache,[url]:{...response,previous:normalizeEventDefinitionEndpointUrl({url:response.previous,eventTypeFilter:values.filters.event_type}),next:normalizeEventDefinitionEndpointUrl({url:response.next,eventTypeFilter:values.filters.event_type}),current:url,page:Math.floor((null!==(_combineUrl$searchPar=(0,kea_router__WEBPACK_IMPORTED_MODULE_2__.combineUrl)(url).searchParams.offset)&&void 0!==_combineUrl$searchPar?_combineUrl$searchPar:0)/lib_constants__WEBPACK_IMPORTED_MODULE_5__.H$)+1}},cache.apiCache[url]},setLocalEventDefinition:_ref6=>{let{definition}=_ref6;return values.eventDefinitions.current?(cache.apiCache={...cache.apiCache,[values.eventDefinitions.current]:{...values.eventDefinitions,results:values.eventDefinitions.results.map(d=>d.id===definition.id?definition:d)}},cache.apiCache[values.eventDefinitions.current]):values.eventDefinitions}}],eventPropertiesCacheMap:[{},{loadPropertiesForEvent:async(_ref7,breakpoint)=>{var _cache$apiCache2,_cache$apiCache3,_combineUrl$searchPar2,_await$api$get$result;let exampleEventProperties;let{definition,url}=_ref7;if(url&&url in(null!==(_cache$apiCache2=cache.apiCache)&&void 0!==_cache$apiCache2?_cache$apiCache2:{}))return{...values.eventPropertiesCacheMap,[definition.id]:cache.apiCache[url]};url||(url=lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.propertyDefinitions.determineListEndpoint({event_names:[definition.name],exclude_core_properties:!0,filter_by_event_names:!0,is_feature_flag:!1,limit:lib_constants__WEBPACK_IMPORTED_MODULE_5__.N6})),actions.setEventDefinitionPropertiesLoading(Array.from([...values.eventDefinitionPropertiesLoading,definition.id])),cache.propertiesStartTime=performance.now();let response=await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.get(url);breakpoint();let exampleUrl=lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.events.determineListEndpoint({event:definition.name},1);exampleUrl&&exampleUrl in(null!==(_cache$apiCache3=cache.apiCache)&&void 0!==_cache$apiCache3?_cache$apiCache3:{})?exampleEventProperties=cache.apiCache[exampleUrl]:(exampleEventProperties=null!==(_await$api$get$result=(await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.get(exampleUrl))?.results?.[0].properties)&&void 0!==_await$api$get$result?_await$api$get$result:{},cache.apiCache={...cache.apiCache,[exampleUrl]:exampleEventProperties});let currentUrl=`${normalizePropertyDefinitionEndpointUrl(url)}`;return cache.apiCache={...cache.apiCache,[currentUrl]:{count:response.count,previous:normalizePropertyDefinitionEndpointUrl(response.previous),next:normalizePropertyDefinitionEndpointUrl(response.next),current:currentUrl,page:Math.floor((null!==(_combineUrl$searchPar2=(0,kea_router__WEBPACK_IMPORTED_MODULE_2__.combineUrl)(currentUrl).searchParams.offset)&&void 0!==_combineUrl$searchPar2?_combineUrl$searchPar2:0)/lib_constants__WEBPACK_IMPORTED_MODULE_5__.N6)+1,results:response.results.map(prop=>({...prop,example:exampleEventProperties?.[prop.name]?.toString()}))}},actions.setEventDefinitionPropertiesLoading(values.eventDefinitionPropertiesLoading.filter(loadingId=>loadingId!=definition.id)),{...values.eventPropertiesCacheMap,[definition.id]:cache.apiCache[currentUrl]}},setLocalPropertyDefinition:_ref8=>{let{event,definition}=_ref8;if(!values.eventPropertiesCacheMap?.[event.id]?.current)return values.eventPropertiesCacheMap;let eventCacheKey=values.eventPropertiesCacheMap[event.id].current;return cache.apiCache={...cache.apiCache,[eventCacheKey]:{...values.eventPropertiesCacheMap[event.id],results:values.eventPropertiesCacheMap[event.id].results.map(p=>p.id===definition.id?definition:p)}},{...values.eventPropertiesCacheMap,[event.id]:cache.apiCache[eventCacheKey]}}}]}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)(_ref9=>{let{cache}=_ref9;return{apiCache:[()=>[],()=>cache.apiCache]}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.listeners)(_ref10=>{let{actions,values,cache}=_ref10;return{setFilters:async()=>{actions.loadEventDefinitions(normalizeEventDefinitionEndpointUrl({url:values.eventDefinitions.current,searchParams:{search:values.filters.event,ordering:values.filters.ordering},full:!0,eventTypeFilter:values.filters.event_type}))},loadEventDefinitionsSuccess:()=>{void 0!==cache.eventsStartTime&&(lib_utils_eventUsageLogic__WEBPACK_IMPORTED_MODULE_7__.vx.findMounted()?.actions.reportDataManagementEventDefinitionsPageLoadSucceeded(performance.now()-cache.eventsStartTime,values.eventDefinitions.results.length),cache.eventsStartTime=void 0)},loadEventDefinitionsFailure:_ref11=>{let{error}=_ref11;void 0!==cache.eventsStartTime&&(lib_utils_eventUsageLogic__WEBPACK_IMPORTED_MODULE_7__.vx.findMounted()?.actions.reportDataManagementEventDefinitionsPageLoadFailed(performance.now()-cache.eventsStartTime,null!=error?error:"There was an unknown error fetching event definitions."),cache.eventsStartTime=void 0)},loadPropertiesForEventSuccess:()=>{void 0!==cache.propertiesStartTime&&(lib_utils_eventUsageLogic__WEBPACK_IMPORTED_MODULE_7__.vx.findMounted()?.actions.reportDataManagementEventDefinitionsPageNestedPropertiesLoadSucceeded(performance.now()-cache.propertiesStartTime),cache.propertiesStartTime=void 0)},loadPropertiesForEventFailure:_ref12=>{let{error}=_ref12;void 0!==cache.propertiesStartTime&&(lib_utils_eventUsageLogic__WEBPACK_IMPORTED_MODULE_7__.vx.findMounted()?.actions.reportDataManagementEventDefinitionsPageNestedPropertiesLoadFailed(performance.now()-cache.propertiesStartTime,null!=error?error:"There was an unknown error fetching nested property definitions."),cache.propertiesStartTime=void 0)}}}),(0,kea_router__WEBPACK_IMPORTED_MODULE_2__.urlToAction)(_ref13=>{let{actions,values}=_ref13;return{"/data-management/events":(_,searchParams)=>{(0,lib_utils__WEBPACK_IMPORTED_MODULE_6__.h0)(cleanFilters(values.filters),cleanFilters(kea_router__WEBPACK_IMPORTED_MODULE_2__.router.values.searchParams))?values.eventDefinitions.results.length||values.eventDefinitionsLoading||actions.loadEventDefinitions():actions.setFilters(searchParams)}}}),(0,kea_router__WEBPACK_IMPORTED_MODULE_2__.actionToUrl)(_ref14=>{let{values}=_ref14;return{setFilters:()=>{let nextValues=cleanFilters(values.filters),urlValues=cleanFilters(kea_router__WEBPACK_IMPORTED_MODULE_2__.router.values.searchParams);if(!(0,lib_utils__WEBPACK_IMPORTED_MODULE_6__.h0)(nextValues,urlValues))return[kea_router__WEBPACK_IMPORTED_MODULE_2__.router.values.location.pathname,nextValues]}}})])},"../../frontend/src/scenes/data-management/properties/propertyDefinitionsTableLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{T:()=>propertyDefinitionsTableLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.6_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.6_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),kea_router__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.6_react@18.2.0_/node_modules/kea-router/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/api.ts"),lib_constants__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/constants.tsx"),lib_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/lib/utils.tsx"),lib_utils_eventUsageLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/lib/utils/eventUsageLogic.ts"),scenes_data_management_events_eventDefinitionsTableLogic__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/scenes/data-management/events/eventDefinitionsTableLogic.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../frontend/src/scenes/urls.ts"),_models_groupsModel__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../frontend/src/models/groupsModel.ts");function cleanFilters(filter){return{property:"",type:"event",group_type_index:null,...filter}}function removeDefaults(filter){return{property:""!==filter.property?filter.property:void 0,type:"event"!==filter.type?filter.type:void 0,group_type_index:null!==filter.group_type_index?filter.group_type_index:void 0}}let propertyDefinitionsTableLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","data-management","properties","propertyDefinitionsTableLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.key)(props=>props.key||"scene"),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)(()=>({values:[_models_groupsModel__WEBPACK_IMPORTED_MODULE_9__.$,["groupTypes","aggregationLabel"]]})),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({loadPropertyDefinitions:function(){let url=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{url}},setFilters:filters=>({filters}),setHoveredDefinition:definitionKey=>({definitionKey}),setOpenedDefinition:id=>({id}),setLocalPropertyDefinition:definition=>({definition}),setPropertyType:propertyType=>({propertyType})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({filters:[{property:"",type:"event"},{setFilters:(state,_ref)=>{let{filters}=_ref;return{...state,...filters}}}],hoveredDefinition:[null,{setHoveredDefinition:(_,_ref2)=>{let{definitionKey}=_ref2;return definitionKey}}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({propertyTypeOptions:[s=>[s.groupTypes,s.aggregationLabel],(groupTypes,aggregationLabel)=>[{label:"Event properties",value:"event::"},{label:"Person properties",value:"person::"}].concat(Array.from(groupTypes.values()).map(type=>({label:`${(0,lib_utils__WEBPACK_IMPORTED_MODULE_5__.fm)(aggregationLabel(type.group_type_index).singular)} properties`,value:`group::${type.group_type_index}`})))]}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)(_ref3=>{let{values,cache}=_ref3;return{propertyDefinitions:[{count:0,next:void 0,current:void 0,previous:void 0,results:[]},{loadPropertyDefinitions:async(_ref4,breakpoint)=>{var _cache$apiCache,_combineUrl$searchPar;let{url}=_ref4;if(url&&url in(null!==(_cache$apiCache=cache.apiCache)&&void 0!==_cache$apiCache?_cache$apiCache:{}))return cache.apiCache[url];url||(url=lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.propertyDefinitions.determineListEndpoint({})),cache.propertiesStartTime=performance.now(),await breakpoint(200);let response=await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.get(url);breakpoint();let currentUrl=`${(0,scenes_data_management_events_eventDefinitionsTableLogic__WEBPACK_IMPORTED_MODULE_7__.oq)(url)}`;return cache.apiCache={...cache.apiCache,[currentUrl]:{...response,previous:(0,scenes_data_management_events_eventDefinitionsTableLogic__WEBPACK_IMPORTED_MODULE_7__.oq)(response.previous),next:(0,scenes_data_management_events_eventDefinitionsTableLogic__WEBPACK_IMPORTED_MODULE_7__.oq)(response.next),current:currentUrl,page:Math.floor((null!==(_combineUrl$searchPar=(0,kea_router__WEBPACK_IMPORTED_MODULE_2__.combineUrl)(url).searchParams.offset)&&void 0!==_combineUrl$searchPar?_combineUrl$searchPar:0)/lib_constants__WEBPACK_IMPORTED_MODULE_4__.ld)+1}},cache.apiCache[url]},setLocalPropertyDefinition:_ref5=>{let{definition}=_ref5;return values.propertyDefinitions.current?(cache.apiCache={...cache.apiCache,[values.propertyDefinitions.current]:{...values.propertyDefinitions,results:values.propertyDefinitions.results.map(d=>d.id===definition.id?definition:d)}},cache.apiCache[values.propertyDefinitions.current]):values.propertyDefinitions}}]}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.listeners)(_ref6=>{let{actions,values,cache}=_ref6;return{setFilters:async(_,breakpoint)=>{await breakpoint(500),actions.loadPropertyDefinitions((0,scenes_data_management_events_eventDefinitionsTableLogic__WEBPACK_IMPORTED_MODULE_7__.oq)(values.propertyDefinitions.current,{offset:0,search:values.filters.property,type:values.filters.type,group_type_index:values.filters.group_type_index},!0))},loadPropertyDefinitionsSuccess:()=>{void 0!==cache.propertiesStartTime&&(lib_utils_eventUsageLogic__WEBPACK_IMPORTED_MODULE_6__.vx.findMounted()?.actions.reportDataManagementEventPropertyDefinitionsPageLoadSucceeded(performance.now()-cache.propertiesStartTime,values.propertyDefinitions.results.length),cache.propertiesStartTime=void 0)},loadPropertyDefinitionsFailure:_ref7=>{let{error}=_ref7;void 0!==cache.propertiesStartTime&&(lib_utils_eventUsageLogic__WEBPACK_IMPORTED_MODULE_6__.vx.findMounted()?.actions.reportDataManagementEventPropertyDefinitionsPageLoadFailed(performance.now()-cache.propertiesStartTime,null!=error?error:"There was an unknown error fetching property definitions."),cache.propertiesStartTime=void 0)},setPropertyType:_ref8=>{let{propertyType}=_ref8,[type,index]=propertyType.split("::");actions.setFilters({type:type,group_type_index:index?+index:null})}}}),(0,kea_router__WEBPACK_IMPORTED_MODULE_2__.urlToAction)(_ref9=>{let{actions,values}=_ref9;return{[scenes_urls__WEBPACK_IMPORTED_MODULE_8__.j.propertyDefinitions()]:(_,searchParams)=>{!values.propertyDefinitionsLoading&&((0,lib_utils__WEBPACK_IMPORTED_MODULE_5__.h0)(cleanFilters(values.filters),cleanFilters(kea_router__WEBPACK_IMPORTED_MODULE_2__.router.values.searchParams))?values.propertyDefinitions.results.length||actions.loadPropertyDefinitions():actions.setFilters(searchParams))}}}),(0,kea_router__WEBPACK_IMPORTED_MODULE_2__.actionToUrl)(_ref10=>{let{values}=_ref10;return{setFilters:()=>{let nextValues=cleanFilters(values.filters),urlValues=cleanFilters(kea_router__WEBPACK_IMPORTED_MODULE_2__.router.values.searchParams);if(!(0,lib_utils__WEBPACK_IMPORTED_MODULE_5__.h0)(nextValues,urlValues))return[kea_router__WEBPACK_IMPORTED_MODULE_2__.router.values.location.pathname,removeDefaults(nextValues)]}}})])},"../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!../../node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.5.6_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!../../node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!../../frontend/src/scenes/data-management/properties/PropertyDefinitionsTable.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".event-properties-definition-table .LemonTable__content>table>tbody td.definition-column-icon{padding-right:.5rem;width:36px}.event-properties-definition-table .LemonTable__content>table>tbody td.definition-column-icon .definition-column-name-icon{align-items:center;display:flex;font-size:1.2rem;justify-content:center;width:30px}.event-properties-definition-table .LemonTable__content>table>tbody td.definition-column-icon .definition-column-name-icon svg.taxonomy-icon{flex-shrink:0}.event-properties-definition-table .LemonTable__content>table>tbody td.definition-column-icon .definition-column-name-icon svg.taxonomy-icon.taxonomy-icon-muted{color:var(--color-text-secondary)}.event-properties-definition-table .LemonTable__content>table>tbody td.definition-column-icon .definition-column-name-icon svg.taxonomy-icon.taxonomy-icon-verified{color:var(--success)}.event-properties-definition-table .LemonTable__content>table>tbody td.definition-column-name .definition-column-name-content{display:flex;flex-direction:column;justify-content:center;min-height:32px;position:relative}.event-properties-definition-table .LemonTable__content>table>tbody td.definition-column-name .definition-column-name-content .definition-column-name-content-title{align-items:center;cursor:pointer;display:flex;font-weight:600;gap:.25rem}.event-properties-definition-table .LemonTable__content>table>tbody td.definition-column-name .definition-column-name-content .definition-column-name-content-title svg{color:var(--success)}",""]),module.exports=exports}}]);