"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[38775],{"../../frontend/src/layout/scenes/SceneContent.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{SN:()=>SceneSection,Vl:()=>SceneDivider,_W:()=>SceneContent,sG:()=>SceneTitleSection});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),_posthog_icons__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.27.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),lib_constants__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/constants.tsx"),lib_lemon_ui_LemonMarkdown__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonMarkdown/index.ts"),lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/lib/logic/featureFlagLogic.ts"),lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/lib/ui/Button/ButtonPrimitives.tsx"),lib_ui_TextInputPrimitive_TextInputPrimitive__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../frontend/src/lib/ui/TextInputPrimitive/TextInputPrimitive.tsx"),lib_ui_TextareaPrimitive_TextareaPrimitive__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../frontend/src/lib/ui/TextareaPrimitive/TextareaPrimitive.tsx"),lib_ui_WrappingLoadingSkeleton_WrappingLoadingSkeleton__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../frontend/src/lib/ui/WrappingLoadingSkeleton/WrappingLoadingSkeleton.tsx"),lib_utils_css_classes__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("../../frontend/src/lib/utils/css-classes.ts"),_panel_layout_ProjectTree_defaultTree__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../frontend/src/layout/panel-layout/ProjectTree/defaultTree.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function SceneContent(_ref){let{children}=_ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("div",{className:"scene-content flex flex-col gap-y-4",children:children})}function SceneSection(_ref2){let{title,description,isLoading,children,className,hideTitleAndDescription}=_ref2,{featureFlags}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_6__.featureFlagLogic);return featureFlags[lib_constants__WEBPACK_IMPORTED_MODULE_4__.y8.NEW_SCENE_LAYOUT]?isLoading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:(0,lib_utils_css_classes__WEBPACK_IMPORTED_MODULE_13__.cn)("flex flex-col gap-4",className),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("h2",{className:"text-xl font-bold my-0 mb-1 max-w-prose",children:title}),description&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("p",{className:"text-sm text-secondary my-0 max-w-prose",children:description})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_ui_WrappingLoadingSkeleton_WrappingLoadingSkeleton__WEBPACK_IMPORTED_MODULE_10__.x,{children:children})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:(0,lib_utils_css_classes__WEBPACK_IMPORTED_MODULE_13__.cn)("scene-section--new-layout flex flex-col gap-4",className),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("h2",{className:"text-xl font-bold my-0 mb-1 max-w-prose",children:title}),description&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("p",{className:"text-sm text-secondary my-0 max-w-prose",children:description})]}),children]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:(0,lib_utils_css_classes__WEBPACK_IMPORTED_MODULE_13__.cn)("scene-section--fallback flex flex-col gap-4",className),children:[!hideTitleAndDescription&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"flex flex-col",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("h2",{className:"flex-1 subtitle mt-0",children:title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("p",{className:"m-0",children:description})]}),children]})}function SceneTitleSection(_ref3){let{name,description,resourceType,markdown=!1,isLoading=!1,onNameBlur,onDescriptionBlur,docsURL}=_ref3,{featureFlags}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_6__.featureFlagLogic);if(!featureFlags[lib_constants__WEBPACK_IMPORTED_MODULE_4__.y8.NEW_SCENE_LAYOUT])return null;let icon=resourceType.forceIcon?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_panel_layout_ProjectTree_defaultTree__WEBPACK_IMPORTED_MODULE_11__.ee,{type:resourceType.type,colorOverride:resourceType.forceIconColorOverride,children:resourceType.forceIcon}):(0,_panel_layout_ProjectTree_defaultTree__WEBPACK_IMPORTED_MODULE_11__.PO)(resourceType.type);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"scene-title-section w-full flex gap-0 group/colorful-product-icons colorful-product-icons-true",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"flex flex-col gap-1.5 flex-1",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"flex gap-3 [&_svg]:size-6 items-center",children:[resourceType.to?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_3__.rU,{to:resourceType.to,tooltip:resourceType.tooltip||`View all ${resourceType.typePlural}`,buttonProps:{size:"base",iconOnly:!0,variant:"panel",className:"rounded-sm h-[var(--button-height-lg)]"},children:icon}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("span",{className:(0,lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_7__.sq)({size:"base",iconOnly:!0,className:"rounded-sm h-[var(--button-height-lg)]",inert:!0}),children:icon}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(SceneName,{name:name,isLoading:isLoading,onBlur:onNameBlur})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(SceneDescription,{description:description,markdown:markdown,isLoading:isLoading,onBlur:onDescriptionBlur})]}),docsURL&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_3__.rU,{to:`${docsURL}?utm_medium=in-product&utm_campaign=scene-title-section-docs-link`,buttonProps:{variant:"panel",className:"rounded-sm"},tooltip:`View docs for ${resourceType.typePlural}`,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_2__.IconDocument,{})," ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("span",{className:"hidden lg:block",children:"Read the docs"})]})]})}function SceneName(_ref4){let{name:initialName,isLoading=!1,onBlur}=_ref4,[isEditing,setIsEditing]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),[name,setName]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(initialName),textClasses="text-3xl font-bold my-0 pl-[var(--button-padding-x-sm)] h-[var(--button-height-lg)] leading-[1.4] select-auto";(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{isLoading||setName(initialName)},[initialName,isLoading]);let Element=onBlur?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_7__.hL,{size:"lg",onClick:()=>setIsEditing(!0),className:textClasses,menuItem:!0,variant:"panel",tooltip:isEditing?null:"Edit name",children:name||(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("span",{className:"text-tertiary",children:"Unnamed"})}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("h1",{className:(0,lib_utils_css_classes__WEBPACK_IMPORTED_MODULE_13__.cn)((0,lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_7__.sq)({size:"lg",inert:!0,className:textClasses})),children:name||(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("span",{className:"text-tertiary",children:"Unnamed"})});return isLoading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("div",{className:"max-w-prose",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_ui_WrappingLoadingSkeleton_WrappingLoadingSkeleton__WEBPACK_IMPORTED_MODULE_10__.x,{fullWidth:!0,children:Element})}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("div",{className:"scene-name max-w-prose flex flex-col gap-0 -ml-[calc(var(--button-padding-x-sm)+2px)]",children:isEditing?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_ui_TextInputPrimitive_TextInputPrimitive__WEBPACK_IMPORTED_MODULE_8__.w,{variant:"default",value:name||"",onChange:e=>setName(e.target.value),className:`${textClasses} bg-transparent field-sizing-content w-full`,autoFocus:!0,onBlur:()=>{setIsEditing(!1),initialName!==name&&onBlur?.(name||"")},size:"lg"})}):Element})}function SceneDescription(_ref5){let{description:initialDescription,markdown=!1,isLoading=!1,onBlur}=_ref5,[isEditing,setIsEditing]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),[description,setDescription]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(initialDescription),textClasses="text-sm my-0 select-auto";(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{isLoading||setDescription(initialDescription)},[initialDescription,isLoading]);let Element=onBlur?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_7__.hL,{onClick:()=>setIsEditing(!0),className:`${textClasses}`,autoHeight:!0,menuItem:!0,variant:"panel",tooltip:isEditing?null:"Edit description",children:markdown&&description?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_lemon_ui_LemonMarkdown__WEBPACK_IMPORTED_MODULE_5__.j,{lowKeyHeadings:!0,className:"[&_p]:my-0 [&_p]:leading-[20px]",children:description}):description||(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("span",{className:"text-tertiary",children:"No description (optional)"})}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:markdown&&description?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_lemon_ui_LemonMarkdown__WEBPACK_IMPORTED_MODULE_5__.j,{lowKeyHeadings:!0,className:(0,lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_7__.sq)({inert:!0,className:`${textClasses} -ml-[var(--button-padding-x-base)]`,autoHeight:!0}),children:description}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("p",{className:(0,lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_7__.sq)({inert:!0,className:`${textClasses} -ml-[var(--button-padding-x-base)]`,autoHeight:!0}),children:description||(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("span",{className:"text-tertiary",children:"No description (optional)"})})});return isLoading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("div",{className:"max-w-prose",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_ui_WrappingLoadingSkeleton_WrappingLoadingSkeleton__WEBPACK_IMPORTED_MODULE_10__.x,{fullWidth:!0,children:Element})}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("div",{className:"scene-description max-w-prose flex flex-col gap-0",children:isEditing?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_ui_TextareaPrimitive_TextareaPrimitive__WEBPACK_IMPORTED_MODULE_9__.L,{variant:"default",value:description||"",onChange:e=>setDescription(e.target.value),className:`${textClasses} bg-transparent field-sizing-content w-full`,autoFocus:!0,onBlur:()=>{setIsEditing(!1),initialDescription!==description&&onBlur?.(description||"")},markdown:!0})}):Element})}function SceneDivider(){let{featureFlags}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_6__.featureFlagLogic);return featureFlags[lib_constants__WEBPACK_IMPORTED_MODULE_4__.y8.NEW_SCENE_LAYOUT]?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_3__.p2,{className:"scene-divider -mx-4 w-[calc(100%+var(--spacing)*8)]"}):null}},"../../frontend/src/scenes/groups/Groups.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Groups:()=>Groups,GroupsScene:()=>GroupsScene,scene:()=>scene});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.27.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),useFeatureFlag=__webpack_require__("../../frontend/src/lib/hooks/useFeatureFlag.ts"),groupsAccessLogic=__webpack_require__("../../frontend/src/lib/introductions/groupsAccessLogic.ts"),LemonButton=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/index.ts"),LemonInput=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonInput/index.ts"),LemonModal=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonModal/index.ts"),Link=__webpack_require__("../../frontend/src/lib/lemon-ui/Link/index.ts"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),GroupsIntroduction=__webpack_require__("../../frontend/src/scenes/groups/GroupsIntroduction.tsx"),PersonsManagementSceneTabs=__webpack_require__("../../frontend/src/scenes/persons-management/PersonsManagementSceneTabs.tsx"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),SceneContent=__webpack_require__("../../frontend/src/layout/scenes/SceneContent.tsx"),groupsModel=__webpack_require__("../../frontend/src/models/groupsModel.ts"),Query=__webpack_require__("../../frontend/src/queries/Query/Query.tsx"),CopyToClipboard=__webpack_require__("../../frontend/src/lib/components/CopyToClipboard.tsx"),LemonTableLink=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/LemonTableLink.tsx"),stringWithWBR=__webpack_require__("../../frontend/src/lib/utils/stringWithWBR.tsx"),billing_utils=__webpack_require__("../../frontend/src/scenes/billing/billing-utils.ts"),PersonDisplay=__webpack_require__("../../frontend/src/scenes/persons/PersonDisplay.tsx"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function getCRMColumns(groupTypeName,groupTypeIndex){return{group_name:{title:groupTypeName,render:function renderGroupName(_ref){var _sourceQuery$select$i;let{query,record,value}=_ref,sourceQuery=query.source,groupKey=record[null!==(_sourceQuery$select$i=sourceQuery?.select?.indexOf("key"))&&void 0!==_sourceQuery$select$i?_sourceQuery$select$i:-1];return(0,jsx_runtime.jsxs)("div",{className:"min-w-40",children:[(0,jsx_runtime.jsx)(LemonTableLink.i,{to:urls.j.group(groupTypeIndex,groupKey),title:value}),(0,jsx_runtime.jsx)(CopyToClipboard.D,{explicitValue:groupKey,iconStyle:{color:"var(--color-accent)"},description:"group id",children:(0,stringWithWBR.Z)(groupKey,100)})]})}},arr:{render:renderCurrency},mrr:{render:renderCurrency},"forecasted mrr":{render:renderCurrency},owner:{render:renderPerson},"survey responses":{render:renderLink},"feature flags":{render:renderLink},"mobile recordings":{render:renderLink},"data warehouse":{render:renderLink},events:{render:renderLink}}}function renderCurrency(_ref2){let{value}=_ref2;return!value||isNaN(Number(value))?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"—"}):(0,jsx_runtime.jsx)(LemonTableLink.i,{to:urls.j.revenueAnalytics(),title:(0,billing_utils.oB)(value)})}function renderPerson(_ref3){let{value}=_ref3;return value&&"string"==typeof value?(0,jsx_runtime.jsx)(PersonDisplay.I,{withIcon:!0,displayName:value}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"—"})}function renderLink(_ref4){let{value,columnName}=_ref4;if(!value||isNaN(Number(value)))return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"—"});let cellData={value:value,title:(0,utils.Lc)(Number(value)),url:"",description:"in the last 7d"};if("survey responses"===columnName)cellData.url=urls.j.surveys();else if("feature flags"===columnName)cellData.url=urls.j.featureFlags(),cellData.description="evals in the last 7d";else if("mobile recordings"===columnName)cellData.url=urls.j.replay();else if("data warehouse"===columnName)cellData.url=urls.j.sqlEditor(),cellData.description="rows synced in the last 7d";else{if("events"!==columnName)return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"—"});cellData.url=urls.j.activity()}return(0,jsx_runtime.jsx)("div",{className:"min-w-30",children:(0,jsx_runtime.jsx)(LemonTableLink.i,{to:cellData.url,title:cellData.title,description:cellData.description})})}var groupViewLogic=__webpack_require__("../../frontend/src/scenes/groups/groupViewLogic.ts"),dist_module=__webpack_require__("../../node_modules/.pnpm/posthog-js@1.260.0_@rrweb+types@2.0.0-alpha.17/node_modules/posthog-js/dist/module.js"),teamLogic=__webpack_require__("../../frontend/src/scenes/teamLogic.tsx"),DataTable_utils=__webpack_require__("../../frontend/src/queries/nodes/DataTable/utils.ts"),schema_general=__webpack_require__("../../frontend/src/queries/schema/schema-general.ts");let INITIAL_SORTING=[],INITIAL_GROUPS_FILTER=[],groupsListLogic=(0,index_esm.kea)([(0,index_esm.props)({}),(0,index_esm.key)(props=>props.groupTypeIndex),(0,index_esm.path)(["scenes","groups","groupsListLogic"]),(0,index_esm.connect)(()=>({values:[teamLogic.teamLogic,["currentTeamId"],groupsModel.$,["groupTypes","aggregationLabel"],groupsAccessLogic.e,["groupsEnabled"]]})),(0,index_esm.actions)(()=>({setQuery:query=>({query}),setQueryWasModified:queryWasModified=>({queryWasModified}),setGroupFilters:filters=>({filters})})),(0,index_esm.reducers)(()=>({query:[(_,props)=>({kind:schema_general.OH.DataTableNode,source:{kind:schema_general.OH.GroupsQuery,select:void 0,group_type_index:props.groupTypeIndex},full:!0,showEventFilter:!1,showPersistentColumnConfigurator:!0,propertiesViaUrl:!0}),{setQuery:(_,_ref)=>{let{query}=_ref;return query}}],groupFilters:[INITIAL_GROUPS_FILTER,{setGroupFilters:(_,_ref2)=>{let{filters}=_ref2;return filters},setQuery:(state,_ref3)=>{let{query}=_ref3;return query.source.kind===schema_general.OH.GroupsQuery&&query.source.properties?query.source.properties:state}}],sorting:[INITIAL_SORTING,{setQuery:(state,_ref4)=>{let{query}=_ref4;return query.source.kind===schema_general.OH.GroupsQuery&&void 0!==query.source.orderBy?query.source.orderBy:state}}],queryWasModified:[!1,{setQueryWasModified:(_,_ref5)=>{let{queryWasModified}=_ref5;return queryWasModified}}]})),(0,index_esm.listeners)(_ref6=>{let{actions}=_ref6;return{setQuery:()=>{actions.setQueryWasModified(!0)}}}),(0,lib.actionToUrl)(_ref7=>{let{values,props}=_ref7;return{setQuery:()=>{let searchParams={};return values.query.source.kind!==schema_general.OH.GroupsQuery||(values.query.source.properties?.length&&(searchParams[`properties_${props.groupTypeIndex}`]=JSON.stringify(values.query.source.properties)),values.query.source.select?.length&&(searchParams[`select_${props.groupTypeIndex}`]=JSON.stringify(values.query.source.select)),values.query.source.orderBy?.length&&(searchParams[`orderBy_${props.groupTypeIndex}`]=JSON.stringify(values.query.source.orderBy))),[lib.router.values.location.pathname,searchParams,void 0,{replace:!0}]},setGroupFilters:()=>{let searchParams={};return values.groupFilters?.length&&(searchParams[`properties_${props.groupTypeIndex}`]=JSON.stringify(values.groupFilters)),[lib.router.values.location.pathname,searchParams,void 0,{replace:!0}]}}}),(0,lib.urlToAction)(_ref8=>{let{actions,values,props}=_ref8;return{[`/groups/${props.groupTypeIndex}`]:(_,searchParams)=>{if(values.query.source.kind!==schema_general.OH.GroupsQuery)return;let queryOverrides={},parseParam=paramName=>{let rawParam=searchParams[`${paramName}_${props.groupTypeIndex}`];if(rawParam)try{let parsedParam=JSON.parse(rawParam);parsedParam&&(queryOverrides[paramName]=parsedParam)}catch(error){dist_module.ZP.captureException("Failed to parse query overrides from URL",error)}};parseParam("properties"),parseParam("select"),parseParam("orderBy"),Object.keys(queryOverrides).length>0?actions.setQuery({...values.query,source:{...values.query.source,...queryOverrides}}):actions.setQuery({...values.query,source:{...values.query.source,properties:values.groupFilters,orderBy:values.sorting}})}}}),(0,index_esm.afterMount)(_ref9=>{let{actions,values}=_ref9;if(values.query.source.kind===schema_general.OH.GroupsQuery&&void 0===values.query.source.select){let defaultColumns=values.groupTypes.get(values.query.source.group_type_index)?.default_columns;actions.setQuery({...values.query,source:{...values.query.source,select:null!=defaultColumns?defaultColumns:(0,DataTable_utils.Qi)(schema_general.OH.GroupsQuery)}}),actions.setQueryWasModified(!1)}})]);var groupsSceneLogic=__webpack_require__("../../frontend/src/scenes/groups/groupsSceneLogic.ts");function Groups(_ref){let{groupTypeIndex}=_ref,{groupTypeName,groupTypeNamePlural}=(0,index_esm.useValues)(groupsSceneLogic.C),{query,queryWasModified}=(0,index_esm.useValues)(groupsListLogic({groupTypeIndex})),{setQuery}=(0,index_esm.useActions)(groupsListLogic({groupTypeIndex})),{saveGroupViewModalOpen,groupViewName}=(0,index_esm.useValues)(groupViewLogic.a),{setSaveGroupViewModalOpen,setGroupViewName,saveGroupView}=(0,index_esm.useActions)(groupViewLogic.a),{groupsAccessStatus}=(0,index_esm.useValues)(groupsAccessLogic.e),{aggregationLabel}=(0,index_esm.useValues)(groupsModel.$),hasCrmIterationOneEnabled=(0,useFeatureFlag.y)("CRM_ITERATION_ONE");if(void 0===groupTypeIndex)throw Error("groupTypeIndex is undefined");if(groupsAccessStatus==groupsAccessLogic.Q.HasAccess||groupsAccessStatus==groupsAccessLogic.Q.HasGroupTypes||groupsAccessStatus==groupsAccessLogic.Q.NoAccess)return(0,jsx_runtime.jsxs)(SceneContent._W,{children:[(0,jsx_runtime.jsx)(PersonsManagementSceneTabs.c,{tabKey:`groups-${groupTypeIndex}`}),(0,jsx_runtime.jsx)(SceneContent.sG,{name:"Groups",description:"Associate events with a group or entity - such as a company, community, or project. Analyze these events as if they were sent by that entity itself. Great for B2B, marketplaces, and more.",resourceType:{type:groupTypeName,typePlural:groupTypeNamePlural,forceIcon:(0,jsx_runtime.jsx)(posthog_icons_es.IconPeople,{})}}),(0,jsx_runtime.jsx)(GroupsIntroduction.S,{})]});let columns={group_name:{title:groupTypeName}},hiddenColumns=[];return hasCrmIterationOneEnabled&&(columns=getCRMColumns(groupTypeName,groupTypeIndex),hiddenColumns.push("key")),(0,jsx_runtime.jsxs)(SceneContent._W,{children:[(0,jsx_runtime.jsx)(PersonsManagementSceneTabs.c,{tabKey:`groups-${groupTypeIndex}`,buttons:(0,jsx_runtime.jsxs)(LemonButton.J,{type:"primary","data-attr":`new-group-${groupTypeIndex}`,onClick:()=>lib.router.actions.push(urls.j.group(groupTypeIndex,"new",!1)),children:["New ",aggregationLabel(groupTypeIndex).singular]})}),(0,jsx_runtime.jsx)(SceneContent.sG,{name:(0,utils.fm)(groupTypeNamePlural),description:`A catalog of all ${groupTypeNamePlural} for this project`,resourceType:{type:groupTypeName,typePlural:groupTypeNamePlural,forceIcon:(0,jsx_runtime.jsx)(posthog_icons_es.IconPeople,{})}}),(0,jsx_runtime.jsx)(SceneContent.Vl,{}),(0,jsx_runtime.jsx)(Query.A,{query:{...query,hiddenColumns},setQuery:setQuery,context:{refresh:"blocking",emptyStateHeading:queryWasModified?`No ${groupTypeNamePlural} found`:`No ${groupTypeNamePlural} exist because none have been identified`,emptyStateDetail:queryWasModified?"Try changing the date range or property filters.":(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Go to the"," ",(0,jsx_runtime.jsx)(Link.r,{to:"https://posthog.com/docs/product-analytics/group-analytics#how-to-create-groups",children:"group analytics docs"})," ","to learn what needs to be done"]}),columns,groupTypeLabel:groupTypeNamePlural},dataAttr:"groups-table"}),hasCrmIterationOneEnabled&&(0,jsx_runtime.jsx)(LemonModal.f,{isOpen:saveGroupViewModalOpen,onClose:()=>setSaveGroupViewModalOpen(!1),title:"Save filtered groups view",footer:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(LemonButton.J,{onClick:()=>setSaveGroupViewModalOpen(!1),children:"Cancel"}),(0,jsx_runtime.jsx)(LemonButton.J,{type:"primary",onClick:()=>saveGroupView(window.location.href,groupTypeIndex),disabledReason:groupViewName.trim()?void 0:"Name is required",children:"Save"})]}),children:(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsx)("p",{children:"Save this filtered view as a shortcut in the People panel."}),(0,jsx_runtime.jsx)(LemonInput.D,{placeholder:"Enter view name",value:groupViewName,onChange:setGroupViewName,onKeyDown:e=>{"Enter"===e.key&&groupViewName.trim()&&saveGroupView(window.location.href,groupTypeIndex)},autoFocus:!0})]})})]})}function GroupsScene(){let{groupTypeIndex}=(0,index_esm.useValues)(groupsSceneLogic.C);return(0,jsx_runtime.jsx)(Groups,{groupTypeIndex:groupTypeIndex})}let scene={component:GroupsScene,logic:groupsSceneLogic.C,settingSectionId:"environment-crm"}},"../../frontend/src/scenes/groups/groupsSceneLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>groupsSceneLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_router__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),lib_introductions_groupsAccessLogic__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/introductions/groupsAccessLogic.ts"),lib_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/utils.tsx"),scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/scenes/urls.ts"),_models_groupsModel__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/models/groupsModel.ts");let groupsSceneLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","groups","groupsSceneLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)(()=>({values:[_models_groupsModel__WEBPACK_IMPORTED_MODULE_6__.$,["aggregationLabel","groupTypes","groupTypesLoading","groupsAccessStatus"]]})),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setGroupTypeIndex:groupTypeIndex=>({groupTypeIndex})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({groupTypeIndex:[0,{setGroupTypeIndex:(_,_ref)=>{let{groupTypeIndex}=_ref;return groupTypeIndex}}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({tabs:[()=>[],()=>[]],groupTypeName:[s=>[s.aggregationLabel,s.groupTypeIndex],(aggregationLabel,groupTypeIndex)=>aggregationLabel(groupTypeIndex).singular],groupTypeNamePlural:[s=>[s.aggregationLabel,s.groupTypeIndex],(aggregationLabel,groupTypeIndex)=>aggregationLabel(groupTypeIndex).plural],breadcrumbs:[s=>[s.groupTypeIndex,s.groupTypeNamePlural,s.showGroupsIntroductionPage],(groupTypeIndex,groupTypeNamePlural,showGroupsIntroductionPage)=>[{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_4__.x.Groups,name:showGroupsIntroductionPage?"Groups":(0,lib_utils__WEBPACK_IMPORTED_MODULE_3__.fm)(groupTypeNamePlural),path:scenes_urls__WEBPACK_IMPORTED_MODULE_5__.j.groups(groupTypeIndex)}]],showGroupsIntroductionPage:[s=>[s.groupsAccessStatus],groupsAccessStatus=>[lib_introductions_groupsAccessLogic__WEBPACK_IMPORTED_MODULE_2__.Q.HasAccess,lib_introductions_groupsAccessLogic__WEBPACK_IMPORTED_MODULE_2__.Q.HasGroupTypes,lib_introductions_groupsAccessLogic__WEBPACK_IMPORTED_MODULE_2__.Q.NoAccess].includes(groupsAccessStatus)]}),(0,kea_router__WEBPACK_IMPORTED_MODULE_1__.urlToAction)(_ref2=>{let{actions}=_ref2;return{[scenes_urls__WEBPACK_IMPORTED_MODULE_5__.j.groups(":key")]:_ref3=>{let{key}=_ref3;key&&actions.setGroupTypeIndex(parseInt(key))}}})])},"../../frontend/src/scenes/persons-management/PersonsManagementSceneTabs.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>PersonsManagementSceneTabs});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),PageHeader=__webpack_require__("../../frontend/src/lib/components/PageHeader.tsx"),constants=__webpack_require__("../../frontend/src/lib/constants.tsx"),LemonTabs=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTabs/index.ts"),featureFlagLogic=__webpack_require__("../../frontend/src/lib/logic/featureFlagLogic.ts"),groupsModel=__webpack_require__("../../frontend/src/models/groupsModel.ts"),groupsAccessLogic=__webpack_require__("../../frontend/src/lib/introductions/groupsAccessLogic.ts"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),groupsSceneLogic=__webpack_require__("../../frontend/src/scenes/groups/groupsSceneLogic.ts"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let personsManagementSceneLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","persons-management","personsManagementSceneLogic"]),(0,index_esm.connect)(()=>({actions:[groupsSceneLogic.C,["setGroupTypeIndex"]],values:[groupsModel.$,["aggregationLabel","groupTypes","groupTypesLoading","groupsAccessStatus"],featureFlagLogic.featureFlagLogic,["featureFlags"]]})),(0,index_esm.selectors)({tabs:[s=>[s.groupTabs],groupTabs=>[{key:"persons",url:urls.j.persons(),label:"People",tooltipDocLink:"https://posthog.com/docs/data/persons"},{key:"cohorts",url:urls.j.cohorts(),label:"Cohorts",tooltipDocLink:"https://posthog.com/docs/data/cohorts"},...groupTabs]],crmFeatureFlag:[s=>[s.featureFlags],featureFlags=>featureFlags[constants.y8.CRM_ITERATION_ONE]],groupTabs:[s=>[s.groupTypes,s.groupsAccessStatus,s.aggregationLabel],(groupTypes,groupsAccessStatus,aggregationLabel)=>[groupsAccessLogic.Q.HasAccess,groupsAccessLogic.Q.HasGroupTypes,groupsAccessLogic.Q.NoAccess].includes(groupsAccessStatus)?[{key:"groups-0",label:"Groups",url:urls.j.groups(0)}]:Array.from(groupTypes.values()).map(_ref=>{let{group_type_index}=_ref;return{key:`groups-${group_type_index}`,label:(0,utils.fm)(aggregationLabel(group_type_index).plural),url:urls.j.groups(group_type_index)}})],lemonTabs:[s=>[s.tabs],tabs=>tabs.map(tab=>({key:tab.key,label:(0,jsx_runtime.jsx)("span",{"data-attr":`persons-management-${tab.key}-tab`,children:tab.label}),tooltipDocLink:tab.tooltipDocLink,link:tab.url}))]})]);function PersonsManagementSceneTabs(_ref){let{tabKey,buttons}=_ref,{lemonTabs}=(0,index_esm.useValues)(personsManagementSceneLogic),{showGroupsOptions}=(0,index_esm.useValues)(groupsModel.$),{featureFlags}=(0,index_esm.useValues)(featureFlagLogic.featureFlagLogic),newSceneLayout=featureFlags[constants.y8.NEW_SCENE_LAYOUT];return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(PageHeader.m,{caption:newSceneLayout?null:showGroupsOptions?"A catalog of identified persons, groups, and your created cohorts.":"A catalog of identified persons and your created cohorts.",buttons:buttons}),(0,jsx_runtime.jsx)(LemonTabs.T,{activeKey:tabKey,tabs:lemonTabs,className:"-mt-4 -mx-4 [&>ul]:px-4 [&>ul]:mb-0"})]})}}}]);