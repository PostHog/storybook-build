(window.webpackJsonp=window.webpackJsonp||[]).push([[229],{4350:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return groupsListLogic}));__webpack_require__(42),__webpack_require__(48),__webpack_require__(40),__webpack_require__(53);var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(8),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__(67),__webpack_require__(13)),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__),kea__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1),lib_api__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(21),lib_introductions_groupsAccessLogic__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(254),lib_utils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(10),scenes_teamLogic__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(32),scenes_urls__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(19),_models_groupsModel__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(128),groupsListLogic=Object(kea__WEBPACK_IMPORTED_MODULE_7__.kea)({path:["groups","groupsListLogic"],connect:{values:[scenes_teamLogic__WEBPACK_IMPORTED_MODULE_11__.a,["currentTeamId"],_models_groupsModel__WEBPACK_IMPORTED_MODULE_13__.a,["groupTypes","aggregationLabel"],lib_introductions_groupsAccessLogic__WEBPACK_IMPORTED_MODULE_9__.b,["groupsEnabled"]]},actions:function actions(){return{loadGroups:function loadGroups(url){return{url:url}},setTab:function setTab(tab){return{tab:tab}}}},loaders:function loaders(_ref){var _loadGroups,values=_ref.values;return{groups:[{next:null,previous:null,results:[]},{loadGroups:(_loadGroups=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark((function _callee(_ref2){var url;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(url=_ref2.url,!values.groupsEnabled){_context.next=6;break}return url=url||"api/projects/".concat(values.currentTeamId,"/groups/?group_type_index=").concat(values.currentTab),_context.next=5,lib_api__WEBPACK_IMPORTED_MODULE_8__.a.get(url);case 5:return _context.abrupt("return",_context.sent);case 6:case"end":return _context.stop()}}),_callee)}))),function loadGroups(_x){return _loadGroups.apply(this,arguments)})}]}},reducers:{currentTab:["-1",{setTab:function setTab(_,_ref3){return _ref3.tab}}]},selectors:{currentTabName:[function(s){return[s.currentTab,s.groupTypes,s.aggregationLabel]},function(currentTab,groupTypes,aggregationLabel){return"-1"===currentTab?"Persons":(null==groupTypes?void 0:groupTypes.length)?Object(lib_utils__WEBPACK_IMPORTED_MODULE_10__.j)(aggregationLabel(parseInt(currentTab)).singular):""}],breadcrumbs:[function(s){return[s.currentTabName,s.currentTab]},function(currentTabName,currentTab){return[{name:currentTabName,path:scenes_urls__WEBPACK_IMPORTED_MODULE_12__.a.groups(currentTab)}]}]},actionToUrl:function actionToUrl(){return{setTab:function setTab(_ref4){var tab=_ref4.tab;return"-1"!==tab?scenes_urls__WEBPACK_IMPORTED_MODULE_12__.a.groups(tab):scenes_urls__WEBPACK_IMPORTED_MODULE_12__.a.persons()}}},urlToAction:function urlToAction(_ref5){var actions=_ref5.actions,values=_ref5.values;return{"/groups/:id":function groupsId(_ref6){var id=_ref6.id;id&&(actions.setTab(id),actions.loadGroups())},"/persons":function persons(){"-1"!==values.currentTab&&actions.setTab("-1")}}}})},4355:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(17),_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_src_index_js_node_modules_sass_loader_dist_cjs_js_ref_5_3_Persons_scss__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4356),_node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_src_index_js_node_modules_sass_loader_dist_cjs_js_ref_5_3_Persons_scss__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_src_index_js_node_modules_sass_loader_dist_cjs_js_ref_5_3_Persons_scss__WEBPACK_IMPORTED_MODULE_1__),options={insert:"head",singleton:!1};_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default()(_node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_src_index_js_node_modules_sass_loader_dist_cjs_js_ref_5_3_Persons_scss__WEBPACK_IMPORTED_MODULE_1___default.a,options),_node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_src_index_js_node_modules_sass_loader_dist_cjs_js_ref_5_3_Persons_scss__WEBPACK_IMPORTED_MODULE_1___default.a.locals},4356:function(module,exports,__webpack_require__){(exports=__webpack_require__(50)(!1)).push([module.i,'.mixin-gradient-overlay{width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent)}.mixin-gradient-overlay,.mixin-gradient-overlay-right{content:"";position:absolute;pointer-events:none;bottom:0}.mixin-gradient-overlay-right{width:3rem;height:100%;background:linear-gradient(270deg,#fff,transparent)}.text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.extra-ids{display:inline-flex;align-items:center;height:1.25rem;line-height:1.125rem;margin:0 0 0 .25rem;padding:0 .25rem 0 .375rem;color:#5375ff;cursor:pointer}.extra-ids svg{margin-left:.25rem}',""]),module.exports=exports},4360:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return PersonPageHeader}));var index_esm=__webpack_require__(1),PageHeader=__webpack_require__(298),react=__webpack_require__(0),react_default=__webpack_require__.n(react),tabs=(__webpack_require__(89),__webpack_require__(33),__webpack_require__(104),__webpack_require__(564)),groupsAccessLogic=__webpack_require__(254),utils=__webpack_require__(10),groupsModel=__webpack_require__(128),groupsListLogic=__webpack_require__(4350);function GroupsTabs(){var setTab=Object(index_esm.useActions)(groupsListLogic.a).setTab,currentTab=Object(index_esm.useValues)(groupsListLogic.a).currentTab,_useValues2=Object(index_esm.useValues)(groupsModel.a),groupTypes=_useValues2.groupTypes,aggregationLabel=_useValues2.aggregationLabel,groupsAccessStatus=Object(index_esm.useValues)(groupsAccessLogic.b).groupsAccessStatus,showGroupsIntroductionPage=[groupsAccessLogic.a.HasAccess,groupsAccessLogic.a.HasGroupTypes,groupsAccessLogic.a.NoAccess].includes(groupsAccessStatus);return react_default.a.createElement(tabs.a,{activeKey:currentTab,onChange:function onChange(activeKey){return setTab(activeKey)}},react_default.a.createElement(tabs.a.TabPane,{tab:"Persons",key:"-1"}),showGroupsIntroductionPage?react_default.a.createElement(tabs.a.TabPane,{tab:"Introducing Group Analytics",key:"0"}):groupTypes.map((function(groupType){return react_default.a.createElement(tabs.a.TabPane,{tab:Object(utils.j)(aggregationLabel(groupType.group_type_index).plural),key:groupType.group_type_index})})))}function PersonPageHeader(_ref){var hideGroupTabs=_ref.hideGroupTabs,showGroupsOptions=Object(index_esm.useValues)(groupsModel.a).showGroupsOptions;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(PageHeader.a,{title:"Persons".concat(showGroupsOptions?" & Groups":""),caption:"A catalog of your product's end users".concat(showGroupsOptions?" and groups":"",".")}),!hideGroupTabs&&showGroupsOptions&&react_default.a.createElement(GroupsTabs,null))}try{PersonPageHeader.displayName="PersonPageHeader",PersonPageHeader.__docgenInfo={description:"",displayName:"PersonPageHeader",props:{hideGroupTabs:{defaultValue:null,description:"",name:"hideGroupTabs",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"]={docgenInfo:PersonPageHeader.__docgenInfo,name:"PersonPageHeader",path:"frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"})}catch(__react_docgen_typescript_loader_error){}},4403:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene})),__webpack_require__.d(__webpack_exports__,"Persons",(function(){return Persons_Persons}));var react=__webpack_require__(0),react_default=__webpack_require__.n(react),index_esm=__webpack_require__(1),toConsumableArray=(__webpack_require__(42),__webpack_require__(118),__webpack_require__(15)),toConsumableArray_default=__webpack_require__.n(toConsumableArray),TimezoneAware=__webpack_require__(317),PropertiesTable=__webpack_require__(912),CopyToClipboard=(__webpack_require__(4355),__webpack_require__(649)),PersonHeader=__webpack_require__(341),LemonTable=__webpack_require__(242);function PersonsTable(_ref){var people=_ref.people,_ref$loading=_ref.loading,loading=void 0!==_ref$loading&&_ref$loading,hasPrevious=_ref.hasPrevious,hasNext=_ref.hasNext,loadPrevious=_ref.loadPrevious,loadNext=_ref.loadNext,compact=_ref.compact,columns=[{title:"Person",key:"person",render:function Render(_,person){return react_default.a.createElement(PersonHeader.a,{withIcon:!0,person:person})}},{title:"ID",key:"id",render:function Render(_,person){return react_default.a.createElement("div",{style:{overflow:"hidden"}},person.distinct_ids.length&&react_default.a.createElement(CopyToClipboard.a,{explicitValue:person.distinct_ids[0],iconStyle:{color:"var(--primary)"},description:"person distinct ID"},person.distinct_ids[0]))}}].concat(toConsumableArray_default()(compact?[]:[{title:"First seen",dataIndex:"created_at",render:function Render(created_at){return created_at?react_default.a.createElement(TimezoneAware.b,{time:created_at}):react_default.a.createElement(react_default.a.Fragment,null)}}]));return react_default.a.createElement(LemonTable.a,{columns:columns,loading:loading,rowKey:"id",pagination:{controlled:!0,pageSize:100,onForward:hasNext?function(){null==loadNext||loadNext(),window.scrollTo(0,0)}:void 0,onBackward:hasPrevious?function(){null==loadPrevious||loadPrevious(),window.scrollTo(0,0)}:void 0},expandable:{expandedRowRender:function RenderPropertiesTable(_ref2){var properties=_ref2.properties;return Object.keys(properties).length?react_default.a.createElement(PropertiesTable.a,{properties:properties}):"This person has no properties."}},dataSource:people,emptyState:"No persons",nouns:["person","persons"]})}try{PersonsTable.displayName="PersonsTable",PersonsTable.__docgenInfo={description:"",displayName:"PersonsTable",props:{people:{defaultValue:null,description:"",name:"people",required:!0,type:{name:"PersonType[]"}},loading:{defaultValue:{value:"false"},description:"",name:"loading",required:!1,type:{name:"boolean"}},hasPrevious:{defaultValue:null,description:"",name:"hasPrevious",required:!1,type:{name:"boolean"}},hasNext:{defaultValue:null,description:"",name:"hasNext",required:!1,type:{name:"boolean"}},loadPrevious:{defaultValue:null,description:"",name:"loadPrevious",required:!1,type:{name:"(() => void)"}},loadNext:{defaultValue:null,description:"",name:"loadNext",required:!1,type:{name:"(() => void)"}},compact:{defaultValue:null,description:"",name:"compact",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"]={docgenInfo:PersonsTable.__docgenInfo,name:"PersonsTable",path:"frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"})}catch(__react_docgen_typescript_loader_error){}var row=__webpack_require__(384),es_button=__webpack_require__(140),ExportOutlined=__webpack_require__(4344),personsLogic=__webpack_require__(1869),slicedToArray=(__webpack_require__(83),__webpack_require__(299),__webpack_require__(12)),slicedToArray_default=__webpack_require__.n(slicedToArray),input=__webpack_require__(507),LemonRow=__webpack_require__(199),icons=__webpack_require__(36),PersonsSearch_PersonsSearch=function PersonsSearch(_ref){var _ref$autoFocus=_ref.autoFocus,autoFocus=void 0===_ref$autoFocus||_ref$autoFocus,_useActions=Object(index_esm.useActions)(personsLogic.a),loadPersons=_useActions.loadPersons,setListFilters=_useActions.setListFilters,listFilters=Object(index_esm.useValues)(personsLogic.a).listFilters,_useState=Object(react.useState)(""),_useState2=slicedToArray_default()(_useState,2),searchTerm=_useState2[0],setSearchTerm=_useState2[1];return Object(react.useEffect)((function(){setSearchTerm(listFilters.search||"")}),[]),react_default.a.createElement("div",{style:{display:"flex",alignItems:"center",width:"min(100%, 24rem)"}},react_default.a.createElement(input.a.Search,{"data-attr":"persons-search",placeholder:"Search for persons",autoFocus:autoFocus,value:searchTerm,onChange:function onChange(e){setSearchTerm(e.target.value),e.target.value||(setListFilters({search:void 0}),loadPersons())},enterButton:!0,allowClear:!0,onSearch:function onSearch(){setListFilters({search:searchTerm||void 0}),loadPersons()},style:{width:"100%"}}),react_default.a.createElement(LemonRow.a,{type:"stealth",tooltip:react_default.a.createElement(react_default.a.Fragment,null,"Search by email, name, ID, or even contents of properties. You can also search for persons who just ",react_default.a.createElement("i",null,"have"),' a property like so: "has:your_property".'),icon:react_default.a.createElement(icons.IconInfo,null)}))};try{PersonsSearch_PersonsSearch.displayName="PersonsSearch",PersonsSearch_PersonsSearch.__docgenInfo={description:"",displayName:"PersonsSearch",props:{autoFocus:{defaultValue:{value:"true"},description:"",name:"autoFocus",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonsSearch.tsx#PersonsSearch"]={docgenInfo:PersonsSearch_PersonsSearch.__docgenInfo,name:"PersonsSearch",path:"frontend/src/scenes/persons/PersonsSearch.tsx#PersonsSearch"})}catch(__react_docgen_typescript_loader_error){}var PersonPageHeader=__webpack_require__(4360),PropertyFilters=__webpack_require__(316),types=__webpack_require__(39),scene={component:Persons_Persons,logic:personsLogic.a,paramsToProps:function paramsToProps(){return{syncWithUrl:!0}}};function Persons_Persons(){var _ref=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},cohort=_ref.cohort,personsLogicProps={cohort:null==cohort?void 0:cohort.id,syncWithUrl:!cohort},_useActions=Object(index_esm.useActions)(Object(personsLogic.a)(personsLogicProps)),loadPersons=_useActions.loadPersons,setListFilters=_useActions.setListFilters,_useValues=Object(index_esm.useValues)(Object(personsLogic.a)(personsLogicProps)),persons=_useValues.persons,listFilters=_useValues.listFilters,personsLoading=_useValues.personsLoading;return react_default.a.createElement(index_esm.BindLogic,{logic:personsLogic.a,props:personsLogicProps},react_default.a.createElement("div",{className:"persons-list"},react_default.a.createElement(PersonPageHeader.a,{hideGroupTabs:!!cohort}),react_default.a.createElement(row.a,{align:"middle",justify:"space-between",className:"mb",style:{gap:"0.75rem"}},react_default.a.createElement(PersonsSearch_PersonsSearch,{autoFocus:!cohort}),react_default.a.createElement("div",null,react_default.a.createElement(es_button.a,{type:"default",icon:react_default.a.createElement(ExportOutlined.a,null),href:"/api/person.csv"+(listFilters.cohort?"?cohort="+listFilters.cohort:""),style:{marginLeft:8}},"Export"))),react_default.a.createElement(PropertyFilters.a,{pageKey:"persons-list-page",propertyFilters:listFilters.properties,onChange:function onChange(properties){setListFilters({properties:properties}),loadPersons()},endpoint:"person",taxonomicGroupTypes:[types.a.PersonProperties,types.a.Cohorts],showConditionBadge:!0}),react_default.a.createElement(PersonsTable,{people:persons.results,loading:personsLoading,hasPrevious:!!persons.previous,hasNext:!!persons.next,loadPrevious:function loadPrevious(){return loadPersons(persons.previous)},loadNext:function loadNext(){return loadPersons(persons.next)}})))}try{Persons_Persons.displayName="Persons",Persons_Persons.__docgenInfo={description:"",displayName:"Persons",props:{cohort:{defaultValue:null,description:"",name:"cohort",required:!1,type:{name:"CohortType"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/Persons.tsx#Persons"]={docgenInfo:Persons_Persons.__docgenInfo,name:"Persons",path:"frontend/src/scenes/persons/Persons.tsx#Persons"})}catch(__react_docgen_typescript_loader_error){}}}]);