(window.webpackJsonp=window.webpackJsonp||[]).push([[312],{"./frontend/src/scenes/authentication/Login2FA.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Login2FA",(function(){return Login2FA}));var index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),preflightLogic=__webpack_require__("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),lib=__webpack_require__("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.0/node_modules/kea-forms/lib/index.js"),api=__webpack_require__("./frontend/src/lib/api.ts"),featureFlagLogic=__webpack_require__("./frontend/src/lib/logic/featureFlagLogic.ts"),loginLogic=__webpack_require__("./frontend/src/scenes/authentication/loginLogic.ts");let LoginStep;!function(LoginStep){LoginStep.LOGIN="login",LoginStep.TWO_FACTOR="two_factor"}(LoginStep||(LoginStep={}));const login2FALogic=Object(index_esm.kea)([Object(index_esm.path)(["scenes","authentication","login2FALogic"]),Object(index_esm.connect)({values:[preflightLogic.a,["preflight"],featureFlagLogic.a,["featureFlags"]]}),Object(index_esm.actions)({setGeneralError:(code,detail)=>({code:code,detail:detail}),setLoginStep:step=>({step:step}),clearGeneralError:!0}),Object(index_esm.reducers)({generalError:[null,{setGeneralError:(_,error)=>error,clearGeneralError:()=>null}]}),Object(lib.forms)((_ref=>{let{actions:actions}=_ref;return{twofactortoken:{defaults:{token:null},errors:_ref2=>{let{token:token}=_ref2;return{token:token?void 0:"Please enter a token to continued"}},submit:async(_ref3,breakpoint)=>{let{token:token}=_ref3;await breakpoint();try{return await api.b.create("api/login/token",{token:token})}catch(e){const{code:code}=e,{detail:detail}=e;throw actions.setGeneralError(code,detail),e}}}}})),Object(index_esm.listeners)({submitTwofactortokenSuccess:()=>{Object(loginLogic.a)(),window.location.reload()}})]);var Field=__webpack_require__("./frontend/src/lib/forms/Field.tsx"),AlertMessage=__webpack_require__("./frontend/src/lib/lemon-ui/AlertMessage/index.ts"),src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),BridgePage=__webpack_require__("./frontend/src/lib/components/BridgePage/BridgePage.tsx"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function Login2FA(){const{isTwofactortokenSubmitting:isTwofactortokenSubmitting,generalError:generalError}=Object(index_esm.useValues)(login2FALogic),{preflight:preflight}=Object(index_esm.useValues)(preflightLogic.a);return Object(jsx_runtime.jsx)(BridgePage.a,{view:"login",hedgehog:!0,message:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Welcome to",Object(jsx_runtime.jsx)("br",{})," PostHog",null!=preflight&&preflight.cloud?" Cloud":"","!"]}),children:Object(jsx_runtime.jsxs)("div",{className:"space-y-2",children:[Object(jsx_runtime.jsx)("h2",{children:"Two-Factor Authentication"}),Object(jsx_runtime.jsx)("p",{children:"Enter a token from your authenticator app."}),Object(jsx_runtime.jsxs)(lib.Form,{logic:login2FALogic,formKey:"twofactortoken",enableFormOnSubmit:!0,className:"space-y-4",children:[generalError&&Object(jsx_runtime.jsx)(AlertMessage.a,{type:"error",children:generalError.detail}),Object(jsx_runtime.jsx)(Field.a,{name:"token",label:"Authenticator token",children:Object(jsx_runtime.jsx)(src.LemonInput,{className:"ph-ignore-input",autoFocus:!0,"data-attr":"token",placeholder:"123456",type:"number",autoComplete:"one-time-code"})}),Object(jsx_runtime.jsx)(src.LemonButton,{htmlType:"submit","data-attr":"2fa-login",fullWidth:!0,type:"primary",center:!0,loading:isTwofactortokenSubmitting,children:"Login"})]})]})})}}}]);