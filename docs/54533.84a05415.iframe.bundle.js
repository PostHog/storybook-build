(self.webpackChunk_posthog_frontend=self.webpackChunk_posthog_frontend||[]).push([[54533],{"./frontend/src/lib/lemon-ui/ClampedText/ClampedText.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{n:()=>ClampedText});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),_Link__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./frontend/src/lib/lemon-ui/Link/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let isCssEllipsisApplied=elem=>elem.scrollHeight>elem.clientHeight,ClampedText=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef(function ClampedText(_ref,ref){let{lines,text}=_ref,[localLines,setLocalLines]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(lines),[isExpanded,setIsExpanded]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[showMore,setShowMore]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),handleToggleShowMore=show=>{setShowMore(!showMore),setIsExpanded(!isExpanded),setLocalLines(show?void 0:lines)};return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>setLocalLines(lines),[lines]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{ref:ref,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(TruncatedElement,{lines:localLines,ref:elem=>{elem&&(isCssEllipsisApplied(elem)?showMore&&isExpanded||setShowMore(!0):setShowMore(!1))},text:text}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{children:isExpanded||showMore?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_Link__WEBPACK_IMPORTED_MODULE_1__.r,{onClick:()=>handleToggleShowMore(!isExpanded),children:isExpanded?"Show less":"Show more"}):null})]})}),TruncatedElement=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef(function TruncatedElement(_ref2,ref){let{text,lines}=_ref2;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{style:lines?{overflow:"hidden",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:lines}:{},ref:ref,children:text})})},"./frontend/src/scenes/error-tracking/ErrorTrackingIssueScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ErrorTrackingIssueScene:()=>ErrorTrackingIssueScene,scene:()=>scene});var injectStylesIntoStyleTag=__webpack_require__("./node_modules/.pnpm/style-loader@2.0.0_webpack@5.88.2/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),ErrorTracking=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.5.2_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/scenes/error-tracking/ErrorTracking.scss"),ErrorTracking_default=__webpack_require__.n(ErrorTracking),options={};options.insert="head",options.singleton=!1,injectStylesIntoStyleTag_default()(ErrorTracking_default(),options),ErrorTracking_default().locals;var src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),PageHeader=__webpack_require__("./frontend/src/lib/components/PageHeader.tsx"),clsx_m=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),LemonMenu=__webpack_require__("./frontend/src/lib/lemon-ui/LemonMenu/LemonMenu.tsx"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function PanelLayout(_ref){let{className,...props}=_ref;return(0,jsx_runtime.jsx)(Container,{className:(0,clsx_m.default)(className,"PanelLayout"),...props,primary:!1})}function Container(_ref2){let{children,primary,className,column}=_ref2;return(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.default)("flex",primary&&"flex-1",column?"flex-col gap-y-4":"gap-x-2",primary?"PanelLayout__container--primary":"PanelLayout__container--secondary",className),children:children})}function Panel(_ref3){let{children,primary,className}=_ref3;return(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.default)(primary&&"flex-1","border bg-surface-primary rounded-sm",className),children:children})}function PanelSettings(_ref4){let{children,title,border}=_ref4;return(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.default)("flex flex-row w-full overflow-hidden bg-surface-primary items-center justify-between","bottom"===border&&"border-b","top"===border&&"border-t"),children:[title&&(0,jsx_runtime.jsx)("span",{className:"pl-1 font-medium",children:title}),(0,jsx_runtime.jsx)("div",{className:"flex font-light text-xs",children:children})]})}function SettingsMenu(_ref5){let{label,items,icon,isAvailable=!0,closeOnClickInside=!0,highlightWhenActive=!0,whenUnavailable,...props}=_ref5,active=items.some(cf=>!!cf.active);return(0,jsx_runtime.jsx)(LemonMenu.d6,{buttonSize:"xsmall",closeOnClickInside:closeOnClickInside,items:isAvailable?items:whenUnavailable?[whenUnavailable]:[],...props,children:(0,jsx_runtime.jsx)(src.Jp,{className:"rounded-[0px]",status:highlightWhenActive&&active?"danger":"default",size:"xsmall",icon:icon,children:label})})}function SettingsToggle(_ref6){let{tooltip,icon,label,active,...props}=_ref6,button=(0,jsx_runtime.jsx)(src.Jp,{className:"rounded-[0px]",icon:icon,size:"xsmall",status:active?"danger":"default",...props,children:label});return props.disabledReason?button:(0,jsx_runtime.jsx)(src.u,{title:tooltip,children:button})}function SettingsButton(props){return(0,jsx_runtime.jsx)(SettingsToggle,{active:!1,...props})}PanelLayout.Panel=Panel,PanelLayout.PanelSettings=PanelSettings,PanelLayout.Container=Container,PanelLayout.SettingsMenu=SettingsMenu,PanelLayout.SettingsToggle=SettingsToggle,PanelLayout.SettingsButton=SettingsButton;let PanelLayout_PanelLayout=PanelLayout;var react=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),AlphaAccessScenePrompt=__webpack_require__("./frontend/src/scenes/error-tracking/AlphaAccessScenePrompt.tsx"),AssigneeSelect=__webpack_require__("./frontend/src/scenes/error-tracking/AssigneeSelect.tsx"),ErrorTrackingFilters=__webpack_require__("./frontend/src/scenes/error-tracking/ErrorTrackingFilters.tsx"),errorTrackingIssueSceneLogic=__webpack_require__("./frontend/src/scenes/error-tracking/errorTrackingIssueSceneLogic.ts"),utils=__webpack_require__("./frontend/src/scenes/error-tracking/utils.ts");let Overview=()=>{let{issueProperties,issueLoading}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r),{synthetic,level,browser,os,library,unhandled}=(0,utils.OZ)(issueProperties),TableRow=_ref=>{let{label,value}=_ref;return(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{className:"text-secondary",children:label}),(0,jsx_runtime.jsx)("td",{children:null!=value?value:(0,jsx_runtime.jsx)("div",{className:"italic",children:"unknown"})})]})};return issueLoading?(0,jsx_runtime.jsxs)("div",{className:"space-y-2",children:[(0,jsx_runtime.jsx)(src.yW,{}),(0,jsx_runtime.jsx)(src.yW.Row,{repeat:2})]}):(0,jsx_runtime.jsx)("div",{className:"px-1",children:(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,jsx_runtime.jsx)("table",{children:[{label:"Level",value:level},{label:"Synthetic",value:synthetic},{label:"Library",value:library},{label:"Unhandled",value:unhandled}].map((row,index)=>(0,jsx_runtime.jsx)(TableRow,{...row},index))}),(0,jsx_runtime.jsx)("table",{children:[{label:"Browser",value:browser},{label:"OS",value:os},{label:"URL",value:issueProperties.$current_url}].map((row,index)=>(0,jsx_runtime.jsx)(TableRow,{...row},index))})]})})};var SessionRecordingPlayer=__webpack_require__("./frontend/src/scenes/session-recordings/player/SessionRecordingPlayer.tsx"),stackFrameLogic=__webpack_require__("./frontend/src/lib/components/Errors/stackFrameLogic.ts"),StackTraces=__webpack_require__("./frontend/src/lib/components/Errors/StackTraces.tsx"),Query=__webpack_require__("./frontend/src/queries/Query/Query.tsx");let EventsTab=()=>{let{eventsQuery}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r);return(0,jsx_runtime.jsx)(Query.A,{query:eventsQuery,context:{columns:{"recording_button(properties.$session_id)":{title:"Recording",width:"134px"}},showOpenEditorButton:!1,insightProps:{dashboardItemId:"new-ErrorTrackingEventsQuery"}}})},PANELS=[{key:"stacktrace",Content:()=>{let{issueProperties}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r),{showAllFrames}=(0,index_esm.useValues)(stackFrameLogic.e),{exceptionList}=(0,utils.OZ)(issueProperties),hasAnyInApp=(0,utils.EQ)(exceptionList);return(0,jsx_runtime.jsx)(StackTraces.v,{showAllFrames:!hasAnyInApp||showAllFrames,exceptionList:exceptionList})},Header:_ref=>{let{active}=_ref,{issueProperties}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r),{showAllFrames}=(0,index_esm.useValues)(stackFrameLogic.e),{setShowAllFrames}=(0,index_esm.useActions)(stackFrameLogic.e),{exceptionList}=(0,utils.OZ)(issueProperties),hasAnyInApp=(0,utils.EQ)(exceptionList);return(0,jsx_runtime.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,jsx_runtime.jsx)("span",{children:"Stack trace"}),active&&hasAnyInApp?(0,jsx_runtime.jsx)(src.P4,{onChange:(value,e)=>{setShowAllFrames("full"===value),e.stopPropagation()},value:showAllFrames?"full":"in-app",options:[{value:"in-app",label:"In app only"},{value:"full",label:"Show full stack"}],size:"xsmall"}):null]})},hasContent:_ref2=>{let{hasStack}=_ref2;return hasStack}},{key:"recording",Content:()=>{let{issueProperties}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r);return(0,jsx_runtime.jsx)(SessionRecordingPlayer.d,{playerKey:"issue",sessionRecordingId:issueProperties.$session_id,noMeta:!0,noBorder:!0,autoPlay:!0,noInspector:!0,matchingEventsMatchType:{matchType:"name",eventNames:["$exception"]}})},Header:"Recording",hasContent:_ref=>{let{hasRecording}=_ref;return hasRecording},className:"p-0"}],Events=()=>{let{issueProperties,eventsMode}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r),{setEventsMode}=(0,index_esm.useActions)(errorTrackingIssueSceneLogic.r),[activeKeys,setActiveKeys]=(0,react.useState)(["stacktrace"]),{exceptionList}=(0,utils.OZ)(issueProperties),hasStack=(0,utils.mX)(exceptionList),hasRecording=issueProperties.$session_id&&"active"===issueProperties.$recording_status,panels=PANELS.filter(_ref=>{let{hasContent}=_ref;return hasContent({hasStack,hasRecording})}).map(_ref2=>{let{key,Header,Content,className}=_ref2;return{key,content:(0,jsx_runtime.jsx)(Content,{}),header:"string"==typeof Header?Header:(0,jsx_runtime.jsx)(Header,{active:activeKeys.includes(key)}),className}});return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(PanelLayout_PanelLayout.PanelSettings,{title:"Events",border:"bottom",children:(0,jsx_runtime.jsx)(SettingsButton,{label:eventsMode===errorTrackingIssueSceneLogic.F.All?"Close":"View all events",active:!0,onClick:()=>setEventsMode(eventsMode===errorTrackingIssueSceneLogic.F.All?errorTrackingIssueSceneLogic.F.Latest:errorTrackingIssueSceneLogic.F.All)})}),eventsMode===errorTrackingIssueSceneLogic.F.All?(0,jsx_runtime.jsx)(EventsTab,{}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Overview,{}),(0,jsx_runtime.jsx)(src.p2,{className:"mt-2 mb-0"}),panels.length>0&&(0,jsx_runtime.jsx)(src.JL,{embedded:!0,multiple:!0,activeKeys:activeKeys,onChange:setActiveKeys,panels:panels})]})]})};var posthog_icons_es=__webpack_require__("./node_modules/.pnpm/@posthog+icons@0.10.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),TZLabel=__webpack_require__("./frontend/src/lib/components/TZLabel/index.tsx"),ClampedText=__webpack_require__("./frontend/src/lib/lemon-ui/ClampedText/ClampedText.tsx"),lib_utils=__webpack_require__("./frontend/src/lib/utils.tsx");let Metadata=()=>{let{issue}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r),hasSessionCount=issue&&issue.aggregations&&0!==issue.aggregations.sessions,Count=_ref=>{let{value}=_ref;return issue&&issue.aggregations?(0,jsx_runtime.jsx)("div",{className:"text-2xl font-semibold",children:value?(0,lib_utils.d$)(value):"-"}):(0,jsx_runtime.jsx)("div",{className:"flex flex-1 items-center",children:(0,jsx_runtime.jsx)(src.yW,{})})},Sessions=(0,jsx_runtime.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,jsx_runtime.jsxs)("div",{className:"flex text-muted text-xs space-x-px",children:[(0,jsx_runtime.jsx)("span",{children:"Sessions"}),!hasSessionCount&&(0,jsx_runtime.jsx)(posthog_icons_es.IconInfo,{className:"mt-0.5"})]}),(0,jsx_runtime.jsx)(Count,{value:issue?.aggregations?.sessions})]});return(0,jsx_runtime.jsxs)("div",{className:"space-y-1",children:[issue&&issue.description?(0,jsx_runtime.jsx)(ClampedText.n,{text:issue.description,lines:2}):(0,jsx_runtime.jsx)(src.yW,{}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-1 justify-between",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-end space-x-6",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{className:"text-muted text-xs",children:"First seen"}),issue?(0,jsx_runtime.jsx)(TZLabel.w,{time:issue.first_seen,className:"border-dotted border-b"}):(0,jsx_runtime.jsx)(src.yW,{})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{className:"text-muted text-xs",children:"Last seen"}),issue&&issue.last_seen?(0,jsx_runtime.jsx)(TZLabel.w,{time:issue.last_seen,className:"border-dotted border-b"}):(0,jsx_runtime.jsx)(src.yW,{})]})]}),(0,jsx_runtime.jsxs)("div",{className:"flex space-x-2 gap-8 items-end",children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,jsx_runtime.jsx)("div",{className:"text-muted text-xs",children:"Occurrences"}),(0,jsx_runtime.jsx)(Count,{value:issue?.aggregations?.occurrences})]}),hasSessionCount?Sessions:(0,jsx_runtime.jsx)(src.u,{title:"No $session_id was set for any event in this issue",delayMs:0,children:Sessions}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,jsx_runtime.jsx)("div",{className:"text-muted text-xs",children:"Users"}),(0,jsx_runtime.jsx)(Count,{value:issue?.aggregations?.users})]})]})]})]})};var Sparkline=__webpack_require__("./frontend/src/lib/components/Sparkline.tsx"),errorTrackingLogic=__webpack_require__("./frontend/src/scenes/error-tracking/errorTrackingLogic.ts");let SparklinePanel=()=>{let{customSparklineConfig}=(0,index_esm.useValues)(errorTrackingLogic.HT),{issue}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r);if(!customSparklineConfig)return null;let labels=(0,utils.Gu)(customSparklineConfig),data=issue?.aggregations?.customVolume||Array(labels.length).fill(0);return(0,jsx_runtime.jsx)(Sparkline.b,{loading:!issue?.aggregations?.customVolume,className:"h-16 w-full",data:data,labels:labels})},scene={component:ErrorTrackingIssueScene,logic:errorTrackingIssueSceneLogic.r,paramsToProps:_ref=>{let{params:{id},searchParams:{fingerprint}}=_ref;return{id,fingerprint}}},STATUS_LABEL={active:"Active",archived:"Archived",resolved:"Resolved",pending_release:"Pending release"};function ErrorTrackingIssueScene(){let{issue}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r),{updateIssue,initIssue}=(0,index_esm.useActions)(errorTrackingIssueSceneLogic.r);return(0,react.useEffect)(()=>{initIssue()},[]),(0,jsx_runtime.jsx)(AlphaAccessScenePrompt._,{children:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(PageHeader.m,{buttons:!!issue&&("active"===issue.status?(0,jsx_runtime.jsxs)("div",{className:"flex divide-x gap-x-2",children:[(0,jsx_runtime.jsx)(AssigneeSelect.i,{assignee:issue.assignee,onChange:assignee=>updateIssue({assignee}),type:"secondary",showName:!0}),(0,jsx_runtime.jsxs)("div",{className:"flex pl-2 gap-x-2",children:[(0,jsx_runtime.jsx)(src.Jp,{type:"secondary",onClick:()=>updateIssue({status:"archived"}),children:"Archive"}),(0,jsx_runtime.jsx)(src.Jp,{type:"primary",onClick:()=>updateIssue({status:"resolved"}),children:"Resolve"})]})]}):(0,jsx_runtime.jsx)(src.Jp,{type:"secondary",className:"upcasefirst-letter:uppercase",onClick:()=>updateIssue({status:"active"}),tooltip:"Mark as active",children:STATUS_LABEL[issue.status]}))}),issue?(0,jsx_runtime.jsxs)("div",{className:"ErrorTrackingIssue",children:[(0,jsx_runtime.jsx)(Metadata,{}),(0,jsx_runtime.jsx)(src.p2,{className:"my-4"}),(0,jsx_runtime.jsx)(PanelLayout_PanelLayout,{children:(0,jsx_runtime.jsxs)(PanelLayout_PanelLayout.Container,{column:!0,primary:!0,children:[(0,jsx_runtime.jsx)(ErrorTrackingFilters.n,{}),(0,jsx_runtime.jsx)(SparklinePanel,{}),(0,jsx_runtime.jsx)(PanelLayout_PanelLayout.Panel,{primary:!0,children:(0,jsx_runtime.jsx)(Events,{})})]})})]}):(0,jsx_runtime.jsx)(src.$j,{})]})})}},"./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.5.2_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/scenes/error-tracking/ErrorTracking.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".ErrorTracking__issue{height:calc(100vh - 12rem);min-height:25rem}.ErrorTrackingIssue .SessionRecordingPlayer{height:24rem}.ErrorTrackingIssue .LemonCollapsePanel>.LemonButton:hover:has(.LemonSegmentedButton:hover){background-color:inherit}",""]),module.exports=exports}}]);