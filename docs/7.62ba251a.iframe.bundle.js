(window.webpackJsonp=window.webpackJsonp||[]).push([[7,8,9,307],{"./frontend/src/scenes/apps/AppMetricsGraph.scss":function(D,l,e){"use strict";e.r(l);var m=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),u=e.n(m),E=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/apps/AppMetricsGraph.scss"),i=e.n(E),j={};j.insert="head",j.singleton=!1;var v=u()(i.a,j);l.default=i.a.locals||{}},"./frontend/src/scenes/apps/AppMetricsGraph.tsx":function(D,l,e){"use strict";e.r(l),e.d(l,"AppMetricsGraph",function(){return O});var m=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),u=e.n(m),E=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),i=e.n(E),j=e("./node_modules/core-js/modules/es.array.concat.js"),v=e.n(j),h=e("./node_modules/core-js/modules/es.object.keys.js"),G=e.n(h),R=e("./node_modules/core-js/modules/es.symbol.js"),F=e.n(R),B=e("./node_modules/core-js/modules/es.array.filter.js"),H=e.n(B),K=e("./node_modules/core-js/modules/es.object.to-string.js"),$=e.n(K),U=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),N=e.n(U),W=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),V=e.n(W),x=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),J=e.n(x),C=e("./node_modules/react/index.js"),Y=e.n(C),p=e("./frontend/src/lib/colors.ts"),I=e("./node_modules/chart.js/dist/chart.mjs"),S=e("./frontend/src/scenes/apps/constants.tsx"),A=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),b=e("./frontend/src/scenes/apps/AppMetricsGraph.scss"),g=e("./frontend/src/lib/utils.tsx"),f=e("./node_modules/react/jsx-runtime.js"),Z=e.n(f);function L(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);r&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,o)}return s}function c(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?L(Object(s),!0).forEach(function(o){u()(t,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):L(Object(s)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(s,o))})}return t}function O(t){var r=t.tab,s=t.metrics,o=t.metricsLoading,n=Object(C.useRef)(null),_=S.DescriptionColumns[r];return Object(C.useEffect)(function(){var d;if(n.current&&s){var a;d=new I.a((a=n.current)===null||a===void 0?void 0:a.getContext("2d"),{type:"line",data:{labels:s.dates,datasets:[c({label:_.successes,data:s.successes,borderColor:""},y("data-brand-blue"))].concat(i()(_.successes_on_retry?[c({label:_.successes_on_retry,data:s.successes_on_retry},y("data-yellow"))]:[]),[c({label:_.failures,data:s.failures},y("data-pink"))])},options:{scales:{x:{ticks:{maxRotation:0},grid:{display:!1}},y:{beginAtZero:!0}},plugins:{crosshair:!1,legend:{display:!1}},maintainAspectRatio:!1,interaction:{mode:"index",axis:"x",intersect:!1}}})}return function(){var M;(M=d)===null||M===void 0||M.destroy()}},[s]),o||!s?Object(f.jsx)(A.a,{className:"AppMetricsGraph"}):Object(f.jsx)("div",{className:"AppMetricsGraph",children:Object(f.jsx)("canvas",{ref:n})})}function y(t){var r=Object(p.b)(t);return{borderColor:r,hoverBorderColor:Object(g.lb)(r,-20),hoverBackgroundColor:Object(g.lb)(r,-20),backgroundColor:r,fill:!1,borderWidth:2,pointRadius:0}}try{O.displayName="AppMetricsGraph",O.__docgenInfo={description:"",displayName:"AppMetricsGraph",props:{tab:{defaultValue:null,description:"",name:"tab",required:!0,type:{name:"enum",value:[{value:'"processEvent"'},{value:'"onEvent"'},{value:'"exportEvents"'},{value:'"historical_exports"'}]}},metrics:{defaultValue:null,description:"",name:"metrics",required:!0,type:{name:"AppMetrics | null"}},metricsLoading:{defaultValue:null,description:"",name:"metricsLoading",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/apps/AppMetricsGraph.tsx#AppMetricsGraph"]={docgenInfo:O.__docgenInfo,name:"AppMetricsGraph",path:"frontend/src/scenes/apps/AppMetricsGraph.tsx#AppMetricsGraph"})}catch(t){}},"./frontend/src/scenes/apps/appMetricsSceneLogic.ts":function(D,l,e){"use strict";e.r(l),e.d(l,"AppMetricsTab",function(){return c}),e.d(l,"appMetricsSceneLogic",function(){return y});var m=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),u=e.n(m),E=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),i=e.n(E),j=e("./node_modules/@babel/runtime/regenerator/index.js"),v=e.n(j),h=e("./node_modules/core-js/modules/es.array.iterator.js"),G=e.n(h),R=e("./node_modules/core-js/modules/es.object.to-string.js"),F=e.n(R),B=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),H=e.n(B),K=e("./node_modules/core-js/modules/es.array.concat.js"),$=e.n(K),U=e("./node_modules/core-js/modules/es.function.name.js"),N=e.n(U),W=e("./node_modules/core-js/modules/es.array.includes.js"),V=e.n(W),x=e("./node_modules/core-js/modules/es.string.includes.js"),J=e.n(x),C=e("./node_modules/core-js/modules/es.array.filter.js"),Y=e.n(C),p=e("./node_modules/kea/lib/index.esm.js"),I=e("./node_modules/kea-loaders/lib/index.js"),S=e.n(I),A=e("./frontend/src/scenes/urls.ts"),b=e("./frontend/src/lib/api.ts"),g=e("./frontend/src/scenes/teamLogic.tsx"),f=e("./node_modules/kea-router/lib/index.js"),Z=e.n(f),L=e("./frontend/src/lib/utils.tsx"),c;(function(t){t.ProcessEvent="processEvent",t.OnEvent="onEvent",t.ExportEvents="exportEvents",t.HistoricalExports="historical_exports"})(c||(c={}));var O=[c.ProcessEvent,c.OnEvent,c.ExportEvents],y=Object(p.kea)([Object(p.path)(function(t){return["scenes","apps","appMetricsSceneLogic",t]}),Object(p.props)({}),Object(p.key)(function(t){return t.pluginConfigId}),Object(p.actions)({setActiveTab:function(r){return{tab:r}},setDateFrom:function(r){return{dateFrom:r}}}),Object(p.reducers)({activeTab:[null,{setActiveTab:function(r,s){var o=s.tab;return o}}],dateFrom:["-30d",{setDateFrom:function(r,s){var o=s.dateFrom;return o}}]}),Object(I.loaders)(function(t){var r=t.values,s=t.props;return{pluginConfig:[null,{loadPluginConfig:function(){var o=i()(v.a.mark(function _(){return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,b.b.get("api/projects/".concat(g.a.values.currentTeamId,"/plugin_configs/").concat(s.pluginConfigId));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},_)}));function n(){return o.apply(this,arguments)}return n}()}],metrics:[null,{loadMetrics:function(){var o=i()(v.a.mark(function _(){var d,a,M;return v.a.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return d=Object(L.Eb)({category:r.activeTab,date_from:r.dateFrom}),T.next=3,b.b.get("api/projects/".concat(g.a.values.currentTeamId,"/app_metrics/").concat(s.pluginConfigId,"?").concat(d));case 3:return a=T.sent,M=a.results,T.abrupt("return",M);case 6:case"end":return T.stop()}},_)}));function n(){return o.apply(this,arguments)}return n}()}],historicalExports:[[],{loadHistoricalExports:function(){var o=i()(v.a.mark(function _(){var d,a;return v.a.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,b.b.get("api/projects/".concat(g.a.values.currentTeamId,"/app_metrics/").concat(s.pluginConfigId,"/historical_exports"));case 2:return d=P.sent,a=d.results,P.abrupt("return",a);case 5:case"end":return P.stop()}},_)}));function n(){return o.apply(this,arguments)}return n}()}]}}),Object(p.selectors)(function(t){var r=t.values;return{breadcrumbs:[function(s){return[s.pluginConfig,function(o,n){return n.pluginConfigId}]},function(s,o){var n;return[{name:"Apps",path:A.a.projectApps()},{name:s==null||(n=s.plugin_info)===null||n===void 0?void 0:n.name,path:A.a.appMetrics(o)}]}],showTab:[function(){return[]},function(){return function(s){var o;if(r.pluginConfigLoading||!r.pluginConfig)return!1;var n=((o=r.pluginConfig.plugin_info.capabilities)===null||o===void 0?void 0:o.methods)||[];return s===c.HistoricalExports?n.includes("exportEvents"):s===c.OnEvent&&n.includes("exportEvents")?!1:n.includes(s)}}]}}),Object(p.listeners)(function(t){var r=t.values,s=t.actions;return{loadPluginConfigSuccess:function(){if(!r.activeTab){var n=O.filter(function(a){return r.showTab(a)}),_=u()(n,1),d=_[0];s.setActiveTab(d)}},setActiveTab:function(n){var _=n.tab;_===c.HistoricalExports?s.loadHistoricalExports():s.loadMetrics()},setDateFrom:function(){s.loadMetrics()}}}),Object(f.actionToUrl)(function(t){var r=t.values,s=t.props;return{setActiveTab:function(){var n;return r.activeTab===c.HistoricalExports?A.a.appHistoricalExports(s.pluginConfigId):A.a.appMetrics(s.pluginConfigId,(n=r.activeTab)!==null&&n!==void 0?n:void 0)}}}),Object(f.urlToAction)(function(t){var r=t.values,s=t.actions;return{"/app/:pluginConfigId/:page":function(n,_){r.pluginConfig||s.loadPluginConfig(),n.page===c.HistoricalExports?s.setActiveTab(c.HistoricalExports):_.tab&&O.includes(_.tab)&&s.setActiveTab(_.tab)}}})])},"./frontend/src/scenes/apps/constants.tsx":function(D,l,e){"use strict";e.r(l),e.d(l,"DescriptionColumns",function(){return j});var m=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),u=e.n(m),E=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),i,j=(i={},u()(i,E.AppMetricsTab.ProcessEvent,{successes:"Events processed",failures:"Failed events"}),u()(i,E.AppMetricsTab.OnEvent,{successes:"Events processed",successes_on_retry:"Events processed on retry",failures:"Failed events"}),u()(i,E.AppMetricsTab.ExportEvents,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),u()(i,E.AppMetricsTab.HistoricalExports,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),i)},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/apps/AppMetricsGraph.scss":function(D,l,e){var m=e("./node_modules/css-loader/dist/runtime/api.js");l=m(!1),l.push([D.i,".AppMetricsGraph{height:300px}",""]),D.exports=l}}]);
