(window.webpackJsonp=window.webpackJsonp||[]).push([[7,10],{"./frontend/src/scenes/apps/ErrorDetailsDrawer.tsx":function(Q,p,e){"use strict";e.r(p),e.d(p,"ErrorDetailsDrawer",function(){return V});var L=e("./node_modules/core-js/modules/es.object.keys.js"),F=e.n(L),I=e("./node_modules/core-js/modules/es.symbol.js"),M=e.n(I),y=e("./node_modules/core-js/modules/es.array.filter.js"),O=e.n(y),B=e("./node_modules/core-js/modules/es.object.to-string.js"),X=e.n(B),K=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Y=e.n(K),R=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Z=e.n(R),U=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),k=e.n(U),W=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),H=e.n(W),h=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),J=e.n(h),g=e("./node_modules/kea/lib/index.esm.js"),C=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),x=e("./frontend/src/lib/components/Drawer.tsx"),N=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),S=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),$=e("./frontend/src/lib/components/PaginationControl/index.tsx"),E=e("./node_modules/antd/es/tabs/index.js"),D=e("./frontend/src/lib/components/LemonLabel/LemonLabel.tsx"),b=e("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),n=e("./node_modules/react/jsx-runtime.js"),T=e.n(n);function v(a,c){var l=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);c&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),l.push.apply(l,r)}return l}function f(a){for(var c=1;c<arguments.length;c++){var l=arguments[c]!=null?arguments[c]:{};c%2?v(Object(l),!0).forEach(function(r){H()(a,r,l[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(l)):v(Object(l)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(l,r))})}return a}function V(){var a=Object(g.useValues)(C.appMetricsSceneLogic),c=a.errorDetailsDrawerError,l=a.errorDetailsLoading,r=Object(g.useActions)(C.appMetricsSceneLogic),s=r.closeErrorDetailsDrawer;return Object(n.jsx)(x.a,{visible:!!c,onClose:s,title:"Viewing error details: ".concat(c),width:"min(50vw, 80rem)",destroyOnClose:!0,children:l?Object(n.jsx)(N.a,{className:"h-10"}):Object(n.jsx)(A,{})})}function A(){var a=Object(g.useValues)(C.appMetricsSceneLogic),c=a.errorDetails,l=Object($.c)(c,{pageSize:1}),r=J()(l.dataSourcePage,1),s=r[0];return Object(n.jsxs)("div",{children:[Object(n.jsx)($.a,f(f({},l),{},{nouns:["sample error","sample errors"]})),Object(n.jsxs)(E.a,{children:[Object(n.jsxs)(E.a.TabPane,{tab:"Overview",children:[Object(n.jsxs)("div",{children:[Object(n.jsx)(D.a,{children:"Error:"})," ",s.error_type]}),s.error_details.error.message&&Object(n.jsxs)("div",{children:[Object(n.jsx)(D.a,{children:"Error message:"})," ",s.error_details.error.message]}),Object(n.jsxs)("div",{children:[Object(n.jsx)(D.a,{children:"When:"})," ",Object(n.jsx)(S.b,{time:s.timestamp,showSeconds:!0})]}),s.error_details.eventCount&&Object(n.jsxs)("div",{children:[Object(n.jsx)(D.a,{children:"Event count:"})," ",s.error_details.eventCount]})]},"overview"),s.error_details.event&&Object(n.jsx)(E.a.TabPane,{tab:"Event",children:Object(n.jsx)(b.a,{language:b.b.JSON,children:JSON.stringify(s.error_details.event,null,2)})},"event"),s.error_details.error.stack&&Object(n.jsx)(E.a.TabPane,{tab:"Stack trace",children:Object(n.jsx)(b.a,{wrap:!0,language:b.b.JavaScript,children:s.error_details.error.stack})},"stacktrace")]})]})}},"./frontend/src/scenes/apps/appMetricsSceneLogic.ts":function(Q,p,e){"use strict";e.r(p),e.d(p,"AppMetricsTab",function(){return a}),e.d(p,"appMetricsSceneLogic",function(){return l});var L=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),F=e.n(L),I=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),M=e.n(I),y=e("./node_modules/@babel/runtime/regenerator/index.js"),O=e.n(y),B=e("./node_modules/core-js/modules/es.array.iterator.js"),X=e.n(B),K=e("./node_modules/core-js/modules/es.object.to-string.js"),Y=e.n(K),R=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Z=e.n(R),U=e("./node_modules/core-js/modules/es.array.concat.js"),k=e.n(U),W=e("./node_modules/core-js/modules/es.function.name.js"),H=e.n(W),h=e("./node_modules/core-js/modules/es.array.includes.js"),J=e.n(h),g=e("./node_modules/core-js/modules/es.string.includes.js"),C=e.n(g),x=e("./node_modules/core-js/modules/es.array.filter.js"),N=e.n(x),S=e("./node_modules/core-js/modules/es.number.constructor.js"),$=e.n(S),E=e("./node_modules/kea/lib/index.esm.js"),D=e("./node_modules/kea-loaders/lib/index.js"),b=e.n(D),n=e("./frontend/src/scenes/urls.ts"),T=e("./frontend/src/lib/api.ts"),v=e("./frontend/src/scenes/teamLogic.tsx"),f=e("./node_modules/kea-router/lib/index.js"),V=e.n(f),A=e("./frontend/src/lib/utils.tsx"),a;(function(r){r.ProcessEvent="processEvent",r.OnEvent="onEvent",r.ExportEvents="exportEvents",r.HistoricalExports="historical_exports"})(a||(a={}));var c=[a.ProcessEvent,a.OnEvent,a.ExportEvents],l=Object(E.kea)([Object(E.path)(function(r){return["scenes","apps","appMetricsSceneLogic",r]}),Object(E.props)({}),Object(E.key)(function(r){return r.pluginConfigId}),Object(E.actions)({setActiveTab:function(s){return{tab:s}},setDateFrom:function(s){return{dateFrom:s}},openErrorDetailsDrawer:function(s,t,o){return{errorType:s,category:t,jobId:o}},closeErrorDetailsDrawer:!0}),Object(E.reducers)({activeTab:[null,{setActiveTab:function(s,t){var o=t.tab;return o}}],dateFrom:["-30d",{setDateFrom:function(s,t){var o=t.dateFrom;return o}}],errorDetailsDrawerError:[null,{openErrorDetailsDrawer:function(s,t){var o=t.errorType;return o},closeErrorDetailsDrawer:function(){return null}}]}),Object(D.loaders)(function(r){var s=r.values,t=r.props;return{pluginConfig:[null,{loadPluginConfig:function(){var o=M()(O.a.mark(function u(){return O.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,T.b.get("api/projects/".concat(v.a.values.currentTeamId,"/plugin_configs/").concat(t.pluginConfigId));case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},u)}));function _(){return o.apply(this,arguments)}return _}()}],appMetricsResponse:[null,{loadMetrics:function(){var o=M()(O.a.mark(function u(){var i;return O.a.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return i=Object(A.Eb)({category:s.activeTab,date_from:s.dateFrom}),j.next=3,T.b.get("api/projects/".concat(v.a.values.currentTeamId,"/app_metrics/").concat(t.pluginConfigId,"?").concat(i));case 3:return j.abrupt("return",j.sent);case 4:case"end":return j.stop()}},u)}));function _(){return o.apply(this,arguments)}return _}()}],historicalExports:[[],{loadHistoricalExports:function(){var o=M()(O.a.mark(function u(){var i,d;return O.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,T.b.get("api/projects/".concat(v.a.values.currentTeamId,"/app_metrics/").concat(t.pluginConfigId,"/historical_exports"));case 2:return i=m.sent,d=i.results,m.abrupt("return",d);case 5:case"end":return m.stop()}},u)}));function _(){return o.apply(this,arguments)}return _}()}],errorDetails:[[],{openErrorDetailsDrawer:function(){var o=M()(O.a.mark(function u(i){var d,j,m,z,G,w;return O.a.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return d=i.category,j=i.jobId,m=i.errorType,z=Object(A.Eb)({category:d,job_id:j,error_type:m}),P.next=4,T.b.get("api/projects/".concat(v.a.values.currentTeamId,"/app_metrics/").concat(t.pluginConfigId,"/error_details?").concat(z));case 4:return G=P.sent,w=G.result,P.abrupt("return",w);case 7:case"end":return P.stop()}},u)}));function _(u){return o.apply(this,arguments)}return _}()}]}}),Object(E.selectors)(function(r){var s=r.values;return{breadcrumbs:[function(t){return[t.pluginConfig,function(o,_){return _.pluginConfigId}]},function(t,o){var _;return[{name:"Apps",path:n.a.projectApps()},{name:t==null||(_=t.plugin_info)===null||_===void 0?void 0:_.name,path:n.a.appMetrics(o)}]}],showTab:[function(){return[]},function(){return function(t){var o;if(s.pluginConfigLoading||!s.pluginConfig)return!1;var _=((o=s.pluginConfig.plugin_info.capabilities)===null||o===void 0?void 0:o.methods)||[];return t===a.HistoricalExports?_.includes("exportEvents"):t===a.OnEvent&&_.includes("exportEvents")?!1:_.includes(t)}}]}}),Object(E.listeners)(function(r){var s=r.values,t=r.actions;return{loadPluginConfigSuccess:function(){if(!s.activeTab){var _=c.filter(function(d){return s.showTab(d)}),u=F()(_,1),i=u[0];t.setActiveTab(i)}},setActiveTab:function(_){var u=_.tab;u===a.HistoricalExports?t.loadHistoricalExports():t.loadMetrics()},setDateFrom:function(){t.loadMetrics()}}}),Object(f.actionToUrl)(function(r){var s=r.values,t=r.props;return{setActiveTab:function(){var _;return s.activeTab===a.HistoricalExports?n.a.appHistoricalExports(t.pluginConfigId):n.a.appMetrics(t.pluginConfigId,(_=s.activeTab)!==null&&_!==void 0?_:void 0)}}}),Object(f.urlToAction)(function(r){var s=r.values,t=r.actions,o=r.props;return{"/app/:pluginConfigId/:page":function(u,i){o.pluginConfigId===Number(u.pluginConfigId)&&(s.pluginConfig||t.loadPluginConfig(),u.page===a.HistoricalExports?t.setActiveTab(a.HistoricalExports):i.tab&&c.includes(i.tab)&&t.setActiveTab(i.tab))}}})])}}]);
