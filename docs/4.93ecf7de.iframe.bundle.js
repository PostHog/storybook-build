(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"./frontend/src/lib/components/ExportButton/ExportButton.tsx":function(z,E,e){"use strict";e.d(E,"a",function(){return s});var S=e("./node_modules/@babel/runtime/helpers/extends.js"),de=e.n(S),R=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),t=e.n(R),c=e("./node_modules/core-js/modules/es.array.map.js"),v=e.n(c),$=e("./node_modules/core-js/modules/es.regexp.exec.js"),le=e.n($),se=e("./node_modules/core-js/modules/es.string.split.js"),Le=e.n(se),J=e("./node_modules/react/index.js"),W=e.n(J),V=e("./frontend/src/lib/components/LemonButton/index.ts"),H=e("./node_modules/kea/lib/index.esm.js"),B=e("./frontend/src/lib/components/ExportButton/exporterLogic.ts"),ve=e("./frontend/src/lib/components/LemonDivider/index.ts"),F=e("./frontend/src/scenes/insights/insightLogic.ts"),w=["dashboardId","insightShortId"];function s(b){var P=b.dashboardId,N=b.insightShortId,T=t()(b,w),X={dashboardItemId:N,doNotLoad:!0},i=Object(H.useValues)(Object(F.c)(X)),_=i.supportsCsvExport,p=i.csvExportUrl,u=i.insight,Q=Object(H.useActions)(Object(B.b)({dashboardId:P,insightId:u==null?void 0:u.id})),Z=Q.exportItem,k=Object(H.useValues)(Object(B.b)({dashboardId:P,insightId:u==null?void 0:u.id})),ie=k.exportInProgress,M=[];(P||N)&&M.push(B.a.PNG),_&&M.push(B.a.CSV);var De=function(q){if(q===B.a.CSV){window.open(p,"_blank");return}Z(q)};return W.a.createElement(V.b,de()({type:"stealth",loading:ie,"data-attr":"export-button"},T,{popup:{actionable:!0,placement:"right-start",overlay:W.a.createElement(W.a.Fragment,null,W.a.createElement("h5",null,"File type"),W.a.createElement(ve.a,null),M.map(function(re){return W.a.createElement(V.a,{key:re,fullWidth:!0,type:"stealth",onClick:function(){return De(re)},"data-attr":"export-button-".concat(re.split("/").pop())},".",re.split("/").pop())}))}}),"Export")}try{s.displayName="ExportButton",s.__docgenInfo={description:"",displayName:"ExportButton",props:{dashboardId:{defaultValue:null,description:"",name:"dashboardId",required:!1,type:{name:"number"}},insightShortId:{defaultValue:null,description:"",name:"insightShortId",required:!1,type:{name:"InsightShortId"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"alt"'},{value:'"primary"'},{value:'"secondary"'},{value:'"tertiary"'},{value:'"stealth"'},{value:'"highlighted"'}]}},icon:{defaultValue:null,description:"",name:"icon",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>> | null"}},fullWidth:{defaultValue:null,description:"Whether the row should take up the parent's full width.",name:"fullWidth",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/ExportButton/ExportButton.tsx#ExportButton"]={docgenInfo:s.__docgenInfo,name:"ExportButton",path:"frontend/src/lib/components/ExportButton/ExportButton.tsx#ExportButton"})}catch(b){}},"./frontend/src/lib/components/ExportButton/exporterLogic.ts":function(z,E,e){"use strict";e.d(E,"a",function(){return ne}),e.d(E,"b",function(){return G});var S=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),de=e.n(S),R=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),t=e.n(R),c=e("./node_modules/@babel/runtime/regenerator/index.js"),v=e.n(c),$=e("./node_modules/core-js/modules/es.array.concat.js"),le=e.n($),se=e("./node_modules/core-js/modules/es.array.iterator.js"),Le=e.n(se),J=e("./node_modules/core-js/modules/es.object.to-string.js"),W=e.n(J),V=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),H=e.n(V),B=e("./node_modules/core-js/modules/es.object.keys.js"),ve=e.n(B),F=e("./node_modules/core-js/modules/es.symbol.js"),w=e.n(F),s=e("./node_modules/core-js/modules/es.array.filter.js"),b=e.n(s),P=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),N=e.n(P),T=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),X=e.n(T),i=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),_=e.n(i),p=e("./node_modules/kea/lib/index.esm.js"),u=e("./frontend/src/lib/api.ts"),Q=e("./frontend/src/lib/utils.tsx"),Z=e("./node_modules/posthog-js/dist/es.js"),k=e("./frontend/src/scenes/teamLogic.tsx"),ie=e("./frontend/src/lib/components/lemonToast.tsx");function M(d,C){var m=Object.keys(d);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(d);C&&(h=h.filter(function(be){return Object.getOwnPropertyDescriptor(d,be).enumerable})),m.push.apply(m,h)}return m}function De(d){for(var C=1;C<arguments.length;C++){var m=arguments[C]!=null?arguments[C]:{};C%2?M(Object(m),!0).forEach(function(h){de()(d,h,m[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(m)):M(Object(m)).forEach(function(h){Object.defineProperty(d,h,Object.getOwnPropertyDescriptor(m,h))})}return d}var re=1e3,q=10,ne;(function(d){d.PNG="image/png",d.CSV="text/csv",d.PDF="application/pdf"})(ne||(ne={}));var G=Object(p.kea)([Object(p.path)(["lib","components","ExportButton","ExporterLogic"]),Object(p.props)({}),Object(p.key)(function(d){var C=d.dashboardId,m=d.insightId;return"dash:".concat(C,"::insight:").concat(m)}),Object(p.actions)({exportItem:function(C,m,h){return{exportFormat:C,exportContext:m,successCallback:h}},exportItemSuccess:!0,exportItemFailure:!0}),Object(p.reducers)({exportInProgress:[!1,{exportItem:function(){return!0},exportItemSuccess:function(){return!1},exportItemFailure:function(){return!1}}]}),Object(p.listeners)(function(d){var C=d.actions,m=d.props;return{exportItem:function(){var h=t()(v.a.mark(function Ae(ye){var _e,ce,ge,ue,xe,me,Fe,Pe;return v.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return _e=ye.exportFormat,ce=ye.exportContext,ge=ye.successCallback,ie.d.info("Export started..."),ue={export_format:_e,dashboard:m.dashboardId,insight:m.insightId,total_time_ms:0},xe=performance.now(),g.prev=4,g.next=7,u.b.create("api/projects/".concat(k.a.values.currentTeamId,"/exports"),De({export_format:_e,dashboard:m.dashboardId,insight:m.insightId},ce||{}));case 7:if(me=g.sent,me.id){g.next=10;break}throw new Error("Missing export_id from response");case 10:Fe=u.b.exports.determineExportUrl(me.id),Pe=0;case 12:if(!(Pe<q)){g.next=29;break}if(Pe++,!me.has_content){g.next=22;break}return C.exportItemSuccess(),ie.d.success("Export complete."),ge==null||ge(),window.open(Fe,"_blank"),ue.total_time_ms=performance.now()-xe,Z.a.capture("export succeeded",ue),g.abrupt("return");case 22:return g.next=24,Object(Q.w)(re);case 24:return g.next=26,u.b.get("api/projects/".concat(k.a.values.currentTeamId,"/exports/").concat(me.id));case 26:me=g.sent,g.next=12;break;case 29:throw new Error("Content not loaded in time...");case 32:g.prev=32,g.t0=g.catch(4),C.exportItemFailure(),ue.total_time_ms=performance.now()-xe,Z.a.capture("export failed",ue),ie.d.error("Export failed: ".concat(JSON.stringify(g.t0)));case 38:case"end":return g.stop()}},Ae,null,[[4,32]])}));function be(Ae){return h.apply(this,arguments)}return be}()}})])},"./frontend/src/lib/hooks/useKeyboardHotkeys.tsx":function(z,E,e){"use strict";e.d(E,"a",function(){return ve});var S=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),de=e.n(S),R=e("./node_modules/core-js/modules/es.array.includes.js"),t=e.n(R),c=e("./node_modules/core-js/modules/es.string.includes.js"),v=e.n(c),$=e("./node_modules/core-js/modules/es.object.to-string.js"),le=e.n($),se=e("./node_modules/core-js/modules/es.object.keys.js"),Le=e.n(se),J=e("./node_modules/core-js/modules/es.array.concat.js"),W=e.n(J),V=e("./frontend/src/lib/hooks/useEventListener.ts"),H=function(w,s){var b=w.composedPath()||w.path;if(!b)return!1;var P=b[0],N=P.tagName||"not an html element";return s.includes(N.toLowerCase())},B=[".hotkey-block",".hotkey-block *"];function ve(F,w){var s=["input","textarea"];Object(V.a)("keydown",function(b){var P=b.key;if(!(b.metaKey||b.ctrlKey||b.altKey)&&!B.some(function(p){return b.target.matches(p)})){var N=s.includes(b.target.tagName.toLowerCase());if(!(P!=="Escape"&&(N||H(b,s))))for(var T=0,X=Object.keys(F);T<X.length;T++){var i=X[T],_=F[i];if(!(!_||_.disabled)&&P.toLowerCase()===i){b.preventDefault(),_.action();break}}}},void 0,[F].concat(de()(w||[])))}},"./frontend/src/scenes/dashboard/Dashboard.tsx":function(z,E,e){"use strict";e.r(E),e.d(E,"scene",function(){return jt}),e.d(E,"Dashboard",function(){return Se});var S=e("./node_modules/core-js/modules/es.array.includes.js"),de=e("./node_modules/core-js/modules/es.string.includes.js"),R=e("./node_modules/react/index.js"),t=e.n(R),c=e("./node_modules/kea/lib/index.esm.js"),v=e("./frontend/src/scenes/dashboard/dashboardLogic.ts"),$=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),le=e.n($),se=e("./node_modules/core-js/modules/es.array.map.js"),Le=e("./node_modules/core-js/modules/es.function.name.js"),J=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),W=e.n(J),V=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/DashboardItems.scss"),H=e.n(V),B={};B.insert="head",B.singleton=!1;var ve=W()(H.a,B),F=H.a.locals||{},w=e("./node_modules/react-grid-layout/index.js"),s=e("./frontend/src/types.ts"),b=e("./frontend/src/models/insightsModel.tsx"),P=e("./node_modules/clsx/dist/clsx.m.js"),N=e("./frontend/src/lib/components/InsightCard/index.tsx"),T=e("./frontend/src/lib/hooks/useResizeObserver.ts");function X(){var r=Object(c.useValues)(v.c),a=r.dashboard,o=r.items,l=r.layouts,n=r.dashboardMode,L=r.placement,D=r.isRefreshing,y=r.highlightedInsightId,x=r.refreshStatus,I=Object(c.useActions)(v.c),ee=I.updateLayouts,A=I.updateContainerWidth,f=I.updateItemColor,K=I.removeItem,he=I.refreshAllDashboardItems,te=Object(c.useActions)(b.a),je=te.duplicateInsight,Ie=te.renameInsight,fe=te.moveToDashboard,Oe=Object(R.useState)(null),We=le()(Oe,2),Me=We[0],Ke=We[1],Ce=Object(R.useRef)(!1),pe=Object(R.useRef)(null),ze=Object(P.a)({"dashboard-view-mode":n!==s.k.Edit,"dashboard-edit-mode":n===s.k.Edit}),Ue=Object(T.b)(),oe=Ue.width,j=Ue.ref,ae=!oe||oe>v.a.sm;return t.a.createElement("div",{className:"dashboard-items-wrapper",ref:j},t.a.createElement(w.Responsive,{width:oe||0,className:ze,isDraggable:n===s.k.Edit,isResizable:n===s.k.Edit,layouts:l,rowHeight:80,margin:[16,16],containerPadding:[0,0],onLayoutChange:function(Ee,Y){n===s.k.Edit&&ee(Y)},onWidthChange:function(Ee,Y,U){A(Ee,U)},breakpoints:v.a,resizeHandles:ae?["s","e","se"]:["s"],cols:v.b,onResize:function(Ee,Y,U){(!Me||Me.w!==U.w||Me.h!==U.h)&&Ke(U)},onResizeStop:function(){Ke(null)},onDrag:function(){Ce.current=!0,pe.current&&window.clearTimeout(pe.current)},onDragStop:function(){pe.current&&window.clearTimeout(pe.current),pe.current=window.setTimeout(function(){Ce.current=!1},250)},draggableCancel:".anticon,.ant-dropdown,table,.ant-popover-content,button,.Popup"},o==null?void 0:o.map(function(O){var Ee;return t.a.createElement(N.a,{key:O.short_id,insight:O,dashboardId:a==null?void 0:a.id,loading:D(O.short_id),apiErrored:((Ee=x[O.short_id])===null||Ee===void 0?void 0:Ee.error)||!1,highlighted:y&&O.short_id===y,showResizeHandles:n===s.k.Edit,canResizeWidth:ae,updateColor:function(U){return f(O.id,U)},removeFromDashboard:function(){return K(O)},refresh:function(){return he([O])},rename:function(){return Ie(O)},duplicate:function(){return je(O)},moveToDashboardOld:function(U){return je(O,U,!0)},moveToDashboard:function(U){var Ot=U.id,Dt=U.name;if(!a)throw new Error("must be on a dashboard to move an insight");fe(O,a.id,Ot,Dt)},showEditingControls:[s.l.Dashboard,s.l.ProjectHomepage].includes(L),showDetailsControls:L!=s.l.Export})})))}var i=e("./frontend/src/lib/components/DateFilter/DateFilter.tsx"),_=e("./node_modules/@ant-design/icons/es/icons/CalendarOutlined.js"),p=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/Dashboard.scss"),u=e.n(p),Q={};Q.insert="head",Q.singleton=!1;var Z=W()(u.a,Q),k=u.a.locals||{},ie=e("./frontend/src/lib/hooks/useKeyboardHotkeys.tsx"),M=e("./frontend/src/lib/utils/eventUsageLogic.ts"),De=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),re=e("./node_modules/core-js/modules/es.array.fill.js"),q=e("./node_modules/antd/es/card/index.js"),ne=e("./node_modules/antd/es/row/index.js"),G=e("./node_modules/antd/es/col/index.js"),d=e("./node_modules/antd/es/skeleton/index.js"),C=e("./frontend/src/lib/components/Link.tsx"),m=e("./frontend/src/scenes/urls.ts"),h=e("./frontend/src/lib/components/LemonButton/index.ts");function be(r){var a=r.active;return t.a.createElement(q.a,{className:"hide-lte-lg"},t.a.createElement(ne.a,null,t.a.createElement(G.a,{span:12},t.a.createElement(d.a,{paragraph:{rows:1},active:a}),t.a.createElement("div",{className:"mt"},t.a.createElement("div",{className:"mt"},t.a.createElement(d.a.Button,{active:a}),t.a.createElement(d.a.Button,{active:a,style:{marginLeft:4,width:140}})),t.a.createElement("div",{className:"mt"},t.a.createElement(d.a.Button,{active:a}),t.a.createElement(d.a.Button,{active:a,style:{marginLeft:4,width:140}})),t.a.createElement("div",{className:"mt"},t.a.createElement(d.a.Button,{active:a}),t.a.createElement(d.a.Button,{active:a,style:{marginLeft:4,width:140}})))),t.a.createElement(G.a,{span:12},t.a.createElement("div",{className:"skeleton-actions"},t.a.createElement(d.a.Avatar,{active:a,shape:"circle",size:"small"}),t.a.createElement(d.a.Avatar,{active:a,shape:"circle",size:"small"})),t.a.createElement(d.a.Avatar,{active:a,shape:"circle",size:"large",className:"pie-chart"}))))}function Ae(){return t.a.createElement("div",{className:"bar-chart ant-skeleton-content"},Array(8).fill(0).map(function(r,a){var o=200,l=40,n=Math.floor(Math.random()*(o-l+1))+l;return t.a.createElement("div",{className:"bar-el ant-skeleton-title",key:a,style:{height:n}})}))}var ye=t.a.memo(Ae);function _e(r){var a=r.active;return t.a.createElement(q.a,{className:Object(P.a)("ant-skeleton",a&&"ant-skeleton-active")},t.a.createElement(ne.a,null,t.a.createElement(G.a,{span:12},t.a.createElement(d.a,{active:a,paragraph:{rows:1}})),t.a.createElement(G.a,{span:12},t.a.createElement("div",{className:"skeleton-actions"},t.a.createElement(d.a.Avatar,{active:a,shape:"circle",size:"small"}),t.a.createElement(d.a.Avatar,{active:a,shape:"circle",size:"small"})))),t.a.createElement(ye,null))}function ce(r){var a=r.loading,o=Object(c.useValues)(v.c),l=o.dashboard;return t.a.createElement("div",{className:"empty-state"},!a&&t.a.createElement("div",{className:"cta"},t.a.createElement(q.a,{className:"card-elevated"},t.a.createElement("h3",{className:"l3"},"Dashboard empty"),t.a.createElement("p",null,"This dashboard sure would look better with some graphs!"),t.a.createElement("div",{className:"mt text-center"},t.a.createElement(C.a,{to:m.a.insightNew(void 0,l==null?void 0:l.id)},t.a.createElement(h.a,{"data-attr":"dashboard-add-graph-header"},"Add insight"))))),t.a.createElement(ne.a,{gutter:16},t.a.createElement(G.a,{span:24,lg:12},t.a.createElement(be,{active:a})),t.a.createElement(G.a,{span:24,lg:12},t.a.createElement(_e,{active:a}))),t.a.createElement(ne.a,{gutter:16,className:"fade-out-graphs"},t.a.createElement(G.a,{span:24,lg:12},t.a.createElement(be,{active:a})),t.a.createElement(G.a,{span:24,lg:12},t.a.createElement(_e,{active:a}))))}try{ce.displayName="EmptyDashboardComponent",ce.__docgenInfo={description:"",displayName:"EmptyDashboardComponent",props:{loading:{defaultValue:null,description:"",name:"loading",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/EmptyDashboardComponent.tsx#EmptyDashboardComponent"]={docgenInfo:ce.__docgenInfo,name:"EmptyDashboardComponent",path:"frontend/src/scenes/dashboard/EmptyDashboardComponent.tsx#EmptyDashboardComponent"})}catch(r){}var ge=e("./frontend/src/lib/components/NotFound/index.tsx"),ue=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),xe=e.n(ue),me=e("./node_modules/core-js/modules/es.array.from.js"),Fe=e("./node_modules/core-js/modules/es.string.iterator.js"),Pe=e("./node_modules/antd/es/dropdown/index.js"),Te=e("./node_modules/antd/es/menu/index.js"),g=e("./node_modules/antd/es/checkbox/index.js"),Ve=e("./node_modules/antd/es/radio/index.js"),Ze=e("./node_modules/antd/es/space/index.js"),ke=e("./node_modules/@ant-design/icons/es/icons/DownOutlined.js"),qe=e("./node_modules/@ant-design/icons/es/icons/LoadingOutlined.js"),et=e("./node_modules/@ant-design/icons/es/icons/ReloadOutlined.js"),He=e("./frontend/src/lib/utils.tsx"),tt=e("./frontend/src/lib/components/Tooltip.tsx"),at=e("./frontend/src/lib/dayjs.ts"),we=function(){var a=Object(c.useValues)(v.c),o=a.lastRefreshed;return t.a.createElement("span",null,"Last updated ",t.a.createElement("b",null,o?Object(at.a)(o).fromNow():"a while ago"))},st=xe()(Array.from([60,120,300,900],function(r){return{label:Object(He.N)(r),value:r}}));function rt(){var r=Object(c.useValues)(v.c),a=r.itemsLoading,o=r.autoRefresh,l=r.refreshMetrics,n=Object(c.useActions)(v.c),L=n.refreshAllDashboardItemsManual,D=n.setAutoRefresh,y=Object(R.useState)(!1),x=le()(y,2),I=x[0],ee=x[1];return t.a.createElement(t.a.Fragment,null,t.a.createElement(Pe.a.Button,{overlay:t.a.createElement(Te.a,{"data-attr":"auto-refresh-picker",id:"auto-refresh-picker"},t.a.createElement("div",{id:"auto-refresh-check",key:"auto-refresh-check",onClick:function(f){f.stopPropagation(),ee(!0),D(!o.enabled,o.interval)}},t.a.createElement(tt.a,{title:"Refresh dashboard automatically",placement:"bottomLeft"},t.a.createElement(g.a,{onChange:function(f){f.stopPropagation(),f.preventDefault()},checked:o.enabled}),t.a.createElement("label",{style:{marginLeft:10,cursor:"pointer"}},"Auto refresh"))),t.a.createElement(Te.a.Divider,null),t.a.createElement(Te.a.ItemGroup,{title:"Refresh interval"},t.a.createElement(Ve.a.Group,{onChange:function(f){D(!0,parseInt(f.target.value))},value:o.interval,style:{width:"100%"}},t.a.createElement(Ze.b,{direction:"vertical",style:{width:"100%"}},st.map(function(A){var f=A.label,K=A.value;return t.a.createElement(Ve.a,{key:K,value:K,style:{width:"100%"}},f)}))))),trigger:["click"],onClick:function(){return L()},icon:t.a.createElement(ke.a,null),disabled:a,buttonsRender:function(f){var K=le()(f,2),he=K[0],te=K[1];return[t.a.cloneElement(he,{style:{paddingLeft:10}}),te]},visible:I,onVisibleChange:function(f){return ee(f)}},t.a.createElement("span",{className:"dashboard-items-action-icon"},a?t.a.createElement(qe.a,null):t.a.createElement(et.a,null)),t.a.createElement("span",{className:Object(P.a)("dashboard-items-action-refresh-text",{hidden:a})},t.a.createElement(we,null)),t.a.createElement("span",{className:Object(P.a)("dashboard-items-action-refresh-text","completed",{hidden:!a})},"Refreshed ",l.completed," out of ",l.total)))}var nt=e("./frontend/src/scenes/insights/EmptyStates/index.ts"),yt=e("./node_modules/core-js/modules/es.symbol.js"),xt=e("./node_modules/core-js/modules/es.symbol.description.js"),Pt=e("./node_modules/core-js/modules/es.array.filter.js"),It=e("./node_modules/core-js/modules/es.object.to-string.js"),Mt=e("./node_modules/core-js/modules/es.array.concat.js"),Ct=e("./node_modules/core-js/modules/es.array.join.js"),Ge=e("./frontend/src/lib/components/EditableField/EditableField.tsx");function Re(r){var a=r.onExit,o="aside.ant-layout-sider, .layout-top-content";return Object(R.useEffect)(function(){for(var l=window.document.querySelectorAll(o),n=0;n<l.length;n++)l[n].style.display="none";var L=function(){window.document.fullscreenElement===null&&(a==null||a())};try{window.document.body.requestFullscreen().then(function(){window.addEventListener("fullscreenchange",L,!1)})}catch(D){}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch(D){}return function(){for(var D=window.document.querySelectorAll(o),y=0;y<D.length;y++)D[y].style.display="block";try{window.removeEventListener("fullscreenchange",L,!1),window.document.fullscreenElement!==null&&window.document.exitFullscreen()}catch(x){}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch(x){}}},[]),null}try{Re.displayName="FullScreen",Re.__docgenInfo={description:"",displayName:"FullScreen",props:{onExit:{defaultValue:null,description:"",name:"onExit",required:!1,type:{name:"(() => any)"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/FullScreen.tsx#FullScreen"]={docgenInfo:Re.__docgenInfo,name:"FullScreen",path:"frontend/src/lib/components/FullScreen.tsx#FullScreen"})}catch(r){}var ot=e("./frontend/src/lib/components/LemonButton/More.tsx"),dt=e("./frontend/src/lib/components/LemonRow/index.ts"),Ne=e("./frontend/src/lib/components/LemonDivider/index.ts"),Ye=e("./frontend/src/lib/components/ObjectTags/ObjectTags.tsx"),lt=e("./frontend/src/lib/components/PageHeader.tsx"),$e=e("./frontend/src/models/dashboardsModel.tsx"),it=e("./frontend/src/scenes/dashboard/dashboardsLogic.ts"),ct=e("./frontend/src/scenes/dashboard/DashboardCollaborators.tsx"),ut=e("./frontend/src/scenes/userLogic.ts"),Be=e("./frontend/src/lib/constants.tsx"),mt=e("./frontend/src/lib/components/ProfilePicture/ProfileBubbles.tsx"),ht=e("./frontend/src/scenes/dashboard/dashboardCollaboratorsLogic.ts"),ft=e("./frontend/src/lib/components/icons.tsx"),Je=e("./frontend/src/lib/logic/featureFlagLogic.ts"),pt=e("./frontend/src/lib/components/ExportButton/ExportButton.tsx"),Xe=e("./frontend/src/lib/components/Subscriptions/SubscriptionsModal.tsx"),Et=e("./node_modules/kea-router/lib/index.js"),vt=e("./frontend/src/lib/components/Sharing/SharingModal.tsx");function bt(){var r=Object(c.useValues)(v.c),a=r.dashboard,o=r.allItemsLoading,l=r.dashboardMode,n=r.canEditDashboard,L=r.showSubscriptions,D=r.subscriptionId,y=Object(c.useActions)(v.c),x=y.setDashboardMode,I=y.triggerDashboardUpdate,ee=Object(c.useValues)(it.b),A=ee.dashboardTags,f=Object(c.useActions)($e.a),K=f.updateDashboard,he=f.pinDashboard,te=f.unpinDashboard,je=f.deleteDashboard,Ie=f.duplicateDashboard,fe=Object(c.useValues)($e.a),Oe=fe.dashboardLoading,We=Object(c.useValues)(ut.a),Me=We.hasAvailableFeature,Ke=Object(c.useValues)(Je.a),Ce=Ke.featureFlags,pe=Ce[Be.h.EXPORT_DASHBOARD_INSIGHTS],ze=Ce[Be.h.INSIGHT_SUBSCRIPTIONS],Ue=Object(c.useActions)(Et.router),oe=Ue.push;return a||o?t.a.createElement(t.a.Fragment,null,l===s.k.Fullscreen&&t.a.createElement(Re,{onExit:function(){return x(null,M.a.Browser)}}),a&&t.a.createElement(t.a.Fragment,null,t.a.createElement(Xe.c,{visible:L,closeModal:function(){return oe(m.a.dashboard(a.id))},dashboardId:a.id,subscriptionId:D}),t.a.createElement(vt.b,{visible:l===s.k.Sharing,closeModal:function(){return oe(m.a.dashboard(a.id))},dashboardId:a.id})),t.a.createElement(lt.a,{title:t.a.createElement("div",{style:{display:"flex",alignItems:"center"}},t.a.createElement(Ge.a,{name:"name",value:(a==null?void 0:a.name)||(o?"Loading\u2026":""),placeholder:"Name this dashboard",onSave:a?function(j){return K({id:a.id,name:j})}:void 0,minLength:1,maxLength:400,mode:n?void 0:"view",notice:a&&!n?{icon:t.a.createElement(ft.IconLock,null),tooltip:"You don't have edit permissions in this dashboard. Ask a dashboard collaborator with edit access to add you."}:void 0})),buttons:l===s.k.Edit?t.a.createElement(h.a,{"data-attr":"dashboard-edit-mode-save",type:"primary",onClick:function(){return x(null,M.a.DashboardHeader)},tabIndex:10,disabled:o},"Done editing"):l===s.k.Fullscreen?t.a.createElement(h.a,{type:"secondary",onClick:function(){return x(null,M.a.DashboardHeader)},"data-attr":"dashboard-exit-presentation-mode",disabled:o},"Exit full screen"):t.a.createElement(t.a.Fragment,null,t.a.createElement(ot.a,{overlay:a?t.a.createElement(t.a.Fragment,null,a.created_by&&t.a.createElement(t.a.Fragment,null,t.a.createElement(dt.a,{fullWidth:!0,style:{color:"var(--muted-alt)"}},"Created by"," ",a.created_by.first_name||a.created_by.email||"-"," ","on ",Object(He.M)(a.created_at)),t.a.createElement(Ne.a,null)),n&&t.a.createElement(h.a,{onClick:function(){return x(s.k.Edit,M.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Edit layout (E)"),t.a.createElement(h.a,{onClick:function(){return x(s.k.Fullscreen,M.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Go full screen (F)"),n&&(a.pinned?t.a.createElement(h.a,{onClick:function(){return te(a.id,M.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Unpin dashboard"):t.a.createElement(h.a,{onClick:function(){return he(a.id,M.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Pin dashboard")),ze&&t.a.createElement(Xe.a,{dashboardId:a.id}),pe&&t.a.createElement(pt.a,{dashboardId:a.id,fullWidth:!0,type:"stealth"}),t.a.createElement(Ne.a,null),t.a.createElement(h.a,{onClick:function(){return Ie({id:a.id,name:a.name,show:!0})},type:"stealth",fullWidth:!0},"Duplicate dashboard"),n&&t.a.createElement(h.a,{onClick:function(){return je({id:a.id,redirect:!0})},status:"danger",type:"stealth",fullWidth:!0},"Delete dashboard")):void 0}),t.a.createElement(Ne.a,{vertical:!0}),a&&t.a.createElement(t.a.Fragment,null,t.a.createElement(_t,{dashboard:a,onClick:function(){return oe(m.a.dashboardSharing(a.id))}}),t.a.createElement(h.a,{type:"secondary","data-attr":"dashboard-share-button",onClick:function(){return oe(m.a.dashboardSharing(a.id))}},"Share")),n&&t.a.createElement(C.a,{to:m.a.insightNew(void 0,a==null?void 0:a.id)},t.a.createElement(h.a,{type:"primary","data-attr":"dashboard-add-graph-header"},"Add insight"))),caption:t.a.createElement(t.a.Fragment,null,a&&!!(n||a.description)&&t.a.createElement(Ge.a,{multiline:!0,name:"description",value:a.description||"",placeholder:"Description (optional)",onSave:function(ae){return K({id:a.id,description:ae})},compactButtons:!0,mode:n?void 0:"view",paywall:!Me(s.d.DASHBOARD_COLLABORATION)}),(a==null?void 0:a.tags)&&t.a.createElement(t.a.Fragment,null,n?t.a.createElement(Ye.a,{tags:a.tags,onChange:function(ae,O){return I({tags:O})},saving:Oe,tagsAvailable:A.filter(function(j){var ae;return!((ae=a.tags)!==null&&ae!==void 0&&ae.includes(j))}),className:"insight-metadata-tags"}):a.tags.length?t.a.createElement(Ye.a,{tags:a.tags,saving:Oe,staticOnly:!0,className:"insight-metadata-tags"}):null)),delimited:!0})):null}function _t(r){var a=r.dashboard,o=r.onClick,l=Object(c.useValues)(Object(ht.a)({dashboardId:a.id})),n=l.allCollaborators;if(!a)return null;var L=ct.a[a.effective_restriction_level],D=[];return L!=null&&L.label&&D.push(L.label),a.is_shared&&D.push("Shared publicly"),t.a.createElement(mt.a,{people:n.map(function(y){return{email:y.user.email,name:y.user.first_name,title:"".concat(y.user.first_name," (").concat(Be.C[y.level],")")}}),tooltip:D.join(" \u2022 "),onClick:o})}var gt=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),jt={component:Qe,logic:v.c,paramsToProps:function(a){var o=a.params,l=o.id,n=o.placement;return{id:l?parseInt(l):void 0,placement:n}}};function Se(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=r.id,o=r.dashboard,l=r.placement;return t.a.createElement(c.BindLogic,{logic:v.c,props:{id:a?parseInt(a):void 0,placement:l,dashboard:o}},t.a.createElement(Qe,null))}function Qe(){var r,a,o=Object(c.useValues)(v.c),l=o.placement,n=o.dashboard,L=o.canEditDashboard,D=o.items,y=o.itemsLoading,x=o.filters,I=o.dashboardMode,ee=o.receivedErrorsFromAPI,A=Object(c.useActions)(v.c),f=A.setDashboardMode,K=A.setDates,he=A.reportDashboardViewed,te=A.setProperties,je=Object(c.useValues)(Je.a),Ie=je.featureFlags;return Object(R.useEffect)(function(){he()},[]),Object(ie.a)([s.l.Public,s.l.InternalMetrics].includes(l)?{}:{e:{action:function(){return f(I===s.k.Edit?null:s.k.Edit,M.a.Hotkey)},disabled:!L||I!==null&&I!==s.k.Edit},f:{action:function(){return f(I===s.k.Fullscreen?null:s.k.Fullscreen,M.a.Hotkey)},disabled:I!==null&&I!==s.k.Fullscreen},escape:{action:function(){return f(null,M.a.Hotkey)},disabled:I!==s.k.Edit}},[f,I]),!n&&!y&&ee?t.a.createElement(ge.a,{object:"dashboard"}):t.a.createElement("div",{className:"dashboard"},![s.l.ProjectHomepage,s.l.Public,s.l.Export,s.l.InternalMetrics].includes(l)&&t.a.createElement(bt,null),ee?t.a.createElement(nt.d,{title:"There was an error loading this dashboard"}):!D||D.length===0?t.a.createElement(ce,{loading:y}):t.a.createElement("div",null,![s.l.Public,s.l.Export,s.l.InternalMetrics].includes(l)&&t.a.createElement("div",{className:"flex pb border-bottom space-x"},t.a.createElement("div",{className:"flex-grow flex",style:{height:30}},t.a.createElement(De.a,{style:{marginRight:8,fontWeight:"bold",lineHeight:"30px"}}),t.a.createElement(i.a,{defaultValue:"Custom",showCustom:!0,dateFrom:(r=x==null?void 0:x.date_from)!==null&&r!==void 0?r:void 0,dateTo:(a=x==null?void 0:x.date_to)!==null&&a!==void 0?a:void 0,onChange:K,disabled:!L,makeLabel:function(Oe){return t.a.createElement(t.a.Fragment,null,t.a.createElement(_.a,null),t.a.createElement("span",{className:"hide-when-small"}," ",Oe))}})),(Ie[Be.h.PROPERTY_FILTER_ON_DASHBOARD]||(n==null?void 0:n.filters.properties))&&t.a.createElement(gt.a,{onChange:te,pageKey:"dashboard_"+(n==null?void 0:n.id),propertyFilters:n==null?void 0:n.filters.properties,useLemonButton:!0})),l!==s.l.Export&&t.a.createElement("div",{className:"flex pt pb space-x dashoard-items-actions"},t.a.createElement("div",{className:"left-item",style:l===s.l.Public?{textAlign:"right"}:void 0},[s.l.Public,s.l.InternalMetrics].includes(l)?t.a.createElement(we,null):t.a.createElement(rt,null))),t.a.createElement(X,null)))}try{Se.displayName="Dashboard",Se.__docgenInfo={description:"",displayName:"Dashboard",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},dashboard:{defaultValue:null,description:"",name:"dashboard",required:!1,type:{name:"DashboardType"}},placement:{defaultValue:null,description:"",name:"placement",required:!1,type:{name:"enum",value:[{value:'"dashboard"'},{value:'"internal-metrics"'},{value:'"project-homepage"'},{value:'"public"'},{value:'"export"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/Dashboard.tsx#Dashboard"]={docgenInfo:Se.__docgenInfo,name:"Dashboard",path:"frontend/src/scenes/dashboard/Dashboard.tsx#Dashboard"})}catch(r){}},"./frontend/src/scenes/dashboard/dashboardsLogic.ts":function(z,E,e){"use strict";e.d(E,"a",function(){return T}),e.d(E,"b",function(){return X});var S=e("./node_modules/core-js/modules/es.array.sort.js"),de=e.n(S),R=e("./node_modules/core-js/modules/es.array.filter.js"),t=e.n(R),c=e("./node_modules/core-js/modules/es.object.to-string.js"),v=e.n(c),$=e("./node_modules/core-js/modules/es.function.name.js"),le=e.n($),se=e("./node_modules/core-js/modules/es.array.map.js"),Le=e.n(se),J=e("./node_modules/core-js/modules/es.regexp.exec.js"),W=e.n(J),V=e("./node_modules/core-js/modules/es.string.search.js"),H=e.n(V),B=e("./node_modules/core-js/modules/es.array.flat-map.js"),ve=e.n(B),F=e("./node_modules/core-js/modules/es.array.unscopables.flat-map.js"),w=e.n(F),s=e("./node_modules/kea/lib/index.esm.js"),b=e("./node_modules/fuse.js/dist/fuse.esm.js"),P=e("./frontend/src/models/dashboardsModel.tsx"),N=e("./frontend/src/lib/utils.tsx"),T;(function(i){i.All="all",i.Pinned="pinned",i.Shared="shared"})(T||(T={}));var X=Object(s.kea)({path:["scenes","dashboard","dashboardsLogic"],actions:{setSearchTerm:function(_){return{searchTerm:_}},setCurrentTab:function(_){return{tab:_}}},reducers:{searchTerm:{setSearchTerm:function(_,p){var u=p.searchTerm;return u}},currentTab:[T.All,{setCurrentTab:function(_,p){var u=p.tab;return u}}]},selectors:{dashboards:[function(i){return[P.a.selectors.nameSortedDashboards,i.searchTerm,i.currentTab]},function(i,_,p){return i=i.filter(function(u){return!u.deleted}).sort(function(u,Q){var Z,k;return((Z=u.name)!==null&&Z!==void 0?Z:"Untitled").localeCompare((k=Q.name)!==null&&k!==void 0?k:"Untitled")}),p===T.Pinned?i=i.filter(function(u){return u.pinned}):p===T.Shared&&(i=i.filter(function(u){return u.is_shared})),_?new b.a(i,{keys:["key","name"],threshold:.3}).search(_).map(function(u){return u.item}):i}],dashboardTags:[function(){return[P.a.selectors.nameSortedDashboards]},function(i){return Object(N.Db)(i.flatMap(function(_){var p=_.tags;return p||""}),function(_){return _}).sort()}]}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/Dashboard.scss":function(z,E,e){var S=e("./node_modules/css-loader/dist/runtime/api.js");E=S(!1),E.push([z.i,'.dashboard .empty-state .fade-out-graphs:after{content:"";width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent);position:absolute;pointer-events:none;bottom:0}.dashboard-header .dashboard-select{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.dashboard{margin-top:1rem}.dashboard .dashboard-items-action-icon{margin-right:6px}.dashboard .dashboard-items-action-refresh-text{visibility:visible}.dashboard .dashboard-items-action-refresh-text.hidden{visibility:hidden}.dashboard .dashboard-items-action-refresh-text.completed{position:absolute;left:30px}.dashboard .empty-state{position:relative}.dashboard .empty-state .skeleton-actions{text-align:right}.dashboard .empty-state .skeleton-actions .ant-skeleton-avatar{margin-right:8px}.dashboard .empty-state .pie-chart{height:200px;width:200px;max-width:100%;margin-top:1rem}@media(max-width:992px){.dashboard .empty-state .pie-chart{height:140px;width:140px}}.dashboard .empty-state .bar-chart{display:flex;margin-top:1rem;align-items:flex-end}.dashboard .empty-state .bar-chart .bar-el{width:12.5%;margin-left:4px;height:100px}.dashboard .empty-state .ant-col{flex-grow:1}.dashboard .empty-state .ant-col .ant-card{height:100%}.dashboard .empty-state .fade-out-graphs{margin-top:1rem;height:150px;overflow:hidden;position:relative}.dashboard .empty-state .fade-out-graphs:after{width:calc(100% - 16px);left:8px;height:150px}.dashboard .empty-state .cta{width:360px;max-width:calc(100% - 32px);position:absolute;top:16px;left:50%;transform:translateX(-50%);z-index:var(--z-content-overlay)}.dashboard-header{display:flex;justify-content:space-between;margin-bottom:1rem;width:100%}.dashboard-header.full-screen{margin-top:1rem}.dashboard-header .dashboard-select{flex:1;padding-right:2rem}.dashboard-header .dashboard-select .ant-select-single{max-width:100%;line-height:40px}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector{align-items:center;padding-left:0;padding-right:8px;line-height:40px;height:40px}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector .ant-select-selection-item{font-size:28px;font-weight:600;line-height:40px;width:100%;height:35px;display:flex;align-items:center}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector .ant-select-selection-item .anticon-share-alt{font-size:16px;margin-left:6px!important;margin-right:4px}.dashboard-header .dashboard-select .ant-select-single.ant-select-open .ant-select-arrow{color:var(--depr-rgba-text-default-0-4)}.dashboard-header .dashboard-select .ant-select-single .ant-select-arrow{color:var(--text-default);font-size:14px}.dashboard-header .dashboard-meta{white-space:nowrap;display:flex;align-items:center}.dashboard-header .dashboard-meta .ant-btn{margin-left:10px}.dashboard-header .dashboard-meta .ant-btn .anticon{vertical-align:baseline}.dashboard-header .dashboard-meta .ant-btn.button-box{padding:4px 8px}@media(max-width:768px){.dashboard-header{flex-direction:column}.dashboard-header .dashboard-meta{padding-top:1rem;justify-content:flex-end}}#auto-refresh-check{padding:5px 12px;cursor:pointer}.CollaboratorRow{justify-content:space-between;height:2rem;margin-top:.5rem;padding-left:.5rem}.CollaboratorRow,.CollaboratorRow__details{display:flex;align-items:center}.CollaboratorRow__details>span{margin-right:.5rem}',""]),z.exports=E},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/DashboardItems.scss":function(z,E,e){var S=e("./node_modules/css-loader/dist/runtime/api.js");E=S(!1),E.push([z.i,".dashboard-items-wrapper{width:100%}.react-grid-layout{position:relative;transition:height .1s ease;margin-bottom:2rem}.react-grid-layout.dashboard-view-mode .react-grid-item{transition:none}.react-grid-item{transition:all .1s ease;transition-property:left,top}.react-grid-item.cssTransforms{transition-property:transform}.react-grid-item.resizing{z-index:1;will-change:width,height}.react-grid-item.react-draggable{cursor:move}.react-grid-item.react-draggable-dragging{transition:none;z-index:105;will-change:transform}.react-grid-item.dropping{visibility:hidden}.react-grid-item.react-grid-placeholder{transition:.1s ease;max-width:100%;position:relative;border:1px solid var(--primary);outline:1px solid var(--primary);border-radius:var(--radius);z-index:2;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-resizable-hide>.react-resizable-handle{display:none}.react-grid-item>.react-resizable-handle{position:absolute;width:2rem;height:2rem;bottom:-.5rem;right:-.5rem;cursor:se-resize;z-index:10}.react-grid-item>.react-resizable-handle.react-resizable-handle-se{cursor:se-resize}.react-grid-item>.react-resizable-handle.react-resizable-handle-e{top:0;bottom:2rem;height:auto;cursor:ew-resize}.react-grid-item>.react-resizable-handle.react-resizable-handle-s{left:0;right:2rem;width:auto;cursor:ns-resize}.ant-dropdown{z-index:700}.dive-btn{margin-right:.5rem}.dive-btn.dive-btn-dive{border-color:var(--primary);color:var(--primary)}.dive-btn.dive-btn-dive:hover{border-color:var(--depr-darken-primary-30);color:var(--depr-darken-primary-30)}",""]),z.exports=E}}]);
