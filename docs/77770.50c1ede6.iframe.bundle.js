(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[77770],{"../../frontend/src/layout/scenes/SceneContent.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{SN:()=>SceneSection,Vl:()=>SceneDivider,_W:()=>SceneContent,sG:()=>SceneTitleSection});var _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),lib_lemon_ui_LemonMarkdown__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonMarkdown/index.ts"),lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/ui/Button/ButtonPrimitives.tsx"),lib_ui_TextareaPrimitive_TextareaPrimitive__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/ui/TextareaPrimitive/TextareaPrimitive.tsx"),lib_ui_TextInputPrimitive_TextInputPrimitive__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/ui/TextInputPrimitive/TextInputPrimitive.tsx"),lib_ui_WrappingLoadingSkeleton_WrappingLoadingSkeleton__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/lib/ui/WrappingLoadingSkeleton/WrappingLoadingSkeleton.tsx"),lib_utils_css_classes__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("../../frontend/src/lib/utils/css-classes.ts"),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),_panel_layout_ProjectTree_defaultTree__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/layout/panel-layout/ProjectTree/defaultTree.tsx"),_posthog_icons__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.27.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),lib_constants__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../frontend/src/lib/constants.tsx"),kea__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../frontend/src/lib/logic/featureFlagLogic.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function SceneContent(_ref){let{children}=_ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("div",{className:"scene-content flex flex-col gap-y-4",children:children})}function SceneSection(_ref2){let{title,description,isLoading,children,className,hideTitleAndDescription}=_ref2,{featureFlags}=(0,kea__WEBPACK_IMPORTED_MODULE_10__.useValues)(lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_11__.featureFlagLogic);return featureFlags[lib_constants__WEBPACK_IMPORTED_MODULE_9__.y8.NEW_SCENE_LAYOUT]?isLoading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:(0,lib_utils_css_classes__WEBPACK_IMPORTED_MODULE_13__.cn)("flex flex-col gap-4",className),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("h2",{className:"text-xl font-bold my-0 mb-1 max-w-prose",children:title}),description&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("p",{className:"text-sm text-secondary my-0 max-w-prose",children:description})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_ui_WrappingLoadingSkeleton_WrappingLoadingSkeleton__WEBPACK_IMPORTED_MODULE_5__.x,{children:children})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:(0,lib_utils_css_classes__WEBPACK_IMPORTED_MODULE_13__.cn)("scene-section--new-layout flex flex-col gap-4",className),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("h2",{className:"text-xl font-bold my-0 mb-1 max-w-prose",children:title}),description&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("p",{className:"text-sm text-secondary my-0 max-w-prose",children:description})]}),children]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:(0,lib_utils_css_classes__WEBPACK_IMPORTED_MODULE_13__.cn)("scene-section--fallback flex flex-col gap-4",className),children:[!hideTitleAndDescription&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"flex flex-col",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("h2",{className:"flex-1 subtitle mt-0",children:title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("p",{className:"m-0",children:description})]}),children]})}function SceneTitleSection(_ref3){let{name,description,resourceType,markdown=!1,isLoading=!1,onNameBlur,onDescriptionBlur,docsURL}=_ref3,{featureFlags}=(0,kea__WEBPACK_IMPORTED_MODULE_10__.useValues)(lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_11__.featureFlagLogic);if(!featureFlags[lib_constants__WEBPACK_IMPORTED_MODULE_9__.y8.NEW_SCENE_LAYOUT])return null;let icon=resourceType.forceIcon?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_panel_layout_ProjectTree_defaultTree__WEBPACK_IMPORTED_MODULE_7__.ee,{type:resourceType.type,colorOverride:resourceType.forceIconColorOverride,children:resourceType.forceIcon}):(0,_panel_layout_ProjectTree_defaultTree__WEBPACK_IMPORTED_MODULE_7__.PO)(resourceType.type);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"scene-title-section w-full flex gap-0 group/colorful-product-icons colorful-product-icons-true",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"flex flex-col gap-1.5 flex-1",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"flex gap-3 [&_svg]:size-6 items-center",children:[resourceType.to?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.rU,{to:resourceType.to,tooltip:resourceType.tooltip||`View all ${resourceType.typePlural}`,buttonProps:{size:"base",iconOnly:!0,variant:"panel",className:"rounded-sm h-[var(--button-height-lg)]"},children:icon}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("span",{className:(0,lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_2__.sq)({size:"base",iconOnly:!0,className:"rounded-sm h-[var(--button-height-lg)]",inert:!0}),children:icon}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(SceneName,{name:name,isLoading:isLoading,onBlur:onNameBlur})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(SceneDescription,{description:description,markdown:markdown,isLoading:isLoading,onBlur:onDescriptionBlur})]}),docsURL&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.rU,{to:`${docsURL}?utm_medium=in-product&utm_campaign=scene-title-section-docs-link`,buttonProps:{variant:"panel",className:"rounded-sm"},tooltip:`View docs for ${resourceType.typePlural}`,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_8__.IconDocument,{})," ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("span",{className:"hidden lg:block",children:"Read the docs"})]})]})}function SceneName(_ref4){let{name:initialName,isLoading=!1,onBlur}=_ref4,[isEditing,setIsEditing]=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)(!1),[name,setName]=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)(initialName),textClasses="text-3xl font-bold my-0 pl-[var(--button-padding-x-sm)] h-[var(--button-height-lg)] leading-[1.4] select-auto";(0,react__WEBPACK_IMPORTED_MODULE_6__.useEffect)(()=>{isLoading||setName(initialName)},[initialName,isLoading]);let Element=onBlur?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_2__.hL,{size:"lg",onClick:()=>setIsEditing(!0),className:textClasses,menuItem:!0,variant:"panel",tooltip:isEditing?null:"Edit name",children:name||(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("span",{className:"text-tertiary",children:"Unnamed"})}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("h1",{className:(0,lib_utils_css_classes__WEBPACK_IMPORTED_MODULE_13__.cn)((0,lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_2__.sq)({size:"lg",inert:!0,className:textClasses})),children:name||(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("span",{className:"text-tertiary",children:"Unnamed"})});return isLoading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("div",{className:"max-w-prose",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_ui_WrappingLoadingSkeleton_WrappingLoadingSkeleton__WEBPACK_IMPORTED_MODULE_5__.x,{fullWidth:!0,children:Element})}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("div",{className:"scene-name max-w-prose flex flex-col gap-0 -ml-[calc(var(--button-padding-x-sm)+2px)]",children:isEditing?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_ui_TextInputPrimitive_TextInputPrimitive__WEBPACK_IMPORTED_MODULE_4__.w,{variant:"default",value:name||"",onChange:e=>setName(e.target.value),className:`${textClasses} bg-transparent field-sizing-content w-full`,autoFocus:!0,onBlur:()=>{setIsEditing(!1),initialName!==name&&onBlur?.(name||"")},size:"lg"})}):Element})}function SceneDescription(_ref5){let{description:initialDescription,markdown=!1,isLoading=!1,onBlur}=_ref5,[isEditing,setIsEditing]=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)(!1),[description,setDescription]=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)(initialDescription),textClasses="text-sm my-0 select-auto";(0,react__WEBPACK_IMPORTED_MODULE_6__.useEffect)(()=>{isLoading||setDescription(initialDescription)},[initialDescription,isLoading]);let Element=onBlur?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_2__.hL,{onClick:()=>setIsEditing(!0),className:`${textClasses}`,autoHeight:!0,menuItem:!0,variant:"panel",tooltip:isEditing?null:"Edit description",children:markdown&&description?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_lemon_ui_LemonMarkdown__WEBPACK_IMPORTED_MODULE_1__.j,{lowKeyHeadings:!0,className:"[&_p]:my-0 [&_p]:leading-[20px]",children:description}):description||(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("span",{className:"text-tertiary",children:"No description (optional)"})}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:markdown&&description?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_lemon_ui_LemonMarkdown__WEBPACK_IMPORTED_MODULE_1__.j,{lowKeyHeadings:!0,className:(0,lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_2__.sq)({inert:!0,className:`${textClasses} -ml-[var(--button-padding-x-base)]`,autoHeight:!0}),children:description}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("p",{className:(0,lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_2__.sq)({inert:!0,className:`${textClasses} -ml-[var(--button-padding-x-base)]`,autoHeight:!0}),children:description||(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("span",{className:"text-tertiary",children:"No description (optional)"})})});return isLoading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("div",{className:"max-w-prose",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_ui_WrappingLoadingSkeleton_WrappingLoadingSkeleton__WEBPACK_IMPORTED_MODULE_5__.x,{fullWidth:!0,children:Element})}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("div",{className:"scene-description max-w-prose flex flex-col gap-0",children:isEditing?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(lib_ui_TextareaPrimitive_TextareaPrimitive__WEBPACK_IMPORTED_MODULE_3__.L,{variant:"default",value:description||"",onChange:e=>setDescription(e.target.value),className:`${textClasses} bg-transparent field-sizing-content w-full`,autoFocus:!0,onBlur:()=>{setIsEditing(!1),initialDescription!==description&&onBlur?.(description||"")},markdown:!0})}):Element})}function SceneDivider(){let{featureFlags}=(0,kea__WEBPACK_IMPORTED_MODULE_10__.useValues)(lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_11__.featureFlagLogic);return featureFlags[lib_constants__WEBPACK_IMPORTED_MODULE_9__.y8.NEW_SCENE_LAYOUT]?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.p2,{className:"scene-divider -mx-4 w-[calc(100%+var(--spacing)*8)]"}):null}},"../../frontend/src/scenes/cohorts/Cohorts.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Cohorts:()=>Cohorts_Cohorts,scene:()=>scene});var injectStylesIntoStyleTag=__webpack_require__("../../node_modules/.pnpm/style-loader@2.0.0_webpack@5.88.2/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),Cohorts=__webpack_require__("../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!../../node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.5.6_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!../../node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!../../frontend/src/scenes/cohorts/Cohorts.scss"),Cohorts_default=__webpack_require__.n(Cohorts),options={};options.insert="head",options.singleton=!1,injectStylesIntoStyleTag_default()(Cohorts_default(),options),Cohorts_default().locals;var src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),hedgehogs=__webpack_require__("../../frontend/src/lib/components/hedgehogs.tsx"),ProductIntroduction=__webpack_require__("../../frontend/src/lib/components/ProductIntroduction/ProductIntroduction.tsx"),dayjs=__webpack_require__("../../frontend/src/lib/dayjs.ts"),LemonButton=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/index.ts"),More=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/More.tsx"),LemonDivider=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonDivider/index.ts"),LemonTable=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/index.ts"),columnUtils=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/columnUtils.tsx"),LemonTableLink=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/LemonTableLink.tsx"),Spinner=__webpack_require__("../../frontend/src/lib/lemon-ui/Spinner/Spinner.tsx"),react=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),types=__webpack_require__("../../frontend/src/types.ts"),PersonsManagementSceneTabs=__webpack_require__("../../frontend/src/scenes/persons-management/PersonsManagementSceneTabs.tsx"),kea_loaders_lib=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.7_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),api=__webpack_require__("../../frontend/src/lib/api.ts"),personsLogic=__webpack_require__("../../frontend/src/scenes/persons/personsLogic.tsx"),cohortsModel=__webpack_require__("../../frontend/src/models/cohortsModel.ts"),deleteWithUndo=__webpack_require__("../../frontend/src/lib/utils/deleteWithUndo.tsx"),projectTreeLogic=__webpack_require__("../../frontend/src/layout/panel-layout/ProjectTree/projectTreeLogic.tsx"),exportsLogic=__webpack_require__("../../frontend/src/lib/components/ExportButton/exportsLogic.ts");let DEFAULT_COHORT_FILTERS={search:void 0,page:1},cohortsSceneLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","cohorts","cohortsSceneLogic"]),(0,index_esm.connect)(()=>({actions:[exportsLogic.exportsLogic,["startExport"]]})),(0,index_esm.actions)(()=>({setCohortFilters:filters=>({filters}),deleteCohort:cohort=>({cohort}),exportCohortPersons:(id,columns)=>({id,columns}),setPollTimeout:pollTimeout=>({pollTimeout})})),(0,index_esm.reducers)({pollTimeout:[null,{setPollTimeout:(_,_ref)=>{let{pollTimeout}=_ref;return pollTimeout}}],cohortFilters:[DEFAULT_COHORT_FILTERS,{setCohortFilters:(state,_ref2)=>{let{filters}=_ref2;return{...state,...filters}}}],cohorts:[{count:0,results:[]},{deleteCohort:(state,_ref3)=>{let{cohort}=_ref3;return cohort.id?{...state,results:state.results.filter(c=>c.id!==cohort.id)}:state}}]}),(0,index_esm.selectors)({breadcrumbs:[()=>[],()=>[{key:"cohorts",name:"Cohorts",path:urls.j.cohorts()}]],count:[selectors=>[selectors.cohorts],cohorts=>cohorts.count],paramsFromFilters:[s=>[s.cohortFilters],filters=>({...filters,limit:100,offset:filters.page?(filters.page-1)*100:0})],pagination:[s=>[s.cohortFilters,s.count],(filters,count)=>({controlled:!0,pageSize:100,currentPage:filters.page||1,entryCount:count})]}),(0,kea_loaders_lib.loaders)(_ref4=>{let{values}=_ref4;return{cohorts:{__default:{count:0,results:[]},loadCohorts:async()=>{let response=await api.ZP.cohorts.listPaginated({...values.paramsFromFilters});return personsLogic.T.findMounted({syncWithUrl:!0})?.actions.loadCohorts(),{count:response.count,results:response.results.map(cohort=>(0,cohortsModel.kO)(cohort))}}}}}),(0,index_esm.listeners)(_ref5=>{let{actions,values}=_ref5;return{loadCohortsSuccess:async _ref6=>{let{cohorts}=_ref6;cohorts.results.filter(cohort=>cohort.is_calculating).length>0&&lib.router.values.location.pathname.includes(urls.j.cohorts())&&actions.setPollTimeout(window.setTimeout(actions.loadCohorts,5e3))},setCohortFilters:async()=>{actions.loadCohorts()},deleteCohort:async _ref7=>{let{cohort}=_ref7;await (0,deleteWithUndo.S)({endpoint:api.ZP.cohorts.determineDeleteEndpoint(),object:cohort,callback:undo=>{actions.loadCohorts(),cohort.id&&"new"!==cohort.id&&(undo?(0,projectTreeLogic.BI)("cohort",String(cohort.id)):(0,projectTreeLogic.qJ)("cohort",String(cohort.id)))}})},exportCohortPersons:async _ref8=>{let{id,columns}=_ref8,cohort=values.cohorts.results.find(c=>c.id===id),exportCommand={export_format:types.P5.CSV,export_context:{path:`/api/cohort/${id}/persons`,columns,filename:cohort?.name?`cohort-${cohort.name}`:"cohort"}};columns&&columns.length>0&&(exportCommand.export_context.columns=columns),actions.startExport(exportCommand)}}}),(0,lib.actionToUrl)(_ref9=>{let{values}=_ref9;return{setCohortFilters:()=>{let searchParams={...values.cohortFilters};return Object.keys(searchParams).forEach(key=>{(void 0===searchParams[key]||searchParams[key]===DEFAULT_COHORT_FILTERS[key])&&delete searchParams[key]}),[lib.router.values.location.pathname,searchParams,lib.router.values.hashParams,{replace:!0}]}}}),(0,lib.urlToAction)(_ref10=>{let{actions}=_ref10;return{[urls.j.cohorts()]:(_,searchParams)=>{let{page,search}=searchParams,filtersFromUrl={search};filtersFromUrl.page=void 0!==page?parseInt(page):void 0,actions.setCohortFilters({...DEFAULT_COHORT_FILTERS,...filtersFromUrl})}}}),(0,index_esm.beforeUnmount)(_ref11=>{let{values}=_ref11;clearTimeout(values.pollTimeout||void 0)}),(0,index_esm.afterMount)(_ref12=>{let{actions}=_ref12;actions.loadCohorts()})]);var SceneContent=__webpack_require__("../../frontend/src/layout/scenes/SceneContent.tsx"),css_classes=__webpack_require__("../../frontend/src/lib/utils/css-classes.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let scene={component:Cohorts_Cohorts,logic:cohortsSceneLogic};function Cohorts_Cohorts(){let{cohorts,cohortsLoading,pagination,cohortFilters}=(0,index_esm.useValues)(cohortsSceneLogic),{deleteCohort,exportCohortPersons,setCohortFilters}=(0,index_esm.useActions)(cohortsSceneLogic),{searchParams}=(0,index_esm.useValues)(lib.router),[searchTerm,setSearchTerm]=(0,react.useState)(cohortFilters.search||""),columns=[{title:"Name",dataIndex:"name",width:"30%",sorter:(a,b)=>(a.name||"").localeCompare(b.name||""),render:function Render(name,_ref){let{id,description}=_ref;return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(LemonTableLink.i,{to:(0,lib.combineUrl)(urls.j.cohort(id),searchParams).url,title:name?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:name}):"Untitled",description:description})})}},{title:"Users in cohort",align:"right",render:function RenderCount(_,cohort){return cohort.count?.toLocaleString()},dataIndex:"count",sorter:(a,b)=>(a.count||0)-(b.count||0)},(0,columnUtils.JB)(),(0,columnUtils.rw)(),{title:"Last calculated",tooltip:"PostHog calculates what users belong to each cohort. This is then used when filtering on cohorts in the Trends page etc. Calculating happens every 24 hours, or whenever a cohort is updated",render:function RenderCalculation(_,cohort){return cohort.is_static?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"N/A"}):cohort.is_calculating?(0,jsx_runtime.jsxs)("span",{className:"flex items-center",children:["in progress ",(0,jsx_runtime.jsx)(Spinner.$,{className:"ml-2"})]}):(0,dayjs.Bv)(cohort.last_calculation).fromNow()}},{width:0,render:function RenderActions(_,cohort){return(0,jsx_runtime.jsx)(More.T,{overlay:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(LemonButton.J,{to:urls.j.cohort(cohort.id),fullWidth:!0,children:"Edit"}),(0,jsx_runtime.jsx)(LemonButton.J,{to:(0,lib.combineUrl)(urls.j.replay(),{filters:{properties:[{key:"id",label:cohort.name,type:"cohort",value:cohort.id}]}}).url,fullWidth:!0,children:"View session recordings"}),(0,jsx_runtime.jsx)(LemonButton.J,{onClick:()=>exportCohortPersons(cohort.id,["distinct_ids.0","id","name","properties.email"]),tooltip:"Export specific columns for users belonging to this cohort in CSV format. Includes distinct id, internal id, email, and name",fullWidth:!0,children:"Export important columns for users"}),(0,jsx_runtime.jsx)(LemonButton.J,{onClick:()=>exportCohortPersons(cohort.id),tooltip:"Export all users belonging to this cohort in CSV format.",fullWidth:!0,children:"Export all columns for users"}),(0,jsx_runtime.jsx)(LemonDivider.p,{}),(0,jsx_runtime.jsx)(LemonButton.J,{status:"danger",onClick:()=>{deleteCohort({id:cohort.id,name:cohort.name,deleted:!0})},fullWidth:!0,children:"Delete cohort"})]})})}}];return(0,jsx_runtime.jsxs)(SceneContent._W,{children:[(0,jsx_runtime.jsx)(PersonsManagementSceneTabs.c,{tabKey:"cohorts",buttons:(0,jsx_runtime.jsx)(LemonButton.J,{type:"primary","data-attr":"new-cohort",onClick:()=>lib.router.actions.push(urls.j.cohort("new")),children:"New cohort"})}),(0,jsx_runtime.jsx)(SceneContent.sG,{name:"Cohorts",description:"A catalog of identified persons and your created cohorts.",resourceType:{type:"cohort",typePlural:"cohorts"},docsURL:"https://posthog.com/docs/data/cohorts"}),(0,jsx_runtime.jsx)(SceneContent.Vl,{}),(0,jsx_runtime.jsx)(ProductIntroduction.C,{productName:"Cohorts",productKey:types.Md.COHORTS,thingName:"cohort",description:"Use cohorts to group people together, such as users who used your app in the last week, or people who viewed the signup page but didn't convert.",isEmpty:0==cohorts.count&&!cohortsLoading&&!searchTerm,docsURL:"https://posthog.com/docs/data/cohorts",action:()=>lib.router.actions.push(urls.j.cohort("new")),customHog:hedgehogs.ListHog}),(0,jsx_runtime.jsx)("div",{className:(0,css_classes.cn)("flex justify-between items-center mb-0 gap-2"),children:(0,jsx_runtime.jsx)(src.DF,{type:"search",placeholder:"Search for cohorts",onChange:search=>{setSearchTerm(search),setCohortFilters({search:search||void 0,page:1})},value:searchTerm})}),(0,jsx_runtime.jsx)(LemonTable.g,{columns:columns,loading:cohortsLoading,rowKey:"id",pagination:pagination,dataSource:cohorts.results,nouns:["cohort","cohorts"],"data-attr":"cohorts-table"})]})}},"../../frontend/src/scenes/groups/groupsSceneLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{C:()=>groupsSceneLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_router__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),lib_introductions_groupsAccessLogic__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/introductions/groupsAccessLogic.ts"),lib_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/utils.tsx"),scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/scenes/urls.ts"),_models_groupsModel__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/models/groupsModel.ts");let groupsSceneLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","groups","groupsSceneLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)(()=>({values:[_models_groupsModel__WEBPACK_IMPORTED_MODULE_6__.$,["aggregationLabel","groupTypes","groupTypesLoading","groupsAccessStatus"]]})),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setGroupTypeIndex:groupTypeIndex=>({groupTypeIndex})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({groupTypeIndex:[0,{setGroupTypeIndex:(_,_ref)=>{let{groupTypeIndex}=_ref;return groupTypeIndex}}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({tabs:[()=>[],()=>[]],groupTypeName:[s=>[s.aggregationLabel,s.groupTypeIndex],(aggregationLabel,groupTypeIndex)=>aggregationLabel(groupTypeIndex).singular],groupTypeNamePlural:[s=>[s.aggregationLabel,s.groupTypeIndex],(aggregationLabel,groupTypeIndex)=>aggregationLabel(groupTypeIndex).plural],breadcrumbs:[s=>[s.groupTypeIndex,s.groupTypeNamePlural,s.showGroupsIntroductionPage],(groupTypeIndex,groupTypeNamePlural,showGroupsIntroductionPage)=>[{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_4__.x.Groups,name:showGroupsIntroductionPage?"Groups":(0,lib_utils__WEBPACK_IMPORTED_MODULE_3__.fm)(groupTypeNamePlural),path:scenes_urls__WEBPACK_IMPORTED_MODULE_5__.j.groups(groupTypeIndex)}]],showGroupsIntroductionPage:[s=>[s.groupsAccessStatus],groupsAccessStatus=>[lib_introductions_groupsAccessLogic__WEBPACK_IMPORTED_MODULE_2__.Q.HasAccess,lib_introductions_groupsAccessLogic__WEBPACK_IMPORTED_MODULE_2__.Q.HasGroupTypes,lib_introductions_groupsAccessLogic__WEBPACK_IMPORTED_MODULE_2__.Q.NoAccess].includes(groupsAccessStatus)]}),(0,kea_router__WEBPACK_IMPORTED_MODULE_1__.urlToAction)(_ref2=>{let{actions}=_ref2;return{[scenes_urls__WEBPACK_IMPORTED_MODULE_5__.j.groups(":key")]:_ref3=>{let{key}=_ref3;key&&actions.setGroupTypeIndex(parseInt(key))}}})])},"../../frontend/src/scenes/persons-management/PersonsManagementSceneTabs.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{c:()=>PersonsManagementSceneTabs});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),PageHeader=__webpack_require__("../../frontend/src/lib/components/PageHeader.tsx"),LemonTabs=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTabs/index.ts"),groupsModel=__webpack_require__("../../frontend/src/models/groupsModel.ts"),groupsAccessLogic=__webpack_require__("../../frontend/src/lib/introductions/groupsAccessLogic.ts"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),groupsSceneLogic=__webpack_require__("../../frontend/src/scenes/groups/groupsSceneLogic.ts"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),featureFlagLogic=__webpack_require__("../../frontend/src/lib/logic/featureFlagLogic.ts"),constants=__webpack_require__("../../frontend/src/lib/constants.tsx"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let personsManagementSceneLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","persons-management","personsManagementSceneLogic"]),(0,index_esm.connect)(()=>({actions:[groupsSceneLogic.C,["setGroupTypeIndex"]],values:[groupsModel.$,["aggregationLabel","groupTypes","groupTypesLoading","groupsAccessStatus"],featureFlagLogic.featureFlagLogic,["featureFlags"]]})),(0,index_esm.selectors)({tabs:[s=>[s.groupTabs],groupTabs=>[{key:"persons",url:urls.j.persons(),label:"People",tooltipDocLink:"https://posthog.com/docs/data/persons"},{key:"cohorts",url:urls.j.cohorts(),label:"Cohorts",tooltipDocLink:"https://posthog.com/docs/data/cohorts"},...groupTabs]],crmFeatureFlag:[s=>[s.featureFlags],featureFlags=>featureFlags[constants.y8.CRM_ITERATION_ONE]],groupTabs:[s=>[s.groupTypes,s.groupsAccessStatus,s.aggregationLabel],(groupTypes,groupsAccessStatus,aggregationLabel)=>[groupsAccessLogic.Q.HasAccess,groupsAccessLogic.Q.HasGroupTypes,groupsAccessLogic.Q.NoAccess].includes(groupsAccessStatus)?[{key:"groups-0",label:"Groups",url:urls.j.groups(0)}]:Array.from(groupTypes.values()).map(_ref=>{let{group_type_index}=_ref;return{key:`groups-${group_type_index}`,label:(0,utils.fm)(aggregationLabel(group_type_index).plural),url:urls.j.groups(group_type_index)}})],lemonTabs:[s=>[s.tabs],tabs=>tabs.map(tab=>({key:tab.key,label:(0,jsx_runtime.jsx)("span",{"data-attr":`persons-management-${tab.key}-tab`,children:tab.label}),tooltipDocLink:tab.tooltipDocLink,link:tab.url}))]})]);function PersonsManagementSceneTabs(_ref){let{tabKey,buttons}=_ref,{lemonTabs}=(0,index_esm.useValues)(personsManagementSceneLogic),{showGroupsOptions}=(0,index_esm.useValues)(groupsModel.$),{featureFlags}=(0,index_esm.useValues)(featureFlagLogic.featureFlagLogic),newSceneLayout=featureFlags[constants.y8.NEW_SCENE_LAYOUT];return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(PageHeader.m,{caption:newSceneLayout?null:showGroupsOptions?"A catalog of identified persons, groups, and your created cohorts.":"A catalog of identified persons and your created cohorts.",buttons:buttons}),(0,jsx_runtime.jsx)(LemonTabs.T,{activeKey:tabKey,tabs:lemonTabs,className:"-mt-4 -mx-4 [&>ul]:px-4 [&>ul]:mb-0"})]})}},"../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!../../node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.5.6_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!../../node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!../../frontend/src/scenes/cohorts/Cohorts.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".cohort-recalculating{background-color:var(--color-bg-primary);border-radius:var(--radius);margin-top:1rem;padding:.5rem 1rem}.cohort-csv-dragger{border-color:var(--color-accent);border-radius:var(--radius);border-style:dashed;border-width:2px;height:155px!important;margin-top:1rem}.cohort-csv-dragger:hover{border-color:var(--primary-3000-hover)}",""]),module.exports=exports}}]);