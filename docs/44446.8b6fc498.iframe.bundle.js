(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[44446],{"../../frontend/src/lib/components/FilterBar.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{f:()=>FilterBar});var clsx__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),_posthog_icons__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.30.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),_layout_scenes_components_SceneStickyBar__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/layout/scenes/components/SceneStickyBar.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let FilterBar=_ref=>{let{top,left,right,className}=_ref,[expanded,setExpanded]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(_layout_scenes_components_SceneStickyBar__WEBPACK_IMPORTED_MODULE_3__.S,{className:className,children:[top,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between gap-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"flex items-start shrink-0",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:"flex flex-1 flex-row gap-2 items-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"flex flex-row gap-1 items-center flex-1 md:flex-none",children:left}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.Jp,{type:"secondary",size:"small",className:"sm:hidden",onClick:()=>setExpanded(expanded=>!expanded),icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_1__.IconFilter,{})})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"hidden sm:flex gap-2",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(FoldableFilters,{children:right})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:(0,clsx__WEBPACK_IMPORTED_MODULE_5__.default)("flex sm:hidden flex-col gap-2 overflow-hidden transition-all duration-200",expanded?"max-h-[500px]":"max-h-0"),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(FoldableFilters,{children:right})})]})]})},FoldableFilters=_ref2=>{let{children}=_ref2;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"flex flex-row md:flex-row-reverse flex-wrap gap-2 md:[&>*]:grow-0 [&>*]:grow w-full",children:children})}},"../../frontend/src/scenes/project-homepage/ProjectHomePageCompactListItem.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{x:()=>ProjectHomePageCompactListItem}),__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js");var _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function ProjectHomePageCompactListItem(_ref){let{to,onClick,title,subtitle,prefix,suffix}=_ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{fullWidth:!0,to:to,onClick:onClick,className:"h-12",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{className:"flex items-start justify-between overflow-hidden gap-2 flex-1",children:[prefix?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{className:"flex shrink-0 text-secondary text-xl",children:prefix}):null,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{className:"truncate flex flex-col gap-y-0.5 flex-1",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{className:"text-link truncate",children:title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{className:"truncate text-secondary font-normal text-xs",children:subtitle})]}),suffix?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{className:"shrink-0",children:suffix}):null]})})}},"../../frontend/src/scenes/session-recordings/components/RecordingRow.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>RecordingRow});var clsx__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib_lemon_ui_LemonSnack__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonSnack/index.ts"),lib_lemon_ui_ProfilePicture__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/lemon-ui/ProfilePicture/index.ts"),lib_lemon_ui_icons__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/lemon-ui/icons/index.ts"),lib_utils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/utils.tsx"),scenes_persons_person_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/scenes/persons/person-utils.ts"),scenes_session_recordings_player_modal_sessionPlayerModalLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/scenes/session-recordings/player/modal/sessionPlayerModalLogic.ts"),scenes_session_recordings_sessionRecordingEventUsageLogic__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/scenes/session-recordings/sessionRecordingEventUsageLogic.ts"),_project_homepage_ProjectHomePageCompactListItem__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../frontend/src/scenes/project-homepage/ProjectHomePageCompactListItem.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function ActivityScoreLabel(_ref){let{score}=_ref,n=null!=score?score:0,backgroundColor="bg-primary-alt-highlight",description="very low";return n>=90?(backgroundColor="bg-success-highlight",description="very high"):n>=75?(backgroundColor="bg-success-highlight",description="high"):n>=50?(backgroundColor="bg-warning-highlight",description="medium"):n>=25&&(backgroundColor="bg-warning-highlight",description="low"),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(lib_lemon_ui_LemonSnack__WEBPACK_IMPORTED_MODULE_1__.L,{className:(0,clsx__WEBPACK_IMPORTED_MODULE_10__.default)(backgroundColor,"text-xs"),children:["activity: ",description]})}function RecordingRow(_ref2){let{recording}=_ref2,{openSessionPlayer}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(scenes_session_recordings_player_modal_sessionPlayerModalLogic__WEBPACK_IMPORTED_MODULE_6__.A),{reportRecordingOpenedFromRecentRecordingList}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(scenes_session_recordings_sessionRecordingEventUsageLogic__WEBPACK_IMPORTED_MODULE_7__.G);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_project_homepage_ProjectHomePageCompactListItem__WEBPACK_IMPORTED_MODULE_8__.x,{title:(0,scenes_persons_person_utils__WEBPACK_IMPORTED_MODULE_5__.y)(recording.person),subtitle:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(ActivityScoreLabel,{score:recording.activity_score}),prefix:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(lib_lemon_ui_ProfilePicture__WEBPACK_IMPORTED_MODULE_2__.Y,{name:(0,scenes_persons_person_utils__WEBPACK_IMPORTED_MODULE_5__.y)(recording.person)}),suffix:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"flex items-center justify-end text-text-3000",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("span",{children:(0,lib_utils__WEBPACK_IMPORTED_MODULE_4__.C7)(recording.recording_duration)}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(lib_lemon_ui_icons__WEBPACK_IMPORTED_MODULE_3__.Ud,{className:"text-2xl ml-2"})]}),onClick:()=>{openSessionPlayer({id:recording.id}),reportRecordingOpenedFromRecentRecordingList()}})}},"../../frontend/src/scenes/web-analytics/WebAnalyticsScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{WebAnalyticsScene:()=>WebAnalyticsScene,scene:()=>scene});var posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.30.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),PageHeader=__webpack_require__("../../frontend/src/lib/components/PageHeader.tsx"),clsx_m=__webpack_require__("../../node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),react=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),ProductIntroduction=__webpack_require__("../../frontend/src/lib/components/ProductIntroduction/ProductIntroduction.tsx"),VersionCheckerBanner=__webpack_require__("../../frontend/src/lib/components/VersionChecker/VersionCheckerBanner.tsx"),hedgehogs=__webpack_require__("../../frontend/src/lib/components/hedgehogs.tsx"),constants=__webpack_require__("../../frontend/src/lib/constants.tsx"),LemonButton=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/index.ts"),LemonDivider=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonDivider/index.ts"),LemonSegmentedSelect=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonSegmentedSelect/LemonSegmentedSelect.tsx"),LemonTabs=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTabs/index.ts"),LemonTag=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTag/index.ts"),Link=__webpack_require__("../../frontend/src/lib/lemon-ui/Link/Link.tsx"),Popover=__webpack_require__("../../frontend/src/lib/lemon-ui/Popover/index.ts"),icons=__webpack_require__("../../frontend/src/lib/lemon-ui/icons/index.ts"),featureFlagLogic=__webpack_require__("../../frontend/src/lib/logic/featureFlagLogic.ts"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),product_intents=__webpack_require__("../../frontend/src/lib/utils/product-intents.ts"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),DateFilter=__webpack_require__("../../frontend/src/lib/components/DateFilter/DateFilter.tsx"),FilterBar=__webpack_require__("../../frontend/src/lib/components/FilterBar.tsx"),LemonInputSelect=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonInputSelect/LemonInputSelect.tsx"),LemonSwitch=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonSwitch/index.ts"),Tooltip=__webpack_require__("../../frontend/src/lib/lemon-ui/Tooltip/index.ts"),CompareFilter=__webpack_require__("../../frontend/src/lib/components/CompareFilter/CompareFilter.tsx"),lemon_ui_LemonSegmentedSelect=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonSegmentedSelect/index.ts"),icons_icons=__webpack_require__("../../frontend/src/lib/lemon-ui/icons/icons.tsx"),userLogic=__webpack_require__("../../frontend/src/scenes/userLogic.ts"),Reload=__webpack_require__("../../frontend/src/queries/nodes/DataNode/Reload.tsx"),types=__webpack_require__("../../frontend/src/types.ts"),webAnalyticsLogic=__webpack_require__("../../frontend/src/scenes/web-analytics/webAnalyticsLogic.tsx"),schema_general=__webpack_require__("../../frontend/src/queries/schema/schema-general.ts"),common=__webpack_require__("../../frontend/src/scenes/web-analytics/common.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let SORT_BY_TO_LABEL={[schema_general.nV.Visitors]:"Visitors",[schema_general.nV.Views]:"Views",[schema_general.nV.Clicks]:"Clicks",[schema_general.nV.BounceRate]:"Bounce rate",[schema_general.nV.AverageScrollPercentage]:"Average scroll percentage",[schema_general.nV.ScrollGt80Percentage]:"Scroll > 80%",[schema_general.nV.TotalConversions]:"Total conversions",[schema_general.nV.UniqueConversions]:"Unique conversions",[schema_general.nV.ConversionRate]:"Conversion rate",[schema_general.nV.ConvertingUsers]:"Converting users",[schema_general.nV.RageClicks]:"Rage clicks",[schema_general.nV.DeadClicks]:"Dead clicks",[schema_general.nV.Errors]:"Errors"},TableSortingIndicator=()=>{let{tablesOrderBy,productTab}=(0,index_esm.useValues)(webAnalyticsLogic.W),{clearTablesOrderBy}=(0,index_esm.useActions)(webAnalyticsLogic.W);return tablesOrderBy&&productTab===common.lZ.ANALYTICS?(0,jsx_runtime.jsx)(src.Jp,{type:"secondary",size:"small",icon:(0,jsx_runtime.jsx)(icons.B4,{className:(0,clsx_m.default)({"rotate-180":"ASC"===tablesOrderBy[1]})}),sideIcon:(0,jsx_runtime.jsx)(posthog_icons_es.IconX,{}),onClick:clearTablesOrderBy,children:(0,jsx_runtime.jsxs)("span",{children:["Sort by: ",SORT_BY_TO_LABEL[tablesOrderBy[0]]]})}):null};var injectStylesIntoStyleTag=__webpack_require__("../../node_modules/.pnpm/style-loader@2.0.0_webpack@5.88.2/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),WebAnalyticsLiveUserCount=__webpack_require__("../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!../../node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.5.6_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!../../node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!../../frontend/src/scenes/web-analytics/WebAnalyticsLiveUserCount.scss"),WebAnalyticsLiveUserCount_default=__webpack_require__.n(WebAnalyticsLiveUserCount),options={};options.insert="head",options.singleton=!1,injectStylesIntoStyleTag_default()(WebAnalyticsLiveUserCount_default(),options),WebAnalyticsLiveUserCount_default().locals;var teamLogic=__webpack_require__("../../frontend/src/scenes/teamLogic.tsx"),apiHost=__webpack_require__("../../frontend/src/lib/utils/apiHost.ts");let liveWebAnalyticsLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","webAnalytics","liveWebAnalyticsLogic"]),(0,index_esm.connect)(()=>({values:[teamLogic.teamLogic,["currentTeam"]]})),(0,index_esm.actions)(()=>({pollStats:!0,setLiveUserCount:_ref=>{let{liveUserCount,now}=_ref;return{liveUserCount,now}},setNow:_ref2=>{let{now}=_ref2;return{now}},setIsHovering:isHovering=>({isHovering})})),(0,index_esm.reducers)({liveUserCount:[null,{setLiveUserCount:(_,_ref3)=>{let{liveUserCount}=_ref3;return liveUserCount}}],statsUpdatedTime:[null,{setLiveUserCount:(_,_ref4)=>{let{now}=_ref4;return now}}],now:[null,{setNow:(_,_ref5)=>{let{now}=_ref5;return now},setLiveUserCount:(_,_ref6)=>{let{now}=_ref6;return now}}],isHovering:[!1,{setIsHovering:(_,_ref7)=>{let{isHovering}=_ref7;return isHovering}}]}),(0,index_esm.selectors)({liveUserUpdatedSecondsAgo:[s=>[s.statsUpdatedTime,s.now],(statsUpdatedTime,now)=>{if(!statsUpdatedTime||!now)return null;let seconds=Math.ceil((now.getTime()-statsUpdatedTime.getTime())/1e3);return seconds<0||seconds>=300?null:seconds}]}),(0,index_esm.listeners)(_ref8=>{let{actions,values,cache}=_ref8;return{pollStats:async()=>{try{if(!values.currentTeam)return;let response=await fetch(`${(0,apiHost.Kn)()}/stats`,{headers:{Authorization:`Bearer ${values.currentTeam.live_events_token}`}}),liveUserCount=(await response.json()).users_on_product||0;actions.setLiveUserCount({liveUserCount,now:new Date})}catch(error){console.error("Failed to poll stats:",error)}},setIsHovering:_ref9=>{let{isHovering}=_ref9;isHovering?(cache.nowInterval&&clearInterval(cache.nowInterval),actions.setNow({now:new Date}),cache.nowInterval=setInterval(()=>{actions.setNow({now:new Date})},500)):cache.nowInterval&&(clearInterval(cache.nowInterval),cache.nowInterval=null)}}}),(0,index_esm.events)(_ref10=>{let{actions,cache}=_ref10;return{afterMount:()=>{actions.setNow({now:new Date}),actions.pollStats(),cache.statsInterval=setInterval(()=>{actions.pollStats()},3e4)},beforeUnmount:()=>{cache.statsInterval&&(clearInterval(cache.statsInterval),cache.statsInterval=null),cache.nowInterval&&(clearInterval(cache.nowInterval),cache.nowInterval=null)}}})]),TooltipContent=()=>{let{currentTeam}=(0,index_esm.useValues)(teamLogic.teamLogic),{liveUserUpdatedSecondsAgo,liveUserCount}=(0,index_esm.useValues)(liveWebAnalyticsLogic),{setIsHovering}=(0,index_esm.useActions)(liveWebAnalyticsLogic);if((0,react.useEffect)(()=>(setIsHovering(!0),()=>setIsHovering(!1)),[setIsHovering]),null==liveUserCount)return null;let usersOnlineString=`${(0,utils.Lc)(liveUserCount)} ${1===liveUserCount?"user has":"users have"} been seen recently`,inTeamString=currentTeam?` in ${currentTeam.name}`:"",updatedString=0===liveUserUpdatedSecondsAgo?"updated just now":null==liveUserUpdatedSecondsAgo?"":`updated ${liveUserUpdatedSecondsAgo} seconds ago`;return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("div",{children:[usersOnlineString,inTeamString]}),updatedString&&(0,jsx_runtime.jsxs)("div",{children:["(",updatedString,")"]})]})},WebAnalyticsLiveUserCount_WebAnalyticsLiveUserCount=()=>{let{liveUserCount}=(0,index_esm.useValues)(liveWebAnalyticsLogic);return null==liveUserCount?null:(0,jsx_runtime.jsx)(Tooltip.u,{title:(0,jsx_runtime.jsx)(TooltipContent,{}),interactive:!0,delayMs:0,docLink:"https://posthog.com/docs/web-analytics/faq#i-am-online-but-the-online-user-count-is-not-reflecting-my-user",children:(0,jsx_runtime.jsxs)("div",{className:"flex flex-row items-center justify-center",children:[(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.default)("live-user-indicator",liveUserCount>0?"online":"offline")}),(0,jsx_runtime.jsxs)("span",{className:"whitespace-nowrap","data-attr":"web-analytics-live-user-count",children:[(0,jsx_runtime.jsx)("strong",{children:(0,utils.d$)(liveUserCount)})," recently online"]})]})})};var TaxonomicFilter_types=__webpack_require__("../../frontend/src/lib/components/TaxonomicFilter/types.ts"),TaxonomicPopover=__webpack_require__("../../frontend/src/lib/components/TaxonomicPopover/TaxonomicPopover.tsx"),useWindowSize=__webpack_require__("../../frontend/src/lib/hooks/useWindowSize.ts"),actionsModel=__webpack_require__("../../frontend/src/models/actionsModel.ts");let WebConversionGoal=()=>{let{isWindowLessThan}=(0,useWindowSize.i)(),{conversionGoal,productTab}=(0,index_esm.useValues)(webAnalyticsLogic.W),{setConversionGoal}=(0,index_esm.useActions)(webAnalyticsLogic.W),{actions}=(0,index_esm.useValues)(actionsModel.D),[group,setGroup]=(0,react.useState)(TaxonomicFilter_types.t.CustomEvents),value=conversionGoal&&"actionId"in conversionGoal?conversionGoal.actionId:conversionGoal?.customEventName;return productTab!==common.lZ.ANALYTICS?null:(0,jsx_runtime.jsx)(TaxonomicPopover.b,{allowClear:!0,"data-attr":"web-analytics-conversion-filter",groupType:group,value:value,onChange:(changedValue,groupType)=>{groupType===TaxonomicFilter_types.t.Actions&&"number"==typeof changedValue?(setConversionGoal({actionId:changedValue}),setGroup(TaxonomicFilter_types.t.Actions)):groupType===TaxonomicFilter_types.t.CustomEvents&&"string"==typeof changedValue&&changedValue?(setConversionGoal({customEventName:changedValue}),setGroup(TaxonomicFilter_types.t.CustomEvents)):setConversionGoal(null)},renderValue:()=>{if(!conversionGoal)return null;if("actionId"in conversionGoal){var _conversionGoalAction;let conversionGoalAction=actions.find(a=>a.id===conversionGoal.actionId);return(0,jsx_runtime.jsx)("span",{className:"text-overflow max-w-full",children:null!==(_conversionGoalAction=conversionGoalAction?.name)&&void 0!==_conversionGoalAction?_conversionGoalAction:"Conversion goal"})}return(0,jsx_runtime.jsx)("span",{className:"text-overflow max-w-full",children:conversionGoal?.customEventName})},groupTypes:[TaxonomicFilter_types.t.CustomEvents,TaxonomicFilter_types.t.Actions],icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconCursor,{}),placeholder:isWindowLessThan("xl")?"Goal":isWindowLessThan("2xl")?"Conversion goal":"Add conversion goal",placeholderClass:"",size:"small"})};var PropertyFilters=__webpack_require__("../../frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),PropertyFilters_utils=__webpack_require__("../../frontend/src/lib/components/PropertyFilters/utils.ts");let WebPropertyFilters=()=>{let{rawWebAnalyticsFilters,preAggregatedEnabled}=(0,index_esm.useValues)(webAnalyticsLogic.W),{setWebAnalyticsFilters}=(0,index_esm.useActions)(webAnalyticsLogic.W),[displayFilters,setDisplayFilters]=(0,react.useState)(!1),taxonomicGroupTypes=[TaxonomicFilter_types.t.EventProperties,TaxonomicFilter_types.t.SessionProperties,...preAggregatedEnabled?[]:[TaxonomicFilter_types.t.PersonProperties]],webAnalyticsPropertyAllowList=preAggregatedEnabled?{[TaxonomicFilter_types.t.EventProperties]:["$host","$device_type","$browser","$os","$referring_domain","$geoip_country_code","$geoip_city_name","$geoip_subdivision_1_code","$geoip_subdivision_1_name","$geoip_time_zone","$pathname","metadata.loggedIn","metadata.backend"],[TaxonomicFilter_types.t.SessionProperties]:["$entry_pathname","$end_pathname","$entry_utm_source","$entry_utm_medium","$entry_utm_campaign","$entry_utm_term","$entry_utm_content","$channel_type"]}:void 0;return(0,jsx_runtime.jsx)(src.J2,{visible:displayFilters,onClickOutside:()=>setDisplayFilters(!1),placement:"bottom",className:"max-w-200",overlay:(0,jsx_runtime.jsx)("div",{className:"p-2",children:(0,jsx_runtime.jsx)(PropertyFilters.t,{disablePopover:!0,propertyAllowList:webAnalyticsPropertyAllowList,taxonomicGroupTypes:taxonomicGroupTypes,onChange:filters=>setWebAnalyticsFilters(filters.filter(PropertyFilters_utils.WO)),propertyFilters:rawWebAnalyticsFilters,pageKey:"web-analytics",eventNames:["$pageview"]})}),children:(0,jsx_runtime.jsx)(LemonButton.J,{icon:(0,jsx_runtime.jsx)(icons.Xd,{count:rawWebAnalyticsFilters.length,showZero:!1,children:(0,jsx_runtime.jsx)(posthog_icons_es.IconFilter,{})}),type:"secondary","data-attr":"show-web-analytics-filters",onClick:()=>setDisplayFilters(displayFilters=>!displayFilters),children:"Filters"})})},WebAnalyticsFilters=_ref=>{let{tabs}=_ref,{dateFilter:{dateTo,dateFrom},preAggregatedEnabled}=(0,index_esm.useValues)(webAnalyticsLogic.W),{setDates}=(0,index_esm.useActions)(webAnalyticsLogic.W);return(0,jsx_runtime.jsx)(FilterBar.f,{top:tabs,left:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Reload.H,{iconOnly:!0}),(0,jsx_runtime.jsx)(WebAnalyticsDomainSelector,{}),(0,jsx_runtime.jsx)(WebAnalyticsDeviceToggle,{}),(0,jsx_runtime.jsxs)("div",{className:"hidden ml-2 md:flex items-center gap-2",children:[(0,jsx_runtime.jsx)("span",{className:"text-muted-alt",children:"|"}),(0,jsx_runtime.jsx)(WebAnalyticsLiveUserCount_WebAnalyticsLiveUserCount,{})]})]}),right:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(DateFilter.f,{allowTimePrecision:!0,dateFrom:dateFrom,dateTo:dateTo,onChange:setDates}),(0,jsx_runtime.jsx)(WebAnalyticsCompareFilter,{}),!preAggregatedEnabled&&(0,jsx_runtime.jsx)(WebConversionGoal,{}),(0,jsx_runtime.jsx)(TableSortingIndicator,{}),(0,jsx_runtime.jsx)(WebVitalsPercentileToggle,{}),(0,jsx_runtime.jsx)(PathCleaningToggle,{}),(0,jsx_runtime.jsx)(WebPropertyFilters,{})]})})},PathCleaningToggle=()=>{let{isPathCleaningEnabled}=(0,index_esm.useValues)(webAnalyticsLogic.W),{setIsPathCleaningEnabled}=(0,index_esm.useActions)(webAnalyticsLogic.W),{hasAvailableFeature}=(0,index_esm.useValues)(userLogic.userLogic);return hasAvailableFeature(types.P$.PATHS_ADVANCED)?(0,jsx_runtime.jsx)(src.u,{title:(0,jsx_runtime.jsxs)("div",{className:"p-2",children:[(0,jsx_runtime.jsx)("p",{className:"mb-2",children:"Path cleaning helps standardize URLs by removing unnecessary parameters and fragments."}),(0,jsx_runtime.jsx)("div",{className:"mb-2",children:(0,jsx_runtime.jsx)(src.rU,{to:"https://posthog.com/docs/product-analytics/paths#path-cleaning-rules",children:"Learn more about path cleaning rules"})}),(0,jsx_runtime.jsx)(src.Jp,{icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconGear,{}),type:"primary",size:"small",to:urls.j.settings("project-product-analytics","path-cleaning"),targetBlank:!0,className:"w-full",children:"Edit path cleaning settings"})]}),placement:"top",interactive:!0,children:(0,jsx_runtime.jsxs)(src.Jp,{icon:(0,jsx_runtime.jsx)(icons_icons.IconBranch,{}),onClick:()=>setIsPathCleaningEnabled(!isPathCleaningEnabled),type:"secondary",size:"small",children:["Path cleaning: ",(0,jsx_runtime.jsx)(src.f4,{checked:isPathCleaningEnabled,className:"ml-1"})]})}):null},DomainSettingsLink=()=>(0,jsx_runtime.jsx)(src.rU,{to:urls.j.settings("environment","web-analytics-authorized-urls"),children:"settings"}),WebAnalyticsDomainSelector=()=>{let{domainFilter,hasHostFilter,authorizedDomains}=(0,index_esm.useValues)(webAnalyticsLogic.W),{setDomainFilter}=(0,index_esm.useActions)(webAnalyticsLogic.W);return(0,jsx_runtime.jsx)(src.Yv,{className:"grow md:grow-0",size:"small",value:hasHostFilter?"host":null!=domainFilter?domainFilter:"all",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconGlobe,{}),onChange:value=>setDomainFilter(value),disabledReason:0===authorizedDomains.length?(0,jsx_runtime.jsxs)("span",{children:["No authorized domains, authorize them on ",(0,jsx_runtime.jsx)(DomainSettingsLink,{})]}):void 0,options:[{options:[{label:"All domains",value:"all"},...hasHostFilter?[{label:"All domains (host filter active)",value:"host"}]:[],...authorizedDomains.map(domain=>({label:domain,value:domain}))],footer:(0,jsx_runtime.jsxs)("span",{className:"text-xs px-2",children:["Have more domains? Go to ",(0,jsx_runtime.jsx)(DomainSettingsLink,{})]})}]})},WebAnalyticsDeviceToggle=()=>{let{deviceTypeFilter}=(0,index_esm.useValues)(webAnalyticsLogic.W),{setDeviceTypeFilter}=(0,index_esm.useActions)(webAnalyticsLogic.W);return(0,jsx_runtime.jsx)(lemon_ui_LemonSegmentedSelect.S,{size:"small",value:null!=deviceTypeFilter?deviceTypeFilter:void 0,onChange:value=>setDeviceTypeFilter(value!==deviceTypeFilter?value:null),options:[{value:"Desktop",label:(0,jsx_runtime.jsx)(icons_icons.IconMonitor,{className:"mx-1"}),tooltip:"Desktop devices include laptops and desktops."},{value:"Mobile",label:(0,jsx_runtime.jsx)(icons_icons.IconPhone,{className:"mx-1"}),tooltip:"Mobile devices include smartphones and tablets."}]})},WebVitalsPercentileToggle=()=>{let{webVitalsPercentile,productTab}=(0,index_esm.useValues)(webAnalyticsLogic.W),{setWebVitalsPercentile}=(0,index_esm.useActions)(webAnalyticsLogic.W);return productTab!==common.lZ.WEB_VITALS?null:(0,jsx_runtime.jsx)(lemon_ui_LemonSegmentedSelect.S,{value:webVitalsPercentile,onChange:setWebVitalsPercentile,options:[{value:types.O4.P75,label:"P75"},{value:types.O4.P90,label:(0,jsx_runtime.jsx)(src.u,{title:"P90 is recommended by the standard as a good baseline",delayMs:0,children:"P90"})},{value:types.O4.P99,label:"P99"}]})},WebAnalyticsCompareFilter=()=>{let{compareFilter,productTab}=(0,index_esm.useValues)(webAnalyticsLogic.W),{setCompareFilter}=(0,index_esm.useActions)(webAnalyticsLogic.W);return[common.lZ.ANALYTICS,common.lZ.PAGE_REPORTS].includes(productTab)?(0,jsx_runtime.jsx)(CompareFilter.m,{compareFilter:compareFilter,updateCompareFilter:setCompareFilter}):null};var pageReportsLogic=__webpack_require__("../../frontend/src/scenes/web-analytics/pageReportsLogic.ts");function NoUrlSelectedMessage(){return(0,jsx_runtime.jsxs)("div",{className:"border-2 border-dashed border-primary w-full p-8 rounded flex items-center justify-center gap-8",children:[(0,jsx_runtime.jsx)("div",{className:"flex-shrink-0",children:(0,jsx_runtime.jsx)(hedgehogs.XRayHog2,{alt:"X-ray hedgehog",className:"w-60"})}),(0,jsx_runtime.jsxs)("div",{className:"flex-1 max-w-140",children:[(0,jsx_runtime.jsx)("h2",{children:"Select a page to analyze"}),(0,jsx_runtime.jsx)("p",{className:"ml-0",children:"See detailed performance metrics for any page on your site. Just use the search bar above to find and select a page you want to analyze."})]})]})}function PageReportsFilters(_ref){let{tabs}=_ref,{pagesUrls,pageUrl,isLoading,stripQueryParams,dateFilter}=(0,index_esm.useValues)(pageReportsLogic.z),{setPageUrl,setPageUrlSearchTerm,toggleStripQueryParams,loadPages,setDates}=(0,index_esm.useActions)(pageReportsLogic.z),options=pagesUrls.map(option=>({key:option.url,label:option.url,labelComponent:(0,jsx_runtime.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,jsx_runtime.jsx)("span",{className:"truncate",children:option.url}),(0,jsx_runtime.jsx)("span",{className:"text-muted ml-2",children:option.count.toLocaleString()})]})}));return(0,jsx_runtime.jsx)(FilterBar.f,{top:tabs,left:(0,jsx_runtime.jsx)("div",{className:"flex-1",children:(0,jsx_runtime.jsxs)("div",{className:"relative",children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconGlobe,{className:"absolute left-2 top-1/2 -translate-y-1/2 text-muted"}),(0,jsx_runtime.jsx)(LemonInputSelect.n,{allowCustomValues:!1,placeholder:"Click or type to see top pages",loading:isLoading,size:"small",mode:"single",value:pageUrl?[pageUrl]:null,onChange:val=>setPageUrl(val.length>0?val[0]:null),options:options,onInputChange:val=>setPageUrlSearchTerm(val),"data-attr":"page-reports-url-search",onFocus:()=>loadPages(""),className:"max-w-full pl-8"})]})}),right:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Tooltip.u,{title:"Strip query parameters from URLs (e.g. '?utm_source=...'). This will match the base URL regardless of query parameters.",children:(0,jsx_runtime.jsxs)(src.Jp,{icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconAsterisk,{}),onClick:toggleStripQueryParams,type:"secondary",size:"small",children:["Strip query parameters: ",(0,jsx_runtime.jsx)(LemonSwitch.f,{checked:stripQueryParams,className:"ml-1"})]})}),(0,jsx_runtime.jsx)(DateFilter.f,{dateFrom:dateFilter.dateFrom,dateTo:dateFilter.dateTo,onChange:setDates}),(0,jsx_runtime.jsx)(WebAnalyticsCompareFilter,{})]})})}function PageReports(){let{hasPageUrl,tiles}=(0,index_esm.useValues)(pageReportsLogic.z);return hasPageUrl?(0,jsx_runtime.jsx)("div",{className:"space-y-2 mt-2 h-full min-h-0",children:(0,jsx_runtime.jsx)(Tiles,{tiles:tiles,compact:!0})}):(0,jsx_runtime.jsx)("div",{className:"space-y-2 mt-2",children:(0,jsx_runtime.jsx)(NoUrlSelectedMessage,{})})}var LemonBanner=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonBanner/index.ts"),lemon_ui_Link=__webpack_require__("../../frontend/src/lib/lemon-ui/Link/index.ts");let WebAnalyticsHealthCheck=()=>{let{statusCheck,conversionGoalWarning,productTab}=(0,index_esm.useValues)(webAnalyticsLogic.W);if(productTab===common.lZ.MARKETING)return null;if(conversionGoalWarning&&conversionGoalWarning===common.sx.CustomEventWithNoSessionId)return(0,jsx_runtime.jsxs)(LemonBanner.V,{type:"warning",className:"mt-2",children:[(0,jsx_runtime.jsxs)("p",{children:["A custom event has been set as a conversion goal, but it has been seen with no"," ",(0,jsx_runtime.jsx)("code",{children:"$session_id"}),". This means that some queries will not be able to include these events."]}),(0,jsx_runtime.jsxs)("p",{children:["To fix this, please see"," ",(0,jsx_runtime.jsx)(lemon_ui_Link.r,{to:"https://posthog.com/docs/data/sessions#custom-session-ids",children:"documentation for custom session IDs"}),"."]})]});if(!statusCheck)return null;if(!statusCheck.hasAuthorizedUrls)return(0,jsx_runtime.jsxs)(LemonBanner.V,{type:"warning",className:"mt-2",children:[(0,jsx_runtime.jsx)("p",{children:"We couldn't find any authorized domains. Some of our Web analytics filters won't work correctly until you let us know what domains you are sending your events from."}),(0,jsx_runtime.jsxs)("p",{children:["Please take some time to outline them for us in"," ",(0,jsx_runtime.jsx)(lemon_ui_Link.r,{to:urls.j.settings("environment","web-analytics-authorized-urls"),children:"the settings"}),"."]})]});if(productTab===common.lZ.WEB_VITALS){if(!statusCheck.isSendingWebVitals)return(0,jsx_runtime.jsxs)(LemonBanner.V,{type:"warning",className:"mt-2",children:[(0,jsx_runtime.jsxs)("p",{children:["No ",(0,jsx_runtime.jsx)("code",{children:"$web_vitals"})," events have been received. Web Vitals won't work correctly (it'll be a little empty!)"]}),(0,jsx_runtime.jsxs)("p",{children:["Please see"," ",(0,jsx_runtime.jsx)(lemon_ui_Link.r,{to:"https://posthog.com/docs/web-analytics/web-vitals",children:"documentation for how to set up web vitals"}),"."]})]})}else{if(!statusCheck.isSendingPageViews)return(0,jsx_runtime.jsxs)(LemonBanner.V,{type:"warning",className:"mt-2",children:[(0,jsx_runtime.jsxs)("p",{children:["No ",(0,jsx_runtime.jsx)("code",{children:"$pageview"})," ",statusCheck.isSendingPageLeaves?null:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["or ",(0,jsx_runtime.jsx)("code",{children:"$pageleave"})," "]}),"events have been received. Web analytics won't work correctly (it'll be a little empty!)"]}),(0,jsx_runtime.jsxs)("p",{children:["Please see"," ",(0,jsx_runtime.jsx)(lemon_ui_Link.r,{to:"https://posthog.com/docs/libraries/js",children:"documentation for how to set up posthog-js"}),"."]})]});if(!statusCheck.isSendingPageLeaves)return(0,jsx_runtime.jsxs)(LemonBanner.V,{type:"warning",className:"mt-2",children:[(0,jsx_runtime.jsxs)("p",{children:["No ",(0,jsx_runtime.jsx)("code",{children:"$pageleave"})," events have been received, this means that Bounce rate and Session duration might be inaccurate."]}),(0,jsx_runtime.jsxs)("p",{children:["Please see"," ",(0,jsx_runtime.jsx)(lemon_ui_Link.r,{to:"https://posthog.com/docs/libraries/js",children:"documentation for how to set up posthog-js"}),"."]})]})}return null};var LemonModal=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonModal/index.ts"),WebAnalyticsTile=__webpack_require__("../../frontend/src/scenes/web-analytics/tiles/WebAnalyticsTile.tsx"),insightsUtils=__webpack_require__("../../frontend/src/scenes/web-analytics/insightsUtils.ts");let webAnalyticsModalLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","webAnalytics","webAnalyticsModalLogic"]),(0,index_esm.connect)({values:[webAnalyticsLogic.W,["tiles as webAnalyticsTiles"],pageReportsLogic.z,["tiles as pageReportsTiles"]]}),(0,index_esm.actions)({openModal:(tileId,tabId)=>({tileId,tabId}),closeModal:()=>!0}),(0,index_esm.reducers)({modalTileAndTab:[null,{openModal:(_,_ref)=>{let{tileId,tabId}=_ref;return{tileId,tabId}},closeModal:()=>null}]}),(0,index_esm.selectors)({combinedTiles:[s=>[s.webAnalyticsTiles,s.pageReportsTiles],(webAnalyticsTiles,pageReportsTiles)=>[...webAnalyticsTiles,...pageReportsTiles.flatMap(tile=>"section"===tile.kind&&tile.tiles?[tile,...tile.tiles]:tile)]],modal:[s=>[s.combinedTiles,s.modalTileAndTab],(tiles,modalTileAndTab)=>{if(!modalTileAndTab)return null;let{tileId,tabId}=modalTileAndTab,tile=tiles.find(t=>t.tileId===tileId);if(!tile)return null;let extendQuery=query=>query.kind===schema_general.OH.DataTableNode&&(query.source.kind===schema_general.OH.WebStatsTableQuery||query.source.kind===schema_general.OH.WebExternalClicksTableQuery||query.source.kind===schema_general.OH.WebGoalsQuery)?{...query,source:{...query.source,limit:50}}:query;if("tabs"===tile.kind){let tab=tile.tabs.find(t=>t.id===tabId);return tab?{tileId,tabId,title:tab.title,showIntervalSelect:tab.showIntervalSelect,control:tab.control,insightProps:{dashboardItemId:(0,insightsUtils.q)(tileId,tabId,!0),loadPriority:0,doNotLoad:!1,dataNodeCollectionId:common.p2},query:extendQuery(tab.query),canOpenInsight:tab.canOpenInsight}:null}return"query"===tile.kind?{tileId,title:tile.title,showIntervalSelect:tile.showIntervalSelect,control:tile.control,insightProps:{dashboardItemId:(0,insightsUtils.q)(tileId,void 0,!0),loadPriority:0,dataNodeCollectionId:common.p2},query:extendQuery(tile.query),canOpenInsight:!!tile.canOpenInsight}:null}],getNewInsightUrl:[s=>[s.combinedTiles],tiles=>(0,insightsUtils.l)(tiles)]})]),WebAnalyticsModal=()=>{let{dateFilter:{dateFrom,dateTo},productTab}=(0,index_esm.useValues)(webAnalyticsLogic.W),{modal}=(0,index_esm.useValues)(webAnalyticsModalLogic),{setDates}=(0,index_esm.useActions)(webAnalyticsLogic.W),{closeModal}=(0,index_esm.useActions)(webAnalyticsModalLogic);return modal?(0,jsx_runtime.jsx)(LemonModal.f,{isOpen:!!modal,onClose:closeModal,simple:!1,title:modal?.title||"",width:1600,fullScreen:!1,closable:!0,children:(0,jsx_runtime.jsxs)("div",{className:"WebAnalyticsModal deprecated-space-y-4",children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-row flex-wrap gap-2",children:[productTab!==common.lZ.MARKETING&&(0,jsx_runtime.jsx)(WebPropertyFilters,{}),(0,jsx_runtime.jsx)(DateFilter.f,{dateFrom:dateFrom,dateTo:dateTo,onChange:setDates})]}),(0,jsx_runtime.jsx)(LemonModal.f.Content,{embedded:!0,children:(0,jsx_runtime.jsx)(WebAnalyticsTile.bP,{query:modal.query,insightProps:modal.insightProps,showIntervalSelect:modal.showIntervalSelect,control:modal.control,tileId:modal.tileId})}),(0,jsx_runtime.jsx)("div",{className:"flex flex-row justify-end",children:modal.canOpenInsight?(0,jsx_runtime.jsx)(LemonButton.J,{to:urls.j.insightNew({query:modal.query,sceneSource:"web-analytics"}),icon:(0,jsx_runtime.jsx)(icons.pF,{}),size:"small",type:"secondary",onClick:()=>{(0,product_intents.uX)({from:types.Md.WEB_ANALYTICS,to:types.Md.PRODUCT_ANALYTICS,intent_context:product_intents.kp.WEB_ANALYTICS_INSIGHT})},children:"Open as new Insight"}):null})]})}):null};var TZLabel=__webpack_require__("../../frontend/src/lib/components/TZLabel/index.tsx"),LemonTableLink=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/LemonTableLink.tsx"),Query=__webpack_require__("../../frontend/src/queries/Query/Query.tsx"),queryFeatures=__webpack_require__("../../frontend/src/queries/nodes/DataTable/queryFeatures.ts");let CountColumn=_ref=>{let{record,columnName}=_ref,count=record.aggregations[columnName];return(0,jsx_runtime.jsx)("span",{className:"text-lg font-medium",children:(0,utils.d$)(count)})},context={extraDataTableQueryFeatures:[queryFeatures.P.hideLoadNextButton],showOpenEditorButton:!1,showQueryEditor:!1,columns:{error:{width:"50%",render:props=>{let record=props.record;return(0,jsx_runtime.jsx)("div",{className:"flex items-start gap-x-1.5 group",children:(0,jsx_runtime.jsx)(LemonTableLink.i,{title:record.name||"Unknown Type",description:(0,jsx_runtime.jsxs)("div",{className:"deprecated-space-y-1",children:[(0,jsx_runtime.jsx)("div",{className:"line-clamp-1",children:record.description}),(0,jsx_runtime.jsx)("div",{className:"deprecated-space-x-1",children:(0,jsx_runtime.jsx)(TZLabel.w,{time:record.last_seen,className:"border-dotted border-b"})})]}),className:"flex-1",to:urls.j.errorTrackingIssue(record.id)})})}},users:{align:"right",render:CountColumn},occurrences:{align:"right",render:CountColumn}}},WebAnalyticsErrorTrackingTile=_ref2=>{var _layout$colSpanClassN,_layout$rowSpanClassN,_layout$orderWhenLarg;let{tile}=_ref2,{layout,query}=tile,to=urls.j.errorTracking(),{addProductIntentForCrossSell}=(0,index_esm.useActions)(teamLogic.teamLogic);return(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.default)("col-span-1 row-span-1 flex flex-col",null!==(_layout$colSpanClassN=layout.colSpanClassName)&&void 0!==_layout$colSpanClassN?_layout$colSpanClassN:"md:col-span-6",null!==(_layout$rowSpanClassN=layout.rowSpanClassName)&&void 0!==_layout$rowSpanClassN?_layout$rowSpanClassN:"md:row-span-1",null!==(_layout$orderWhenLarg=layout.orderWhenLargeClassName)&&void 0!==_layout$orderWhenLarg?_layout$orderWhenLarg:"xxl:order-12",layout.className),children:[(0,jsx_runtime.jsx)("h2",{className:"m-0 mb-3",children:"Error tracking"}),(0,jsx_runtime.jsx)("div",{className:"border rounded bg-surface-primary flex-1 flex flex-col py-2 px-1",children:(0,jsx_runtime.jsx)(Query.A,{query:query,embedded:!0,context:context})}),(0,jsx_runtime.jsx)("div",{className:"flex flex-row-reverse my-2",children:(0,jsx_runtime.jsx)(LemonButton.J,{to:to,icon:(0,jsx_runtime.jsx)(icons.pF,{}),onClick:()=>{addProductIntentForCrossSell({from:types.Md.WEB_ANALYTICS,to:types.Md.ERROR_TRACKING,intent_context:product_intents.kp.WEB_ANALYTICS_ERRORS})},size:"small",type:"secondary",children:"View all"})})]})};var EmptyMessage=__webpack_require__("../../frontend/src/lib/components/EmptyMessage/EmptyMessage.tsx"),LemonSkeleton=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonSkeleton/index.ts"),RecordingRow=__webpack_require__("../../frontend/src/scenes/session-recordings/components/RecordingRow.tsx"),sessionRecordingsPlaylistLogic=__webpack_require__("../../frontend/src/scenes/session-recordings/playlist/sessionRecordingsPlaylistLogic.ts");function WebAnalyticsRecordingsTile(_ref){var _layout$colSpanClassN,_layout$rowSpanClassN,_layout$orderWhenLarg;let{tile}=_ref,{layout}=tile,{replayFilters,webAnalyticsFilters}=(0,index_esm.useValues)(webAnalyticsLogic.W),{currentTeam}=(0,index_esm.useValues)(teamLogic.teamLogic),{addProductIntentForCrossSell}=(0,index_esm.useActions)(teamLogic.teamLogic),sessionRecordingsListLogicInstance=(0,sessionRecordingsPlaylistLogic.YV)({logicKey:"webAnalytics",filters:replayFilters}),{sessionRecordings,sessionRecordingsResponseLoading}=(0,index_esm.useValues)(sessionRecordingsListLogicInstance),items=sessionRecordings.slice(0,5),emptyMessage=currentTeam?.session_recording_opt_in?webAnalyticsFilters.length>0?{title:"There are no recordings matching the current filters",description:"Try changing the filters, or view all recordings.",buttonText:"View all",buttonTo:urls.j.replay()}:{title:"There are no recordings matching this date range",description:"Make sure you have the javascript snippet setup in your website.",buttonText:"Learn more",buttonTo:"https://posthog.com/docs/user-guides/recordings"}:{title:"Recordings are not enabled for this project",description:"Once recordings are enabled, new recordings will display here.",buttonText:"Enable recordings",buttonTo:urls.j.settings("project-replay","replay")},to=items.length>0?urls.j.replay(types.yd.Home,replayFilters):urls.j.replay();return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.default)("col-span-1 row-span-1 flex flex-col",null!==(_layout$colSpanClassN=layout.colSpanClassName)&&void 0!==_layout$colSpanClassN?_layout$colSpanClassN:"md:col-span-6",null!==(_layout$rowSpanClassN=layout.rowSpanClassName)&&void 0!==_layout$rowSpanClassN?_layout$rowSpanClassN:"md:row-span-1",null!==(_layout$orderWhenLarg=layout.orderWhenLargeClassName)&&void 0!==_layout$orderWhenLarg?_layout$orderWhenLarg:"xxl:order-12",layout.className),children:[(0,jsx_runtime.jsx)("h2",{className:"m-0 mb-3",children:"Session replay"}),(0,jsx_runtime.jsx)("div",{className:"border rounded bg-surface-primary flex-1 flex flex-col py-2 px-1",children:sessionRecordingsResponseLoading?(0,jsx_runtime.jsx)("div",{className:"p-2 deprecated-space-y-6",children:Array.from({length:6},(_,index)=>(0,jsx_runtime.jsx)(LemonSkeleton.y,{},index))}):0===items.length&&emptyMessage?(0,jsx_runtime.jsx)(EmptyMessage.M,{...emptyMessage}):items.map((item,index)=>(0,jsx_runtime.jsx)(RecordingRow.Z,{recording:item},index))}),(0,jsx_runtime.jsx)("div",{className:"flex flex-row-reverse my-2",children:(0,jsx_runtime.jsx)(LemonButton.J,{to:to,icon:(0,jsx_runtime.jsx)(icons.pF,{}),onClick:()=>{addProductIntentForCrossSell({from:types.Md.WEB_ANALYTICS,to:types.Md.SESSION_REPLAY,intent_context:product_intents.kp.WEB_ANALYTICS_INSIGHT})},size:"small",type:"secondary",children:"View all"})})]})})}var SceneContent=__webpack_require__("../../frontend/src/layout/scenes/components/SceneContent.tsx"),dataNodeCollectionLogic=__webpack_require__("../../frontend/src/queries/nodes/DataNode/dataNodeCollectionLogic.ts"),lib=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),dist_module=__webpack_require__("../../node_modules/.pnpm/posthog-js@1.266.0_@rrweb+types@2.0.0-alpha.17/node_modules/posthog-js/dist/module.js");let WebAnalyticsPageReportsCTA=()=>{let{webAnalyticsFilters,productTab,domainFilter,authorizedDomains}=(0,index_esm.useValues)(webAnalyticsLogic.W),{setProductTab}=(0,index_esm.useActions)(webAnalyticsLogic.W),pageFilter=webAnalyticsFilters?.find(filter=>"$pathname"===filter.key),hasSingleDomain=1===authorizedDomains.length,hasSpecificDomain=domainFilter&&"all"!==domainFilter;return pageFilter&&productTab===common.lZ.ANALYTICS&&(hasSpecificDomain||hasSingleDomain)?(0,jsx_runtime.jsx)(LemonBanner.V,{type:"info",className:"mt-2",action:{onClick:()=>{let domainToUse=hasSpecificDomain?domainFilter:authorizedDomains[0];dist_module.ZP.updateEarlyAccessFeatureEnrollment("web-analytics-page-reports",!0),setTimeout(()=>{setProductTab(common.lZ.PAGE_REPORTS),lib.router.actions.push("/web/page-reports",{pageURL:`${domainToUse}${pageFilter.value}`})},100)},children:"Let me check it out!"},onClose:()=>{},children:(0,jsx_runtime.jsx)("p",{children:"It looks like you're filtering by a specific page. We have a new Page Reports feature in early access that gives you detailed insights about individual pages."})}):null};var marketingAnalyticsLogic=__webpack_require__("../../frontend/src/scenes/web-analytics/tabs/marketing-analytics/frontend/logic/marketingAnalyticsLogic.ts"),marketingAnalyticsTilesLogic=__webpack_require__("../../frontend/src/scenes/web-analytics/tabs/marketing-analytics/frontend/logic/marketingAnalyticsTilesLogic.ts");let MarketingAnalyticsFilters=_ref=>{let{tabs}=_ref,{compareFilter,dateFilter}=(0,index_esm.useValues)(marketingAnalyticsLogic.O),{setCompareFilter,setDates}=(0,index_esm.useActions)(marketingAnalyticsLogic.O);return(0,jsx_runtime.jsx)(index_esm.BindLogic,{logic:dataNodeCollectionLogic.y,props:{key:marketingAnalyticsTilesLogic.m},children:(0,jsx_runtime.jsx)(FilterBar.f,{top:tabs,left:(0,jsx_runtime.jsx)(Reload.H,{}),right:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(DateFilter.f,{allowTimePrecision:!0,dateFrom:dateFilter.dateFrom,dateTo:dateFilter.dateTo,onChange:setDates}),(0,jsx_runtime.jsx)(CompareFilter.m,{compareFilter:compareFilter,updateCompareFilter:setCompareFilter})]})})})},Tiles=props=>{let{tiles:tilesFromProps,compact=!1}=props,{tiles:tilesFromLogic}=(0,index_esm.useValues)(webAnalyticsLogic.W);return(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.default)("mt-4 grid grid-cols-1 md:grid-cols-2 xxl:grid-cols-3",compact?"gap-x-2 gap-y-2":"gap-x-4 gap-y-12"),children:(null!=tilesFromProps?tilesFromProps:tilesFromLogic).map((tile,i)=>{if("query"===tile.kind)return(0,jsx_runtime.jsx)(QueryTileItem,{tile:tile},i);if("tabs"===tile.kind)return(0,jsx_runtime.jsx)(TabsTileItem,{tile:tile},i);if("replay"===tile.kind)return(0,jsx_runtime.jsx)(WebAnalyticsRecordingsTile,{tile:tile},i);if("error_tracking"===tile.kind)return(0,jsx_runtime.jsx)(WebAnalyticsErrorTrackingTile,{tile:tile},i);if("section"===tile.kind)return(0,jsx_runtime.jsx)(SectionTileItem,{tile:tile},i);return null})})},QueryTileItem=_ref=>{var _layout$colSpanClassN,_layout$rowSpanClassN,_layout$orderWhenLarg;let{tile}=_ref,{query,title,layout,insightProps,control,showIntervalSelect,docs}=tile,{openModal}=(0,index_esm.useActions)(webAnalyticsModalLogic),{getNewInsightUrl}=(0,index_esm.useValues)(webAnalyticsLogic.W),buttonsRow=[tile.canOpenInsight?(0,jsx_runtime.jsx)(LemonButton.J,{to:getNewInsightUrl(tile.tileId),icon:(0,jsx_runtime.jsx)(icons.pF,{}),size:"small",type:"secondary",onClick:()=>{(0,product_intents.uX)({from:types.Md.WEB_ANALYTICS,to:types.Md.PRODUCT_ANALYTICS,intent_context:product_intents.kp.WEB_ANALYTICS_INSIGHT})},children:"Open as new Insight"},"open-insight-button"):null,tile.canOpenModal?(0,jsx_runtime.jsx)(LemonButton.J,{onClick:()=>openModal(tile.tileId),icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconExpand45,{}),size:"small",type:"secondary",children:"Show more"},"open-modal-button"):null].filter(utils.DX);return(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.default)("col-span-1 row-span-1 flex flex-col",null!==(_layout$colSpanClassN=layout.colSpanClassName)&&void 0!==_layout$colSpanClassN?_layout$colSpanClassN:"md:col-span-6",null!==(_layout$rowSpanClassN=layout.rowSpanClassName)&&void 0!==_layout$rowSpanClassN?_layout$rowSpanClassN:"md:row-span-1",null!==(_layout$orderWhenLarg=layout.orderWhenLargeClassName)&&void 0!==_layout$orderWhenLarg?_layout$orderWhenLarg:"xxl:order-12",layout.className),children:[title&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-row items-center mb-3",children:[(0,jsx_runtime.jsx)("h2",{children:title}),docs&&(0,jsx_runtime.jsx)(LearnMorePopover,{url:docs.url,title:docs.title,description:docs.description})]}),(0,jsx_runtime.jsx)(WebAnalyticsTile.bP,{query:query,insightProps:insightProps,control:control,showIntervalSelect:showIntervalSelect,tileId:tile.tileId}),buttonsRow.length>0?(0,jsx_runtime.jsx)("div",{className:"flex justify-end my-2 deprecated-space-x-2",children:buttonsRow}):null]})},TabsTileItem=_ref2=>{let{tile}=_ref2,{layout}=tile,{getNewInsightUrl}=(0,index_esm.useValues)(webAnalyticsLogic.W);return(0,jsx_runtime.jsx)(WebTabs,{className:(0,clsx_m.default)("col-span-1 row-span-1",layout.colSpanClassName||"md:col-span-1",layout.rowSpanClassName||"md:row-span-1",layout.orderWhenLargeClassName||"xxl:order-12",layout.className),activeTabId:tile.activeTabId,setActiveTabId:tile.setTabId,tabs:tile.tabs.map(tab=>({id:tab.id,content:(0,jsx_runtime.jsx)(WebAnalyticsTile.bP,{query:tab.query,showIntervalSelect:tab.showIntervalSelect,control:tab.control,insightProps:tab.insightProps,tileId:tile.tileId},tab.id),linkText:tab.linkText,title:tab.title,canOpenModal:!!tab.canOpenModal,canOpenInsight:!!tab.canOpenInsight,query:tab.query,docs:tab.docs})),tileId:tile.tileId,getNewInsightUrl:getNewInsightUrl})},SectionTileItem=_ref3=>{let{tile,separator}=_ref3;return(0,jsx_runtime.jsxs)("div",{className:"col-span-full",children:[tile.title&&(0,jsx_runtime.jsx)("h2",{className:"text-lg font-semibold mb-4",children:tile.title}),(0,jsx_runtime.jsx)("div",{className:tile.layout.className?`grid ${tile.layout.className} mb-4`:"mb-4",children:tile.tiles.map((subTile,i)=>"query"===subTile.kind?(0,jsx_runtime.jsx)("div",{className:"col-span-1",children:(0,jsx_runtime.jsx)(QueryTileItem,{tile:subTile})},`${subTile.tileId}-${i}`):null)}),separator&&(0,jsx_runtime.jsx)(LemonDivider.p,{className:"my-3"})]})},WebTabs=_ref4=>{let{className,activeTabId,tabs,setActiveTabId,getNewInsightUrl,tileId}=_ref4,activeTab=tabs.find(t=>t.id===activeTabId),newInsightUrl=getNewInsightUrl(tileId,activeTabId),{openModal}=(0,index_esm.useActions)(webAnalyticsModalLogic),{setTileVisualization}=(0,index_esm.useActions)(webAnalyticsLogic.W),{tileVisualizations}=(0,index_esm.useValues)(webAnalyticsLogic.W),visualization=tileVisualizations[tileId],isVisualizationToggleEnabled=[common.nM.SOURCES,common.nM.DEVICES,common.nM.PATHS].includes(tileId),buttonsRow=[activeTab?.canOpenInsight&&newInsightUrl?(0,jsx_runtime.jsx)(LemonButton.J,{to:newInsightUrl,icon:(0,jsx_runtime.jsx)(icons.pF,{}),size:"small",type:"secondary",onClick:()=>{(0,product_intents.uX)({from:types.Md.WEB_ANALYTICS,to:types.Md.PRODUCT_ANALYTICS,intent_context:product_intents.kp.WEB_ANALYTICS_INSIGHT})},children:"Open as new Insight"},"open-insight-button"):null,activeTab?.canOpenModal?(0,jsx_runtime.jsx)(LemonButton.J,{onClick:()=>openModal(tileId,activeTabId),icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconExpand45,{}),size:"small",type:"secondary",children:"Show more"},"open-modal-button"):null].filter(utils.DX);return(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.default)(className,"flex flex-col"),children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-row items-center self-stretch mb-3",children:[(0,jsx_runtime.jsxs)("h2",{className:"flex-1 m-0 flex flex-row ml-1",children:[activeTab?.title,activeTab?.docs&&(0,jsx_runtime.jsx)(LearnMorePopover,{url:activeTab.docs.url,title:activeTab.docs.title,description:activeTab.docs.description})]}),isVisualizationToggleEnabled&&(0,jsx_runtime.jsx)(src.P4,{value:visualization||"table",onChange:value=>setTileVisualization(tileId,value),options:[{value:"table",icon:(0,jsx_runtime.jsx)(icons.p$,{})},{value:"graph",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconLineGraph,{})}],size:"small",className:"mr-2"}),(0,jsx_runtime.jsx)(LemonSegmentedSelect.S,{shrinkOn:7,size:"small",disabled:!1,value:activeTabId,dropdownMatchSelectWidth:!1,onChange:setActiveTabId,options:tabs.map(_ref5=>{let{id,linkText}=_ref5;return{value:id,label:linkText}})})]}),(0,jsx_runtime.jsx)("div",{className:"flex-1 flex flex-col",children:activeTab?.content}),buttonsRow.length>0?(0,jsx_runtime.jsx)("div",{className:"flex justify-end my-2 deprecated-space-x-2",children:buttonsRow}):null]})},LearnMorePopover=_ref6=>{let{url,title,description}=_ref6,[isOpen,setIsOpen]=(0,react.useState)(!1);return(0,jsx_runtime.jsx)(Popover.J2,{visible:isOpen,onClickOutside:()=>setIsOpen(!1),overlay:(0,jsx_runtime.jsxs)("div",{className:"p-4 max-w-160 max-h-160 overflow-auto",children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-row w-full",children:[(0,jsx_runtime.jsx)("h2",{className:"flex-1",children:title}),(0,jsx_runtime.jsx)(LemonButton.J,{targetBlank:!0,type:"tertiary",onClick:()=>setIsOpen(!1),size:"small",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconX,{})})]}),(0,jsx_runtime.jsx)("div",{className:"text-sm text-gray-700 dark:text-white",children:description}),url&&(0,jsx_runtime.jsx)("div",{className:"flex justify-end mt-4",children:(0,jsx_runtime.jsx)(LemonButton.J,{to:url,onClick:()=>setIsOpen(!1),targetBlank:!0,sideIcon:(0,jsx_runtime.jsx)(posthog_icons_es.IconOpenSidebar,{}),children:"Learn more"})})]}),children:(0,jsx_runtime.jsx)(LemonButton.J,{onClick:()=>setIsOpen(!isOpen),size:"small",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconInfo,{}),className:"ml-1 mb-1"})})},Filters=_ref7=>{let{tabs}=_ref7,{productTab}=(0,index_esm.useValues)(webAnalyticsLogic.W);switch(productTab){case common.lZ.PAGE_REPORTS:return(0,jsx_runtime.jsx)(PageReportsFilters,{tabs:tabs});case common.lZ.MARKETING:return(0,jsx_runtime.jsx)(MarketingAnalyticsFilters,{tabs:tabs});default:return(0,jsx_runtime.jsx)(WebAnalyticsFilters,{tabs:tabs})}},MainContent=()=>{let{productTab}=(0,index_esm.useValues)(webAnalyticsLogic.W),{featureFlags}=(0,index_esm.useValues)(featureFlagLogic.featureFlagLogic);return productTab===common.lZ.PAGE_REPORTS&&featureFlags[constants.y8.WEB_ANALYTICS_PAGE_REPORTS]?(0,jsx_runtime.jsx)(PageReports,{}):productTab===common.lZ.MARKETING?(0,jsx_runtime.jsx)(MarketingDashboard,{}):(0,jsx_runtime.jsx)(Tiles,{})},MarketingDashboard=()=>{let{featureFlags}=(0,index_esm.useValues)(featureFlagLogic.featureFlagLogic),{validExternalTables,validNativeSources,loading}=(0,index_esm.useValues)(marketingAnalyticsLogic.O),feedbackBanner=(0,jsx_runtime.jsx)(src.Vp,{type:"info",dismissKey:"marketing-analytics-beta-banner",className:"mb-2 mt-4",action:{children:"Send feedback",id:"marketing-analytics-feedback-button"},children:"Marketing analytics is in beta. Please let us know what you'd like to see here and/or report any issues directly to us!"}),component=null;return component=featureFlags[constants.y8.WEB_ANALYTICS_MARKETING]?loading?(0,jsx_runtime.jsx)(src.yW,{}):0===validExternalTables.length&&0===validNativeSources.length?(0,jsx_runtime.jsx)(ProductIntroduction.C,{productName:"Marketing Analytics",productKey:types.Md.MARKETING_ANALYTICS,thingName:"marketing integration",titleOverride:"Add your first marketing integration",description:"To enable marketing analytics, you need to integrate your marketing data sources. You can do this in the settings by adding a native (like Google Ads) or non-native (from a bucket like S3) source.",action:()=>window.open(urls.j.settings("environment-marketing-analytics"),"_blank"),isEmpty:!0,docsURL:"https://posthog.com/docs/web-analytics/marketing-analytics",customHog:hedgehogs.FilmCameraHog}):(0,jsx_runtime.jsx)(Tiles,{}):(0,jsx_runtime.jsxs)(src.Vp,{type:"info",children:["You can enable marketing analytics in the feature preview settings"," ",(0,jsx_runtime.jsx)(Link.r,{to:"https://app.posthog.com/settings/user-feature-previews#marketing-analytics",children:"here"}),"."]}),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[feedbackBanner,component]})},pageReportsTab=featureFlags=>featureFlags[constants.y8.WEB_ANALYTICS_PAGE_REPORTS]?[{key:common.lZ.PAGE_REPORTS,label:(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1",children:["Page reports",(0,jsx_runtime.jsx)(LemonTag.o,{type:"warning",className:"uppercase",children:"Beta"})]}),link:"/web/page-reports"}]:[],marketingTab=featureFlags=>featureFlags[constants.y8.WEB_ANALYTICS_MARKETING]?[{key:common.lZ.MARKETING,label:(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1",children:["Marketing",(0,jsx_runtime.jsx)(LemonTag.o,{type:"warning",className:"uppercase",children:"Beta"})]}),link:"/web/marketing"}]:[],WebAnalyticsDashboard=()=>(0,jsx_runtime.jsx)(index_esm.BindLogic,{logic:webAnalyticsLogic.W,props:{},children:(0,jsx_runtime.jsxs)(index_esm.BindLogic,{logic:dataNodeCollectionLogic.y,props:{key:common.p2},children:[(0,jsx_runtime.jsx)(WebAnalyticsModal,{}),(0,jsx_runtime.jsx)(VersionCheckerBanner.o,{}),(0,jsx_runtime.jsxs)(SceneContent._,{className:"WebAnalyticsDashboard w-full flex flex-col",children:[(0,jsx_runtime.jsx)(WebAnalyticsTabs,{}),(0,jsx_runtime.jsx)(Filters,{tabs:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}),(0,jsx_runtime.jsx)(WebAnalyticsPageReportsCTA,{}),(0,jsx_runtime.jsx)(WebAnalyticsHealthCheck,{}),(0,jsx_runtime.jsx)(MainContent,{})]})]})}),WebAnalyticsTabs=()=>{let{productTab}=(0,index_esm.useValues)(webAnalyticsLogic.W),{featureFlags}=(0,index_esm.useValues)(featureFlagLogic.featureFlagLogic),{setProductTab}=(0,index_esm.useActions)(webAnalyticsLogic.W);return(0,jsx_runtime.jsx)(LemonTabs.T,{activeKey:productTab,onChange:setProductTab,tabs:[{key:common.lZ.ANALYTICS,label:"Web analytics",link:"/web"},{key:common.lZ.WEB_VITALS,label:"Web vitals",link:"/web/web-vitals"},...pageReportsTab(featureFlags),...marketingTab(featureFlags)],sceneInset:!0,className:"-mt-4"})};var LemonMenu=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonMenu/index.ts");let WebAnalyticsMenu=()=>{let{shouldFilterTestAccounts}=(0,index_esm.useValues)(webAnalyticsLogic.W),{setShouldFilterTestAccounts}=(0,index_esm.useActions)(webAnalyticsLogic.W);return(0,jsx_runtime.jsx)(LemonMenu.d,{items:[{label:"Session Attribution Explorer",to:urls.j.sessionAttributionExplorer(),icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconSearch,{})},{label:()=>(0,jsx_runtime.jsx)(LemonSwitch.f,{checked:shouldFilterTestAccounts,onChange:()=>{setShouldFilterTestAccounts(!shouldFilterTestAccounts)},fullWidth:!0,label:"Filter test accounts"})}].filter(Boolean),closeOnClickInside:!1,children:(0,jsx_runtime.jsx)(LemonButton.J,{icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconEllipsis,{}),size:"small"})})};function WebAnalyticsHeaderButtons(){let{featureFlags}=(0,index_esm.useValues)(featureFlagLogic.featureFlagLogic),{currentTeam}=(0,index_esm.useValues)(teamLogic.teamLogic),{updateCurrentTeam}=(0,index_esm.useActions)(teamLogic.teamLogic),[showPopover,setShowPopover]=(0,react.useState)(!1),hasFeatureFlag=featureFlags[constants.y8.SETTINGS_WEB_ANALYTICS_PRE_AGGREGATED_TABLES],isUsingNewEngine=currentTeam?.modifiers?.useWebAnalyticsPreAggregatedTables,handleToggleEngine=checked=>{updateCurrentTeam({modifiers:{...currentTeam?.modifiers,useWebAnalyticsPreAggregatedTables:checked}})};return(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[hasFeatureFlag&&(0,jsx_runtime.jsx)(Popover.J2,{visible:showPopover,onClickOutside:()=>setShowPopover(!1),overlay:(0,jsx_runtime.jsxs)("div",{className:"p-4 max-w-160",children:[(0,jsx_runtime.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,jsx_runtime.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:["About the New Query Engine",(0,jsx_runtime.jsx)(LemonTag.o,{type:"warning",className:"uppercase",children:"Beta"})]})}),(0,jsx_runtime.jsx)("p",{className:"mb-3",children:"Our new Web Analytics Query Engine powers faster queries using pre-aggregated data, giving you quicker access to insights and it's much better at handling large datasets."}),(0,jsx_runtime.jsxs)("div",{className:"mb-3",children:[(0,jsx_runtime.jsx)("strong",{children:"A few things to note:"}),(0,jsx_runtime.jsxs)("ul",{className:"list-disc ml-4 mt-1 space-y-1",children:[(0,jsx_runtime.jsx)("li",{children:"Some filters may not yet be supported, but we're working on expanding coverage."}),(0,jsx_runtime.jsx)("li",{children:"We use smart approximation techniques to keep performance high, and we aim for less than 1% difference compared to exact results."}),(0,jsx_runtime.jsx)("li",{children:"You can toggle the engine on or off directly from this interface if you want to compare results or prefer the previous method."}),(0,jsx_runtime.jsx)("li",{children:"Results are currently tied to UTC timezone for query and display."})]})]}),(0,jsx_runtime.jsxs)("div",{className:"mb-3",children:[(0,jsx_runtime.jsx)("strong",{children:"Coming Soon:"}),(0,jsx_runtime.jsxs)("ul",{className:"list-disc ml-4 mt-1 space-y-1",children:[(0,jsx_runtime.jsx)("li",{children:"Use the new engine for chart visualizations"}),(0,jsx_runtime.jsx)("li",{children:"Support for channel types in breakdowns"}),(0,jsx_runtime.jsx)("li",{children:"Enable conversion goals"}),(0,jsx_runtime.jsx)("li",{children:"Further improvements in accuracy"}),(0,jsx_runtime.jsx)("li",{children:"More filters!"})]})]})]}),children:(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>handleToggleEngine(!isUsingNewEngine),onMouseEnter:()=>setShowPopover(!0),onMouseLeave:()=>setShowPopover(!1),children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconBolt,{className:isUsingNewEngine?"text-warning":"text-muted"}),(0,jsx_runtime.jsx)("span",{className:"text-sm font-medium",children:isUsingNewEngine?"New Query Engine":"Regular Query Engine"}),(0,jsx_runtime.jsx)(LemonSwitch.f,{checked:!!isUsingNewEngine,onChange:handleToggleEngine,size:"small"})]})}),(0,jsx_runtime.jsx)(WebAnalyticsMenu,{})]})}var SceneDivider=__webpack_require__("../../frontend/src/layout/scenes/components/SceneDivider.tsx"),SceneTitleSection=__webpack_require__("../../frontend/src/layout/scenes/components/SceneTitleSection.tsx");function WebAnalyticsScene(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(PageHeader.m,{buttons:(0,jsx_runtime.jsx)(WebAnalyticsHeaderButtons,{})}),(0,jsx_runtime.jsxs)(SceneContent._,{children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,jsx_runtime.jsx)(SceneTitleSection.s,{name:"Web analytics",description:"Analyze your web analytics data to understand website performance and user behavior.",resourceType:{type:"web",forceIcon:(0,jsx_runtime.jsx)(posthog_icons_es.IconPieChart,{}),forceIconColorOverride:["var(--color-product-web-analytics-light)","var(--color-product-web-analytics-dark)"]}}),(0,jsx_runtime.jsx)(SceneDivider.V,{})]}),(0,jsx_runtime.jsx)(WebAnalyticsDashboard,{})]})]})}let scene={component:WebAnalyticsScene,logic:webAnalyticsLogic.W,settingSectionId:"environment-web-analytics"}},"../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!../../node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.5.6_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!../../node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!../../frontend/src/scenes/web-analytics/WebAnalyticsLiveUserCount.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".live-user-indicator{border-radius:9999px;height:.5rem;margin-right:.25rem;transition:background-color 1s ease-in-out;width:.5rem}.live-user-indicator.online{animation:LiveUserIndicator__Pulse 10s ease-in-out infinite;background-color:var(--color-green-500)}.live-user-indicator.offline{background-color:var(--color-red-300)}@keyframes LiveUserIndicator__Pulse{0%{opacity:1;transform:scale(1)}45%{opacity:1;transform:scale(.9)}50%{opacity:.6;transform:scale(1.15)}55%{opacity:1;transform:scale(.9)}to{opacity:1;transform:scale(1)}}",""]),module.exports=exports}}]);