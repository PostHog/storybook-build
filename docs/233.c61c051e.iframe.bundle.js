(window.webpackJsonp=window.webpackJsonp||[]).push([[233],{4347:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return appEditorUrl})),__webpack_require__.d(__webpack_exports__,"a",(function(){return NEW_URL})),__webpack_require__.d(__webpack_exports__,"c",(function(){return authorizedUrlsLogic}));__webpack_require__(42),__webpack_require__(64),__webpack_require__(92),__webpack_require__(383),__webpack_require__(50),__webpack_require__(33),__webpack_require__(149),__webpack_require__(646),__webpack_require__(755),__webpack_require__(40),__webpack_require__(84),__webpack_require__(118),__webpack_require__(108),__webpack_require__(104),__webpack_require__(299),__webpack_require__(53),__webpack_require__(566);var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(15),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_17__),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(8),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_18__),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_20__=(__webpack_require__(69),__webpack_require__(13)),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_20___default=__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_20__),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(3),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_21___default=__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_21__),kea__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(1),lib_api__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(23),lib_utils__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(10),scenes_teamLogic__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(31),lib_dayjs__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(37),fuse_js__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(301),kea_router__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(32);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_21___default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function appEditorUrl(appUrl,actionId,defaultIntent){var params=_objectSpread(_objectSpread({userIntent:defaultIntent?void 0:actionId?"edit-action":"add-action"},actionId?{actionId:actionId}:{}),appUrl?{appUrl:appUrl}:{});return"/api/user/redirect_to_site/"+Object(kea_router__WEBPACK_IMPORTED_MODULE_28__.encodeParams)(params,"?")}var NEW_URL="https://",authorizedUrlsLogic=Object(kea__WEBPACK_IMPORTED_MODULE_22__.kea)({path:function path(key){return["lib","components","AppEditorLink","appUrlsLogic",key]},key:function key(props){return"".concat(props.pageKey).concat(props.actionId)||"global"},props:{},connect:{values:[scenes_teamLogic__WEBPACK_IMPORTED_MODULE_25__.a,["currentTeam","currentTeamId"]],actions:[scenes_teamLogic__WEBPACK_IMPORTED_MODULE_25__.a,["updateCurrentTeam"]]},actions:function actions(){return{setAppUrls:function setAppUrls(appUrls){return{appUrls:appUrls}},addUrl:function addUrl(url,launch){return{url:url,launch:launch}},newUrl:!0,removeUrl:function removeUrl(index){return{index:index}},updateUrl:function updateUrl(index,url){return{index:index,url:url}},launchAtUrl:function launchAtUrl(url){return{url:url}},setSearchTerm:function setSearchTerm(term){return{term:term}},setEditUrlIndex:function setEditUrlIndex(originalIndex){return{originalIndex:originalIndex}}}},loaders:function loaders(_ref){var _loadSuggestions,values=_ref.values;return{suggestions:{__default:[],loadSuggestions:(_loadSuggestions=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_20___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_18___default.a.mark((function _callee(){var _result$,params,result,domainsSeen;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_18___default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return params={events:[{id:"$pageview",name:"$pageview",type:"events"}],breakdown:"$current_url",date_from:Object(lib_dayjs__WEBPACK_IMPORTED_MODULE_26__.a)().subtract(3,"days").toISOString()},_context.next=3,lib_api__WEBPACK_IMPORTED_MODULE_23__.a.get("api/projects/".concat(values.currentTeamId,"/insights/trend/?").concat(Object(lib_utils__WEBPACK_IMPORTED_MODULE_24__.yb)(params)));case 3:if(!(result=_context.sent.result)||0!==(null===(_result$=result[0])||void 0===_result$?void 0:_result$.count)){_context.next=6;break}return _context.abrupt("return",[]);case 6:return domainsSeen=[],_context.abrupt("return",(result||[]).filter((function(item){if(!item.breakdown_value)return!1;try{var domain=new URL(item.breakdown_value.toString()).hostname;if(domainsSeen.indexOf(domain)>-1)return;if(values.appUrls.filter((function(url){return url.indexOf(domain)>-1})).length>0)return;return domainsSeen.push(domain),!0}catch(error){return!1}})).map((function(item){return item.breakdown_value})).slice(0,20));case 8:case"end":return _context.stop()}}),_callee)}))),function loadSuggestions(){return _loadSuggestions.apply(this,arguments)})}}},events:function events(_ref2){var actions=_ref2.actions,values=_ref2.values;return{afterMount:function afterMount(){actions.loadSuggestions(),values.currentTeam&&actions.setAppUrls(values.currentTeam.app_urls)}}},reducers:function reducers(){return{appUrls:[[],{setAppUrls:function setAppUrls(_,_ref3){return _ref3.appUrls},addUrl:function addUrl(state,_ref4){var url=_ref4.url;return state.concat([url])},newUrl:function newUrl(state){return state.includes(NEW_URL)?state:[NEW_URL].concat(state)},updateUrl:function updateUrl(state,_ref5){var index=_ref5.index,url=_ref5.url;return Object.assign(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_17___default()(state),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_21___default()({},index,url))},removeUrl:function removeUrl(state,_ref6){var index=_ref6.index,newAppUrls=_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_17___default()(state);return newAppUrls.splice(index,1),newAppUrls}}],suggestions:[[],{addUrl:function addUrl(state,_ref7){var url=_ref7.url;return _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_17___default()(state).filter((function(item){return url!==item}))}}],searchTerm:["",{setSearchTerm:function setSearchTerm(_,_ref8){return _ref8.term}}],editUrlIndex:[null,{setEditUrlIndex:function setEditUrlIndex(_,_ref9){return _ref9.originalIndex},removeUrl:function removeUrl(editUrlIndex,_ref10){var index=_ref10.index;return editUrlIndex&&index<editUrlIndex?editUrlIndex-1:index===editUrlIndex?null:editUrlIndex}}]}},listeners:function listeners(_ref11){var _ref17,_ref15,sharedListeners=_ref11.sharedListeners,values=_ref11.values,actions=_ref11.actions;return _ref17={addUrl:[sharedListeners.saveAppUrls,function(){var _ref13=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_20___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_18___default.a.mark((function _callee2(_ref12){var url;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_18___default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:url=_ref12.url,_ref12.launch&&actions.launchAtUrl(url);case 2:case"end":return _context2.stop()}}),_callee2)})));return function(_x){return _ref13.apply(this,arguments)}}()],removeUrl:sharedListeners.saveAppUrls,updateUrl:[sharedListeners.saveAppUrls,function(){return actions.setEditUrlIndex(null)}]},_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_21___default()(_ref17,scenes_teamLogic__WEBPACK_IMPORTED_MODULE_25__.a.actionTypes.loadCurrentTeamSuccess,(_ref15=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_20___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_18___default.a.mark((function _callee3(_ref14){var currentTeam;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_18___default.a.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:(currentTeam=_ref14.currentTeam)&&actions.setAppUrls(currentTeam.app_urls);case 2:case"end":return _context3.stop()}}),_callee3)}))),function(_x2){return _ref15.apply(this,arguments)})),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_21___default()(_ref17,"launchAtUrl",(function launchAtUrl(_ref16){var url=_ref16.url;window.location.href=values.launchUrl(url)})),_ref17},sharedListeners:function sharedListeners(_ref18){var values=_ref18.values;return{saveAppUrls:function saveAppUrls(){scenes_teamLogic__WEBPACK_IMPORTED_MODULE_25__.a.actions.updateCurrentTeam({app_urls:values.appUrls})}}},selectors:function selectors(_ref19){var props=_ref19.props;return{appUrlsKeyed:[function(s){return[s.appUrls,s.suggestions,s.searchTerm]},function(appUrls,suggestions,searchTerm){var urls=appUrls.map((function(url,index){return{url:url,type:"authorized",originalIndex:index}})).concat(suggestions.map((function(url,index){return{url:url,type:"suggestion",originalIndex:index}})));return searchTerm?new fuse_js__WEBPACK_IMPORTED_MODULE_27__.a(urls,{keys:["url"],threshold:.3}).search(searchTerm).map((function(result){return result.item})):urls}],launchUrl:[function(){return[]},function(){return function(url){return appEditorUrl(url,props.actionId,!props.actionId)}}]}}})},4350:function(module,exports,__webpack_require__){(exports=__webpack_require__(49)(!1)).push([module.i,'.mixin-gradient-overlay{width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent)}.mixin-gradient-overlay,.mixin-gradient-overlay-right{content:"";position:absolute;pointer-events:none;bottom:0}.mixin-gradient-overlay-right{width:3rem;height:100%;background:linear-gradient(270deg,#fff,transparent)}.text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.authorized-urls-table .authorized-url-col{display:flex;align-items:center}.authorized-urls-table .authorized-url-col .lemon-tag{margin-left:4px}.authorized-urls-table .authorized-url-col.suggestion{color:#747ea1}.authorized-urls-table .authorized-url-col.authorized{color:var(--success)}.authorized-urls-table .actions-col{display:flex;align-items:center;justify-content:flex-end}',""]),module.exports=exports},4352:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return AuthorizedUrlsTable_AuthorizedUrlsTable}));__webpack_require__(383),__webpack_require__(84),__webpack_require__(754);var slicedToArray=__webpack_require__(12),slicedToArray_default=__webpack_require__.n(slicedToArray),react=__webpack_require__(0),react_default=__webpack_require__.n(react),injectStylesIntoStyleTag=__webpack_require__(19),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),AuthorizedUrlsTable=__webpack_require__(4350),AuthorizedUrlsTable_default=__webpack_require__.n(AuthorizedUrlsTable),options={insert:"head",singleton:!1},clsx_m=(injectStylesIntoStyleTag_default()(AuthorizedUrlsTable_default.a,options),AuthorizedUrlsTable_default.a.locals,__webpack_require__(44)),index_esm=__webpack_require__(1),LemonTable=__webpack_require__(242),LemonTag=__webpack_require__(567),CheckCircleFilled=__webpack_require__(555),PlusOutlined=__webpack_require__(1870),EditOutlined=__webpack_require__(2683),DeleteOutlined=__webpack_require__(4240),LemonButton=__webpack_require__(82),input=__webpack_require__(506),es_button=__webpack_require__(140),authorizedUrlsLogic=__webpack_require__(4347),utils=__webpack_require__(10),More=__webpack_require__(647);function AuthorizedUrlsTable_AuthorizedUrlsTable(_ref){var pageKey=_ref.pageKey,actionId=_ref.actionId,logic=Object(authorizedUrlsLogic.c)({actionId:actionId}),_useValues=Object(index_esm.useValues)(logic),appUrlsKeyed=_useValues.appUrlsKeyed,suggestionsLoading=_useValues.suggestionsLoading,searchTerm=_useValues.searchTerm,launchUrl=_useValues.launchUrl,appUrls=_useValues.appUrls,editUrlIndex=_useValues.editUrlIndex,_useActions=Object(index_esm.useActions)(logic),addUrl=_useActions.addUrl,removeUrl=_useActions.removeUrl,setSearchTerm=_useActions.setSearchTerm,updateUrl=_useActions.updateUrl,newUrl=_useActions.newUrl,setEditUrlIndex=_useActions.setEditUrlIndex,columns=[{title:"URLs",dataIndex:"url",key:"url",render:function Render(url,record){var _useState=Object(react.useState)(record.url),_useState2=slicedToArray_default()(_useState,2),urlUpdatingState=_useState2[0],setUrlUpdatingState=_useState2[1],_useState3=Object(react.useState)(""),_useState4=slicedToArray_default()(_useState3,2),errorState=_useState4[0],setErrorState=_useState4[1];Object(react.useEffect)((function(){return setUrlUpdatingState(record.url)}),[record]);var save=function save(){setErrorState(""),urlUpdatingState===authorizedUrlsLogic.a&&removeUrl(record.originalIndex),urlUpdatingState.indexOf("*")>-1&&!urlUpdatingState.match(/^(.*)\*[^\*]*\.[^\*]+\.[^\*]+$/)?setErrorState("You can only wildcard subdomains. If you wildcard the domain or TLD, people might be able to gain access to your PostHog data."):Object(utils.ab)(urlUpdatingState)?appUrls.indexOf(urlUpdatingState)>-1&&appUrls.indexOf(urlUpdatingState,record.originalIndex)!==record.originalIndex&&appUrls.indexOf(urlUpdatingState,record.originalIndex+1)!==record.originalIndex?setErrorState("This URL is already registered."):updateUrl(record.originalIndex,urlUpdatingState):setErrorState("Please type a valid URL or domain.")};return"suggestion"===record.type||url!==authorizedUrlsLogic.a&&editUrlIndex!==record.originalIndex?react_default.a.createElement("div",{className:Object(clsx_m.a)("authorized-url-col",record.type)},"authorized"===record.type&&react_default.a.createElement(CheckCircleFilled.a,{style:{marginRight:4}}),url,"suggestion"===record.type&&react_default.a.createElement(LemonTag.a,null,"Suggestion")):react_default.a.createElement("div",null,react_default.a.createElement("div",{style:{display:"flex"}},react_default.a.createElement(input.a,{value:urlUpdatingState,onChange:function onChange(e){return setUrlUpdatingState(e.target.value)},onPressEnter:save,autoFocus:!0,placeholder:"Enter a URL or wildcard subdomain (e.g. https://*.posthog.com)"}),react_default.a.createElement(es_button.a,{type:"primary",onClick:save},"Save")),errorState&&react_default.a.createElement("span",{className:"text-small text-danger"},errorState))}},{title:"",key:"actions",render:function Render(_,record,index){return react_default.a.createElement("div",{className:"actions-col"},"suggestion"===record.type?react_default.a.createElement(LemonButton.a,{type:"default",onClick:function onClick(){return addUrl(record.url)}},react_default.a.createElement(PlusOutlined.a,null)," Add as authorized"):react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("a",{href:launchUrl(record.url),style:{marginRight:4}},react_default.a.createElement(LemonButton.a,{type:"highlighted"},"Launch toolbar")),react_default.a.createElement(More.a,{overlay:react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(LemonButton.a,{fullWidth:!0,type:"stealth",onClick:function onClick(){return setEditUrlIndex(record.originalIndex)}},react_default.a.createElement(EditOutlined.a,{style:{marginRight:4}}),"Edit authorized URL"),react_default.a.createElement(LemonButton.a,{fullWidth:!0,style:{color:"var(--danger)"},type:"stealth",onClick:function onClick(){return removeUrl(index)}},react_default.a.createElement(DeleteOutlined.a,{style:{marginRight:4}}),"Remove authorized URL"))})))}}];return react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"flex-center mb"},react_default.a.createElement("div",{style:{flexGrow:1}},react_default.a.createElement(input.a.Search,{allowClear:!0,enterButton:!0,placeholder:"Search for authorized URLs",style:{maxWidth:480},value:searchTerm,onChange:function onChange(e){setSearchTerm(e.target.value)},autoFocus:"toolbar-launch"===pageKey&&!Object(utils.U)()})),react_default.a.createElement(es_button.a,{type:"primary",icon:react_default.a.createElement(PlusOutlined.a,null),onClick:newUrl},"Add","toolbar-launch"===pageKey&&" authorized domain")),react_default.a.createElement(LemonTable.a,{className:"authorized-urls-table",columns:columns,dataSource:appUrlsKeyed,emptyState:searchTerm?"There are no authorized URLs that match your search.":"There are no authorized URLs or domains. Add one to get started.",loading:suggestionsLoading}))}try{AuthorizedUrlsTable_AuthorizedUrlsTable.displayName="AuthorizedUrlsTable",AuthorizedUrlsTable_AuthorizedUrlsTable.__docgenInfo={description:"",displayName:"AuthorizedUrlsTable",props:{pageKey:{defaultValue:null,description:"",name:"pageKey",required:!1,type:{name:"string"}},actionId:{defaultValue:null,description:"",name:"actionId",required:!1,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx#AuthorizedUrlsTable"]={docgenInfo:AuthorizedUrlsTable_AuthorizedUrlsTable.__docgenInfo,name:"AuthorizedUrlsTable",path:"frontend/src/scenes/toolbar-launch/AuthorizedUrlsTable.tsx#AuthorizedUrlsTable"})}catch(__react_docgen_typescript_loader_error){}},4734:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene})),__webpack_require__.d(__webpack_exports__,"ActionsTable",(function(){return ActionsTable}));__webpack_require__(42),__webpack_require__(64),__webpack_require__(33),__webpack_require__(149),__webpack_require__(62),__webpack_require__(212),__webpack_require__(84),__webpack_require__(299);var toConsumableArray=__webpack_require__(15),toConsumableArray_default=__webpack_require__.n(toConsumableArray),slicedToArray=__webpack_require__(12),slicedToArray_default=__webpack_require__.n(slicedToArray),react=__webpack_require__(0),react_default=__webpack_require__.n(react),Link=(__webpack_require__(912),__webpack_require__(55)),input=__webpack_require__(506),es_radio=__webpack_require__(1221),CheckOutlined=__webpack_require__(554),utils=__webpack_require__(10),index_esm=__webpack_require__(1),actionsModel=__webpack_require__(373),es_button=__webpack_require__(140),modal=__webpack_require__(1246),row=__webpack_require__(382),col=__webpack_require__(350),card=__webpack_require__(4265),PlusOutlined=__webpack_require__(1870),SearchOutlined=__webpack_require__(741),EditOutlined=__webpack_require__(2683),lib=__webpack_require__(32),urls=__webpack_require__(18),AuthorizedUrlsTable=__webpack_require__(4352);function NewActionButton(){var _useState=Object(react.useState)(!1),_useState2=slicedToArray_default()(_useState,2),visible=_useState2[0],setVisible=_useState2[1],_useState3=Object(react.useState)(!1),_useState4=slicedToArray_default()(_useState3,2),appUrlsVisible=_useState4[0],setAppUrlsVisible=_useState4[1];return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(es_button.a,{type:"primary",icon:react_default.a.createElement(PlusOutlined.a,null),onClick:function onClick(){return setVisible(!0)},"data-attr":"create-action"},"New Action"),react_default.a.createElement(modal.a,{visible:visible,style:{cursor:"pointer"},onCancel:function onCancel(){setVisible(!1),setAppUrlsVisible(!1)},title:"Create new action",footer:[appUrlsVisible&&react_default.a.createElement(es_button.a,{key:"back-button",onClick:function onClick(){return setAppUrlsVisible(!1)}},"Back"),react_default.a.createElement(es_button.a,{key:"cancel-button",onClick:function onClick(){setVisible(!1),setAppUrlsVisible(!1)}},"Cancel")]},!appUrlsVisible&&react_default.a.createElement(row.a,{gutter:2,justify:"space-between"},react_default.a.createElement(col.a,{xs:11},react_default.a.createElement(card.a,{title:"Inspect element on your site",onClick:function onClick(){return setAppUrlsVisible(!0)},size:"small"},react_default.a.createElement("div",{style:{textAlign:"center",fontSize:40}},react_default.a.createElement(SearchOutlined.a,null)))),react_default.a.createElement(col.a,{xs:11},react_default.a.createElement(card.a,{title:"From event or pageview",onClick:function onClick(){lib.router.actions.push(urls.a.LEGACY_createAction())},size:"small"},react_default.a.createElement("div",{style:{textAlign:"center",fontSize:40},"data-attr":"new-action-pageview"},react_default.a.createElement(EditOutlined.a,null))))),appUrlsVisible&&react_default.a.createElement(AuthorizedUrlsTable.a,null)))}var actions_tutorial_grouping=__webpack_require__.p+"images/actions-tutorial-grouping.c9c565ed9cae79997aa714fdf8196aca.svg",actions_tutorial_standardized=__webpack_require__.p+"images/actions-tutorial-standardized.3935760a1606361ee014ad5615d6e22a.svg",actions_tutorial_retroactive=__webpack_require__.p+"images/actions-tutorial-retroactive.8bcf9190e81ba5d434572271b9f632be.svg",types=__webpack_require__(6),fuse_esm=__webpack_require__(301),userLogic=__webpack_require__(73),teamLogic=__webpack_require__(31),LEGACY_events=__webpack_require__(918),api=__webpack_require__(23),EventPageHeader=__webpack_require__(1879),columnUtils=__webpack_require__(1248),LemonTable=__webpack_require__(242),LemonButton=__webpack_require__(82),LemonRow=__webpack_require__(199),More=__webpack_require__(647),scene={component:ActionsTable};function ActionsTable(){var currentTeam=Object(index_esm.useValues)(teamLogic.a).currentTeam,_useValues2=Object(index_esm.useValues)(Object(actionsModel.a)({params:"include_count=1"})),actions=_useValues2.actions,actionsLoading=_useValues2.actionsLoading,loadActions=Object(index_esm.useActions)(actionsModel.a).loadActions,_useState=Object(react.useState)(""),_useState2=slicedToArray_default()(_useState,2),searchTerm=_useState2[0],setSearchTerm=_useState2[1],_useState3=Object(react.useState)(!1),_useState4=slicedToArray_default()(_useState3,2),filterByMe=_useState4[0],setFilterByMe=_useState4[1],user=Object(index_esm.useValues)(userLogic.a).user,columns=[{title:"Name",dataIndex:"name",width:"30%",sorter:function sorter(a,b){return(""+a.name).localeCompare(b.name)},render:function RenderName(name,action,index){return react_default.a.createElement(Link.a,{"data-attr":"action-link-"+index,to:urls.a.LEGACY_action(action.id),className:"row-name"},name||react_default.a.createElement("i",null,"Unnnamed action"))}},{title:"Type",key:"type",render:function RenderType(_,action){var _action$steps;return react_default.a.createElement("span",null,(null===(_action$steps=action.steps)||void 0===_action$steps?void 0:_action$steps.length)?action.steps.map((function(step){return react_default.a.createElement("div",{key:step.id},function(){var url=Object(utils.vb)(step.url||"");switch(url=url.slice(0,40)+(url.length>40?"...":""),step.event){case"$autocapture":return"Autocapture";case"$pageview":switch(step.url_matching){case"regex":return react_default.a.createElement(react_default.a.Fragment,null,"Page view URL matches regex ",react_default.a.createElement("strong",null,url));case"exact":return react_default.a.createElement(react_default.a.Fragment,null,"Page view URL matches exactly ",react_default.a.createElement("strong",null,url));default:return react_default.a.createElement(react_default.a.Fragment,null,"Page view URL contains ",react_default.a.createElement("strong",null,url))}default:return react_default.a.createElement(react_default.a.Fragment,null,"Event: ",react_default.a.createElement("strong",null,step.event))}}())})):react_default.a.createElement("i",null,"Empty â€“ set this action up"))}},Object(columnUtils.b)(),Object(columnUtils.a)()].concat(toConsumableArray_default()((null==currentTeam?void 0:currentTeam.slack_incoming_webhook)?[{title:"Webhook",dataIndex:"post_to_slack",sorter:function sorter(a,b){return Number(a.post_to_slack)-Number(b.post_to_slack)},render:function RenderActions(post_to_slack){return post_to_slack?react_default.a.createElement(CheckOutlined.a,null):null}}]:[]),[{width:0,render:function RenderActions(_,action){return react_default.a.createElement(More.a,{overlay:react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(LemonButton.a,{type:"stealth",to:urls.a.LEGACY_action(action.id),fullWidth:!0},"Edit"),react_default.a.createElement(LemonButton.a,{type:"stealth",to:Object(lib.combineUrl)(urls.a.insightNew({insight:types.p.TRENDS,interval:"day",display:types.d.ActionsLineGraphLinear,actions:[{id:action.id,name:action.name,type:"actions",order:0}]})).url,fullWidth:!0},"Try out in Insights"),react_default.a.createElement(LemonRow.b,null),react_default.a.createElement(LemonButton.a,{type:"stealth",style:{color:"var(--danger)"},onClick:function onClick(){return Object(utils.v)({endpoint:api.a.actions.determineDeleteEndpoint(),object:action,callback:loadActions})},fullWidth:!0},"Delete action"))})}}]),data=actions;return searchTerm&&""!==searchTerm&&(data=function searchActions(sources,search){return new fuse_esm.a(sources,{keys:["name","url"],threshold:.3}).search(search).map((function(result){return result.item}))}(data,searchTerm)),filterByMe&&(data=data.filter((function(item){var _item$created_by;return(null===(_item$created_by=item.created_by)||void 0===_item$created_by?void 0:_item$created_by.uuid)===(null==user?void 0:user.uuid)}))),react_default.a.createElement("div",{"data-attr":"manage-events-table"},react_default.a.createElement(EventPageHeader.a,{activeTab:LEGACY_events.a.Actions}),react_default.a.createElement("div",null,react_default.a.createElement("div",null),react_default.a.createElement("div",{className:"tutorial-container"},react_default.a.createElement("div",{className:"t-element"},react_default.a.createElement("div",null,react_default.a.createElement("img",{src:actions_tutorial_grouping,alt:""})),react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"title"},"Multiple grouping"),react_default.a.createElement("div",{className:"description"},"Group multiple sets of events into a single action."))),react_default.a.createElement("div",{className:"t-element"},react_default.a.createElement("div",null,react_default.a.createElement("img",{src:actions_tutorial_standardized,alt:""})),react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"title"},"Clean & standardized data"),react_default.a.createElement("div",{className:"description"},"Keep your actions the same, even if your product or data changes."))),react_default.a.createElement("div",{className:"t-element"},react_default.a.createElement("div",null,react_default.a.createElement("img",{src:actions_tutorial_retroactive,alt:""})),react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"title"},"Retroactive"),react_default.a.createElement("div",{className:"description"},"We'll retroactively update your actions to match any past events."))))),react_default.a.createElement(input.a.Search,{placeholder:"Search for actions",allowClear:!0,enterButton:!0,style:{maxWidth:600,width:"initial",flexGrow:1,marginRight:12},onChange:function onChange(e){setSearchTerm(e.target.value)}}),react_default.a.createElement(es_radio.a.Group,{buttonStyle:"solid",value:filterByMe,onChange:function onChange(e){return setFilterByMe(e.target.value)}},react_default.a.createElement(es_radio.a.Button,{value:!1},"All actions"),react_default.a.createElement(es_radio.a.Button,{value:!0},"My actions")),react_default.a.createElement("div",{className:"mb float-right"},react_default.a.createElement(NewActionButton,null)),react_default.a.createElement(LemonTable.a,{columns:columns,loading:actionsLoading,rowKey:"id",pagination:{pageSize:100},"data-attr":"actions-table",dataSource:data,defaultSorting:{columnKey:"created_by",order:-1},emptyState:"The first step to standardized analytics is creating your first action."}))}}}]);