(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[30617],{"../../frontend/src/lib/lemon-ui/ClampedText/ClampedText.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{n:()=>ClampedText});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),_Link__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/src/lib/lemon-ui/Link/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let isCssEllipsisApplied=elem=>elem.scrollHeight>elem.clientHeight,ClampedText=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef(function ClampedText(_ref,ref){let{lines,text}=_ref,[localLines,setLocalLines]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(lines),[isExpanded,setIsExpanded]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[showMore,setShowMore]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),handleToggleShowMore=show=>{setShowMore(!showMore),setIsExpanded(!isExpanded),setLocalLines(show?void 0:lines)};return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>setLocalLines(lines),[lines]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{ref:ref,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(TruncatedElement,{lines:localLines,ref:elem=>{elem&&(isCssEllipsisApplied(elem)?showMore&&isExpanded||setShowMore(!0):setShowMore(!1))},text:text}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{children:isExpanded||showMore?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_Link__WEBPACK_IMPORTED_MODULE_1__.r,{onClick:()=>handleToggleShowMore(!isExpanded),children:isExpanded?"Show less":"Show more"}):null})]})}),TruncatedElement=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef(function TruncatedElement(_ref2,ref){let{text,lines}=_ref2;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{style:lines?{overflow:"hidden",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:lines}:{},ref:ref,children:text})})},"../../frontend/src/scenes/error-tracking/ErrorTrackingIssueScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ErrorTrackingIssueScene:()=>ErrorTrackingIssueScene,STATUS_LABEL:()=>STATUS_LABEL,scene:()=>scene});var injectStylesIntoStyleTag=__webpack_require__("../../node_modules/.pnpm/style-loader@2.0.0_webpack@5.88.2/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),ErrorTracking=__webpack_require__("../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!../../node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.5.3_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!../../node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!../../frontend/src/scenes/error-tracking/ErrorTracking.scss"),ErrorTracking_default=__webpack_require__.n(ErrorTracking),options={};options.insert="head",options.singleton=!1,injectStylesIntoStyleTag_default()(ErrorTracking_default(),options),ErrorTracking_default().locals;var src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),PageHeader=__webpack_require__("../../frontend/src/lib/components/PageHeader.tsx"),react=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),AssigneeSelect=__webpack_require__("../../frontend/src/scenes/error-tracking/AssigneeSelect.tsx"),ErrorTrackingFilters=__webpack_require__("../../frontend/src/scenes/error-tracking/ErrorTrackingFilters.tsx"),errorTrackingIssueSceneLogic=__webpack_require__("../../frontend/src/scenes/error-tracking/errorTrackingIssueSceneLogic.ts"),ErrorTrackingSetupPrompt=__webpack_require__("../../frontend/src/scenes/error-tracking/ErrorTrackingSetupPrompt.tsx"),GenericSelect=__webpack_require__("../../frontend/src/scenes/error-tracking/issue/GenericSelect.tsx"),Indicator=__webpack_require__("../../frontend/src/scenes/error-tracking/issue/Indicator.tsx"),posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.11.7_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),TZLabel=__webpack_require__("../../frontend/src/lib/components/TZLabel/index.tsx"),ClampedText=__webpack_require__("../../frontend/src/lib/lemon-ui/ClampedText/ClampedText.tsx"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),OccurrenceSparkline=__webpack_require__("../../frontend/src/scenes/error-tracking/OccurrenceSparkline.tsx"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let Metadata=()=>{let{firstSeen,summary,aggregations,lastSeen,summaryLoading,issue,issueLoading,issueDateRange}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r),{values,labels}=(0,OccurrenceSparkline.P)("custom",issueDateRange,aggregations),hasSessionCount=summary&&aggregations&&0!==aggregations.sessions;return(0,jsx_runtime.jsxs)("div",{className:"space-y-2 pb-5",children:[issueLoading?(0,jsx_runtime.jsx)(src.yW.Row,{repeat:1}):(0,jsx_runtime.jsx)(ClampedText.n,{text:issue?.description||"",lines:2}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-1 justify-between py-3",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-end space-x-6",children:[renderTime("First seen",firstSeen,issueLoading),renderTime("Last seen",lastSeen,summaryLoading)]}),(0,jsx_runtime.jsxs)("div",{className:"flex space-x-2 gap-8 items-end",children:[renderMetric("Occurrences",aggregations?.occurrences,summaryLoading),renderMetric("Sessions",aggregations?.sessions,summaryLoading,hasSessionCount?void 0:"No $session_id was set for any event in this issue"),renderMetric("Users",aggregations?.users,summaryLoading)]})]}),(0,jsx_runtime.jsx)(OccurrenceSparkline.i,{className:"h-32 w-full",values:values,labels:labels,displayXAxis:!0,loading:summaryLoading})]})};function renderMetric(name,value,loading,tooltip){return(0,jsx_runtime.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center text-muted text-xs gap-1",children:[name,!loading&&tooltip&&(0,jsx_runtime.jsx)(posthog_icons_es.IconInfo,{className:"mt-0.5"})]}),loading?(0,jsx_runtime.jsx)(src.yW,{}):(0,jsx_runtime.jsx)(src.u,{title:tooltip,delayMs:0,placement:"bottom",children:(0,jsx_runtime.jsx)("div",{className:"text-2xl font-semibold",children:value?(0,utils.d$)(value):"-"})})]})}function renderTime(label,time,loading){return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{className:"text-muted text-xs",children:label}),loading&&(0,jsx_runtime.jsx)(src.yW,{}),!loading&&time&&(0,jsx_runtime.jsx)(TZLabel.w,{time:time,className:"border-dotted border-b"}),!loading&&!time&&(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"-"})]})}var Query=__webpack_require__("../../frontend/src/queries/Query/Query.tsx");let EventsTab=()=>{let{eventsQuery}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r);return(0,jsx_runtime.jsx)(Query.A,{query:eventsQuery,context:{columns:{"recording_button(properties.$session_id)":{title:"Recording",width:"134px"}},showOpenEditorButton:!1,insightProps:{dashboardItemId:"new-ErrorTrackingEventsQuery"}}})};var ViewRecordingButton=__webpack_require__("../../frontend/src/lib/components/ViewRecordingButton/ViewRecordingButton.tsx"),error_tracking_utils=__webpack_require__("../../frontend/src/scenes/error-tracking/utils.ts");let Overview=()=>{let{properties,propertiesLoading}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r);if(propertiesLoading)return(0,jsx_runtime.jsxs)("div",{className:"space-y-2 p-2",children:[(0,jsx_runtime.jsx)(src.yW,{}),(0,jsx_runtime.jsx)(src.yW.Row,{repeat:2})]});let{synthetic,level,browser,os,library,unhandled}=(0,error_tracking_utils.OZ)(properties);return(0,jsx_runtime.jsx)("div",{className:"grid grid-cols-2 gap-2",children:[{label:"Level",value:level},{label:"Synthetic",value:synthetic},{label:"Library",value:library},{label:"Unhandled",value:unhandled},{label:"Browser",value:browser},{label:"OS",value:os},{label:"URL",value:properties.$current_url}].filter(row=>void 0!==row.value).map((row,index)=>(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsx)("span",{className:"font-semibold w-full",children:row.label}),(0,jsx_runtime.jsx)("span",{className:"w-full truncate",title:row.value,children:row.value+""})]},index))})};function DetailsWidget(){let{properties}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r),sessionId=(0,error_tracking_utils.MQ)(properties);return(0,jsx_runtime.jsx)(src._j,{title:"Details",actions:(0,jsx_runtime.jsx)(ViewRecordingButton.Z,{sessionId:sessionId,timestamp:properties.timestamp,inModal:!0,size:"xsmall",type:"primary",disabledReason:sessionId?"":"No recording available"}),children:(0,jsx_runtime.jsx)("div",{className:"p-2",children:(0,jsx_runtime.jsx)(Overview,{})})})}var EmptyMessage=__webpack_require__("../../frontend/src/lib/components/EmptyMessage/EmptyMessage.tsx"),stackFrameLogic=__webpack_require__("../../frontend/src/lib/components/Errors/stackFrameLogic.ts"),StackTraces=__webpack_require__("../../frontend/src/lib/components/Errors/StackTraces.tsx");function StacktraceWidget(){let{properties,propertiesLoading}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r),{showAllFrames,frameOrderReversed}=(0,index_esm.useValues)(stackFrameLogic.e),{setShowAllFrames,reverseFrameOrder}=(0,index_esm.useActions)(stackFrameLogic.e),{exceptionList}=(0,error_tracking_utils.OZ)(properties),showStacktrace=(0,error_tracking_utils.mX)(exceptionList),hasAnyInApp=(0,error_tracking_utils.EQ)(exceptionList),orderedExceptions=applyFrameOrder(exceptionList,frameOrderReversed);return(0,jsx_runtime.jsx)(src._j,{title:"Stacktrace",actions:(0,jsx_runtime.jsxs)("div",{className:"flex gap-2",children:[!propertiesLoading&&showStacktrace&&(0,jsx_runtime.jsxs)(src.Jp,{className:"space-x-2",type:"tertiary",size:"xsmall",onClick:()=>reverseFrameOrder(!frameOrderReversed),children:[(0,jsx_runtime.jsx)("span",{className:"me-1",children:frameOrderReversed?"First call":"Last call"}),(0,jsx_runtime.jsx)(posthog_icons_es.IconSort,{})]}),!propertiesLoading&&hasAnyInApp&&(0,jsx_runtime.jsxs)(src.Jp,{className:"space-x-2",type:"tertiary",size:"xsmall",onClick:()=>setShowAllFrames(!showAllFrames),children:[(0,jsx_runtime.jsx)("span",{className:"me-1",children:showAllFrames?"Full stack":"In app"}),(0,jsx_runtime.jsx)(posthog_icons_es.IconFilter,{})]})]}),children:(0,jsx_runtime.jsxs)("div",{className:"p-2",children:[!propertiesLoading&&showStacktrace&&(0,jsx_runtime.jsx)(StackTraces.v,{showAllFrames:!hasAnyInApp||showAllFrames,exceptionList:orderedExceptions}),!propertiesLoading&&!showStacktrace&&(0,jsx_runtime.jsx)(EmptyMessage.M,{title:"No stacktrace available",description:"Make sure sdk is setup correctly or contact support if problem persists",buttonText:"Check documentation",buttonTo:"https://posthog.com/docs/error-tracking/installation"}),propertiesLoading&&(0,jsx_runtime.jsxs)("div",{className:"space-y-2",children:[(0,jsx_runtime.jsx)(src.yW,{}),(0,jsx_runtime.jsx)(src.yW.Row,{repeat:2})]})]})})}function applyFrameOrder(exceptionList,frameOrderReversed){return frameOrderReversed&&(exceptionList=exceptionList.map(exception=>(exception.stacktrace&&(exception.stacktrace.frames=exception.stacktrace.frames.slice().reverse()),exception)).reverse()),exceptionList}let scene={component:ErrorTrackingIssueScene,logic:errorTrackingIssueSceneLogic.r,paramsToProps:_ref=>{let{params:{id},searchParams:{fingerprint}}=_ref;return{id,fingerprint}}},STATUS_LABEL={active:"Active",archived:"Archived",resolved:"Resolved",pending_release:"Pending release",suppressed:"Suppressed"};function ErrorTrackingIssueScene(){let{issue,issueLoading}=(0,index_esm.useValues)(errorTrackingIssueSceneLogic.r),{loadIssue,updateStatus,updateAssignee}=(0,index_esm.useActions)(errorTrackingIssueSceneLogic.r),[activeTab,setActiveTab]=(0,react.useState)("stacktrace");return(0,react.useEffect)(()=>{loadIssue()},[loadIssue]),(0,jsx_runtime.jsx)(ErrorTrackingSetupPrompt.n,{children:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(PageHeader.m,{buttons:(0,jsx_runtime.jsxs)("div",{className:"flex gap-x-2",children:[!issueLoading&&issue?.status=="active"&&(0,jsx_runtime.jsx)(AssigneeSelect.i,{assignee:issue?.assignee,onChange:updateAssignee,type:"secondary",showName:!0}),!issueLoading&&(0,jsx_runtime.jsx)(GenericSelect.e,{size:"small",current:issue?.status,values:["active","resolved","suppressed"],placeholder:"Mark as",renderValue:value=>(0,jsx_runtime.jsx)(Indicator.Eg,{status:value,size:"small",withTooltip:!0}),onChange:updateStatus})]})}),(0,jsx_runtime.jsxs)("div",{className:"ErrorTrackingIssue",children:[(0,jsx_runtime.jsx)(Metadata,{}),(0,jsx_runtime.jsx)(src.TP,{activeKey:activeTab,onChange:key=>setActiveTab(key),tabs:[{key:"stacktrace",label:"Overview",content:(0,jsx_runtime.jsxs)("div",{className:"space-y-2",children:[(0,jsx_runtime.jsx)(DetailsWidget,{}),(0,jsx_runtime.jsx)(StacktraceWidget,{})]})},{key:"events",label:"Events",content:(0,jsx_runtime.jsxs)("div",{className:"space-y-2",children:[(0,jsx_runtime.jsx)(ErrorTrackingFilters.n,{}),(0,jsx_runtime.jsx)("div",{className:"border-1 overflow-hidden border-accent border-primary rounded bg-surface-primary relative",children:(0,jsx_runtime.jsx)(EventsTab,{})})]})}]})]})]})})}},"../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!../../node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.5.3_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!../../node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!../../frontend/src/scenes/error-tracking/ErrorTracking.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".ErrorTracking__issue{height:calc(100vh - 12rem);min-height:25rem}.ErrorTrackingIssue .SessionRecordingPlayer{height:24rem}.ErrorTrackingIssue .LemonCollapsePanel>.LemonButton:hover:has(.LemonSegmentedButton:hover){background-color:inherit}",""]),module.exports=exports}}]);