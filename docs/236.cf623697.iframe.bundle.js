(window.webpackJsonp=window.webpackJsonp||[]).push([[236],{5757:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createdAtColumn})),__webpack_require__.d(__webpack_exports__,"b",(function(){return createdByColumn}));__webpack_require__(35);var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),lib_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(11),kea__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1),scenes_userLogic__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(68),_TimezoneAware__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(472),lib_components_Table_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(874);function createdAtColumn(){return{title:Object(lib_components_Table_utils__WEBPACK_IMPORTED_MODULE_6__.a)("Created"),render:function RenderCreatedAt(_,item){return item.created_at&&react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{style:{whiteSpace:"nowrap"}},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_TimezoneAware__WEBPACK_IMPORTED_MODULE_5__.b,{time:item.created_at}))},sorter:function sorter(a,b){return new Date(a.created_at)>new Date(b.created_at)?1:-1}}}function createdByColumn(items){var user=Object(kea__WEBPACK_IMPORTED_MODULE_3__.useValues)(scenes_userLogic__WEBPACK_IMPORTED_MODULE_4__.a).user;return{title:Object(lib_components_Table_utils__WEBPACK_IMPORTED_MODULE_6__.a)("Created by"),render:function Render(_,item){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{style:{maxWidth:250,width:"auto"}},item.created_by?item.created_by.first_name||item.created_by.email:"-")},filters:Object(lib_utils__WEBPACK_IMPORTED_MODULE_2__.sb)(items.map((function(item){var _item$created_by,_item$created_by2,_item$created_by3;return item.created_by?{text:(null===(_item$created_by=item.created_by)||void 0===_item$created_by?void 0:_item$created_by.first_name)||(null===(_item$created_by2=item.created_by)||void 0===_item$created_by2?void 0:_item$created_by2.email),value:null===(_item$created_by3=item.created_by)||void 0===_item$created_by3?void 0:_item$created_by3.uuid}:{text:"(none)",value:null}})),(function(item){return null==item?void 0:item.value})).sort((function(a,b){return a.value===(null==user?void 0:user.uuid)?-10:b.value===(null==user?void 0:user.uuid)?10:(a.text+"").localeCompare(b.text+"")})),onFilter:function onFilter(value,item){var _item$created_by4;return null===value&&null===item.created_by||(null===(_item$created_by4=item.created_by)||void 0===_item$created_by4?void 0:_item$created_by4.uuid)===value},sorter:function sorter(a,b){var _a$created_by,_a$created_by2,_b$created_by,_b$created_by2;return((null===(_a$created_by=a.created_by)||void 0===_a$created_by?void 0:_a$created_by.first_name)||(null===(_a$created_by2=a.created_by)||void 0===_a$created_by2?void 0:_a$created_by2.email)||"").localeCompare((null===(_b$created_by=b.created_by)||void 0===_b$created_by?void 0:_b$created_by.first_name)||(null===(_b$created_by2=b.created_by)||void 0===_b$created_by2?void 0:_b$created_by2.email)||"")}}}try{createdByColumn.displayName="createdByColumn",createdByColumn.__docgenInfo={description:"",displayName:"createdByColumn",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Table/Table.tsx#createdByColumn"]={docgenInfo:createdByColumn.__docgenInfo,name:"createdByColumn",path:"frontend/src/lib/components/Table/Table.tsx#createdByColumn"})}catch(__react_docgen_typescript_loader_error){}},5783:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return featureFlagsLogic}));__webpack_require__(39),__webpack_require__(152),__webpack_require__(41),__webpack_require__(35),__webpack_require__(37),__webpack_require__(44);var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(17),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6__),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(5),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_7__),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__=(__webpack_require__(66),__webpack_require__(12)),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__),kea__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(1),lib_api__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(20),_teamLogic__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(25),featureFlagsLogic=Object(kea__WEBPACK_IMPORTED_MODULE_10__.kea)({path:["scenes","feature-flags","featureFlagsLogic"],connect:{values:[_teamLogic__WEBPACK_IMPORTED_MODULE_12__.a,["currentTeamId"]]},actions:{updateFlag:function updateFlag(flag){return{flag:flag}}},loaders:function loaders(_ref){var _updateFeatureFlag,_loadFeatureFlags,values=_ref.values;return{featureFlags:{__default:[],loadFeatureFlags:(_loadFeatureFlags=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_7___default.a.mark((function _callee(){var response;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_7___default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,lib_api__WEBPACK_IMPORTED_MODULE_11__.a.get("api/projects/".concat(values.currentTeamId,"/feature_flags/"));case 2:return response=_context.sent,_context.abrupt("return",response.results);case 4:case"end":return _context.stop()}}),_callee)}))),function loadFeatureFlags(){return _loadFeatureFlags.apply(this,arguments)}),updateFeatureFlag:(_updateFeatureFlag=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_7___default.a.mark((function _callee2(_ref2){var id,payload,response;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_7___default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return id=_ref2.id,payload=_ref2.payload,_context2.next=3,lib_api__WEBPACK_IMPORTED_MODULE_11__.a.update("api/projects/".concat(values.currentTeamId,"/feature_flags/").concat(id),payload);case 3:return response=_context2.sent,_context2.abrupt("return",_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default()(values.featureFlags).map((function(flag){return flag.id===response.id?response:flag})));case 5:case"end":return _context2.stop()}}),_callee2)}))),function updateFeatureFlag(_x){return _updateFeatureFlag.apply(this,arguments)})}}},reducers:{featureFlags:{updateFlag:function updateFlag(state,_ref3){var flag=_ref3.flag;return state.find((function(_ref4){return _ref4.id===flag.id}))?state.map((function(stateFlag){return stateFlag.id===flag.id?flag:stateFlag})):[flag].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default()(state))}}},events:function events(_ref5){var actions=_ref5.actions;return{afterMount:function afterMount(){actions.loadFeatureFlags()}}}})},6144:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene})),__webpack_require__.d(__webpack_exports__,"FeatureFlags",(function(){return FeatureFlags}));__webpack_require__(64);var react=__webpack_require__(0),react_default=__webpack_require__.n(react),index_esm=__webpack_require__(1),featureFlagsLogic=__webpack_require__(5783),typography=__webpack_require__(5627),es_switch=__webpack_require__(5629),table=__webpack_require__(2634),Link=__webpack_require__(56),utils=__webpack_require__(11),asn_DisconnectOutlined={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832.6 191.4c-84.6-84.6-221.5-84.6-306 0l-96.9 96.9 51 51 96.9-96.9c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204l-96.9 96.9 51.1 51.1 96.9-96.9c84.4-84.6 84.4-221.5-.1-306.1zM446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l96.9-96.9-51.1-51.1-96.9 96.9c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l96.9-96.9-51-51-96.8 97zM260.3 209.4a8.03 8.03 0 00-11.3 0L209.4 249a8.03 8.03 0 000 11.3l554.4 554.4c3.1 3.1 8.2 3.1 11.3 0l39.6-39.6c3.1-3.1 3.1-8.2 0-11.3L260.3 209.4z"}}]},name:"disconnect",theme:"outlined"},AntdIcon=__webpack_require__(18),icons_DisconnectOutlined_DisconnectOutlined=function DisconnectOutlined(props,ref){return react.createElement(AntdIcon.a,Object.assign({},props,{ref:ref,icon:asn_DisconnectOutlined}))};icons_DisconnectOutlined_DisconnectOutlined.displayName="DisconnectOutlined";var icons_DisconnectOutlined=react.forwardRef(icons_DisconnectOutlined_DisconnectOutlined),ExportOutlined=__webpack_require__(5725),EditOutlined=__webpack_require__(2627),DeleteOutlined=__webpack_require__(5643),PlusOutlined=__webpack_require__(1804),PageHeader=__webpack_require__(323),PropertyFilterButton=(__webpack_require__(35),__webpack_require__(843)),PropertyFiltersDisplay_PropertyFiltersDisplay=function PropertyFiltersDisplay(_ref){var filters=_ref.filters,style=_ref.style;return react_default.a.createElement("div",{className:"mb",style:style},filters&&filters.map((function(item){return react_default.a.createElement(PropertyFilterButton.b,{key:item.key,item:item})})))},components_PropertyFiltersDisplay=PropertyFiltersDisplay_PropertyFiltersDisplay;try{PropertyFiltersDisplay_PropertyFiltersDisplay.displayName="PropertyFiltersDisplay",PropertyFiltersDisplay_PropertyFiltersDisplay.__docgenInfo={description:"",displayName:"PropertyFiltersDisplay",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"AnyPropertyFilter[]"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/PropertyFilters/components/PropertyFiltersDisplay.tsx#PropertyFiltersDisplay"]={docgenInfo:PropertyFiltersDisplay_PropertyFiltersDisplay.__docgenInfo,name:"PropertyFiltersDisplay",path:"frontend/src/lib/components/PropertyFilters/components/PropertyFiltersDisplay.tsx#PropertyFiltersDisplay"})}catch(__react_docgen_typescript_loader_error){}var Table=__webpack_require__(5757),lib=__webpack_require__(21),LinkButton=__webpack_require__(287),CopyToClipboard=__webpack_require__(610),Table_utils=__webpack_require__(874),urls=__webpack_require__(26),Tooltip=__webpack_require__(58),stringWithWBR=__webpack_require__(2470),teamLogic=__webpack_require__(25),scene={component:FeatureFlags,logic:featureFlagsLogic.a};function FeatureFlags(){var currentTeamId=Object(index_esm.useValues)(teamLogic.a).currentTeamId,_useValues2=Object(index_esm.useValues)(featureFlagsLogic.a),featureFlags=_useValues2.featureFlags,featureFlagsLoading=_useValues2.featureFlagsLoading,_useActions=Object(index_esm.useActions)(featureFlagsLogic.a),updateFeatureFlag=_useActions.updateFeatureFlag,loadFeatureFlags=_useActions.loadFeatureFlags,push=Object(index_esm.useActions)(lib.router).push,tableScrollX=Object(Table_utils.b)("lg").tableScrollX,columns=[{title:Object(Table_utils.a)("Key"),dataIndex:"key",className:"ph-no-capture",fixed:"left",width:"15%",sorter:function sorter(a,b){return(""+a.key).localeCompare(b.key)},render:function Render(_,featureFlag){return react_default.a.createElement("div",{style:{display:"flex",alignItems:"center",maxWidth:210,width:"auto"}},!featureFlag.active&&react_default.a.createElement(Tooltip.a,{title:"This feature flag is disabled."},react_default.a.createElement(icons_DisconnectOutlined,{style:{marginRight:4}})),react_default.a.createElement("div",{onClick:function onClick(e){return e.stopPropagation()}},react_default.a.createElement(CopyToClipboard.a,{iconStyle:{color:"var(--primary)"},iconPosition:"start",explicitValue:featureFlag.key})),react_default.a.createElement(typography.a.Text,{title:featureFlag.key},Object(stringWithWBR.a)(featureFlag.key,17)))}},{title:Object(Table_utils.a)("Description"),render:function Render(_,featureFlag){return react_default.a.createElement("div",{style:{display:"flex",wordWrap:"break-word",maxWidth:450,width:"auto",whiteSpace:"break-spaces"}},react_default.a.createElement(typography.a.Paragraph,{ellipsis:{rows:5},title:featureFlag.name},featureFlag.name))},className:"ph-no-capture",sorter:function sorter(a,b){return(""+a.name).localeCompare(b.name)}},Object(Table.a)(),Object(Table.b)(featureFlags),{title:"Filters",render:function Render(_,featureFlag){var _featureFlag$filters;return(null===(_featureFlag$filters=featureFlag.filters)||void 0===_featureFlag$filters?void 0:_featureFlag$filters.groups)?featureFlag.filters.groups.length>1?"Multiple groups":function GroupFilters(_ref){var group=_ref.group;return group.properties&&group.properties.length>0&&null!=group.rollout_percentage?react_default.a.createElement("div",{style:{display:"flex",alignItems:"center"}},react_default.a.createElement("span",{style:{flexShrink:0,marginRight:5}},group.rollout_percentage,"% of"),react_default.a.createElement(components_PropertyFiltersDisplay,{filters:group.properties,style:{margin:0,width:"100%"}})):group.properties&&group.properties.length>0?react_default.a.createElement(components_PropertyFiltersDisplay,{filters:group.properties,style:{margin:0}}):null!==group.rollout_percentage&&void 0!==group.rollout_percentage?"".concat(group.rollout_percentage,"% of all users"):"100% of all users"}({group:featureFlag.filters.groups[0]}):"N/A"}},{title:"Enabled",width:90,align:"right",render:function RenderActive(_,featureFlag){return react_default.a.createElement(es_switch.a,{onClick:function onClick(_checked,e){return e.stopPropagation()},checked:featureFlag.active,onChange:function onChange(active){return featureFlag.id?updateFeatureFlag({id:featureFlag.id,payload:{active:active}}):null}})}},{title:Object(Table_utils.a)("Usage"),width:100,align:"right",render:function Render(_,featureFlag){return react_default.a.createElement(Link.a,{to:'/insights?events=[{"id":"$pageview","name":"$pageview","type":"events","math":"dau"}]&breakdown_type=event&breakdown=$feature/'.concat(featureFlag.key),"data-attr":"usage",onClick:function onClick(e){return e.stopPropagation()}},"Insights ",react_default.a.createElement(ExportOutlined.a,null))}},{title:Object(Table_utils.a)("Actions"),width:100,align:"right",render:function Render(_,featureFlag){return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(Link.a,{to:"/feature_flags/".concat(featureFlag.id)},react_default.a.createElement(EditOutlined.a,null)),featureFlag.id&&react_default.a.createElement(utils.b,{endpoint:"projects/".concat(currentTeamId,"/feature_flags"),object:{name:featureFlag.name,id:featureFlag.id},className:"text-danger",style:{marginLeft:8},callback:loadFeatureFlags},react_default.a.createElement(DeleteOutlined.a,null)))}}];return react_default.a.createElement("div",{className:"feature_flags"},react_default.a.createElement(PageHeader.a,{title:"Feature Flags",caption:"Feature flags are a way of turning functionality in your app on or off, based on user properties."}),react_default.a.createElement("div",{className:"mb text-right"},react_default.a.createElement(LinkButton.a,{type:"primary",to:urls.a.featureFlag("new"),"data-attr":"new-feature-flag",icon:react_default.a.createElement(PlusOutlined.a,null)},"New Feature Flag")),react_default.a.createElement(table.a,{dataSource:featureFlags,columns:columns,loading:featureFlagsLoading&&0===featureFlags.length,pagination:{pageSize:99999,hideOnSinglePage:!0},onRow:function onRow(featureFlag){return{onClick:function onClick(){return featureFlag.id&&push(urls.a.featureFlag(featureFlag.id))},style:featureFlag.active?{}:{color:"var(--muted)"}}},size:"small",rowClassName:"cursor-pointer","data-attr":"feature-flag-table",scroll:{x:tableScrollX}}))}}}]);