"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[92746],{"../../frontend/src/scenes/pipeline/PipelineNode.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PIPELINE_TAB_TO_NODE_STAGE:()=>PIPELINE_TAB_TO_NODE_STAGE,PipelineNode:()=>PipelineNode,scene:()=>scene});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),ActivityLog=__webpack_require__("../../frontend/src/lib/components/ActivityLog/ActivityLog.tsx"),FlaggedFeature=__webpack_require__("../../frontend/src/lib/components/FlaggedFeature.tsx"),NotFound=__webpack_require__("../../frontend/src/lib/components/NotFound/index.tsx"),LemonTabs=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTabs/LemonTabs.tsx"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),BatchExportsMetrics=__webpack_require__("../../frontend/src/scenes/data-pipelines/batch-exports/BatchExportsMetrics.tsx"),LogsViewer=__webpack_require__("../../frontend/src/scenes/hog-functions/logs/LogsViewer.tsx"),HogFunctionMetrics=__webpack_require__("../../frontend/src/scenes/hog-functions/metrics/HogFunctionMetrics.tsx"),HogFunctionTesting=__webpack_require__("../../frontend/src/scenes/hog-functions/testing/HogFunctionTesting.tsx"),PipelineNodeLogs=__webpack_require__("../../frontend/src/scenes/pipeline/PipelineNodeLogs.tsx"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),types=__webpack_require__("../../frontend/src/types.ts"),BatchExportBackfills=__webpack_require__("../../frontend/src/scenes/data-pipelines/batch-exports/BatchExportBackfills.tsx"),BatchExportRuns=__webpack_require__("../../frontend/src/scenes/data-pipelines/batch-exports/BatchExportRuns.tsx"),HogFunctionLogs=__webpack_require__("../../frontend/src/scenes/hog-functions/logs/HogFunctionLogs.tsx"),BatchExportConfiguration=__webpack_require__("../../frontend/src/scenes/data-pipelines/batch-exports/BatchExportConfiguration.tsx"),HogFunctionConfiguration=__webpack_require__("../../frontend/src/scenes/hog-functions/configuration/HogFunctionConfiguration.tsx"),PipelinePluginConfiguration=__webpack_require__("../../frontend/src/scenes/pipeline/PipelinePluginConfiguration.tsx"),pipelineNodeLogic=__webpack_require__("../../frontend/src/scenes/pipeline/pipelineNodeLogic.tsx"),pipeline_types=__webpack_require__("../../frontend/src/scenes/pipeline/types.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function PipelineNodeConfiguration(){let{node,stage}=(0,index_esm.useValues)(pipelineNodeLogic.y);return stage?(0,jsx_runtime.jsx)("div",{className:"deprecated-space-y-3",children:node.backend===pipeline_types.b.HogFunction?(0,jsx_runtime.jsx)(HogFunctionConfiguration.g,{id:node.id}):node.backend===pipeline_types.b.Plugin?(0,jsx_runtime.jsx)(PipelinePluginConfiguration.s,{stage:stage,pluginConfigId:node.id}):(0,jsx_runtime.jsx)(BatchExportConfiguration.J,{id:node.id.toString()})}):(0,jsx_runtime.jsx)(NotFound.T,{object:"pipeline app stage"})}var PipelineNodeMetrics=__webpack_require__("../../frontend/src/scenes/pipeline/PipelineNodeMetrics.tsx");let PIPELINE_TAB_TO_NODE_STAGE={[types.J9.Transformations]:types.We.Transformation,[types.J9.Destinations]:types.We.Destination,[types.J9.SiteApps]:types.We.SiteApp,[types.J9.ImportApps]:types.We.ImportApp,[types.J9.Sources]:types.We.Source},paramsToProps=_ref=>{let{params:{stage,id}}=_ref,numericId=id&&/^\d+$/.test(id)?parseInt(id):void 0;if(!stage||!id)throw Error("Loaded PipelineNode without either `stage` or `id` passed in");return{stage:PIPELINE_TAB_TO_NODE_STAGE[stage]||null,id:numericId&&!isNaN(numericId)?numericId:id}},scene={component:PipelineNode,logic:pipelineNodeLogic.y,paramsToProps};function PipelineNode(){let params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{stage,id}=paramsToProps({params}),{currentTab,node}=(0,index_esm.useValues)(pipelineNodeLogic.y);if(!stage)return(0,jsx_runtime.jsx)(NotFound.T,{object:"pipeline stage"});let tabToContent={[types.il.Configuration]:(0,jsx_runtime.jsx)(PipelineNodeConfiguration,{}),[types.il.Metrics]:node.backend===pipeline_types.b.HogFunction?(0,jsx_runtime.jsx)(HogFunctionMetrics.k,{id:node.id}):node.backend===pipeline_types.b.BatchExport?(0,jsx_runtime.jsx)(FlaggedFeature.P,{flag:"batch-export-new-metrics",fallback:(0,jsx_runtime.jsx)(PipelineNodeMetrics._,{id:id}),children:(0,jsx_runtime.jsx)(BatchExportsMetrics.c,{id:id.toString()})}):(0,jsx_runtime.jsx)(PipelineNodeMetrics._,{id:id}),[types.il.Logs]:node.backend===pipeline_types.b.HogFunction?(0,jsx_runtime.jsx)(HogFunctionLogs.x,{hogFunctionId:id.toString().substring(4)}):node.backend===pipeline_types.b.BatchExport?(0,jsx_runtime.jsx)(FlaggedFeature.P,{flag:"batch-export-new-logs",fallback:(0,jsx_runtime.jsx)(PipelineNodeLogs.e,{id:id,stage:stage}),children:(0,jsx_runtime.jsx)(LogsViewer.FW,{sourceType:"batch_export",sourceId:id.toString(),instanceLabel:"run"})}):(0,jsx_runtime.jsx)(PipelineNodeLogs.e,{id:id,stage:stage})};return node.backend===pipeline_types.b.BatchExport&&(tabToContent[types.il.Runs]=(0,jsx_runtime.jsx)(BatchExportRuns.t_,{id:node.id}),tabToContent[types.il.Backfills]=(0,jsx_runtime.jsx)(BatchExportBackfills.F,{id:node.id})),node.backend===pipeline_types.b.Plugin&&(tabToContent[types.il.History]=(0,jsx_runtime.jsx)(ActivityLog.DA,{id:id,scope:types.jc.PLUGIN})),node.backend===pipeline_types.b.HogFunction&&(stage===types.We.Destination&&(tabToContent[types.il.Testing]=(0,jsx_runtime.jsx)(HogFunctionTesting.D,{id:node.id})),tabToContent[types.il.History]=(0,jsx_runtime.jsx)(ActivityLog.DA,{id:String(id).startsWith("hog-")?String(id).substring(4):id,scope:types.jc.HOG_FUNCTION})),stage===types.We.SiteApp&&(delete tabToContent[types.il.Logs],delete tabToContent[types.il.Metrics]),(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(LemonTabs.T,{activeKey:currentTab,tabs:Object.entries(tabToContent).map(_ref2=>{let[tab,content]=_ref2;return{label:(0,utils.fm)(tab),key:tab,content:content,link:params.stage?urls.j.pipelineNode(stage,id,tab):void 0}})})})}}}]);