(window.webpackJsonp=window.webpackJsonp||[]).push([[305],{"./frontend/src/scenes/billing/Billing.tsx":function(b,r,n){"use strict";n.r(r),n.d(r,"scene",function(){return X}),n.d(r,"Billing",function(){return T});var d=n("./frontend/src/lib/components/PageHeader.tsx"),p=n("./frontend/src/scenes/billing/Plan.tsx"),se=n("./node_modules/core-js/modules/es.object.keys.js"),ie=n("./node_modules/core-js/modules/es.symbol.js"),oe=n("./node_modules/core-js/modules/es.array.filter.js"),re=n("./node_modules/core-js/modules/es.object.to-string.js"),ae=n("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),ce=n("./node_modules/core-js/modules/web.dom-collections.for-each.js"),de=n("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),A=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),I=n.n(A),F=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),V=n.n(F),w=n("./node_modules/antd/es/progress/index.js"),u=n("./node_modules/kea/lib/index.esm.js"),O=n("./frontend/src/lib/utils.tsx"),j=n("./frontend/src/scenes/billing/billingLogic.ts"),U=n("./frontend/src/lib/components/Tooltip.tsx"),R=n("./frontend/src/lib/components/LemonTable/index.ts"),y=n("./frontend/src/lib/dayjs.ts"),a=n("./frontend/@posthog/lemon-ui/src/index.ts"),$=n("./frontend/src/lib/logic/featureFlagLogic.ts"),E=n("./frontend/src/lib/constants.tsx"),z=n("./node_modules/react/index.js"),e=n("./node_modules/react/jsx-runtime.js");function B(s,t){var o=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);t&&(i=i.filter(function(f){return Object.getOwnPropertyDescriptor(s,f).enumerable})),o.push.apply(o,i)}return o}function P(s){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?B(Object(o),!0).forEach(function(i){I()(s,i,o[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(o)):B(Object(o)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(o,i))})}return s}function S(){var s,t=Object(u.useValues)(j.b),o=t.eventAllocation,i=t.percentage,f=t.strokeColor,M=t.showUsageTiers,l=t.billing,Y=Object(u.useActions)(j.b),Z=Y.toggleUsageTiers,k=Y.setBillingLimit,q=Object(u.useValues)($.a),_=q.featureFlags,ee=Object(z.useState)((l==null?void 0:l.billing_limit)||0),C=V()(ee,2),D=C[0],ne=C[1],v=l==null?void 0:l.plan;if(!l)return null;var te=[{title:"Tier",dataIndex:"name"},{title:"Price per event",render:function(m,c){return Object(e.jsxs)("div",{children:["$",c.price_per_event]})}},{title:"Number of events",dataIndex:"number_of_events"},{title:"Sub-total",render:function(m,c){return Object(e.jsxs)("div",{children:["$",c.subtotal]})}},{title:"Running total",render:function(m,c){return Object(e.jsxs)("div",{children:["$",c.running_total]})}}],x=l.current_bill_usage||l.current_usage,le=_[E.h.BILLING_LIMIT];return Object(e.jsxs)("div",{className:"border rounded p-4",children:[l.should_display_current_bill&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h3",{className:"text-xs uppercase font-semibold text-muted",children:"Current Bill Amount"}),(l==null?void 0:l.current_bill_amount)!==void 0&&(l==null?void 0:l.current_bill_amount)!==null?Object(e.jsxs)("div",{className:"flex flex-col space-y-2",children:[Object(e.jsx)("div",{className:"text-5xl font-extrabold",children:"$".concat(l==null||(s=l.current_bill_amount)===null||s===void 0?void 0:s.toLocaleString())}),Object(e.jsxs)("p",{children:["This is the amount (in dollars) of the bill for the currently ongoing period. The final amount will be billed a few days after the end of the month. Please note this number is reported on a daily basis,"," ",Object(e.jsx)("b",{children:"so events ingested in the last 24 hours may not be reflected yet."})]}),M&&Object(e.jsx)(R.a,{columns:te,dataSource:l.tiers||[]}),Object(e.jsx)("div",{className:"flex-none",children:Object(e.jsxs)(a.LemonButton,{type:"secondary",onClick:Z,children:[M?"Hide":"Show"," usage tiers"]})})]}):Object(e.jsxs)(e.Fragment,{children:["We can't show your current bill amount right now. Please check back again in a few minutes or"," ",Object(e.jsx)("a",{href:"https://posthog.com/support/",target:"_blank",children:"contact us"})," ","if this message does not disappear."]}),(l==null?void 0:l.current_bill_cycle)&&Object(e.jsxs)("p",{className:"mt-4 text-muted",children:["Your current billing period runs from"," ",Object(e.jsx)("strong",{children:y.a.unix(l.current_bill_cycle.current_period_start).format("MMMM DD, YYYY")})," ","until"," ",Object(e.jsx)("strong",{children:y.a.unix(l.current_bill_cycle.current_period_end).format("MMMM DD, YYYY")}),", which is when you'll be charged."]}),Object(e.jsx)(a.LemonDivider,{className:"my-6"})]}),Object(e.jsx)("h3",{className:"text-xs uppercase font-semibold text-muted",children:"Current Usage"}),x!==null?Object(e.jsxs)(e.Fragment,{children:["Your organization has used"," ",Object(e.jsx)(U.a,{title:"".concat(x.toLocaleString()," events"),children:Object(e.jsx)("b",{children:Object(O.p)(x)})})," ","events ",l.current_bill_usage?"this billing period":"this month"," (calculated every day)."," ",o&&Object(e.jsxs)(e.Fragment,{children:["You can use up to ",Object(e.jsx)("b",{children:Object(O.p)(o)})," events per month."]}),v&&!v.event_allowance&&!v.is_metered_billing&&"Your current plan has an unlimited event allocation.",Object(e.jsx)(w.a,{type:"line",percent:i!==null?Math.floor(i*100):100,strokeColor:f,status:i!==null?"normal":"success"}),Object(e.jsx)("p",{children:"This is the number of events that your organization has ingested across all your projects for the current month and that will be billed a few days after the end of the month."})]}):Object(e.jsxs)("div",{children:["Currently we do not have information about the number of billed events. Please check back again in a few minutes or"," ",Object(e.jsx)("a",{href:"https://posthog.com/support/",target:"_blank",children:"contact us"})," ","if this message does not disappear."]}),le&&l.plan&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(a.LemonDivider,{className:"my-6"}),Object(e.jsx)("h3",{className:"text-xs uppercase font-semibold text-muted",children:"Billing Limit"}),Object(e.jsxs)("div",{className:"flex flex-row space-x-2 my-2",children:[Object(e.jsx)("div",{className:"flex-none",children:Object(e.jsx)(a.LemonInput,{type:"number",onChange:function(m){ne(m||0)},value:D,min:0,step:10,prefix:Object(e.jsx)(e.Fragment,{children:"$"}),suffix:Object(e.jsx)("div",{className:"shrink-0",children:"USD / MONTH"})})}),Object(e.jsx)(a.LemonButton,{type:"secondary",onClick:function(){l&&k(P(P({},l),{},{billing_limit:D}))},children:"Submit"})]}),Object(e.jsxs)("p",{children:["Set a billing limit to control your recurring costs."," ",Object(e.jsx)("b",{children:"Your critical data will still be ingested and available in the product."})," Some features may cease operation if your usage greatly exceeds your billing cap."]})]})]})}var L=n("./frontend/src/scenes/billing/BillingEnrollment.tsx"),H=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),J=n.n(H),G=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/billing/Billing.scss"),N=n.n(G),h={};h.insert="head",h.singleton=!1;var ue=J()(N.a,h),je=N.a.locals||{},K=n("./frontend/src/lib/components/AlertMessage/index.ts"),W=n("./frontend/src/scenes/billing/v2/Billing.tsx"),Q=n("./frontend/src/lib/components/Spinner/Spinner.tsx"),X={component:T,logic:j.b};function T(){var s=Object(u.useValues)(j.b),t=s.billing,o=s.isSmallScreen,i=s.billingVersion;return i?i==="v2"?Object(e.jsxs)("div",{children:[Object(e.jsx)(d.a,{title:"Billing & usage"}),Object(e.jsx)(W.a,{})]}):Object(e.jsxs)("div",{className:"flex flex-col space-y-6",children:[Object(e.jsx)(d.a,{title:"Billing & usage"}),Object(e.jsx)(a.LemonDivider,{}),(t==null?void 0:t.should_setup_billing)&&Object(e.jsxs)(K.a,{type:"warning",action:{children:t.subscription_url?Object(e.jsx)("a",{href:t.subscription_url,children:Object(e.jsx)(a.LemonButton,{children:"Finish setup"})}):void 0},children:["Your plan is ",Object(e.jsx)("b",{children:"currently inactive"})," as you haven't finished setting up your billing information."]}),o?Object(e.jsxs)("div",{className:"flex flex-col space-y-4",children:[Object(e.jsx)(S,{}),t!=null&&t.plan?Object(e.jsx)(p.a,{plan:t.plan,currentPlan:!0}):Object(e.jsx)(L.a,{})]}):Object(e.jsxs)("div",{className:"flex flex-row space-x-4",children:[Object(e.jsx)("div",{className:"w-2/3",children:Object(e.jsx)(S,{})}),Object(e.jsx)("div",{className:"w-1/3",children:t!=null&&t.plan&&!(t!=null&&t.should_setup_billing)?Object(e.jsx)(p.a,{plan:t.plan,currentPlan:!0}):Object(e.jsx)(L.a,{})})]})]}):Object(e.jsx)(Q.b,{})}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/billing/Billing.scss":function(b,r,n){var d=n("./node_modules/css-loader/dist/runtime/api.js");r=d(!1),r.push([b.i,".BillingPlan{max-width:500px;flex-grow:1}.BillingPlan .BillingPlan__description ol,.BillingPlan .BillingPlan__description ul{margin-top:1rem;padding-left:0;list-style:none;text-align:center}.BillingPlan .BillingPlan__description ol li,.BillingPlan .BillingPlan__description ul li{line-height:1.2rem;margin-bottom:1rem}.BillingPlan .BillingPlan__description ol .disclaimer,.BillingPlan .BillingPlan__description ul .disclaimer{font-size:10px;font-weight:700;vertical-align:top;padding-left:1px}.BillingPlan .BillingPlan__description .disclaimer-details{font-size:.75rem;color:var(--muted);margin-top:1rem}",""]),b.exports=r}}]);
