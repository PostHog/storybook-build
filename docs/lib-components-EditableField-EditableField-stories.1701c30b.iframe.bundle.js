(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[6319],{"./frontend/src/lib/components/EditableField/EditableField.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{f:function(){return EditableField_EditableField_EditableField}});var react=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/.pnpm/style-loader@2.0.0_webpack@5.88.2/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),EditableField=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/lib/components/EditableField/EditableField.scss"),EditableField_default=__webpack_require__.n(EditableField),options={insert:"head",singleton:!1},icons=(injectStylesIntoStyleTag_default()(EditableField_default(),options),EditableField_default().locals,__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts")),LemonButton=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/index.ts"),react_textarea_autosize_browser_esm=__webpack_require__("./node_modules/.pnpm/react-textarea-autosize@8.3.4_@types+react@16.14.34_react@16.14.0/node_modules/react-textarea-autosize/dist/react-textarea-autosize.browser.esm.js"),clsx_m=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),utils=__webpack_require__("./frontend/src/lib/utils.tsx"),Tooltip=__webpack_require__("./frontend/src/lib/lemon-ui/Tooltip.tsx"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function EditableField_EditableField_EditableField(_ref){let{name:name,value:value,onChange:onChange,onSave:onSave,saveOnBlur:saveOnBlur=!1,placeholder:placeholder,minLength:minLength,maxLength:maxLength,autoFocus:autoFocus=!0,multiline:multiline=!1,compactButtons:compactButtons=!1,paywall:paywall=!1,mode:mode,className:className,style:style,"data-attr":dataAttr,saveButtonText:saveButtonText="Save",notice:notice}=_ref;const[localIsEditing,setLocalIsEditing]=(0,react.useState)(!1),[tentativeValue,setTentativeValue]=(0,react.useState)(value);(0,react.useEffect)((()=>{setTentativeValue(value)}),[value]);const isSaveable=!minLength||tentativeValue.length>=minLength,cancel=()=>{setLocalIsEditing(!1),setTentativeValue(value)},save=()=>{onSave?.(tentativeValue),setLocalIsEditing(!1)},isEditing=!paywall&&("edit"===mode||localIsEditing),handleKeyDown=e=>{isEditing&&(isSaveable&&"Enter"===e.key&&(!multiline||e.metaKey||e.ctrlKey)?(save(),e.stopPropagation(),e.preventDefault()):"Escape"===e.key&&(cancel(),e.stopPropagation(),e.preventDefault()))};return(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.default)("EditableField",multiline&&"EditableField--multiline",isEditing&&"EditableField--editing",className),"data-attr":dataAttr,style:style,children:[(0,jsx_runtime.jsx)(Tooltip.u,{placement:"right",title:paywall?"This field is part of PostHog's collaboration feature set and requires a premium plan.":void 0,children:(0,jsx_runtime.jsx)("div",{className:"EditableField--highlight",children:isEditing?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[multiline?(0,jsx_runtime.jsx)(react_textarea_autosize_browser_esm.Z,{name:name,value:tentativeValue,onChange:e=>{onChange?.(e.target.value),setTentativeValue(e.target.value)},onBlur:saveOnBlur?tentativeValue!==value?save:cancel:void 0,onKeyDown:handleKeyDown,placeholder:placeholder,minLength:minLength,maxLength:maxLength,autoFocus:autoFocus}):(0,jsx_runtime.jsx)(AutosizeInput,{name:name,value:tentativeValue,onChange:e=>{onChange?.(e.target.value),setTentativeValue(e.target.value)},onBlur:saveOnBlur?tentativeValue!==value?save:cancel:void 0,onKeyDown:handleKeyDown,placeholder:placeholder,minLength:minLength,maxLength:maxLength,autoFocus:autoFocus}),!mode&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(LemonButton.Jp,{title:"Cancel editing",size:"small",onClick:cancel,type:"secondary",onMouseDown:e=>{e.preventDefault()},children:"Cancel"}),(0,jsx_runtime.jsx)(LemonButton.Jp,{title:minLength?`Save (at least ${(0,utils._6)(minLength,"character","characters")} required)`:"Save",size:"small",disabled:!isSaveable,onClick:save,type:"primary",children:saveButtonText})]})]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[tentativeValue||(0,jsx_runtime.jsx)("i",{children:placeholder}),!mode&&(0,jsx_runtime.jsx)(LemonButton.Jp,{title:"Edit",icon:(0,jsx_runtime.jsx)(icons.yl5,{}),size:compactButtons?"small":void 0,onClick:()=>setLocalIsEditing(!0),"data-attr":`edit-prop-${name}`,disabled:paywall,noPadding:!0})]})})}),!isEditing&&notice&&(0,jsx_runtime.jsx)(Tooltip.u,{title:notice.tooltip,placement:"right",children:react.cloneElement(notice.icon,{...notice.icon.props,className:(0,clsx_m.default)(notice.icon.props.className,"EditableField__notice")})})]})}const AutosizeInput=_ref2=>{let{name:name,value:value,onChange:onChange,placeholder:placeholder,onBlur:onBlur,onKeyDown:onKeyDown,minLength:minLength,maxLength:maxLength,autoFocus:autoFocus}=_ref2;const[inputWidth,setInputWidth]=(0,react.useState)(1),inputRef=(0,react.useRef)(null),sizerRef=(0,react.useRef)(null),placeHolderSizerRef=(0,react.useRef)(null),copyStyles=(styles,node)=>{node.style.fontSize=styles.fontSize,node.style.fontFamily=styles.fontFamily,node.style.fontWeight=styles.fontWeight,node.style.fontStyle=styles.fontStyle,node.style.letterSpacing=styles.letterSpacing,node.style.textTransform=styles.textTransform},inputStyles=(0,react.useMemo)((()=>inputRef.current?window.getComputedStyle(inputRef.current):null),[inputRef.current]);return(0,react.useLayoutEffect)((()=>{inputStyles&&placeHolderSizerRef.current&&copyStyles(inputStyles,placeHolderSizerRef.current)}),[placeHolderSizerRef,placeHolderSizerRef]),(0,react.useLayoutEffect)((()=>{inputStyles&&sizerRef.current&&copyStyles(inputStyles,sizerRef.current)}),[inputStyles,sizerRef]),(0,react.useLayoutEffect)((()=>{if(!sizerRef.current||!placeHolderSizerRef.current)return;let newInputWidth;newInputWidth=placeholder&&!value?Math.max(sizerRef.current.scrollWidth,placeHolderSizerRef.current.scrollWidth)+2:sizerRef.current.scrollWidth+2,newInputWidth!==inputWidth&&setInputWidth(newInputWidth)}),[sizerRef.current,placeHolderSizerRef.current,placeholder,value]),(0,jsx_runtime.jsxs)("div",{className:"EditableField__autosize",children:[(0,jsx_runtime.jsx)("input",{name:name,value:value,placeholder:placeholder,onChange:onChange,onKeyDown:onKeyDown,onBlur:onBlur,minLength:minLength,maxLength:maxLength,autoFocus:autoFocus,ref:inputRef,style:{boxSizing:"content-box",width:`${inputWidth}px`}}),(0,jsx_runtime.jsx)("div",{ref:sizerRef,className:"EditableField__autosize__sizer",children:value}),(0,jsx_runtime.jsx)("div",{ref:placeHolderSizerRef,className:"EditableField__autosize__sizer",children:placeholder})]})};try{EditableField_EditableField_EditableField.displayName="EditableField",EditableField_EditableField_EditableField.__docgenInfo={description:"",displayName:"EditableField",props:{name:{defaultValue:null,description:"What this field stands for.",name:"name",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((value: string) => void)"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!1,type:{name:"((value: string) => void)"}},saveOnBlur:{defaultValue:{value:"false"},description:"",name:"saveOnBlur",required:!1,type:{name:"boolean"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},minLength:{defaultValue:null,description:"",name:"minLength",required:!1,type:{name:"number"}},maxLength:{defaultValue:null,description:"",name:"maxLength",required:!1,type:{name:"number"}},autoFocus:{defaultValue:{value:"true"},description:"",name:"autoFocus",required:!1,type:{name:"boolean"}},multiline:{defaultValue:{value:"false"},description:"",name:"multiline",required:!1,type:{name:"boolean"}},compactButtons:{defaultValue:{value:"false"},description:"",name:"compactButtons",required:!1,type:{name:"boolean"}},paywall:{defaultValue:{value:"false"},description:'Whether this field should be gated behind a "paywall".',name:"paywall",required:!1,type:{name:"boolean"}},mode:{defaultValue:null,description:"Controlled mode.",name:"mode",required:!1,type:{name:"enum",value:[{value:'"view"'},{value:'"edit"'}]}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},"data-attr":{defaultValue:null,description:"",name:"data-attr",required:!1,type:{name:"string"}},saveButtonText:{defaultValue:{value:"Save"},description:"",name:"saveButtonText",required:!1,type:{name:"string"}},notice:{defaultValue:null,description:"Extra information shown next to the field.",name:"notice",required:!1,type:{name:"{ icon: ReactElement<any, string | JSXElementConstructor<any>>; tooltip: string; }"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/EditableField/EditableField.tsx#EditableField"]={docgenInfo:EditableField_EditableField_EditableField.__docgenInfo,name:"EditableField",path:"frontend/src/lib/components/EditableField/EditableField.tsx#EditableField"})}catch(__react_docgen_typescript_loader_error){}},"./frontend/src/lib/components/EditableField/EditableField.stories.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{EditableField_:function(){return EditableField_}});var _EditableField__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./frontend/src/lib/components/EditableField/EditableField.tsx"),_PageHeader__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./frontend/src/lib/components/PageHeader.tsx"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");const meta={title:"Components/Editable Field",component:_EditableField__WEBPACK_IMPORTED_MODULE_0__.f};function EditableField_(){const[savedTitle,setSavedTitle]=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)("Foo"),[savedDescription,setSavedDescription]=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)("Lorem ipsum dolor sit amet.");return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_PageHeader__WEBPACK_IMPORTED_MODULE_1__.m,{title:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_EditableField__WEBPACK_IMPORTED_MODULE_0__.f,{name:"title",value:savedTitle,onSave:value=>setSavedTitle(value)}),caption:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_EditableField__WEBPACK_IMPORTED_MODULE_0__.f,{name:"description",value:savedDescription,onSave:value=>setSavedDescription(value),multiline:!0})})}__webpack_exports__.default=meta,EditableField_.parameters={...EditableField_.parameters,docs:{...EditableField_.parameters?.docs,source:{originalSource:"function EditableField_(): JSX.Element {\n  const [savedTitle, setSavedTitle] = useState('Foo');\n  const [savedDescription, setSavedDescription] = useState('Lorem ipsum dolor sit amet.');\n  return <PageHeader title={<EditableFieldComponent name=\"title\" value={savedTitle} onSave={value => setSavedTitle(value)} />} caption={<EditableFieldComponent name=\"description\" value={savedDescription} onSave={value => setSavedDescription(value)} multiline />} />;\n}",...EditableField_.parameters?.docs?.source}}}},"./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/lib/components/EditableField/EditableField.scss":function(module,exports,__webpack_require__){(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".EditableField{display:flex;align-items:center;max-width:100%}.EditableField:not(.EditableField--multiline){line-height:2rem}.EditableField i{color:var(--muted)}.EditableField .EditableField__notice{font-size:1.5rem;color:var(--muted);margin-left:.5rem}.EditableField .EditableField--highlight{display:flex;flex-direction:row;align-items:center;width:-moz-fit-content;width:fit-content;max-width:calc(100% + .5rem);min-height:2rem;padding:.25rem;margin:-.25rem;white-space:pre-wrap;overflow:auto}.EditableField--editing .EditableField--highlight{flex-grow:1;align-items:flex-end;width:auto;max-width:calc(100% + .5rem);outline:1px solid var(--border);border-radius:var(--radius)}.EditableField .EditableField__autosize{align-self:center;min-width:0}.EditableField .EditableField__autosize__sizer{position:absolute;top:0;left:0;visibility:hidden;height:0;overflow:scroll;white-space:pre}.EditableField input,.EditableField textarea{max-width:100%;border:none;background:transparent;font:inherit;color:var(--default);outline:none;padding:0}.EditableField textarea{align-self:center;width:100%}.EditableField button{margin-left:.5rem}.EditableField button:first-of-type{margin-left:.75rem}",""]),module.exports=exports}}]);