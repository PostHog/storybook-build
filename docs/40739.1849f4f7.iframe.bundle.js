(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[40739],{"../../frontend/src/lib/animations/animations.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{ru:()=>AnimationType,sF:()=>animations,BG:()=>getAnimationSource});let musichog_lottie_url=__webpack_require__.p+"images/musichog.d4258deab99fafa012c2f635c1de4c1b.lottie",sportshog_lottie_url=__webpack_require__.p+"images/sportshog.2c45fe87d29fd3a5dea9bce15e12c8bd.lottie",AnimationType=function(AnimationType){return AnimationType.MusicHog="musichog",AnimationType.SportsHog="sportshog",AnimationType}({}),animations={musichog:{url:musichog_lottie_url,width:800,height:800},sportshog:{url:sportshog_lottie_url,width:800,height:800}},animationCache={},fetchCache={};async function fetchJson(url){let response=await window.fetch(url);return await response.json()}async function getAnimationSource(animation){return animationCache[animation]||(animation in fetchCache||(fetchCache[animation]=fetchJson(animations[animation].url)),animationCache[animation]=await fetchCache[animation]),animationCache[animation]}},"../../frontend/src/lib/components/Animation/Animation.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{f:()=>Animation_Animation_Animation});var injectStylesIntoStyleTag=__webpack_require__("../../node_modules/.pnpm/style-loader@2.0.0_webpack@5.88.2/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),Animation=__webpack_require__("../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!../../node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.5.6_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!../../node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!../../frontend/src/lib/components/Animation/Animation.scss"),Animation_default=__webpack_require__.n(Animation),options={};options.insert="head",options.singleton=!1,injectStylesIntoStyleTag_default()(Animation_default(),options),Animation_default().locals;var lottie_react_esm=__webpack_require__("../../node_modules/.pnpm/@lottiefiles+react-lottie-player@3.4.7_react@18.2.0/node_modules/@lottiefiles/react-lottie-player/dist/lottie-react.esm.js"),clsx_m=__webpack_require__("../../node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),react=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),animations=__webpack_require__("../../frontend/src/lib/animations/animations.ts"),Spinner=__webpack_require__("../../frontend/src/lib/lemon-ui/Spinner/Spinner.tsx"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function Animation_Animation_Animation(_ref){let{className,style,delay=300,type=animations.ru.MusicHog,size="large"}=_ref,[visible,setVisible]=(0,react.useState)(0===delay),[source,setSource]=(0,react.useState)(null),[showFallbackSpinner,setShowFallbackSpinner]=(0,react.useState)(!1),{width,height}=animations.sF[type];return(0,react.useEffect)(()=>{if(delay){let timeout=window.setTimeout(()=>setVisible(!0),delay);return()=>window.clearTimeout(timeout)}},[delay]),(0,react.useEffect)(()=>{let unmounted=!1;return async function loadAnimation(){try{let source=await (0,animations.BG)(type);unmounted||setSource(source)}catch{unmounted||setShowFallbackSpinner(!0)}}(),()=>{unmounted=!0}},[type]),(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.default)("Animation",{"Animation--hidden":!(visible&&(source||showFallbackSpinner))},`Animation--${size}`,className),style:{aspectRatio:`${width} / ${height}`,...style},children:source?(0,jsx_runtime.jsx)(lottie_react_esm.J5,{className:"Animation__player",autoplay:!(0,utils.es)(),loop:!0,src:source}):showFallbackSpinner?(0,jsx_runtime.jsx)(Spinner.$,{}):null})}},"../../frontend/src/lib/components/Scenes/InsightOrDashboard/SceneExportDropdownMenu.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{k:()=>SceneExportDropdownMenu});var _posthog_icons__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.35.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/src/lib/ui/Button/ButtonPrimitives.tsx"),lib_ui_DropdownMenu_DropdownMenu__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/ui/DropdownMenu/DropdownMenu.tsx"),_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/types.ts"),_ExportButton_exportsLogic__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/components/ExportButton/exportsLogic.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function SceneExportDropdownMenu(_ref){let{dropdownMenuItems}=_ref,{actions}=_ExportButton_exportsLogic__WEBPACK_IMPORTED_MODULE_4__.exportsLogic,onExportClick=async triggerExportProps=>{actions.startExport(triggerExportProps)};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(lib_ui_DropdownMenu_DropdownMenu__WEBPACK_IMPORTED_MODULE_2__.h_,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(lib_ui_DropdownMenu_DropdownMenu__WEBPACK_IMPORTED_MODULE_2__.$F,{asChild:!0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_1__.hL,{menuItem:!0,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_0__.IconDownload,{}),"Export",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(lib_ui_DropdownMenu_DropdownMenu__WEBPACK_IMPORTED_MODULE_2__.Ac,{className:"ml-auto"})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(lib_ui_DropdownMenu_DropdownMenu__WEBPACK_IMPORTED_MODULE_2__.AW,{align:"start",matchTriggerWidth:!0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(lib_ui_DropdownMenu_DropdownMenu__WEBPACK_IMPORTED_MODULE_2__.Qk,{children:dropdownMenuItems.map((item,index)=>{let target;let exportFormatExtension=Object.keys(_types__WEBPACK_IMPORTED_MODULE_3__.P5).find(key=>_types__WEBPACK_IMPORTED_MODULE_3__.P5[key]===item.format)?.toLowerCase(),exportBody="";return item.insight?target=`insight-${item.insight}`:item.dashboard?target=`dashboard-${item.dashboard}`:"path"in(item.context||{})?(target=item.context?.path||"unknown",exportBody=item.context?.body||"unknown"):target="unknown",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(lib_ui_DropdownMenu_DropdownMenu__WEBPACK_IMPORTED_MODULE_2__.Xi,{onClick:()=>void onExportClick({export_format:item.format,...item.insight&&{insight:item.insight},...item.dashboard&&{dashboard:item.dashboard},...item.context&&{export_context:item.context}}),"data-attr":`export-button-${exportFormatExtension}`,"data-ph-capture-attribute-export-target":target,"data-ph-capture-attribute-export-body":exportBody.length?JSON.stringify(exportBody):null,asChild:!0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_1__.hL,{menuItem:!0,children:item.label?item.label:`.${exportFormatExtension}`})},index)})})})]})}},"../../frontend/src/lib/components/Scenes/ScenePin.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{K:()=>ScenePin});var _posthog_icons__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.35.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/src/lib/ui/Button/ButtonPrimitives.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function ScenePin(_ref){let{dataAttrKey,onClick,isPinned}=_ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_1__.hL,{menuItem:!0,onClick:onClick,"data-attr":`${dataAttrKey}-pin-button`,tooltip:isPinned?"Unpin":"Pin",children:[isPinned?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_0__.IconPinFilled,{className:"text-warning"}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_0__.IconPin,{}),"Pin"]})}},"../../frontend/src/lib/components/Scenes/SceneSubscribeButton.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{F:()=>SceneSubscribeButton});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_router__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),_posthog_icons__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.35.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/ui/Button/ButtonPrimitives.tsx"),_Subscriptions_utils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/components/Subscriptions/utils.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function SceneSubscribeButton(_ref){let{dataAttrKey,insight,dashboardId}=_ref,{push}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(kea_router__WEBPACK_IMPORTED_MODULE_1__.router);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_3__.hL,{menuItem:!0,onClick:()=>push((0,_Subscriptions_utils__WEBPACK_IMPORTED_MODULE_4__.h$)({insightShortId:insight?.short_id,dashboardId})),"data-attr":`${dataAttrKey}-subscribe-dropdown-menu-item`,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_2__.IconBell,{}),"Subscribe"]})}},"../../frontend/src/lib/components/Scenes/SceneTags.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{y:()=>SceneTags});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),lib_lemon_ui_LemonInputSelect_LemonInputSelect__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonInputSelect/LemonInputSelect.tsx"),lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/ui/Button/ButtonPrimitives.tsx"),_layout_scenes_SceneLayout__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/layout/scenes/SceneLayout.tsx"),_types__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/types.ts"),_ObjectTags_ObjectTags__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/lib/components/ObjectTags/ObjectTags.tsx"),_UpgradeModal_upgradeModalLogic__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/lib/components/UpgradeModal/upgradeModalLogic.ts"),_utils__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../frontend/src/lib/components/Scenes/utils.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let SceneTags=_ref=>{let{onSave,tags,tagsAvailable,dataAttrKey,canEdit=!0}=_ref,[localTags,setLocalTags]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(tags),[localIsEditing,setLocalIsEditing]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),[hasChanged,setHasChanged]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),{guardAvailableFeature}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(_UpgradeModal_upgradeModalLogic__WEBPACK_IMPORTED_MODULE_7__.J),onGuardClick=callback=>{guardAvailableFeature(_types__WEBPACK_IMPORTED_MODULE_5__.P$.TAGGING,()=>{callback()})};return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{setHasChanged(localTags!==tags)},[localTags,tags]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{setLocalTags(tags)},[tags]),localIsEditing?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("form",{onSubmit:e=>{e.preventDefault(),onSave?.(null!=localTags?localTags:[]),setHasChanged(!1),setLocalIsEditing(!1)},name:"page-tags",className:"flex flex-col gap-1",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_layout_scenes_SceneLayout__WEBPACK_IMPORTED_MODULE_4__.ZV,{htmlFor:"new-tag-input",title:"Tags",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(lib_lemon_ui_LemonInputSelect_LemonInputSelect__WEBPACK_IMPORTED_MODULE_2__.n,{mode:"multiple",allowCustomValues:!0,value:localTags,options:tagsAvailable?.map(t=>({key:t,label:t})),onChange:setLocalTags,loading:!1,"data-attr":`${dataAttrKey}-new-tag-input`,placeholder:'try "official"',size:"xsmall",autoFocus:!0})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_utils__WEBPACK_IMPORTED_MODULE_8__.B,{name:"tags",onCancel:()=>{setLocalTags(tags),setLocalIsEditing(!1)},hasChanged:hasChanged,dataAttrKey:dataAttrKey})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_layout_scenes_SceneLayout__WEBPACK_IMPORTED_MODULE_4__.ZV,{title:"Tags",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(lib_ui_Button_ButtonPrimitives__WEBPACK_IMPORTED_MODULE_3__.hL,{className:"hyphens-auto flex gap-1 items-center",lang:"en",onClick:()=>onSave&&canEdit&&onGuardClick(()=>setLocalIsEditing(!0)),tooltip:canEdit?"Edit tags":"Tags are read-only",autoHeight:!0,menuItem:!0,inert:!canEdit,"data-attr":`${dataAttrKey}-tags-button`,variant:"panel",children:tags&&tags.length>0?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_ObjectTags_ObjectTags__WEBPACK_IMPORTED_MODULE_6__.D,{tags:tags,"data-attr":`${dataAttrKey}-tags`,staticOnly:!0}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.Fragment,{children:onSave&&canEdit?"Click to add tags":(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("span",{className:"text-tertiary font-normal",children:"No tags"})})})})}},"../../frontend/src/lib/components/Scenes/SceneUpdateActivityInfo.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{T:()=>SceneActivityIndicator});var lib_lemon_ui_ProfilePicture__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../frontend/src/lib/lemon-ui/ProfilePicture/index.ts"),_layout_scenes_SceneLayout__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/src/layout/scenes/SceneLayout.tsx"),_TZLabel__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/components/TZLabel/index.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function SceneActivityIndicator(_ref){let{at,by,prefix="Last modified"}=_ref;return at||by?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_layout_scenes_SceneLayout__WEBPACK_IMPORTED_MODULE_1__.ZV,{title:prefix,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("span",{className:"flex items-center gap-1 whitespace-normal flex-wrap",children:[at&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_TZLabel__WEBPACK_IMPORTED_MODULE_2__.w,{time:at,className:"w-fit"}),by&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("span",{className:"text-secondary",children:"by"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(lib_lemon_ui_ProfilePicture__WEBPACK_IMPORTED_MODULE_0__.Y,{user:by,showName:!0,size:"md"})]})]})}):null}},"../../frontend/src/scenes/dashboard/DashboardHeader.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{o:()=>DASHBOARD_CANNOT_EDIT_MESSAGE,x:()=>DashboardHeader});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),react=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.35.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),AccessControlAction=__webpack_require__("../../frontend/src/lib/components/AccessControlAction.tsx"),kea_forms_lib=__webpack_require__("../../node_modules/.pnpm/kea-forms@3.2.0_kea@3.1.7_react@18.2.0_/node_modules/kea-forms/lib/index.js"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),dashboardsModel=__webpack_require__("../../frontend/src/models/dashboardsModel.tsx");let getTileBody=(dashboard,textTileId)=>{let dashboardTiles=dashboard.tiles,matchedTile=dashboardTiles?.find(tt=>tt.id===textTileId);return matchedTile?.text?.body||""},textCardModalLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","dashboard","dashboardTextTileModal","logic"]),(0,index_esm.props)({}),(0,index_esm.key)(props=>`textCardModalLogic-${props.dashboard.id}-${props.textTileId}`),(0,index_esm.connect)(()=>({actions:[dashboardsModel.h,["updateDashboard"]]})),(0,index_esm.listeners)(_ref=>{let{props,actions}=_ref;return{submitTextTileFailure:error=>{props.dashboard&&props.textTileId&&src.UJ.error(`Could not save text: ${error.error} (${JSON.stringify(error.errors)})`),actions.resetTextTile(),props?.onClose?.()},submitTextTileSuccess:()=>{actions.resetTextTile(),props?.onClose?.()}}}),(0,kea_forms_lib.forms)(_ref2=>{let{props,actions}=_ref2;return{textTile:{defaults:{body:props.textTileId&&"new"!==props.textTileId?getTileBody(props.dashboard,props.textTileId):""},errors:_ref3=>{let{body}=_ref3;return{body:body?null:"This card would be empty! Type something first"}},submit:formValues=>{let textTiles=(props.dashboard.tiles||[]).map(t=>({id:t.id,text:t.text}));if("new"===props.textTileId)actions.updateDashboard({id:props.dashboard.id,tiles:[{text:formValues}]});else{let updatedTiles=[...textTiles].reduce((acc,tile)=>(tile.id===props.textTileId&&tile.text&&(tile.text.body=formValues.body,acc.push(tile)),acc),[]);actions.updateDashboard({id:props.dashboard.id,tiles:updatedTiles})}}}}})]);var LemonButton=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/index.ts"),LemonModal=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonModal/index.ts"),LemonTextArea=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTextArea/index.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function TextCardModal(_ref){let{isOpen,onClose,dashboard,textTileId}=_ref,modalLogic=textCardModalLogic({dashboard,textTileId:null!=textTileId?textTileId:"new",onClose}),{isTextTileSubmitting,textTileValidationErrors}=(0,index_esm.useValues)(modalLogic),{submitTextTile,resetTextTile}=(0,index_esm.useActions)(modalLogic),handleClose=()=>{resetTextTile(),onClose()};return(0,jsx_runtime.jsx)(LemonModal.f,{closable:!0,isOpen:isOpen,title:"",onClose:handleClose,footer:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(LemonButton.J,{disabledReason:isTextTileSubmitting?"Cannot cancel card creation in progress":null,type:"secondary",onClick:handleClose,children:"Cancel"}),(0,jsx_runtime.jsx)(LemonButton.J,{disabledReason:textTileValidationErrors.body,loading:isTextTileSubmitting,form:"text-tile-form",htmlType:"submit",type:"primary",onClick:submitTextTile,"data-attr":"new"===textTileId?"save-new-text-tile":"edit-text-tile-text",children:"Save"})]}),children:(0,jsx_runtime.jsx)(kea_forms_lib.Form,{logic:textCardModalLogic,props:{dashboard,textTileId},formKey:"textTile",id:"text-tile-form",className:"",enableFormOnSubmit:!0,children:(0,jsx_runtime.jsx)(kea_forms_lib.Field,{name:"body",label:"",children:(0,jsx_runtime.jsx)(LemonTextArea.X,{maxLength:4e3,"data-attr":"text-card-edit-area"})})})})}var useOnMountEffect=__webpack_require__("../../frontend/src/lib/hooks/useOnMountEffect.ts");function FullScreen(_ref){let{onExit}=_ref,selector=".layout-top-content";return(0,useOnMountEffect.x)(()=>{let myClasses=window.document.querySelectorAll(selector);for(let i=0;i<myClasses.length;i++)myClasses[i].style.display="none";let handler=()=>{null===window.document.fullscreenElement&&onExit?.()};try{document.body.requestFullscreen().then(()=>{window.addEventListener("fullscreenchange",handler,!1)})}catch{}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch{}return()=>{let elements=window.document.querySelectorAll(selector);for(let i=0;i<elements.length;i++)elements[i].style.display="block";try{window.removeEventListener("fullscreenchange",handler,!1),null!==document.fullscreenElement&&document.exitFullscreen()}catch{}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch{}}}),null}var SceneExportDropdownMenu=__webpack_require__("../../frontend/src/lib/components/Scenes/InsightOrDashboard/SceneExportDropdownMenu.tsx"),SceneDuplicate=__webpack_require__("../../frontend/src/lib/components/Scenes/SceneDuplicate.tsx"),SceneFile=__webpack_require__("../../frontend/src/lib/components/Scenes/SceneFile.tsx"),ButtonPrimitives=__webpack_require__("../../frontend/src/lib/ui/Button/ButtonPrimitives.tsx");function SceneFullscreen(_ref){let{dataAttrKey,onClick,isFullscreen}=_ref;return(0,jsx_runtime.jsxs)(ButtonPrimitives.hL,{menuItem:!0,onClick:onClick,"data-attr":`${dataAttrKey}-fullscreen-button`,tooltip:isFullscreen?"Exit fullscreen":"Fullscreen",active:isFullscreen,children:[isFullscreen?(0,jsx_runtime.jsx)(posthog_icons_es.IconExpand45,{className:"text-warning"}):(0,jsx_runtime.jsx)(posthog_icons_es.IconExpand45,{}),"Fullscreen"]})}var SceneMetalyticsSummaryButton=__webpack_require__("../../frontend/src/lib/components/Scenes/SceneMetalyticsSummaryButton.tsx"),ScenePin=__webpack_require__("../../frontend/src/lib/components/Scenes/ScenePin.tsx"),SceneSubscribeButton=__webpack_require__("../../frontend/src/lib/components/Scenes/SceneSubscribeButton.tsx"),SceneTags=__webpack_require__("../../frontend/src/lib/components/Scenes/SceneTags.tsx"),SceneUpdateActivityInfo=__webpack_require__("../../frontend/src/lib/components/Scenes/SceneUpdateActivityInfo.tsx"),SharingModal=__webpack_require__("../../frontend/src/lib/components/Sharing/SharingModal.tsx"),SubscriptionsModal=__webpack_require__("../../frontend/src/lib/components/Subscriptions/SubscriptionsModal.tsx"),useFeatureFlag=__webpack_require__("../../frontend/src/lib/hooks/useFeatureFlag.ts"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),eventUsageLogic=__webpack_require__("../../frontend/src/lib/utils/eventUsageLogic.ts"),DeleteDashboardModal=__webpack_require__("../../frontend/src/scenes/dashboard/DeleteDashboardModal.tsx"),DuplicateDashboardModal=__webpack_require__("../../frontend/src/scenes/dashboard/DuplicateDashboardModal.tsx"),deleteDashboardLogic=__webpack_require__("../../frontend/src/scenes/dashboard/deleteDashboardLogic.ts"),duplicateDashboardLogic=__webpack_require__("../../frontend/src/scenes/dashboard/duplicateDashboardLogic.ts"),MaxTool=__webpack_require__("../../frontend/src/scenes/max/MaxTool.tsx"),sceneLogic=__webpack_require__("../../frontend/src/scenes/sceneLogic.tsx"),sceneTypes=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),scenes=__webpack_require__("../../frontend/src/scenes/scenes.ts"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),userLogic=__webpack_require__("../../frontend/src/scenes/userLogic.ts"),KeyboardShortcut=__webpack_require__("../../frontend/src/layout/navigation-3000/components/KeyboardShortcut.tsx"),SceneLayout=__webpack_require__("../../frontend/src/layout/scenes/SceneLayout.tsx"),SceneTitleSection=__webpack_require__("../../frontend/src/layout/scenes/components/SceneTitleSection.tsx"),sceneLayoutLogic=__webpack_require__("../../frontend/src/layout/scenes/sceneLayoutLogic.tsx"),notebooksModel=__webpack_require__("../../frontend/src/models/notebooksModel.ts"),tagsModel=__webpack_require__("../../frontend/src/models/tagsModel.ts"),types=__webpack_require__("../../frontend/src/types.ts"),animations=__webpack_require__("../../frontend/src/lib/animations/animations.ts"),Animation=__webpack_require__("../../frontend/src/lib/components/Animation/Animation.tsx"),stringWithWBR=__webpack_require__("../../frontend/src/lib/utils/stringWithWBR.tsx"),insights_utils=__webpack_require__("../../frontend/src/scenes/insights/utils.tsx"),dataColorThemesLogic=__webpack_require__("../../frontend/src/scenes/settings/environment/dataColorThemesLogic.ts"),cohortsModel=__webpack_require__("../../frontend/src/models/cohortsModel.ts"),propertyDefinitionsModel=__webpack_require__("../../frontend/src/models/propertyDefinitionsModel.ts"),queries_utils=__webpack_require__("../../frontend/src/queries/utils.ts"),dashboardLogic=__webpack_require__("../../frontend/src/scenes/dashboard/dashboardLogic.tsx");function extractBreakdownValues(insightTiles,cohorts){return null==insightTiles?[]:insightTiles.flatMap(tile=>{if((0,queries_utils.KN)(tile.insight?.query)){let querySource=tile.insight?.query.source;if((0,queries_utils.Wl)(querySource)&&(querySource.funnelsFilter?.funnelVizType===void 0||querySource.funnelsFilter?.funnelVizType===types.Ui.Steps)){let breakdownType=querySource.breakdownFilter?.breakdown_type||"event",breakdownValues=[{breakdownValue:"Baseline",breakdownType}];return tile.insight?.result?.forEach(result=>{let breakdownValue=JSON.parse(insights_utils.dI(result)).breakdown_value;breakdownValues.push({breakdownValue:Array.isArray(breakdownValue)?breakdownValue.join("::"):breakdownValue,breakdownType})}),breakdownValues}if((0,queries_utils.kX)(querySource)){let breakdownType=querySource.breakdownFilter?.breakdown_type||"event";return tile.insight?.result?.map(result=>{let breakdownValue=JSON.parse(insights_utils.X_(result)).breakdown_value;return{breakdownValue:Array.isArray(breakdownValue)?breakdownValue.join("::"):breakdownValue,breakdownType}})}}return[]}).filter(value=>null!=value).reduce((acc,curr)=>(acc.some(x=>x.breakdownValue===curr.breakdownValue&&x.breakdownType===curr.breakdownType)||acc.push(curr),acc),[]).sort((a,b)=>"cohort"===a.breakdownType&&"cohort"===b.breakdownType?(0,insights_utils.gU)(a.breakdownValue,b.breakdownValue,cohorts):"cohort"===a.breakdownType||"cohort"===b.breakdownType?"cohort"===a.breakdownType?1:-1:String(a.breakdownValue).localeCompare(String(b.breakdownValue)))}let dashboardInsightColorsModalLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","dashboard","dashboardInsightColorsModalLogic"]),(0,index_esm.connect)(()=>({values:[cohortsModel.Qo,["allCohorts"]]})),(0,index_esm.actions)({showInsightColorsModal:id=>({id}),hideInsightColorsModal:!0}),(0,index_esm.reducers)({dashboardId:[null,{showInsightColorsModal:(_,_ref)=>{let{id}=_ref;return id},hideInsightColorsModal:()=>null}]}),(0,index_esm.selectors)({isOpen:[s=>[s.dashboardId],dashboardId=>null!=dashboardId],insightTiles:[s=>[state=>dashboardLogic.BM.findMounted({id:s.dashboardId(state)})?.values.insightTiles||null],insightTiles=>insightTiles],insightTilesLoading:[s=>[state=>dashboardLogic.BM.findMounted({id:s.dashboardId(state)})?.values.itemsLoading||null],itemsLoading=>itemsLoading,{resultEqualityCheck:()=>!1,equalityCheck:()=>!1}],breakdownValues:[s=>[s.insightTiles,s.allCohorts],(insightTiles,allCohorts)=>extractBreakdownValues(insightTiles,allCohorts?.results)]})]);function DashboardInsightColorsModal(){let{isOpen,insightTilesLoading,breakdownValues}=(0,index_esm.useValues)(dashboardInsightColorsModalLogic),{hideInsightColorsModal}=(0,index_esm.useActions)(dashboardInsightColorsModalLogic),{themes:_themes,themesLoading}=(0,index_esm.useValues)(dataColorThemesLogic.A),{temporaryBreakdownColors:dashboardBreakdownColors,dataColorThemeId,dashboardMode}=(0,index_esm.useValues)(dashboardLogic.BM),{setBreakdownColorConfig,setDataColorThemeId,setDashboardMode}=(0,index_esm.useActions)(dashboardLogic.BM),{formatPropertyValueForDisplay}=(0,index_esm.useValues)(propertyDefinitionsModel.IP),{allCohorts}=(0,index_esm.useValues)(cohortsModel.Qo),columns=[{title:"Breakdown",key:"breakdown_value",render:(_,_ref)=>{let{breakdownValue,...config}=_ref,breakdownFilter={breakdown_type:config.breakdownType},breakdownLabel=(0,insights_utils.Cq)(breakdownValue,breakdownFilter,allCohorts?.results,formatPropertyValueForDisplay),formattedLabel=(0,stringWithWBR.Z)(breakdownLabel,20);return(0,jsx_runtime.jsx)("span",{children:formattedLabel})}},{title:"Color",key:"color",width:400,render:(_,_ref2)=>{let{colorToken,...config}=_ref2;return(0,jsx_runtime.jsx)(src.zn,{selectedColorToken:colorToken,onSelectColorToken:colorToken=>{dashboardMode!==types.MN.Edit&&setDashboardMode(types.MN.Edit,null),setBreakdownColorConfig({...config,colorToken})},customButton:null===colorToken?(0,jsx_runtime.jsx)(src.Jp,{type:"tertiary",children:"Customize color"}):void 0,themeId:dataColorThemeId})}}];return(0,jsx_runtime.jsxs)(src.fQ,{title:"Customize Breakdown Colors",isOpen:isOpen,onClose:hideInsightColorsModal,children:[(0,jsx_runtime.jsx)(src.HQ,{info:"Select a color theme for all insights on this dashboard. If a theme is selected, it will be applied to all series and breakdowns.",children:"Color theme"}),(0,jsx_runtime.jsx)(src.Yv,{className:"mt-2",value:dataColorThemeId||null,placeholder:"Defined by insight",onChange:id=>{dashboardMode!==types.MN.Edit&&setDashboardMode(types.MN.Edit,null),setDataColorThemeId(id)},loading:themesLoading,options:(_themes||[]).map(theme=>({value:theme.id,label:theme.name}))}),(0,jsx_runtime.jsx)(src.HQ,{className:"mt-4",children:"Breakdown colors"}),(0,jsx_runtime.jsxs)("p",{className:"text-muted-alt mb-4",children:["Assign custom colors to breakdown values that will be used consistently across all insights on this dashboard. ",(0,jsx_runtime.jsx)("i",{children:"Note: This feature currently only works for trend and step-based funnel insights."})]}),insightTilesLoading?(0,jsx_runtime.jsxs)("div",{className:"flex flex-col items-center",children:[(0,jsx_runtime.jsx)(Animation.f,{type:animations.ru.SportsHog,size:"large",className:"-ml-4"}),(0,jsx_runtime.jsx)("p",{className:"text-primary",children:"Waiting for dashboard tiles to load and refreshâ€¦"})]}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(src.g3,{columns:columns,dataSource:breakdownValues.map(breakdownValue=>({...breakdownValue,colorToken:dashboardBreakdownColors.find(c=>c.breakdownValue===breakdownValue.breakdownValue&&c.breakdownType===breakdownValue.breakdownType)?.colorToken||null})),loading:insightTilesLoading||void 0})})]})}var DashboardTemplateEditor=__webpack_require__("../../frontend/src/scenes/dashboard/DashboardTemplateEditor.tsx"),addInsightToDashboardModalLogic=__webpack_require__("../../frontend/src/scenes/dashboard/addInsightToDashboardModalLogic.ts"),dashboardTemplateEditorLogic=__webpack_require__("../../frontend/src/scenes/dashboard/dashboardTemplateEditorLogic.ts");let RESOURCE_TYPE="dashboard",DASHBOARD_CANNOT_EDIT_MESSAGE="You don't have edit permissions for this dashboard. Ask a dashboard collaborator with edit access to add you.";function DashboardHeader(){let{dashboard,dashboardLoading,dashboardMode,canEditDashboard,showSubscriptions,subscriptionId,apiUrl,showTextTileModal,textTileId}=(0,index_esm.useValues)(dashboardLogic.BM),{setDashboardMode,triggerDashboardUpdate,loadDashboard}=(0,index_esm.useActions)(dashboardLogic.BM),{asDashboardTemplate,effectiveEditBarFilters,effectiveDashboardVariableOverrides,tiles}=(0,index_esm.useValues)(dashboardLogic.BM),{updateDashboard,pinDashboard,unpinDashboard}=(0,index_esm.useActions)(dashboardsModel.h),{createNotebookFromDashboard}=(0,index_esm.useActions)(notebooksModel.L),{showAddInsightToDashboardModal}=(0,index_esm.useActions)(addInsightToDashboardModalLogic.P),{setDashboardTemplate,openDashboardTemplateEditor}=(0,index_esm.useActions)(dashboardTemplateEditorLogic.X),{showInsightColorsModal}=(0,index_esm.useActions)(dashboardInsightColorsModalLogic),{newTab}=(0,index_esm.useActions)(sceneLogic.k),{setScenePanelOpen}=(0,index_esm.useActions)(sceneLayoutLogic.U),{user}=(0,index_esm.useValues)(userLogic.userLogic),{showDuplicateDashboardModal}=(0,index_esm.useActions)(duplicateDashboardLogic.T),{showDeleteDashboardModal}=(0,index_esm.useActions)(deleteDashboardLogic.r),{tags}=(0,index_esm.useValues)(tagsModel.x),{push}=(0,index_esm.useActions)(lib.router),[isPinned,setIsPinned]=(0,react.useState)(dashboard?.pinned),isNewDashboard=(0,react.useMemo)(()=>{if(!dashboard||dashboardLoading)return!1;let now=new Date,createdAt=new Date(dashboard.created_at),isRecentlyCreated=now.getTime()-createdAt.getTime()<3e4;return!!dashboard._highlight||"New Dashboard"===dashboard.name||isRecentlyCreated||!dashboard.tiles||0===dashboard.tiles.length},[dashboard,dashboardLoading]),hasDashboardColors=(0,useFeatureFlag.y)("DASHBOARD_COLORS"),exportOptions=[{export_format:types.P5.PNG,dashboard:dashboard?.id,export_context:{path:apiUrl()}}];return user?.is_staff&&exportOptions.push({export_format:types.P5.JSON,export_context:{localData:JSON.stringify(asDashboardTemplate),filename:`dashboard-${(0,utils.lV)(dashboard?.name||"nameless dashboard")}.json`,mediaType:types.P5.JSON}}),(0,react.useEffect)(()=>{setIsPinned(dashboard?.pinned)},[dashboard?.pinned]),dashboard||dashboardLoading?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[dashboardMode===types.MN.Fullscreen&&(0,jsx_runtime.jsx)(FullScreen,{onExit:()=>setDashboardMode(null,eventUsageLogic.GU.Browser)}),dashboard&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(SubscriptionsModal.r,{isOpen:showSubscriptions,closeModal:()=>push(urls.j.dashboard(dashboard.id)),dashboardId:dashboard.id,subscriptionId:subscriptionId}),(0,jsx_runtime.jsx)(SharingModal.PA,{title:"Dashboard permissions & sharing",isOpen:dashboardMode===types.MN.Sharing,closeModal:()=>push(urls.j.dashboard(dashboard.id)),dashboardId:dashboard.id,userAccessLevel:dashboard.user_access_level}),canEditDashboard&&(0,jsx_runtime.jsx)(TextCardModal,{isOpen:showTextTileModal,onClose:()=>push(urls.j.dashboard(dashboard.id)),dashboard:dashboard,textTileId:textTileId}),canEditDashboard&&(0,jsx_runtime.jsx)(DeleteDashboardModal.y,{}),canEditDashboard&&(0,jsx_runtime.jsx)(DuplicateDashboardModal.i,{}),canEditDashboard&&(0,jsx_runtime.jsx)(DashboardInsightColorsModal,{}),user?.is_staff&&(0,jsx_runtime.jsx)(DashboardTemplateEditor.v,{})]}),(0,jsx_runtime.jsxs)(SceneLayout.kI,{children:[(0,jsx_runtime.jsxs)(SceneLayout.Ol,{children:[(0,jsx_runtime.jsx)(SceneTags.y,{onSave:tags=>{triggerDashboardUpdate({tags})},canEdit:canEditDashboard,tags:dashboard?.tags,tagsAvailable:tags.filter(tag=>!dashboard?.tags?.includes(tag)),dataAttrKey:RESOURCE_TYPE}),(0,jsx_runtime.jsx)(SceneFile.z,{dataAttrKey:RESOURCE_TYPE}),(0,jsx_runtime.jsx)(SceneUpdateActivityInfo.T,{at:dashboard?.created_at,by:dashboard?.created_by,prefix:"Created"})]}),(0,jsx_runtime.jsx)(SceneLayout.bI,{}),(0,jsx_runtime.jsxs)(SceneLayout.EJ,{children:[dashboard&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(SceneDuplicate._,{dataAttrKey:RESOURCE_TYPE,onClick:()=>showDuplicateDashboardModal(dashboard.id,dashboard.name)}),(0,jsx_runtime.jsx)(ScenePin.K,{dataAttrKey:RESOURCE_TYPE,onClick:()=>{isPinned?(unpinDashboard(dashboard.id,eventUsageLogic.GU.SceneCommonButtons),setIsPinned(!1)):(pinDashboard(dashboard.id,eventUsageLogic.GU.SceneCommonButtons),setIsPinned(!0))},isPinned:null!=isPinned&&isPinned}),(0,jsx_runtime.jsx)(SceneFullscreen,{dataAttrKey:RESOURCE_TYPE,onClick:()=>{dashboardMode===types.MN.Fullscreen?setDashboardMode(null,eventUsageLogic.GU.SceneCommonButtons):setDashboardMode(types.MN.Fullscreen,eventUsageLogic.GU.SceneCommonButtons)},isFullscreen:dashboardMode===types.MN.Fullscreen})]}),dashboard&&canEditDashboard&&hasDashboardColors&&(0,jsx_runtime.jsxs)(ButtonPrimitives.hL,{onClick:()=>showInsightColorsModal(dashboard.id),menuItem:!0,"data-attr":`${RESOURCE_TYPE}-customize-colors`,children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconPalette,{}),"Customize colors"]}),dashboard&&canEditDashboard&&(0,jsx_runtime.jsxs)(ButtonPrimitives.hL,{onClick:()=>setDashboardMode(types.MN.Edit,eventUsageLogic.GU.SceneCommonButtons),menuItem:!0,active:dashboardMode===types.MN.Edit,"data-attr":`${RESOURCE_TYPE}-edit-layout`,children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconGridMasonry,{}),"Edit layout ",(0,jsx_runtime.jsx)(KeyboardShortcut.e,{e:!0})]}),dashboard&&canEditDashboard&&(0,jsx_runtime.jsxs)(ButtonPrimitives.hL,{onClick:()=>createNotebookFromDashboard(dashboard),menuItem:!0,"data-attr":`${RESOURCE_TYPE}-create-notebook-from-dashboard`,children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconNotebook,{}),"Create notebook from dashboard"]}),dashboard&&canEditDashboard&&(0,jsx_runtime.jsx)(SceneSubscribeButton.F,{dashboardId:dashboard.id,dataAttrKey:RESOURCE_TYPE}),dashboard&&canEditDashboard&&(0,jsx_runtime.jsx)(SceneExportDropdownMenu.k,{dropdownMenuItems:[{format:types.P5.PNG,dashboard:dashboard.id,context:{path:apiUrl()},dataAttr:`${RESOURCE_TYPE}-export-png`},...user?.is_staff?[{format:types.P5.JSON,context:{localData:JSON.stringify(asDashboardTemplate),filename:`dashboard-${(0,utils.lV)(dashboard?.name||"nameless dashboard")}.json`,mediaType:types.P5.JSON},dataAttr:`${RESOURCE_TYPE}-export-json`}]:[]]}),user?.is_staff&&(0,jsx_runtime.jsxs)(ButtonPrimitives.hL,{onClick:()=>{asDashboardTemplate&&(setDashboardTemplate(asDashboardTemplate),openDashboardTemplateEditor())},menuItem:!0,children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconScreen,{}),"Save as template"]}),dashboard&&(0,jsx_runtime.jsx)(SceneMetalyticsSummaryButton.B,{dataAttrKey:RESOURCE_TYPE}),dashboard&&(0,jsx_runtime.jsxs)(ButtonPrimitives.hL,{onClick:()=>{tiles.forEach(tile=>{tile.insight?.short_id!=null&&newTab(urls.j.insightView(tile.insight.short_id,dashboard.id,effectiveDashboardVariableOverrides,effectiveEditBarFilters,tile?.filters_overrides))}),setScenePanelOpen(!1)},menuItem:!0,"data-attr":"open-insights-in-new-posthog-tabs",disabledReasons:{"Cannot open insights when editing dashboard":dashboardMode===types.MN.Edit,"Dashboard has no insights":0===tiles.length},children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconGraph,{}),"Open insights in new PostHog tabs"]})]}),dashboard&&canEditDashboard&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(SceneLayout.bI,{}),(0,jsx_runtime.jsx)(SceneLayout.EJ,{children:(0,jsx_runtime.jsx)(AccessControlAction.b,{resourceType:types.qR.Dashboard,minAccessLevel:types.W$.Editor,userAccessLevel:dashboard.user_access_level,children:_ref=>{let{disabledReason}=_ref;return(0,jsx_runtime.jsxs)(ButtonPrimitives.hL,{menuItem:!0,variant:"danger",disabled:!!disabledReason,...disabledReason&&{tooltip:disabledReason},onClick:()=>showDeleteDashboardModal(dashboard.id),children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconTrash,{}),"Delete dashboard"]})}})})]})]}),(0,jsx_runtime.jsx)(SceneTitleSection.s,{name:dashboard?.name,description:dashboard?.description,resourceType:{type:scenes.lc[sceneTypes.x.Dashboard].iconType||"default_icon_type"},onNameChange:value=>updateDashboard({id:dashboard?.id,name:value,allowUndo:!0}),onDescriptionChange:value=>updateDashboard({id:dashboard?.id,description:value,allowUndo:!0}),markdown:!0,canEdit:canEditDashboard,isLoading:dashboardLoading,forceEdit:dashboardMode===types.MN.Edit||isNewDashboard,renameDebounceMs:1e3,actions:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:dashboardMode===types.MN.Edit?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(LemonButton.J,{"data-attr":"dashboard-edit-mode-discard",type:"secondary",onClick:()=>setDashboardMode(null,eventUsageLogic.GU.DashboardHeaderDiscardChanges),size:"small",tabIndex:9,children:"Cancel"}),(0,jsx_runtime.jsx)(LemonButton.J,{"data-attr":"dashboard-edit-mode-save",type:"primary",onClick:()=>setDashboardMode(null,eventUsageLogic.GU.DashboardHeaderSaveDashboard),size:"small",tabIndex:10,disabledReason:dashboardLoading?"Wait for dashboard to finish loading":canEditDashboard?void 0:"Not privileged to edit this dashboard",children:"Save"})]}):dashboardMode===types.MN.Fullscreen?(0,jsx_runtime.jsx)(LemonButton.J,{type:"secondary",onClick:()=>setDashboardMode(null,eventUsageLogic.GU.DashboardHeaderExitFullscreen),"data-attr":"dashboard-exit-presentation-mode",disabled:dashboardLoading,size:"small",children:"Exit full screen"}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[dashboard&&(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(LemonButton.J,{type:"secondary","data-attr":"dashboard-share-button",onClick:()=>push(urls.j.dashboardSharing(dashboard.id)),size:"small",children:"Share"})}),dashboard?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(AccessControlAction.b,{resourceType:types.qR.Dashboard,minAccessLevel:types.W$.Editor,userAccessLevel:dashboard.user_access_level,children:(0,jsx_runtime.jsx)(LemonButton.J,{onClick:()=>{push(urls.j.dashboardTextTile(dashboard.id,"new"))},"data-attr":"add-text-tile-to-dashboard",type:"secondary",size:"small",children:"Add text card"})}),(0,jsx_runtime.jsx)(MaxTool.L,{identifier:"edit_current_dashboard",context:{current_dashboard:dashboard?{id:dashboard.id,name:dashboard.name,description:dashboard.description,tags:dashboard.tags}:void 0},active:!!dashboard&&canEditDashboard,callback:()=>loadDashboard({action:dashboardLogic.yE.Update}),position:"top-right",children:(0,jsx_runtime.jsx)(AccessControlAction.b,{resourceType:types.qR.Dashboard,minAccessLevel:types.W$.Editor,userAccessLevel:dashboard.user_access_level,children:(0,jsx_runtime.jsx)(LemonButton.J,{onClick:showAddInsightToDashboardModal,type:"primary","data-attr":"dashboard-add-graph-header",size:"small",children:"Add insight"})})})]}):null]})})})]}):null}},"../../frontend/src/scenes/dashboard/DashboardTemplateEditor.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{v:()=>DashboardTemplateEditor});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),lib_monaco_CodeEditor__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/monaco/CodeEditor.tsx"),_dashboardTemplateEditorLogic__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/scenes/dashboard/dashboardTemplateEditorLogic.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function DashboardTemplateEditor(_ref){let{inline=!1}=_ref,{closeDashboardTemplateEditor,createDashboardTemplate,updateDashboardTemplate,setEditorValue,updateValidationErrors}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(_dashboardTemplateEditorLogic__WEBPACK_IMPORTED_MODULE_3__.X),{isOpenNewDashboardTemplateModal,editorValue,validationErrors,templateSchema,id}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(_dashboardTemplateEditorLogic__WEBPACK_IMPORTED_MODULE_3__.X);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.fQ,{title:id?"Edit dashboard template":"New dashboard template",isOpen:isOpenNewDashboardTemplateModal,width:1e3,onClose:()=>{closeDashboardTemplateEditor()},inline:inline,footer:id?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{type:"primary","data-attr":"update-dashboard-template-button",onClick:()=>{updateDashboardTemplate({id})},disabledReason:validationErrors.length?`There are ${validationErrors.length} errors to resolve: ${validationErrors.map(e=>" "+e)}`:void 0,children:"Update template"}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{type:"primary","data-attr":"create-dashboard-template-button",onClick:()=>{createDashboardTemplate()},disabledReason:validationErrors.length?`There are ${validationErrors.length} errors to resolve:${validationErrors.map(e=>" "+e)}`:void 0,children:"Create new template"}),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(lib_monaco_CodeEditor__WEBPACK_IMPORTED_MODULE_2__.p,{className:"border",language:"json",value:editorValue,onChange:v=>{setEditorValue(null!=v?v:"")},onValidate:markers=>{updateValidationErrors(markers)},path:id?`dashboard-templates/${id}.json`:"dashboard-templates/new.json",schema:templateSchema,height:600})})}},"../../frontend/src/scenes/dashboard/DeleteDashboardModal.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{y:()=>DeleteDashboardModal});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_forms__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-forms@3.2.0_kea@3.1.7_react@18.2.0_/node_modules/kea-forms/lib/index.js"),lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/index.ts"),lib_lemon_ui_LemonCheckbox__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonCheckbox/index.ts"),lib_lemon_ui_LemonField__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonField/index.ts"),lib_lemon_ui_LemonModal__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonModal/index.ts"),scenes_dashboard_deleteDashboardLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/scenes/dashboard/deleteDashboardLogic.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function DeleteDashboardModal(){let{hideDeleteDashboardModal}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(scenes_dashboard_deleteDashboardLogic__WEBPACK_IMPORTED_MODULE_6__.r),{isDeleteDashboardSubmitting,deleteDashboardModalVisible}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(scenes_dashboard_deleteDashboardLogic__WEBPACK_IMPORTED_MODULE_6__.r);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(lib_lemon_ui_LemonModal__WEBPACK_IMPORTED_MODULE_5__.f,{title:"Delete dashboard",onClose:hideDeleteDashboardModal,isOpen:deleteDashboardModalVisible,footer:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_2__.J,{form:"delete-dashboard-form",type:"secondary","data-attr":"dashboard-delete",disabled:isDeleteDashboardSubmitting,onClick:hideDeleteDashboardModal,children:"Cancel"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_2__.J,{form:"delete-dashboard-form",htmlType:"submit",type:"secondary",status:"danger","data-attr":"dashboard-delete-submit",loading:isDeleteDashboardSubmitting,disabled:isDeleteDashboardSubmitting,children:"Delete dashboard"})]}),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(kea_forms__WEBPACK_IMPORTED_MODULE_1__.Form,{logic:scenes_dashboard_deleteDashboardLogic__WEBPACK_IMPORTED_MODULE_6__.r,formKey:"deleteDashboard",id:"delete-dashboard-form",enableFormOnSubmit:!0,className:"deprecated-space-y-2",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(lib_lemon_ui_LemonField__WEBPACK_IMPORTED_MODULE_4__.D,{name:"deleteInsights",help:"This will only delete insights if they're not on any other dashboards.",children:_ref=>{let{value,onChange}=_ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(lib_lemon_ui_LemonCheckbox__WEBPACK_IMPORTED_MODULE_3__.H,{"data-attr":"delete-dashboard-insights-checkbox",checked:value,label:"Delete this dashboard's insights",onChange:onChange})}})})})}},"../../frontend/src/scenes/dashboard/DuplicateDashboardModal.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{i:()=>DuplicateDashboardModal});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_forms__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-forms@3.2.0_kea@3.1.7_react@18.2.0_/node_modules/kea-forms/lib/index.js"),lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/index.ts"),lib_lemon_ui_LemonCheckbox__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonCheckbox/index.ts"),lib_lemon_ui_LemonField__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonField/index.ts"),lib_lemon_ui_LemonModal__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonModal/index.ts"),scenes_dashboard_duplicateDashboardLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/scenes/dashboard/duplicateDashboardLogic.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function DuplicateDashboardModal(){let{hideDuplicateDashboardModal,duplicateAndGoToDashboard}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(scenes_dashboard_duplicateDashboardLogic__WEBPACK_IMPORTED_MODULE_6__.T),{isDuplicateDashboardSubmitting,duplicateDashboardModalVisible}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(scenes_dashboard_duplicateDashboardLogic__WEBPACK_IMPORTED_MODULE_6__.T);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(lib_lemon_ui_LemonModal__WEBPACK_IMPORTED_MODULE_5__.f,{title:"Duplicate dashboard",onClose:hideDuplicateDashboardModal,isOpen:duplicateDashboardModalVisible,footer:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_2__.J,{form:"new-dashboard-form",type:"secondary","data-attr":"dashboard-cancel",disabled:isDuplicateDashboardSubmitting,onClick:hideDuplicateDashboardModal,children:"Cancel"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_2__.J,{form:"new-dashboard-form",type:"secondary","data-attr":"dashboard-submit-and-go",disabled:isDuplicateDashboardSubmitting,onClick:duplicateAndGoToDashboard,children:"Duplicate and go to dashboard"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_2__.J,{form:"duplicate-dashboard-form",htmlType:"submit",type:"primary","data-attr":"duplicate-dashboard-submit",loading:isDuplicateDashboardSubmitting,disabled:isDuplicateDashboardSubmitting,children:"Duplicate"})]}),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(kea_forms__WEBPACK_IMPORTED_MODULE_1__.Form,{logic:scenes_dashboard_duplicateDashboardLogic__WEBPACK_IMPORTED_MODULE_6__.T,formKey:"duplicateDashboard",id:"duplicate-dashboard-form",enableFormOnSubmit:!0,className:"deprecated-space-y-2",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(lib_lemon_ui_LemonField__WEBPACK_IMPORTED_MODULE_4__.D,{name:"duplicateTiles",help:"Choose whether to duplicate this dashboard's insights and text or attach them to the new dashboard.",children:_ref=>{let{value,onChange}=_ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(lib_lemon_ui_LemonCheckbox__WEBPACK_IMPORTED_MODULE_3__.H,{checked:value,label:"Duplicate this dashboard's tiles",onChange:onChange})}})})})}},"../../frontend/src/scenes/dashboard/addInsightToDashboardModalLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{P:()=>addInsightToDashboardLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js");let addInsightToDashboardLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","dashboard","addInsightToDashboardLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({showAddInsightToDashboardModal:!0,hideAddInsightToDashboardModal:!0}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({addInsightToDashboardModalVisible:[!1,{showAddInsightToDashboardModal:()=>!0,hideAddInsightToDashboardModal:()=>!1}]})])},"../../frontend/src/scenes/dashboard/dashboardTemplateEditorLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{X:()=>dashboardTemplateEditorLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.7_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),lib_api__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/api.ts"),lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/logic/featureFlagLogic.ts"),_dashboards_templates_dashboardTemplatesLogic__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/scenes/dashboard/dashboards/templates/dashboardTemplatesLogic.tsx");let dashboardTemplateEditorLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","dashboard","dashboardTemplateEditorLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)(()=>({logic:[_dashboards_templates_dashboardTemplatesLogic__WEBPACK_IMPORTED_MODULE_5__.R],values:[lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_4__.featureFlagLogic,["featureFlags"]]})),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setEditorValue:value=>({value}),setDashboardTemplate:dashboardTemplate=>({dashboardTemplate}),clear:!0,setDashboardTemplateId:id=>({id}),openDashboardTemplateEditor:!0,closeDashboardTemplateEditor:!0,updateValidationErrors:markers=>({markers})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({editorValue:["",{setEditorValue:(_,_ref)=>{let{value}=_ref;return value},clear:()=>""}],dashboardTemplate:[null,{clear:()=>null,setDashboardTemplate:(_,_ref2)=>{let{dashboardTemplate}=_ref2;return dashboardTemplate}}],validationErrors:[[],{updateValidationErrors:(_,_ref3)=>{let{markers}=_ref3;return markers&&0!==markers.length?markers.map(marker=>marker.message):[]},clear:()=>[]}],id:[null,{setDashboardTemplateId:(_,_ref4)=>{let{id}=_ref4;return id},clear:()=>null}],isOpenNewDashboardTemplateModal:[!1,{openDashboardTemplateEditor:()=>!0,closeDashboardTemplateEditor:()=>!1}]}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)(_ref5=>{let{values}=_ref5;return{dashboardTemplate:[void 0,{createDashboardTemplate:async()=>{if(!values.dashboardTemplate){_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.UJ.error("Unable to create dashboard template");return}let response=await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.dashboardTemplates.create(values.dashboardTemplate);return _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.UJ.success("Dashboard template created"),response},getDashboardTemplate:async id=>await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.dashboardTemplates.get(id),updateDashboardTemplate:async _ref6=>{let{id,dashboardTemplateUpdates}=_ref6,response=null;if(dashboardTemplateUpdates)response=await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.dashboardTemplates.update(id,dashboardTemplateUpdates);else if(values.dashboardTemplate)response=await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.dashboardTemplates.update(id,values.dashboardTemplate);else{_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.UJ.error("Unable to update dashboard template");return}return _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.UJ.success("Dashboard template updated"),response},deleteDashboardTemplate:async id=>(await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.dashboardTemplates.delete(id),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.UJ.success("Dashboard template deleted"),null)}],templateSchema:[null,{getTemplateSchema:async()=>await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.dashboardTemplates.getSchema()}]}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.listeners)(_ref7=>{let{values,actions}=_ref7;return{createDashboardTemplateSuccess:async()=>{actions.closeDashboardTemplateEditor(),_dashboards_templates_dashboardTemplatesLogic__WEBPACK_IMPORTED_MODULE_5__.R.actions.getAllTemplates()},updateDashboardTemplateSuccess:async()=>{actions.closeDashboardTemplateEditor(),_dashboards_templates_dashboardTemplatesLogic__WEBPACK_IMPORTED_MODULE_5__.R.actions.getAllTemplates()},deleteDashboardTemplateSuccess:async()=>{_dashboards_templates_dashboardTemplatesLogic__WEBPACK_IMPORTED_MODULE_5__.R.actions.getAllTemplates()},closeDashboardTemplateEditor:()=>{actions.clear()},setDashboardTemplateId:_ref8=>{let{id}=_ref8;id&&actions.getDashboardTemplate(id)},getDashboardTemplateSuccess:async _ref9=>{let{dashboardTemplate}=_ref9;dashboardTemplate&&actions.setEditorValue(JSON.stringify(dashboardTemplate))},setEditorValue:async(_ref10,breakpoint)=>{let{value}=_ref10;if(await breakpoint(500),0==values.validationErrors.length&&value?.length)try{let dashboardTemplate=JSON.parse(value);actions.setDashboardTemplate(dashboardTemplate)}catch(error){console.error("error",error),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.UJ.error("Unable to parse dashboard template")}},updateValidationErrors:async _ref11=>{let{markers}=_ref11;markers?.length||actions.setEditorValue(values.editorValue)},setDashboardTemplate:async _ref12=>{let{dashboardTemplate}=_ref12;dashboardTemplate&&actions.setEditorValue(JSON.stringify(dashboardTemplate,null,4))}}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.afterMount)(_ref13=>{let{actions}=_ref13;actions.getTemplateSchema()})])},"../../frontend/src/scenes/dashboard/dashboards/templates/dashboardTemplatesLogic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{R:()=>dashboardTemplatesLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.7_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),kea_router__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/api.ts"),lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/logic/featureFlagLogic.ts");let dashboardTemplatesLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","dashboard","dashboards","templates","dashboardTemplatesLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.key)(_ref=>{let{scope}=_ref;return null!=scope?scope:"unknown"}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)(()=>({values:[lib_logic_featureFlagLogic__WEBPACK_IMPORTED_MODULE_4__.featureFlagLogic,["featureFlags"]]})),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setTemplates:allTemplates=>({allTemplates}),setTemplateFilter:search=>({search})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({templateFilter:["",{setTemplateFilter:(_,_ref2)=>{let{search}=_ref2;return search}}]}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.lazyLoaders)(_ref3=>{let{props,values}=_ref3;return{allTemplates:[[],{getAllTemplates:async()=>{let params={scope:"default"!==props.scope?props.scope:void 0,search:values.templateFilter.length>2?values.templateFilter:void 0};return(await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.dashboardTemplates.list(params)).results}}]}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.listeners)(_ref4=>{let{actions}=_ref4;return{setTemplateFilter:async(_,breakpoint)=>{await breakpoint(100),actions.getAllTemplates()}}}),(0,kea_router__WEBPACK_IMPORTED_MODULE_2__.urlToAction)(_ref5=>{let{actions}=_ref5;return{"/dashboard":(_,searchParams)=>{searchParams.templateFilter&&actions.setTemplateFilter(searchParams.templateFilter)}}}),(0,kea_router__WEBPACK_IMPORTED_MODULE_2__.actionToUrl)(_ref6=>{let{values}=_ref6;return{setTemplateFilter:()=>{let searchParams={...kea_router__WEBPACK_IMPORTED_MODULE_2__.router.values.searchParams};return searchParams.templateFilter=values.templateFilter,values.templateFilter||delete searchParams.templateFilter,["/dashboard",searchParams,kea_router__WEBPACK_IMPORTED_MODULE_2__.router.values.hashParams,{replace:!0}]}}})])},"../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!../../node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.5.6_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!../../node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!../../frontend/src/lib/components/Animation/Animation.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("../../node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".Animation{align-items:center;aspect-ratio:1/1;display:inline-flex;justify-content:center;max-width:300px;opacity:1;overflow:hidden;transition:opacity .4s ease}.Animation.Animation--hidden{opacity:0}.Animation .Animation__player{display:block;height:100%;width:100%}.Animation .Animation__player svg{display:block}.Animation.Animation--large{width:100%}.Animation.Animation--small{overflow:visible}.Animation.Animation--small svg{height:45px!important;width:45px!important}",""]),module.exports=exports}}]);