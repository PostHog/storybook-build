(window.webpackJsonp=window.webpackJsonp||[]).push([[328],{"./frontend/src/scenes/session-recordings/playlist/SessionRecordingsPlaylistScene.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene})),__webpack_require__.d(__webpack_exports__,"SessionRecordingsPlaylistScene",(function(){return SessionRecordingsPlaylistScene}));var index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),src=(__webpack_require__("./frontend/src/scenes/session-recordings/playlist/SessionRecordingsPlaylist.scss"),__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts")),LemonSkeleton=__webpack_require__("./frontend/src/lib/lemon-ui/LemonSkeleton/index.tsx"),EditableField=__webpack_require__("./frontend/src/lib/components/EditableField/EditableField.tsx"),PageHeader=__webpack_require__("./frontend/src/lib/components/PageHeader.tsx"),types=__webpack_require__("./frontend/src/types.ts"),urls=__webpack_require__("./frontend/src/scenes/urls.ts"),fast_deep_equal=__webpack_require__("./node_modules/.pnpm/fast-deep-equal@3.1.3/node_modules/fast-deep-equal/index.js"),fast_deep_equal_default=__webpack_require__.n(fast_deep_equal),lib=__webpack_require__("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.5/node_modules/kea-router/lib/index.js"),cohortsModel=__webpack_require__("./frontend/src/models/cohortsModel.ts"),playlistUtils=__webpack_require__("./frontend/src/scenes/session-recordings/playlist/playlistUtils.ts"),kea_loaders_lib=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js");const sessionRecordingsPlaylistLogic=Object(index_esm.kea)([Object(index_esm.path)((key=>["scenes","session-recordings","playlist","sessionRecordingsPlaylistLogic",key])),Object(index_esm.props)({}),Object(index_esm.key)((props=>props.shortId)),Object(index_esm.connect)({values:[cohortsModel.a,["cohortsById"]]}),Object(index_esm.actions)({updatePlaylist:function(properties){let silent=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{properties:properties,silent:silent}},setFilters:filters=>({filters:filters})}),Object(kea_loaders_lib.loaders)((_ref=>{let{values:values,props:props}=_ref;return{playlist:[null,{getPlaylist:async()=>Object(playlistUtils.d)(props.shortId),updatePlaylist:async _ref2=>{var _values$playlist,_values$playlist2;let{properties:properties,silent:silent}=_ref2;return null!==(_values$playlist=values.playlist)&&void 0!==_values$playlist&&_values$playlist.short_id?Object(playlistUtils.f)(null===(_values$playlist2=values.playlist)||void 0===_values$playlist2?void 0:_values$playlist2.short_id,null!=properties?properties:{filters:values.filters||void 0},silent):values.playlist},duplicatePlaylist:async()=>{var _values$playlist3;return Object(playlistUtils.c)(null!==(_values$playlist3=values.playlist)&&void 0!==_values$playlist3?_values$playlist3:{},!0)},deletePlaylist:async()=>values.playlist?Object(playlistUtils.b)(values.playlist,(()=>{lib.router.actions.replace(urls.a.replay(types.ab.Playlists))})):null}]}})),Object(index_esm.reducers)((_ref3=>{let{}=_ref3;return{filters:[null,{getPlaylistSuccess:(_,_ref4)=>{let{playlist:playlist}=_ref4;return(null==playlist?void 0:playlist.filters)||null},updatePlaylistSuccess:(_,_ref5)=>{let{playlist:playlist}=_ref5;return(null==playlist?void 0:playlist.filters)||null},setFilters:(_,_ref6)=>{let{filters:filters}=_ref6;return filters}}]}})),Object(index_esm.listeners)((_ref7=>{let{actions:actions,values:values}=_ref7;return{getPlaylistSuccess:()=>{var _values$playlist4;(null===(_values$playlist4=values.playlist)||void 0===_values$playlist4?void 0:_values$playlist4.derived_name)!==values.derivedName&&actions.updatePlaylist({derived_name:values.derivedName},!0)}}})),Object(lib.beforeUnload)((_ref8=>{let{values:values,actions:actions}=_ref8;return{enabled:newLocation=>values.hasChanges&&(null==newLocation?void 0:newLocation.pathname)!==lib.router.values.location.pathname,message:"Leave playlist? Changes you made will be discarded.",onConfirm:()=>{var _values$playlist5;actions.setFilters((null===(_values$playlist5=values.playlist)||void 0===_values$playlist5?void 0:_values$playlist5.filters)||null)}}})),Object(index_esm.selectors)((_ref9=>{let{}=_ref9;return{breadcrumbs:[s=>[s.playlist],playlist=>[{name:"Recordings",path:urls.a.replay()},{name:"Playlists",path:urls.a.replay(types.ab.Playlists)},{name:(null==playlist?void 0:playlist.name)||(null==playlist?void 0:playlist.derived_name)||"(Untitled)",path:urls.a.replayPlaylist((null==playlist?void 0:playlist.short_id)||"")}]],hasChanges:[s=>[s.playlist,s.filters],(playlist,filters)=>!fast_deep_equal_default()(null==playlist?void 0:playlist.filters,filters)],derivedName:[s=>[s.filters,s.cohortsById],(filters,cohortsById)=>{var _summarizePlaylistFil;return(null===(_summarizePlaylistFil=Object(playlistUtils.e)(filters||{},cohortsById))||void 0===_summarizePlaylistFil?void 0:_summarizePlaylistFil.slice(0,400))||"(Untitled)"}]}})),Object(index_esm.afterMount)((_ref10=>{let{actions:actions}=_ref10;actions.getPlaylist()}))]);var NotFound=__webpack_require__("./frontend/src/lib/components/NotFound/index.tsx"),UserActivityIndicator=__webpack_require__("./frontend/src/lib/components/UserActivityIndicator/UserActivityIndicator.tsx"),More=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/More.tsx"),playlist_SessionRecordingsPlaylist=__webpack_require__("./frontend/src/scenes/session-recordings/playlist/SessionRecordingsPlaylist.tsx"),sessionRecordingsListLogic=__webpack_require__("./frontend/src/scenes/session-recordings/playlist/sessionRecordingsListLogic.ts"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");const scene={component:SessionRecordingsPlaylistScene,logic:sessionRecordingsPlaylistLogic,paramsToProps:_ref=>{let{params:{id:id}}=_ref;return{shortId:id}}};function SessionRecordingsPlaylistScene(){const{playlist:playlist,playlistLoading:playlistLoading,hasChanges:hasChanges,derivedName:derivedName}=Object(index_esm.useValues)(sessionRecordingsPlaylistLogic),{setFilters:setFilters,updatePlaylist:updatePlaylist,duplicatePlaylist:duplicatePlaylist,deletePlaylist:deletePlaylist}=Object(index_esm.useActions)(sessionRecordingsPlaylistLogic),currentListLogic=Object(sessionRecordingsListLogic.d)({playlistShortId:null==playlist?void 0:playlist.short_id,filters:null==playlist?void 0:playlist.filters,onFiltersChange:setFilters}),{showFilters:showFilters}=Object(index_esm.useValues)(currentListLogic),{setShowFilters:setShowFilters}=Object(index_esm.useActions)(currentListLogic);return!playlist&&playlistLoading?Object(jsx_runtime.jsxs)("div",{className:"space-y-4 mt-6",children:[Object(jsx_runtime.jsx)(LemonSkeleton.a,{className:"h-10 w-1/4"}),Object(jsx_runtime.jsx)(LemonSkeleton.a,{className:" w-1/3"}),Object(jsx_runtime.jsx)(LemonSkeleton.a,{className:" w-1/4"}),Object(jsx_runtime.jsxs)("div",{className:"flex justify-between mt-4",children:[Object(jsx_runtime.jsx)(LemonSkeleton.a.Button,{}),Object(jsx_runtime.jsxs)("div",{className:"flex gap-4",children:[Object(jsx_runtime.jsx)(LemonSkeleton.a.Button,{}),Object(jsx_runtime.jsx)(LemonSkeleton.a.Button,{})]})]}),Object(jsx_runtime.jsxs)("div",{className:"flex justify-between gap-4 mt-8",children:[Object(jsx_runtime.jsx)("div",{className:"space-y-8 w-1/4",children:Object(jsx_runtime.jsx)(LemonSkeleton.a,{className:"h-10",repeat:10})}),Object(jsx_runtime.jsx)("div",{className:"flex-1"})]})]}):playlist?Object(jsx_runtime.jsxs)("div",{className:"-mb-16",children:[Object(jsx_runtime.jsx)(PageHeader.a,{title:Object(jsx_runtime.jsx)(EditableField.a,{name:"name",value:playlist.name||"",placeholder:derivedName,onSave:value=>updatePlaylist({short_id:playlist.short_id,name:value}),saveOnBlur:!0,maxLength:400,mode:void 0,"data-attr":"playlist-name"}),buttons:Object(jsx_runtime.jsxs)("div",{className:"flex justify-between items-center gap-2",children:[Object(jsx_runtime.jsx)(More.a,{overlay:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.LemonButton,{status:"stealth",onClick:()=>duplicatePlaylist(),fullWidth:!0,"data-attr":"duplicate-playlist",children:"Duplicate"}),Object(jsx_runtime.jsx)(src.LemonButton,{status:"stealth",onClick:()=>updatePlaylist({short_id:playlist.short_id,pinned:!playlist.pinned}),fullWidth:!0,children:playlist.pinned?"Unpin playlist":"Pin playlist"}),Object(jsx_runtime.jsx)(src.LemonDivider,{}),Object(jsx_runtime.jsx)(src.LemonButton,{status:"danger",onClick:()=>deletePlaylist(),fullWidth:!0,children:"Delete playlist"})]})}),Object(jsx_runtime.jsx)(src.LemonDivider,{vertical:!0}),Object(jsx_runtime.jsx)(src.LemonButton,{type:"primary",disabledReason:showFilters&&!hasChanges?"No changes to save":void 0,loading:hasChanges&&playlistLoading,onClick:()=>{showFilters?updatePlaylist():setShowFilters(!showFilters)},children:showFilters?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"Save changes"}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"Edit"})})]}),caption:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(EditableField.a,{multiline:!0,name:"description",value:playlist.description||"",placeholder:"Description (optional)",onSave:value=>updatePlaylist({description:value}),saveOnBlur:!0,maxLength:400,"data-attr":"playlist-description",compactButtons:!0}),Object(jsx_runtime.jsx)(UserActivityIndicator.a,{at:playlist.last_modified_at,by:playlist.last_modified_by,className:"mt-2"})]})}),playlist.short_id?Object(jsx_runtime.jsx)(playlist_SessionRecordingsPlaylist.b,{playlistShortId:playlist.short_id,filters:playlist.filters,onFiltersChange:setFilters}):null]}):Object(jsx_runtime.jsx)(NotFound.a,{object:"Recording Playlist"})}}}]);