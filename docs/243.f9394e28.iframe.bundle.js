(window.webpackJsonp=window.webpackJsonp||[]).push([[243],{4521:function(module,exports,__webpack_require__){(exports=__webpack_require__(48)(!1)).push([module.i,".system-status-scene{margin-bottom:64px}@media(min-width:750px){.system-status-scene .metric-column{width:33%}}.embedded-svg-wrapper{cursor:text}.embedded-svg-wrapper svg{width:100%;height:100%}",""]),module.exports=exports},4741:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene})),__webpack_require__.d(__webpack_exports__,"SystemStatus",(function(){return SystemStatus_SystemStatus}));var injectStylesIntoStyleTag=__webpack_require__(20),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),SystemStatus=__webpack_require__(4521),SystemStatus_default=__webpack_require__.n(SystemStatus),options={insert:"head",singleton:!1},react=(injectStylesIntoStyleTag_default()(SystemStatus_default.a,options),SystemStatus_default.a.locals,__webpack_require__(0)),react_default=__webpack_require__.n(react),es_alert=__webpack_require__(1252),tabs=__webpack_require__(577),systemStatusLogic=__webpack_require__(579),index_esm=__webpack_require__(1),PageHeader=__webpack_require__(210),logic=__webpack_require__(66),icons=__webpack_require__(24),card=(__webpack_require__(32),__webpack_require__(4164)),table=__webpack_require__(2569),Link=__webpack_require__(56),LemonTag=(__webpack_require__(45),__webpack_require__(39),__webpack_require__(109),__webpack_require__(360),__webpack_require__(98),__webpack_require__(49),__webpack_require__(578)),utils=__webpack_require__(10),TIMESTAMP_VALUES=new Set(["last_event_ingested_timestamp"]);function RenderMetricValue(_ref){var key=_ref.key,value=_ref.value,value_type=_ref.value_type,emptyNullLabel=_ref.emptyNullLabel;return TIMESTAMP_VALUES.has(key)?new Date(value).getTime()===new Date("1970-01-01T00:00:00").getTime()?"Never":Object(utils.K)(value):"bool"===value_type||"boolean"==typeof value?react_default.a.createElement(LemonTag.a,{type:value?"success":"danger"},value?"Yes":"No"):"int"===value_type||"number"==typeof value?value.toLocaleString("en-US"):null==value||""===value?react_default.a.createElement(LemonTag.a,{style:{color:"var(--text-muted)"}},null!=emptyNullLabel?emptyNullLabel:"Unknown"):value.toString()}try{RenderMetricValue.displayName="RenderMetricValue",RenderMetricValue.__docgenInfo={description:"",displayName:"RenderMetricValue",props:{emptyNullLabel:{defaultValue:null,description:"",name:"emptyNullLabel",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}},key:{defaultValue:null,description:"",name:"key",required:!0,type:{name:"string"}},value_type:{defaultValue:null,description:"",name:"value_type",required:!1,type:{name:"enum",value:[{value:'"bool"'},{value:'"str"'},{value:'"int"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/instance/SystemStatus/RenderMetricValue.tsx#RenderMetricValue"]={docgenInfo:RenderMetricValue.__docgenInfo,name:"RenderMetricValue",path:"frontend/src/scenes/instance/SystemStatus/RenderMetricValue.tsx#RenderMetricValue"})}catch(__react_docgen_typescript_loader_error){}var METRIC_KEY_TO_INTERNAL_LINK={async_migrations_ok:"/instance/async_migrations"};function RenderMetric(metricRow){return react_default.a.createElement("span",null,metricRow.metric," ",METRIC_KEY_TO_INTERNAL_LINK[metricRow.key]?react_default.a.createElement(Link.a,{to:METRIC_KEY_TO_INTERNAL_LINK[metricRow.key]},react_default.a.createElement(icons.IconOpenInNew,{style:{verticalAlign:"middle"}})):null)}function OverviewTab(){var _useValues=Object(index_esm.useValues)(systemStatusLogic.b),overview=_useValues.overview,systemStatusLoading=_useValues.systemStatusLoading,columns=[{title:"Metric",className:"metric-column",render:RenderMetric},{title:"Value",render:RenderMetricValue}];return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(card.a,null,react_default.a.createElement("h3",{className:"l3"},"Key metrics"),react_default.a.createElement(table.a,{className:"system-status-table",size:"small",rowKey:"metric",pagination:!1,dataSource:overview,columns:columns,loading:systemStatusLoading,expandable:{expandedRowRender:function renderExpand(row){return row.subrows?react_default.a.createElement(Subrows,row.subrows):null},rowExpandable:function rowExpandable(row){return!!row.subrows&&row.subrows.rows.length>0},expandRowByClick:!0}})))}function Subrows(props){return react_default.a.createElement(table.a,{rowKey:"metric",pagination:!1,dataSource:props.rows,columns:props.columns.map((function(title,dataIndex){return{title:title,dataIndex:dataIndex}}))})}__webpack_require__(61),__webpack_require__(166),__webpack_require__(113),__webpack_require__(167);var objectDestructuringEmpty=__webpack_require__(121),objectDestructuringEmpty_default=__webpack_require__.n(objectDestructuringEmpty),slicedToArray=__webpack_require__(13),slicedToArray_default=__webpack_require__.n(slicedToArray),collapse=__webpack_require__(4159),es_checkbox=__webpack_require__(760),es_button=__webpack_require__(142),ReloadOutlined=__webpack_require__(4171),Dashboard=__webpack_require__(1168),modal=(__webpack_require__(124),__webpack_require__(1251)),input=__webpack_require__(473);function AnalyzeQueryModal(){var _useValues=Object(index_esm.useValues)(systemStatusLogic.b),analyzeModalOpen=_useValues.analyzeModalOpen,analyzeQuery=_useValues.analyzeQuery,analyzeQueryResult=_useValues.analyzeQueryResult,analyzeQueryResultLoading=_useValues.analyzeQueryResultLoading,_useActions=Object(index_esm.useActions)(systemStatusLogic.b),setAnalyzeModalOpen=_useActions.setAnalyzeModalOpen,setAnalyzeQuery=_useActions.setAnalyzeQuery,runAnalyzeQuery=_useActions.runAnalyzeQuery;return react_default.a.createElement(modal.a,{visible:analyzeModalOpen,title:"Analyze ClickHouse query performance",footer:react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(es_button.a,{onClick:function onClick(){return setAnalyzeModalOpen(!1)}},"Cancel"),react_default.a.createElement(es_button.a,{type:"primary",onClick:function onClick(){runAnalyzeQuery()},disabled:analyzeQueryResultLoading},"Analyze")),onCancel:function onCancel(){return setAnalyzeModalOpen(!1)},width:"80%"},react_default.a.createElement(input.a.TextArea,{placeholder:"SQL query to analyze",onChange:function onChange(e){return setAnalyzeQuery(e.target.value)},value:analyzeQuery,rows:10}),analyzeQueryResult&&react_default.a.createElement("div",{style:{marginTop:30}},react_default.a.createElement("h2",null,"Analysis results"),react_default.a.createElement("ul",null,Object.entries(analyzeQueryResult.timing).map((function(_ref){var _ref2=slicedToArray_default()(_ref,2),key=_ref2[0],value=_ref2[1];return react_default.a.createElement("li",{key:key},key,": ",value)}))),Object.entries(analyzeQueryResult.flamegraphs).map((function(_ref3){var _ref4=slicedToArray_default()(_ref3,2),key=_ref4[0],value=_ref4[1];return react_default.a.createElement("div",{key:key},react_default.a.createElement("h3",null,"Flamegraph: ",key),react_default.a.createElement("a",{className:"embedded-svg-wrapper",href:"data:image/svg+xml;utf8,".concat(encodeURIComponent(value)),dangerouslySetInnerHTML:{__html:value}}))}))))}function InternalMetricsTab(){var _useValues=Object(index_esm.useValues)(systemStatusLogic.b),openSections=_useValues.openSections,systemStatus=_useValues.systemStatus,queries=_useValues.queries,queriesLoading=_useValues.queriesLoading,showAnalyzeQueryButton=_useValues.showAnalyzeQueryButton,_useActions=Object(index_esm.useActions)(systemStatusLogic.b),setOpenSections=_useActions.setOpenSections,loadQueries=_useActions.loadQueries,_useState=Object(react.useState)(!1),_useState2=slicedToArray_default()(_useState,2),showIdle=_useState2[0],setShowIdle=_useState2[1],postgresQueries=Object(react.useMemo)((function(){var _queries$postgres_run;return null==queries||null===(_queries$postgres_run=queries.postgres_running)||void 0===_queries$postgres_run?void 0:_queries$postgres_run.filter((function(_ref){var state=_ref.state;return showIdle||"idle"!==state}))}),[showIdle,queries]),dashboard=null==systemStatus?void 0:systemStatus.internal_metrics.clickhouse,reloadQueries=function reloadQueries(e){e.stopPropagation(),loadQueries()};return react_default.a.createElement(card.a,null,react_default.a.createElement(collapse.a,{activeKey:openSections,onChange:function onChange(keys){return setOpenSections(keys)}},dashboard?react_default.a.createElement(collapse.a.Panel,{header:"Dashboards",key:"0"},react_default.a.createElement(Dashboard.Dashboard,{id:dashboard.id.toString(),shareToken:dashboard.share_token,internal:!0})):null,react_default.a.createElement(collapse.a.Panel,{header:"PostgreSQL - currently running queries",key:"1"},react_default.a.createElement("div",{className:"mb float-right"},react_default.a.createElement(es_checkbox.a,{checked:showIdle,onChange:function onChange(e){setShowIdle(e.target.checked)}},"Show idle queries"),react_default.a.createElement(es_button.a,{style:{marginLeft:8},onClick:reloadQueries},react_default.a.createElement(ReloadOutlined.a,null)," Reload Queries")),react_default.a.createElement(QueryTable,{queries:postgresQueries,loading:queriesLoading})),null!=(null==queries?void 0:queries.clickhouse_running)?react_default.a.createElement(collapse.a.Panel,{header:"Clickhouse - currently running queries",key:"2"},react_default.a.createElement("div",{className:"mb float-right"},react_default.a.createElement(es_button.a,{style:{marginLeft:8},onClick:reloadQueries},react_default.a.createElement(ReloadOutlined.a,null)," Reload Queries")),react_default.a.createElement(QueryTable,{queries:null==queries?void 0:queries.clickhouse_running,loading:queriesLoading,showAnalyze:showAnalyzeQueryButton})):null,null!=(null==queries?void 0:queries.clickhouse_slow_log)?react_default.a.createElement(collapse.a.Panel,{header:"Clickhouse - slow query log (past 6 hours)",key:"3"},react_default.a.createElement("div",{className:"mb float-right"},react_default.a.createElement(es_button.a,{style:{marginLeft:8},onClick:reloadQueries},react_default.a.createElement(ReloadOutlined.a,null)," Reload Queries")),react_default.a.createElement(QueryTable,{queries:null==queries?void 0:queries.clickhouse_slow_log,loading:queriesLoading,showAnalyze:showAnalyzeQueryButton})):null),react_default.a.createElement(AnalyzeQueryModal,null))}function QueryTable(props){var openAnalyzeModalWithQuery=Object(index_esm.useActions)(systemStatusLogic.b).openAnalyzeModalWithQuery,columns=[{title:"duration",dataIndex:"duration",key:"duration",sorter:function sorter(a,b){return+a.duration-+b.duration}},{title:"query",dataIndex:"query",render:function RenderAnalyze(_ref2,item){return objectDestructuringEmpty_default()(_ref2),props.showAnalyze?react_default.a.createElement(Link.a,{to:"#",onClick:function onClick(){return openAnalyzeModalWithQuery(item.query)}},item.query):item.query},key:"query"}];return props.queries&&props.queries.length>0&&Object.keys(props.queries[0]).forEach((function(column){"duration"!==column&&"query"!==column&&columns.push({title:column,dataIndex:column,key:column})})),react_default.a.createElement(table.a,{dataSource:props.queries||[],columns:columns,loading:props.loading,pagination:{pageSize:30,hideOnSinglePage:!0},size:"small",bordered:!0,style:{overflowX:"auto",overflowY:"auto"},locale:{emptyText:"No queries found"}})}var defineProperty=__webpack_require__(3),defineProperty_default=__webpack_require__.n(defineProperty),HotkeyButton=__webpack_require__(1173),LemonTable=__webpack_require__(244),useKeyboardHotkeys=__webpack_require__(1165);function RenderMetricValueEdit(_ref){var key=_ref.key,value=_ref.value,value_type=_ref.value_type,onValueChanged=_ref.onValueChanged;return"bool"===value_type?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(es_checkbox.a,{defaultChecked:value,onChange:function onChange(e){return onValueChanged(key,e.target.checked)}}),react_default.a.createElement(LemonTag.a,{style:{marginLeft:4},type:value?"success":"danger"},value?"Yes":"No")):react_default.a.createElement(input.a,{defaultValue:value,type:"int"===value_type?"number":"text",onBlur:function onBlur(e){return onValueChanged(key,e.target.value)}})}try{RenderMetricValueEdit.displayName="RenderMetricValueEdit",RenderMetricValueEdit.__docgenInfo={description:"",displayName:"RenderMetricValueEdit",props:{onValueChanged:{defaultValue:null,description:"",name:"onValueChanged",required:!0,type:{name:"(key: string, value: any) => void"}},emptyNullLabel:{defaultValue:null,description:"",name:"emptyNullLabel",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}},key:{defaultValue:null,description:"",name:"key",required:!0,type:{name:"string"}},value_type:{defaultValue:null,description:"",name:"value_type",required:!1,type:{name:"enum",value:[{value:'"bool"'},{value:'"str"'},{value:'"int"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/instance/SystemStatus/RenderMetricValueEdit.tsx#RenderMetricValueEdit"]={docgenInfo:RenderMetricValueEdit.__docgenInfo,name:"RenderMetricValueEdit",path:"frontend/src/scenes/instance/SystemStatus/RenderMetricValueEdit.tsx#RenderMetricValueEdit"})}catch(__react_docgen_typescript_loader_error){}var WarningOutlined=__webpack_require__(4172),AlertMessage=(__webpack_require__(116),__webpack_require__(85),__webpack_require__(101),__webpack_require__(246),__webpack_require__(2452));function ChangeRow(_ref){var metricKey=_ref.metricKey,oldValue=_ref.oldValue,value=_ref.value;return value.toString()===oldValue.toString()?null:react_default.a.createElement("div",{style:{backgroundColor:"var(--border-light)",borderRadius:"var(--radius)",padding:8,marginTop:16}},react_default.a.createElement("div",null,react_default.a.createElement("code",null,metricKey)),react_default.a.createElement("div",{style:{color:"var(--text-muted)"}},"Value will be changed from"," ",react_default.a.createElement("span",{style:{color:"var(--text-default)",fontWeight:"bold"}},RenderMetricValue({key:metricKey,value:oldValue}))," ","to"," ",react_default.a.createElement("span",{style:{color:"var(--text-default)",fontWeight:"bold"}},RenderMetricValue({key:metricKey,value:value}))))}function InstanceConfigSaveModal(_ref2){var onClose=_ref2.onClose,_useValues=Object(index_esm.useValues)(systemStatusLogic.b),instanceConfigEditingState=_useValues.instanceConfigEditingState,editableInstanceSettings=_useValues.editableInstanceSettings,updatedInstanceConfigCount=_useValues.updatedInstanceConfigCount,saveInstanceConfig=Object(index_esm.useActions)(systemStatusLogic.b).saveInstanceConfig,loading=null!==updatedInstanceConfigCount;return react_default.a.createElement(modal.a,{title:"Confirm new changes",visible:!0,okText:"Apply changes",okType:"danger",onCancel:onClose,maskClosable:!1,onOk:saveInstanceConfig,okButtonProps:{loading:loading},cancelButtonProps:{loading:loading},closable:!loading},Object.keys(instanceConfigEditingState).find((function(key){return key.startsWith("EMAIL")}))&&react_default.a.createElement(AlertMessage.a,{style:{marginBottom:16}},react_default.a.createElement(react_default.a.Fragment,null,"As you are changing email settings, we'll attempt to send a ",react_default.a.createElement("b",null,"test email")," so you can verify everything works (unless you are turning email off).")),Object.keys(instanceConfigEditingState).includes("RECORDINGS_TTL_WEEKS")&&react_default.a.createElement(AlertMessage.a,{style:{marginBottom:16},type:"warning"},react_default.a.createElement(react_default.a.Fragment,null,"Changing your recordings TTL requires ClickHouse to have enough free space to perform the operation (even when reducing this value). In addition, please mind that removing old recordings will be removed asynchronously, not immediately.")),react_default.a.createElement("div",null,"The following changes will be immediately applied to your instance."),Object.keys(instanceConfigEditingState).map((function(key){var _editableInstanceSett;return react_default.a.createElement(ChangeRow,{key:key,metricKey:key,value:instanceConfigEditingState[key],oldValue:null===(_editableInstanceSett=editableInstanceSettings.find((function(record){return record.key===key})))||void 0===_editableInstanceSett?void 0:_editableInstanceSett.value})})),loading&&react_default.a.createElement("div",{className:"mt text-success"},react_default.a.createElement("b",null,Object(utils.nb)(updatedInstanceConfigCount||0,"change")," updated successfully.")))}try{InstanceConfigSaveModal.displayName="InstanceConfigSaveModal",InstanceConfigSaveModal.__docgenInfo={description:"",displayName:"InstanceConfigSaveModal",props:{onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/instance/SystemStatus/InstanceConfigSaveModal.tsx#InstanceConfigSaveModal"]={docgenInfo:InstanceConfigSaveModal.__docgenInfo,name:"InstanceConfigSaveModal",path:"frontend/src/scenes/instance/SystemStatus/InstanceConfigSaveModal.tsx#InstanceConfigSaveModal"})}catch(__react_docgen_typescript_loader_error){}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function InstanceConfigTab(){var _useValues=Object(index_esm.useValues)(logic.a),configOptions=_useValues.configOptions,preflightLoading=_useValues.preflightLoading,_useValues2=Object(index_esm.useValues)(systemStatusLogic.b),editableInstanceSettings=_useValues2.editableInstanceSettings,instanceSettingsLoading=_useValues2.instanceSettingsLoading,instanceConfigMode=_useValues2.instanceConfigMode,instanceConfigEditingState=_useValues2.instanceConfigEditingState,_useActions=Object(index_esm.useActions)(systemStatusLogic.b),loadInstanceSettings=_useActions.loadInstanceSettings,setInstanceConfigMode=_useActions.setInstanceConfigMode,updateInstanceConfigValue=_useActions.updateInstanceConfigValue,clearInstanceConfigEditing=_useActions.clearInstanceConfigEditing;Object(useKeyboardHotkeys.a)({e:{action:function action(){return setInstanceConfigMode(systemStatusLogic.a.Edit)},disabled:instanceConfigMode!==systemStatusLogic.a.View||instanceSettingsLoading},escape:{action:function action(){return discard()},disabled:instanceConfigMode!==systemStatusLogic.a.Edit||instanceSettingsLoading},enter:{action:function action(){return save()},disabled:instanceConfigMode!==systemStatusLogic.a.Edit||instanceSettingsLoading}});var save=function save(){Object.keys(instanceConfigEditingState).length?setInstanceConfigMode(systemStatusLogic.a.Saving):setInstanceConfigMode(systemStatusLogic.a.View)},discard=function discard(){setInstanceConfigMode(systemStatusLogic.a.View),clearInstanceConfigEditing()};Object(react.useEffect)((function(){loadInstanceSettings()}),[]);var columns=[{title:"Key",dataIndex:"key",render:function render(value){return react_default.a.createElement("code",null,value)}},{title:"Description",dataIndex:"description"},{title:"Value",render:function renderValue(_,record){var _instanceConfigEditin,props={value:record.value,key:record.key,emptyNullLabel:"Unset",value_type:record.value_type};return instanceConfigMode===systemStatusLogic.a.View?RenderMetricValue(props):RenderMetricValueEdit(_objectSpread(_objectSpread({},props),{},{value:null!==(_instanceConfigEditin=instanceConfigEditingState[record.key])&&void 0!==_instanceConfigEditin?_instanceConfigEditin:record.value,onValueChanged:updateInstanceConfigValue}))},width:300}];return react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"flex-center"},react_default.a.createElement("div",{style:{flexGrow:1}},react_default.a.createElement("h3",{className:"l3",style:{marginTop:16}},"Instance configuration"),react_default.a.createElement("div",{className:"mb"},"Changing these settings will take effect on your entire instance."," ",react_default.a.createElement("a",{href:"https://posthog.com/docs/self-host/configure/instance-settings",target:"_blank"},"Learn more ",react_default.a.createElement(icons.IconOpenInNew,{style:{verticalAlign:"middle"}})),".")),instanceConfigMode===systemStatusLogic.a.View?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(HotkeyButton.a,{type:"primary",onClick:function onClick(){return setInstanceConfigMode(systemStatusLogic.a.Edit)},"data-attr":"instance-config-edit-button",hotkey:"e",disabled:instanceSettingsLoading},"Edit")):react_default.a.createElement(react_default.a.Fragment,null,Object.keys(instanceConfigEditingState).length>0&&react_default.a.createElement("span",{style:{color:"var(--warning)"}},react_default.a.createElement(WarningOutlined.a,null)," You have ",react_default.a.createElement("b",null,Object.keys(instanceConfigEditingState).length)," ","unapplied"," ",Object(utils.nb)(Object.keys(instanceConfigEditingState).length,"change",void 0,!1)),react_default.a.createElement(es_button.a,{type:"link",disabled:instanceSettingsLoading,onClick:discard},"Discard changes"),react_default.a.createElement(es_button.a,{type:"primary",disabled:instanceSettingsLoading,onClick:save},"Save"))),react_default.a.createElement(LemonTable.a,{dataSource:editableInstanceSettings,columns:columns,loading:instanceSettingsLoading,rowKey:"key"}),react_default.a.createElement("h3",{className:"l3",style:{marginTop:32}},"Environment configuration"),react_default.a.createElement("div",{className:"mb"},"These settings can only be modified by environment variables."," ",react_default.a.createElement("a",{href:"https://posthog.com/docs/self-host/configure/environment-variables",target:"_blank"},"Learn more ",react_default.a.createElement(icons.IconOpenInNew,{style:{verticalAlign:"middle"}})),"."),react_default.a.createElement(LemonTable.a,{dataSource:configOptions,columns:[{key:"metric",title:"Metric",dataIndex:"metric"},{title:"Value",dataIndex:"value"}],loading:preflightLoading,rowKey:"key"}),instanceConfigMode===systemStatusLogic.a.Saving&&react_default.a.createElement(InstanceConfigSaveModal,{onClose:function onClose(){return setInstanceConfigMode(systemStatusLogic.a.Edit)}}))}var userLogic=__webpack_require__(65),scene={component:SystemStatus_SystemStatus,logic:systemStatusLogic.b};function SystemStatus_SystemStatus(){var _useValues=Object(index_esm.useValues)(systemStatusLogic.b),tab=_useValues.tab,error=_useValues.error,systemStatus=_useValues.systemStatus,setTab=Object(index_esm.useActions)(systemStatusLogic.b).setTab,_useValues2=Object(index_esm.useValues)(logic.a),preflight=_useValues2.preflight,siteUrlMisconfigured=_useValues2.siteUrlMisconfigured,user=Object(index_esm.useValues)(userLogic.a).user;return react_default.a.createElement("div",{className:"system-status-scene"},react_default.a.createElement(PageHeader.a,{title:"Instance status & settings",caption:react_default.a.createElement(react_default.a.Fragment,null,"Here you can find all the critical runtime details and settings of your PostHog instance. You have access to this because you're a ",react_default.a.createElement("b",null,"staff user"),"."," ",react_default.a.createElement("a",{target:"_blank",style:{display:"inline-flex",alignItems:"center"},href:"https://posthog.com/docs/self-host/configure/instance-settings?utm_medium=in-product&utm_campaign=instance_status"},"Learn more ",react_default.a.createElement(icons.IconOpenInNew,{style:{marginLeft:4}})),".")}),error&&react_default.a.createElement(es_alert.a,{message:"Something went wrong",description:error||react_default.a.createElement("span",null,"An unknown error occurred. Please try again or contact us."),type:"error",showIcon:!0}),siteUrlMisconfigured&&react_default.a.createElement(es_alert.a,{message:"Misconfiguration detected",description:react_default.a.createElement(react_default.a.Fragment,null,"Your ",react_default.a.createElement("code",null,"SITE_URL")," environment variable seems misconfigured. Your"," ",react_default.a.createElement("code",null,"SITE_URL")," is set to"," ",react_default.a.createElement("b",null,react_default.a.createElement("code",null,null==preflight?void 0:preflight.site_url))," ","but you're currently browsing this page from"," ",react_default.a.createElement("b",null,react_default.a.createElement("code",null,window.location.origin)),". In order for PostHog to work properly, please set this to the origin where your instance is hosted."," ",react_default.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://posthog.com/docs/configuring-posthog/environment-variables?utm_medium=in-product&utm_campaign=system-status-site-url-misconfig"},"Learn more ",react_default.a.createElement(icons.IconOpenInNew,null))),showIcon:!0,type:"warning",style:{marginBottom:32}}),react_default.a.createElement(tabs.a,{tabPosition:"top",animated:!1,activeKey:tab,onTabClick:function onTabClick(key){return setTab(key)}},react_default.a.createElement(tabs.a.TabPane,{tab:"System overview",key:"overview"},react_default.a.createElement(OverviewTab,null)),!(null==systemStatus?void 0:systemStatus.internal_metrics.clickhouse)&&react_default.a.createElement(tabs.a.TabPane,{tab:"Internal metrics",key:"metrics"},react_default.a.createElement(InternalMetricsTab,null)),(null==user?void 0:user.is_staff)&&react_default.a.createElement(tabs.a.TabPane,{tab:react_default.a.createElement(react_default.a.Fragment,null,"Settings ",react_default.a.createElement(LemonTag.a,{type:"warning"},"Beta")),key:"settings"},react_default.a.createElement(InstanceConfigTab,null))))}}}]);