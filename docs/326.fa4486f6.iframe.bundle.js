"use strict";(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[326],{"./frontend/src/scenes/web-analytics/WebAnalyticsScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{WebAnalyticsScene:()=>WebAnalyticsScene,scene:()=>scene});var index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),schema=__webpack_require__("./frontend/src/queries/schema.ts"),types=__webpack_require__("./frontend/src/types.ts"),utils=__webpack_require__("./frontend/src/lib/utils.tsx");let SourceTab=function(SourceTab){return SourceTab.REFERRING_DOMAIN="REFERRING_DOMAIN",SourceTab.UTM_SOURCE="UTM_SOURCE",SourceTab.UTM_CAMPAIGN="UTM_CAMPAIGN",SourceTab}({}),DeviceTab=function(DeviceTab){return DeviceTab.BROWSER="BROWSER",DeviceTab.OS="OS",DeviceTab.DEVICE_TYPE="DEVICE_TYPE",DeviceTab}({}),PathTab=function(PathTab){return PathTab.PATH="PATH",PathTab.INITIAL_PATH="INITIAL_PATH",PathTab}({}),GeographyTab=function(GeographyTab){return GeographyTab.MAP="MAP",GeographyTab.COUNTRIES="COUNTRIES",GeographyTab.REGIONS="REGIONS",GeographyTab.CITIES="CITIES",GeographyTab}({});const setOncePropertyNames=["$initial_pathname","$initial_referrer","$initial_utm_source","$initial_utm_campaign"],hogqlForSetOnceProperty=(key,value)=>`properties.$set_once.${key} = '${value}'`,isHogqlForSetOnceProperty=(key,p)=>setOncePropertyNames.includes(key)&&p.key.startsWith(`properties.$set_once.${key} = `),webAnalyticsLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","webAnalytics","webAnalyticsSceneLogic"]),(0,index_esm.connect)({}),(0,index_esm.actions)({setWebAnalyticsFilters:webAnalyticsFilters=>({webAnalyticsFilters}),togglePropertyFilter:(key,value)=>({key,value}),setSourceTab:tab=>({tab}),setDeviceTab:tab=>({tab}),setPathTab:tab=>({tab}),setGeographyTab:tab=>({tab}),setDates:(dateFrom,dateTo)=>({dateFrom,dateTo})}),(0,index_esm.reducers)({webAnalyticsFilters:[[],{setWebAnalyticsFilters:(_,_ref)=>{let{webAnalyticsFilters}=_ref;return webAnalyticsFilters},togglePropertyFilter:(oldPropertyFilters,_ref2)=>{let{key,value}=_ref2;if(oldPropertyFilters.some((f=>f.type===types.FT.Event&&f.key===key&&f.operator===types.WV.Exact||f.type===types.FT.HogQL&&isHogqlForSetOnceProperty(key,f))))return oldPropertyFilters.map((f=>{if(setOncePropertyNames.includes(key)){if(f.type!==types.FT.HogQL)return f;if(!isHogqlForSetOnceProperty(key,f))return f;const hogql=hogqlForSetOnceProperty(key,value);return f.key===hogql?null:{type:types.FT.HogQL,key,value:hogql}}{if(f.key!==key||f.type!==types.FT.Event||f.operator!==types.WV.Exact)return f;const oldValue=(Array.isArray(f.value)?f.value:[f.value]).filter(utils.DX);let newValue;if(oldValue.includes(value)){if(!(oldValue.length>1))return null;newValue=[value]}else newValue=[...oldValue,value];return{type:types.FT.Event,key,operator:types.WV.Exact,value:newValue}}})).filter(utils.DX);{let newFilter;return newFilter=setOncePropertyNames.includes(key)?{type:types.FT.HogQL,key:hogqlForSetOnceProperty(key,value)}:{type:types.FT.Event,key,value,operator:types.WV.Exact},[...oldPropertyFilters,newFilter]}}}],sourceTab:[SourceTab.REFERRING_DOMAIN,{setSourceTab:(_,_ref3)=>{let{tab}=_ref3;return tab}}],deviceTab:[DeviceTab.BROWSER,{setDeviceTab:(_,_ref4)=>{let{tab}=_ref4;return tab}}],pathTab:[PathTab.PATH,{setPathTab:(_,_ref5)=>{let{tab}=_ref5;return tab}}],geographyTab:[GeographyTab.COUNTRIES,{setGeographyTab:(_,_ref6)=>{let{tab}=_ref6;return tab}}],dateFrom:["-7d",{setDates:(_,_ref7)=>{let{dateFrom}=_ref7;return dateFrom}}],dateTo:["-0d",{setDates:(_,_ref8)=>{let{dateTo}=_ref8;return dateTo}}]}),(0,index_esm.selectors)((_ref9=>{let{actions}=_ref9;return{tiles:[s=>[s.webAnalyticsFilters,s.pathTab,s.deviceTab,s.sourceTab,s.geographyTab,s.dateFrom,s.dateTo],(webAnalyticsFilters,pathTab,deviceTab,sourceTab,geographyTab,dateFrom,dateTo)=>{const dateRange={date_from:dateFrom,date_to:dateTo};return[{layout:{colSpan:12},query:{kind:schema.OH.WebOverviewQuery,properties:webAnalyticsFilters,dateRange}},{layout:{colSpan:6},activeTabId:pathTab,setTabId:actions.setPathTab,tabs:[{id:PathTab.PATH,title:"Top Paths",linkText:"Path",query:{full:!0,kind:schema.OH.DataTableNode,source:{kind:schema.OH.WebStatsTableQuery,properties:webAnalyticsFilters,breakdownBy:schema.GI.Page,dateRange}}},{id:PathTab.INITIAL_PATH,title:"Top Entry Paths",linkText:"Entry Path",query:{full:!0,kind:schema.OH.DataTableNode,source:{kind:schema.OH.WebStatsTableQuery,properties:webAnalyticsFilters,breakdownBy:schema.GI.InitialPage,dateRange}}}]},{layout:{colSpan:6},activeTabId:sourceTab,setTabId:actions.setSourceTab,tabs:[{id:SourceTab.REFERRING_DOMAIN,title:"Top Referrers",linkText:"Referrer",query:{full:!0,kind:schema.OH.DataTableNode,source:{kind:schema.OH.WebStatsTableQuery,properties:webAnalyticsFilters,breakdownBy:schema.GI.InitialReferringDomain,dateRange}}},{id:SourceTab.UTM_SOURCE,title:"Top Sources",linkText:"UTM Source",query:{full:!0,kind:schema.OH.DataTableNode,source:{kind:schema.OH.WebStatsTableQuery,properties:webAnalyticsFilters,breakdownBy:schema.GI.InitialUTMSource,dateRange}}},{id:SourceTab.UTM_CAMPAIGN,title:"Top Campaigns",linkText:"UTM Campaign",query:{full:!0,kind:schema.OH.DataTableNode,source:{kind:schema.OH.WebStatsTableQuery,properties:webAnalyticsFilters,breakdownBy:schema.GI.InitialUTMCampaign,dateRange}}}]},{layout:{colSpan:6},activeTabId:deviceTab,setTabId:actions.setDeviceTab,tabs:[{id:DeviceTab.BROWSER,title:"Top Browsers",linkText:"Browser",query:{full:!0,kind:schema.OH.DataTableNode,source:{kind:schema.OH.WebStatsTableQuery,properties:webAnalyticsFilters,breakdownBy:schema.GI.Browser,dateRange}}},{id:DeviceTab.OS,title:"Top OSs",linkText:"OS",query:{full:!0,kind:schema.OH.DataTableNode,source:{kind:schema.OH.WebStatsTableQuery,properties:webAnalyticsFilters,breakdownBy:schema.GI.OS,dateRange}}},{id:DeviceTab.DEVICE_TYPE,title:"Top Device Types",linkText:"Device Type",query:{full:!0,kind:schema.OH.DataTableNode,source:{kind:schema.OH.WebStatsTableQuery,properties:webAnalyticsFilters,breakdownBy:schema.GI.DeviceType,dateRange}}}]},{layout:{colSpan:6},activeTabId:geographyTab,setTabId:actions.setGeographyTab,tabs:[{id:GeographyTab.MAP,title:"World Map",linkText:"Map",query:{kind:schema.OH.InsightVizNode,source:{kind:schema.OH.TrendsQuery,breakdown:{breakdown:"$geoip_country_code",breakdown_type:"person"},dateRange,series:[{event:"$pageview",kind:schema.OH.EventsNode,math:types.vN.UniqueUsers}],trendsFilter:{display:types.Qb.WorldMap},filterTestAccounts:!0,properties:webAnalyticsFilters}}},{id:GeographyTab.COUNTRIES,title:"Top Countries",linkText:"Countries",query:{full:!0,kind:schema.OH.DataTableNode,source:{kind:schema.OH.WebStatsTableQuery,properties:webAnalyticsFilters,breakdownBy:schema.GI.Country,dateRange}}},{id:GeographyTab.REGIONS,title:"Top Regions",linkText:"Regions",query:{full:!0,kind:schema.OH.DataTableNode,source:{kind:schema.OH.WebStatsTableQuery,properties:webAnalyticsFilters,breakdownBy:schema.GI.Region,dateRange}}},{id:GeographyTab.CITIES,title:"Top Cities",linkText:"Cities",query:{full:!0,kind:schema.OH.DataTableNode,source:{kind:schema.OH.WebStatsTableQuery,properties:webAnalyticsFilters,breakdownBy:schema.GI.City,dateRange}}}]}]}]}})),(0,index_esm.sharedListeners)((()=>({}))),(0,index_esm.listeners)((()=>({})))]);var Query=__webpack_require__("./frontend/src/queries/Query/Query.tsx"),PropertyFilters=__webpack_require__("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),PropertyFilters_utils=__webpack_require__("./frontend/src/lib/components/PropertyFilters/utils.ts"),DateFilter=__webpack_require__("./frontend/src/lib/components/DateFilter/DateFilter.tsx"),supportLogic=__webpack_require__("./frontend/src/lib/components/Support/supportLogic.ts"),preflightLogic=__webpack_require__("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),LemonBanner=__webpack_require__("./frontend/src/lib/lemon-ui/LemonBanner/index.ts"),Link=__webpack_require__("./frontend/src/lib/lemon-ui/Link/index.ts"),icons=__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");const WebAnalyticsNotice=()=>{const{openSupportForm}=(0,index_esm.useActions)(supportLogic.Pw),{preflight}=(0,index_esm.useValues)(preflightLogic.preflightLogic),showSupportOptions=preflight?.cloud;return(0,jsx_runtime.jsxs)(LemonBanner.V,{type:"info",children:[(0,jsx_runtime.jsx)("p",{children:"PostHog Web Analytics is in closed Alpha. Thanks for taking part! We'd love to hear what you think."}),showSupportOptions?(0,jsx_runtime.jsxs)("p",{children:[(0,jsx_runtime.jsxs)(Link.r,{onClick:()=>openSupportForm("bug"),children:[(0,jsx_runtime.jsx)(icons.Hkj,{})," Report a bug"]})," ","-"," ",(0,jsx_runtime.jsxs)(Link.r,{onClick:()=>openSupportForm("feedback"),children:[(0,jsx_runtime.jsx)(icons.Rz4,{})," Give feedback"]})," ","-"," ",(0,jsx_runtime.jsxs)(Link.r,{to:"https://github.com/PostHog/posthog/issues/18177",children:[(0,jsx_runtime.jsx)(icons.Uvs,{})," View GitHub issue"]})]}):null]})};var react=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),WorldMap=__webpack_require__("./frontend/src/scenes/insights/views/WorldMap/index.ts");const NumericCell=_ref2=>{let{value}=_ref2;return(0,jsx_runtime.jsx)("span",{children:"number"==typeof value?value.toLocaleString():String(value)})},webStatsBreakdownToPropertyName=breakdownBy=>{switch(breakdownBy){case schema.GI.Page:return"$pathname";case schema.GI.InitialPage:return"$client_session_initial_pathname";case schema.GI.InitialReferringDomain:return"$client_session_initial_referring_host";case schema.GI.InitialUTMSource:return"$client_session_initial_utm_source";case schema.GI.InitialUTMCampaign:return"$client_session_initial_utm_campaign";case schema.GI.InitialUTMMedium:return"$client_session_initial_utm_medium";case schema.GI.InitialUTMContent:return"$client_session_initial_utm_content";case schema.GI.InitialUTMTerm:return"$client_session_initial_utm_term";case schema.GI.Browser:return"$browser";case schema.GI.OS:return"$os";case schema.GI.DeviceType:return"$device_type";case schema.GI.Country:return"$geoip_country_code";case schema.GI.Region:return"$geoip_subdivision_1_code";case schema.GI.City:return"$geoip_city_name";default:throw new utils.q0(breakdownBy)}},webAnalyticsDataTableQueryContext={columns:{breakdown_value:{renderTitle:props=>{const{query}=props,{source}=query;if(source.kind!==schema.OH.WebStatsTableQuery)return null;const{breakdownBy}=source;switch(breakdownBy){case schema.GI.Page:return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"Path"});case schema.GI.InitialPage:return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"Initial Path"});case schema.GI.InitialReferringDomain:return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"Referring Domain"});case schema.GI.InitialUTMSource:return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"UTM Source"});case schema.GI.InitialUTMCampaign:return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"UTM Campaign"});case schema.GI.InitialUTMMedium:return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"UTM Medium"});case schema.GI.InitialUTMTerm:return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"UTM Term"});case schema.GI.InitialUTMContent:return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"UTM Content"});case schema.GI.Browser:return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"Browser"});case schema.GI.OS:return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"OS"});case schema.GI.DeviceType:return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"Device Type"});case schema.GI.Country:return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"Country"});case schema.GI.Region:return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"Region"});case schema.GI.City:return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"City"});default:throw new utils.q0(breakdownBy)}},render:props=>{const{value,query}=props,{source}=query;if(source.kind!==schema.OH.WebStatsTableQuery)return null;const{breakdownBy}=source;switch(breakdownBy){case schema.GI.Country:if("string"==typeof value){const countryCode=value;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,WorldMap.q9)(countryCode)," ",WorldMap.XJ[countryCode]||countryCode]})}break;case schema.GI.Region:if(Array.isArray(value)){const[countryCode,regionCode,regionName]=value;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,WorldMap.q9)(countryCode)," ",WorldMap.XJ[countryCode]||countryCode," -"," ",regionName||regionCode]})}break;case schema.GI.City:if(Array.isArray(value)){const[countryCode,cityName]=value;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,WorldMap.q9)(countryCode)," ",WorldMap.XJ[countryCode]||countryCode," - ",cityName]})}}return"string"==typeof value?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:value}):null}},bounce_rate:{title:"Bounce Rate",render:_ref=>{let{value}=_ref;return"number"==typeof value?(0,jsx_runtime.jsx)("span",{children:`${(100*value).toFixed(1)}%`}):null},align:"right"},views:{title:"Views",render:NumericCell,align:"right"},visitors:{title:"Visitors",render:NumericCell,align:"right"}}},WebStatsTableTile=_ref3=>{let{query,breakdownBy}=_ref3;const{togglePropertyFilter}=(0,index_esm.useActions)(webAnalyticsLogic),propertyName=webStatsBreakdownToPropertyName(breakdownBy),onClick=(0,react.useCallback)((breakdownValue=>{togglePropertyFilter(propertyName,breakdownValue)}),[togglePropertyFilter,propertyName]),context=(0,react.useMemo)((()=>({...webAnalyticsDataTableQueryContext,rowProps:record=>{const breakdownValue=getBreakdownValue(record,breakdownBy);return void 0===breakdownValue?{}:{onClick:()=>onClick(breakdownValue)}}})),[onClick]);return(0,jsx_runtime.jsx)(Query.A,{query,readOnly:!0,context})},getBreakdownValue=(record,breakdownBy)=>{if("object"!=typeof record||!record||!("result"in record))return;const result=record.result;if(!Array.isArray(result))return;const breakdownValue=result[0];switch(breakdownBy){case schema.GI.Country:if(Array.isArray(breakdownValue))return breakdownValue[0];break;case schema.GI.Region:case schema.GI.City:if(Array.isArray(breakdownValue))return breakdownValue[1]}return"string"==typeof breakdownValue?breakdownValue:void 0};try{webStatsBreakdownToPropertyName.displayName="webStatsBreakdownToPropertyName",webStatsBreakdownToPropertyName.__docgenInfo={description:"",displayName:"webStatsBreakdownToPropertyName",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/web-analytics/WebAnalyticsDataTable.tsx#webStatsBreakdownToPropertyName"]={docgenInfo:webStatsBreakdownToPropertyName.__docgenInfo,name:"webStatsBreakdownToPropertyName",path:"frontend/src/scenes/web-analytics/WebAnalyticsDataTable.tsx#webStatsBreakdownToPropertyName"})}catch(__react_docgen_typescript_loader_error){}try{WebStatsTableTile.displayName="WebStatsTableTile",WebStatsTableTile.__docgenInfo={description:"",displayName:"WebStatsTableTile",props:{query:{defaultValue:null,description:"",name:"query",required:!0,type:{name:"DataTableNode"}},breakdownBy:{defaultValue:null,description:"",name:"breakdownBy",required:!0,type:{name:"enum",value:[{value:'"Page"'},{value:'"InitialPage"'},{value:'"InitialReferringDomain"'},{value:'"InitialUTMSource"'},{value:'"InitialUTMCampaign"'},{value:'"InitialUTMMedium"'},{value:'"InitialUTMTerm"'},{value:'"InitialUTMContent"'},{value:'"Browser"'},{value:'"OS"'},{value:'"DeviceType"'},{value:'"Country"'},{value:'"Region"'},{value:'"City"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/web-analytics/WebAnalyticsDataTable.tsx#WebStatsTableTile"]={docgenInfo:WebStatsTableTile.__docgenInfo,name:"WebStatsTableTile",path:"frontend/src/scenes/web-analytics/WebAnalyticsDataTable.tsx#WebStatsTableTile"})}catch(__react_docgen_typescript_loader_error){}var clsx_m=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),hooks=__webpack_require__("./frontend/src/lib/lemon-ui/hooks.ts");const WebTabs=_ref=>{let{className,activeTabId,tabs,setActiveTabId}=_ref;const activeTab=tabs.find((t=>t.id===activeTabId)),{containerRef,selectionRef,sliderWidth,sliderOffset,transitioning}=(0,hooks.g)(activeTabId,200);return(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.default)(className,"flex flex-col"),children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-row items-center self-stretch",children:[(0,jsx_runtime.jsx)("h2",{className:"flex-1 m-0 mb-1",children:activeTab?.title}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-col items-stretch",children:[tabs.length>1&&(0,jsx_runtime.jsx)("ul",{className:"flex flex-row items-center space-x-2",ref:containerRef,children:tabs.map((_ref2=>{let{id,linkText}=_ref2;return(0,jsx_runtime.jsx)("li",{ref:id===activeTabId?selectionRef:void 0,children:(0,jsx_runtime.jsx)("button",{className:(0,clsx_m.default)("bg-transparent border-none cursor-pointer",id===activeTabId?"text-bold text-link":"text-current hover:text-link"),onClick:()=>setActiveTabId(id),children:linkText})},id)}))}),(0,jsx_runtime.jsx)("div",{className:"w-full relative",children:(0,jsx_runtime.jsx)("div",{className:"h-px bg-link absolute",style:{width:sliderWidth,left:0,transform:`translateX(${sliderOffset}px)`,transition:transitioning?"width 200ms ease, transform 200ms ease":void 0}})})]})]}),(0,jsx_runtime.jsx)("div",{children:activeTab?.content})]})};try{WebTabs.displayName="WebTabs",WebTabs.__docgenInfo={description:"",displayName:"WebTabs",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},activeTabId:{defaultValue:null,description:"",name:"activeTabId",required:!0,type:{name:"string"}},tabs:{defaultValue:null,description:"",name:"tabs",required:!0,type:{name:"{ id: string; title: string; linkText: string; content: ReactNode; }[]"}},setActiveTabId:{defaultValue:null,description:"",name:"setActiveTabId",required:!0,type:{name:"(id: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/web-analytics/WebTabs.tsx#WebTabs"]={docgenInfo:WebTabs.__docgenInfo,name:"WebTabs",path:"frontend/src/scenes/web-analytics/WebTabs.tsx#WebTabs"})}catch(__react_docgen_typescript_loader_error){}var TaxonomicFilter_types=__webpack_require__("./frontend/src/lib/components/TaxonomicFilter/types.ts");const Filters=()=>{const{webAnalyticsFilters,dateTo,dateFrom}=(0,index_esm.useValues)(webAnalyticsLogic),{setWebAnalyticsFilters,setDates}=(0,index_esm.useActions)(webAnalyticsLogic);return(0,jsx_runtime.jsxs)("div",{className:"sticky top-0 bg-white z-20 pt-2",children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-row flex-wrap gap-2",children:[(0,jsx_runtime.jsx)(DateFilter.f,{dateFrom,dateTo,onChange:setDates}),(0,jsx_runtime.jsx)(PropertyFilters.t,{taxonomicGroupTypes:[TaxonomicFilter_types.t.EventProperties],onChange:filters=>setWebAnalyticsFilters(filters.filter(PropertyFilters_utils.B0)),propertyFilters:webAnalyticsFilters,pageKey:"web-analytics",eventNames:["$pageview","$pageleave","$autocapture"],propertyAllowList:{[TaxonomicFilter_types.t.EventProperties]:["$pathname","$host","$browser","$os","$device_type","$geoip_country_code","$geoip_subdivision_1_code","$geoip_city_name","$client_session_initial_pathname","$client_session_initial_referring_host","$client_session_initial_utm_source","$client_session_initial_utm_campaign","$client_session_initial_utm_medium","$client_session_initial_utm_content","$client_session_initial_utm_term"]}})]}),(0,jsx_runtime.jsx)("div",{className:"bg-border h-px w-full mt-2"})]})},Tiles=()=>{const{tiles}=(0,index_esm.useValues)(webAnalyticsLogic);return(0,jsx_runtime.jsx)("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-12 gap-4",children:tiles.map(((tile,i)=>{if("query"in tile){var _layout$colSpan,_layout$rowSpan;const{query,title,layout}=tile;return(0,jsx_runtime.jsxs)("div",{className:`col-span-1 row-span-1 md:col-span-${null!==(_layout$colSpan=layout.colSpan)&&void 0!==_layout$colSpan?_layout$colSpan:6} md:row-span-${null!==(_layout$rowSpan=layout.rowSpan)&&void 0!==_layout$rowSpan?_layout$rowSpan:1}  flex flex-col`,children:[title&&(0,jsx_runtime.jsx)("h2",{className:"m-0  mb-1",children:title}),(0,jsx_runtime.jsx)(WebQuery,{query})]},i)}return"tabs"in tile?(0,jsx_runtime.jsx)(TabsTileItem,{tile},i):null}))})},TabsTileItem=_ref=>{var _layout$colSpan2,_layout$rowSpan2;let{tile}=_ref;const{layout}=tile;return(0,jsx_runtime.jsx)(WebTabs,{className:`col-span-1 row-span-1 md:col-span-${null!==(_layout$colSpan2=layout.colSpan)&&void 0!==_layout$colSpan2?_layout$colSpan2:6} md:row-span-${null!==(_layout$rowSpan2=layout.rowSpan)&&void 0!==_layout$rowSpan2?_layout$rowSpan2:1}`,activeTabId:tile.activeTabId,setActiveTabId:tile.setTabId,tabs:tile.tabs.map((tab=>({id:tab.id,content:(0,jsx_runtime.jsx)(WebQuery,{query:tab.query},tab.id),linkText:tab.linkText,title:tab.title})))})},WebQuery=_ref2=>{let{query}=_ref2;return query.kind===schema.OH.DataTableNode&&query.source.kind===schema.OH.WebStatsTableQuery?(0,jsx_runtime.jsx)(WebStatsTableTile,{query,breakdownBy:query.source.breakdownBy}):(0,jsx_runtime.jsx)(Query.A,{query,readOnly:!0,context:webAnalyticsDataTableQueryContext})},WebAnalyticsDashboard=()=>(0,jsx_runtime.jsxs)("div",{className:"w-full flex flex-col pt-2",children:[(0,jsx_runtime.jsx)(WebAnalyticsNotice,{}),(0,jsx_runtime.jsx)(Filters,{}),(0,jsx_runtime.jsx)(Tiles,{})]});function WebAnalyticsScene(){return(0,jsx_runtime.jsx)(WebAnalyticsDashboard,{})}const scene={component:WebAnalyticsScene,logic:webAnalyticsLogic}}}]);