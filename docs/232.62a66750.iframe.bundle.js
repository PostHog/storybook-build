(window.webpackJsonp=window.webpackJsonp||[]).push([[232,242],{"./frontend/src/lib/components/LemonSelect.tsx":function(ie,C,e){"use strict";e.d(C,"a",function(){return D});var T=e("./node_modules/core-js/modules/es.array.map.js"),s=e.n(T),B=e("./node_modules/core-js/modules/es.object.entries.js"),I=e.n(B),$=e("./node_modules/@babel/runtime/helpers/extends.js"),de=e.n($),ee=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),b=e.n(ee),W=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),Z=e.n(W),p=e("./node_modules/react/index.js"),t=e.n(p),w=e("./frontend/src/lib/components/icons.tsx"),j=e("./frontend/src/lib/components/LemonButton/index.ts");function D(v){var g,V,O=v.value,F=v.onChange,U=v.options,ae=v.placeholder,d=v.dropdownMatchSelectWidth,m=d===void 0?!0:d,c=v.allowClear,z=c===void 0?!1:c,ce=Z()(v,["value","onChange","options","placeholder","dropdownMatchSelectWidth","allowClear"]),se=Object(p.useState)(O),A=b()(se,2),N=A[0],oe=A[1],u=Object(p.useState)(!1),J=b()(u,2),te=J[0],X=J[1],K=z&&te&&!!N;return Object(p.useEffect)(function(){ce.loading||oe(O)},[O,ce.loading]),t.a.createElement("div",{className:"LemonButtonWithSideAction",onMouseEnter:function(){return X(!0)},onMouseLeave:function(){return X(!1)}},t.a.createElement(j.b,de()({popup:{overlay:Object.entries(U).map(function(k){var q=b()(k,2),L=q[0],R=q[1];return t.a.createElement(j.a,{key:L,icon:R.icon,onClick:function(){L!=N&&(F(L),oe(L))},type:L==N?"highlighted":"stealth",disabled:R.disabled,fullWidth:!0,"data-attr":R["data-attr"]},R.label||L)}),sameWidth:m,actionable:!0},icon:N&&((g=U[N])===null||g===void 0?void 0:g.icon),sideIcon:K?t.a.createElement("div",null):void 0},ce),N&&(((V=U[N])===null||V===void 0?void 0:V.label)||N)||t.a.createElement("span",{className:"text-muted"},ae)),K&&t.a.createElement(j.a,{className:"side-button",type:"tertiary",icon:t.a.createElement(w.IconClose,{style:{fontSize:"1rem"}}),tooltip:"Clear selection",onClick:function(){F(null),oe(null)}}))}try{D.displayName="LemonSelect",D.__docgenInfo={description:"",displayName:"LemonSelect",props:{options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"LemonSelectOptions"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string | number | symbol | null"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(newValue: keyof O | null) => void"}},dropdownMatchSelectWidth:{defaultValue:{value:"true"},description:"",name:"dropdownMatchSelectWidth",required:!1,type:{name:"boolean"}},allowClear:{defaultValue:{value:"false"},description:"",name:"allowClear",required:!1,type:{name:"boolean"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"highlighted"'},{value:'"primary"'},{value:'"secondary"'},{value:'"tertiary"'},{value:'"stealth"'},{value:'"primary-alt"'}]}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLButtonElement>"}},relaxedIconWidth:{defaultValue:null,description:"If icon width is relaxed, width of icon box is set to auto. Default icon width is 1em",name:"relaxedIconWidth",required:!1,type:{name:"boolean"}},status:{defaultValue:null,description:"",name:"status",required:!1,type:{name:"enum",value:[{value:'"muted"'},{value:'"success"'},{value:'"warning"'},{value:'"danger"'},{value:'"highlighted"'}]}},extendedContent:{defaultValue:null,description:"Extended content, e.g. a description, to show in the lower button area.",name:"extendedContent",required:!1,type:{name:"ReactNode"}},tooltip:{defaultValue:null,description:"Tooltip to display on hover.",name:"tooltip",required:!1,type:{name:"any"}},sideIcon:{defaultValue:null,description:"",name:"sideIcon",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>> | null"}},loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"boolean"}},compact:{defaultValue:null,description:"A compact row is slightly smaller than normal to better look inline with text.",name:"compact",required:!1,type:{name:"boolean"}},fullWidth:{defaultValue:null,description:"Whether the row should take up the parent's full width.",name:"fullWidth",required:!1,type:{name:"boolean"}},center:{defaultValue:null,description:"Whether the row's contents should be centered.",name:"center",required:!1,type:{name:"boolean"}},outlined:{defaultValue:null,description:"Whether the element should be outlined with a standard border.",name:"outlined",required:!1,type:{name:"any"}},"data-attr":{defaultValue:null,description:"",name:"data-attr",required:!1,type:{name:"string"}},to:{defaultValue:null,description:"URL to link to.",name:"to",required:!1,type:{name:"string"}},htmlType:{defaultValue:null,description:"",name:"htmlType",required:!1,type:{name:"string"}},translucent:{defaultValue:null,description:"Whether the button should have transparent background in its base state (i.e. non-hover).",name:"translucent",required:!1,type:{name:"boolean"}},active:{defaultValue:null,description:"Whether hover style should be applied, signaling that the button is held active in some way.",name:"active",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/LemonSelect.tsx#LemonSelect"]={docgenInfo:D.__docgenInfo,name:"LemonSelect",path:"frontend/src/lib/components/LemonSelect.tsx#LemonSelect"})}catch(v){}},"./frontend/src/lib/forms/Field.tsx":function(ie,C,e){"use strict";e.d(C,"a",function(){return t});var T=e("./node_modules/core-js/modules/es.function.name.js"),s=e.n(T),B=e("./node_modules/@babel/runtime/helpers/extends.js"),I=e.n(B),$=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),de=e.n($),ee=e("./node_modules/clsx/dist/clsx.m.js"),b=e("./node_modules/kea-forms/lib/components.js"),W=e.n(b),Z=e("./node_modules/react/index.js"),p=e.n(Z),t=function(j){var D=j.showOptional,v=j.name,g=de()(j,["showOptional","name"]),V=function(F){var U=F.label,ae=F.kids,d=F.hint,m=F.error;return p.a.createElement("div",{className:Object(ee.a)("ant-row","ant-form-item",d||m?"ant-form-item-with-help":"",m?"ant-form-item-has-error":"")},U?p.a.createElement("div",{className:"ant-col ant-form-item-label"},p.a.createElement("label",{htmlFor:String(v),title:typeof U=="string"?U:void 0},D?p.a.createElement(p.a.Fragment,null,U,D?p.a.createElement("span",{className:"ant-form-item-optional",title:""},"(optional)"):null):U)):null,p.a.createElement("div",{className:"ant-col ant-form-item-control"},p.a.createElement("div",{className:"ant-form-item-control-input"},p.a.createElement("div",{className:"ant-form-item-control-input-content"},ae)),d||m?p.a.createElement("div",{className:"ant-form-item-explain ant-form-item-explain-connected"},m?p.a.createElement("div",{role:"alert",className:"ant-form-item-explain-error"},"Error: ",m):null,d?p.a.createElement("div",{role:"alert",className:"ant-form-item-explain-warning"},"Hint: ",d):null):null))};return p.a.createElement(b.Field,I()({},g,{name:v,template:V}))};try{t.displayName="Field",t.__docgenInfo={description:"Compatible replacement for Form.Item",displayName:"Field",props:{showOptional:{defaultValue:null,description:"",name:"showOptional",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/forms/Field.tsx#Field"]={docgenInfo:t.__docgenInfo,name:"Field",path:"frontend/src/lib/forms/Field.tsx#Field"})}catch(w){}},"./frontend/src/lib/forms/VerticalForm.tsx":function(ie,C,e){"use strict";e.d(C,"a",function(){return b});var T=e("./node_modules/@babel/runtime/helpers/extends.js"),s=e.n(T),B=e("./node_modules/react/index.js"),I=e.n(B),$=e("./node_modules/kea-forms/lib/index.js"),de=e.n($),ee=e("./node_modules/clsx/dist/clsx.m.js");function b(W){return I.a.createElement($.Form,s()({},W,{className:Object(ee.a)("antd-form ant-form-vertical",W.className)}),W.children)}try{b.displayName="VerticalForm",b.__docgenInfo={description:"",displayName:"VerticalForm",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/forms/VerticalForm.tsx#VerticalForm"]={docgenInfo:b.__docgenInfo,name:"VerticalForm",path:"frontend/src/lib/forms/VerticalForm.tsx#VerticalForm"})}catch(W){}},"./frontend/src/scenes/cohorts/Cohort.tsx":function(ie,C,e){"use strict";e.r(C),e.d(C,"scene",function(){return Be}),e.d(C,"Cohort",function(){return he});var T=e("./node_modules/core-js/modules/es.array.concat.js"),s=e("./node_modules/core-js/modules/es.array.filter.js"),B=e("./node_modules/core-js/modules/es.array.map.js"),I=e("./node_modules/core-js/modules/es.function.name.js"),$=e("./node_modules/core-js/modules/es.object.to-string.js"),de=e("./node_modules/core-js/modules/es.regexp.to-string.js"),ee=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),b=e.n(ee),W=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),Z=e.n(W),p=e("./node_modules/react/index.js"),t=e.n(p),w=e("./node_modules/kea/lib/index.esm.js"),j=e("./node_modules/kea-forms/lib/index.js"),D=e("./node_modules/antd/es/divider/index.js"),v=e("./node_modules/antd/es/row/index.js"),g=e("./node_modules/antd/es/col/index.js"),V=e("./frontend/src/types.ts"),O=e("./frontend/src/lib/constants.tsx"),F=e("./node_modules/@ant-design/icons/es/icons/PlusOutlined.js"),U=e("./node_modules/antd/lib/upload/Dragger.js"),ae=e.n(U),d=e("./frontend/src/scenes/persons/Persons.tsx"),m=e("./node_modules/core-js/modules/es.array.find-index.js"),c=e("./node_modules/core-js/modules/es.array.iterator.js"),z=e("./node_modules/core-js/modules/es.object.entries.js"),ce=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),se=e("./node_modules/@babel/runtime/regenerator/index.js"),A=e.n(se),N=e("./node_modules/regenerator-runtime/runtime.js"),oe=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),u=e.n(oe),J=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),te=e.n(J),X=e("./frontend/src/lib/api.ts"),K=e("./frontend/src/models/cohortsModel.ts"),k=e("./frontend/src/lib/utils.tsx"),q=e("./frontend/src/scenes/persons/personsLogic.ts"),L=e("./frontend/src/lib/components/lemonToast.tsx"),R=e("./frontend/src/scenes/urls.ts"),re=e("./node_modules/kea-router/lib/index.js");function le(r,o){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);o&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),n.push.apply(n,a)}return n}function h(r){for(var o=1;o<arguments.length;o++){var n=arguments[o]!=null?arguments[o]:{};o%2?le(Object(n),!0).forEach(function(a){Z()(r,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(n,a))})}return r}function G(r){for(var o=h(h({},r),{},{groups:JSON.stringify(r.is_static?[]:r.groups.map(function(x){return h(h({},x),{},{id:void 0,matchType:void 0})}))}),n=new FormData,a=0,i=Object.entries(o);a<i.length;a++){var S=te()(i[a],2),E=S[0],y=S[1];n.append(E,y)}return n}function pe(r){var o=r.action_id||r.event_id?O.f:O.o;return h({matchType:o,id:Math.random().toString().substr(2,5)},r)}function ue(r){return r.groups&&(r.groups=r.groups.map(function(o){return pe(o)}),r.groups=r.groups.map(function(o){return o.properties?h(h({},o),{},{properties:Object(k.s)(o.properties)}):o})),r}var ge=ue({id:"new",groups:[{id:Math.random().toString().substr(2,5),matchType:O.o,properties:[]}]}),Te=Object(w.kea)({props:{},key:function(o){return o.id||"new"},path:function(o){return["scenes","cohorts","cohortLogic",o]},actions:function(){return{saveCohort:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return{cohortParams:n,filterParams:a}},setCohort:function(n){return{cohort:n}},deleteCohort:!0,fetchCohort:function(n){return{id:n}},onCriteriaChange:function(n,a){return{newGroup:n,id:a}},setPollTimeout:function(n){return{pollTimeout:n}},checkIfFinishedCalculating:function(n){return{cohort:n}}}},reducers:function(){return{cohort:[ge,{onCriteriaChange:function(n,a){var i=a.newGroup,S=a.id,E=h({},n),y=E.groups.findIndex(function(x){return x.id===S});return i.matchType?E.groups[y]=h({id:E.groups[y].id,matchType:O.f},i):E.groups[y]=h(h({},E.groups[y]),i),ue(E)}}],pollTimeout:[null,{setPollTimeout:function(n,a){var i=a.pollTimeout;return i}}]}},forms:function(o){var n=o.actions;return{cohort:{defaults:ge,validator:function(i){var S=i.name,E=i.csv,y=i.is_static,x=i.groups;return{name:S?void 0:"You need to set a name",csv:y&&!E?"You need to upload a CSV file":null,groups:y?void 0:!x||x.length<1?[{id:"You need at least one matching group"}]:x==null?void 0:x.map(function(l){var H=l.matchType,Q=l.properties,M=l.action_id,f=l.event_id;return H===O.o&&!(Q!=null&&Q.length)?{id:"Please select at least one property or remove this match group."}:H===O.f&&!(M||f)?{id:"Please select an event or action."}:{id:void 0}})}},submit:function(i){n.saveCohort(i)}}}},loaders:function(o){var n=o.actions,a=o.values,i=o.key;return{cohort:[ge,{setCohort:function(E){var y=E.cohort;return ue(y)},fetchCohort:function(){var S=u()(A.a.mark(function y(x,l){var H,Q;return A.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return H=x.id,f.prev=1,f.next=4,X.b.cohorts.get(H);case 4:return Q=f.sent,l(),K.a.actions.updateCohort(Q),n.checkIfFinishedCalculating(Q),f.abrupt("return",ue(Q));case 11:return f.prev=11,f.t0=f.catch(1),L.a.error(f.t0.detail||"Failed to fetch cohort"),f.abrupt("return",a.cohort);case 15:case"end":return f.stop()}},y,null,[[1,11]])}));function E(y,x){return S.apply(this,arguments)}return E}(),saveCohort:function(){var S=u()(A.a.mark(function y(x,l){var H,Q,M,f;return A.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(H=x.cohortParams,Q=x.filterParams,M=h(h({},a.cohort),H),f=G(M),_.prev=3,M.id==="new"){_.next=11;break}return _.next=7,X.b.cohorts.update(M.id,f,Q);case 7:M=_.sent,K.a.actions.updateCohort(M),_.next=15;break;case 11:return _.next=13,X.b.cohorts.create(f,Q);case 13:M=_.sent,K.a.actions.cohortCreated(M);case 15:_.next=21;break;case 17:return _.prev=17,_.t0=_.catch(3),L.a.error(_.t0.detail||"Failed to save cohort"),_.abrupt("return",a.cohort);case 21:return M.is_calculating=!0,l(),delete M.csv,n.setCohort(M),L.a.success("Cohort saved. Please wait up to a few minutes for it to be calculated",{toastId:"cohort-saved-".concat(i)}),_.abrupt("return",M);case 27:case"end":return _.stop()}},y,null,[[3,17]])}));function E(y,x){return S.apply(this,arguments)}return E}()}]}},selectors:{breadcrumbs:[function(r){return[r.cohort]},function(r){return[{name:"Cohorts",path:R.a.cohorts()}].concat(b()(r?[{name:r.name||"Untitled"}]:[]))}]},listeners:function(o){var n=o.actions,a=o.values;return{deleteCohort:function(){var S;(S=K.a.findMounted())===null||S===void 0||S.actions.deleteCohort(a.cohort),re.router.actions.push(R.a.cohorts())},checkIfFinishedCalculating:function(){var i=u()(A.a.mark(function E(y,x){var l,H;return A.a.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:l=y.cohort,l.is_calculating?n.setPollTimeout(setTimeout(u()(A.a.mark(function f(){var ve;return A.a.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,X.b.cohorts.get(l.id);case 2:ve=P.sent,x(),n.checkIfFinishedCalculating(ve);case 5:case"end":return P.stop()}},f)})),1e3)):(n.setCohort(l),K.a.actions.updateCohort(l),(H=q.a.findMounted({syncWithUrl:!0}))===null||H===void 0||H.actions.loadCohorts(),a.pollTimeout&&(clearTimeout(a.pollTimeout),n.setPollTimeout(null)));case 2:case"end":return M.stop()}},E)}));function S(E,y){return i.apply(this,arguments)}return S}()}},actionToUrl:function(o){var n=o.values;return{saveCohortSuccess:function(){return R.a.cohort(n.cohort.id)}}},events:function(o){var n=o.values,a=o.actions,i=o.props;return{afterMount:function(){var S=u()(A.a.mark(function y(){return A.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:!i.id||i.id==="new"?a.setCohort(ge):a.fetchCohort(i.id);case 1:case"end":return l.stop()}},y)}));function E(){return S.apply(this,arguments)}return E}(),beforeUnmount:function(){n.pollTimeout&&clearTimeout(n.pollTimeout)}}}}),Se=e("./frontend/src/scenes/userLogic.ts"),Fe=e("./node_modules/antd/lib/dropdown/style/index.css"),xe=e("./frontend/src/lib/components/Spinner/Spinner.tsx"),Oe=e("./frontend/src/lib/components/LemonButton/index.ts"),Le=e("./frontend/src/lib/components/PageHeader.tsx"),Me=e("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),Ee=e("./frontend/src/lib/forms/Field.tsx"),De=e("./frontend/src/lib/forms/VerticalForm.tsx"),Ae=e("./frontend/src/lib/components/LemonSelect.tsx"),_e=e("./frontend/src/lib/components/LemonTextArea/LemonTextArea.tsx"),be=e("./frontend/src/lib/components/icons.tsx"),Ie=e("./frontend/src/scenes/cohorts/MatchCriteriaSelector.tsx"),Re=e("./frontend/src/lib/components/Tooltip.tsx"),ye;function je(r,o){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);o&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),n.push.apply(n,a)}return n}function Pe(r){for(var o=1;o<arguments.length;o++){var n=arguments[o]!=null?arguments[o]:{};o%2?je(Object(n),!0).forEach(function(a){Z()(r,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(n,a))})}return r}var Be={component:he,paramsToProps:function(o){var n=o.params.id;return{id:n&&n!=="new"?parseInt(n):"new"}}},We=(ye={},Z()(ye,O.b.Static,{label:"Static \xB7 Updated manually"}),Z()(ye,O.b.Dynamic,{label:"Dynamic \xB7 Updates automatically"}),ye);function he(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=r.id,n={id:o},a=Te(n),i=Object(w.useActions)(a),S=i.deleteCohort,E=i.setCohort,y=i.onCriteriaChange,x=Object(w.useValues)(a),l=x.cohort,H=x.cohortLoading,Q=Object(w.useValues)(Se.a),M=Q.hasAvailableFeature,f=l.id==="new"||l.id===void 0,ve=function(){E(Pe(Pe({},l),{},{groups:[].concat(b()(l.groups),[{id:Math.random().toString().substr(2,5),matchType:O.o,properties:[]}])}))},_=function(Y){E(Pe(Pe({},l),{},{groups:l.groups.filter(function(ne,me){return me!==Y})}))};return t.a.createElement("div",{className:"cohort"},t.a.createElement(De.a,{logic:Te,props:n,formKey:"cohort"},t.a.createElement(Le.a,{title:f?"New cohort":l.name||"Untitled",buttons:t.a.createElement("div",{className:"flex-center"},f?t.a.createElement(Oe.a,{"data-attr":"cancel-cohort",type:"secondary",onClick:function(){re.router.actions.push(R.a.cohorts())},style:{marginRight:8},disabled:H},"Cancel"):t.a.createElement(Oe.a,{"data-attr":"delete-cohort",status:"danger",type:"secondary",onClick:function(){S()},style:{marginRight:8},disabled:H},"Delete"),t.a.createElement(Oe.a,{type:"primary","data-attr":"save-cohort",htmlType:"submit",loading:H},"Save"))}),t.a.createElement(D.a,null),t.a.createElement(v.a,{gutter:[16,24],style:{maxWidth:640}},t.a.createElement(g.a,{xs:24,sm:12},t.a.createElement(Ee.a,{name:"name",label:"Name"},function(P){var Y=P.value,ne=P.onValueChange;return t.a.createElement(Me.a,{value:Y,onChange:ne,"data-attr":"cohort-name"})})),t.a.createElement(g.a,{xs:24,sm:12},t.a.createElement(Ee.a,{name:"is_static",label:"Type"},function(P){var Y=P.value,ne=P.onValueChange;return t.a.createElement(Re.a,{title:f?null:"Create a new cohort to use a different type of cohort."},t.a.createElement("div",null,t.a.createElement(Ae.a,{disabled:!f,options:We,value:Y?O.b.Static:O.b.Dynamic,onChange:function(fe){ne(fe===O.b.Static)},type:"stealth",outlined:!0,style:{width:"100%"},"data-attr":"cohort-type"})))}))),M(V.d.DASHBOARD_COLLABORATION)&&t.a.createElement(v.a,{gutter:[16,24],className:"mt ph-ignore-input",style:{maxWidth:640}},t.a.createElement(g.a,{span:24},t.a.createElement(Ee.a,{name:"description",label:"Description","data-attr":"cohort-description"},function(P){var Y=P.value,ne=P.onValueChange;return t.a.createElement(_e.a,{value:Y,onChange:ne})}))),l.is_static?t.a.createElement(v.a,{gutter:24,className:"mt ph-ignore-input"},t.a.createElement(g.a,{span:24},t.a.createElement(Ee.a,{name:"csv",label:f?"Upload users":"Add users","data-attr":"cohort-csv"},function(P){var Y,ne,me=P.onValueChange;return t.a.createElement(t.a.Fragment,null,t.a.createElement("span",{className:"mb"},"Upload a CSV file to add users to your cohort. The CSV file only requires a single column with the user\u2019s distinct ID."),t.a.createElement(ae.a,{name:"file",multiple:!1,fileList:l.csv?[l.csv]:[],accept:".csv",showUploadList:!1,beforeUpload:function(Ce){return me(Ce),!1},className:"cohort-csv-dragger"},l.csv?t.a.createElement(t.a.Fragment,null,t.a.createElement(be.IconUploadFile,{style:{fontSize:"3rem",color:"var(--muted-alt)"}}),t.a.createElement("div",{className:"ant-upload-text"},(Y=(ne=l.csv)===null||ne===void 0?void 0:ne.name)!==null&&Y!==void 0?Y:"File chosen")):t.a.createElement(t.a.Fragment,null,t.a.createElement(be.IconUploadFile,{style:{fontSize:"3rem",color:"var(--muted-alt)"}}),t.a.createElement("div",{className:"ant-upload-text"},"Drag a file here or click to browse for a file"))))}))):t.a.createElement(t.a.Fragment,null,t.a.createElement(D.a,null),t.a.createElement(v.a,{gutter:24,className:"mt"},t.a.createElement(g.a,{span:24},t.a.createElement(t.a.Fragment,null,t.a.createElement("div",{className:"ant-row ant-form-item ant-form-item-label",style:{display:"flex"}},t.a.createElement("label",{htmlFor:"groups",title:"Matching criteria"},"Matching criteria"),t.a.createElement("span",null,"Actors who match the following criteria will be part of the cohort. Continuously updated automatically.")),l.groups.map(function(P,Y){return t.a.createElement(j.Group,{key:Y,name:["groups",Y]},t.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"}},t.a.createElement(j.Field,{name:"id",template:function(me){var fe=me.error,Ce=me.kids;return t.a.createElement("div",{style:{padding:15,border:fe?"1px solid var(--danger)":"1px solid rgba(0, 0, 0, 0.1)",borderRadius:4,width:"100%"}},Ce,t.a.createElement(v.a,null,fe&&t.a.createElement("div",{style:{color:"var(--danger)",marginTop:16}},fe)))}},t.a.createElement(Ie.b,{onCriteriaChange:function(me){return y(me,P.id)},onRemove:function(){return _(Y)},group:P,hideRemove:l.groups.length===1})),Y<l.groups.length-1&&t.a.createElement("div",{className:"stateful-badge or mt mb"},"OR")))})),t.a.createElement("span",{id:"add"}),t.a.createElement("div",{style:{marginTop:8,marginBottom:8}},t.a.createElement("a",{href:"#add",style:{padding:0},onClick:function(){return ve()},"data-attr":"add-match-criteria"},t.a.createElement(F.a,null)," Add matching criteria"))))),!f&&t.a.createElement(t.a.Fragment,null,t.a.createElement(D.a,null),t.a.createElement("div",null,t.a.createElement("h3",{className:"l3"},"Persons in this cohort"),l.is_calculating?t.a.createElement("div",{className:"cohort-recalculating flex-center"},t.a.createElement(xe.a,{size:"sm",style:{marginRight:4}}),"We're recalculating who belongs to this cohort. This could take up to a couple of minutes."):t.a.createElement("div",{style:{marginTop:15}},t.a.createElement(d.Persons,{cohort:l}))))))}try{he.displayName="Cohort",he.__docgenInfo={description:"",displayName:"Cohort",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:'number | "new"'}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/cohorts/Cohort.tsx#Cohort"]={docgenInfo:he.__docgenInfo,name:"Cohort",path:"frontend/src/scenes/cohorts/Cohort.tsx#Cohort"})}catch(r){}},"./frontend/src/scenes/groups/groupsListLogic.ts":function(ie,C,e){"use strict";e.d(C,"a",function(){return ae});var T=e("./node_modules/core-js/modules/es.array.concat.js"),s=e.n(T),B=e("./node_modules/core-js/modules/es.array.iterator.js"),I=e.n(B),$=e("./node_modules/core-js/modules/es.object.to-string.js"),de=e.n($),ee=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),b=e.n(ee),W=e("./node_modules/@babel/runtime/regenerator/index.js"),Z=e.n(W),p=e("./node_modules/regenerator-runtime/runtime.js"),t=e.n(p),w=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),j=e.n(w),D=e("./node_modules/kea/lib/index.esm.js"),v=e("./frontend/src/lib/api.ts"),g=e("./frontend/src/lib/introductions/groupsAccessLogic.ts"),V=e("./frontend/src/lib/utils.tsx"),O=e("./frontend/src/scenes/teamLogic.ts"),F=e("./frontend/src/scenes/urls.ts"),U=e("./frontend/src/models/groupsModel.ts"),ae=Object(D.kea)({path:["groups","groupsListLogic"],connect:{values:[O.a,["currentTeamId"],U.a,["groupTypes","aggregationLabel"],g.b,["groupsEnabled"]]},actions:function(){return{loadGroups:function(c){return{url:c}},setTab:function(c){return{tab:c}}}},loaders:function(m){var c=m.values;return{groups:[{next:null,previous:null,results:[]},{loadGroups:function(){var z=j()(Z.a.mark(function se(A){var N;return Z.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(N=A.url,!c.groupsEnabled){u.next=6;break}return N=N||"api/projects/".concat(c.currentTeamId,"/groups/?group_type_index=").concat(c.currentTab),u.next=5,v.b.get(N);case 5:return u.abrupt("return",u.sent);case 6:case"end":return u.stop()}},se)}));function ce(se){return z.apply(this,arguments)}return ce}()}]}},reducers:{currentTab:["-1",{setTab:function(m,c){var z=c.tab;return z}}]},selectors:{currentTabName:[function(d){return[d.currentTab,d.groupTypes,d.aggregationLabel]},function(d,m,c){return d==="-1"?"Persons":m!=null&&m.length?Object(V.j)(c(parseInt(d)).singular):""}],breadcrumbs:[function(d){return[d.currentTabName,d.currentTab]},function(d,m){return[{name:d,path:F.a.groups(m)}]}]},actionToUrl:function(){return{setTab:function(c){var z=c.tab;return z!=="-1"?F.a.groups(z):F.a.persons()}}},urlToAction:function(m){var c=m.actions,z=m.values;return{"/groups/:id":function(se){var A=se.id;A&&(c.setTab(A),c.loadGroups())},"/persons":function(){z.currentTab!=="-1"&&c.setTab("-1")}}}})},"./frontend/src/scenes/persons/PersonPageHeader.tsx":function(ie,C,e){"use strict";e.d(C,"a",function(){return j});var T=e("./node_modules/kea/lib/index.esm.js"),s=e("./frontend/src/lib/components/PageHeader.tsx"),B=e("./node_modules/react/index.js"),I=e.n(B),$=e("./node_modules/core-js/modules/es.array.includes.js"),de=e("./node_modules/core-js/modules/es.array.map.js"),ee=e("./node_modules/core-js/modules/es.string.includes.js"),b=e("./node_modules/antd/es/tabs/index.js"),W=e("./frontend/src/lib/introductions/groupsAccessLogic.ts"),Z=e("./frontend/src/lib/utils.tsx"),p=e("./frontend/src/models/groupsModel.ts"),t=e("./frontend/src/scenes/groups/groupsListLogic.ts");function w(){var D=Object(T.useActions)(t.a),v=D.setTab,g=Object(T.useValues)(t.a),V=g.currentTab,O=Object(T.useValues)(p.a),F=O.groupTypes,U=O.aggregationLabel,ae=Object(T.useValues)(W.b),d=ae.groupsAccessStatus,m=[W.a.HasAccess,W.a.HasGroupTypes,W.a.NoAccess].includes(d);return I.a.createElement(b.a,{activeKey:V,onChange:function(z){return v(z)}},I.a.createElement(b.a.TabPane,{tab:"Persons",key:"-1"}),m?I.a.createElement(b.a.TabPane,{tab:"Introducing Group Analytics",key:"0"}):F.map(function(c){return I.a.createElement(b.a.TabPane,{tab:Object(Z.j)(U(c.group_type_index).plural),key:c.group_type_index})}))}function j(D){var v=D.hideGroupTabs,g=Object(T.useValues)(p.a),V=g.showGroupsOptions;return I.a.createElement(I.a.Fragment,null,I.a.createElement(s.a,{title:"Persons".concat(V?" & Groups":""),caption:"A catalog of your product's end users".concat(V?" and groups":"",".")}),!v&&V&&I.a.createElement(w,null))}try{j.displayName="PersonPageHeader",j.__docgenInfo={description:"",displayName:"PersonPageHeader",props:{hideGroupTabs:{defaultValue:null,description:"",name:"hideGroupTabs",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"]={docgenInfo:j.__docgenInfo,name:"PersonPageHeader",path:"frontend/src/scenes/persons/PersonPageHeader.tsx#PersonPageHeader"})}catch(D){}},"./frontend/src/scenes/persons/Persons.scss":function(ie,C,e){"use strict";var T=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),s=e.n(T),B=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/persons/Persons.scss"),I=e.n(B),$={};$.insert="head",$.singleton=!1;var de=s()(I.a,$),ee=I.a.locals||{}},"./frontend/src/scenes/persons/Persons.tsx":function(ie,C,e){"use strict";e.r(C),e.d(C,"scene",function(){return N}),e.d(C,"Persons",function(){return oe});var T=e("./node_modules/react/index.js"),s=e.n(T),B=e("./node_modules/kea/lib/index.esm.js"),I=e("./node_modules/core-js/modules/es.array.concat.js"),$=e("./node_modules/core-js/modules/es.object.keys.js"),de=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),ee=e.n(de),b=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),W=e("./frontend/src/lib/components/PropertiesTable.tsx"),Z=e("./frontend/src/scenes/persons/Persons.scss"),p=e("./frontend/src/lib/components/CopyToClipboard.tsx"),t=e("./frontend/src/scenes/persons/PersonHeader.tsx"),w=e("./frontend/src/lib/components/LemonTable/index.ts");function j(u){var J=u.people,te=u.loading,X=te===void 0?!1:te,K=u.hasPrevious,k=u.hasNext,q=u.loadPrevious,L=u.loadNext,R=u.compact,re=[{title:"Person",key:"person",render:function(h,G){return s.a.createElement(t.a,{withIcon:!0,person:G})}},{title:"ID",key:"id",render:function(h,G){return s.a.createElement("div",{style:{overflow:"hidden"}},G.distinct_ids.length&&s.a.createElement(p.a,{explicitValue:G.distinct_ids[0],iconStyle:{color:"var(--primary)"},description:"person distinct ID"},G.distinct_ids[0]))}}].concat(ee()(R?[]:[{title:"First seen",dataIndex:"created_at",render:function(h){return h?s.a.createElement(b.b,{time:h}):s.a.createElement(s.a.Fragment,null)}}]));return s.a.createElement(w.a,{columns:re,loading:X,rowKey:"id",pagination:{controlled:!0,pageSize:100,onForward:k?function(){L==null||L(),window.scrollTo(0,0)}:void 0,onBackward:K?function(){q==null||q(),window.scrollTo(0,0)}:void 0},expandable:{expandedRowRender:function(h){var G=h.properties;return Object.keys(G).length?s.a.createElement(W.a,{properties:G}):"This person has no properties."}},dataSource:J,emptyState:"No persons",nouns:["person","persons"]})}try{j.displayName="PersonsTable",j.__docgenInfo={description:"",displayName:"PersonsTable",props:{people:{defaultValue:null,description:"",name:"people",required:!0,type:{name:"PersonType[]"}},loading:{defaultValue:{value:"false"},description:"",name:"loading",required:!1,type:{name:"boolean"}},hasPrevious:{defaultValue:null,description:"",name:"hasPrevious",required:!1,type:{name:"boolean"}},hasNext:{defaultValue:null,description:"",name:"hasNext",required:!1,type:{name:"boolean"}},loadPrevious:{defaultValue:null,description:"",name:"loadPrevious",required:!1,type:{name:"(() => void)"}},loadNext:{defaultValue:null,description:"",name:"loadNext",required:!1,type:{name:"(() => void)"}},compact:{defaultValue:null,description:"",name:"compact",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"]={docgenInfo:j.__docgenInfo,name:"PersonsTable",path:"frontend/src/scenes/persons/PersonsTable.tsx#PersonsTable"})}catch(u){}var D=e("./node_modules/antd/es/row/index.js"),v=e("./node_modules/antd/es/popconfirm/index.js"),g=e("./frontend/src/scenes/persons/personsLogic.ts"),V=e("./node_modules/core-js/modules/es.regexp.exec.js"),O=e("./node_modules/core-js/modules/es.string.search.js"),F=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),U=e.n(F),ae=e("./node_modules/antd/es/input/index.js"),d=e("./frontend/src/lib/components/LemonRow/index.ts"),m=e("./frontend/src/lib/components/icons.tsx"),c=function(J){var te=J.autoFocus,X=te===void 0?!0:te,K=Object(B.useActions)(g.a),k=K.loadPersons,q=K.setListFilters,L=Object(B.useValues)(g.a),R=L.listFilters,re=Object(T.useState)(""),le=U()(re,2),h=le[0],G=le[1];return Object(T.useEffect)(function(){G(R.search||"")},[]),s.a.createElement("div",{style:{display:"flex",alignItems:"center",width:"min(100%, 24rem)"}},s.a.createElement(ae.a.Search,{"data-attr":"persons-search",placeholder:"Search for persons",autoFocus:X,value:h,onChange:function(ue){G(ue.target.value),ue.target.value||(q({search:void 0}),k())},enterButton:!0,onPressEnter:function(ue){ue.preventDefault(),q({search:h||void 0}),k()},allowClear:!0,onSearch:function(){q({search:h||void 0}),k()},style:{width:"100%"}}),s.a.createElement(d.a,{className:"ml-05",type:"stealth",tooltip:s.a.createElement(s.a.Fragment,null,"Search by email, name, ID, or even contents of properties. You can also search for persons who just ",s.a.createElement("i",null,"have"),' a property like so: "has:your_property".'),icon:s.a.createElement(m.IconInfo,null)}))};try{c.displayName="PersonsSearch",c.__docgenInfo={description:"",displayName:"PersonsSearch",props:{autoFocus:{defaultValue:{value:"true"},description:"",name:"autoFocus",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/PersonsSearch.tsx#PersonsSearch"]={docgenInfo:c.__docgenInfo,name:"PersonsSearch",path:"frontend/src/scenes/persons/PersonsSearch.tsx#PersonsSearch"})}catch(u){}var z=e("./frontend/src/scenes/persons/PersonPageHeader.tsx"),ce=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),se=e("./frontend/src/lib/components/TaxonomicFilter/types.ts"),A=e("./frontend/src/lib/components/LemonButton/index.ts"),N={component:oe,logic:g.a,paramsToProps:function(){return{syncWithUrl:!0}}};function oe(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},J=u.cohort,te={cohort:J==null?void 0:J.id,syncWithUrl:!J},X=Object(B.useActions)(Object(g.a)(te)),K=X.loadPersons,k=X.setListFilters,q=X.exportCsv,L=Object(B.useValues)(Object(g.a)(te)),R=L.persons,re=L.listFilters,le=L.personsLoading,h=L.exportUrl;return s.a.createElement(B.BindLogic,{logic:g.a,props:te},s.a.createElement("div",{className:"persons-list"},!J&&s.a.createElement(z.a,null),s.a.createElement(D.a,{align:"middle",justify:"space-between",className:"mb-05",style:{gap:"0.75rem"}},s.a.createElement(c,{autoFocus:!J}),s.a.createElement("div",null,s.a.createElement(v.a,{placement:"topRight",title:s.a.createElement(s.a.Fragment,null,"Exporting by csv is limited to 10,000 users.",s.a.createElement("br",null),"To return more, please use"," ",s.a.createElement("a",{href:"https://posthog.com/docs/api/persons"},"the API"),". Do you want to export by CSV?"),onConfirm:q},h&&s.a.createElement(A.a,{type:"secondary",icon:s.a.createElement(m.IconExport,{style:{color:"var(--primary)"}})},re.properties&&re.properties.length>0?s.a.createElement("div",{style:{display:"block"}},"Export (",s.a.createElement("strong",null,re.properties.length)," filter)"):"Export")))),s.a.createElement(ce.a,{pageKey:"persons-list-page",propertyFilters:re.properties,onChange:function(pe){k({properties:pe}),K()},endpoint:"person",taxonomicGroupTypes:[se.a.PersonProperties,se.a.Cohorts],showConditionBadge:!0}),s.a.createElement(j,{people:R.results,loading:le,hasPrevious:!!R.previous,hasNext:!!R.next,loadPrevious:function(){return K(R.previous)},loadNext:function(){return K(R.next)}})))}try{oe.displayName="Persons",oe.__docgenInfo={description:"",displayName:"Persons",props:{cohort:{defaultValue:null,description:"",name:"cohort",required:!1,type:{name:"CohortType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/persons/Persons.tsx#Persons"]={docgenInfo:oe.__docgenInfo,name:"Persons",path:"frontend/src/scenes/persons/Persons.tsx#Persons"})}catch(u){}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/persons/Persons.scss":function(ie,C,e){var T=e("./node_modules/css-loader/dist/runtime/api.js");C=T(!1),C.push([ie.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.extra-ids{display:inline-flex;align-items:center;height:1.25rem;line-height:1.125rem;margin:0 0 0 .25rem;padding:0 .25rem 0 .375rem;color:#5375ff;cursor:pointer}.extra-ids svg{margin-left:.25rem}",""]),ie.exports=C}}]);
