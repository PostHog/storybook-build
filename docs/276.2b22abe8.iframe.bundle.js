(window.webpackJsonp=window.webpackJsonp||[]).push([[276],{"./frontend/src/scenes/dashboard/NewDashboardModal.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DashboardTemplateChooser})),__webpack_require__.d(__webpack_exports__,"b",(function(){return NewDashboardModal_NewDashboardModal}));var index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),newDashboardLogic=__webpack_require__("./frontend/src/scenes/dashboard/newDashboardLogic.ts"),LemonModal=__webpack_require__("./frontend/src/lib/lemon-ui/LemonModal/index.ts"),dashboardTemplatesLogic=__webpack_require__("./frontend/src/scenes/dashboard/dashboards/templates/dashboardTemplatesLogic.tsx"),src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),ActionFilter=__webpack_require__("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilter.tsx"),types=__webpack_require__("./frontend/src/types.ts");const dashboardTemplateVariablesLogic=Object(index_esm.kea)([Object(index_esm.path)(["scenes","dashboard","DashboardTemplateVariablesLogic"]),Object(index_esm.props)({variables:[]}),Object(index_esm.actions)({setVariables:variables=>({variables:variables}),setVariable:(variableName,filterGroup)=>({variable_name:variableName,filterGroup:filterGroup})}),Object(index_esm.reducers)({variables:[[],{setVariables:(_,_ref)=>{let{variables:variables}=_ref;return variables},setVariable:(state,_ref2)=>{let{variable_name:variableName,filterGroup:filterGroup}=_ref2;return state.map((v=>{var _filterGroup$events;return v.name===variableName&&null!=filterGroup&&null!==(_filterGroup$events=filterGroup.events)&&void 0!==_filterGroup$events&&_filterGroup$events.length&&filterGroup.events[0]?{...v,default:filterGroup.events[0]}:v}))}}]}),Object(index_esm.propsChanged)(((_ref3,oldProps)=>{let{actions:actions,props:props}=_ref3;props.variables!==oldProps.variables&&actions.setVariables(props.variables)}))]);var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function DashboardTemplateVariables(){const{activeDashboardTemplate:activeDashboardTemplate}=Object(index_esm.useValues)(newDashboardLogic.a),theDashboardTemplateVariablesLogic=dashboardTemplateVariablesLogic({variables:(null==activeDashboardTemplate?void 0:activeDashboardTemplate.variables)||[]}),{variables:variables}=Object(index_esm.useValues)(theDashboardTemplateVariablesLogic),{setVariable:setVariable}=Object(index_esm.useActions)(theDashboardTemplateVariablesLogic),FALLBACK_EVENT={id:"$pageview",math:"dau",type:"events"};return Object(jsx_runtime.jsx)("div",{className:"mb-4 DashboardTemplateVariables max-w-md",children:variables.map(((variable,index)=>Object(jsx_runtime.jsxs)("div",{className:"mb-6",children:[Object(jsx_runtime.jsxs)("div",{className:"mb-2",children:[Object(jsx_runtime.jsx)(src.LemonLabel,{showOptional:!variable.required,children:variable.name}),Object(jsx_runtime.jsx)("p",{className:"text-sm text-muted",children:variable.description})]}),Object(jsx_runtime.jsx)("div",{children:Object(jsx_runtime.jsx)(ActionFilter.a,{filters:{insight:types.G.TRENDS,events:variable.default?[variable.default]:[FALLBACK_EVENT]},setFilters:filters=>{setVariable(variable.name,filters)},typeKey:"variable_"+variable.name,buttonCopy:"",hideDeleteBtn:!0,hideRename:!0,hideDuplicate:!0,entitiesLimit:1})})]},index)))})}var react=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),utils=__webpack_require__("./frontend/src/lib/utils.tsx"),blank_dashboard_hog=__webpack_require__("./frontend/public/blank-dashboard-hog.png"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/.pnpm/style-loader@2.0.0_webpack@4.46.0/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),NewDashboardModal=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@4.46.0/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/NewDashboardModal.scss"),NewDashboardModal_default=__webpack_require__.n(NewDashboardModal),options={insert:"head",singleton:!1},FallbackCoverImage=(injectStylesIntoStyleTag_default()(NewDashboardModal_default.a,options),NewDashboardModal_default.a.locals,__webpack_require__("./frontend/src/lib/components/FallbackCoverImage/FallbackCoverImage.tsx")),clsx_m=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js");function TemplateItem(_ref){var _template$dashboard_d;let{template:template,onClick:onClick,index:index,"data-attr":dataAttr}=_ref;const[isHovering,setIsHovering]=Object(react.useState)(!1);return Object(jsx_runtime.jsxs)("div",{className:"cursor-pointer border rounded TemplateItem flex flex-col transition-all",onClick:onClick,onMouseEnter:()=>setIsHovering(!0),onMouseLeave:()=>setIsHovering(!1),"data-attr":dataAttr,children:[Object(jsx_runtime.jsx)("div",{className:Object(clsx_m.default)("transition-all w-full overflow-hidden",isHovering?"h-4 min-h-4":"h-30 min-h-30"),children:Object(jsx_runtime.jsx)(FallbackCoverImage.a,{src:null==template?void 0:template.image_url,alt:"cover photo",index:index,imageClassName:"h-30"})}),Object(jsx_runtime.jsx)("h5",{className:"px-2 mb-1",children:null==template?void 0:template.template_name}),Object(jsx_runtime.jsx)("div",{className:"px-2 py-1 overflow-y-auto grow",children:Object(jsx_runtime.jsx)("p",{className:Object(clsx_m.default)("text-muted-alt text-xs",isHovering?"":"line-clamp-2"),children:null!==(_template$dashboard_d=null==template?void 0:template.dashboard_description)&&void 0!==_template$dashboard_d?_template$dashboard_d:" "})})]})}function DashboardTemplatePreview(){const{activeDashboardTemplate:activeDashboardTemplate,variableSelectModalVisible:variableSelectModalVisible}=Object(index_esm.useValues)(newDashboardLogic.a),{variables:variables}=Object(index_esm.useValues)(dashboardTemplateVariablesLogic),{createDashboardFromTemplate:createDashboardFromTemplate,clearActiveDashboardTemplate:clearActiveDashboardTemplate}=Object(index_esm.useActions)(newDashboardLogic.a);return Object(jsx_runtime.jsxs)("div",{children:[Object(jsx_runtime.jsx)(DashboardTemplateVariables,{}),Object(jsx_runtime.jsxs)("div",{className:"flex justify-between my-4",children:[variableSelectModalVisible?Object(jsx_runtime.jsx)("div",{}):Object(jsx_runtime.jsx)(src.LemonButton,{onClick:clearActiveDashboardTemplate,type:"secondary",children:"Back"}),Object(jsx_runtime.jsx)(src.LemonButton,{onClick:()=>{activeDashboardTemplate&&createDashboardFromTemplate(activeDashboardTemplate,variables)},type:"primary",children:"Create"})]})]})}function DashboardTemplateChooser(_ref2){let{scope:scope="global"}=_ref2;const templatesLogic=Object(dashboardTemplatesLogic.a)({scope:scope}),{allTemplates:allTemplates}=Object(index_esm.useValues)(templatesLogic),{isLoading:isLoading,newDashboardModalVisible:newDashboardModalVisible}=Object(index_esm.useValues)(newDashboardLogic.a),{setActiveDashboardTemplate:setActiveDashboardTemplate,createDashboardFromTemplate:createDashboardFromTemplate,addDashboard:addDashboard,setIsLoading:setIsLoading,showVariableSelectModal:showVariableSelectModal}=Object(index_esm.useActions)(newDashboardLogic.a);return Object(jsx_runtime.jsx)("div",{children:Object(jsx_runtime.jsxs)("div",{className:"DashboardTemplateChooser",children:[Object(jsx_runtime.jsx)(TemplateItem,{template:{template_name:"Blank dashboard",dashboard_description:"Create a blank dashboard",image_url:blank_dashboard_hog.a},onClick:()=>{isLoading||(setIsLoading(!0),addDashboard({name:"New Dashboard",show:!0}))},index:0,"data-attr":"create-dashboard-blank"}),allTemplates.map(((template,index)=>Object(jsx_runtime.jsx)(TemplateItem,{template:template,onClick:()=>{isLoading||(setIsLoading(!0),0===(template.variables||[]).length?(null===template.variables&&(template.variables=[]),createDashboardFromTemplate(template,template.variables||[])):newDashboardModalVisible?setActiveDashboardTemplate(template):showVariableSelectModal(template))},index:index+1,"data-attr":"create-dashboard-from-template"},index)))]})})}function NewDashboardModal_NewDashboardModal(){const builtLogic=Object(index_esm.useMountedLogic)(newDashboardLogic.a),{hideNewDashboardModal:hideNewDashboardModal}=Object(index_esm.useActions)(newDashboardLogic.a),{newDashboardModalVisible:newDashboardModalVisible,activeDashboardTemplate:activeDashboardTemplate}=Object(index_esm.useValues)(newDashboardLogic.a),_dashboardTemplateChooser=builtLogic.props.featureFlagId?Object(jsx_runtime.jsx)(DashboardTemplateChooser,{scope:"feature_flag"}):Object(jsx_runtime.jsx)(DashboardTemplateChooser,{});return Object(jsx_runtime.jsx)(LemonModal.a,{onClose:hideNewDashboardModal,isOpen:newDashboardModalVisible,title:activeDashboardTemplate?"Setup your events":"Create a dashboard",description:activeDashboardTemplate?`The dashboard template you selected requires you to set up ${Object(utils.xb)((activeDashboardTemplate.variables||[]).length,"event","events",!0)}.`:"Choose a template or start with a blank slate",children:Object(jsx_runtime.jsx)("div",{className:"NewDashboardModal",children:activeDashboardTemplate?Object(jsx_runtime.jsx)(DashboardTemplatePreview,{}):_dashboardTemplateChooser})})}try{DashboardTemplateChooser.displayName="DashboardTemplateChooser",DashboardTemplateChooser.__docgenInfo={description:"",displayName:"DashboardTemplateChooser",props:{scope:{defaultValue:{value:"global"},description:"",name:"scope",required:!1,type:{name:"enum",value:[{value:'"team"'},{value:'"feature_flag"'},{value:'"global"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/NewDashboardModal.tsx#DashboardTemplateChooser"]={docgenInfo:DashboardTemplateChooser.__docgenInfo,name:"DashboardTemplateChooser",path:"frontend/src/scenes/dashboard/NewDashboardModal.tsx#DashboardTemplateChooser"})}catch(__react_docgen_typescript_loader_error){}},"./frontend/src/scenes/insights/Insight.scss":function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_pnpm_style_loader_2_0_0_webpack_4_46_0_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/style-loader@2.0.0_webpack@4.46.0/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),_node_modules_pnpm_style_loader_2_0_0_webpack_4_46_0_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_style_loader_2_0_0_webpack_4_46_0_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_3_6_0_webpack_4_46_0_node_modules_css_loader_dist_cjs_js_node_modules_pnpm_postcss_loader_4_3_0_postcss_8_4_18_webpack_4_46_0_node_modules_postcss_loader_dist_cjs_js_node_modules_pnpm_sass_loader_10_3_1_sass_1_56_0_webpack_4_46_0_node_modules_sass_loader_dist_cjs_js_ref_6_3_Insight_scss__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@4.46.0/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/Insight.scss"),_node_modules_pnpm_css_loader_3_6_0_webpack_4_46_0_node_modules_css_loader_dist_cjs_js_node_modules_pnpm_postcss_loader_4_3_0_postcss_8_4_18_webpack_4_46_0_node_modules_postcss_loader_dist_cjs_js_node_modules_pnpm_sass_loader_10_3_1_sass_1_56_0_webpack_4_46_0_node_modules_sass_loader_dist_cjs_js_ref_6_3_Insight_scss__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_node_modules_pnpm_css_loader_3_6_0_webpack_4_46_0_node_modules_css_loader_dist_cjs_js_node_modules_pnpm_postcss_loader_4_3_0_postcss_8_4_18_webpack_4_46_0_node_modules_postcss_loader_dist_cjs_js_node_modules_pnpm_sass_loader_10_3_1_sass_1_56_0_webpack_4_46_0_node_modules_sass_loader_dist_cjs_js_ref_6_3_Insight_scss__WEBPACK_IMPORTED_MODULE_1__),options={insert:"head",singleton:!1};_node_modules_pnpm_style_loader_2_0_0_webpack_4_46_0_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default()(_node_modules_pnpm_css_loader_3_6_0_webpack_4_46_0_node_modules_css_loader_dist_cjs_js_node_modules_pnpm_postcss_loader_4_3_0_postcss_8_4_18_webpack_4_46_0_node_modules_postcss_loader_dist_cjs_js_node_modules_pnpm_sass_loader_10_3_1_sass_1_56_0_webpack_4_46_0_node_modules_sass_loader_dist_cjs_js_ref_6_3_Insight_scss__WEBPACK_IMPORTED_MODULE_1___default.a,options),_node_modules_pnpm_css_loader_3_6_0_webpack_4_46_0_node_modules_css_loader_dist_cjs_js_node_modules_pnpm_postcss_loader_4_3_0_postcss_8_4_18_webpack_4_46_0_node_modules_postcss_loader_dist_cjs_js_node_modules_pnpm_sass_loader_10_3_1_sass_1_56_0_webpack_4_46_0_node_modules_sass_loader_dist_cjs_js_ref_6_3_Insight_scss__WEBPACK_IMPORTED_MODULE_1___default.a.locals},"./frontend/src/scenes/insights/InsightScene.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"InsightScene",(function(){return InsightScene})),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene}));var insightSceneLogic=__webpack_require__("./frontend/src/scenes/insights/insightSceneLogic.tsx"),index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@16.14.0/node_modules/kea/lib/index.esm.js"),react=(__webpack_require__("./frontend/src/scenes/insights/Insight.scss"),__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js")),insightLogic=__webpack_require__("./frontend/src/scenes/insights/insightLogic.ts"),commandPaletteLogic=__webpack_require__("./frontend/src/lib/components/CommandPalette/commandPaletteLogic.tsx"),compareFilterLogic=__webpack_require__("./frontend/src/lib/components/CompareFilter/compareFilterLogic.ts"),RiseOutlined=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/icons/RiseOutlined.js"),utils=__webpack_require__("./frontend/src/lib/utils.tsx"),sharedUtils=__webpack_require__("./frontend/src/scenes/insights/sharedUtils.ts"),insightDateFilterLogic=__webpack_require__("./frontend/src/scenes/insights/filters/InsightDateFilter/insightDateFilterLogic.ts");const insightCommandLogic=Object(index_esm.kea)([Object(index_esm.props)({}),Object(index_esm.key)(Object(sharedUtils.k)("new")),Object(index_esm.path)((key=>["scenes","insights","insightCommandLogic",key])),Object(index_esm.connect)((props=>[commandPaletteLogic.a,Object(compareFilterLogic.a)(props),Object(insightDateFilterLogic.a)(props)])),Object(index_esm.events)((_ref=>{let{props:props}=_ref;return{afterMount:()=>{const funnelCommands=[{key:"insight-graph",resolver:[{icon:RiseOutlined.a,display:'Toggle "Compare Previous" on Graph',executor:()=>{Object(compareFilterLogic.a)(props).actions.toggleCompare()}},...utils.u.map((_ref2=>{let{key:key,values:values}=_ref2;return{icon:RiseOutlined.a,display:`Set Time Range to ${key}`,executor:()=>{Object(insightDateFilterLogic.a)(props).actions.setDates(values[0],values[1])}}}))],scope:"insights"}];for(const command of funnelCommands)commandPaletteLogic.a.actions.registerCommand(command)},beforeUnmount:()=>{commandPaletteLogic.a.actions.deregisterScope("insights")}}}))]);var insightDataLogic=__webpack_require__("./frontend/src/scenes/insights/insightDataLogic.ts"),types=__webpack_require__("./frontend/src/types.ts"),Tooltip=__webpack_require__("./frontend/src/lib/lemon-ui/Tooltip.tsx"),featureFlagLogic=(__webpack_require__("./node_modules/.pnpm/core-js@3.15.2/node_modules/core-js/modules/es.regexp.flags.js"),__webpack_require__("./frontend/src/lib/logic/featureFlagLogic.ts")),es=__webpack_require__("./node_modules/.pnpm/posthog-js@1.68.4/node_modules/posthog-js/dist/es.js"),constants=__webpack_require__("./frontend/src/lib/constants.tsx");const funnelsCueLogic=Object(index_esm.kea)([Object(index_esm.props)({}),Object(index_esm.key)(Object(sharedUtils.k)("new")),Object(index_esm.path)((key=>["scenes","insights","InsightTabs","TrendTab","FunnelsCue",key])),Object(index_esm.connect)((props=>({values:[Object(insightLogic.c)(props),["filters","isFirstLoad"],featureFlagLogic.a,["featureFlags"]],actions:[Object(insightLogic.c)(props),["setFilters"],featureFlagLogic.a,["setFeatureFlags"]]}))),Object(index_esm.actions)({optOut:userOptedOut=>({userOptedOut:userOptedOut}),setShouldShow:show=>({show:show}),setPermanentOptOut:!0}),Object(index_esm.reducers)({_shouldShow:[!1,{setShouldShow:(_,_ref)=>{let{show:show}=_ref;return show}}],permanentOptOut:[!1,{setPermanentOptOut:()=>!0}]}),Object(index_esm.listeners)((_ref2=>{let{actions:actions,values:values}=_ref2;return{optOut:async _ref3=>{let{userOptedOut:userOptedOut}=_ref3;es.b.capture("funnel cue 7301 - terminated",{user_opted_out:userOptedOut}),es.b.people.set({funnels_cue_3701_opt_out:!0}),actions.setPermanentOptOut()},setFilters:async _ref4=>{var _filters$events$lengt,_filters$events,_filters$actions$leng,_filters$actions;let{filters:filters}=_ref4;const step_count=(null!==(_filters$events$lengt=null===(_filters$events=filters.events)||void 0===_filters$events?void 0:_filters$events.length)&&void 0!==_filters$events$lengt?_filters$events$lengt:0)+(null!==(_filters$actions$leng=null===(_filters$actions=filters.actions)||void 0===_filters$actions?void 0:_filters$actions.length)&&void 0!==_filters$actions$leng?_filters$actions$leng:0);!values.isFirstLoad&&filters.insight===types.G.TRENDS&&step_count>=3?(actions.setShouldShow(!0),!values.permanentOptOut&&es.b.capture("funnel cue 7301 - shown",{step_count:step_count})):values.shown&&filters.insight===types.G.FUNNELS?actions.optOut(!1):actions.setShouldShow(!1)},setFeatureFlags:async _ref5=>{let{flags:flags}=_ref5;flags[constants.i.FUNNELS_CUE_OPT_OUT]&&actions.setPermanentOptOut()}}})),Object(index_esm.selectors)({shown:[s=>[s._shouldShow,s.permanentOptOut],(shouldShow,permanentOptout)=>shouldShow&&!permanentOptout]}),Object(index_esm.events)((_ref6=>{let{actions:actions,values:values}=_ref6;return{afterMount:async()=>{values.featureFlags[constants.i.FUNNELS_CUE_OPT_OUT]&&actions.setPermanentOptOut()}}}))]);var urls=__webpack_require__("./frontend/src/scenes/urls.ts"),LemonBanner=__webpack_require__("./frontend/src/lib/lemon-ui/LemonBanner/index.ts"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function FunnelsCue(){const{insightProps:insightProps}=Object(index_esm.useValues)(insightLogic.c),{optOut:optOut}=Object(index_esm.useActions)(funnelsCueLogic(insightProps)),{shown:shown}=Object(index_esm.useValues)(funnelsCueLogic(insightProps));return shown?Object(jsx_runtime.jsx)(LemonBanner.a,{type:"info",action:{to:urls.a.insightNew({insight:types.G.FUNNELS}),status:"primary",children:"Try this insight as a funnel"},onClose:()=>optOut(!0),className:"mb-4",children:"Looks like you have multiple events. A funnel can help better visualize your user’s progression across each event."}):null}var SavedInsights=__webpack_require__("./frontend/src/scenes/saved-insights/SavedInsights.tsx"),Link=__webpack_require__("./frontend/src/lib/lemon-ui/Link/index.ts"),LemonTabs=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTabs/index.ts"),insightNavLogic=__webpack_require__("./frontend/src/scenes/insights/InsightNav/insightNavLogic.tsx"),insights_utils=__webpack_require__("./frontend/src/scenes/insights/utils.tsx");function InsightsNav(){const{insightProps:insightProps}=Object(index_esm.useValues)(insightLogic.c),{activeView:activeView,tabs:tabs}=Object(index_esm.useValues)(Object(insightNavLogic.a)(insightProps)),{setActiveView:setActiveView}=Object(index_esm.useActions)(Object(insightNavLogic.a)(insightProps));return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(FunnelsCue,{}),Object(jsx_runtime.jsx)(LemonTabs.a,{activeKey:activeView,onChange:newKey=>setActiveView(newKey),tabs:tabs.map((_ref=>{let{label:label,type:type,dataAttr:dataAttr}=_ref;return{key:type,label:Object(jsx_runtime.jsx)(Link.a,{to:insights_utils.k[type],preventClick:!0,"data-attr":dataAttr,children:Object(jsx_runtime.jsx)(Tooltip.a,{placement:"top",title:SavedInsights.INSIGHT_TYPES_METADATA[type].description,children:label})})}}))})]})}var LemonSkeleton=__webpack_require__("./frontend/src/lib/lemon-ui/LemonSkeleton/index.tsx");function InsightSkeleton(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object(jsx_runtime.jsxs)("div",{className:"my-6 space-y-4",children:[Object(jsx_runtime.jsx)(LemonSkeleton.a,{className:"w-1/4"}),Object(jsx_runtime.jsx)(LemonSkeleton.a,{className:"w-1/2",repeat:3}),Object(jsx_runtime.jsx)(LemonSkeleton.a,{}),Object(jsx_runtime.jsxs)("div",{className:"border rounded p-6 flex items-center gap-4",children:[Object(jsx_runtime.jsx)("div",{className:"flex-1 space-y-2",children:Object(jsx_runtime.jsx)(LemonSkeleton.a.Row,{repeat:3})}),Object(jsx_runtime.jsx)("div",{className:"flex-1 space-y-2",children:Object(jsx_runtime.jsx)(LemonSkeleton.a.Row,{repeat:3})})]}),Object(jsx_runtime.jsx)("div",{className:"border rounded p-6",style:{minHeight:600}})]})})}var Query=__webpack_require__("./frontend/src/queries/Query/Query.tsx"),EditableField=__webpack_require__("./frontend/src/lib/components/EditableField/EditableField.tsx"),icons=__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts"),More=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/More.tsx"),LemonButton=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/index.ts"),LemonDivider=__webpack_require__("./frontend/src/lib/lemon-ui/LemonDivider/index.ts"),SubscriptionsModal=__webpack_require__("./frontend/src/lib/components/Subscriptions/SubscriptionsModal.tsx"),ExportButton=__webpack_require__("./frontend/src/lib/components/ExportButton/ExportButton.tsx"),dashboardsModel=__webpack_require__("./frontend/src/models/dashboardsModel.tsx"),eventUsageLogic=__webpack_require__("./frontend/src/lib/utils/eventUsageLogic.ts"),newDashboardLogic=__webpack_require__("./frontend/src/scenes/dashboard/newDashboardLogic.ts"),fuse_esm=__webpack_require__("./node_modules/.pnpm/fuse.js@6.6.2/node_modules/fuse.js/dist/fuse.esm.js"),lemonToast=__webpack_require__("./frontend/src/lib/lemon-ui/lemonToast.tsx"),lib=__webpack_require__("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.5/node_modules/kea-router/lib/index.js");const addToDashboardModalLogic=Object(index_esm.kea)({path:["lib","components","AddToDashboard","saveToDashboardModalLogic"],props:{},key:_ref=>{let{insight:insight}=_ref;if(!insight.short_id)throw Error("must provide an insight with a short id");return insight.short_id},connect:props=>({actions:[Object(insightLogic.c)({dashboardItemId:props.insight.short_id,cachedInsight:props.insight}),["updateInsight","updateInsightSuccess","updateInsightFailure"],eventUsageLogic.d,["reportSavedInsightToDashboard","reportRemovedInsightFromDashboard","reportCreatedDashboardFromModal"],newDashboardLogic.a,["showNewDashboardModal"]]}),actions:{addNewDashboard:!0,setDashboardId:id=>({id:id}),setSearchQuery:query=>({query:query}),setInsight:insight=>({insight:insight}),setScrollIndex:index=>({index:index}),addToDashboard:(insight,dashboardId)=>({insight:insight,dashboardId:dashboardId}),removeFromDashboard:(insight,dashboardId)=>({insight:insight,dashboardId:dashboardId})},reducers:{_dashboardId:[null,{setDashboardId:(_,_ref2)=>{let{id:id}=_ref2;return id}}],searchQuery:["",{setSearchQuery:(_,_ref3)=>{let{query:query}=_ref3;return query}}],scrollIndex:[-1,{setScrollIndex:(_,_ref4)=>{let{index:index}=_ref4;return index}}],dashboardWithActiveAPICall:[null,{addToDashboard:(_,_ref5)=>{let{dashboardId:dashboardId}=_ref5;return dashboardId},removeFromDashboard:(_,_ref6)=>{let{dashboardId:dashboardId}=_ref6;return dashboardId},updateInsightSuccess:()=>null,updateInsightFailure:()=>null}]},selectors:{dashboardId:[s=>[s._dashboardId,dashboardsModel.a.selectors.lastDashboardId,dashboardsModel.a.selectors.nameSortedDashboards,(_,props)=>props.fromDashboard],(_dashboardId,lastDashboardId,dashboards,fromDashboard)=>_dashboardId||fromDashboard||lastDashboardId||(dashboards.length>0?dashboards[0].id:null)],dashboardsFuse:[()=>[dashboardsModel.a.selectors.nameSortedDashboards],nameSortedDashboards=>new fuse_esm.a(nameSortedDashboards||[],{keys:["name","description","tags"],threshold:.3})],filteredDashboards:[s=>[s.searchQuery,s.dashboardsFuse,dashboardsModel.a.selectors.nameSortedDashboards],(searchQuery,dashboardsFuse,nameSortedDashboards)=>searchQuery.length?dashboardsFuse.search(searchQuery).map((r=>r.item)):nameSortedDashboards],currentDashboards:[s=>[s.filteredDashboards,(_,props)=>props.insight],(filteredDashboards,insight)=>filteredDashboards.filter((d=>{var _insight$dashboard_ti,_insight$dashboard_ti2;return null===(_insight$dashboard_ti=insight.dashboard_tiles)||void 0===_insight$dashboard_ti||null===(_insight$dashboard_ti2=_insight$dashboard_ti.map((dt=>dt.dashboard_id)))||void 0===_insight$dashboard_ti2?void 0:_insight$dashboard_ti2.includes(d.id)}))],availableDashboards:[s=>[s.filteredDashboards,s.currentDashboards],(filteredDashboards,currentDashboards)=>filteredDashboards.filter((d=>!(null!=currentDashboards&&currentDashboards.map((cd=>cd.id)).includes(d.id))))],orderedDashboards:[s=>[s.currentDashboards,s.availableDashboards],(currentDashboards,availableDashboards)=>[...currentDashboards,...availableDashboards]]},listeners:_ref7=>{let{actions:actions,values:values,props:props}=_ref7;return{setDashboardId:_ref8=>{let{id:id}=_ref8;dashboardsModel.a.actions.setLastDashboardId(id)},addNewDashboard:async()=>{actions.showNewDashboardModal()},[dashboardsModel.a.actionTypes.addDashboardSuccess]:async _ref9=>{let{dashboard:dashboard}=_ref9;actions.reportCreatedDashboardFromModal(),actions.setDashboardId(dashboard.id),actions.addToDashboard(props.insight,dashboard.id),actions.setScrollIndex(values.orderedDashboards.findIndex((d=>d.id===dashboard.id)))},addToDashboard:async _ref10=>{let{insight:insight,dashboardId:dashboardId}=_ref10;actions.updateInsight({...insight,dashboards:[...insight.dashboards||[],dashboardId]},(()=>{actions.reportSavedInsightToDashboard(),dashboardsModel.a.actions.tileAddedToDashboard(dashboardId),lemonToast.d.success("Insight added to dashboard",{button:{label:"View dashboard",action:()=>lib.router.actions.push(urls.a.dashboard(dashboardId))}})}))},removeFromDashboard:async _ref11=>{let{insight:insight,dashboardId:dashboardId}=_ref11;actions.updateInsight({...insight,dashboards:(insight.dashboards||[]).filter((d=>d!==dashboardId)),dashboard_tiles:(insight.dashboard_tiles||[]).filter((dt=>dt.dashboard_id!==dashboardId))},(()=>{actions.reportRemovedInsightFromDashboard(),lemonToast.d.success("Insight removed from dashboard")}))}}}});var injectStylesIntoStyleTag=__webpack_require__("./node_modules/.pnpm/style-loader@2.0.0_webpack@4.46.0/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),AddToDashboard=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@4.46.0/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/lib/components/AddToDashboard/AddToDashboard.scss"),AddToDashboard_default=__webpack_require__.n(AddToDashboard),options={insert:"head",singleton:!1},LemonInput=(injectStylesIntoStyleTag_default()(AddToDashboard_default.a,options),AddToDashboard_default.a.locals,__webpack_require__("./frontend/src/lib/lemon-ui/LemonInput/LemonInput.tsx")),List=__webpack_require__("./node_modules/.pnpm/react-virtualized@9.22.3_react-dom@16.14.0_react@16.14.0/node_modules/react-virtualized/dist/es/List/index.js"),AutoSizer=__webpack_require__("./node_modules/.pnpm/react-virtualized@9.22.3_react-dom@16.14.0_react@16.14.0/node_modules/react-virtualized/dist/es/AutoSizer/index.js"),clsx_m=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),teamLogic=__webpack_require__("./frontend/src/scenes/teamLogic.tsx"),LemonModal=__webpack_require__("./frontend/src/lib/lemon-ui/LemonModal/index.ts");const DashboardRelationRow=_ref=>{var _insight$dashboards;let{style:style,isHighlighted:isHighlighted,isAlreadyOnDashboard:isAlreadyOnDashboard,dashboard:dashboard,insight:insight,canEditInsight:canEditInsight}=_ref;const logic=addToDashboardModalLogic({insight:insight,fromDashboard:(null===(_insight$dashboards=insight.dashboards)||void 0===_insight$dashboards?void 0:_insight$dashboards[0])||void 0}),{addToDashboard:addToDashboard,removeFromDashboard:removeFromDashboard}=Object(index_esm.useActions)(logic),{dashboardWithActiveAPICall:dashboardWithActiveAPICall}=Object(index_esm.useValues)(logic),{currentTeam:currentTeam}=Object(index_esm.useValues)(teamLogic.b),isPrimary=dashboard.id===(null==currentTeam?void 0:currentTeam.primary_dashboard);return Object(jsx_runtime.jsxs)("div",{"data-attr":"dashboard-list-item",style:style,className:Object(clsx_m.default)("flex items-center space-x-2",isHighlighted&&"highlighted"),children:[Object(jsx_runtime.jsx)(Link.a,{to:urls.a.dashboard(dashboard.id),children:dashboard.name||"Untitled"}),isPrimary&&Object(jsx_runtime.jsx)(Tooltip.a,{title:"Primary dashboards are shown on the project home page",children:Object(jsx_runtime.jsx)(icons.M,{className:"text-warning text-base"})}),Object(jsx_runtime.jsx)("span",{className:"grow"}),Object(jsx_runtime.jsx)(LemonButton.a,{type:isAlreadyOnDashboard?"primary":"secondary",loading:dashboardWithActiveAPICall===dashboard.id,disabledReason:canEditInsight?dashboardWithActiveAPICall?"Loading...":"":"You don't have permission to edit this dashboard",size:"small",onClick:e=>{e.preventDefault(),isAlreadyOnDashboard?removeFromDashboard(insight,dashboard.id):addToDashboard(insight,dashboard.id)},children:isAlreadyOnDashboard?"Added":"Add to dashboard"})]})};function AddToDashboardModal(_ref2){var _insight$dashboards2,_insight$dashboard_ti,_insight$dashboard_ti2;let{isOpen:isOpen,closeModal:closeModal,insight:insight,canEditInsight:canEditInsight}=_ref2;const logic=addToDashboardModalLogic({insight:insight,fromDashboard:(null===(_insight$dashboards2=insight.dashboards)||void 0===_insight$dashboards2?void 0:_insight$dashboards2[0])||void 0}),{searchQuery:searchQuery,currentDashboards:currentDashboards,orderedDashboards:orderedDashboards,scrollIndex:scrollIndex}=Object(index_esm.useValues)(logic),{setSearchQuery:setSearchQuery,addNewDashboard:addNewDashboard}=Object(index_esm.useActions)(logic),renderItem=_ref3=>{let{index:rowIndex,style:style}=_ref3;return Object(jsx_runtime.jsx)(DashboardRelationRow,{dashboard:orderedDashboards[rowIndex],insight:insight,canEditInsight:canEditInsight,isHighlighted:rowIndex===scrollIndex,isAlreadyOnDashboard:currentDashboards.some((currentDashboard=>currentDashboard.id===orderedDashboards[rowIndex].id)),style:style},rowIndex)};return Object(jsx_runtime.jsx)(LemonModal.a,{onClose:closeModal,isOpen:isOpen,title:"Add to dashboard",footer:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("div",{className:"flex-1",children:Object(jsx_runtime.jsx)(LemonButton.a,{type:"secondary",onClick:addNewDashboard,disabledReason:canEditInsight?void 0:"You do not have permission to add this Insight to dashboards",children:"Add to a new dashboard"})}),Object(jsx_runtime.jsx)(LemonButton.a,{type:"secondary",onClick:closeModal,children:"Close"})]}),children:Object(jsx_runtime.jsxs)("div",{className:"space-y-2",children:[Object(jsx_runtime.jsx)(LemonInput.a,{"data-attr":"dashboard-searchfield",type:"search",fullWidth:!0,placeholder:"Search for dashboards...",value:searchQuery,onChange:newValue=>setSearchQuery(newValue)}),Object(jsx_runtime.jsxs)("div",{className:"text-muted-alt",children:["This insight is referenced on"," ",Object(jsx_runtime.jsx)("strong",{className:"text-default",children:null===(_insight$dashboard_ti=insight.dashboard_tiles)||void 0===_insight$dashboard_ti?void 0:_insight$dashboard_ti.length})," ",Object(utils.xb)((null===(_insight$dashboard_ti2=insight.dashboard_tiles)||void 0===_insight$dashboard_ti2?void 0:_insight$dashboard_ti2.length)||0,"dashboard","dashboards",!1)]}),Object(jsx_runtime.jsx)("div",{style:{minHeight:420},children:Object(jsx_runtime.jsx)(AutoSizer.a,{children:_ref4=>{let{height:height,width:width}=_ref4;return Object(jsx_runtime.jsx)(List.a,{width:width,height:height,rowCount:orderedDashboards.length,overscanRowCount:100,rowHeight:40,rowRenderer:renderItem,scrollToIndex:scrollIndex})}})})]})})}try{AddToDashboardModal.displayName="AddToDashboardModal",AddToDashboardModal.__docgenInfo={description:"",displayName:"AddToDashboardModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},closeModal:{defaultValue:null,description:"",name:"closeModal",required:!0,type:{name:"() => void"}},insight:{defaultValue:null,description:"",name:"insight",required:!0,type:{name:"Partial<InsightModel>"}},canEditInsight:{defaultValue:null,description:"",name:"canEditInsight",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/AddToDashboard/AddToDashboardModal.tsx#AddToDashboardModal"]={docgenInfo:AddToDashboardModal.__docgenInfo,name:"AddToDashboardModal",path:"frontend/src/lib/components/AddToDashboard/AddToDashboardModal.tsx#AddToDashboardModal"})}catch(__react_docgen_typescript_loader_error){}var NewDashboardModal=__webpack_require__("./frontend/src/scenes/dashboard/NewDashboardModal.tsx");function AddToDashboard_AddToDashboard_AddToDashboard(_ref){var _insight$dashboard_ti;let{insight:insight,canEditInsight:canEditInsight}=_ref;const[openModal,setOpenModal]=Object(react.useState)(!1),{rawDashboards:rawDashboards}=Object(index_esm.useValues)(dashboardsModel.a),dashboards=(null===(_insight$dashboard_ti=insight.dashboard_tiles)||void 0===_insight$dashboard_ti?void 0:_insight$dashboard_ti.map((tile=>rawDashboards[tile.dashboard_id])).filter((d=>!!d)))||[];return Object(jsx_runtime.jsxs)("span",{className:"save-to-dashboard","data-attr":"save-to-dashboard-button",children:[Object(jsx_runtime.jsx)(AddToDashboardModal,{isOpen:openModal,closeModal:()=>setOpenModal(!1),insight:insight,canEditInsight:canEditInsight}),Object(jsx_runtime.jsx)(NewDashboardModal.b,{}),Object(jsx_runtime.jsx)(LemonButton.a,{onClick:()=>setOpenModal(!0),type:"secondary",icon:Object(jsx_runtime.jsx)(icons.Cd,{count:dashboards.length,showZero:!1,children:Object(jsx_runtime.jsx)(icons.rb,{})}),children:"Add to dashboard"})]})}try{AddToDashboard_AddToDashboard_AddToDashboard.displayName="AddToDashboard",AddToDashboard_AddToDashboard_AddToDashboard.__docgenInfo={description:"",displayName:"AddToDashboard",props:{insight:{defaultValue:null,description:"",name:"insight",required:!0,type:{name:"Partial<InsightModel>"}},canEditInsight:{defaultValue:null,description:"",name:"canEditInsight",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/AddToDashboard/AddToDashboard.tsx#AddToDashboard"]={docgenInfo:AddToDashboard_AddToDashboard_AddToDashboard.__docgenInfo,name:"AddToDashboard",path:"frontend/src/lib/components/AddToDashboard/AddToDashboard.tsx#AddToDashboard"})}catch(__react_docgen_typescript_loader_error){}function InsightSaveButton(_ref){let{saveAs:saveAs,saveInsight:saveInsight,isSaved:isSaved,insightSaving:insightSaving,insightChanged:insightChanged,addingToDashboard:addingToDashboard}=_ref;const disabled=isSaved&&!insightChanged,saveAsAvailable=isSaved&&!addingToDashboard;return Object(jsx_runtime.jsx)(LemonButton.c,{type:"primary",onClick:()=>saveInsight(!0),"data-attr":"insight-save-button",disabled:disabled,loading:!disabled&&insightSaving,sideAction:{dropdown:{placement:"bottom-end",overlay:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[!disabled&&Object(jsx_runtime.jsxs)(LemonButton.a,{onClick:()=>saveInsight(!1),"data-attr":"insight-save-and-continue",status:"stealth",fullWidth:!0,children:[addingToDashboard?"Save, add to dashboard":"Save"," & continue editing"]}),saveAsAvailable&&Object(jsx_runtime.jsx)(LemonButton.a,{onClick:saveAs,"data-attr":"insight-save-as-new-insight",status:"stealth",fullWidth:!0,children:"Save as…"})]})},disabled:disabled&&!saveAsAvailable,"data-attr":"insight-save-dropdown"},children:disabled?"No changes to be saved":addingToDashboard?"Save & add to dashboard":"Save"})}try{InsightSaveButton.displayName="InsightSaveButton",InsightSaveButton.__docgenInfo={description:"",displayName:"InsightSaveButton",props:{saveAs:{defaultValue:null,description:"",name:"saveAs",required:!0,type:{name:"() => void"}},saveInsight:{defaultValue:null,description:"",name:"saveInsight",required:!0,type:{name:"(redirectToViewMode?: boolean | undefined) => void"}},isSaved:{defaultValue:null,description:"",name:"isSaved",required:!0,type:{name:"boolean | undefined"}},insightSaving:{defaultValue:null,description:"",name:"insightSaving",required:!0,type:{name:"boolean"}},insightChanged:{defaultValue:null,description:"",name:"insightChanged",required:!0,type:{name:"boolean"}},addingToDashboard:{defaultValue:null,description:"",name:"addingToDashboard",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightSaveButton.tsx#InsightSaveButton"]={docgenInfo:InsightSaveButton.__docgenInfo,name:"InsightSaveButton",path:"frontend/src/scenes/insights/InsightSaveButton.tsx#InsightSaveButton"})}catch(__react_docgen_typescript_loader_error){}var ObjectTags=__webpack_require__("./frontend/src/lib/components/ObjectTags/ObjectTags.tsx"),UserActivityIndicator=__webpack_require__("./frontend/src/lib/components/UserActivityIndicator/UserActivityIndicator.tsx"),PageHeader=__webpack_require__("./frontend/src/lib/components/PageHeader.tsx"),savedInsightsLogic=__webpack_require__("./frontend/src/scenes/saved-insights/savedInsightsLogic.ts"),userLogic=__webpack_require__("./frontend/src/scenes/userLogic.ts"),groupsModel=__webpack_require__("./frontend/src/models/groupsModel.ts"),cohortsModel=__webpack_require__("./frontend/src/models/cohortsModel.ts"),mathsLogic=__webpack_require__("./frontend/src/scenes/trends/mathsLogic.tsx"),tagsModel=__webpack_require__("./frontend/src/models/tagsModel.ts"),SharingModal=__webpack_require__("./frontend/src/lib/components/Sharing/SharingModal.tsx"),tooltip=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@16.14.0_react@16.14.0/node_modules/antd/es/tooltip/index.js"),src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),objectSpread2=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.20.1/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),asn_ThunderboltFilled={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M848 359.3H627.7L825.8 109c4.1-5.3.4-13-6.3-13H436c-2.8 0-5.5 1.5-6.9 4L170 547.5c-3.1 5.3.7 12 6.9 12h174.4l-89.4 357.6c-1.9 7.8 7.5 13.3 13.3 7.7L853.5 373c5.2-4.9 1.7-13.7-5.5-13.7z"}}]},name:"thunderbolt",theme:"filled"},AntdIcon=__webpack_require__("./node_modules/.pnpm/@ant-design+icons@4.7.0_react-dom@16.14.0_react@16.14.0/node_modules/@ant-design/icons/es/components/AntdIcon.js"),icons_ThunderboltFilled_ThunderboltFilled=function ThunderboltFilled(props,ref){return react.createElement(AntdIcon.a,Object(objectSpread2.a)(Object(objectSpread2.a)({},props),{},{ref:ref,icon:asn_ThunderboltFilled}))};icons_ThunderboltFilled_ThunderboltFilled.displayName="ThunderboltFilled";var icons_ThunderboltFilled=react.forwardRef(icons_ThunderboltFilled_ThunderboltFilled),globalInsightLogic=__webpack_require__("./frontend/src/scenes/insights/globalInsightLogic.ts"),queries_utils=__webpack_require__("./frontend/src/queries/utils.ts"),summarizeInsight=__webpack_require__("./frontend/src/scenes/insights/summarizeInsight.ts"),usePeriodicRerender=__webpack_require__("./frontend/src/lib/hooks/usePeriodicRerender.ts");function InsightPageHeader(_ref){var _insight$dashboards,_insight$tags,_insight$tags2;let{insightLogicProps:insightLogicProps}=_ref;const{insightMode:insightMode,subscriptionId:subscriptionId}=Object(index_esm.useValues)(insightSceneLogic.a),{setInsightMode:setInsightMode}=Object(index_esm.useActions)(insightSceneLogic.a),logic=Object(insightLogic.c)(insightLogicProps),{insightProps:insightProps,filters:filters,canEditInsight:canEditInsight,insight:insight,insightChanged:insightChanged,insightSaving:insightSaving,hasDashboardItemId:hasDashboardItemId,exporterResourceParams:exporterResourceParams}=Object(index_esm.useValues)(logic),{setInsightMetadata:setInsightMetadata,saveAs:saveAs}=Object(index_esm.useActions)(logic),{duplicateInsight:duplicateInsight,loadInsights:loadInsights}=Object(index_esm.useActions)(savedInsightsLogic.b),{query:query,queryChanged:queryChanged,showQueryEditor:showQueryEditor,getInsightRefreshButtonDisabledReason:getInsightRefreshButtonDisabledReason}=Object(index_esm.useValues)(Object(insightDataLogic.a)(insightProps)),{saveInsight:saveQueryBasedInsight,toggleQueryEditorPanel:toggleQueryEditorPanel,loadData:loadData}=Object(index_esm.useActions)(Object(insightDataLogic.a)(insightProps));Object(index_esm.useMountedLogic)(insightCommandLogic(insightProps));const{hasAvailableFeature:hasAvailableFeature}=Object(index_esm.useValues)(userLogic.a),{aggregationLabel:aggregationLabel}=Object(index_esm.useValues)(groupsModel.a),{cohortsById:cohortsById}=Object(index_esm.useValues)(cohortsModel.a),{mathDefinitions:mathDefinitions}=Object(index_esm.useValues)(mathsLogic.g),{tags:tags}=Object(index_esm.useValues)(tagsModel.a),{currentTeamId:currentTeamId}=Object(index_esm.useValues)(teamLogic.b),{push:push}=Object(index_esm.useActions)(lib.router),{globalInsightFilters:globalInsightFilters}=Object(index_esm.useValues)(globalInsightLogic.a),{setGlobalInsightFilters:setGlobalInsightFilters}=Object(index_esm.useActions)(globalInsightLogic.a);Object(usePeriodicRerender.a)(3e4);const insightRefreshButtonDisabledReason=getInsightRefreshButtonDisabledReason();return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[hasDashboardItemId&&Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(SubscriptionsModal.b,{isOpen:insightMode===types.H.Subscriptions,closeModal:()=>push(urls.a.insightView(insight.short_id)),insightShortId:insight.short_id,subscriptionId:subscriptionId}),Object(jsx_runtime.jsx)(SharingModal.a,{title:"Insight Sharing",isOpen:insightMode===types.H.Sharing,closeModal:()=>push(urls.a.insightView(insight.short_id)),insightShortId:insight.short_id,insight:insight,previewIframe:!0})]}),Object(jsx_runtime.jsx)(PageHeader.a,{title:Object(jsx_runtime.jsx)(EditableField.a,{name:"name",value:insight.name||"",placeholder:Object(summarizeInsight.a)(query,filters,{aggregationLabel:aggregationLabel,cohortsById:cohortsById,mathDefinitions:mathDefinitions}),onSave:value=>setInsightMetadata({name:value}),saveOnBlur:!0,maxLength:400,mode:canEditInsight?void 0:"view","data-attr":"insight-name",notice:canEditInsight?void 0:{icon:Object(jsx_runtime.jsx)(icons.Pb,{}),tooltip:"You don't have edit permissions on any of the dashboards this insight belongs to. Ask a dashboard collaborator with edit access to add you."}}),buttons:Object(jsx_runtime.jsxs)("div",{className:"flex justify-between items-center gap-2",children:[hasDashboardItemId?Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(More.a,{overlay:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(LemonButton.a,{status:"stealth",onClick:()=>loadData(!0),fullWidth:!0,"data-attr":"refresh-insight-from-insight-view",disabledReason:insightRefreshButtonDisabledReason,children:"Refresh"}),Object(jsx_runtime.jsx)(LemonButton.a,{status:"stealth",onClick:()=>duplicateInsight(insight,!0),fullWidth:!0,"data-attr":"duplicate-insight-from-insight-view",children:"Duplicate"}),Object(jsx_runtime.jsx)(LemonButton.a,{status:"stealth",onClick:()=>setInsightMetadata({favorited:!insight.favorited}),fullWidth:!0,children:insight.favorited?"Remove from favorites":"Add to favorites"}),Object(jsx_runtime.jsx)(LemonDivider.a,{}),Object(jsx_runtime.jsx)(LemonButton.a,{status:"stealth",onClick:()=>insight.short_id?push(urls.a.insightSharing(insight.short_id)):null,fullWidth:!0,children:"Share or embed"}),insight.short_id&&Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(SubscriptionsModal.a,{insightShortId:insight.short_id}),exporterResourceParams?Object(jsx_runtime.jsx)(ExportButton.a,{fullWidth:!0,items:[{export_format:types.t.PNG,insight:insight.id},{export_format:types.t.CSV,export_context:exporterResourceParams}]}):null,Object(jsx_runtime.jsx)(LemonDivider.a,{})]}),Object(jsx_runtime.jsx)(LemonButton.a,{status:"danger",onClick:()=>Object(utils.x)({object:insight,endpoint:`projects/${currentTeamId}/insights`,callback:()=>{loadInsights(),push(urls.a.savedInsights())}}),fullWidth:!0,children:"Delete insight"})]})}),Object(jsx_runtime.jsx)(LemonDivider.a,{vertical:!0})]}):Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(More.a,{overlay:Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object(jsx_runtime.jsx)(LemonButton.a,{status:"stealth",onClick:()=>loadData(!0),fullWidth:!0,"data-attr":"refresh-insight-from-insight-view",disabledReason:insightRefreshButtonDisabledReason,children:"Refresh"})})}),Object(jsx_runtime.jsx)(LemonDivider.a,{vertical:!0})]}),Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(tooltip.a,{title:"Turning on fast mode will automatically enable 10% sampling for all insights you refresh, speeding up the calculation of results",placement:"bottom",children:Object(jsx_runtime.jsx)("div",{children:Object(jsx_runtime.jsx)(src.LemonSwitch,{onChange:checked=>{let samplingFilter={sampling_factor:null};checked?(samplingFilter={sampling_factor:.1},es.c.capture("sampling_fast_mode_enabled")):es.c.capture("sampling_fast_mode_disabled"),setGlobalInsightFilters({...globalInsightFilters,...samplingFilter})},checked:!!globalInsightFilters.sampling_factor,icon:Object(jsx_runtime.jsx)(icons_ThunderboltFilled,{style:globalInsightFilters.sampling_factor?{color:"var(--primary)"}:{}})})})}),Object(jsx_runtime.jsx)(LemonDivider.a,{vertical:!0})]}),insightMode===types.H.Edit&&hasDashboardItemId&&Object(jsx_runtime.jsx)(LemonButton.a,{type:"secondary",onClick:()=>setInsightMode(types.H.View,null),children:"Cancel"}),insightMode!==types.H.Edit&&hasDashboardItemId&&Object(jsx_runtime.jsx)(AddToDashboard_AddToDashboard_AddToDashboard,{insight:insight,canEditInsight:canEditInsight}),insightMode!==types.H.Edit?canEditInsight&&Object(jsx_runtime.jsx)(LemonButton.a,{type:"primary",onClick:()=>setInsightMode(types.H.Edit,null),"data-attr":"insight-edit-button",children:"Edit"}):Object(jsx_runtime.jsx)(InsightSaveButton,{saveAs:saveAs,saveInsight:saveQueryBasedInsight,isSaved:hasDashboardItemId,addingToDashboard:!(null===(_insight$dashboards=insight.dashboards)||void 0===_insight$dashboards||!_insight$dashboards.length||insight.id),insightSaving:insightSaving,insightChanged:insightChanged||queryChanged}),Object(queries_utils.q)(query)?Object(jsx_runtime.jsx)(LemonButton.a,{tooltip:showQueryEditor?Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Hide source",Object(jsx_runtime.jsx)(src.LemonTag,{className:"ml-2",type:"warning",children:"BETA"})]}):Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["View source",Object(jsx_runtime.jsx)(src.LemonTag,{className:"ml-2",type:"warning",children:"BETA"})]}),"aria-label":showQueryEditor?"Hide source (BETA)":"View source (BETA)",tooltipPlacement:"bottomRight",type:"secondary",onClick:()=>{hasDashboardItemId&&insightMode!==types.H.Edit&&(setInsightMode(types.H.Edit,null),!1!==showQueryEditor)||toggleQueryEditorPanel()},icon:Object(jsx_runtime.jsx)(icons.P,{fontSize:"18"})}):null]}),caption:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[!(!canEditInsight&&!insight.description)&&Object(jsx_runtime.jsx)(EditableField.a,{multiline:!0,name:"description",value:insight.description||"",placeholder:"Description (optional)",onSave:value=>setInsightMetadata({description:value}),saveOnBlur:!0,maxLength:400,mode:canEditInsight?void 0:"view","data-attr":"insight-description",compactButtons:!0,paywall:!hasAvailableFeature(types.d.DASHBOARD_COLLABORATION)}),canEditInsight?Object(jsx_runtime.jsx)(ObjectTags.a,{tags:null!==(_insight$tags=insight.tags)&&void 0!==_insight$tags?_insight$tags:[],saving:insightSaving,onChange:(_,tags)=>setInsightMetadata({tags:null!=tags?tags:[]}),tagsAvailable:tags,className:"insight-metadata-tags","data-attr":"insight-tags"}):null!==(_insight$tags2=insight.tags)&&void 0!==_insight$tags2&&_insight$tags2.length?Object(jsx_runtime.jsx)(ObjectTags.a,{tags:insight.tags,saving:insightSaving,className:"insight-metadata-tags","data-attr":"insight-tags",staticOnly:!0}):null,Object(jsx_runtime.jsx)(UserActivityIndicator.a,{at:insight.last_modified_at,by:insight.last_modified_by,className:"mt-2"})]}),tabbedPage:insightMode===types.H.Edit})]})}try{InsightPageHeader.displayName="InsightPageHeader",InsightPageHeader.__docgenInfo={description:"",displayName:"InsightPageHeader",props:{insightLogicProps:{defaultValue:null,description:"",name:"insightLogicProps",required:!0,type:{name:"InsightLogicProps"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightPageHeader.tsx#InsightPageHeader"]={docgenInfo:InsightPageHeader.__docgenInfo,name:"InsightPageHeader",path:"frontend/src/scenes/insights/InsightPageHeader.tsx#InsightPageHeader"})}catch(__react_docgen_typescript_loader_error){}function Insight_Insight(_ref){let{insightId:insightId}=_ref;const{insightMode:insightMode,insight:insight}=Object(index_esm.useValues)(insightSceneLogic.a),logic=Object(insightLogic.c)({dashboardItemId:insightId||"new",cachedInsight:(null==insight?void 0:insight.short_id)===insightId?insight:null}),{insightProps:insightProps,insightLoading:insightLoading,filtersKnown:filtersKnown,erroredQueryId:erroredQueryId}=Object(index_esm.useValues)(logic),{reportInsightViewedForRecentInsights:reportInsightViewedForRecentInsights,abortAnyRunningQuery:abortAnyRunningQuery,loadResults:loadResults}=Object(index_esm.useActions)(logic),{query:query,isQueryBasedInsight:isQueryBasedInsight,showQueryEditor:showQueryEditor}=Object(index_esm.useValues)(Object(insightDataLogic.a)(insightProps)),{setQuery:setQuery}=Object(index_esm.useActions)(Object(insightDataLogic.a)(insightProps));if(Object(index_esm.useMountedLogic)(insightCommandLogic(insightProps)),Object(react.useEffect)((()=>{reportInsightViewedForRecentInsights()}),[insightId]),Object(react.useEffect)((()=>(erroredQueryId&&loadResults(),()=>{abortAnyRunningQuery()})),[]),"new"!==insightId&&insightLoading&&!filtersKnown)return Object(jsx_runtime.jsx)(InsightSkeleton,{});const actuallyShowQueryEditor=insightMode===types.H.Edit&&(isQueryBasedInsight&&!Object(queries_utils.a)(query)||!isQueryBasedInsight&&showQueryEditor);return Object(jsx_runtime.jsx)(index_esm.BindLogic,{logic:insightLogic.c,props:insightProps,children:Object(jsx_runtime.jsxs)("div",{className:"insights-page",children:[Object(jsx_runtime.jsx)(InsightPageHeader,{insightLogicProps:insightProps}),insightMode===types.H.Edit&&Object(jsx_runtime.jsx)(InsightsNav,{}),Object(jsx_runtime.jsx)(Query.a,{query:Object(queries_utils.q)(query)?{...query,full:!0}:query,setQuery:insightMode===types.H.Edit?setQuery:void 0,readOnly:insightMode!==types.H.Edit,context:{showOpenEditorButton:!1,showQueryEditor:actuallyShowQueryEditor,showQueryHelp:insightMode===types.H.Edit&&!Object(queries_utils.a)(query),insightProps:insightProps}})]})})}try{Insight_Insight.displayName="Insight",Insight_Insight.__docgenInfo={description:"",displayName:"Insight",props:{insightId:{defaultValue:null,description:"",name:"insightId",required:!0,type:{name:'"new" | InsightShortId'}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/Insight.tsx#Insight"]={docgenInfo:Insight_Insight.__docgenInfo,name:"Insight",path:"frontend/src/scenes/insights/Insight.tsx#Insight"})}catch(__react_docgen_typescript_loader_error){}var NotFound=__webpack_require__("./frontend/src/lib/components/NotFound/index.tsx");function InsightScene(){var _insightLogicRef$logi,_insightLogicRef$logi2;const{insightId:insightId,insight:insight,insightLogicRef:insightLogicRef}=Object(index_esm.useValues)(insightSceneLogic.a);return"new"===insightId||insightId&&null!=insight&&insight.id&&null!=insight&&insight.short_id?Object(jsx_runtime.jsx)(Insight_Insight,{insightId:insightId}):null!=insightLogicRef&&null!==(_insightLogicRef$logi=insightLogicRef.logic)&&void 0!==_insightLogicRef$logi&&null!==(_insightLogicRef$logi2=_insightLogicRef$logi.values)&&void 0!==_insightLogicRef$logi2&&_insightLogicRef$logi2.insightLoading?Object(jsx_runtime.jsx)(InsightSkeleton,{}):Object(jsx_runtime.jsx)(NotFound.a,{object:"insight"})}const scene={component:InsightScene,logic:insightSceneLogic.a}},"./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@4.46.0/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/lib/components/AddToDashboard/AddToDashboard.scss":function(module,exports,__webpack_require__){(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.i,"",""]),module.exports=exports},"./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@4.46.0/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/NewDashboardModal.scss":function(module,exports,__webpack_require__){(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.i,".NewDashboardModal .DashboardTemplateChooser{max-width:780px;grid-template-columns:repeat(3,1fr);-moz-column-gap:.5em;column-gap:.5em;row-gap:.5em;display:grid}.NewDashboardModal .TemplateItem{width:240px;height:210px}",""]),module.exports=exports},"./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.18_webpack@4.46.0/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/Insight.scss":function(module,exports,__webpack_require__){(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.i,".insights-page h2{font-size:1.125rem;font-weight:600}.insights-page .insight-history-button{padding-right:0;padding-left:0;border-radius:0;border:0;border-bottom:2px solid transparent}.insights-page .insight-history-button.active{border-bottom:2px solid var(--primary)}.insights-page hr{margin:1rem 0}.insights-page .ant-tabs-tab .hotkey{margin-bottom:0;background-color:var(--primary-bg-hover)!important;border-color:var(--primary-bg-hover)!important}.insights-page .ant-tabs-tab .deprecated{color:var(--muted)}.insights-page .ant-tabs-tab .deprecated .hotkey{margin-bottom:0;background-color:var(--white)!important;border-color:var(--border)!important;color:var(--muted)}.insights-page .ant-tabs-tab.ant-tabs-tab-active .deprecated{color:var(--primary)}.insights-page .ant-tabs-tab:not(.ant-tabs-tab-active):hover .hotkey{background-color:var(--primary-bg-active)!important}.insights-page .ant-tabs-tab:not(.ant-tabs-tab-active):hover .deprecated .hotkey{background-color:var(--white)!important}.insights-page .insight-controls{overflow:visible;position:relative;margin-bottom:1rem}.insights-page .insight-controls .ant-card-body{padding:.8rem 1rem}.insights-page .insight-wrapper.insight-wrapper--singlecolumn{position:relative}@media screen and (min-width:1200px){.insights-page .insight-wrapper.insight-wrapper--singlecolumn{display:flex;overflow:hidden}.insights-page .insight-wrapper.insight-wrapper--singlecolumn .insights-container{flex:1;overflow-x:auto}}.insights-page .insights-graph-container{margin-bottom:1rem}.insights-page .insights-graph-container .ant-card-head{border-bottom:1px solid var(--border);min-height:unset;background-color:var(--bg-light);padding-left:1rem;padding-right:1rem}.insights-page .insights-graph-container .ant-card-body,.insights-page .insights-graph-container .ant-card-head .ant-card-head-title{padding:0}.insights-page .insights-graph-container .insights-graph-container-row .insights-graph-container-row-left{width:100%}.insights-page .insights-graph-container .insights-graph-container-row .insights-graph-container-row-right{height:min(90vh - 16rem,36rem);max-width:45%;min-width:300px;width:-moz-fit-content;width:fit-content;padding:0 1rem 1rem 0;display:flex;align-items:center}.insights-page .insights-graph-container .LineGraph{width:calc(100% - 3rem);height:calc(100% - 3rem)}.insights-page .insight-title-container{display:flex;align-items:center}.insights-page .insight-title-container .insight-title-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.insights-page .advanced-options-dropdown{font-size:1.4em;color:var(--primary-alt)}.insights-page .advanced-options-dropdown.expanded{transform:rotateX(180deg)}.insights-page .funnel-advanced-options .funnel-exclusions-filter .mt:first-of-type{margin-top:.5rem}.insights-page .retention-date-picker{background-color:transparent;border:0}.insights-page .retention-date-picker input::-moz-placeholder{color:var(--default)}.insights-page .retention-date-picker input::placeholder{color:var(--default)}.insights-page .insights-graph-header{margin-top:0!important;margin-bottom:0!important;padding-left:1rem;padding-right:1rem;min-height:48px}.insight-metadata-tags{margin-top:.5rem}.insight-metadata-tags .ant-tag{margin-top:0}.trends-insights-container{position:relative;min-height:min(90vh - 16rem,36rem);display:flex;justify-content:center}.trends-insights-container .LineGraph{height:calc(100% - 1rem)!important}.funnel-insights-container{border-radius:0 0 var(--radius) var(--radius)}.funnel-insights-container.non-empty-state{min-height:26rem;position:relative;margin-bottom:0}.funnel-insights-container .ant-table-wrapper{margin-top:0!important}.funnel-tab-btn-popover .ant-popover-inner-content{padding:4px 15px}.funnel-tab-btn-popover .ant-popover-inner-content button.ant-btn-link{padding:0;margin:0 0 0 4px}.significance-highlight{display:inline-flex;background:var(--primary);color:var(--bg-light)}.significance-highlight .LemonIcon{color:var(--bg-light)}",""]),module.exports=exports}}]);