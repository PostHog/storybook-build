(window.webpackJsonp=window.webpackJsonp||[]).push([[318],{"./frontend/src/scenes/instance/Licenses/index.tsx":function(Q,M,n){"use strict";n.r(M),n.d(M,"scene",function(){return J}),n.d(M,"Licenses",function(){return y});var C=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),A=n.n(C),T=n("./node_modules/core-js/modules/es.array.filter.js"),X=n.n(T),h=n("./node_modules/core-js/modules/es.object.to-string.js"),Z=n.n(h),B=n("./node_modules/core-js/modules/es.array.sort.js"),w=n.n(B),I=n("./node_modules/core-js/modules/es.array.slice.js"),k=n.n(I),W=n("./node_modules/core-js/modules/es.array.map.js"),q=n.n(W),K=n("./node_modules/core-js/modules/es.function.name.js"),ee=n.n(K),U=n("./node_modules/react/index.js"),e=n.n(U),R=n("./frontend/src/lib/components/LemonButton/More.tsx"),m=n("./node_modules/antd/es/form/index.js"),p=n("./node_modules/antd/es/alert/index.js"),x=n("./node_modules/antd/es/input/index.js"),b=n("./node_modules/antd/es/button/index.js"),u=n("./frontend/src/scenes/instance/Licenses/licenseLogic.ts"),P=n("./node_modules/kea/lib/index.esm.js"),L=n("./frontend/src/lib/utils.tsx"),F=n("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),N=n("./frontend/src/lib/components/PageHeader.tsx"),z=n("./node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),V=n("./frontend/src/lib/components/Tooltip.tsx"),S=n("./frontend/src/lib/components/LemonTable/index.ts"),v=n("./frontend/src/lib/components/LemonButton/index.ts"),H=n("./frontend/src/scenes/organizationLogic.tsx"),g=n("./frontend/src/lib/dayjs.ts"),Y=n("./frontend/src/lib/components/LemonModal/index.ts"),J={component:y,logic:u.b};function $(i){var D=i.licenses,d=i.isOpen,r=i.onCancel,E=i.onOk,j=Object(P.useValues)(H.a),c=j.currentOrganization,_=D.filter(function(s){return Object(g.a)().isBefore(s.valid_until)}).length>1,o=((c==null?void 0:c.teams)||[]).filter(function(s){return!s.is_demo}).sort(function(s,f){return s.id-f.id}),O=!_&&o.slice(1,o.length).length>0;return e.a.createElement(Y.a,{isOpen:d,onClose:r,title:"Are you sure you want to deactivate your license?",footer:e.a.createElement(e.a.Fragment,null,e.a.createElement(v.a,{form:"new-dashboard-form",type:"secondary","data-attr":"deactivate-license-cancel",className:"mr-2",onClick:r},"Cancel"),e.a.createElement(v.a,{"data-attr":"deactivate-license-proceed",type:"primary",status:"danger",onClick:E},O?e.a.createElement(e.a.Fragment,null,"Deactivate license & delete ",o.length," project(s)"):"Deactivate license"))},e.a.createElement("ul",{className:"pl-3 list-disc"},_?e.a.createElement("li",null,"You will ",e.a.createElement("strong",null,"keep")," all premium features available with your other valid license."):e.a.createElement("li",null,"You will ",e.a.createElement("strong",null,"IMMEDIATELY")," lose access to all premium features such as"," ",e.a.createElement("strong",null,"multiple projects"),", ",e.a.createElement("strong",null,"single sign on"),","," ",e.a.createElement("strong",null,"group analytics"),", ",e.a.createElement("strong",null,"multivariate feature flags")," and many more."),O&&e.a.createElement("li",null,"We will ",e.a.createElement("strong",{className:"text-danger"},"DELETE")," the following projects:",e.a.createElement("ul",{className:"pl-6 list-disc mb-2"},o.map(function(s){return e.a.createElement("li",{key:s.id},e.a.createElement("strong",null,s.name))})),"To keep one of these projects instead, remove all other projects first."),e.a.createElement("li",null,"You will immediately be billed for usage in the current period, if any.")))}function y(){var i=m.a.useForm(),D=A()(i,1),d=D[0],r=Object(P.useValues)(u.b),E=r.licenses,j=r.licensesLoading,c=r.error,_=r.showConfirmCancel,o=Object(P.useActions)(u.b),O=o.createLicense,s=o.deleteLicense,f=o.setShowConfirmCancel,G=[{title:"Active",render:function(l,t){return Object(u.a)(t)?"expired":"active"}},{title:"Valid until",render:function(l,t){return Object(L.N)(t.valid_until)}},{title:"Plan",dataIndex:"plan"},{title:function(){return e.a.createElement(V.a,{placement:"right",title:"Maximum number of team members that you can have across all organizations with your current license."},"Max #\xA0of team members",e.a.createElement(z.a,{className:"info-indicator"}))},render:function(l,t){return t.max_users===null?"Unlimited":t.max_users}},{title:"Key",render:function(l,t){return e.a.createElement(F.a,null,t.key)}},{title:"License added on",render:function(l,t){return Object(L.N)(t.created_at)}},{width:0,render:function(l,t){return Object(g.a)().isAfter(t.valid_until)?null:e.a.createElement(R.a,{overlay:e.a.createElement(e.a.Fragment,null,e.a.createElement(v.a,{status:"danger",onClick:function(){return f(t)},fullWidth:!0},"Deactivate license"))})}}];return e.a.createElement("div",null,e.a.createElement($,{licenses:E,isOpen:!!_,onCancel:function(){return f(null)},onOk:function(){return _?s(_):null}}),e.a.createElement(N.a,{title:"Licenses",caption:e.a.createElement(e.a.Fragment,null,"Here you can add and manage your PostHog enterprise licenses. When you activate a license key, enterprise functionality will be enabled immediately. Contact"," ",e.a.createElement("a",{href:"mailto:sales@posthog.com"},"sales@posthog.com")," to buy a license or if you have any issues with a license.")}),c&&e.a.createElement(p.a,{message:c.detail||e.a.createElement("span",null,"Could not validate license key. Please try again or contact us."),type:"error",style:{marginBottom:"1em"}}),e.a.createElement(m.a,{form:d,name:"horizontal_login",layout:"inline",onFinish:function(l){return O({key:l.key})},style:{marginBottom:"1rem"}},e.a.createElement(m.a.Item,{name:"key",rules:[{required:!0,message:"Please input a license key!"}]},e.a.createElement(x.a,{placeholder:"License key",style:{minWidth:400}})),e.a.createElement(m.a.Item,{shouldUpdate:!0},function(){return e.a.createElement(b.a,{type:"primary",htmlType:"submit",disabled:!d.isFieldsTouched(!0)||!!d.getFieldsError().filter(function(a){var l=a.errors;return l.length}).length},"Activate License Key")})),e.a.createElement(S.a,{"data-attr":"license-table",size:"small",rowKey:"id",rowClassName:"cursor-pointer",dataSource:E,columns:G,loading:j}))}}}]);
