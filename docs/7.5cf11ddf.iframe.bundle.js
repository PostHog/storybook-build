(window.webpackJsonp=window.webpackJsonp||[]).push([[7,10],{"./frontend/src/scenes/apps/ErrorDetailsDrawer.tsx":function(z,v,e){"use strict";e.r(v),e.d(v,"ErrorDetailsDrawer",function(){return c});var L=e("./node_modules/core-js/modules/es.object.keys.js"),$=e.n(L),I=e("./node_modules/core-js/modules/es.symbol.js"),f=e.n(I),y=e("./node_modules/core-js/modules/es.array.filter.js"),j=e.n(y),h=e("./node_modules/core-js/modules/es.object.to-string.js"),G=e.n(h),B=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Q=e.n(B),K=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),X=e.n(K),R=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Y=e.n(R),U=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),F=e.n(U),W=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),H=e.n(W),P=e("./node_modules/kea/lib/index.esm.js"),T=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),x=e("./frontend/src/lib/components/Drawer.tsx"),J=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),u=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),M=e("./frontend/src/lib/components/PaginationControl/index.tsx"),g=e("./node_modules/antd/es/tabs/index.js"),O=e("./frontend/src/lib/components/LemonLabel/LemonLabel.tsx"),D=e("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),a=e("./node_modules/react/jsx-runtime.js"),C=e.n(a);function S(l,s){var o=Object.keys(l);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(l);s&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(l,t).enumerable})),o.push.apply(o,r)}return o}function b(l){for(var s=1;s<arguments.length;s++){var o=arguments[s]!=null?arguments[s]:{};s%2?S(Object(o),!0).forEach(function(r){F()(l,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(o)):S(Object(o)).forEach(function(r){Object.defineProperty(l,r,Object.getOwnPropertyDescriptor(o,r))})}return l}function c(){var l=Object(P.useValues)(T.appMetricsSceneLogic),s=l.errorDetailsDrawerError,o=l.errorDetailsLoading,r=Object(P.useActions)(T.appMetricsSceneLogic),t=r.closeErrorDetailsDrawer;return Object(a.jsx)(x.a,{visible:!!s,onClose:t,title:"Viewing error details: ".concat(s),width:"min(50vw, 80rem)",destroyOnClose:!0,children:o?Object(a.jsx)(J.a,{className:"h-10"}):Object(a.jsx)(A,{})})}function A(){var l=Object(P.useValues)(T.appMetricsSceneLogic),s=l.errorDetails,o=Object(M.c)(s,{pageSize:1}),r=H()(o.dataSourcePage,1),t=r[0];return Object(a.jsxs)("div",{children:[Object(a.jsx)(M.a,b(b({},o),{},{nouns:["sample error","sample errors"]})),Object(a.jsxs)(g.a,{children:[Object(a.jsxs)(g.a.TabPane,{tab:"Overview",children:[Object(a.jsxs)("div",{children:[Object(a.jsx)(O.a,{children:"Error:"})," ",t.error_type]}),t.error_details.error.message&&Object(a.jsxs)("div",{children:[Object(a.jsx)(O.a,{children:"Error message:"})," ",t.error_details.error.message]}),Object(a.jsxs)("div",{children:[Object(a.jsx)(O.a,{children:"When:"})," ",Object(a.jsx)(u.b,{time:t.timestamp,showSeconds:!0})]}),t.error_details.eventCount&&Object(a.jsxs)("div",{children:[Object(a.jsx)(O.a,{children:"Event count:"})," ",t.error_details.eventCount]})]},"overview"),t.error_details.event&&Object(a.jsx)(g.a.TabPane,{tab:"Event",children:Object(a.jsx)(D.a,{language:D.b.JSON,children:JSON.stringify(t.error_details.event,null,2)})},"event"),t.error_details.error.stack&&Object(a.jsx)(g.a.TabPane,{tab:"Stack trace",children:Object(a.jsx)(D.a,{wrap:!0,language:D.b.JavaScript,children:t.error_details.error.stack})},"stacktrace")]})]})}},"./frontend/src/scenes/apps/appMetricsSceneLogic.ts":function(z,v,e){"use strict";e.r(v),e.d(v,"AppMetricsTab",function(){return c}),e.d(v,"appMetricsSceneLogic",function(){return l});var L=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),$=e.n(L),I=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),f=e.n(I),y=e("./node_modules/@babel/runtime/regenerator/index.js"),j=e.n(y),h=e("./node_modules/core-js/modules/es.array.iterator.js"),G=e.n(h),B=e("./node_modules/core-js/modules/es.object.to-string.js"),Q=e.n(B),K=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),X=e.n(K),R=e("./node_modules/core-js/modules/es.array.concat.js"),Y=e.n(R),U=e("./node_modules/core-js/modules/es.function.name.js"),F=e.n(U),W=e("./node_modules/core-js/modules/es.array.includes.js"),H=e.n(W),P=e("./node_modules/core-js/modules/es.string.includes.js"),T=e.n(P),x=e("./node_modules/core-js/modules/es.array.filter.js"),J=e.n(x),u=e("./node_modules/kea/lib/index.esm.js"),M=e("./node_modules/kea-loaders/lib/index.js"),g=e.n(M),O=e("./frontend/src/scenes/urls.ts"),D=e("./frontend/src/lib/api.ts"),a=e("./frontend/src/scenes/teamLogic.tsx"),C=e("./node_modules/kea-router/lib/index.js"),S=e.n(C),b=e("./frontend/src/lib/utils.tsx"),c;(function(s){s.ProcessEvent="processEvent",s.OnEvent="onEvent",s.ExportEvents="exportEvents",s.HistoricalExports="historical_exports"})(c||(c={}));var A=[c.ProcessEvent,c.OnEvent,c.ExportEvents],l=Object(u.kea)([Object(u.path)(function(s){return["scenes","apps","appMetricsSceneLogic",s]}),Object(u.props)({}),Object(u.key)(function(s){return s.pluginConfigId}),Object(u.actions)({setActiveTab:function(o){return{tab:o}},setDateFrom:function(o){return{dateFrom:o}},openErrorDetailsDrawer:function(o,r,t){return{errorType:o,category:r,jobId:t}},closeErrorDetailsDrawer:!0}),Object(u.reducers)({activeTab:[null,{setActiveTab:function(o,r){var t=r.tab;return t}}],dateFrom:["-30d",{setDateFrom:function(o,r){var t=r.dateFrom;return t}}],errorDetailsDrawerError:[null,{openErrorDetailsDrawer:function(o,r){var t=r.errorType;return t},closeErrorDetailsDrawer:function(){return null}}]}),Object(M.loaders)(function(s){var o=s.values,r=s.props;return{pluginConfig:[null,{loadPluginConfig:function(){var t=f()(j.a.mark(function _(){return j.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,D.b.get("api/projects/".concat(a.a.values.currentTeamId,"/plugin_configs/").concat(r.pluginConfigId));case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},_)}));function n(){return t.apply(this,arguments)}return n}()}],appMetricsResponse:[null,{loadMetrics:function(){var t=f()(j.a.mark(function _(){var d;return j.a.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return d=Object(b.Eb)({category:o.activeTab,date_from:o.dateFrom}),E.next=3,D.b.get("api/projects/".concat(a.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"?").concat(d));case 3:return E.abrupt("return",E.sent);case 4:case"end":return E.stop()}},_)}));function n(){return t.apply(this,arguments)}return n}()}],historicalExports:[[],{loadHistoricalExports:function(){var t=f()(j.a.mark(function _(){var d,i;return j.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,D.b.get("api/projects/".concat(a.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"/historical_exports"));case 2:return d=m.sent,i=d.results,m.abrupt("return",i);case 5:case"end":return m.stop()}},_)}));function n(){return t.apply(this,arguments)}return n}()}],errorDetails:[[],{openErrorDetailsDrawer:function(){var t=f()(j.a.mark(function _(d){var i,E,m,V,w,N;return j.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return i=d.category,E=d.jobId,m=d.errorType,V=Object(b.Eb)({category:i,job_id:E,error_type:m}),p.next=4,D.b.get("api/projects/".concat(a.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"/error_details?").concat(V));case 4:return w=p.sent,N=w.result,p.abrupt("return",N);case 7:case"end":return p.stop()}},_)}));function n(_){return t.apply(this,arguments)}return n}()}]}}),Object(u.selectors)(function(s){var o=s.values;return{breadcrumbs:[function(r){return[r.pluginConfig,function(t,n){return n.pluginConfigId}]},function(r,t){var n;return[{name:"Apps",path:O.a.projectApps()},{name:r==null||(n=r.plugin_info)===null||n===void 0?void 0:n.name,path:O.a.appMetrics(t)}]}],showTab:[function(){return[]},function(){return function(r){var t;if(o.pluginConfigLoading||!o.pluginConfig)return!1;var n=((t=o.pluginConfig.plugin_info.capabilities)===null||t===void 0?void 0:t.methods)||[];return r===c.HistoricalExports?n.includes("exportEvents"):r===c.OnEvent&&n.includes("exportEvents")?!1:n.includes(r)}}]}}),Object(u.listeners)(function(s){var o=s.values,r=s.actions;return{loadPluginConfigSuccess:function(){if(!o.activeTab){var n=A.filter(function(i){return o.showTab(i)}),_=$()(n,1),d=_[0];r.setActiveTab(d)}},setActiveTab:function(n){var _=n.tab;_===c.HistoricalExports?r.loadHistoricalExports():r.loadMetrics()},setDateFrom:function(){r.loadMetrics()}}}),Object(C.actionToUrl)(function(s){var o=s.values,r=s.props;return{setActiveTab:function(){var n;return o.activeTab===c.HistoricalExports?O.a.appHistoricalExports(r.pluginConfigId):O.a.appMetrics(r.pluginConfigId,(n=o.activeTab)!==null&&n!==void 0?n:void 0)}}}),Object(C.urlToAction)(function(s){var o=s.values,r=s.actions;return{"/app/:pluginConfigId/:page":function(n,_){o.pluginConfig||r.loadPluginConfig(),n.page===c.HistoricalExports?r.setActiveTab(c.HistoricalExports):_.tab&&A.includes(_.tab)&&r.setActiveTab(_.tab)}}})])}}]);
