(window.webpackJsonp=window.webpackJsonp||[]).push([[2,6,8,12],{"./frontend/src/scenes/apps/AppMetricsScene.tsx":function(U,E,e){"use strict";e.r(E),e.d(E,"scene",function(){return g}),e.d(E,"AppMetrics",function(){return x});var P=e("./node_modules/core-js/modules/es.function.name.js"),T=e.n(P),d=e("./node_modules/antd/es/tabs/index.js"),n=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),v=e("./frontend/src/lib/components/PageHeader.tsx"),b=e("./node_modules/kea/lib/index.esm.js"),i=e("./frontend/src/scenes/apps/MetricsTab.tsx"),h=e("./frontend/src/scenes/apps/HistoricalExportsTab.tsx"),j=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),f=e("./frontend/src/scenes/apps/ErrorDetailsModal.tsx"),O=e("./frontend/src/lib/components/Tooltip.tsx"),L=e("./frontend/src/lib/components/icons.tsx"),s=e("./node_modules/react/jsx-runtime.js"),t=e.n(s),g={component:x,logic:n.appMetricsSceneLogic,paramsToProps:function(l){var c,_=l.params.pluginConfigId;return{pluginConfigId:(c=parseInt(_))!==null&&c!==void 0?c:0}}};function x(){var o=Object(b.useValues)(n.appMetricsSceneLogic),l=o.activeTab,c=o.pluginConfig,_=o.pluginConfigLoading,a=o.showTab,p=Object(b.useActions)(n.appMetricsSceneLogic),A=p.setActiveTab;return Object(s.jsxs)("div",{children:[Object(s.jsx)(v.a,{title:c?c.plugin_info.name:Object(s.jsx)(j.a,{}),caption:"An overview of metrics and export for this app."}),_||!l?Object(s.jsx)(j.a,{}):Object(s.jsxs)(d.a,{tabPosition:"top",animated:!1,activeKey:l,onTabClick:function(m){return A(m)},children:[a(n.AppMetricsTab.ProcessEvent)&&Object(s.jsx)(d.a.TabPane,{tab:"processEvent metrics",children:Object(s.jsx)(i.MetricsTab,{tab:n.AppMetricsTab.ProcessEvent})},n.AppMetricsTab.ProcessEvent),a(n.AppMetricsTab.OnEvent)&&Object(s.jsx)(d.a.TabPane,{tab:"onEvent metrics",children:Object(s.jsx)(i.MetricsTab,{tab:n.AppMetricsTab.OnEvent})},n.AppMetricsTab.OnEvent),a(n.AppMetricsTab.ExportEvents)&&Object(s.jsx)(d.a.TabPane,{tab:"exportEvents metrics",children:Object(s.jsx)(i.MetricsTab,{tab:n.AppMetricsTab.ExportEvents})},n.AppMetricsTab.ExportEvents),a(n.AppMetricsTab.ScheduledTask)&&Object(s.jsx)(d.a.TabPane,{tab:Object(s.jsxs)(s.Fragment,{children:["Scheduled tasks"," ",Object(s.jsx)(O.a,{title:"Shows metrics for app methods `runEveryMinute`, `runEveryHour` and `runEveryDay`",children:Object(s.jsx)(L.IconInfo,{})})]}),children:Object(s.jsx)(i.MetricsTab,{tab:n.AppMetricsTab.ScheduledTask})},n.AppMetricsTab.ScheduledTask),a(n.AppMetricsTab.HistoricalExports)&&Object(s.jsx)(d.a.TabPane,{tab:"Historical exports",children:Object(s.jsx)(h.HistoricalExportsTab,{})},n.AppMetricsTab.HistoricalExports)]}),Object(s.jsx)(f.ErrorDetailsModal,{})]})}},"./frontend/src/scenes/apps/ErrorDetailsModal.tsx":function(U,E,e){"use strict";e.r(E),e.d(E,"ErrorDetailsModal",function(){return x});var P=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),T=e.n(P),d=e("./node_modules/react/index.js"),n=e.n(d),v=e("./node_modules/kea/lib/index.esm.js"),b=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),i=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),h=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),j=e("./frontend/src/lib/components/LemonLabel/LemonLabel.tsx"),f=e("./frontend/src/lib/components/LemonButton/index.ts"),O=e("./frontend/src/lib/components/icons.tsx"),L=e("./frontend/src/lib/components/LemonModal/index.ts"),s=e("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),t=e("./node_modules/react/jsx-runtime.js"),g=e.n(t);function x(){var l,c,_=Object(v.useValues)(b.appMetricsSceneLogic),a=_.errorDetails,p=_.errorDetailsModalError,A=_.errorDetailsLoading,R=Object(v.useActions)(b.appMetricsSceneLogic),m=R.closeErrorDetailsModal,K=Object(d.useState)(0),W=T()(K,2),I=W[0],y=W[1],r=a[I];return Object(t.jsx)(L.a,{isOpen:!!p,onClose:m,title:p,width:"min(50vw, 80rem)",description:Object(t.jsx)("span",{children:r==null||(l=r.error_details)===null||l===void 0||(c=l.error.message)===null||c===void 0?void 0:c.substring(0,200)}),footer:Object(t.jsx)("div",{className:"flex items-center justify-end gap-1 h-",children:A?Object(t.jsx)(i.a,{className:"1-10"}):Object(t.jsxs)(t.Fragment,{children:[Object(t.jsxs)("span",{children:[I+1," of ",a.length," sample",a.length>1?"s":""]}),Object(t.jsx)(f.a,{icon:Object(t.jsx)(O.IconChevronLeft,{}),onClick:function(){return y(I-1)},disabled:I==0}),Object(t.jsx)(f.a,{icon:Object(t.jsx)(O.IconChevronRight,{}),onClick:function(){return y(I+1)},disabled:I==a.length-1})]})}),children:!p||A?Object(t.jsx)(i.a,{className:"h-10"}):Object(t.jsxs)("div",{className:"flex flex-col space-y-2",style:{height:"80vh"},children:[Object(t.jsxs)("div",{children:[Object(t.jsx)(j.a,{children:"When:"})," ",Object(t.jsx)(h.b,{time:r.timestamp,showSeconds:!0})]}),r.error_details.eventCount&&Object(t.jsxs)("div",{children:[Object(t.jsx)(j.a,{children:"Event Count"}),Object(t.jsx)("div",{children:r.error_details.eventCount})]}),r.error_details.error.message&&Object(t.jsx)(o,{title:"Error message",defaultIsExpanded:!0,children:Object(t.jsx)(s.a,{wrap:!0,language:s.b.JavaScript,children:r.error_details.error.message})}),r.error_details.event&&Object(t.jsx)(o,{title:"Event payload",defaultIsExpanded:!1,children:Object(t.jsx)(s.a,{wrap:!0,language:s.b.JSON,children:JSON.stringify(r.error_details.event,null,2)})}),r.error_details.error.stack&&Object(t.jsx)(o,{title:"Stack trace",defaultIsExpanded:!1,children:Object(t.jsx)(s.a,{wrap:!0,language:s.b.JavaScript,children:r.error_details.error.stack})})]})})}function o(l){var c=Object(d.useState)(l.defaultIsExpanded),_=T()(c,2),a=_[0],p=_[1];return Object(t.jsxs)("div",{className:"bg-mid border rounded",children:[Object(t.jsx)(f.a,{status:"stealth",fullWidth:!0,onClick:function(){return p(!a)},sideIcon:a?Object(t.jsx)(O.IconUnfoldLess,{}):Object(t.jsx)(O.IconUnfoldMore,{}),title:a?"Show less":"Show more",className:"bg-mid",children:l.title}),a&&Object(t.jsx)("div",{className:"bg-light p-2",children:l.children})]})}},"./frontend/src/scenes/apps/HistoricalExport.tsx":function(U,E,e){"use strict";e.r(E),e.d(E,"HistoricalExport",function(){return j});var P=e("./node_modules/antd/es/card/index.js"),T=e("./node_modules/kea/lib/index.esm.js"),d=e("./frontend/src/scenes/apps/AppMetricsGraph.tsx"),n=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),v=e("./frontend/src/scenes/apps/historicalExportLogic.ts"),b=e("./frontend/src/scenes/apps/MetricsTab.tsx"),i=e("./node_modules/react/jsx-runtime.js"),h=e.n(i);function j(f){var O,L,s,t,g,x=Object(T.useValues)(Object(v.historicalExportLogic)(f)),o=x.data,l=x.dataLoading;return Object(i.jsxs)("div",{className:"mt-4 mb-4 mr-8",children:[Object(i.jsx)(P.a,{title:"Overview",children:Object(i.jsx)(b.MetricsOverview,{tab:n.AppMetricsTab.HistoricalExports,metrics:(O=o==null?void 0:o.metrics)!==null&&O!==void 0?O:null,metricsLoading:l,exportDuration:o==null||(L=o.summary)===null||L===void 0?void 0:L.duration,exportFailureReason:o==null||(s=o.summary)===null||s===void 0?void 0:s.failure_reason})}),Object(i.jsx)(P.a,{title:"Delivery trends",className:"mt-4",children:Object(i.jsx)(d.AppMetricsGraph,{tab:n.AppMetricsTab.HistoricalExports,metrics:(t=o==null?void 0:o.metrics)!==null&&t!==void 0?t:null,metricsLoading:l})}),Object(i.jsx)(P.a,{title:"Errors",className:"mt-4",children:Object(i.jsx)(b.ErrorsOverview,{errors:(o==null?void 0:o.errors)||[],loading:l,category:"exportEvents",jobId:o==null||(g=o.summary)===null||g===void 0?void 0:g.job_id})})]})}try{j.displayName="HistoricalExport",j.__docgenInfo={description:"",displayName:"HistoricalExport",props:{pluginConfigId:{defaultValue:null,description:"",name:"pluginConfigId",required:!0,type:{name:"number"}},jobId:{defaultValue:null,description:"",name:"jobId",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/apps/HistoricalExport.tsx#HistoricalExport"]={docgenInfo:j.__docgenInfo,name:"HistoricalExport",path:"frontend/src/scenes/apps/HistoricalExport.tsx#HistoricalExport"})}catch(f){}},"./frontend/src/scenes/apps/HistoricalExportsTab.tsx":function(U,E,e){"use strict";e.r(E),e.d(E,"HistoricalExportsTab",function(){return Y});var P=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),T=e.n(P),d=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),n=e.n(d),v=e("./node_modules/core-js/modules/es.array.concat.js"),b=e.n(v),i=e("./node_modules/core-js/modules/es.object.keys.js"),h=e.n(i),j=e("./node_modules/core-js/modules/es.symbol.js"),f=e.n(j),O=e("./node_modules/core-js/modules/es.array.filter.js"),L=e.n(O),s=e("./node_modules/core-js/modules/es.object.to-string.js"),t=e.n(s),g=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),x=e.n(g),o=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),l=e.n(o),c=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),_=e.n(c),a=e("./node_modules/kea/lib/index.esm.js"),p=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),A=e("./frontend/src/lib/components/LemonTable/index.ts"),R=e("./frontend/src/scenes/apps/HistoricalExport.tsx"),m=e("./frontend/src/lib/components/LemonTable/columnUtils.tsx"),K=e("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),W=e("./node_modules/antd/es/progress/index.js"),I=e("./frontend/src/lib/components/LemonButton/index.ts"),y=e("./frontend/src/scenes/plugins/edit/interface-jobs/PluginJobConfiguration.tsx"),r=e("./node_modules/react/jsx-runtime.js"),J=e.n(r);function V(u,C){var D=Object.keys(u);if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(u);C&&(M=M.filter(function(B){return Object.getOwnPropertyDescriptor(u,B).enumerable})),D.push.apply(D,M)}return D}function z(u){for(var C=1;C<arguments.length;C++){var D=arguments[C]!=null?arguments[C]:{};C%2?V(Object(D),!0).forEach(function(M){T()(u,M,D[M])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(D)):V(Object(D)).forEach(function(M){Object.defineProperty(u,M,Object.getOwnPropertyDescriptor(D,M))})}return u}function Y(){var u=Object(a.useValues)(p.appMetricsSceneLogic),C=u.historicalExports,D=u.historicalExportsLoading,M=u.pluginConfig,B=u.interfaceJobsProps,Q=Object(a.useActions)(p.appMetricsSceneLogic),X=Q.openHistoricalExportModal;return Object(r.jsxs)("div",{className:"space-y-2",children:[Object(r.jsx)("div",{className:"flex items-center justify-end",children:Object(r.jsx)(I.a,{type:"primary",onClick:X,disabled:!B,children:"Start new export"})}),Object(r.jsx)(A.a,{dataSource:C,loading:D,columns:[{title:"Dates exported",render:function(H,S){var F=n()(S.payload.dateRange,2),N=F[0],G=F[1];return N===G?N:"".concat(N," - ").concat(G)}},{title:"Progress",width:130,render:function(H,S){switch(S.status){case"success":return Object(r.jsx)(K.a,{type:"success",className:"uppercase",children:"Success"});case"fail":return Object(r.jsx)(K.a,{type:"danger",className:"uppercase",children:"Failed"});case"not_finished":return Object(r.jsx)(W.a,{percent:Math.floor((S.progress||0)*100)})}},align:"right"},Object(m.b)(),Object(m.a)()],expandable:{expandedRowRender:function(H){if(!!M)return Object(r.jsx)(R.HistoricalExport,{pluginConfigId:M.id,jobId:H.job_id})}},useURLForSorting:!1,noSortingCancellation:!0}),B&&Object(r.jsx)(y.d,z({},B))]})}},"./frontend/src/scenes/apps/historicalExportLogic.ts":function(U,E,e){"use strict";e.r(E),e.d(E,"historicalExportLogic",function(){return l});var P=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),T=e.n(P),d=e("./node_modules/@babel/runtime/regenerator/index.js"),n=e.n(d),v=e("./node_modules/core-js/modules/es.array.concat.js"),b=e.n(v),i=e("./node_modules/core-js/modules/es.array.iterator.js"),h=e.n(i),j=e("./node_modules/core-js/modules/es.object.to-string.js"),f=e.n(j),O=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),L=e.n(O),s=e("./node_modules/kea/lib/index.esm.js"),t=e("./node_modules/kea-loaders/lib/index.js"),g=e.n(t),x=e("./frontend/src/lib/api.ts"),o=e("./frontend/src/scenes/teamLogic.tsx"),l=Object(s.kea)([Object(s.path)(["scenes","apps","historicalExportLogic"]),Object(s.props)({}),Object(s.key)(function(c){var _=c.pluginConfigId,a=c.jobId;return"".concat(_,"_").concat(a)}),Object(t.loaders)(function(c){var _=c.props;return{data:[null,{loadExportData:function(){var a=T()(n.a.mark(function A(){return n.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,x.b.get("api/projects/".concat(o.a.values.currentTeamId,"/app_metrics/").concat(_.pluginConfigId,"/historical_exports/").concat(_.jobId));case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},A)}));function p(){return a.apply(this,arguments)}return p}()}]}}),Object(s.events)(function(c){var _=c.actions;return{afterMount:_.loadExportData}})])}}]);
