var sn=Object.defineProperty,on=Object.defineProperties;var an=Object.getOwnPropertyDescriptors;var je=Object.getOwnPropertySymbols;var Me=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var Ae=(S,p,t)=>p in S?sn(S,p,{enumerable:!0,configurable:!0,writable:!0,value:t}):S[p]=t,te=(S,p)=>{for(var t in p||(p={}))Me.call(p,t)&&Ae(S,t,p[t]);if(je)for(var t of je(p))Ce.call(p,t)&&Ae(S,t,p[t]);return S},be=(S,p)=>on(S,an(p));var De=(S,p)=>{var t={};for(var O in S)Me.call(S,O)&&p.indexOf(O)<0&&(t[O]=S[O]);if(S!=null&&je)for(var O of je(S))p.indexOf(O)<0&&Ce.call(S,O)&&(t[O]=S[O]);return t};var I=(S,p,t)=>new Promise((O,N)=>{var l=A=>{try{M(t.next(A))}catch(V){N(V)}},R=A=>{try{M(t.throw(A))}catch(V){N(V)}},M=A=>A.done?O(A.value):Promise.resolve(A.value).then(l,R);M((t=t.apply(S,p)).next())});(window.webpackJsonp=window.webpackJsonp||[]).push([[283],{"./frontend/src/lib/hooks/useAnchor.ts":function(S,p,t){"use strict";t.d(p,"a",function(){return l});var O=t("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),N=t.n(O);function l(R){Object(O.useEffect)(()=>{if(R&&document.getElementById(R.substr(1))){const M=document.getElementById(R.substr(1));if(!M)return;M.classList.add("highlighted");const A=M.getBoundingClientRect().top+window.pageYOffset;window.scrollTo({top:A-50-32,behavior:"smooth"})}},[R])}},"./frontend/src/scenes/organization/Settings/Permissions/permissionsLogic.tsx":function(S,p,t){"use strict";t.d(p,"a",function(){return b}),t.d(p,"b",function(){return g});var O=t("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),N=t("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js"),l=t.n(N),R=t("./frontend/src/lib/api.ts"),M=t("./frontend/src/types.ts"),A=t("./frontend/src/lib/logic/featureFlagLogic.ts"),V=t("./frontend/src/lib/constants.tsx");const j={[M.U.FEATURE_FLAGS]:"Feature Flags"},b={[M.a.WRITE]:"View & Edit",[M.a.READ]:"View Only"},g=Object(O.kea)([Object(O.path)(["scenes","organization","Settings","Permissions","permissionsLogic"]),Object(O.connect)({values:[A.a,["featureFlags"]]}),Object(N.loaders)(r=>{let{values:d}=r;return{organizationResourcePermissions:[[],{loadOrganizationResourcePermissions:()=>I(this,null,function*(){const x=yield R.b.resourcePermissions.list();return(x==null?void 0:x.results)||[]}),updateOrganizationResourcePermission:x=>I(this,null,function*(){let{id:e,resource:$,access_level:se}=x;if(e){const W=yield R.b.resourcePermissions.update(e,{access_level:se});return d.organizationResourcePermissions.map(G=>G.id==W.id?W:G)}else{const W=yield R.b.resourcePermissions.create({resource:$,access_level:se});return[...d.organizationResourcePermissions,W]}})}]}}),Object(O.selectors)({organizationResourcePermissionsMap:[r=>[r.organizationResourcePermissions],r=>r.reduce((d,x)=>be(te({},d),{[x.resource]:x}),{})],allPermissions:[r=>[r.organizationResourcePermissionsMap],r=>Object.keys(j).map(d=>{var x,e;return{id:((x=r[d])===null||x===void 0?void 0:x.id)||null,resource:d,name:j[d],access_level:((e=r[d])===null||e===void 0?void 0:e.access_level)||M.a.WRITE}})],shouldShowPermissionsTable:[r=>[r.featureFlags],r=>r[V.i.ROLE_BASED_ACCESS]==="control"]}),Object(O.afterMount)(r=>{let{actions:d}=r;d.loadOrganizationResourcePermissions()})])},"./frontend/src/scenes/organization/Settings/Roles/rolesLogic.tsx":function(S,p,t){"use strict";t.d(p,"a",function(){return V});var O=t("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),N=t("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js"),l=t.n(N),R=t("./frontend/src/lib/api.ts"),M=t("./frontend/src/scenes/project/Settings/teamMembersLogic.tsx"),A=t("./frontend/src/types.ts");const V=Object(O.kea)([Object(O.path)(["scenes","organization","rolesLogic"]),Object(O.connect)({values:[M.b,["allMembers"]]}),Object(O.actions)({setCreateRoleModalShown:j=>({shown:j}),setRoleInFocus:j=>({role:j}),setRoleMembersInFocus:j=>({roleMembers:j}),setRoleMembersToAdd:j=>({uuids:j}),openCreateRoleModal:!0,setPermission:(j,b)=>({resource:j,access:b}),setPermissionInPlace:(j,b)=>({resource:j,access:b}),clearPermission:!0,updateRole:j=>({role:j})}),Object(O.reducers)({createRoleModalShown:[!1,{setCreateRoleModalShown:(j,b)=>{let{shown:g}=b;return g}}],roleInFocus:[null,{setRoleInFocus:(j,b)=>{let{role:g}=b;return g}}],roleMembersInFocus:[[],{setRoleMembersInFocus:(j,b)=>{let{roleMembers:g}=b;return g}}],roleMembersToAdd:[[],{setRoleMembersToAdd:(j,b)=>{let{uuids:g}=b;return g}}],permissionsToSet:[{},{setPermission:(j,b)=>{let{resource:g,access:r}=b;return be(te({},j),{[`${g}`]:r})},clearPermission:()=>({})}],roles:[[],{updateRole:(j,b)=>{let{role:g}=b;return j.map(r=>r.id==g.id?g:r)}}]}),Object(N.loaders)(j=>{let{values:b,actions:g}=j;return{roles:{loadRoles:()=>I(this,null,function*(){const r=yield R.b.roles.list();return(r==null?void 0:r.results)||[]}),createRole:r=>I(this,null,function*(){const{roles:d,roleMembersToAdd:x,permissionsToSet:e}=b,$=yield R.b.roles.create(r,e[A.U.FEATURE_FLAGS]);return yield g.addRoleMembers({role:$,membersToAdd:x}),g.setRoleMembersInFocus([]),g.setRoleMembersToAdd([]),g.clearPermission(),g.setCreateRoleModalShown(!1),[$,...d]}),deleteRole:r=>I(this,null,function*(){return yield R.b.roles.delete(r.id),b.roles.filter(d=>d.id!==r.id)})},roleMembersInFocus:[[],{loadRoleMembers:r=>I(this,null,function*(){let{roleId:d}=r;const x=yield R.b.roles.members.list(d);return(x==null?void 0:x.results)||[]}),addRoleMembers:r=>I(this,null,function*(){let{role:d,membersToAdd:x}=r;const e=yield Promise.all(x.map($=>I(this,null,function*(){return yield R.b.roles.members.create(d.id,$)})));return g.setRoleMembersToAdd([]),[...b.roleMembersInFocus,...e]}),deleteRoleMember:r=>I(this,null,function*(){let{roleMemberUuid:d}=r;return b.roleInFocus&&(yield R.b.roles.members.delete(b.roleInFocus.id,d)),b.roleMembersInFocus.filter(x=>x.id!==d)})}]}}),Object(O.listeners)(j=>{let{actions:b,values:g}=j;return{setRoleInFocus:r=>{let{role:d}=r;d&&b.loadRoleMembers({roleId:d.id}),b.setCreateRoleModalShown(!0)},openCreateRoleModal:()=>{b.setRoleInFocus(null),b.setRoleMembersInFocus([]),b.setCreateRoleModalShown(!0)},setCreateRoleModalShown:()=>{g.roleInFocus?b.setPermission(A.U.FEATURE_FLAGS,g.roleInFocus.feature_flags_access_level):b.setPermission(A.U.FEATURE_FLAGS,A.a.WRITE)},setPermissionInPlace:r=>I(this,null,function*(){let{access:d}=r;if(g.roleInFocus){d&&(yield R.b.roles.update(g.roleInFocus.id,{feature_flags_access_level:d}));const x=Object.assign({},g.roleInFocus);x.feature_flags_access_level=d,b.updateRole(x)}})}}),Object(O.selectors)({addableMembers:[j=>[j.allMembers,j.roleMembersInFocus],(j,b)=>{const g=[];for(const r of j)b.some(d=>d.user.uuid===r.user.uuid)||g.push(r.user);return g.sort((r,d)=>r.first_name.localeCompare(d.first_name)),g}]}),Object(O.afterMount)(j=>{let{actions:b}=j;b.loadRoles()})])},"./frontend/src/scenes/organization/Settings/index.tsx":function(S,p,t){"use strict";t.r(p),t.d(p,"scene",function(){return qe}),t.d(p,"OrganizationSettingsTabs",function(){return ue}),t.d(p,"OrganizationSettings",function(){return Le});var O=t("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),N=t("./frontend/src/lib/components/PageHeader.tsx"),l=t("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),R=t("./frontend/src/lib/components/CopyToClipboard.tsx"),M=t("./frontend/src/lib/components/ProfilePicture/index.ts"),A=t("./frontend/src/scenes/organization/Settings/inviteLogic.ts"),V=t("./frontend/src/scenes/organization/Settings/InviteModal.tsx"),j=t("./frontend/src/lib/components/LemonTable/index.ts"),b=t("./frontend/src/lib/components/LemonTable/columnUtils.tsx"),g=t("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),r=t("./frontend/src/lib/components/LemonButton/index.ts"),d=t("./frontend/src/lib/components/icons.tsx"),x=t("./frontend/src/lib/components/LemonDialog/index.ts"),e=t("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function $(n,s){const o=new URL(`/signup/${n}`,document.baseURI).href;return s.is_expired?Object(e.jsx)("b",{children:"Expired! Delete and recreate"}):Object(e.jsx)(R.a,{"data-attr":"invite-link",description:"invite link",children:o})}function se(n){return function(o,i){return Object(e.jsx)(r.a,{title:"Cancel the invite","data-attr":"invite-delete",icon:Object(e.jsx)(d.IconClose,{}),status:"danger",onClick:()=>{i.is_expired?n(i):x.a.open({title:`Do you want to cancel the invite for ${i.target_email}?`,primaryButton:{children:"Yes, cancel invite",status:"danger",onClick:()=>n(i)},secondaryButton:{children:"No, keep invite"}})}})}}function W(){const{invites:n,invitesLoading:s}=Object(l.useValues)(A.a),{deleteInvite:o,showInviteModal:i}=Object(l.useActions)(A.a),{preflight:a}=Object(l.useValues)(g.a),u=[{key:"user_profile_picture",render:function(m,c){return Object(e.jsx)(M.b,{name:c.first_name,email:c.target_email})},width:32},{title:"Invitee",dataIndex:"target_email",key:"target_email",render:function(m,c){return c.target_email?Object(e.jsxs)("div",{className:"flex items-center",children:[c.target_email,c.first_name?` (${c.first_name})`:""]}):Object(e.jsx)("i",{children:"no one"})},width:"20%"},Object(b.b)(),Object(b.a)(),{title:"Invite Link",dataIndex:"id",key:"link",render:(v,m)=>$(m.id,m)},{title:"",key:"actions",width:24,render:se(o)}];return Object(e.jsxs)("div",{children:[Object(e.jsxs)("h2",{id:"invites",className:"subtitle",style:{justifyContent:"space-between"},children:["Pending Invites",Object(e.jsx)(r.a,{type:"primary",onClick:i,"data-attr":"invite-teammate-button",children:"Invite team member"})]}),!(a!=null&&a.email_service_available)&&Object(e.jsx)(V.a,{}),Object(e.jsx)(j.a,{dataSource:n,columns:u,rowKey:"id",loading:s,style:{marginTop:"1rem"},"data-attr":"invites-table",emptyState:"There are no outstanding invitations. You can invite another team member above."})]})}var G=t("./frontend/src/scenes/organization/Settings/membersLogic.tsx"),C=t("./frontend/src/lib/constants.tsx"),z=t("./frontend/src/scenes/organizationLogic.tsx"),pe=t("./frontend/src/scenes/userLogic.ts"),Y=t("./frontend/src/lib/utils/permissioning.ts"),Ie=t("./frontend/src/lib/components/TZLabel/index.tsx"),fe=t("./frontend/src/lib/components/LemonButton/More.tsx"),Oe=t("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),Ee=t("./frontend/src/lib/components/LemonDivider/index.ts"),y=t("./frontend/@posthog/lemon-ui/src/index.ts");function Te(n,s){var o;const{user:i}=Object(l.useValues)(pe.a),{currentOrganization:a}=Object(l.useValues)(z.a),{removeMember:u,changeMemberAccessLevel:v}=Object(l.useActions)(G.a);if(!i)return null;const m=(o=a==null?void 0:a.membership_level)!==null&&o!==void 0?o:-1,c=(m>=C.p.Admin&&s.level<=m||s.user.uuid===i.uuid)&&s.level!==C.p.Owner,h=a?a.membership_level:null,f=Y.c.filter(L=>!Object(Y.a)(h,i,s,L)),B=Object(Y.a)(h,i,s,f);return Object(e.jsx)(fe.a,{overlay:Object(e.jsxs)(e.Fragment,{children:[B?Object(e.jsx)("div",{children:B}):f.map(L=>Object(e.jsx)(r.a,{status:"stealth",fullWidth:!0,onClick:U=>{if(U.preventDefault(),!i)throw Error;if(L===C.p.Owner){var D;x.a.open({title:`Transfer organization ownership to ${s.user.first_name}?`,description:`You will no longer be the owner of ${(D=i.organization)===null||D===void 0?void 0:D.name}. After the transfer you will become an administrator.`,primaryButton:{status:"danger",children:"Transfer Ownership",onClick:()=>v(s,L)},secondaryButton:{children:"Cancel"}})}else v(s,L)},"data-test-level":L,children:L===C.p.Owner?Object(e.jsx)(e.Fragment,{children:"Transfer organization ownership"}):L>s.level?Object(e.jsxs)(e.Fragment,{children:["Upgrade to ",Y.b.get(L)]}):Object(e.jsxs)(e.Fragment,{children:["Downgrade to ",Y.b.get(L)]})},`${s.user.uuid}-level-${L}`)),c?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Ee.a,{}),Object(e.jsx)(r.a,{status:"danger","data-attr":"delete-org-membership",onClick:()=>{var L;if(!i)throw Error;x.a.open({title:`${s.user.uuid==i.uuid?"Leave":`Remove ${s.user.first_name} from`} organization ${(L=i.organization)===null||L===void 0?void 0:L.name}?`,primaryButton:{children:s.user.uuid==i.uuid?"Leave":"Remove",status:"danger",onClick:()=>u(s)},secondaryButton:{children:"Cancel"}})},fullWidth:!0,children:s.user.uuid!==i.uuid?"Remove from organization":"Leave organization"})]}):null]})})}function ie(n){let{user:s}=n;const{filteredMembers:o,membersLoading:i,search:a}=Object(l.useValues)(G.a),{setSearch:u}=Object(l.useActions)(G.a),v=[{key:"user_profile_picture",render:function(c,h){return Object(e.jsx)(M.b,{name:h.user.first_name,email:h.user.email})},width:32},{title:"Name",key:"user_first_name",render:(m,c)=>c.user.uuid==s.uuid?`${c.user.first_name} (me)`:c.user.first_name,sorter:(m,c)=>m.user.first_name.localeCompare(c.user.first_name)},{title:"Email",key:"user_email",render:(m,c)=>c.user.email,sorter:(m,c)=>m.user.email.localeCompare(c.user.email)},{title:"Level",dataIndex:"level",key:"level",render:function(c,h){var f;return Object(e.jsx)(Oe.a,{"data-attr":"membership-level",children:h.level===C.p.Owner?"Organization owner":`Project ${(f=Y.b.get(h.level))!==null&&f!==void 0?f:`unknown (${h.level})`}`})},sorter:(m,c)=>m.level-c.level},{title:"Joined",dataIndex:"joined_at",key:"joined_at",render:function(c){return Object(e.jsx)("div",{className:"whitespace-nowrap",children:Object(e.jsx)(Ie.a,{time:c})})},sorter:(m,c)=>m.joined_at.localeCompare(c.joined_at)},{key:"actions",width:0,render:Te}];return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h2",{className:"subtitle",children:"Members"}),Object(e.jsx)(y.LemonInput,{type:"search",placeholder:"Search for members",value:a,onChange:u}),Object(e.jsx)(j.a,{dataSource:o,columns:v,rowKey:"id",style:{marginTop:"1rem"},loading:i,"data-attr":"org-members-table",defaultSorting:{columnKey:"level",order:-1},pagination:{pageSize:50}})]})}try{ie.displayName="Members",ie.__docgenInfo={description:"",displayName:"Members",props:{user:{defaultValue:null,description:"Currently logged-in user.",name:"user",required:!0,type:{name:"UserType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/organization/Settings/Members.tsx#Members"]={docgenInfo:ie.__docgenInfo,name:"Members",path:"frontend/src/scenes/organization/Settings/Members.tsx#Members"})}catch(n){}function oe(n){let{isOpen:s,setIsOpen:o}=n;const{currentOrganization:i,organizationBeingDeleted:a}=Object(l.useValues)(z.a),{deleteOrganization:u}=Object(l.useActions)(z.a),[v,m]=Object(O.useState)(!1),c=!!i&&(a==null?void 0:a.id)===i.id;return Object(e.jsxs)(y.LemonModal,{title:"Delete the entire organization?",onClose:c?void 0:()=>o(!1),footer:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(y.LemonButton,{disabled:c,type:"secondary",onClick:()=>o(!1),children:"Cancel"}),Object(e.jsx)(y.LemonButton,{type:"primary",disabled:!v,loading:c,"data-attr":"delete-organization-ok",status:"danger",onClick:i?()=>u(i):void 0,children:`Delete ${i?i.name:"the current organization"}`})]}),isOpen:s,children:[Object(e.jsxs)("p",{children:["Organization deletion ",Object(e.jsx)("b",{children:"cannot be undone"}),". You will lose all data, ",Object(e.jsx)("b",{children:"including all events"}),", related to all projects within this organization."]}),Object(e.jsxs)("p",{children:["Please type"," ",Object(e.jsx)("strong",{children:i?i.name:"this organization's name"})," to confirm."]}),Object(e.jsx)(y.LemonInput,{type:"text",onChange:h=>{i&&m(h.toLowerCase()===i.name.toLowerCase())}})]})}function ae(n){let{isRestricted:s}=n;const{currentOrganization:o}=Object(l.useValues)(z.a),[i,a]=Object(O.useState)(!1);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"text-danger",children:[Object(e.jsx)("h2",{className:"text-danger subtitle",children:"Danger Zone"}),Object(e.jsxs)("div",{className:"mt-4",children:[!s&&Object(e.jsxs)("p",{className:"text-danger",children:["This is ",Object(e.jsx)("b",{children:"irreversible"}),". Please be certain."]}),Object(e.jsxs)(y.LemonButton,{status:"danger",type:"secondary",onClick:()=>a(!0),"data-attr":"delete-organization-button",icon:Object(e.jsx)(d.IconDelete,{}),disabled:s,children:["Delete ",(o==null?void 0:o.name)||"the current organization"]})]})]}),Object(e.jsx)(oe,{isOpen:i,setIsOpen:a})]})}try{oe.displayName="DeleteOrganizationModal",oe.__docgenInfo={description:"",displayName:"DeleteOrganizationModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},setIsOpen:{defaultValue:null,description:"",name:"setIsOpen",required:!0,type:{name:"Dispatch<SetStateAction<boolean>>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/organization/Settings/DangerZone.tsx#DeleteOrganizationModal"]={docgenInfo:oe.__docgenInfo,name:"DeleteOrganizationModal",path:"frontend/src/scenes/organization/Settings/DangerZone.tsx#DeleteOrganizationModal"})}catch(n){}try{ae.displayName="DangerZone",ae.__docgenInfo={description:"",displayName:"DangerZone",props:{isRestricted:{defaultValue:null,description:"",name:"isRestricted",required:!0,type:{name:"boolean"}},restrictionReason:{defaultValue:null,description:"",name:"restrictionReason",required:!0,type:{name:"string | null"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/organization/Settings/DangerZone.tsx#DangerZone"]={docgenInfo:ae.__docgenInfo,name:"DangerZone",path:"frontend/src/scenes/organization/Settings/DangerZone.tsx#DangerZone"})}catch(n){}var Z=t("./frontend/src/lib/components/RestrictedArea.tsx"),Pe=t("./frontend/src/lib/hooks/useAnchor.ts"),ge=t("./frontend/src/lib/components/Tooltip.tsx"),H=t("./frontend/src/lib/api.ts"),re=t("./frontend/src/lib/components/lemonToast.tsx"),P=t("./frontend/src/types.ts"),he=t("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.0/node_modules/kea-forms/lib/index.js"),Ne=t("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js");const F=Object(l.kea)([Object(l.path)(["scenes","organization","verifiedDomainsLogic"]),Object(l.connect)({values:[z.a,["currentOrganization"]]}),Object(l.actions)({replaceDomain:n=>({domain:n}),setAddModalShown:n=>({shown:n}),setConfigureSAMLModalId:n=>({id:n}),setVerifyModal:n=>({id:n})}),Object(l.reducers)({verifiedDomains:[[],{replaceDomain:(n,s)=>{let{domain:o}=s;const i=[...n.filter(a=>{let{id:u}=a;return u!==o.id}),o];return i.sort((a,u)=>a.domain.localeCompare(u.domain)),i}}],addModalShown:[!1,{setAddModalShown:(n,s)=>{let{shown:o}=s;return o},addVerifiedDomainSuccess:()=>!1}],configureSAMLModalId:[null,{setConfigureSAMLModalId:(n,s)=>{let{id:o}=s;return o}}],verifyModal:[null,{setVerifyModal:(n,s)=>{let{id:o}=s;return o}}]}),Object(Ne.loaders)(n=>{let{values:s,actions:o}=n;return{verifiedDomains:[[],{loadVerifiedDomains:()=>I(this,null,function*(){var i;return(yield H.b.get(`api/organizations/${(i=s.currentOrganization)===null||i===void 0?void 0:i.id}/domains`)).results}),addVerifiedDomain:i=>I(this,null,function*(){var a;return[yield H.b.create(`api/organizations/${(a=s.currentOrganization)===null||a===void 0?void 0:a.id}/domains`,{domain:i}),...s.verifiedDomains]}),deleteVerifiedDomain:i=>I(this,null,function*(){var a;return yield H.b.delete(`api/organizations/${(a=s.currentOrganization)===null||a===void 0?void 0:a.id}/domains/${i}`),[...s.verifiedDomains.filter(u=>u.id!==i)]})}],updatingDomain:[!1,{updateDomain:i=>I(this,null,function*(){var a;const u=yield H.b.update(`api/organizations/${(a=s.currentOrganization)===null||a===void 0?void 0:a.id}/domains/${i.id}`,be(te({},i),{id:void 0}));return re.d.success("Domain updated successfully! Changes will take immediately."),o.replaceDomain(u),!1}),verifyDomain:()=>I(this,null,function*(){var i;const a=yield H.b.create(`api/organizations/${(i=s.currentOrganization)===null||i===void 0?void 0:i.id}/domains/${s.verifyModal}/verify`);return a.is_verified?re.d.success("Domain verified successfully."):re.d.warning("We could not verify your domain yet. DNS propagation may take up to 72 hours. Please try again later."),o.replaceDomain(a),o.setVerifyModal(null),!1})}]}}),Object(l.listeners)(n=>{let{actions:s,values:o}=n;return{setConfigureSAMLModalId:i=>{let{id:a}=i;const u=o.verifiedDomains.find(v=>{let{id:m}=v;return m===a});if(a&&u){const{saml_acs_url:v,saml_entity_id:m,saml_x509_cert:c}=u;s.setSamlConfigValues({saml_acs_url:v,saml_entity_id:m,saml_x509_cert:c,id:a})}}}}),Object(l.selectors)({domainBeingVerified:[n=>[n.verifiedDomains,n.verifyModal],(n,s)=>s&&n.find(o=>{let{id:i}=o;return i===s})||null],isSSOEnforcementAvailable:[n=>[n.currentOrganization],n=>{var s;return(s=n==null?void 0:n.available_features.includes(P.e.SSO_ENFORCEMENT))!==null&&s!==void 0?s:!1}],isSAMLAvailable:[n=>[n.currentOrganization],n=>{var s;return(s=n==null?void 0:n.available_features.includes(P.e.SAML))!==null&&s!==void 0?s:!1}]}),Object(l.afterMount)(n=>{let{actions:s}=n;return s.loadVerifiedDomains()}),Object(he.forms)(n=>{let{actions:s,values:o}=n;return{samlConfig:{defaults:{},errors:i=>({saml_acs_url:i.saml_acs_url&&!i.saml_acs_url.match(C.w)?"Please enter a valid URL, including https://":void 0}),submit:(i,a)=>I(this,null,function*(){var u;const h=i,{id:v}=h,m=De(h,["id"]);if(!v)return;const c=yield H.b.update(`api/organizations/${(u=o.currentOrganization)===null||u===void 0?void 0:u.id}/domains/${i.id}`,te({},m));a(),s.replaceDomain(c),s.setConfigureSAMLModalId(null),s.setSamlConfigValues({}),re.d.success(`SAML configuration for ${c.domain} updated successfully.`)})}}})]);var xe=t("./node_modules/.pnpm/@ant-design+icons@4.7.0_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),K=t("./frontend/src/lib/components/LemonModal/index.ts");function ze(){const{addModalShown:n,verifiedDomainsLoading:s}=Object(l.useValues)(F),{setAddModalShown:o,addVerifiedDomain:i}=Object(l.useActions)(F),[a,u]=Object(O.useState)(""),[v,m]=Object(O.useState)(!1),c=!a||!a.match(C.e),h=()=>{u(""),m(!1)},f=()=>{o(!1),h()},B=()=>{m(!0),c||(i(a),h())};return Object(e.jsxs)(K.a,{onClose:f,isOpen:n,title:"Add authentication domain",footer:Object(e.jsx)(r.a,{type:"primary",disabled:a===""||v&&c||s,onClick:B,children:"Add domain"}),children:[Object(e.jsx)(y.LemonInput,{placeholder:"posthog.com",autoFocus:!0,value:a,onChange:u,onPressEnter:B}),v&&c&&Object(e.jsx)("span",{className:"text-danger text-xs",children:"Please enter a valid domain or subdomain name (e.g. my.posthog.com)"})]})}var Fe=t("./frontend/src/scenes/organization/Settings/VerifiedDomains/SSOSelect.tsx"),J=t("./frontend/src/lib/forms/Field.tsx");function we(){const{domainBeingVerified:n,updatingDomainLoading:s}=Object(l.useValues)(F),{setVerifyModal:o,verifyDomain:i}=Object(l.useActions)(F),a=`_posthog-challenge.${n==null?void 0:n.domain}.`;return Object(e.jsx)(K.a,{isOpen:!!n,onClose:()=>o(null),title:"Verify your domain",description:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Oe.a,{className:"uppercase",children:(n==null?void 0:n.domain)||""}),Object(e.jsx)("p",{children:"To verify your domain, you need to add a record to your DNS zone."})]}),footer:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(r.a,{type:"secondary",onClick:()=>o(null),children:"Verify later"}),Object(e.jsx)(r.a,{type:"primary",disabled:s,onClick:i,children:"Verify"})]}),children:Object(e.jsx)("div",{children:Object(e.jsxs)("ol",{children:[Object(e.jsx)("li",{children:"Sign in to your DNS provider."}),Object(e.jsxs)("li",{children:["Add the following ",Object(e.jsx)("b",{children:"TXT"})," record.",Object(e.jsxs)("div",{className:"my-4 space-y-2",children:[Object(e.jsx)(J.b,{label:"Name",children:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)("div",{className:"border rounded p-2 h-10 flex-1",children:a}),Object(e.jsx)(R.a,{explicitValue:a})]})}),Object(e.jsx)(J.b,{label:"Value or content",children:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)("div",{className:"border rounded p-2 h-10 flex-1",children:n==null?void 0:n.verification_challenge}),Object(e.jsx)(R.a,{explicitValue:n==null?void 0:n.verification_challenge})]})}),Object(e.jsx)(J.b,{label:"TTL",children:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)("div",{className:"border rounded p-2 h-10 flex-1",children:"Default or 3600"}),Object(e.jsx)(R.a,{explicitValue:"3600"})]})})]})]}),Object(e.jsx)("li",{children:"Press verify below."})]})})})}var ye=t("./frontend/src/lib/components/Link.tsx"),Ve=t("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),Be=t("./frontend/src/lib/components/AlertMessage/index.ts"),Se=t("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),Ue=t("./frontend/src/lib/components/LemonTextArea/LemonTextArea.tsx");function $e(){const{configureSAMLModalId:n,isSamlConfigSubmitting:s,samlConfig:o}=Object(l.useValues)(F),{setConfigureSAMLModalId:i}=Object(l.useActions)(F),a=o.saml_acs_url&&o.saml_entity_id&&o.saml_x509_cert,u=()=>{i(null)};return Object(e.jsx)(K.a,{onClose:u,isOpen:!!n,title:"",simple:!0,children:Object(e.jsxs)(he.Form,{logic:F,formKey:"samlConfig",enableFormOnSubmit:!0,className:"LemonModal__layout ",children:[Object(e.jsx)(K.a.Header,{children:Object(e.jsx)("h3",{children:"Configure SAML authentication and provisioning"})}),Object(e.jsxs)(K.a.Content,{className:"space-y-2",children:[Object(e.jsx)(J.a,{name:"saml_acs_url",label:"SAML ACS URL",children:Object(e.jsx)(Se.a,{className:"ph-ignore-input",placeholder:"Your IdP's ACS or single sign-on URL."})}),Object(e.jsx)(J.a,{name:"saml_entity_id",label:"SAML Entity ID",children:Object(e.jsx)(Se.a,{className:"ph-ignore-input",placeholder:"Entity ID provided by your IdP."})}),Object(e.jsx)(J.a,{name:"saml_x509_cert",label:"SAML X.509 Certificate",children:Object(e.jsx)(Ue.a,{className:"ph-ignore-input",minRows:10,placeholder:`Enter the public certificate of your IdP. Keep all line breaks.
-----BEGIN CERTIFICATE-----
MIICVjCCAb+gAwIBAgIBADANBgkqhkiG9w0BAQ0FADBIMQswCQYDVQQGEwJ1czEL
-----END CERTIFICATE-----`})}),!a&&Object(e.jsx)(Be.a,{type:"info",children:"SAML will not be enabled unless you enter all attributes above. However you can still settings as draft."})]}),Object(e.jsx)(K.a.Footer,{children:Object(e.jsx)(r.a,{loading:s,type:"primary",htmlType:"submit",children:"Save settings"})})]})})}const Q={marginRight:4,fontSize:"1.15em",paddingTop:2};function _e(){const{verifiedDomainsLoading:n,updatingDomainLoading:s}=Object(l.useValues)(F),{setAddModalShown:o}=Object(l.useActions)(F);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"flex items-center",children:[Object(e.jsxs)("div",{style:{flexGrow:1},children:[Object(e.jsx)("div",{id:"domain-whitelist"})," ",Object(e.jsx)("h2",{id:"authentication-domains",className:"subtitle",children:"Authentication domains"}),Object(e.jsx)("p",{className:"text-muted-alt",children:"Enable users to sign up automatically with an email address on verified domains and enforce SSO for accounts under your domains."})]}),Object(e.jsx)(r.a,{type:"primary",onClick:()=>o(!0),disabled:n||s,children:"Add domain"})]}),Object(e.jsx)(Ke,{})]})}function Ke(){const{verifiedDomains:n,verifiedDomainsLoading:s,currentOrganization:o,updatingDomainLoading:i,isSSOEnforcementAvailable:a,isSAMLAvailable:u}=Object(l.useValues)(F),{updateDomain:v,deleteVerifiedDomain:m,setVerifyModal:c,setConfigureSAMLModalId:h}=Object(l.useActions)(F),{preflight:f}=Object(l.useValues)(g.a),B=[{key:"domain",title:"Domain name",dataIndex:"domain",render:function(U,D){let{domain:E}=D;return Object(e.jsx)(Oe.a,{children:E})}},...f!=null&&f.cloud?[{key:"is_verified",title:Object(e.jsxs)(e.Fragment,{children:["Verification",Object(e.jsx)(ge.a,{title:"Verification (through DNS) is required to use domains for authentication (e.g. SAML or enforce SSO).",children:Object(e.jsx)(xe.a,{style:{marginLeft:4}})})]}),render:function(U,D){let{is_verified:E,verified_at:T}=D;return E?Object(e.jsxs)("div",{className:"flex items-center text-success",children:[Object(e.jsx)(d.IconCheckmark,{style:Q})," Verified"]}):T?Object(e.jsxs)("div",{className:"flex items-center text-danger",children:[Object(e.jsx)(d.IconExclamation,{style:Q})," Verification expired"]}):Object(e.jsxs)("div",{className:"flex items-center text-warning",children:[Object(e.jsx)(d.IconWarning,{style:Q})," Pending verification"]})}}]:[],{key:"jit_provisioning_enabled",title:Object(e.jsxs)(e.Fragment,{children:["Automatic provisioning"," ",Object(e.jsx)(ge.a,{title:`Enables just-in-time provisioning. If a user logs in with SSO with an email address on this domain an account will be created in ${(o==null?void 0:o.name)||"this organization"} if it does not exist.`,children:Object(e.jsx)(xe.a,{})})]}),render:function(U,D){let{jit_provisioning_enabled:E,id:T,is_verified:w}=D;return w?Object(e.jsx)("div",{className:"flex items-center",children:Object(e.jsx)(Ve.a,{checked:E,disabled:i||!w,onChange:k=>v({id:T,jit_provisioning_enabled:k}),label:Object(e.jsx)("span",{className:"font-normal",children:E?"Enabled":"Disabled"})})}):Object(e.jsx)("i",{className:"text-muted-alt",children:"Verify domain to enable automatic provisioning"})}},{key:"sso_enforcement",title:Object(e.jsxs)(e.Fragment,{children:["Enforce SSO"," ",Object(e.jsx)(ge.a,{title:"Require users with email addresses on this domain to always log in using a specific SSO provider.",children:Object(e.jsx)(xe.a,{})})]}),render:function(U,D,E){let{sso_enforcement:T,is_verified:w,id:k,has_saml:q}=D;return a?w?Object(e.jsx)(Fe.a,{value:T,loading:i,onChange:ee=>v({id:k,sso_enforcement:ee}),samlAvailable:q}):Object(e.jsx)("i",{className:"text-muted-alt",children:"Verify domain to enable"}):E===0?Object(e.jsxs)(ye.a,{to:Object(C.D)(f==null?void 0:f.cloud).url,target:Object(C.D)(f==null?void 0:f.cloud).target,className:"flex items-center",children:[Object(e.jsx)(d.IconLock,{style:{color:"var(--warning)",marginLeft:4}})," Upgrade to enable SSO enforcement"]}):Object(e.jsx)(e.Fragment,{})}},{key:"saml",title:"SAML",render:function(U,D,E){let{is_verified:T,saml_acs_url:w,saml_entity_id:k,saml_x509_cert:q,has_saml:ee}=D;return u?T?Object(e.jsx)(e.Fragment,{children:ee?Object(e.jsxs)("div",{className:"flex items-center text-success",children:[Object(e.jsx)(d.IconCheckmark,{style:Q})," SAML enabled"]}):w||k||q?Object(e.jsxs)("div",{className:"flex items-center text-warning",children:[Object(e.jsx)(d.IconWarning,{style:Q})," SAML partially configured"]}):Object(e.jsxs)("div",{className:"flex items-center",children:[Object(e.jsx)(d.IconOffline,{style:Q})," SAML not set up"]})}):Object(e.jsx)("i",{className:"text-muted-alt",children:"Verify domain to enable"}):E===0?Object(e.jsxs)(ye.a,{to:Object(C.D)(f==null?void 0:f.cloud).url,target:Object(C.D)(f==null?void 0:f.cloud).target,className:"flex items-center",children:[Object(e.jsx)(d.IconLock,{style:{color:"var(--warning)",marginLeft:4}})," Upgrade to enable SAML"]}):Object(e.jsx)(e.Fragment,{})}},{key:"actions",width:32,align:"center",render:function(U,D){let{is_verified:E,id:T,domain:w}=D;return E?Object(e.jsx)(fe.a,{overlay:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(r.a,{status:"stealth",onClick:()=>h(T),fullWidth:!0,disabled:!u,title:u?void 0:"Upgrade to enable SAML",children:"Configure SAML"}),Object(e.jsxs)(r.a,{status:"danger",onClick:()=>x.a.open({title:`Remove ${w}?`,description:"This cannot be undone. If you have SAML configured or SSO enforced,it will be immediately disabled.",primaryButton:{status:"danger",children:"Remove domain",onClick:()=>m(T)},secondaryButton:{children:"Cancel"}}),fullWidth:!0,children:[Object(e.jsx)(d.IconDelete,{})," Remove domain"]})]}),style:{display:"inline-block"}}):Object(e.jsx)(r.a,{type:"primary",onClick:()=>c(T),children:"Verify"})}}];return Object(e.jsxs)("div",{children:[Object(e.jsx)(j.a,{dataSource:n,columns:B,loading:s,rowKey:"id",emptyState:"You haven't registered any authentication domains yet."}),Object(e.jsx)(ze,{}),Object(e.jsx)($e,{}),Object(e.jsx)(we,{})]})}var X=t("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/tabs/index.js"),ve=t("./frontend/src/scenes/urls.ts"),ke=t("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/row/index.js"),We=t("./frontend/src/lib/components/LemonSelectMultiple/LemonSelectMultiple.tsx"),Ge=t("./frontend/src/lib/components/Spinner/Spinner.tsx"),Ye=t("./frontend/src/lib/components/UserSelectItem.tsx"),le=t("./frontend/src/scenes/organization/Settings/Roles/rolesLogic.tsx");function Ze(){const{roleInFocus:n,createRoleModalShown:s,roleMembersToAdd:o,roleMembersInFocusLoading:i,addableMembers:a,rolesLoading:u,roleMembersInFocus:v,permissionsToSet:m}=Object(l.useValues)(le.a),{setCreateRoleModalShown:c,setRoleMembersToAdd:h,createRole:f,deleteRoleMember:B,addRoleMembers:L,setPermission:U,setPermissionInPlace:D}=Object(l.useActions)(le.a),{isAdminOrOwner:E}=Object(l.useValues)(z.a),[T,w]=Object(O.useState)(""),k=()=>{c(!1),h([])},q=()=>{f(T),w("")},ee=_=>{_&&(U(P.U.FEATURE_FLAGS,_),D(P.U.FEATURE_FLAGS,_))},ne=!n;return Object(e.jsxs)(K.a,{onClose:k,isOpen:s,title:ne?"Create role":`Edit ${n.name} role`,footer:ne&&Object(e.jsx)(r.a,{type:"primary",disabled:u,onClick:q,children:u?Object(e.jsx)(Ge.a,{monocolor:!0}):"Create role"}),children:[ne&&Object(e.jsxs)("div",{className:"mb-5",children:[Object(e.jsx)("h5",{children:"Role Name"}),Object(e.jsx)(y.LemonInput,{placeholder:"Product",autoFocus:!0,value:T,onChange:w})]}),E&&Object(e.jsxs)("div",{className:"mb-5",children:[Object(e.jsx)("h5",{children:"Members"}),Object(e.jsxs)("div",{className:"flex gap-2",children:[Object(e.jsx)("div",{className:"flex-1",children:Object(e.jsx)(We.a,{placeholder:"Search for team members to add\u2026",value:o,loading:i,onChange:_=>h(_),filterOption:!0,mode:"multiple","data-attr":"subscribed-emails",options:Object(Ye.a)(a,"uuid")})}),!ne&&Object(e.jsx)(r.a,{type:"primary",loading:i,disabled:o.length===0,onClick:()=>L({role:n,membersToAdd:o}),children:"Add"})]})]}),!ne&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h5",{children:"Role Members"}),v.length>0?Object(e.jsx)("div",{className:"mt-2 pb-2 rounded overflow-y-auto",style:{maxHeight:300},children:v.map(_=>Object(e.jsx)(He,{member:_,deleteMember:tn=>B({roleMemberUuid:tn}),isAdminOrOwner:!!E},_.id))}):Object(e.jsx)("div",{className:"text-muted mb-2",children:"No members added yet"})]}),Object(e.jsx)(y.LemonDivider,{}),Object(e.jsx)("h5",{className:"mt-4",children:"Permissions"}),Object(e.jsxs)(ke.a,{justify:"space-between",align:"middle",children:[Object(e.jsx)("b",{className:"",children:"Feature Flags"}),Object(e.jsx)(y.LemonSelect,{disabled:!E,value:m[P.U.FEATURE_FLAGS],onChange:ee,options:[{value:P.a.WRITE,label:"View & Edit"},{value:P.a.READ,label:"View Only"}]})]})]})}function He(n){let{member:s,deleteMember:o,isAdminOrOwner:i}=n;const{user:a}=s;return Object(e.jsxs)("div",{className:"flex items-center justify-between mt-2 h-8",children:[Object(e.jsx)(M.b,{email:a.email,name:a.first_name,size:"md",showName:!0}),i&&o&&Object(e.jsx)(r.a,{icon:Object(e.jsx)(d.IconDelete,{}),onClick:()=>o(s.id),tooltip:"Remove user from role",status:"primary-alt",type:"tertiary",size:"small"})]})}function ce(n){let{isRestricted:s}=n;const{roles:o,rolesLoading:i}=Object(l.useValues)(le.a),{setRoleInFocus:a,openCreateRoleModal:u,deleteRole:v}=Object(l.useActions)(le.a),m=[{key:"name",title:"Role",dataIndex:"name",render:function(h,f){return Object(e.jsx)("div",{className:"row-name text-primary cursor-pointer",onClick:()=>{a(f)},children:f.name})}},{key:"actions",width:0,sticky:!0,render:function(h,f){return Object(e.jsx)(fe.a,{overlay:s?"You don't have permission to delete roles":Object(e.jsx)(y.LemonButton,{onClick:()=>v(f),status:"danger",children:"Delete"})})}}];return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"flex items-center",children:[Object(e.jsxs)("div",{style:{flexGrow:1},children:[Object(e.jsx)("h2",{id:"roles",className:"subtitle",children:"Roles"}),Object(e.jsx)("p",{className:"text-muted-alt",children:"Create roles to provide fine-grained permissions to users across posthog resources. Admins+ will always have full edit access regardless of default or role."})]}),!s&&Object(e.jsx)(y.LemonButton,{type:"primary",onClick:u,"data-attr":"create-role-button",children:"Create role"})]}),Object(e.jsx)(j.a,{dataSource:o,columns:m,rowKey:()=>"id",expandable:{expandedRowRender:function(h){return Object(e.jsxs)(X.a,{defaultActiveKey:"members",children:[Object(e.jsx)(X.a.TabPane,{tab:"Members",children:Object(e.jsx)("div",{className:"flex flex-col my-4",children:h.members.map(f=>Object(e.jsx)("div",{children:f.user.first_name},f.id))})},"members"),Object(e.jsx)(X.a.TabPane,{tab:"Feature flags",children:Object(e.jsx)("div",{className:"mb-4",children:h.feature_flags_access_level===P.a.WRITE?"All":Object(e.jsx)("div",{className:"flex flex-col",children:h.associated_flags.map(f=>Object(e.jsx)(y.Link,{to:ve.a.featureFlag(f.id),children:f.key},f.id))})})},"feature-flags")]})}},style:{marginTop:"1rem"},loading:i,"data-attr":"org-roles-table",defaultSorting:{columnKey:"level",order:-1},pagination:{pageSize:50}}),Object(e.jsx)(Ze,{})]})}try{ce.displayName="Roles",ce.__docgenInfo={description:"",displayName:"Roles",props:{isRestricted:{defaultValue:null,description:"",name:"isRestricted",required:!0,type:{name:"boolean"}},restrictionReason:{defaultValue:null,description:"",name:"restrictionReason",required:!0,type:{name:"string | null"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/organization/Settings/Roles/Roles.tsx#Roles"]={docgenInfo:ce.__docgenInfo,name:"Roles",path:"frontend/src/scenes/organization/Settings/Roles/Roles.tsx#Roles"})}catch(n){}var Je=t("./frontend/src/lib/utils.tsx"),de=t("./frontend/src/scenes/organization/Settings/Permissions/permissionsLogic.tsx");function me(n){let{isRestricted:s}=n;const{allPermissions:o}=Object(l.useValues)(de.b),{updateOrganizationResourcePermission:i}=Object(l.useActions)(de.b),a=[{key:"name",title:"Resource",dataIndex:"name",render:function(v,m){return Object(e.jsx)("b",{children:Object(Je.i)(m.resource)})}},{key:"access_level",title:"Access Level",dataIndex:"access_level",render:function(v,m){return Object(e.jsx)(y.LemonSelect,{disabled:s,value:m.access_level,onChange:c=>i({id:m.id,resource:m.resource,access_level:c}),options:[{value:P.a.WRITE,label:de.a[P.a.WRITE]},{value:P.a.READ,label:de.a[P.a.READ]}]})}}];return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("div",{className:"flex items-center",children:Object(e.jsxs)("div",{style:{flexGrow:1},children:[Object(e.jsx)("h2",{id:"roles",className:"subtitle",children:"Permission Defaults"}),Object(e.jsx)("p",{className:"text-muted-alt",children:"Add organizational default permission levels for posthog resources. Use roles to apply permissions to specific sets of users."})]})}),Object(e.jsx)(j.a,{dataSource:o,columns:a,rowKey:()=>"id",style:{marginTop:"1rem"},loading:!1,"data-attr":"org-permissions-table",defaultSorting:{columnKey:"level",order:-1},pagination:{pageSize:50}})]})}try{me.displayName="Permissions",me.__docgenInfo={description:"",displayName:"Permissions",props:{isRestricted:{defaultValue:null,description:"",name:"isRestricted",required:!0,type:{name:"boolean"}},restrictionReason:{defaultValue:null,description:"",name:"restrictionReason",required:!0,type:{name:"string | null"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/organization/Settings/Permissions/Permissions.tsx#Permissions"]={docgenInfo:me.__docgenInfo,name:"Permissions",path:"frontend/src/scenes/organization/Settings/Permissions/Permissions.tsx#Permissions"})}catch(n){}var Qe=t("./frontend/src/lib/components/PayGateMini/PayGateMini.tsx"),Xe=t("./frontend/src/lib/logic/featureFlagLogic.ts");const qe={component:Le,logic:z.a};let ue;(function(n){n.GENERAL="general",n.ROLE_ACCESS="role_access"})(ue||(ue={}));function en(n){let{isRestricted:s}=n;const{currentOrganization:o,currentOrganizationLoading:i}=Object(l.useValues)(z.a),{updateOrganization:a}=Object(l.useActions)(z.a),[u,v]=Object(O.useState)((o==null?void 0:o.name)||"");return Object(e.jsxs)("div",{style:{maxWidth:"40rem"},children:[Object(e.jsx)("h2",{id:"name",className:"subtitle mt-0",children:"Display Name"}),Object(e.jsx)(y.LemonInput,{className:"mb-4",value:u,onChange:v,disabled:s}),Object(e.jsx)(y.LemonButton,{type:"primary",onClick:m=>{m.preventDefault(),a({name:u})},disabled:s||!u||!o||u===o.name,loading:i,children:"Rename Organization"})]})}function nn(n){let{isRestricted:s}=n;const{currentOrganization:o}=Object(l.useValues)(z.a),{updateOrganization:i}=Object(l.useActions)(z.a);return Object(e.jsxs)("div",{children:[Object(e.jsx)("h2",{id:"notification-preferences",className:"subtitle",children:"Notification Preferences"}),Object(e.jsx)("div",{children:Object(e.jsx)(y.LemonSwitch,{"data-attr":"is-member-join-email-enabled-switch",onChange:a=>{i({is_member_join_email_enabled:a})},checked:!!(o!=null&&o.is_member_join_email_enabled),disabled:s||!o,label:"Email all current members when a new member joins",bordered:!0})})]})}const Re=Object(l.kea)({path:["scenes","organization","Settings","index"],actions:{setTab:n=>({tab:n})},reducers:{tab:[ue.GENERAL,{setTab:(n,s)=>{let{tab:o}=s;return o}}]},actionToUrl:()=>({setTab:n=>{let{tab:s}=n;return`${ve.a.organizationSettings()}?tab=${s}`}}),urlToAction:n=>{let{values:s,actions:o}=n;return{[ve.a.organizationSettings()]:(i,a)=>{a.tab&&s.tab!==a.tab&&o.setTab(a.tab)}}}});function Le(){const{user:n}=Object(l.useValues)(pe.a),{featureFlags:s}=Object(l.useValues)(Xe.a);Object(Pe.a)(location.hash);const{tab:o}=Object(l.useValues)(Re),{setTab:i}=Object(l.useActions)(Re);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(N.a,{title:"Organization Settings",caption:"View and manage your organization here. Build an even better product together."}),Object(e.jsxs)(X.a,{activeKey:o,destroyInactiveTabPane:!0,onChange:a=>i(a),children:[Object(e.jsx)(X.a.TabPane,{tab:"General",children:Object(e.jsxs)("div",{className:"border rounded p-6",children:[Object(e.jsx)(Z.a,{Component:en,minimumAccessLevel:C.p.Admin}),Object(e.jsx)(y.LemonDivider,{className:"my-6"}),Object(e.jsx)(W,{}),Object(e.jsx)(y.LemonDivider,{className:"my-6"}),n&&Object(e.jsx)(ie,{user:n}),Object(e.jsx)(y.LemonDivider,{className:"my-6"}),Object(e.jsx)(Z.a,{Component:_e,minimumAccessLevel:C.p.Admin}),Object(e.jsx)(y.LemonDivider,{className:"my-6"}),Object(e.jsx)(Z.a,{Component:nn,minimumAccessLevel:C.p.Admin}),Object(e.jsx)(y.LemonDivider,{className:"my-6"}),Object(e.jsx)(Z.a,{Component:ae,minimumAccessLevel:C.p.Owner})]})},"general"),s[C.i.ROLE_BASED_ACCESS]&&Object(e.jsx)(X.a.TabPane,{tab:"Role access",children:Object(e.jsxs)(Qe.a,{feature:P.e.ROLE_BASED_ACCESS,children:[Object(e.jsx)(Z.a,{Component:me,minimumAccessLevel:C.p.Admin}),Object(e.jsx)(y.LemonDivider,{className:"my-6"}),Object(e.jsx)(Z.a,{Component:ce,minimumAccessLevel:C.p.Admin}),Object(e.jsx)(y.LemonDivider,{className:"my-6"})]})},"role_access")]})]})}}}]);
