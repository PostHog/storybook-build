(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"./frontend/src/scenes/actions/EventName.tsx":function(pe,I,e){"use strict";e.d(I,"a",function(){return le}),e.d(I,"b",function(){return k});var H=e("./node_modules/react/index.js"),N=e.n(H),ee=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),te=e("./frontend/src/lib/components/TaxonomicPopup/TaxonomicPopup.tsx"),ae=e("./frontend/src/lib/components/TaxonomicFilter/types.ts");function le(G){var ne=G.value,Q=G.onChange;return N.a.createElement(te.d,{groupType:ae.a.Events,onChange:Q,value:ne,type:"secondary",style:{maxWidth:"24rem"},placeholder:"Choose an event",dataAttr:"event-name-box",renderValue:function(o){return N.a.createElement(ee.a,{value:o,disablePopover:!0})},allowClear:!0})}function k(G){var ne=G.value,Q=G.onChange;return N.a.createElement(te.b,{groupType:ae.a.Events,onChange:Q,value:ne,type:"secondary",placeholder:"Select an event",dataAttr:"event-name-box",renderValue:function(o){return N.a.createElement(ee.a,{value:o,disablePopover:!0})},allowClear:!0})}try{le.displayName="EventName",le.__docgenInfo={description:"",displayName:"EventName",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/actions/EventName.tsx#EventName"]={docgenInfo:le.__docgenInfo,name:"EventName",path:"frontend/src/scenes/actions/EventName.tsx#EventName"})}catch(G){}try{k.displayName="LemonEventName",k.__docgenInfo={description:"",displayName:"LemonEventName",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/actions/EventName.tsx#LemonEventName"]={docgenInfo:k.__docgenInfo,name:"LemonEventName",path:"frontend/src/scenes/actions/EventName.tsx#LemonEventName"})}catch(G){}},"./frontend/src/scenes/events/EventDetails.tsx":function(pe,I,e){"use strict";e.d(I,"a",function(){return J});var H=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),N=e.n(H),ee=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),te=e.n(ee),ae=e("./node_modules/core-js/modules/es.object.keys.js"),le=e("./node_modules/core-js/modules/es.symbol.js"),k=e("./node_modules/core-js/modules/es.array.filter.js"),G=e("./node_modules/core-js/modules/es.object.to-string.js"),ne=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Q=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),X=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),o=e("./node_modules/react/index.js"),T=e.n(o),C=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),re=e("./frontend/src/lib/components/PropertiesTable.tsx"),U=e("./frontend/src/scenes/events/EventElements.tsx"),ie=e("./node_modules/antd/es/tabs/index.js"),ge=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),ye=e.n(ge),Pe=e("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),fe=e("./frontend/src/lib/utils.tsx"),se=["event","id","uuid","distinct_id","properties","elements","timestamp","person"];function ce(m,a){var E=Object.keys(m);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(m);a&&(p=p.filter(function(S){return Object.getOwnPropertyDescriptor(m,S).enumerable})),E.push.apply(E,p)}return E}function Y(m){for(var a=1;a<arguments.length;a++){var E=arguments[a]!=null?arguments[a]:{};a%2?ce(Object(E),!0).forEach(function(p){N()(m,p,E[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(E)):ce(Object(E)).forEach(function(p){Object.defineProperty(m,p,Object.getOwnPropertyDescriptor(E,p))})}return m}function F(m){var a=m.event,E=a.event,p=a.id,S=a.uuid,B=a.distinct_id,ue=a.properties,V=a.elements,ve=a.timestamp,Z=a.person,me=ye()(a,se),x=Y(Y(Y(Y({},p?{id:p}:null),S?{uuid:S}:null),{},{timestamp:ve,event:E,distinct_id:B,properties:Object(fe.wb)(ue)},V&&V.length>0?{elements:V}:null),me);return T.a.createElement(Pe.a,{language:Pe.b.JSON},JSON.stringify(x,null,4))}try{F.displayName="EventJSON",F.__docgenInfo={description:"",displayName:"EventJSON",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"Record<string, any>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventJSON.tsx#EventJSON"]={docgenInfo:F.__docgenInfo,name:"EventJSON",path:"frontend/src/scenes/events/EventJSON.tsx#EventJSON"})}catch(m){}var je=e("./frontend/src/lib/dayjs.ts"),W=e("./frontend/src/lib/components/LemonButton/index.ts");function w(m,a){var E=Object.keys(m);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(m);a&&(p=p.filter(function(S){return Object.getOwnPropertyDescriptor(m,S).enumerable})),E.push.apply(E,p)}return E}function O(m){for(var a=1;a<arguments.length;a++){var E=arguments[a]!=null?arguments[a]:{};a%2?w(Object(E),!0).forEach(function(p){N()(m,p,E[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(E)):w(Object(E)).forEach(function(p){Object.defineProperty(m,p,Object.getOwnPropertyDescriptor(E,p))})}return m}var de=ie.a.TabPane;function J(m){for(var a=m.event,E=Object(o.useState)(!1),p=te()(E,2),S=p[0],B=p[1],ue={},V={},ve=0,Z=0,me=Object.keys(a.properties);Z<me.length;Z++){var x=me[Z];C.d.event[x]&&C.d.event[x].hide&&(ve+=1,S&&(V[x]=a.properties[x])),(!C.d.event[x]||!C.d.event[x].hide)&&(ue[x]=a.properties[x])}return T.a.createElement(ie.a,{"data-attr":"event-details",defaultActiveKey:"properties",style:{float:"left",width:"100%"},tabBarStyle:{margin:0}},T.a.createElement(de,{tab:"Properties",key:"properties"},T.a.createElement(re.a,{properties:O(O({$timestamp:Object(je.a)(a.timestamp).toISOString()},ue),V),useDetectedPropertyType:!0}),ve>0&&T.a.createElement(W.a,{className:"mb-05",onClick:function(){return B(!S)},size:"small"},S?"Hide":"Show"," ",Object(fe.qb)(ve,"hidden property","hidden properties"))),T.a.createElement(de,{tab:"JSON",key:"json"},T.a.createElement(F,{event:a})),a.elements&&a.elements.length>0&&T.a.createElement(de,{tab:"Elements",key:"elements"},T.a.createElement(U.a,{event:a})))}try{J.displayName="EventDetails",J.__docgenInfo={description:"",displayName:"EventDetails",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"EventType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventDetails.tsx#EventDetails"]={docgenInfo:J.__docgenInfo,name:"EventDetails",path:"frontend/src/scenes/events/EventDetails.tsx#EventDetails"})}catch(m){}},"./frontend/src/scenes/events/EventElements.tsx":function(pe,I,e){"use strict";e.d(I,"a",function(){return Y});var H=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),N=e.n(H),ee=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),te=e.n(ee),ae=e("./node_modules/core-js/modules/es.array.join.js"),le=e.n(ae),k=e("./node_modules/core-js/modules/es.array.fill.js"),G=e.n(k),ne=e("./node_modules/core-js/modules/es.array.slice.js"),Q=e.n(ne),X=e("./node_modules/core-js/modules/es.array.map.js"),o=e.n(X),T=e("./node_modules/core-js/modules/es.object.entries.js"),C=e.n(T),re=e("./node_modules/core-js/modules/es.array.concat.js"),U=e.n(re),ie=e("./node_modules/core-js/modules/es.regexp.exec.js"),ge=e.n(ie),ye=e("./node_modules/core-js/modules/es.string.replace.js"),Pe=e.n(ye),fe=e("./node_modules/react/index.js"),se=e.n(fe);function ce(F){return Array(F).fill("    ").join("")}function Y(F){var je=F.event,W=te()(je.elements||[]).reverse();return W=W.slice(Math.max(W.length-10,1)),se.a.createElement("div",null,W.map(function(w,O){return se.a.createElement("pre",{className:"code",key:O,style:{margin:0,padding:0,borderRadius:0,backgroundColor:O===W.length-1?"var(--primary)":void 0}},ce(O),"<",w.tag_name,w.attr_id&&' id="'.concat(w.attr_id,'"'),Object.entries(w.attributes).map(function(de){var J=N()(de,2),m=J[0],a=J[1];return se.a.createElement("span",{key:m}," ".concat(m.replace("attr__",""),'="').concat(a,'"'))}),">",w.text,O===W.length-1&&se.a.createElement("span",null,"</",w.tag_name,">"))}),te()(W).reverse().slice(1).map(function(w,O){return se.a.createElement("pre",{className:"code",key:O,style:{margin:0,padding:0,borderRadius:0}},ce(W.length-O-2),"</",w.tag_name,">")}))}try{Y.displayName="EventElements",Y.__docgenInfo={description:"",displayName:"EventElements",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"EventType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventElements.tsx#EventElements"]={docgenInfo:Y.__docgenInfo,name:"EventElements",path:"frontend/src/scenes/events/EventElements.tsx#EventElements"})}catch(F){}},"./frontend/src/scenes/events/EventsTable.tsx":function(pe,I,e){"use strict";e.d(I,"a",function(){return M});var H=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),N=e.n(H),ee=e("./node_modules/core-js/modules/es.array.splice.js"),te=e("./node_modules/core-js/modules/es.array.map.js"),ae=e("./node_modules/core-js/modules/es.array.find.js"),le=e("./node_modules/core-js/modules/es.object.to-string.js"),k=e("./node_modules/core-js/modules/es.array.concat.js"),G=e("./node_modules/core-js/modules/es.array.join.js"),ne=e("./node_modules/core-js/modules/es.object.keys.js"),Q=e("./node_modules/core-js/modules/es.regexp.to-string.js"),X=e("./node_modules/react/index.js"),o=e.n(X),T=e("./node_modules/kea/lib/index.esm.js"),C=e("./frontend/src/scenes/events/EventDetails.tsx"),re=e("./frontend/src/lib/components/Link.tsx"),U=e("./node_modules/antd/es/button/index.js"),ie=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),ge=e.n(ie),ye=e("./node_modules/core-js/modules/es.array.filter.js"),Pe=e("./node_modules/core-js/modules/es.symbol.js"),fe=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),se=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),ce=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Y=e("./node_modules/kea-router/lib/index.js"),F=e("./node_modules/@babel/runtime/helpers/typeof.js"),je=e.n(F),W=e("./node_modules/core-js/modules/es.regexp.exec.js"),w=e("./node_modules/core-js/modules/es.string.replace.js");function O(l){var u=l.value;return o.a.createElement("span",{title:u},je()(u)==="object"?JSON.stringify(u):u&&u.toString().replace(/(^\w+:|^)\/\//,""))}try{O.displayName="Property",O.__docgenInfo={description:"",displayName:"Property",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Property.tsx#Property"]={docgenInfo:O.__docgenInfo,name:"Property",path:"frontend/src/lib/components/Property.tsx#Property"})}catch(l){}var de=e("./frontend/src/lib/components/PropertyFilters/utils.ts");function J(l,u){var d=Object.keys(l);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(l);u&&(_=_.filter(function(P){return Object.getOwnPropertyDescriptor(l,P).enumerable})),d.push.apply(d,_)}return d}function m(l){for(var u=1;u<arguments.length;u++){var d=arguments[u]!=null?arguments[u]:{};u%2?J(Object(d),!0).forEach(function(_){ge()(l,_,d[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(d)):J(Object(d)).forEach(function(_){Object.defineProperty(l,_,Object.getOwnPropertyDescriptor(d,_))})}return l}function a(l){var u=l.property,d=l.value,_=l.filters,P=l.onClick,oe=l.className,y=Object(de.c)(_.properties),Ce=y.find(function(K){return K.key===u&&K.value===d&&!K.operator})?y.filter(function(K){return K.key!==u||K.value!==d||K.operator}):[].concat(N()(y),[{key:u,value:d}]),j=Object(Y.combineUrl)(window.location.pathname,m(m({},_),{},{properties:Ce}),{}),Oe=j.url;return o.a.createElement(re.a,{to:Oe,className:oe,onClick:function(){P&&P(u,d)}},o.a.createElement(O,{value:d}))}try{a.displayName="FilterPropertyLink",a.__docgenInfo={description:"",displayName:"FilterPropertyLink",props:{property:{defaultValue:null,description:"",name:"property",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string | number"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((property: string, value: string | number) => void)"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/FilterPropertyLink.tsx#FilterPropertyLink"]={docgenInfo:a.__docgenInfo,name:"FilterPropertyLink",path:"frontend/src/lib/components/FilterPropertyLink.tsx#FilterPropertyLink"})}catch(l){}var E=e("./frontend/src/lib/utils.tsx"),p=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),S=e.n(p),B=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/events/EventsTable.scss"),ue=e.n(B),V={};V.insert="head",V.singleton=!1;var ve=S()(ue.a,V),Z=ue.a.locals||{},me=e("./frontend/src/scenes/events/eventsTableLogic.ts"),x=e("./frontend/src/scenes/persons/PersonHeader.tsx"),be=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),D=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),he=e("./frontend/src/types.ts"),Be=e("./frontend/src/scenes/actions/EventName.tsx"),Se=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),xe=e("./frontend/src/lib/components/Tooltip.tsx"),Te=e("./node_modules/clsx/dist/clsx.m.js"),Ke=e("./frontend/src/lib/components/ResizableTable/tableConfigLogic.ts"),s=e("./frontend/src/scenes/urls.ts"),t=e("./frontend/src/lib/components/LemonTable/index.ts"),n=e("./frontend/src/lib/components/icons.tsx"),r=e("./frontend/src/lib/components/LemonButton/index.ts"),c=e("./frontend/src/lib/components/LemonButton/More.tsx"),f=e("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),g=e("./frontend/src/scenes/teamLogic.ts"),R=e("./frontend/src/scenes/events/createActionFromEvent.tsx");function $(l){Object(X.useEffect)(function(){var u="hidden",d="visibilitychange";typeof document.msHidden!="undefined"?(u="msHidden",d="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(u="webkitHidden",d="webkitvisibilitychange");var _=function(){l(!document[u])};return document.addEventListener(d,_),function(){document.removeEventListener(d,_)}},[])}var z=e("./frontend/src/lib/components/ResizableTable/TableConfig.tsx");function M(l){var u=l.pageKey,d=l.fixedFilters,_=l.fixedColumns,P=l.sceneUrl,oe=l.fetchMonths,y=oe===void 0?12:oe,Ce=l.startingColumns,j=l.showCustomizeColumns,Oe=j===void 0?!0:j,K=l.showExport,Me=K===void 0?!0:K,De=l.showAutoload,Ne=De===void 0?!0:De,Ee=l.showEventFilter,Ze=Ee===void 0?!0:Ee,Ve=l.showRowExpanders,ke=Ve===void 0?!0:Ve,$e=l.showActionsButton,qe=$e===void 0?!0:$e,Ye=l.showPersonColumn,et=Ye===void 0?!0:Ye,Je=l.linkPropertiesToFilters,Ue=Je===void 0?!0:Je,tt=Object(T.useValues)(g.a),Fe=tt.currentTeam,ze=Object(me.a)({fixedFilters:d,key:u,sceneUrl:P||s.a.events(),fetchMonths:y}),q=Object(T.useValues)(ze),Ae=q.properties,nt=q.eventsFormatted,He=q.isLoading,rt=q.hasNext,Ge=q.isLoadingNext,Re=q.eventFilter,st=q.automaticLoadEnabled,ot=q.exportUrl,at=q.highlightEvents,lt=q.months,Qe=Object(T.useValues)(Object(Ke.a)({startingColumns:Ce})),We=Qe.tableWidth,Le=Qe.selectedColumns,_e=Object(T.useActions)(ze),it=_e.fetchNextEvents,ct=_e.prependNewEvents,dt=_e.setEventFilter,ut=_e.toggleAutomaticLoad,vt=_e.startDownload,mt=_e.setPollingActive,pt=_e.setProperties,ft=!(d!=null&&d.person_id);$(mt);var Xe=function(i,b){var h=i.date_break,v=i.new_events;return{children:h||(v?o.a.createElement(r.a,{icon:o.a.createElement(n.IconSync,null),style:{borderRadius:0},onClick:function(){return ct()},center:!0,fullWidth:!0},"There are new events. Click here to load them"):"???"),props:{colSpan:b+1,style:v?{padding:0}:void 0}}},Et={title:"Person",key:"person",render:function(i,b){var h,v,L=b.event;return L?ft&&(h=L.person)!==null&&h!==void 0&&(v=h.distinct_ids)!==null&&v!==void 0&&v.length?o.a.createElement(re.a,{to:s.a.person(L.person.distinct_ids[0])},o.a.createElement(x.a,{withIcon:!0,person:L.person})):o.a.createElement(x.a,{withIcon:!0,person:L.person}):{props:{colSpan:0}}}},we=Object(X.useMemo)(function(){var A=[{title:"Event",key:"event",width:"16rem",render:function(b,h){if(!h.event)return Xe(h,We);var v=h.event;return o.a.createElement(D.a,{value:Object(E.f)(v)})}},{title:"URL / Screen",key:"url",width:"4rem",render:function(b,h){var v=h.event;if(!v)return{props:{colSpan:0}};var L=v.properties.$current_url?"$current_url":"$screen_name";return Ue?o.a.createElement(a,{className:"ph-no-capture",property:L,value:v.properties[L],filters:{properties:Ae}}):o.a.createElement(O,{value:v.properties[L]})}},{title:o.a.createElement(xe.a,{title:'This is the "Library" property on events. Sent by the SDK as "$lib"'},"Source"),key:"source",render:function(b,h){var v=h.event;return v?Ue?o.a.createElement(a,{property:"$lib",value:v.properties.$lib,filters:{properties:Ae}}):o.a.createElement(O,{value:v.properties.$lib}):{props:{colSpan:0}}}}];return et&&A.splice(1,0,Et),A},[We]),_t=Object(X.useMemo)(function(){var A=Le==="DEFAULT"?N()(we):Le.map(function(i,b){return we.find(function(h){return h.key===i})||{title:D.d.event[i]?D.d.event[i].label:i,key:i,render:function(v,L){var Ie=L.event;return Ie?Ue?o.a.createElement(a,{className:"ph-no-capture ",property:i,value:Ie.properties[i],filters:{properties:Ae}}):o.a.createElement(O,{value:Ie.properties[i]}):b===0?Xe(L,We):{props:{colSpan:0}}}}});return A.push({title:"Time",key:"time",render:function(b,h){var v=h.event;return v?o.a.createElement(be.b,{time:v.timestamp,showSeconds:!0}):{props:{colSpan:0}}}}),qe&&A.push({key:"actions",width:0,render:function(b,h){var v=h.event;if(!v)return{props:{colSpan:0}};var L;return v.event==="$pageview"?L={insight:he.y.TRENDS,interval:"day",display:he.i.ActionsLineGraph,actions:[],events:[{id:"$pageview",name:"$pageview",type:"events",order:0,properties:[{key:"$current_url",value:v.properties.$current_url,type:"event"}]}]}:v.event!=="$autocapture"&&(L={insight:he.y.TRENDS,interval:"day",display:he.i.ActionsLineGraph,actions:[],events:[{id:v.event,name:v.event,type:"events",order:0,properties:[]}]}),o.a.createElement(c.a,{overlay:o.a.createElement(o.a.Fragment,null,Fe&&o.a.createElement(r.a,{type:"stealth",onClick:function(){return Object(R.a)(Fe.id,v,0,Fe.data_attributes||[])},fullWidth:!0,"data-attr":"events-table-create-action"},"Create action from event"),L&&o.a.createElement(r.a,{type:"stealth",to:s.a.insightNew(L),fullWidth:!0,"data-attr":"events-table-usage"},"Try out in Insights"))})}}),_?A.concat(_):A},[Le]);return o.a.createElement("div",{"data-attr":"manage-events-table"},o.a.createElement("div",{className:"events","data-attr":"events-table"},o.a.createElement("div",{className:"flex pt pb border-top space-x"},Ze?o.a.createElement(Be.b,{value:Re,onChange:function(i){dt(i||"")}}):null,o.a.createElement(Se.a,{propertyFilters:Ae,onChange:pt,pageKey:u,taxonomicPopoverPlacement:"bottom-start",style:{marginBottom:0,marginTop:0},eventNames:Re?[Re]:[],useLemonButton:!0})),Ne||Oe||Me?o.a.createElement("div",{className:"space-between-items pt pb border-top"},Ne&&o.a.createElement(f.a,{type:"primary",id:"autoload-switch",label:"Automatically load new events",checked:st,onChange:ut}),o.a.createElement("div",{className:"flex space-x-05"},Oe&&o.a.createElement(z.a,{immutableColumns:["event","person"],defaultColumns:we.map(function(A){return A.key||""})}),Me&&ot&&o.a.createElement(xe.a,{title:"Export up to 10,000 latest events.",placement:"left"},o.a.createElement(r.a,{type:"secondary",icon:o.a.createElement(n.IconExport,{style:{color:"var(--primary)"}}),onClick:vt},"Export")))):null,o.a.createElement(t.a,{dataSource:nt,loading:He,columns:_t,key:Le==="DEFAULT"?"default":Le.join("-"),className:"ph-no-capture",loadingSkeletonRows:20,emptyState:He?void 0:Ae.some(function(A){return Object.keys(A).length})||Re?"No events matching filters found in the last ".concat(lt," months!"):o.a.createElement(o.a.Fragment,null,"This project doesn't have any events. If you haven't integrated PostHog yet,"," ",o.a.createElement(re.a,{to:"/project/settings"},"click here to instrument analytics with PostHog in your product"),"."),rowKey:function(i){var b;return i.event?i.event.id+"-"+i.event.event:((b=i.date_break)===null||b===void 0?void 0:b.toString())||""},rowClassName:function(i){return Object(Te.a)({"event-row":i.event,highlighted:i.event&&at[i.event.id],"event-row-is-exception":i.event&&i.event.event==="$exception","event-row-date-separator":i.date_break,"event-row-new":i.new_events})},expandable:ke?{expandedRowRender:function(i){var b=i.event;return b&&o.a.createElement(C.a,{event:b})},rowExpandable:function(i){var b=i.event,h=i.date_break,v=i.new_events;return h||v?-1:!!b}}:void 0}),o.a.createElement(U.a,{type:"primary",onClick:it,loading:Ge,style:{display:rt||Ge?"block":"none",margin:"2rem auto 1rem"}},"Load more events")))}try{M.displayName="EventsTable",M.__docgenInfo={description:"",displayName:"EventsTable",props:{pageKey:{defaultValue:null,description:"",name:"pageKey",required:!0,type:{name:"string"}},fixedFilters:{defaultValue:null,description:"",name:"fixedFilters",required:!1,type:{name:"FixedFilters"}},fixedColumns:{defaultValue:null,description:"",name:"fixedColumns",required:!1,type:{name:"LemonTableColumn<EventsTableRowItem, keyof EventsTableRowItem>[]"}},sceneUrl:{defaultValue:null,description:"",name:"sceneUrl",required:!1,type:{name:"string"}},fetchMonths:{defaultValue:{value:"12"},description:"",name:"fetchMonths",required:!1,type:{name:"number"}},startingColumns:{defaultValue:null,description:"",name:"startingColumns",required:!1,type:{name:"ColumnChoice"}},showCustomizeColumns:{defaultValue:{value:"true"},description:"",name:"showCustomizeColumns",required:!1,type:{name:"boolean"}},showExport:{defaultValue:{value:"true"},description:"",name:"showExport",required:!1,type:{name:"boolean"}},showAutoload:{defaultValue:{value:"true"},description:"",name:"showAutoload",required:!1,type:{name:"boolean"}},showEventFilter:{defaultValue:{value:"true"},description:"",name:"showEventFilter",required:!1,type:{name:"boolean"}},showRowExpanders:{defaultValue:{value:"true"},description:"",name:"showRowExpanders",required:!1,type:{name:"boolean"}},showActionsButton:{defaultValue:{value:"true"},description:"",name:"showActionsButton",required:!1,type:{name:"boolean"}},showPersonColumn:{defaultValue:{value:"true"},description:"",name:"showPersonColumn",required:!1,type:{name:"boolean"}},linkPropertiesToFilters:{defaultValue:{value:"true"},description:"",name:"linkPropertiesToFilters",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventsTable.tsx#EventsTable"]={docgenInfo:M.__docgenInfo,name:"EventsTable",path:"frontend/src/scenes/events/EventsTable.tsx#EventsTable"})}catch(l){}},"./frontend/src/scenes/events/eventsTableLogic.ts":function(pe,I,e){"use strict";e.d(I,"a",function(){return Ke});var H=e("./node_modules/core-js/modules/es.object.keys.js"),N=e.n(H),ee=e("./node_modules/core-js/modules/es.symbol.js"),te=e.n(ee),ae=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),le=e.n(ae),k=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),G=e.n(k),ne=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),Q=e.n(ne),X=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=e.n(X),T=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),C=e.n(T),re=e("./node_modules/@babel/runtime/regenerator/index.js"),U=e.n(re),ie=e("./node_modules/core-js/modules/es.array.map.js"),ge=e.n(ie),ye=e("./node_modules/core-js/modules/es.object.to-string.js"),Pe=e.n(ye),fe=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),se=e.n(fe),ce=e("./node_modules/core-js/modules/es.array.splice.js"),Y=e.n(ce),F=e("./node_modules/core-js/modules/es.array.join.js"),je=e.n(F),W=e("./node_modules/core-js/modules/es.array.filter.js"),w=e.n(W),O=e("./node_modules/core-js/modules/es.array.concat.js"),de=e.n(O),J=e("./node_modules/core-js/modules/es.array.iterator.js"),m=e.n(J),a=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),E=e.n(a),p=e("./node_modules/kea/lib/index.esm.js"),S=e("./frontend/src/lib/utils.tsx"),B=e("./node_modules/kea-router/lib/index.js"),ue=e.n(B),V=e("./frontend/src/lib/api.ts"),ve=e("./frontend/src/scenes/teamLogic.ts"),Z=e("./frontend/src/lib/dayjs.ts"),me=e("./frontend/src/lib/logic/featureFlagLogic.ts"),x=e("./frontend/src/lib/components/lemonToast.tsx");function be(s,t){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable})),n.push.apply(n,r)}return n}function D(s){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?be(Object(n),!0).forEach(function(r){o()(s,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(n,r))})}return s}var he=5,Be=365,Se=5e3,xe=function(t,n){var r=[];return r=t.map(function(c){return{event:c}}),r.forEach(function(c,f){var g=r[f-1];f>0&&c.event&&g.event&&!Object(Z.a)(c.event.timestamp).isSame(g.event.timestamp,"day")&&r.splice(f,0,{date_break:Object(Z.a)(c.event.timestamp).format("LL")})}),n.length>0&&r.splice(0,0,{new_events:!0}),r},Te=function(t){return Object(Z.b)().subtract(t,"day").toISOString()},Ke=Object(p.kea)({path:function(t){return["scenes","events","eventsTableLogic",t]},props:{},key:function(t){return[t.fixedFilters?JSON.stringify(t.fixedFilters):"all",t.key,t.sceneUrl].filter(function(n){return!!n}).join("-")},connect:{values:[ve.a,["currentTeamId"],me.a,["featureFlags"]]},actions:{setPollingActive:function(t){return{pollingActive:t}},setProperties:function(t){return Array.isArray(t)?t.length===0?{properties:[{}]}:{properties:t}:{properties:[t]}},fetchEvents:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return{nextParams:t}},fetchEventsSuccess:function(t){return t},fetchNextEvents:!0,fetchOrPollFailure:function(t){return{error:t}},pollEvents:!0,pollEventsSuccess:function(t){return{events:t}},prependEvents:function(t){return{events:t}},prependNewEvents:!0,setSelectedEvent:function(t){return{selectedEvent:t}},setPollTimeout:function(t){return{pollTimeout:t}},setEventFilter:function(t){return{event:t}},toggleAutomaticLoad:function(t){return{automaticLoadEnabled:t}},noop:function(t){return t},startDownload:!0},reducers:{pollingIsActive:[!0,{setPollingActive:function(t,n){var r=n.pollingActive;return r},pollEventsSuccess:function(t,n){var r=n.events;return r&&r.length?!1:t},prependNewEvents:function(){return!0},toggleAutomaticLoad:function(){return!0}}],properties:[[],{setProperties:function(t,n){var r=n.properties;return Object(S.s)(r)}}],eventFilter:["",{setEventFilter:function(t,n){var r=n.event;return r}}],isLoading:[!0,{fetchEvents:function(){return!0},fetchEventsSuccess:function(){return!1},fetchOrPollFailure:function(){return!1}}],isLoadingNext:[!1,{fetchNextEvents:function(){return!0},fetchEventsSuccess:function(){return!1}}],events:[[],{fetchEventsSuccess:function(t,n){var r=n.events,c=n.isNext;return c?[].concat(C()(t),C()(r)):r},prependEvents:function(t,n){var r=n.events;return[].concat(C()(r),C()(t))}}],hasNext:[!1,{fetchEvents:function(){return!1},fetchNextEvents:function(){return!1},fetchEventsSuccess:function(t,n){var r=n.hasNext;return r}}],orderBy:["-timestamp",{}],selectedEvent:[null,{setSelectedEvent:function(t,n){var r=n.selectedEvent;return r}}],newEvents:[[],{setProperties:function(){return[]},pollEventsSuccess:function(t,n){var r=n.events;return r||[]},prependEvents:function(){return[]}}],highlightEvents:[{},{prependEvents:function(t,n){var r=n.events;return r.reduce(function(c,f){return c[f.id]=!0,c},{})}}],pollTimeout:[0,{setPollTimeout:function(t,n){return n.pollTimeout}}],automaticLoadEnabled:[!1,{persist:!0},{toggleAutomaticLoad:function(t,n){var r=n.automaticLoadEnabled;return r}}]},selectors:function(t){var n=t.selectors,r=t.props;return{eventsFormatted:[function(){return[n.events,n.newEvents]},function(c,f){return xe(c,f)}],exportUrl:[function(){return[n.currentTeamId,n.eventFilter,n.orderBy,n.properties,n.minimumQueryDate]},function(c,f,g,R,$){var z;return"/api/projects/".concat(c,"/events.csv?").concat(Object(S.zb)(D(D(D({},r.fixedFilters||{}),{},{properties:[].concat(C()(R),C()(((z=r.fixedFilters)===null||z===void 0?void 0:z.properties)||[]))},f?{event:f}:{}),{},{orderBy:[g],after:$})))}],months:[function(){return[function(c,f){return f.fetchMonths}]},function(c){return c||12}],minimumQueryDate:[function(){return[n.months]},function(c){return Object(Z.b)().subtract(c,"months").toISOString()}],pollAfter:[function(){return[n.events]},function(c){return(c==null?void 0:c.length)>0&&c[0].timestamp?c[0].timestamp:Te(0)}]}},actionToUrl:function(t){var n=t.values;return{setProperties:function(){return[B.router.values.location.pathname,D(D({},B.router.values.searchParams),{},{properties:n.properties.length===0?void 0:n.properties}),B.router.values.hashParams,{replace:!0}]},setEventFilter:function(){return[B.router.values.location.pathname,D(D({},B.router.values.searchParams),{},{eventFilter:n.eventFilter}),B.router.values.hashParams,{replace:!0}]}}},urlToAction:function(t){var n=t.actions,r=t.values,c=t.props;return o()({},c.sceneUrl,function(f,g){n.setProperties(g.properties||r.properties||{}),g.eventFilter&&n.setEventFilter(g.eventFilter)})},events:function(t){var n=t.values;return{beforeUnmount:function(){return clearTimeout(n.pollTimeout||void 0)}}},listeners:function(t){var n=t.actions,r=t.values,c=t.props;return{startDownload:function(){x.b.success("The export is starting. It should finish soon"),window.location.href=r.exportUrl},setProperties:function(){return n.fetchEvents()},setEventFilter:function(){return n.fetchEvents()},fetchNextEvents:function(){var f=Q()(U.a.mark(function R(){var $;return U.a.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:$=r.events,$.length===0?n.fetchEvents():n.fetchEvents({before:$[$.length-1].timestamp});case 2:case"end":return M.stop()}},R)}));function g(){return f.apply(this,arguments)}return g}(),fetchEvents:function(){var f=Q()(U.a.mark(function R($,z){var M,l,u,d,_,P,oe,y;return U.a.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(_=function(){return _=Q()(U.a.mark(function K(Me){var De;return U.a.wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:return De=D(D(D(D({after:Me},c.fixedFilters||{}),{},{properties:u},l||{}),r.eventFilter?{event:r.eventFilter}:{}),{},{orderBy:[r.orderBy]}),Ee.abrupt("return",V.b.get("api/projects/".concat(r.currentTeamId,"/events/?").concat(Object(S.zb)(De))));case 2:case"end":return Ee.stop()}},K)})),_.apply(this,arguments)},d=function(K){return _.apply(this,arguments)},l=$.nextParams,clearTimeout(r.pollTimeout),!(r.events.length>0)){j.next=9;break}return j.next=7,z(300);case 7:j.next=11;break;case 9:return j.next=11,z(1);case 11:return u=[].concat(C()(r.properties),C()(((M=c.fixedFilters)===null||M===void 0?void 0:M.properties)||[])),P=null,oe=!1,j.prev=14,j.next=17,d(Te(he));case 17:if(P=j.sent,P.results.length!==0){j.next=23;break}return j.next=21,d(Te(Be));case 21:P=j.sent,oe=!0;case 23:j.next=29;break;case 25:return j.prev=25,j.t0=j.catch(14),n.fetchOrPollFailure(j.t0),j.abrupt("return");case 29:z(),n.fetchEventsSuccess({events:P.results,hasNext:!!P.next||!oe,isNext:!!l}),y=window.setTimeout(n.pollEvents,Se),n.setPollTimeout(y);case 33:case"end":return j.stop()}},R,null,[[14,25]])}));function g(R,$){return f.apply(this,arguments)}return g}(),pollEvents:function(){var f=Q()(U.a.mark(function R($,z){var M,l,u,d,_,P;return U.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(l=function(){var j=window.setTimeout(n.pollEvents,Se);n.setPollTimeout(j)},r.orderBy==="-timestamp"){y.next=3;break}return y.abrupt("return");case 3:if(c.sceneUrl===B.router.values.location.pathname){y.next=5;break}return y.abrupt("return");case 5:if(r.pollingIsActive){y.next=8;break}return l(),y.abrupt("return");case 8:return u=[].concat(C()(r.properties),C()(((M=c.fixedFilters)===null||M===void 0?void 0:M.properties)||[])),d=D(D(D({},c.fixedFilters||{}),{},{properties:u},r.eventFilter?{event:r.eventFilter}:{}),{},{orderBy:[r.orderBy],after:r.pollAfter}),_=Object(S.zb)(d),P=null,y.prev=12,y.next=15,V.b.get("api/projects/".concat(r.currentTeamId,"/events/?").concat(_));case 15:P=y.sent,y.next=21;break;case 18:return y.prev=18,y.t0=y.catch(12),y.abrupt("return");case 21:z(),r.automaticLoadEnabled?n.prependEvents(P.results):n.pollEventsSuccess(P.results),l();case 24:case"end":return y.stop()}},R,null,[[12,18]])}));function g(R,$){return f.apply(this,arguments)}return g}(),prependNewEvents:function(){r.newEvents.length&&n.prependEvents(r.newEvents)},fetchOrPollFailure:function(g){var R=g.error;x.b.error("There was a problem fetching your events: ".concat(R.statusText))},toggleAutomaticLoad:function(g){var R=g.automaticLoadEnabled;R&&n.prependNewEvents()}}}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/events/EventsTable.scss":function(pe,I,e){var H=e("./node_modules/css-loader/dist/runtime/api.js");I=H(!1),I.push([pe.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.events .events-table-button-clear{padding:0 4px;margin-left:4px}.events .events-table-button-clear.visible,.events .events-table-button-clear:focus,.events .events-table-button-clear:hover{border:1px solid #5375ff}.events .event-row-new{height:2.5rem}.events .event-row-date-separator{background-color:var(--bg-mid);color:var(--text-muted);font-weight:600;font-size:.75rem;height:2rem;text-align:center}.events .event-row-is-exception{background-color:#fffaf8}.events td{max-width:20rem}",""]),pe.exports=I}}]);
