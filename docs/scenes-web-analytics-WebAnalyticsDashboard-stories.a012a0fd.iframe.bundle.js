"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[89445],{"../../frontend/src/scenes/web-analytics/WebAnalyticsDashboard.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{WebAnalyticsDashboard:()=>WebAnalyticsDashboard,__namedExportsOrder:()=>__namedExportsOrder,default:()=>WebAnalyticsDashboard_stories});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib=__webpack_require__("../../node_modules/.pnpm/kea-router@3.2.1_kea@3.1.5_react@18.2.0_/node_modules/kea-router/lib/index.js"),react=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),App=__webpack_require__("../../frontend/src/scenes/App.tsx"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),browser=__webpack_require__("../../frontend/src/mocks/browser.tsx");let UniqueVisitors_namespaceObject=JSON.parse('{"cache_key":"cache_b80cb541a5183eaf621d6ea4a1ddaf07","cache_target_age":"2025-01-21T01:17:20.311895Z","calculation_trigger":null,"error":"","hasMore":false,"hogql":"SELECT\\n    arrayMap(number -> plus(toStartOfDay(assumeNotNull(toDateTime(\'2025-01-06 00:00:00\'))), toIntervalDay(number)), range(0, plus(coalesce(dateDiff(\'day\', toStartOfDay(assumeNotNull(toDateTime(\'2025-01-06 00:00:00\'))), toStartOfDay(assumeNotNull(toDateTime(\'2025-01-20 23:59:59\'))))), 1))) AS date,\\n    arrayMap(_match_date -> arraySum(arraySlice(groupArray(ifNull(count, 0)), indexOf(groupArray(day_start) AS _days_for_count, _match_date) AS _index, plus(minus(arrayLastIndex(x -> equals(x, _match_date), _days_for_count), _index), 1))), date) AS total\\nFROM\\n    (SELECT\\n        sum(total) AS count,\\n        day_start\\n    FROM\\n        (SELECT\\n            count(DISTINCT e.person_id) AS total,\\n            toStartOfDay(timestamp) AS day_start\\n        FROM\\n            events AS e SAMPLE 1\\n        WHERE\\n            and(greaterOrEquals(timestamp, toStartOfDay(assumeNotNull(toDateTime(\'2025-01-06 00:00:00\')))), lessOrEquals(timestamp, assumeNotNull(toDateTime(\'2025-01-20 23:59:59\'))), equals(event, \'$pageview\'))\\n        GROUP BY\\n            day_start)\\n    GROUP BY\\n        day_start\\n    ORDER BY\\n        day_start ASC)\\nORDER BY\\n    arraySum(total) DESC\\nLIMIT 50000\\nUNION ALL\\nSELECT\\n    arrayMap(number -> plus(toStartOfDay(assumeNotNull(toDateTime(\'2024-12-23 00:00:00\'))), toIntervalDay(number)), range(0, plus(coalesce(dateDiff(\'day\', toStartOfDay(assumeNotNull(toDateTime(\'2024-12-23 00:00:00\'))), toStartOfDay(assumeNotNull(toDateTime(\'2025-01-06 23:59:59\'))))), 1))) AS date,\\n    arrayMap(_match_date -> arraySum(arraySlice(groupArray(ifNull(count, 0)), indexOf(groupArray(day_start) AS _days_for_count, _match_date) AS _index, plus(minus(arrayLastIndex(x -> equals(x, _match_date), _days_for_count), _index), 1))), date) AS total\\nFROM\\n    (SELECT\\n        sum(total) AS count,\\n        day_start\\n    FROM\\n        (SELECT\\n            count(DISTINCT e.person_id) AS total,\\n            toStartOfDay(timestamp) AS day_start\\n        FROM\\n            events AS e SAMPLE 1\\n        WHERE\\n            and(greaterOrEquals(timestamp, toStartOfDay(assumeNotNull(toDateTime(\'2024-12-23 00:00:00\')))), lessOrEquals(timestamp, assumeNotNull(toDateTime(\'2025-01-06 23:59:59\'))), equals(event, \'$pageview\'))\\n        GROUP BY\\n            day_start)\\n    GROUP BY\\n        day_start\\n    ORDER BY\\n        day_start ASC)\\nORDER BY\\n    arraySum(total) DESC\\nLIMIT 50000","is_cached":false,"last_refresh":"2025-01-20T23:17:20.311895Z","modifiers":{"bounceRateDurationSeconds":null,"bounceRatePageViewMode":"uniq_page_screen_autocaptures","customChannelTypeRules":[],"dataWarehouseEventsModifiers":[],"debug":null,"inCohortVia":"auto","materializationMode":"legacy_null_as_null","optimizeJoinedFilters":false,"personsArgMaxVersion":"auto","personsJoinMode":null,"personsOnEventsMode":"person_id_override_properties_on_events","propertyGroupsMode":"optimized","s3TableUseInvalidColumns":null,"sessionTableVersion":"auto","useMaterializedViews":true},"next_allowed_client_refresh":"2025-01-20T23:32:20.311895Z","query_status":null,"results":[{"data":[22938,24418,23817,23910,20335,9312,17801,25286,25401,25335,25473,21397,9582,18421,20439],"labels":["6-Jan-2025","7-Jan-2025","8-Jan-2025","9-Jan-2025","10-Jan-2025","11-Jan-2025","12-Jan-2025","13-Jan-2025","14-Jan-2025","15-Jan-2025","16-Jan-2025","17-Jan-2025","18-Jan-2025","19-Jan-2025","20-Jan-2025"],"days":["2025-01-06","2025-01-07","2025-01-08","2025-01-09","2025-01-10","2025-01-11","2025-01-12","2025-01-13","2025-01-14","2025-01-15","2025-01-16","2025-01-17","2025-01-18","2025-01-19","2025-01-20"],"count":313865,"label":"$pageview","filter":{"insight":"TRENDS","properties":[],"filter_test_accounts":false,"date_to":"2025-01-20T23:59:59.999999-08:00","date_from":"2025-01-06T00:00:00-08:00","entity_type":"events","interval":"day","aggregationAxisFormat":"numeric","display":"ActionsLineGraph","resultCustomizationBy":"value","showAlertThresholdLines":false,"showLegend":false,"showPercentStackView":false,"showValuesOnSeries":false,"smoothingIntervals":1,"yAxisScaleType":"linear"},"action":{"days":["2025-01-06T00:00:00-08:00","2025-01-07T00:00:00-08:00","2025-01-08T00:00:00-08:00","2025-01-09T00:00:00-08:00","2025-01-10T00:00:00-08:00","2025-01-11T00:00:00-08:00","2025-01-12T00:00:00-08:00","2025-01-13T00:00:00-08:00","2025-01-14T00:00:00-08:00","2025-01-15T00:00:00-08:00","2025-01-16T00:00:00-08:00","2025-01-17T00:00:00-08:00","2025-01-18T00:00:00-08:00","2025-01-19T00:00:00-08:00","2025-01-20T00:00:00-08:00"],"id":"$pageview","type":"events","order":0,"name":"$pageview","custom_name":"Unique visitors","math":"dau","math_property":null,"math_hogql":null,"math_group_type_index":null,"properties":{}},"compare":true,"compare_label":"current"},{"data":[16719,11526,8331,13021,12876,7616,14604,14756,9937,9875,18814,16182,8505,17010,22936],"labels":["23-Dec-2024","24-Dec-2024","25-Dec-2024","26-Dec-2024","27-Dec-2024","28-Dec-2024","29-Dec-2024","30-Dec-2024","31-Dec-2024","1-Jan-2025","2-Jan-2025","3-Jan-2025","4-Jan-2025","5-Jan-2025","6-Jan-2025"],"days":["2024-12-23","2024-12-24","2024-12-25","2024-12-26","2024-12-27","2024-12-28","2024-12-29","2024-12-30","2024-12-31","2025-01-01","2025-01-02","2025-01-03","2025-01-04","2025-01-05","2025-01-06"],"count":202708,"label":"$pageview","filter":{"insight":"TRENDS","properties":[],"filter_test_accounts":false,"date_to":"2025-01-20T23:59:59.999999-08:00","date_from":"2025-01-06T00:00:00-08:00","entity_type":"events","interval":"day","aggregationAxisFormat":"numeric","display":"ActionsLineGraph","resultCustomizationBy":"value","showAlertThresholdLines":false,"showLegend":false,"showPercentStackView":false,"showValuesOnSeries":false,"smoothingIntervals":1,"yAxisScaleType":"linear"},"action":{"days":["2025-01-06T00:00:00-08:00","2025-01-07T00:00:00-08:00","2025-01-08T00:00:00-08:00","2025-01-09T00:00:00-08:00","2025-01-10T00:00:00-08:00","2025-01-11T00:00:00-08:00","2025-01-12T00:00:00-08:00","2025-01-13T00:00:00-08:00","2025-01-14T00:00:00-08:00","2025-01-15T00:00:00-08:00","2025-01-16T00:00:00-08:00","2025-01-17T00:00:00-08:00","2025-01-18T00:00:00-08:00","2025-01-19T00:00:00-08:00","2025-01-20T00:00:00-08:00"],"id":"$pageview","type":"events","order":0,"name":"$pageview","custom_name":"Unique visitors","math":"dau","math_property":null,"math_hogql":null,"math_group_type_index":null,"properties":{}},"compare":true,"compare_label":"previous"}],"timezone":"US/Pacific","timings":[]}'),WebOverview_namespaceObject=JSON.parse("{\"cache_key\":\"cache_2d74908f63413d881a5c3d91a20397b2_[{'alias': '/person/<id>', 'regex': '\\\\\\\\/person\\\\\\\\/[^\\\\\\\\/]+'}, {'alias': 'Any Session Recording Route', 'regex': '.*sessionRecordingId=[a-zA-Z]+'}, {'alias': '/insights/<insight_id>', 'regex': '.*\\\\\\\\/insights\\\\\\\\/[0-9a-zA-Z]+'}, {'alias': '/project/<team_id>', 'regex': '\\\\\\\\/project\\\\\\\\/\\\\\\\\d+'}, {'alias': '/dashboard/<dashboard_id>', 'regex': '\\\\\\\\/dashboard\\\\\\\\/[0-9]+'}, {'alias': '/feature_flags/<feature_flag_id>', 'regex': '\\\\\\\\/feature_flags\\\\\\\\/[0-9]+'}, {'alias': '/replay/<replay_id>', 'regex': '\\\\\\\\/replay\\\\\\\\/[0-9a-f\\\\\\\\-]+'}, {'alias': '/cohorts/<cohort_id>', 'regex': '\\\\\\\\/cohorts\\\\\\\\/[0-9]+'}, {'alias': '/experiments/<experiment_id>', 'regex': '\\\\\\\\/experiments\\\\\\\\/[0-9]+'}, {'alias': '/surveys/<survey_id>', 'regex': '\\\\\\\\/surveys\\\\\\\\/[0-9a-f\\\\\\\\-]+'}, {'alias': '/events/<event_id>', 'regex': '\\\\\\\\/events\\\\\\\\/[0-9a-f\\\\\\\\-]+'}, {'alias': '/verify_email/<id>', 'regex': '\\\\\\\\/verify_email\\\\\\\\/[0-9a-f\\\\\\\\-]+'}, {'alias': '/community/profiles/<id>', 'regex': '\\\\\\\\/community\\\\\\\\/profiles\\\\\\\\/[0-9]+'}, {'alias': '/notebooks/<notebook_id>', 'regex': '\\\\\\\\/notebooks\\\\\\\\/[a-zA-Z0-9]+'}, {'alias': '/groups/<id>', 'regex': '\\\\\\\\/groups\\\\\\\\/[0-9]+\\\\\\\\/[a-zA-Z0-9]+'}, {'alias': '/signup/<id>', 'regex': '\\\\\\\\/signup\\\\\\\\/[0-9a-f\\\\\\\\-]+'}, {'alias': '/playlists/<playlist_id>', 'regex': '\\\\\\\\/playlists\\\\\\\\/[a-zA-Z0-9]+'}, {'alias': '/destinations/<destination_id>', 'regex': '\\\\\\\\/destinations?\\\\\\\\/[0-9a-zA-Z\\\\\\\\-]+'}, {'alias': '/properties/<property_id>', 'regex': '\\\\\\\\/properties\\\\\\\\/[0-9a-f\\\\\\\\-]+'}, {'alias': '/sources/<source_id>', 'regex': '\\\\\\\\/sources\\\\\\\\/[0-9a-zA-Z\\\\\\\\-]+'}, {'alias': '/reset', 'regex': '\\\\\\\\/reset\\\\\\\\/[0-9a-zA-Z\\\\\\\\-]+'}, {'alias': '/actions/<action_id>', 'regex': '\\\\\\\\/actions\\\\\\\\/[0-9]+'}, {'alias': '/shared-metrics/<metric_id>', 'regex': '\\\\\\\\/shared-metrics\\\\\\\\/[0-9]+'}]\",\"cache_target_age\":\"2025-01-20T23:41:25.930048Z\",\"calculation_trigger\":null,\"dateFrom\":\"2025-01-06 00:00:00\",\"dateTo\":\"2025-01-20 23:59:59\",\"error\":null,\"hogql\":null,\"is_cached\":true,\"last_refresh\":\"2025-01-20T21:41:25.930048Z\",\"modifiers\":{\"bounceRateDurationSeconds\":null,\"bounceRatePageViewMode\":\"uniq_page_screen_autocaptures\",\"customChannelTypeRules\":[],\"dataWarehouseEventsModifiers\":null,\"debug\":null,\"inCohortVia\":\"auto\",\"materializationMode\":\"legacy_null_as_null\",\"optimizeJoinedFilters\":false,\"personsArgMaxVersion\":\"auto\",\"personsJoinMode\":null,\"personsOnEventsMode\":\"person_id_override_properties_on_events\",\"propertyGroupsMode\":\"optimized\",\"s3TableUseInvalidColumns\":null,\"sessionTableVersion\":\"auto\",\"useMaterializedViews\":true},\"next_allowed_client_refresh\":\"2025-01-20T21:56:25.930048Z\",\"query_status\":null,\"results\":[{\"changeFromPreviousPct\":12.4,\"isIncreaseBad\":null,\"key\":\"visitors\",\"kind\":\"unit\",\"previous\":160000,\"value\":171861},{\"changeFromPreviousPct\":15.6,\"isIncreaseBad\":null,\"key\":\"views\",\"kind\":\"unit\",\"previous\":4700000,\"value\":4863551},{\"changeFromPreviousPct\":-1.4,\"isIncreaseBad\":null,\"key\":\"sessions\",\"kind\":\"unit\",\"previous\":552000,\"value\":547323},{\"changeFromPreviousPct\":0,\"isIncreaseBad\":null,\"key\":\"session duration\",\"kind\":\"duration_s\",\"previous\":724,\"value\":724.9206857358319},{\"changeFromPreviousPct\":-0.5,\"isIncreaseBad\":true,\"key\":\"bounce rate\",\"kind\":\"percentage\",\"previous\":10,\"value\":9.921511959952788}],\"samplingRate\":{\"denominator\":null,\"numerator\":1},\"timezone\":\"US/Pacific\",\"timings\":null}");var Browser=__webpack_require__("../../frontend/src/scenes/web-analytics/tiles/__mocks__/Browser.json"),Path=__webpack_require__("../../frontend/src/scenes/web-analytics/tiles/__mocks__/Path.json"),ReferringDomain=__webpack_require__("../../frontend/src/scenes/web-analytics/tiles/__mocks__/ReferringDomain.json"),Retention=__webpack_require__("../../frontend/src/scenes/web-analytics/tiles/__mocks__/Retention.json"),webAnalyticsLogic=__webpack_require__("../../frontend/src/scenes/web-analytics/webAnalyticsLogic.tsx"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let WebAnalyticsDashboard_stories={title:"Scenes-App/Web Analytics",parameters:{layout:"fullscreen",viewMode:"story",mockDate:"2023-02-01",testOptions:{includeNavigationInSnapshot:!0,waitForLoadersToDisappear:!0,waitForSelector:"[data-attr=trend-line-graph] > canvas"}},decorators:[(0,browser.x8)({get:{"/stats":()=>[200,{users_on_product:2387}],"/api/projects/:team_id/event_definitions":()=>[200,{count:5}]},post:{"/api/environments/:team_id/query":req=>{let query=req.body.query,queryKind=query.kind;if("DatabaseSchemaQuery"===queryKind)return[200,{tables:{}}];if("WebOverviewQuery"===queryKind)return[200,WebOverview_namespaceObject];if("TrendsQuery"===queryKind)return[200,UniqueVisitors_namespaceObject];if("WebStatsTableQuery"===queryKind){if("Page"===query.breakdownBy)return[200,Path];if("InitialReferringDomain"===query.breakdownBy)return[200,ReferringDomain];if("Browser"===query.breakdownBy)return[200,Browser]}else if("RetentionQuery"===queryKind)return[200,Retention]}}})]};function WebAnalyticsDashboard(){let{setSourceTab,setDeviceTab}=(0,index_esm.useActions)(webAnalyticsLogic.WG);return(0,react.useEffect)(()=>{lib.router.actions.push(urls.j.webAnalytics()),setSourceTab(webAnalyticsLogic.VL.REFERRING_DOMAIN),setDeviceTab(webAnalyticsLogic.tL.BROWSER)},[setDeviceTab,setSourceTab]),(0,jsx_runtime.jsx)(App.g,{})}WebAnalyticsDashboard.parameters={...WebAnalyticsDashboard.parameters,docs:{...WebAnalyticsDashboard.parameters?.docs,source:{originalSource:"function WebAnalyticsDashboard(): JSX.Element {\n  const {\n    setSourceTab,\n    setDeviceTab\n  } = useActions(webAnalyticsLogic);\n  useEffect(() => {\n    // Open the web analytics dashboard page\n    router.actions.push(urls.webAnalytics());\n\n    // Set the source tab to referring domain\n    setSourceTab(SourceTab.REFERRING_DOMAIN);\n\n    // Set the device tab to browsers\n    setDeviceTab(DeviceTab.BROWSER);\n  }, [setDeviceTab, setSourceTab]);\n  return <App />;\n}",...WebAnalyticsDashboard.parameters?.docs?.source}}};let __namedExportsOrder=["WebAnalyticsDashboard"]}}]);