(window.webpackJsonp=window.webpackJsonp||[]).push([[7,10],{"./frontend/src/scenes/apps/ErrorDetailsDrawer.tsx":function(z,p,e){"use strict";e.r(p),e.d(p,"ErrorDetailsDrawer",function(){return x});var C=e("./node_modules/core-js/modules/es.object.keys.js"),S=e.n(C),A=e("./node_modules/core-js/modules/es.symbol.js"),f=e.n(A),L=e("./node_modules/core-js/modules/es.array.filter.js"),E=e.n(L),I=e("./node_modules/core-js/modules/es.object.to-string.js"),G=e.n(I),y=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),w=e.n(y),B=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Q=e.n(B),K=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),X=e.n(K),R=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),$=e.n(R),U=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),F=e.n(U),W=e("./node_modules/react/index.js"),Y=e.n(W),M=e("./node_modules/kea/lib/index.esm.js"),b=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),d=e("./frontend/src/lib/components/Drawer.tsx"),T=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),H=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),v=e("./frontend/src/lib/components/PaginationControl/index.tsx"),j=e("./node_modules/antd/es/tabs/index.js"),O=e("./frontend/src/lib/components/LemonLabel/LemonLabel.tsx"),m=e("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),_=e("./node_modules/react/jsx-runtime.js"),h=e.n(_);function l(o,r){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(o);r&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(o,a).enumerable})),s.push.apply(s,t)}return s}function g(o){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?l(Object(s),!0).forEach(function(t){$()(o,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(s,t))})}return o}function x(){var o=Object(M.useValues)(b.appMetricsSceneLogic),r=o.errorDetailsDrawerError,s=o.errorDetailsLoading,t=Object(M.useActions)(b.appMetricsSceneLogic),a=t.closeErrorDetailsDrawer;return Object(_.jsx)(d.a,{visible:!!r,onClose:a,title:"Viewing error details: ".concat(r),width:"min(50vw, 80rem)",destroyOnClose:!0,children:s?Object(_.jsx)(T.a,{className:"h-10"}):Object(_.jsx)(n,{})})}function n(){var o=Object(M.useValues)(b.appMetricsSceneLogic),r=o.errorDetails,s=Object(v.c)(r,{pageSize:1}),t=F()(s.dataSourcePage,1),a=t[0];return Object(_.jsxs)("div",{children:[Object(_.jsx)(v.a,g(g({},s),{},{nouns:["sample error","sample errors"]})),Object(_.jsxs)(j.a,{children:[Object(_.jsxs)(j.a.TabPane,{tab:"Overview",children:[Object(_.jsxs)("div",{children:[Object(_.jsx)(O.a,{children:"Error:"})," ",a.error_type]}),a.error_details.error.message&&Object(_.jsxs)("div",{children:[Object(_.jsx)(O.a,{children:"Error message:"})," ",a.error_details.error.message]}),Object(_.jsxs)("div",{children:[Object(_.jsx)(O.a,{children:"When:"})," ",Object(_.jsx)(H.b,{time:a.timestamp,showSeconds:!0})]}),a.error_details.eventCount&&Object(_.jsxs)("div",{children:[Object(_.jsx)(O.a,{children:"Event count:"})," ",a.error_details.eventCount]})]},"overview"),a.error_details.event&&Object(_.jsx)(j.a.TabPane,{tab:"Event",children:Object(_.jsx)(m.a,{language:m.b.JSON,children:JSON.stringify(a.error_details.event,null,2)})},"event"),a.error_details.error.stack&&Object(_.jsx)(j.a.TabPane,{tab:"Stack trace",children:Object(_.jsx)(m.a,{wrap:!0,language:m.b.JavaScript,children:a.error_details.error.stack})},"stacktrace")]})]})}},"./frontend/src/scenes/apps/appMetricsSceneLogic.ts":function(z,p,e){"use strict";e.r(p),e.d(p,"AppMetricsTab",function(){return l}),e.d(p,"appMetricsSceneLogic",function(){return x});var C=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),S=e.n(C),A=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),f=e.n(A),L=e("./node_modules/@babel/runtime/regenerator/index.js"),E=e.n(L),I=e("./node_modules/core-js/modules/es.array.iterator.js"),G=e.n(I),y=e("./node_modules/core-js/modules/es.object.to-string.js"),w=e.n(y),B=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Q=e.n(B),K=e("./node_modules/core-js/modules/es.array.concat.js"),X=e.n(K),R=e("./node_modules/core-js/modules/es.function.name.js"),$=e.n(R),U=e("./node_modules/core-js/modules/es.array.includes.js"),F=e.n(U),W=e("./node_modules/core-js/modules/es.string.includes.js"),Y=e.n(W),M=e("./node_modules/core-js/modules/es.array.filter.js"),b=e.n(M),d=e("./node_modules/kea/lib/index.esm.js"),T=e("./node_modules/kea-loaders/lib/index.js"),H=e.n(T),v=e("./frontend/src/scenes/urls.ts"),j=e("./frontend/src/lib/api.ts"),O=e("./frontend/src/scenes/teamLogic.tsx"),m=e("./node_modules/kea-router/lib/index.js"),_=e.n(m),h=e("./frontend/src/lib/utils.tsx"),l;(function(n){n.ProcessEvent="processEvent",n.OnEvent="onEvent",n.ExportEvents="exportEvents",n.HistoricalExports="historical_exports"})(l||(l={}));var g=[l.ProcessEvent,l.OnEvent,l.ExportEvents],x=Object(d.kea)([Object(d.path)(function(n){return["scenes","apps","appMetricsSceneLogic",n]}),Object(d.props)({}),Object(d.key)(function(n){return n.pluginConfigId}),Object(d.actions)({setActiveTab:function(o){return{tab:o}},setDateFrom:function(o){return{dateFrom:o}},openErrorDetailsDrawer:function(o,r,s){return{errorType:o,category:r,jobId:s}},closeErrorDetailsDrawer:!0}),Object(d.reducers)({activeTab:[null,{setActiveTab:function(o,r){var s=r.tab;return s}}],dateFrom:["-30d",{setDateFrom:function(o,r){var s=r.dateFrom;return s}}],errorDetailsDrawerError:[null,{openErrorDetailsDrawer:function(o,r){var s=r.errorType;return s},closeErrorDetailsDrawer:function(){return null}}]}),Object(T.loaders)(function(n){var o=n.values,r=n.props;return{pluginConfig:[null,{loadPluginConfig:function(){var s=f()(E.a.mark(function a(){return E.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,j.b.get("api/projects/".concat(O.a.values.currentTeamId,"/plugin_configs/").concat(r.pluginConfigId));case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},a)}));function t(){return s.apply(this,arguments)}return t}()}],appMetricsResponse:[null,{loadMetrics:function(){var s=f()(E.a.mark(function a(){var c;return E.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return c=Object(h.Eb)({category:o.activeTab,date_from:o.dateFrom}),u.next=3,j.b.get("api/projects/".concat(O.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"?").concat(c));case 3:return u.abrupt("return",u.sent);case 4:case"end":return u.stop()}},a)}));function t(){return s.apply(this,arguments)}return t}()}],historicalExports:[[],{loadHistoricalExports:function(){var s=f()(E.a.mark(function a(){var c,i;return E.a.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,j.b.get("api/projects/".concat(O.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"/historical_exports"));case 2:return c=D.sent,i=c.results,D.abrupt("return",i);case 5:case"end":return D.stop()}},a)}));function t(){return s.apply(this,arguments)}return t}()}],errorDetails:[[],{openErrorDetailsDrawer:function(){var s=f()(E.a.mark(function a(c){var i,u,D,J,V,N;return E.a.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return i=c.category,u=c.jobId,D=c.errorType,J=Object(h.Eb)({category:i,job_id:u,error_type:D}),P.next=4,j.b.get("api/projects/".concat(O.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"/error_details?").concat(J));case 4:return V=P.sent,N=V.result,P.abrupt("return",N);case 7:case"end":return P.stop()}},a)}));function t(a){return s.apply(this,arguments)}return t}()}]}}),Object(d.selectors)(function(n){var o=n.values;return{breadcrumbs:[function(r){return[r.pluginConfig,function(s,t){return t.pluginConfigId}]},function(r,s){var t;return[{name:"Apps",path:v.a.projectApps()},{name:r==null||(t=r.plugin_info)===null||t===void 0?void 0:t.name,path:v.a.appMetrics(s)}]}],showTab:[function(){return[]},function(){return function(r){var s;if(o.pluginConfigLoading||!o.pluginConfig)return!1;var t=((s=o.pluginConfig.plugin_info.capabilities)===null||s===void 0?void 0:s.methods)||[];return r===l.HistoricalExports?t.includes("exportEvents"):r===l.OnEvent&&t.includes("exportEvents")?!1:t.includes(r)}}]}}),Object(d.listeners)(function(n){var o=n.values,r=n.actions;return{loadPluginConfigSuccess:function(){if(!o.activeTab){var t=g.filter(function(i){return o.showTab(i)}),a=S()(t,1),c=a[0];r.setActiveTab(c)}},setActiveTab:function(t){var a=t.tab;a===l.HistoricalExports?r.loadHistoricalExports():r.loadMetrics()},setDateFrom:function(){r.loadMetrics()}}}),Object(m.actionToUrl)(function(n){var o=n.values,r=n.props;return{setActiveTab:function(){var t;return o.activeTab===l.HistoricalExports?v.a.appHistoricalExports(r.pluginConfigId):v.a.appMetrics(r.pluginConfigId,(t=o.activeTab)!==null&&t!==void 0?t:void 0)}}}),Object(m.urlToAction)(function(n){var o=n.values,r=n.actions;return{"/app/:pluginConfigId/:page":function(t,a){o.pluginConfig||r.loadPluginConfig(),t.page===l.HistoricalExports?r.setActiveTab(l.HistoricalExports):a.tab&&g.includes(a.tab)&&r.setActiveTab(a.tab)}}})])}}]);
