(window.webpackJsonp=window.webpackJsonp||[]).push([[6,8,10,308],{"./frontend/src/scenes/apps/AppMetricsGraph.scss":function(g,l,e){"use strict";e.r(l);var f=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),E=e.n(f),p=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/apps/AppMetricsGraph.scss"),c=e.n(p),v={};v.insert="head",v.singleton=!1;var m=E()(c.a,v);l.default=c.a.locals||{}},"./frontend/src/scenes/apps/AppMetricsGraph.tsx":function(g,l,e){"use strict";e.r(l),e.d(l,"AppMetricsGraph",function(){return P});var f=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),E=e.n(f),p=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),c=e.n(p),v=e("./node_modules/core-js/modules/es.array.concat.js"),m=e.n(v),h=e("./node_modules/core-js/modules/es.object.keys.js"),$=e.n(h),R=e("./node_modules/core-js/modules/es.symbol.js"),N=e.n(R),B=e("./node_modules/core-js/modules/es.array.filter.js"),V=e.n(B),K=e("./node_modules/core-js/modules/es.object.to-string.js"),J=e.n(K),U=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Y=e.n(U),W=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Z=e.n(W),x=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),z=e.n(x),C=e("./node_modules/react/index.js"),Q=e.n(C),j=e("./frontend/src/lib/colors.ts"),L=e("./node_modules/chart.js/dist/chart.mjs"),S=e("./frontend/src/scenes/apps/constants.tsx"),A=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),y=e("./frontend/src/scenes/apps/AppMetricsGraph.scss"),D=e("./frontend/src/lib/utils.tsx"),M=e("./node_modules/react/jsx-runtime.js"),X=e.n(M);function b(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);o&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),s.push.apply(s,t)}return s}function i(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?b(Object(s),!0).forEach(function(t){E()(r,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):b(Object(s)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(s,t))})}return r}function P(r){var o=r.tab,s=r.metrics,t=r.metricsLoading,n=Object(C.useRef)(null),a=S.DescriptionColumns[o];return Object(C.useEffect)(function(){var d;if(n.current&&s){var _;d=new L.a((_=n.current)===null||_===void 0?void 0:_.getContext("2d"),{type:"line",data:{labels:s.dates,datasets:[i({label:a.successes,data:s.successes,borderColor:""},I("data-brand-blue"))].concat(c()(a.successes_on_retry?[i({label:a.successes_on_retry,data:s.successes_on_retry},I("data-yellow"))]:[]),[i({label:a.failures,data:s.failures},I("data-pink"))])},options:{scales:{x:{ticks:{maxRotation:0},grid:{display:!1}},y:{beginAtZero:!0}},plugins:{crosshair:!1,legend:{display:!1}},maintainAspectRatio:!1,interaction:{mode:"index",axis:"x",intersect:!1}}})}return function(){var u;(u=d)===null||u===void 0||u.destroy()}},[s]),t||!s?Object(M.jsx)(A.a,{className:"AppMetricsGraph"}):Object(M.jsx)("div",{className:"AppMetricsGraph",children:Object(M.jsx)("canvas",{ref:n})})}function I(r){var o=Object(j.b)(r);return{borderColor:o,hoverBorderColor:Object(D.lb)(o,-20),hoverBackgroundColor:Object(D.lb)(o,-20),backgroundColor:o,fill:!1,borderWidth:2,pointRadius:0}}try{P.displayName="AppMetricsGraph",P.__docgenInfo={description:"",displayName:"AppMetricsGraph",props:{tab:{defaultValue:null,description:"",name:"tab",required:!0,type:{name:"enum",value:[{value:'"processEvent"'},{value:'"onEvent"'},{value:'"exportEvents"'},{value:'"historical_exports"'}]}},metrics:{defaultValue:null,description:"",name:"metrics",required:!1,type:{name:"AppMetrics | null"}},metricsLoading:{defaultValue:null,description:"",name:"metricsLoading",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/apps/AppMetricsGraph.tsx#AppMetricsGraph"]={docgenInfo:P.__docgenInfo,name:"AppMetricsGraph",path:"frontend/src/scenes/apps/AppMetricsGraph.tsx#AppMetricsGraph"})}catch(r){}},"./frontend/src/scenes/apps/appMetricsSceneLogic.ts":function(g,l,e){"use strict";e.r(l),e.d(l,"AppMetricsTab",function(){return i}),e.d(l,"appMetricsSceneLogic",function(){return I});var f=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),E=e.n(f),p=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),c=e.n(p),v=e("./node_modules/@babel/runtime/regenerator/index.js"),m=e.n(v),h=e("./node_modules/core-js/modules/es.array.iterator.js"),$=e.n(h),R=e("./node_modules/core-js/modules/es.object.to-string.js"),N=e.n(R),B=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),V=e.n(B),K=e("./node_modules/core-js/modules/es.array.concat.js"),J=e.n(K),U=e("./node_modules/core-js/modules/es.function.name.js"),Y=e.n(U),W=e("./node_modules/core-js/modules/es.array.includes.js"),Z=e.n(W),x=e("./node_modules/core-js/modules/es.string.includes.js"),z=e.n(x),C=e("./node_modules/core-js/modules/es.array.filter.js"),Q=e.n(C),j=e("./node_modules/kea/lib/index.esm.js"),L=e("./node_modules/kea-loaders/lib/index.js"),S=e.n(L),A=e("./frontend/src/scenes/urls.ts"),y=e("./frontend/src/lib/api.ts"),D=e("./frontend/src/scenes/teamLogic.tsx"),M=e("./node_modules/kea-router/lib/index.js"),X=e.n(M),b=e("./frontend/src/lib/utils.tsx"),i;(function(r){r.ProcessEvent="processEvent",r.OnEvent="onEvent",r.ExportEvents="exportEvents",r.HistoricalExports="historical_exports"})(i||(i={}));var P=[i.ProcessEvent,i.OnEvent,i.ExportEvents],I=Object(j.kea)([Object(j.path)(function(r){return["scenes","apps","appMetricsSceneLogic",r]}),Object(j.props)({}),Object(j.key)(function(r){return r.pluginConfigId}),Object(j.actions)({setActiveTab:function(o){return{tab:o}},setDateFrom:function(o){return{dateFrom:o}},openErrorDetailsDrawer:function(o,s,t){return{errorType:o,category:s,jobId:t}},closeErrorDetailsDrawer:!0}),Object(j.reducers)({activeTab:[null,{setActiveTab:function(o,s){var t=s.tab;return t}}],dateFrom:["-30d",{setDateFrom:function(o,s){var t=s.dateFrom;return t}}],errorDetailsDrawerError:[null,{openErrorDetailsDrawer:function(o,s){var t=s.errorType;return t},closeErrorDetailsDrawer:function(){return null}}]}),Object(L.loaders)(function(r){var o=r.values,s=r.props;return{pluginConfig:[null,{loadPluginConfig:function(){var t=c()(m.a.mark(function a(){return m.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,y.b.get("api/projects/".concat(D.a.values.currentTeamId,"/plugin_configs/").concat(s.pluginConfigId));case 2:return _.abrupt("return",_.sent);case 3:case"end":return _.stop()}},a)}));function n(){return t.apply(this,arguments)}return n}()}],appMetricsResponse:[null,{loadMetrics:function(){var t=c()(m.a.mark(function a(){var d;return m.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return d=Object(b.Eb)({category:o.activeTab,date_from:o.dateFrom}),u.next=3,y.b.get("api/projects/".concat(D.a.values.currentTeamId,"/app_metrics/").concat(s.pluginConfigId,"?").concat(d));case 3:return u.abrupt("return",u.sent);case 4:case"end":return u.stop()}},a)}));function n(){return t.apply(this,arguments)}return n}()}],historicalExports:[[],{loadHistoricalExports:function(){var t=c()(m.a.mark(function a(){var d,_;return m.a.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,y.b.get("api/projects/".concat(D.a.values.currentTeamId,"/app_metrics/").concat(s.pluginConfigId,"/historical_exports"));case 2:return d=O.sent,_=d.results,O.abrupt("return",_);case 5:case"end":return O.stop()}},a)}));function n(){return t.apply(this,arguments)}return n}()}],errorDetails:[[],{openErrorDetailsDrawer:function(){var t=c()(m.a.mark(function a(d){var _,u,O,G,F,H;return m.a.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return _=d.category,u=d.jobId,O=d.errorType,G=Object(b.Eb)({category:_,job_id:u,error_type:O}),T.next=4,y.b.get("api/projects/".concat(D.a.values.currentTeamId,"/app_metrics/").concat(s.pluginConfigId,"/error_details?").concat(G));case 4:return F=T.sent,H=F.result,T.abrupt("return",H);case 7:case"end":return T.stop()}},a)}));function n(a){return t.apply(this,arguments)}return n}()}]}}),Object(j.selectors)(function(r){var o=r.values;return{breadcrumbs:[function(s){return[s.pluginConfig,function(t,n){return n.pluginConfigId}]},function(s,t){var n;return[{name:"Apps",path:A.a.projectApps()},{name:s==null||(n=s.plugin_info)===null||n===void 0?void 0:n.name,path:A.a.appMetrics(t)}]}],showTab:[function(){return[]},function(){return function(s){var t;if(o.pluginConfigLoading||!o.pluginConfig)return!1;var n=((t=o.pluginConfig.plugin_info.capabilities)===null||t===void 0?void 0:t.methods)||[];return s===i.HistoricalExports?n.includes("exportEvents"):s===i.OnEvent&&n.includes("exportEvents")?!1:n.includes(s)}}]}}),Object(j.listeners)(function(r){var o=r.values,s=r.actions;return{loadPluginConfigSuccess:function(){if(!o.activeTab){var n=P.filter(function(_){return o.showTab(_)}),a=E()(n,1),d=a[0];s.setActiveTab(d)}},setActiveTab:function(n){var a=n.tab;a===i.HistoricalExports?s.loadHistoricalExports():s.loadMetrics()},setDateFrom:function(){s.loadMetrics()}}}),Object(M.actionToUrl)(function(r){var o=r.values,s=r.props;return{setActiveTab:function(){var n;return o.activeTab===i.HistoricalExports?A.a.appHistoricalExports(s.pluginConfigId):A.a.appMetrics(s.pluginConfigId,(n=o.activeTab)!==null&&n!==void 0?n:void 0)}}}),Object(M.urlToAction)(function(r){var o=r.values,s=r.actions;return{"/app/:pluginConfigId/:page":function(n,a){o.pluginConfig||s.loadPluginConfig(),n.page===i.HistoricalExports?s.setActiveTab(i.HistoricalExports):a.tab&&P.includes(a.tab)&&s.setActiveTab(a.tab)}}})])},"./frontend/src/scenes/apps/constants.tsx":function(g,l,e){"use strict";e.r(l),e.d(l,"DescriptionColumns",function(){return v});var f=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),E=e.n(f),p=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),c,v=(c={},E()(c,p.AppMetricsTab.ProcessEvent,{successes:"Events processed",failures:"Failed events"}),E()(c,p.AppMetricsTab.OnEvent,{successes:"Events processed",successes_on_retry:"Events processed on retry",failures:"Failed events"}),E()(c,p.AppMetricsTab.ExportEvents,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),E()(c,p.AppMetricsTab.HistoricalExports,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),c)},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/apps/AppMetricsGraph.scss":function(g,l,e){var f=e("./node_modules/css-loader/dist/runtime/api.js");l=f(!1),l.push([g.i,".AppMetricsGraph{height:300px}",""]),g.exports=l}}]);
