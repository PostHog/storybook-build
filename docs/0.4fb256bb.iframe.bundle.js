(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"./frontend/src/scenes/actions/EventName.tsx":function(pe,B,e){"use strict";e.d(B,"a",function(){return ie}),e.d(B,"b",function(){return Z});var H=e("./node_modules/react/index.js"),F=e.n(H),ee=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),te=e("./frontend/src/lib/components/TaxonomicPopup/TaxonomicPopup.tsx"),le=e("./frontend/src/lib/components/TaxonomicFilter/types.ts");function ie(z){var ne=z.value,G=z.onChange;return F.a.createElement(te.d,{groupType:le.a.Events,onChange:G,value:ne,type:"secondary",style:{maxWidth:"24rem"},placeholder:"Choose an event",dataAttr:"event-name-box",renderValue:function(s){return F.a.createElement(ee.a,{value:s,disablePopover:!0})},allowClear:!0})}function Z(z){var ne=z.value,G=z.onChange;return F.a.createElement(te.b,{groupType:le.a.Events,onChange:G,value:ne,type:"secondary",placeholder:"Select an event",dataAttr:"event-name-box",renderValue:function(s){return F.a.createElement(ee.a,{value:s,disablePopover:!0})},allowClear:!0})}try{ie.displayName="EventName",ie.__docgenInfo={description:"",displayName:"EventName",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/actions/EventName.tsx#EventName"]={docgenInfo:ie.__docgenInfo,name:"EventName",path:"frontend/src/scenes/actions/EventName.tsx#EventName"})}catch(z){}try{Z.displayName="LemonEventName",Z.__docgenInfo={description:"",displayName:"LemonEventName",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/actions/EventName.tsx#LemonEventName"]={docgenInfo:Z.__docgenInfo,name:"LemonEventName",path:"frontend/src/scenes/actions/EventName.tsx#LemonEventName"})}catch(z){}},"./frontend/src/scenes/events/EventDetails.tsx":function(pe,B,e){"use strict";e.d(B,"a",function(){return J});var H=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),F=e.n(H),ee=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),te=e.n(ee),le=e("./node_modules/core-js/modules/es.object.keys.js"),ie=e("./node_modules/core-js/modules/es.symbol.js"),Z=e("./node_modules/core-js/modules/es.array.filter.js"),z=e("./node_modules/core-js/modules/es.object.to-string.js"),ne=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),G=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Q=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),s=e("./node_modules/react/index.js"),C=e.n(s),D=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),re=e("./frontend/src/lib/components/PropertiesTable.tsx"),U=e("./frontend/src/scenes/events/EventElements.tsx"),ce=e("./node_modules/antd/es/tabs/index.js"),Te=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),je=e.n(Te),Ce=e("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),fe=e("./frontend/src/lib/utils.tsx"),se=["event","id","uuid","distinct_id","properties","elements","timestamp","person"];function ue(_,a){var O=Object.keys(_);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(_);a&&(y=y.filter(function(S){return Object.getOwnPropertyDescriptor(_,S).enumerable})),O.push.apply(O,y)}return O}function Y(_){for(var a=1;a<arguments.length;a++){var O=arguments[a]!=null?arguments[a]:{};a%2?ue(Object(O),!0).forEach(function(y){F()(_,y,O[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(O)):ue(Object(O)).forEach(function(y){Object.defineProperty(_,y,Object.getOwnPropertyDescriptor(O,y))})}return _}function W(_){var a=_.event,O=a.event,y=a.id,S=a.uuid,K=a.distinct_id,ve=a.properties,$=a.elements,me=a.timestamp,X=a.person,oe=je()(a,se),R=Y(Y(Y(Y({},y?{id:y}:null),S?{uuid:S}:null),{},{timestamp:me,event:O,distinct_id:K,properties:Object(fe.xb)(ve)},$&&$.length>0?{elements:$}:null),oe);return C.a.createElement(Ce.a,{language:Ce.b.JSON},JSON.stringify(R,null,4))}try{W.displayName="EventJSON",W.__docgenInfo={description:"",displayName:"EventJSON",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"Record<string, any>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventJSON.tsx#EventJSON"]={docgenInfo:W.__docgenInfo,name:"EventJSON",path:"frontend/src/scenes/events/EventJSON.tsx#EventJSON"})}catch(_){}var he=e("./frontend/src/lib/dayjs.ts"),w=e("./frontend/src/lib/components/LemonButton/index.ts");function V(_,a){var O=Object.keys(_);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(_);a&&(y=y.filter(function(S){return Object.getOwnPropertyDescriptor(_,S).enumerable})),O.push.apply(O,y)}return O}function T(_){for(var a=1;a<arguments.length;a++){var O=arguments[a]!=null?arguments[a]:{};a%2?V(Object(O),!0).forEach(function(y){F()(_,y,O[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(O)):V(Object(O)).forEach(function(y){Object.defineProperty(_,y,Object.getOwnPropertyDescriptor(O,y))})}return _}var de=ce.a.TabPane;function J(_){for(var a=_.event,O=Object(s.useState)(!1),y=te()(O,2),S=y[0],K=y[1],ve={},$={},me=0,X=0,oe=Object.keys(a.properties);X<oe.length;X++){var R=oe[X];D.e.event[R]&&D.e.event[R].hide&&(me+=1,S&&($[R]=a.properties[R])),(!D.e.event[R]||!D.e.event[R].hide)&&(ve[R]=a.properties[R])}return C.a.createElement(ce.a,{"data-attr":"event-details",defaultActiveKey:"properties",style:{float:"left",width:"100%"},tabBarStyle:{margin:0}},C.a.createElement(de,{tab:"Properties",key:"properties"},C.a.createElement(re.a,{properties:T(T({$timestamp:Object(he.a)(a.timestamp).toISOString()},ve),$),useDetectedPropertyType:!0}),me>0&&C.a.createElement(w.a,{className:"mb-05",onClick:function(){return K(!S)},size:"small"},S?"Hide":"Show"," ",Object(fe.pb)(me,"hidden property","hidden properties"))),C.a.createElement(de,{tab:"JSON",key:"json"},C.a.createElement(W,{event:a})),a.elements&&a.elements.length>0&&C.a.createElement(de,{tab:"Elements",key:"elements"},C.a.createElement(U.a,{event:a})))}try{J.displayName="EventDetails",J.__docgenInfo={description:"",displayName:"EventDetails",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"EventType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventDetails.tsx#EventDetails"]={docgenInfo:J.__docgenInfo,name:"EventDetails",path:"frontend/src/scenes/events/EventDetails.tsx#EventDetails"})}catch(_){}},"./frontend/src/scenes/events/EventElements.tsx":function(pe,B,e){"use strict";e.d(B,"a",function(){return Y});var H=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),F=e.n(H),ee=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),te=e.n(ee),le=e("./node_modules/core-js/modules/es.array.join.js"),ie=e.n(le),Z=e("./node_modules/core-js/modules/es.array.fill.js"),z=e.n(Z),ne=e("./node_modules/core-js/modules/es.array.slice.js"),G=e.n(ne),Q=e("./node_modules/core-js/modules/es.array.map.js"),s=e.n(Q),C=e("./node_modules/core-js/modules/es.object.entries.js"),D=e.n(C),re=e("./node_modules/core-js/modules/es.array.concat.js"),U=e.n(re),ce=e("./node_modules/core-js/modules/es.regexp.exec.js"),Te=e.n(ce),je=e("./node_modules/core-js/modules/es.string.replace.js"),Ce=e.n(je),fe=e("./node_modules/react/index.js"),se=e.n(fe);function ue(W){return Array(W).fill("    ").join("")}function Y(W){var he=W.event,w=te()(he.elements||[]).reverse();return w=w.slice(Math.max(w.length-10,1)),se.a.createElement("div",null,w.map(function(V,T){return se.a.createElement("pre",{className:"code",key:T,style:{margin:0,padding:0,borderRadius:0,backgroundColor:T===w.length-1?"var(--primary)":void 0}},ue(T),"<",V.tag_name,V.attr_id&&' id="'.concat(V.attr_id,'"'),Object.entries(V.attributes).map(function(de){var J=F()(de,2),_=J[0],a=J[1];return se.a.createElement("span",{key:_}," ".concat(_.replace("attr__",""),'="').concat(a,'"'))}),">",V.text,T===w.length-1&&se.a.createElement("span",null,"</",V.tag_name,">"))}),te()(w).reverse().slice(1).map(function(V,T){return se.a.createElement("pre",{className:"code",key:T,style:{margin:0,padding:0,borderRadius:0}},ue(w.length-T-2),"</",V.tag_name,">")}))}try{Y.displayName="EventElements",Y.__docgenInfo={description:"",displayName:"EventElements",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"EventType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventElements.tsx#EventElements"]={docgenInfo:Y.__docgenInfo,name:"EventElements",path:"frontend/src/scenes/events/EventElements.tsx#EventElements"})}catch(W){}},"./frontend/src/scenes/events/EventsTable.tsx":function(pe,B,e){"use strict";e.d(B,"a",function(){return k});var H=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),F=e.n(H),ee=e("./node_modules/core-js/modules/es.array.splice.js"),te=e("./node_modules/core-js/modules/es.array.map.js"),le=e("./node_modules/core-js/modules/es.array.find.js"),ie=e("./node_modules/core-js/modules/es.object.to-string.js"),Z=e("./node_modules/core-js/modules/es.array.concat.js"),z=e("./node_modules/core-js/modules/es.array.join.js"),ne=e("./node_modules/core-js/modules/es.object.keys.js"),G=e("./node_modules/core-js/modules/es.regexp.to-string.js"),Q=e("./node_modules/react/index.js"),s=e.n(Q),C=e("./node_modules/kea/lib/index.esm.js"),D=e("./frontend/src/scenes/events/EventDetails.tsx"),re=e("./frontend/src/lib/components/Link.tsx"),U=e("./node_modules/antd/es/button/index.js"),ce=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),Te=e.n(ce),je=e("./node_modules/core-js/modules/es.array.filter.js"),Ce=e("./node_modules/core-js/modules/es.symbol.js"),fe=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),se=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),ue=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Y=e("./node_modules/kea-router/lib/index.js"),W=e("./node_modules/@babel/runtime/helpers/typeof.js"),he=e.n(W),w=e("./node_modules/core-js/modules/es.regexp.exec.js"),V=e("./node_modules/core-js/modules/es.string.replace.js");function T(l){var p=l.value;return s.a.createElement("span",{title:p},he()(p)==="object"?JSON.stringify(p):p&&p.toString().replace(/(^\w+:|^)\/\//,""))}try{T.displayName="Property",T.__docgenInfo={description:"",displayName:"Property",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Property.tsx#Property"]={docgenInfo:T.__docgenInfo,name:"Property",path:"frontend/src/lib/components/Property.tsx#Property"})}catch(l){}var de=e("./frontend/src/lib/components/PropertyFilters/utils.ts");function J(l,p){var v=Object.keys(l);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(l);p&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(l,j).enumerable})),v.push.apply(v,g)}return v}function _(l){for(var p=1;p<arguments.length;p++){var v=arguments[p]!=null?arguments[p]:{};p%2?J(Object(v),!0).forEach(function(g){Te()(l,g,v[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(v)):J(Object(v)).forEach(function(g){Object.defineProperty(l,g,Object.getOwnPropertyDescriptor(v,g))})}return l}function a(l){var p=l.property,v=l.value,g=l.filters,j=l.onClick,Pe=l.className,h=Object(de.c)(g.properties),De=h.find(function(N){return N.key===p&&N.value===v&&!N.operator})?h.filter(function(N){return N.key!==p||N.value!==v||N.operator}):[].concat(F()(h),[{key:p,value:v}]),Ee=Object(Y.combineUrl)(window.location.pathname,_(_({},g),{},{properties:De}),{}),be=Ee.url;return s.a.createElement(re.a,{to:be,className:Pe,onClick:function(){j&&j(p,v)}},s.a.createElement(T,{value:v}))}try{a.displayName="FilterPropertyLink",a.__docgenInfo={description:"",displayName:"FilterPropertyLink",props:{property:{defaultValue:null,description:"",name:"property",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string | number"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((property: string, value: string | number) => void)"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/FilterPropertyLink.tsx#FilterPropertyLink"]={docgenInfo:a.__docgenInfo,name:"FilterPropertyLink",path:"frontend/src/lib/components/FilterPropertyLink.tsx#FilterPropertyLink"})}catch(l){}var O=e("./frontend/src/lib/utils.tsx"),y=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),S=e.n(y),K=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/events/EventsTable.scss"),ve=e.n(K),$={};$.insert="head",$.singleton=!1;var me=S()(ve.a,$),X=ve.a.locals||{},oe=e("./frontend/src/scenes/events/eventsTableLogic.ts"),R=e("./frontend/src/scenes/persons/PersonHeader.tsx"),x=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),Ae=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),Oe=e("./frontend/src/types.ts"),xe=e("./frontend/src/scenes/actions/EventName.tsx"),Be=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),ge=e("./frontend/src/lib/components/Tooltip.tsx"),Me=e("./node_modules/clsx/dist/clsx.m.js"),f=e("./frontend/src/lib/components/ResizableTable/tableConfigLogic.ts"),t=e("./frontend/src/scenes/urls.ts"),n=e("./frontend/src/lib/components/LemonTable/index.ts"),r=e("./frontend/src/lib/components/icons.tsx"),u=e("./frontend/src/lib/components/LemonButton/index.ts"),o=e("./frontend/src/lib/components/LemonButton/More.tsx"),m=e("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),i=e("./frontend/src/scenes/teamLogic.tsx"),d=e("./frontend/src/scenes/events/createActionFromEvent.tsx");function M(l){Object(Q.useEffect)(function(){var p="hidden",v="visibilitychange";typeof document.msHidden!="undefined"?(p="msHidden",v="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(p="webkitHidden",v="webkitvisibilitychange");var g=function(){l(!document[p])};return document.addEventListener(v,g),function(){document.removeEventListener(v,g)}},[])}var I=e("./frontend/src/lib/components/ResizableTable/TableConfig.tsx"),ae=e("./frontend/src/lib/utils/eventUsageLogic.ts");function k(l){var p=l.pageKey,v=l.fixedFilters,g=l.fixedColumns,j=l.sceneUrl,Pe=l.fetchMonths,h=Pe===void 0?12:Pe,De=l.startingColumns,Ee=l.showCustomizeColumns,be=Ee===void 0?!0:Ee,N=l.showExport,Ke=N===void 0?!0:N,_e=l.showAutoload,$e=_e===void 0?!0:_e,Ye=l.showEventFilter,Ne=Ye===void 0?!0:Ye,Je=l.showPropertyFilter,Fe=Je===void 0?!0:Je,He=l.showRowExpanders,tt=He===void 0?!0:He,ze=l.showActionsButton,nt=ze===void 0?!0:ze,Ge=l.showPersonColumn,rt=Ge===void 0?!0:Ge,Qe=l.linkPropertiesToFilters,Ue=Qe===void 0?!0:Qe,st=Object(C.useValues)(i.a),We=st.currentTeam,Xe=Object(oe.a)({fixedFilters:v,key:p,sceneUrl:j||t.a.events(),fetchMonths:h}),q=Object(C.useValues)(Xe),Le=q.properties,ot=q.eventsFormatted,Ze=q.isLoading,at=q.hasNext,ke=q.isLoadingNext,Re=q.eventFilter,lt=q.automaticLoadEnabled,it=q.exportUrl,ct=q.highlightEvents,ut=q.months,qe=Object(C.useValues)(Object(f.a)({startingColumns:De})),we=qe.tableWidth,Se=qe.selectedColumns,ye=Object(C.useActions)(Xe),dt=ye.fetchNextEvents,vt=ye.prependNewEvents,mt=ye.setEventFilter,pt=ye.toggleAutomaticLoad,ft=ye.startDownload,Et=ye.setPollingActive,_t=ye.setProperties,yt=!(v!=null&&v.person_id),jt=Object(C.useActions)(ae.f),ht=jt.reportEventsTablePollingReactedToPageVisibility;M(function(b){Et(b),ht(b)});var et=function(c,A){var P=c.date_break,E=c.new_events;return{children:P||(E?s.a.createElement(u.a,{icon:s.a.createElement(r.IconSync,null),style:{borderRadius:0},onClick:function(){return vt()},center:!0,fullWidth:!0},"There are new events. Click here to load them"):"???"),props:{colSpan:A+1,style:E?{padding:0}:void 0}}},Ot={title:"Person",key:"person",render:function(c,A){var P,E,L=A.event;return L?yt&&(P=L.person)!==null&&P!==void 0&&(E=P.distinct_ids)!==null&&E!==void 0&&E.length?s.a.createElement(re.a,{to:t.a.person(L.person.distinct_ids[0])},s.a.createElement(R.a,{withIcon:!0,person:L.person})):s.a.createElement(R.a,{withIcon:!0,person:L.person}):{props:{colSpan:0}}}},Ve=Object(Q.useMemo)(function(){var b=[{title:"Event",key:"event",width:"16rem",render:function(A,P){if(!P.event)return et(P,we);var E=P.event;return s.a.createElement(Ae.a,{value:Object(O.f)(E)})}},{title:"URL / Screen",key:"url",width:"4rem",render:function(A,P){var E=P.event;if(!E)return{props:{colSpan:0}};var L=E.properties.$current_url?"$current_url":"$screen_name";return Ue?s.a.createElement(a,{className:"ph-no-capture",property:L,value:E.properties[L],filters:{properties:Le}}):s.a.createElement(T,{value:E.properties[L]})}},{title:s.a.createElement(ge.a,{title:'This is the "Library" property on events. Sent by the SDK as "$lib"'},"Source"),key:"source",render:function(A,P){var E=P.event;return E?Ue?s.a.createElement(a,{property:"$lib",value:E.properties.$lib,filters:{properties:Le}}):s.a.createElement(T,{value:E.properties.$lib}):{props:{colSpan:0}}}}];return rt&&b.splice(1,0,Ot),b},[we]),gt=Object(Q.useMemo)(function(){var b=Se==="DEFAULT"?F()(Ve):Se.map(function(c,A){return Ve.find(function(P){return P.key===c})||{title:Ae.e.event[c]?Ae.e.event[c].label:c,key:c,render:function(E,L){var Ie=L.event;return Ie?Ue?s.a.createElement(a,{className:"ph-no-capture ",property:c,value:Ie.properties[c],filters:{properties:Le}}):s.a.createElement(T,{value:Ie.properties[c]}):A===0?et(L,we):{props:{colSpan:0}}}}});return b.push({title:"Time",key:"time",render:function(A,P){var E=P.event;return E?s.a.createElement(x.b,{time:E.timestamp,showSeconds:!0}):{props:{colSpan:0}}}}),nt&&b.push({key:"actions",width:0,render:function(A,P){var E=P.event;if(!E)return{props:{colSpan:0}};var L;return E.event==="$pageview"?L={insight:Oe.y.TRENDS,interval:"day",display:Oe.i.ActionsLineGraph,actions:[],events:[{id:"$pageview",name:"$pageview",type:"events",order:0,properties:[{key:"$current_url",value:E.properties.$current_url,type:"event"}]}]}:E.event!=="$autocapture"&&(L={insight:Oe.y.TRENDS,interval:"day",display:Oe.i.ActionsLineGraph,actions:[],events:[{id:E.event,name:E.event,type:"events",order:0,properties:[]}]}),s.a.createElement(o.a,{overlay:s.a.createElement(s.a.Fragment,null,We&&s.a.createElement(u.a,{type:"stealth",onClick:function(){return Object(d.a)(We.id,E,0,We.data_attributes||[])},fullWidth:!0,"data-attr":"events-table-create-action"},"Create action from event"),L&&s.a.createElement(u.a,{type:"stealth",to:t.a.insightNew(L),fullWidth:!0,"data-attr":"events-table-usage"},"Try out in Insights"))})}}),g?b.concat(g):b},[Se]);return s.a.createElement("div",{"data-attr":"manage-events-table"},s.a.createElement("div",{className:"events","data-attr":"events-table"},(Ne||Fe)&&s.a.createElement("div",{className:"flex pt pb space-x border-top"},Ne&&s.a.createElement(xe.b,{value:Re,onChange:function(c){mt(c||"")}}),Fe&&s.a.createElement(Be.a,{propertyFilters:Le,onChange:_t,pageKey:p,taxonomicPopoverPlacement:"bottom-start",style:{marginBottom:0,marginTop:0},eventNames:Re?[Re]:[],useLemonButton:!0})),$e||be||Ke?s.a.createElement("div",{className:Object(Me.a)("space-between-items pt pb",(Ne||Fe)&&"border-top")},$e&&s.a.createElement(m.a,{type:"primary",id:"autoload-switch",label:"Automatically load new events",checked:lt,onChange:pt}),s.a.createElement("div",{className:"flex space-x-05"},be&&s.a.createElement(I.a,{immutableColumns:["event","person"],defaultColumns:Ve.map(function(b){return b.key||""})}),Ke&&it&&s.a.createElement(ge.a,{title:"Export up to 10,000 latest events.",placement:"left"},s.a.createElement(u.a,{type:"secondary",icon:s.a.createElement(r.IconExport,{style:{color:"var(--primary)"}}),onClick:ft},"Export")))):null,s.a.createElement(n.a,{dataSource:ot,loading:Ze,columns:gt,key:Se==="DEFAULT"?"default":Se.join("-"),className:"ph-no-capture",loadingSkeletonRows:20,emptyState:Ze?void 0:Le.some(function(b){return Object.keys(b).length})||Re?"No events matching filters found in the last ".concat(ut," months!"):s.a.createElement(s.a.Fragment,null,"This project doesn't have any events. If you haven't integrated PostHog yet,"," ",s.a.createElement(re.a,{to:"/project/settings"},"click here to instrument analytics with PostHog in your product"),"."),rowKey:function(c){var A;return c.event?c.event.id+"-"+c.event.event:((A=c.date_break)===null||A===void 0?void 0:A.toString())||""},rowClassName:function(c){return Object(Me.a)({"event-row":c.event,highlighted:c.event&&ct[c.event.id],"event-row-is-exception":c.event&&c.event.event==="$exception","event-row-date-separator":c.date_break,"event-row-new":c.new_events})},expandable:tt?{expandedRowRender:function(c){var A=c.event;return A&&s.a.createElement(D.a,{event:A})},rowExpandable:function(c){var A=c.event,P=c.date_break,E=c.new_events;return P||E?-1:!!A}}:void 0}),s.a.createElement(U.a,{type:"primary",onClick:dt,loading:ke,style:{display:at||ke?"block":"none",margin:"2rem auto 1rem"}},"Load more events")))}try{k.displayName="EventsTable",k.__docgenInfo={description:"",displayName:"EventsTable",props:{pageKey:{defaultValue:null,description:"",name:"pageKey",required:!0,type:{name:"string"}},fixedFilters:{defaultValue:null,description:"",name:"fixedFilters",required:!1,type:{name:"FixedFilters"}},fixedColumns:{defaultValue:null,description:"",name:"fixedColumns",required:!1,type:{name:"LemonTableColumn<EventsTableRowItem, keyof EventsTableRowItem>[]"}},sceneUrl:{defaultValue:null,description:"",name:"sceneUrl",required:!1,type:{name:"string"}},fetchMonths:{defaultValue:{value:"12"},description:"",name:"fetchMonths",required:!1,type:{name:"number"}},startingColumns:{defaultValue:null,description:"",name:"startingColumns",required:!1,type:{name:"ColumnChoice"}},showCustomizeColumns:{defaultValue:{value:"true"},description:"",name:"showCustomizeColumns",required:!1,type:{name:"boolean"}},showExport:{defaultValue:{value:"true"},description:"",name:"showExport",required:!1,type:{name:"boolean"}},showAutoload:{defaultValue:{value:"true"},description:"",name:"showAutoload",required:!1,type:{name:"boolean"}},showEventFilter:{defaultValue:{value:"true"},description:"",name:"showEventFilter",required:!1,type:{name:"boolean"}},showPropertyFilter:{defaultValue:{value:"true"},description:"",name:"showPropertyFilter",required:!1,type:{name:"boolean"}},showRowExpanders:{defaultValue:{value:"true"},description:"",name:"showRowExpanders",required:!1,type:{name:"boolean"}},showActionsButton:{defaultValue:{value:"true"},description:"",name:"showActionsButton",required:!1,type:{name:"boolean"}},showPersonColumn:{defaultValue:{value:"true"},description:"",name:"showPersonColumn",required:!1,type:{name:"boolean"}},linkPropertiesToFilters:{defaultValue:{value:"true"},description:"",name:"linkPropertiesToFilters",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventsTable.tsx#EventsTable"]={docgenInfo:k.__docgenInfo,name:"EventsTable",path:"frontend/src/scenes/events/EventsTable.tsx#EventsTable"})}catch(l){}},"./frontend/src/scenes/events/eventsTableLogic.ts":function(pe,B,e){"use strict";e.d(B,"a",function(){return Me});var H=e("./node_modules/core-js/modules/es.object.keys.js"),F=e.n(H),ee=e("./node_modules/core-js/modules/es.symbol.js"),te=e.n(ee),le=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),ie=e.n(le),Z=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),z=e.n(Z),ne=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),G=e.n(ne),Q=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),s=e.n(Q),C=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),D=e.n(C),re=e("./node_modules/@babel/runtime/regenerator/index.js"),U=e.n(re),ce=e("./node_modules/core-js/modules/es.array.map.js"),Te=e.n(ce),je=e("./node_modules/core-js/modules/es.object.to-string.js"),Ce=e.n(je),fe=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),se=e.n(fe),ue=e("./node_modules/core-js/modules/es.array.splice.js"),Y=e.n(ue),W=e("./node_modules/core-js/modules/es.array.join.js"),he=e.n(W),w=e("./node_modules/core-js/modules/es.array.filter.js"),V=e.n(w),T=e("./node_modules/core-js/modules/es.array.concat.js"),de=e.n(T),J=e("./node_modules/core-js/modules/es.array.iterator.js"),_=e.n(J),a=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),O=e.n(a),y=e("./node_modules/kea/lib/index.esm.js"),S=e("./frontend/src/lib/utils.tsx"),K=e("./node_modules/kea-router/lib/index.js"),ve=e.n(K),$=e("./frontend/src/lib/api.ts"),me=e("./frontend/src/scenes/teamLogic.tsx"),X=e("./frontend/src/lib/dayjs.ts"),oe=e("./frontend/src/lib/components/lemonToast.tsx");function R(f,t){var n=Object.keys(f);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(f);t&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(f,u).enumerable})),n.push.apply(n,r)}return n}function x(f){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?R(Object(n),!0).forEach(function(r){s()(f,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach(function(r){Object.defineProperty(f,r,Object.getOwnPropertyDescriptor(n,r))})}return f}var Ae=5,Oe=365,xe=5e3,Be=function(t,n){var r=[];return r=t.map(function(u){return{event:u}}),r.forEach(function(u,o){var m=r[o-1];o>0&&u.event&&m.event&&!Object(X.a)(u.event.timestamp).isSame(m.event.timestamp,"day")&&r.splice(o,0,{date_break:Object(X.a)(u.event.timestamp).format("LL")})}),n.length>0&&r.splice(0,0,{new_events:!0}),r},ge=function(t){return Object(X.b)().subtract(t,"day").toISOString()},Me=Object(y.kea)({path:function(t){return["scenes","events","eventsTableLogic",t]},props:{},key:function(t){return[t.fixedFilters?JSON.stringify(t.fixedFilters):"all",t.key,t.sceneUrl].filter(function(n){return!!n}).join("-")},connect:{values:[me.a,["currentTeamId"]]},actions:{setPollingActive:function(t){return{pollingActive:t}},setProperties:function(t){return Array.isArray(t)?t.length===0?{properties:[{}]}:{properties:t}:{properties:[t]}},fetchEvents:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return{nextParams:t}},fetchEventsSuccess:function(t){return t},fetchNextEvents:!0,fetchOrPollFailure:function(t){return{error:t}},pollEvents:!0,pollEventsSuccess:function(t){return{events:t}},prependEvents:function(t){return{events:t}},prependNewEvents:!0,setSelectedEvent:function(t){return{selectedEvent:t}},setPollTimeout:function(t){return{pollTimeout:t}},setEventFilter:function(t){return{event:t}},toggleAutomaticLoad:function(t){return{automaticLoadEnabled:t}},noop:function(t){return t},startDownload:!0},reducers:function(t){var n,r,u=t.props;return{pollingIsActive:[!0,{setPollingActive:function(m,i){var d=i.pollingActive;return d},pollEventsSuccess:function(m,i){var d=i.events;return d&&d.length?!1:m},prependNewEvents:function(){return!0},toggleAutomaticLoad:function(){return!0}}],properties:[[],{setProperties:function(m,i){var d=i.properties;return Object(S.s)(d)}}],eventFilter:[(n=(r=u.fixedFilters)===null||r===void 0?void 0:r.event_filter)!==null&&n!==void 0?n:"",{setEventFilter:function(m,i){var d=i.event;return d}}],isLoading:[!0,{fetchEvents:function(){return!0},fetchEventsSuccess:function(){return!1},fetchOrPollFailure:function(){return!1}}],isLoadingNext:[!1,{fetchNextEvents:function(){return!0},fetchEventsSuccess:function(){return!1}}],events:[[],{fetchEventsSuccess:function(m,i){var d=i.events,M=i.isNext;return M?[].concat(D()(m),D()(d)):d},prependEvents:function(m,i){var d=i.events;return[].concat(D()(d),D()(m))}}],hasNext:[!1,{fetchEvents:function(){return!1},fetchNextEvents:function(){return!1},fetchEventsSuccess:function(m,i){var d=i.hasNext;return d}}],orderBy:["-timestamp",{}],selectedEvent:[null,{setSelectedEvent:function(m,i){var d=i.selectedEvent;return d}}],newEvents:[[],{setProperties:function(){return[]},pollEventsSuccess:function(m,i){var d=i.events;return d||[]},prependEvents:function(){return[]}}],highlightEvents:[{},{prependEvents:function(m,i){var d=i.events;return d.reduce(function(M,I){return M[I.id]=!0,M},{})}}],pollTimeout:[0,{setPollTimeout:function(m,i){return i.pollTimeout}}],automaticLoadEnabled:[!1,{persist:!0},{toggleAutomaticLoad:function(m,i){var d=i.automaticLoadEnabled;return d}}]}},selectors:function(t){var n=t.selectors,r=t.props;return{eventsFormatted:[function(){return[n.events,n.newEvents]},function(u,o){return Be(u,o)}],exportUrl:[function(){return[n.currentTeamId,n.eventFilter,n.orderBy,n.properties,n.minimumQueryDate]},function(u,o,m,i,d){var M;return"/api/projects/".concat(u,"/events.csv?").concat(Object(S.Ab)(x(x(x({},r.fixedFilters||{}),{},{properties:[].concat(D()(i),D()(((M=r.fixedFilters)===null||M===void 0?void 0:M.properties)||[]))},o?{event:o}:{}),{},{orderBy:[m],after:d})))}],months:[function(){return[function(u,o){return o.fetchMonths}]},function(u){return u||12}],minimumQueryDate:[function(){return[n.months]},function(u){return Object(X.b)().subtract(u,"months").toISOString()}],pollAfter:[function(){return[n.events]},function(u){return(u==null?void 0:u.length)>0&&u[0].timestamp?u[0].timestamp:ge(0)}]}},actionToUrl:function(t){var n=t.values;return{setProperties:function(){return[K.router.values.location.pathname,x(x({},K.router.values.searchParams),{},{properties:n.properties.length===0?void 0:n.properties}),K.router.values.hashParams,{replace:!0}]},setEventFilter:function(){return[K.router.values.location.pathname,x(x({},K.router.values.searchParams),{},{eventFilter:n.eventFilter}),K.router.values.hashParams,{replace:!0}]}}},urlToAction:function(t){var n=t.actions,r=t.values,u=t.props;return s()({},u.sceneUrl,function(o,m){n.setProperties(m.properties||r.properties||{}),m.eventFilter&&n.setEventFilter(m.eventFilter)})},events:function(t){var n=t.values;return{beforeUnmount:function(){return clearTimeout(n.pollTimeout||void 0)}}},listeners:function(t){var n=t.actions,r=t.values,u=t.props;return{startDownload:function(){oe.d.success("The export is starting. It should finish soon"),window.location.href=r.exportUrl},setProperties:function(){return n.fetchEvents()},setEventFilter:function(){return n.fetchEvents()},fetchNextEvents:function(){var o=G()(U.a.mark(function i(){var d;return U.a.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:d=r.events,d.length===0?n.fetchEvents():n.fetchEvents({before:d[d.length-1].timestamp});case 2:case"end":return I.stop()}},i)}));function m(){return o.apply(this,arguments)}return m}(),fetchEvents:function(){var o=G()(U.a.mark(function i(d,M){var I,ae,k,l,p,v,g,j;return U.a.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(p=function(){return p=G()(U.a.mark(function Ee(be){var N;return U.a.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:return N=x(x(x(x({after:be},u.fixedFilters||{}),{},{properties:k},ae||{}),r.eventFilter?{event:r.eventFilter}:{}),{},{orderBy:[r.orderBy]}),_e.abrupt("return",$.b.get("api/projects/".concat(r.currentTeamId,"/events/?").concat(Object(S.Ab)(N))));case 2:case"end":return _e.stop()}},Ee)})),p.apply(this,arguments)},l=function(Ee){return p.apply(this,arguments)},ae=d.nextParams,clearTimeout(r.pollTimeout),!(r.events.length>0)){h.next=9;break}return h.next=7,M(300);case 7:h.next=11;break;case 9:return h.next=11,M(1);case 11:return k=[].concat(D()(r.properties),D()(((I=u.fixedFilters)===null||I===void 0?void 0:I.properties)||[])),v=null,g=!1,h.prev=14,h.next=17,l(ge(Ae));case 17:if(v=h.sent,v.results.length!==0){h.next=23;break}return h.next=21,l(ge(Oe));case 21:v=h.sent,g=!0;case 23:h.next=29;break;case 25:return h.prev=25,h.t0=h.catch(14),n.fetchOrPollFailure(h.t0),h.abrupt("return");case 29:M(),n.fetchEventsSuccess({events:v.results,hasNext:!!v.next||!g,isNext:!!ae}),j=window.setTimeout(n.pollEvents,xe),n.setPollTimeout(j);case 33:case"end":return h.stop()}},i,null,[[14,25]])}));function m(i,d){return o.apply(this,arguments)}return m}(),pollEvents:function(){var o=G()(U.a.mark(function i(d,M){var I,ae,k,l,p,v;return U.a.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(ae=function(){var h=window.setTimeout(n.pollEvents,xe);n.setPollTimeout(h)},r.orderBy==="-timestamp"){j.next=3;break}return j.abrupt("return");case 3:if(u.sceneUrl===K.router.values.location.pathname){j.next=5;break}return j.abrupt("return");case 5:if(r.pollingIsActive){j.next=8;break}return ae(),j.abrupt("return");case 8:return k=[].concat(D()(r.properties),D()(((I=u.fixedFilters)===null||I===void 0?void 0:I.properties)||[])),l=x(x(x({},u.fixedFilters||{}),{},{properties:k},r.eventFilter?{event:r.eventFilter}:{}),{},{orderBy:[r.orderBy],after:r.pollAfter}),p=Object(S.Ab)(l),v=null,j.prev=12,j.next=15,$.b.get("api/projects/".concat(r.currentTeamId,"/events/?").concat(p));case 15:v=j.sent,j.next=21;break;case 18:return j.prev=18,j.t0=j.catch(12),j.abrupt("return");case 21:M(),r.automaticLoadEnabled?n.prependEvents(v.results):n.pollEventsSuccess(v.results),ae();case 24:case"end":return j.stop()}},i,null,[[12,18]])}));function m(i,d){return o.apply(this,arguments)}return m}(),prependNewEvents:function(){r.newEvents.length&&n.prependEvents(r.newEvents)},fetchOrPollFailure:function(m){var i=m.error;oe.d.error("There was a problem fetching your events: ".concat(i.statusText))},toggleAutomaticLoad:function(m){var i=m.automaticLoadEnabled;i&&n.prependNewEvents()}}}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/events/EventsTable.scss":function(pe,B,e){var H=e("./node_modules/css-loader/dist/runtime/api.js");B=H(!1),B.push([pe.i,".events .events-table-button-clear{padding:0 4px;margin-left:4px}.events .events-table-button-clear.visible,.events .events-table-button-clear:focus,.events .events-table-button-clear:hover{border:1px solid var(--primary)}.events .event-row-new{height:2.5rem}.events .event-row-date-separator{background-color:var(--bg-mid);color:var(--text-muted);font-weight:600;font-size:.75rem;height:2rem;text-align:center}.events .event-row-is-exception{background-color:var(--depr-lighten-danger-40)}.events td{max-width:20rem}",""]),pe.exports=B}}]);
