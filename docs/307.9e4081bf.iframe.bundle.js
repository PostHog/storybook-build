(window.webpackJsonp=window.webpackJsonp||[]).push([[307],{"./frontend/src/scenes/instance/AsyncMigrations/AsyncMigrations.tsx":function(We,w,i){"use strict";i.r(w),i.d(w,"scene",function(){return Oe}),i.d(w,"AsyncMigrations",function(){return te});var Ue=i("./node_modules/core-js/modules/es.function.name.js"),Ye=i("./node_modules/core-js/modules/es.symbol.js"),He=i("./node_modules/core-js/modules/es.symbol.description.js"),Ge=i("./node_modules/core-js/modules/es.array.includes.js"),ze=i("./node_modules/core-js/modules/es.string.includes.js"),Je=i("./node_modules/core-js/modules/es.array.map.js"),F=i("./node_modules/react/index.js"),t=i.n(F),U=i("./frontend/src/lib/components/PageHeader.tsx"),Y=i("./node_modules/antd/es/tabs/index.js"),oe=i("./node_modules/antd/es/progress/index.js"),H=i("./node_modules/antd/es/button/index.js"),se=i("./node_modules/antd/es/space/index.js"),p=i("./node_modules/kea/lib/index.esm.js"),le=i("./node_modules/@ant-design/icons/es/icons/PlayCircleOutlined.js"),Qe=i("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Xe=i("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Ze=i("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),ce=i("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),b=i.n(ce),ue=i("./node_modules/@babel/runtime/helpers/defineProperty.js"),R=i.n(ue),de=i("./node_modules/@babel/runtime/regenerator/index.js"),m=i.n(de),qe=i("./node_modules/core-js/modules/es.array.iterator.js"),_e=i("./node_modules/core-js/modules/es.object.to-string.js"),en=i("./node_modules/core-js/modules/web.dom-collections.iterator.js"),nn=i("./node_modules/core-js/modules/es.array.filter.js"),tn=i("./node_modules/core-js/modules/es.object.keys.js"),rn=i("./node_modules/core-js/modules/es.array.concat.js"),T=i("./frontend/src/lib/api.ts"),N=i("./frontend/src/scenes/userLogic.ts"),ge=i("./frontend/src/scenes/instance/SystemStatus/systemStatusLogic.ts"),P=i("./frontend/src/lib/components/lemonToast.tsx"),me=i("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),fe=i("./node_modules/kea-loaders/lib/index.js"),G=i("./node_modules/kea-router/lib/index.js");function z(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);e&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),r.push.apply(r,a)}return r}function h(n){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?z(Object(r),!0).forEach(function(a){R()(n,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(r,a))})}return n}var M;(function(n){n[n.NotStarted=0]="NotStarted",n[n.Running=1]="Running",n[n.CompletedSuccessfully=2]="CompletedSuccessfully",n[n.Errored=3]="Errored",n[n.RolledBack=4]="RolledBack",n[n.Starting=5]="Starting",n[n.FailedAtStartup=6]="FailedAtStartup"})(M||(M={}));var E;(function(n){n.Management="management",n.FutureMigrations="future",n.Settings="settings"})(E||(E={}));var pe={0:"Not started",1:"Running",2:"Complete",3:"Error",4:"Rolled back",5:"Starting",6:"Failed at startup"},j=Object(p.kea)([Object(p.path)(["scenes","instance","AsyncMigrations","asyncMigrationsLogic"]),Object(p.connect)({values:[me.a,["preflight"]]}),Object(p.actions)({triggerMigration:function(e){return{migration:e}},resumeMigration:function(e){return{migration:e}},rollbackMigration:function(e){return{migration:e}},forceStopMigration:function(e){return{migration:e}},forceStopMigrationWithoutRollback:function(e){return{migration:e}},updateMigrationStatus:function(e,r,a){return{migration:e,endpoint:r,message:a}},setActiveTab:function(e){return{tab:e}},updateSetting:function(e,r){return{settingKey:e,newValue:r}},loadAsyncMigrationErrors:function(e){return{migrationId:e}},loadAsyncMigrationErrorsSuccess:function(e,r){return{migrationId:e,errors:r}},loadAsyncMigrationErrorsFailure:function(e,r){return{migrationId:e,error:r}},openAsyncMigrationsModal:function(e,r,a){return{migration:e,endpoint:r,message:a}},closeAsyncMigrationsModal:!0}),Object(p.reducers)({activeTab:[E.Management,{setActiveTab:function(e,r){var a=r.tab;return a}}],asyncMigrationErrors:[{},{loadAsyncMigrationErrorsSuccess:function(e,r){var a=r.migrationId,s=r.errors;return h(h({},e),{},R()({},a,s))}}],asyncMigrationErrorsLoading:[{},{loadAsyncMigrationErrors:function(e,r){var a=r.migrationId;return h(h({},e),{},R()({},a,!0))},loadAsyncMigrationErrorsSuccess:function(e,r){var a=r.migrationId;return h(h({},e),{},R()({},a,!1))},loadAsyncMigrationErrorsFailure:function(e,r){var a=r.migrationId;return h(h({},e),{},R()({},a,!1))}}],activeAsyncMigrationModal:[null,{openAsyncMigrationsModal:function(e,r){return r},closeAsyncMigrationsModal:function(){return null},updateMigrationStatus:function(){return null}}]}),Object(fe.loaders)(function(){return{asyncMigrations:[[],{loadAsyncMigrations:function(){var n=b()(m.a.mark(function r(){var a;return m.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if((a=N.a.values.user)!==null&&a!==void 0&&a.is_staff){l.next=2;break}return l.abrupt("return",[]);case 2:return l.next=4,T.b.get("api/async_migrations");case 4:return l.abrupt("return",l.sent.results);case 5:case"end":return l.stop()}},r)}));function e(){return n.apply(this,arguments)}return e}()}],asyncMigrationSettings:[[],{loadAsyncMigrationSettings:function(){var n=b()(m.a.mark(function r(){var a,s;return m.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if((a=N.a.values.user)!==null&&a!==void 0&&a.is_staff){o.next=2;break}return o.abrupt("return",[]);case 2:return o.next=4,T.b.get("api/instance_settings");case 4:return s=o.sent.results,o.abrupt("return",s.filter(function(u){return u.key.includes("ASYNC_MIGRATIONS")}));case 6:case"end":return o.stop()}},r)}));function e(){return n.apply(this,arguments)}return e}()}]}}),Object(p.selectors)({isAnyMigrationRunning:[function(n){return[n.asyncMigrations]},function(n){return n.some(function(e){return[M.Running,M.Starting].includes(e.status)})}],actionableMigrations:[function(n){return[n.asyncMigrations]},function(n){return n.filter(function(e){return e.is_available})}],futureMigrations:[function(n){return[n.asyncMigrations]},function(n){return n.filter(function(e){return!e.is_available})}]}),Object(p.listeners)(function(n){var e=n.actions;return{triggerMigration:function(){var r=b()(m.a.mark(function s(l){var o;return m.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:o=l.migration,Object.keys(o.parameter_definitions).length>0?e.openAsyncMigrationsModal(o,"trigger","Migration triggered successfully"):e.updateMigrationStatus(o,"trigger","Migration triggered successfully");case 2:case"end":return d.stop()}},s)}));function a(s){return r.apply(this,arguments)}return a}(),resumeMigration:function(){var r=b()(m.a.mark(function s(l){var o;return m.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:o=l.migration,Object.keys(o.parameter_definitions).length>0?e.openAsyncMigrationsModal(o,"resume","Migration resume triggered successfully"):e.updateMigrationStatus(o,"resume","Migration resume triggered successfully");case 2:case"end":return d.stop()}},s)}));function a(s){return r.apply(this,arguments)}return a}(),rollbackMigration:function(){var r=b()(m.a.mark(function s(l){var o;return m.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:o=l.migration,e.updateMigrationStatus(o,"rollback","Migration rollback triggered successfully");case 2:case"end":return d.stop()}},s)}));function a(s){return r.apply(this,arguments)}return a}(),forceStopMigration:function(){var r=b()(m.a.mark(function s(l){var o;return m.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:o=l.migration,e.updateMigrationStatus(o,"force_stop","Force stop triggered successfully");case 2:case"end":return d.stop()}},s)}));function a(s){return r.apply(this,arguments)}return a}(),forceStopMigrationWithoutRollback:function(){var r=b()(m.a.mark(function s(l){var o;return m.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:o=l.migration,e.updateMigrationStatus(o,"force_stop_without_rollback","Force stop without rollback triggered successfully");case 2:case"end":return d.stop()}},s)}));function a(s){return r.apply(this,arguments)}return a}(),updateMigrationStatus:function(){var r=b()(m.a.mark(function s(l){var o,u,d,c;return m.a.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return o=l.migration,u=l.endpoint,d=l.message,O.next=3,T.b.create("/api/async_migrations/".concat(o.id,"/").concat(u),{parameters:o.parameters});case 3:c=O.sent,c.success?(P.d.success(d),e.loadAsyncMigrations()):P.d.error(c.error);case 5:case"end":return O.stop()}},s)}));function a(s){return r.apply(this,arguments)}return a}(),updateSetting:function(){var r=b()(m.a.mark(function s(l){var o,u;return m.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=l.settingKey,u=l.newValue,c.prev=1,c.next=4,T.b.update("/api/instance_settings/".concat(o),{value:u});case 4:P.d.success("Instance setting ".concat(o," updated")),e.loadAsyncMigrationSettings(),e.loadAsyncMigrations(),ge.b.actions.loadSystemStatus(),c.next=13;break;case 10:c.prev=10,c.t0=c.catch(1),P.d.error("Failed to trigger migration");case 13:case"end":return c.stop()}},s,null,[[1,10]])}));function a(s){return r.apply(this,arguments)}return a}(),loadAsyncMigrationErrors:function(){var r=b()(m.a.mark(function s(l){var o,u;return m.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=l.migrationId,c.prev=1,c.next=4,T.b.get("api/async_migrations/".concat(o,"/errors"));case 4:u=c.sent,e.loadAsyncMigrationErrorsSuccess(o,u),c.next=11;break;case 8:c.prev=8,c.t0=c.catch(1),e.loadAsyncMigrationErrorsFailure(o,c.t0);case 11:case"end":return c.stop()}},s,null,[[1,8]])}));function a(s){return r.apply(this,arguments)}return a}()}}),Object(p.events)(function(n){var e=n.actions;return{afterMount:function(){e.loadAsyncMigrations(),e.loadAsyncMigrationSettings()}}}),Object(G.actionToUrl)(function(n){var e=n.values;return{setActiveTab:function(){return"/instance/async_migrations".concat(e.activeTab===E.Management?"":"/"+e.activeTab)}}}),Object(G.urlToAction)(function(n){var e=n.actions,r=n.values;return{"/instance/async_migrations(/:tab)":function(s){var l=s.tab;l&&l!==r.activeTab&&l!==E.Management&&e.setActiveTab(l)}}})]),J=i("./frontend/src/lib/components/Tooltip.tsx"),Q=i("./frontend/src/lib/components/Spinner/Spinner.tsx"),ye=i("./node_modules/@babel/runtime/helpers/slicedToArray.js"),X=i.n(ye),ve=i("./node_modules/antd/es/row/index.js"),Z=i("./node_modules/antd/es/col/index.js"),Me=i("./node_modules/antd/es/input/index.js"),Ee=i("./node_modules/antd/es/divider/index.js");function L(n){var e=n.setting,r=Object(p.useActions)(j),a=r.updateSetting,s=Object(F.useState)(String(e.value)),l=X()(s,2),o=l[0],u=l[1];return t.a.createElement("div",{key:e.key},t.a.createElement("h4",null,e.key),t.a.createElement("p",null,e.description),t.a.createElement(ve.a,{gutter:[8,8]},t.a.createElement(Z.a,{span:8},t.a.createElement(Me.a,{value:o,onChange:function(c){return u(c.target.value)}})),t.a.createElement(Z.a,{span:16},t.a.createElement(H.a,{disabled:String(e.value)===o,type:"primary",onClick:function(){return a(e.key,o)}},"Update"))),t.a.createElement(Ee.a,null))}try{L.displayName="SettingUpdateField",L.__docgenInfo={description:"",displayName:"SettingUpdateField",props:{setting:{defaultValue:null,description:"",name:"setting",required:!0,type:{name:"InstanceSetting"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/instance/AsyncMigrations/SettingUpdateField.tsx#SettingUpdateField"]={docgenInfo:L.__docgenInfo,name:"SettingUpdateField",path:"frontend/src/scenes/instance/AsyncMigrations/SettingUpdateField.tsx#SettingUpdateField"})}catch(n){}var q=i("./frontend/src/lib/components/LemonTable/index.ts"),V=i("./frontend/src/lib/utils.tsx"),A=i("./frontend/src/lib/components/LemonButton/index.ts"),D=i("./frontend/src/lib/components/icons.tsx");function I(n){var e=n.asyncMigration,r=Object(p.useValues)(j),a=r.asyncMigrationErrorsLoading,s=r.asyncMigrationErrors,l=Object(p.useActions)(j),o=l.loadAsyncMigrationErrors,u=[{title:"Error",dataIndex:"description"},{title:t.a.createElement(A.a,{icon:a[e.id]?t.a.createElement(Q.a,null):t.a.createElement(D.IconRefresh,null),onClick:function(){return o(e.id)},type:"secondary",size:"small"},"Refresh errors"),render:function(c,S){return t.a.createElement("div",null,Object(V.O)(S.created_at))}}];return t.a.createElement(q.a,{columns:u,dataSource:s[e.id],loading:a[e.id],embedded:!0})}try{I.displayName="AsyncMigrationDetails",I.__docgenInfo={description:"",displayName:"AsyncMigrationDetails",props:{asyncMigration:{defaultValue:null,description:"",name:"asyncMigration",required:!0,type:{name:"AsyncMigration"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/instance/AsyncMigrations/AsyncMigrationDetails.tsx#AsyncMigrationDetails"]={docgenInfo:I.__docgenInfo,name:"AsyncMigrationDetails",path:"frontend/src/scenes/instance/AsyncMigrations/AsyncMigrationDetails.tsx#AsyncMigrationDetails"})}catch(n){}var _=i("./frontend/src/lib/components/LemonButton/More.tsx"),be=i("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),$=i("./node_modules/kea-forms/lib/index.js");function ee(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);e&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),r.push.apply(r,a)}return r}function ne(n){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ee(Object(r),!0).forEach(function(a){R()(n,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(r,a))})}return n}var Se=Object(p.kea)([Object(p.path)(["scenes","instance","AsyncMigrations","asyncMigrationParameterFormLogic"]),Object(p.props)({}),Object(p.key)(function(n){return n.migration.id}),Object($.forms)(function(n){var e=n.props;return{parameters:{defaults:Ae(e),submit:function(){var r=b()(m.a.mark(function s(l){return m.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:j.actions.updateMigrationStatus(ne(ne({},e.migration),{},{parameters:l}),e.endpoint,e.message);case 1:case"end":return u.stop()}},s)}));function a(s){return r.apply(this,arguments)}return a}()}}})]);function Ae(n){var e={};return Object.keys(n.migration.parameter_definitions).forEach(function(r){n.migration.parameters[r]?e[r]=n.migration.parameters[r]:e[r]=n.migration.parameter_definitions[r][0]}),e}var he=i("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),je=i("./frontend/src/lib/components/AnimatedCollapsible.tsx"),k=i("./frontend/src/lib/components/LemonModal/index.ts");function x(n){var e=Object(p.useActions)(j),r=e.closeAsyncMigrationsModal,a=Object(F.useState)(!0),s=X()(a,2),l=s[0],o=s[1];return t.a.createElement(k.a,{title:"",onClose:r,isOpen:!0,simple:!0},t.a.createElement($.Form,{logic:Se,props:n,formKey:"parameters",enableFormOnSubmit:!0,id:"async-migration-parameters-form",className:"LemonModal__layout"},t.a.createElement(k.a.Header,null,t.a.createElement("h3",null,"Advanced migration configuration")),t.a.createElement(k.a.Content,null,t.a.createElement("p",null,"This async migration allows tuning parameters used in the async migration.",l&&t.a.createElement(t.a.Fragment,null,t.a.createElement("br",null),t.a.createElement("a",{onClick:function(){o(!l)}},"Click here to show advanced configuration."))),t.a.createElement(je.a,{collapsed:l},Object.keys(n.migration.parameter_definitions).map(function(u){return t.a.createElement($.Field,{name:u,key:u,label:t.a.createElement(t.a.Fragment,null,n.migration.parameter_definitions[u][1])},t.a.createElement(he.a,{type:"number"}))}))),t.a.createElement(k.a.Footer,null,t.a.createElement(A.a,{form:"async-migration-parameters-form",type:"secondary","data-attr":"async-migration-parameters-cancel",className:"mr-2",onClick:r},"Cancel"),t.a.createElement(A.a,{form:"async-migration-parameters-form",htmlType:"submit",type:"primary","data-attr":"async-migration-parameters-submit"},"Run migration"))))}try{x.displayName="AsyncMigrationParametersModal",x.__docgenInfo={description:"",displayName:"AsyncMigrationParametersModal",props:{migration:{defaultValue:null,description:"",name:"migration",required:!0,type:{name:"AsyncMigration"}},endpoint:{defaultValue:null,description:"",name:"endpoint",required:!0,type:{name:"string"}},message:{defaultValue:null,description:"",name:"message",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/instance/AsyncMigrations/AsyncMigrationParametersModal.tsx#AsyncMigrationParametersModal"]={docgenInfo:x.__docgenInfo,name:"AsyncMigrationParametersModal",path:"frontend/src/scenes/instance/AsyncMigrations/AsyncMigrationParametersModal.tsx#AsyncMigrationParametersModal"})}catch(n){}var B=Y.a.TabPane,Oe={component:te,logic:j},Ce=3e3;function te(){var n=Object(p.useValues)(N.a),e=n.user,r=Object(p.useValues)(j),a=r.asyncMigrationsLoading,s=r.activeTab,l=r.asyncMigrationSettings,o=r.isAnyMigrationRunning,u=r.activeAsyncMigrationModal,d=r.actionableMigrations,c=r.futureMigrations,S=Object(p.useActions)(j),O=S.triggerMigration,Re=S.resumeMigration,Te=S.rollbackMigration,Fe=S.forceStopMigration,Pe=S.forceStopMigrationWithoutRollback,re=S.loadAsyncMigrations,Le=S.loadAsyncMigrationErrors,Ie=S.setActiveTab;Object(F.useEffect)(function(){if(o){var y=setInterval(function(){return re()},Ce);return function(){return clearInterval(y)}}},[o]);var ae={title:"Migration",render:function(v,g){var f="https://github.com/PostHog/posthog/blob/master/posthog/async_migrations/migrations/"+g.name+".py";return t.a.createElement(t.a.Fragment,null,t.a.createElement("div",{className:"row-name"},t.a.createElement("a",{href:f},g.name)),t.a.createElement("div",{className:"row-description"},g.description))}},ke={title:"Progress",render:function(v,g){var f=g.progress;return t.a.createElement("div",null,t.a.createElement(oe.a,{percent:f}))}},ie={title:"Status",render:function(v,g){var f=g.status,C=f===M.Running?"success":f===M.Errored||f===M.FailedAtStartup?"danger":f===M.Starting||f===M.RolledBack?"warning":"default";return t.a.createElement(be.a,{type:C},pe[f])}},xe={title:"Last operation index",render:function(v,g){return t.a.createElement("div",null,g.current_operation_index)}},we={title:"Last query ID",render:function(v,g){return t.a.createElement("div",null,t.a.createElement("small",null,g.current_query_id))}},Ne={title:"Started at",render:function(v,g){var f=g.started_at;return t.a.createElement("div",null,Object(V.O)(f))}},Ve={title:"Finished at",render:function(v,g){var f=g.finished_at;return t.a.createElement("div",null,Object(V.O)(f))}},De={title:"",render:function(v,g){var f=g.status;return t.a.createElement("div",null,f===M.NotStarted||f===M.FailedAtStartup?t.a.createElement(J.a,{title:"Start"},t.a.createElement(H.a,{type:"link",icon:t.a.createElement(le.a,null),onClick:function(){return O(g)}},"Run")):f===M.Starting||f===M.Running?t.a.createElement(_.a,{overlay:t.a.createElement(t.a.Fragment,null,t.a.createElement(A.a,{status:"stealth",onClick:function(){return Fe(g)},fullWidth:!0},"Stop and rollback"),t.a.createElement(A.a,{status:"stealth",onClick:function(){return Pe(g)},fullWidth:!0},"Stop"))}):f===M.CompletedSuccessfully?t.a.createElement(t.a.Fragment,null):f===M.Errored?t.a.createElement(_.a,{overlay:t.a.createElement(t.a.Fragment,null,t.a.createElement(A.a,{status:"stealth",onClick:function(){return Re(g)},fullWidth:!0},"Resume"),t.a.createElement(A.a,{status:"stealth",onClick:function(){return Te(g)},fullWidth:!0},"Rollback"))}):f===M.RolledBack?t.a.createElement(J.a,{title:"Restart"},t.a.createElement(A.a,{status:"stealth",icon:t.a.createElement(D.IconReplay,null),onClick:function(){return O(g)},fullWidth:!0})):null)}},$e={title:"Minimum PostHog version",render:function(v,g){return t.a.createElement("div",null,g.posthog_min_version)}},Be={title:"Maximum PostHog version",render:function(v,g){return t.a.createElement("div",null,g.posthog_max_version)}},K={};K[E.FutureMigrations]=[ae,ie,$e,Be],K[E.Management]=[ae,ke,ie,xe,we,Ne,Ve,De];var W={};W[E.FutureMigrations]=c,W[E.Management]=d;var Ke={expandedRowRender:function(v){return v&&t.a.createElement(I,{asyncMigration:v})},rowExpandable:function(v){return v.error_count>0},onRowExpand:function(v){Le(v.id)}};return t.a.createElement("div",null,e!=null&&e.is_staff?t.a.createElement(t.a.Fragment,null,t.a.createElement(U.a,{title:"Async Migrations",caption:t.a.createElement(t.a.Fragment,null,t.a.createElement("p",null,"Manage async migrations in your instance."),t.a.createElement("p",null,"Read about async migrations on our"," ",t.a.createElement("a",{href:"https://posthog.com/docs/self-host/configure/async-migrations/overview"},"dedicated docs page"),"."))}),t.a.createElement(Y.a,{activeKey:s,onTabClick:function(v){return Ie(v)}},t.a.createElement(B,{tab:"Management (".concat(d.length,")"),key:E.Management}),c.length>0&&t.a.createElement(B,{tab:"Future Migrations (".concat(c.length,")"),key:E.FutureMigrations}),t.a.createElement(B,{tab:"Settings",key:E.Settings})),[E.Management,E.FutureMigrations].includes(s)?t.a.createElement(t.a.Fragment,null,t.a.createElement("div",{className:"mb-4 float-right"},t.a.createElement(A.a,{icon:a?t.a.createElement(Q.a,null):t.a.createElement(D.IconRefresh,null),onClick:re,type:"secondary",size:"small"},"Refresh")),t.a.createElement(se.b,null),t.a.createElement(q.a,{pagination:{pageSize:10},loading:a,columns:K[s],dataSource:W[s],expandable:Ke}),u?t.a.createElement(x,u):null):s===E.Settings?t.a.createElement(t.a.Fragment,null,t.a.createElement("br",null),l.map(function(y){return t.a.createElement("div",{key:y.key},t.a.createElement(L,{setting:y}))})):null):t.a.createElement(U.a,{title:"Async Migrations",caption:t.a.createElement(t.a.Fragment,null,t.a.createElement("p",null,"Only users with staff access can manage async migrations. Please contact your instance admin."),t.a.createElement("p",null,"If you're an admin and don't have access, set ",t.a.createElement("code",null,"is_staff=true")," for your user on the PostgreSQL ",t.a.createElement("code",null,"posthog_user")," table."))}))}}}]);
