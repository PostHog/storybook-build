(window.webpackJsonp=window.webpackJsonp||[]).push([[8,10],{"./frontend/src/scenes/apps/appMetricsSceneLogic.ts":function(B,v,e){"use strict";e.r(v),e.d(v,"AppMetricsTab",function(){return c}),e.d(v,"appMetricsSceneLogic",function(){return J});var j=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),f=e.n(j),m=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),u=e.n(m),P=e("./node_modules/@babel/runtime/regenerator/index.js"),E=e.n(P),K=e("./node_modules/core-js/modules/es.array.iterator.js"),N=e.n(K),W=e("./node_modules/core-js/modules/es.object.to-string.js"),z=e.n(W),h=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Q=e.n(h),F=e("./node_modules/core-js/modules/es.array.concat.js"),V=e.n(F),x=e("./node_modules/core-js/modules/es.function.name.js"),X=e.n(x),H=e("./node_modules/core-js/modules/es.array.includes.js"),Y=e.n(H),$=e("./node_modules/core-js/modules/es.string.includes.js"),Z=e.n($),S=e("./node_modules/core-js/modules/es.array.filter.js"),w=e.n(S),G=e("./node_modules/core-js/modules/es.number.constructor.js"),k=e.n(G),p=e("./node_modules/kea/lib/index.esm.js"),C=e("./node_modules/kea-loaders/lib/index.js"),q=e.n(C),M=e("./frontend/src/scenes/urls.ts"),g=e("./frontend/src/lib/api.ts"),O=e("./frontend/src/scenes/teamLogic.tsx"),T=e("./node_modules/kea-router/lib/index.js"),ee=e.n(T),b=e("./frontend/src/lib/utils.tsx"),c;(function(s){s.ProcessEvent="processEvent",s.OnEvent="onEvent",s.ExportEvents="exportEvents",s.HistoricalExports="historical_exports"})(c||(c={}));var A="-30d",I=[c.ProcessEvent,c.OnEvent,c.ExportEvents],J=Object(p.kea)([Object(p.path)(function(s){return["scenes","apps","appMetricsSceneLogic",s]}),Object(p.props)({}),Object(p.key)(function(s){return s.pluginConfigId}),Object(p.actions)({setActiveTab:function(n){return{tab:n}},setDateFrom:function(n){return{dateFrom:n}},openErrorDetailsDrawer:function(n,r,t){return{errorType:n,category:r,jobId:t}},closeErrorDetailsDrawer:!0}),Object(p.reducers)({activeTab:[null,{setActiveTab:function(n,r){var t=r.tab;return t}}],dateFrom:[A,{setDateFrom:function(n,r){var t=r.dateFrom;return t}}],errorDetailsDrawerError:[null,{openErrorDetailsDrawer:function(n,r){var t=r.errorType;return t},closeErrorDetailsDrawer:function(){return null}}]}),Object(C.loaders)(function(s){var n=s.values,r=s.props;return{pluginConfig:[null,{loadPluginConfig:function(){var t=u()(E.a.mark(function i(){return E.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,g.b.get("api/projects/".concat(O.a.values.currentTeamId,"/plugin_configs/").concat(r.pluginConfigId));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},i)}));function o(){return t.apply(this,arguments)}return o}()}],appMetricsResponse:[null,{loadMetrics:function(){var t=u()(E.a.mark(function i(){var a;return E.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return a=Object(b.Eb)({category:n.activeTab,date_from:n.dateFrom}),_.next=3,g.b.get("api/projects/".concat(O.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"?").concat(a));case 3:return _.abrupt("return",_.sent);case 4:case"end":return _.stop()}},i)}));function o(){return t.apply(this,arguments)}return o}()}],historicalExports:[[],{loadHistoricalExports:function(){var t=u()(E.a.mark(function i(){var a,l;return E.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,g.b.get("api/projects/".concat(O.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"/historical_exports"));case 2:return a=d.sent,l=a.results,d.abrupt("return",l);case 5:case"end":return d.stop()}},i)}));function o(){return t.apply(this,arguments)}return o}()}],errorDetails:[[],{openErrorDetailsDrawer:function(){var t=u()(E.a.mark(function i(a){var l,_,d,y,U,R;return E.a.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return l=a.category,_=a.jobId,d=a.errorType,y=Object(b.Eb)({category:l,job_id:_,error_type:d}),D.next=4,g.b.get("api/projects/".concat(O.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"/error_details?").concat(y));case 4:return U=D.sent,R=U.result,D.abrupt("return",R);case 7:case"end":return D.stop()}},i)}));function o(i){return t.apply(this,arguments)}return o}()}]}}),Object(p.selectors)(function(s){var n=s.values;return{breadcrumbs:[function(r){return[r.pluginConfig,function(t,o){return o.pluginConfigId}]},function(r,t){var o;return[{name:"Apps",path:M.a.projectApps()},{name:r==null||(o=r.plugin_info)===null||o===void 0?void 0:o.name,path:M.a.appMetrics(t)}]}],showTab:[function(){return[]},function(){return function(r){var t;if(n.pluginConfigLoading||!n.pluginConfig)return!1;var o=((t=n.pluginConfig.plugin_info.capabilities)===null||t===void 0?void 0:t.methods)||[];return r===c.HistoricalExports?o.includes("exportEvents"):r===c.OnEvent&&o.includes("exportEvents")?!1:o.includes(r)}}]}}),Object(p.listeners)(function(s){var n=s.values,r=s.actions;return{loadPluginConfigSuccess:function(){if(!n.activeTab){var o=I.filter(function(l){return n.showTab(l)}),i=f()(o,1),a=i[0];r.setActiveTab(a)}},setActiveTab:function(o){var i=o.tab;i===c.HistoricalExports?r.loadHistoricalExports():r.loadMetrics()},setDateFrom:function(){r.loadMetrics()}}}),Object(T.actionToUrl)(function(s){var n=s.values,r=s.props;return{setActiveTab:function(){return L(n,r)},setDateFrom:function(){return L(n,r)}}}),Object(T.urlToAction)(function(s){var n=s.values,r=s.actions,t=s.props;return{"/app/:pluginConfigId/:page":function(i,a){t.pluginConfigId===Number(i.pluginConfigId)&&(n.pluginConfig||r.loadPluginConfig(),i.page===c.HistoricalExports?r.setActiveTab(c.HistoricalExports):(a.tab&&I.includes(a.tab)&&r.setActiveTab(a.tab),a.from&&r.setDateFrom(a.from)))}}})]);function L(s,n){if(s.activeTab===c.HistoricalExports)return M.a.appHistoricalExports(n.pluginConfigId);var r={};return s.activeTab&&(r.tab=s.activeTab),s.dateFrom!==A&&(r.from=s.dateFrom),M.a.appMetrics(n.pluginConfigId,r)}},"./frontend/src/scenes/apps/constants.tsx":function(B,v,e){"use strict";e.r(v),e.d(v,"DescriptionColumns",function(){return P});var j=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),f=e.n(j),m=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),u,P=(u={},f()(u,m.AppMetricsTab.ProcessEvent,{successes:"Events processed",failures:"Failed events"}),f()(u,m.AppMetricsTab.OnEvent,{successes:"Events processed",successes_on_retry:"Events processed on retry",failures:"Failed events"}),f()(u,m.AppMetricsTab.ExportEvents,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),f()(u,m.AppMetricsTab.HistoricalExports,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),u)}}]);
