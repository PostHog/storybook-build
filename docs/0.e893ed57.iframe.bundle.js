(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"./frontend/src/scenes/actions/EventName.tsx":function(pe,I,e){"use strict";e.d(I,"a",function(){return ie}),e.d(I,"b",function(){return Z});var H=e("./node_modules/react/index.js"),N=e.n(H),ee=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),te=e("./frontend/src/lib/components/TaxonomicPopup/TaxonomicPopup.tsx"),le=e("./frontend/src/lib/components/TaxonomicFilter/types.ts");function ie(z){var ne=z.value,G=z.onChange;return N.a.createElement(te.d,{groupType:le.a.Events,onChange:G,value:ne,type:"secondary",style:{maxWidth:"24rem"},placeholder:"Choose an event",dataAttr:"event-name-box",renderValue:function(o){return N.a.createElement(ee.a,{value:o,disablePopover:!0})},allowClear:!0})}function Z(z){var ne=z.value,G=z.onChange;return N.a.createElement(te.b,{groupType:le.a.Events,onChange:G,value:ne,type:"secondary",placeholder:"Select an event",dataAttr:"event-name-box",renderValue:function(o){return N.a.createElement(ee.a,{value:o,disablePopover:!0})},allowClear:!0})}try{ie.displayName="EventName",ie.__docgenInfo={description:"",displayName:"EventName",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/actions/EventName.tsx#EventName"]={docgenInfo:ie.__docgenInfo,name:"EventName",path:"frontend/src/scenes/actions/EventName.tsx#EventName"})}catch(z){}try{Z.displayName="LemonEventName",Z.__docgenInfo={description:"",displayName:"LemonEventName",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/actions/EventName.tsx#LemonEventName"]={docgenInfo:Z.__docgenInfo,name:"LemonEventName",path:"frontend/src/scenes/actions/EventName.tsx#LemonEventName"})}catch(z){}},"./frontend/src/scenes/events/EventDetails.tsx":function(pe,I,e){"use strict";e.d(I,"a",function(){return Y});var H=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),N=e.n(H),ee=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),te=e.n(ee),le=e("./node_modules/core-js/modules/es.object.keys.js"),ie=e("./node_modules/core-js/modules/es.symbol.js"),Z=e("./node_modules/core-js/modules/es.array.filter.js"),z=e("./node_modules/core-js/modules/es.object.to-string.js"),ne=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),G=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Q=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),o=e("./node_modules/react/index.js"),b=e.n(o),C=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),re=e("./frontend/src/lib/components/PropertiesTable.tsx"),U=e("./frontend/src/scenes/events/EventElements.tsx"),ce=e("./node_modules/antd/es/tabs/index.js"),Oe=e("./node_modules/antd/es/button/index.js"),he=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),xe=e.n(he),fe=e("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),se=e("./frontend/src/lib/utils.tsx"),Ee=["event","id","uuid","distinct_id","properties","elements","timestamp","person"];function k(m,a){var E=Object.keys(m);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(m);a&&(p=p.filter(function(D){return Object.getOwnPropertyDescriptor(m,D).enumerable})),E.push.apply(E,p)}return E}function F(m){for(var a=1;a<arguments.length;a++){var E=arguments[a]!=null?arguments[a]:{};a%2?k(Object(E),!0).forEach(function(p){N()(m,p,E[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(E)):k(Object(E)).forEach(function(p){Object.defineProperty(m,p,Object.getOwnPropertyDescriptor(E,p))})}return m}function oe(m){var a=m.event,E=a.event,p=a.id,D=a.uuid,B=a.distinct_id,ue=a.properties,V=a.elements,ve=a.timestamp,X=a.person,me=xe()(a,Ee),S=F(F(F(F({},p?{id:p}:null),D?{uuid:D}:null),{},{timestamp:ve,event:E,distinct_id:B,properties:Object(se.vb)(ue)},V&&V.length>0?{elements:V}:null),me);return b.a.createElement(fe.a,{language:fe.b.JSON},JSON.stringify(S,null,4))}try{oe.displayName="EventJSON",oe.__docgenInfo={description:"",displayName:"EventJSON",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"Record<string, any>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventJSON.tsx#EventJSON"]={docgenInfo:oe.__docgenInfo,name:"EventJSON",path:"frontend/src/scenes/events/EventJSON.tsx#EventJSON"})}catch(m){}var W=e("./frontend/src/lib/dayjs.ts");function w(m,a){var E=Object.keys(m);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(m);a&&(p=p.filter(function(D){return Object.getOwnPropertyDescriptor(m,D).enumerable})),E.push.apply(E,p)}return E}function g(m){for(var a=1;a<arguments.length;a++){var E=arguments[a]!=null?arguments[a]:{};a%2?w(Object(E),!0).forEach(function(p){N()(m,p,E[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(E)):w(Object(E)).forEach(function(p){Object.defineProperty(m,p,Object.getOwnPropertyDescriptor(E,p))})}return m}var de=ce.a.TabPane;function Y(m){for(var a=m.event,E=Object(o.useState)(!1),p=te()(E,2),D=p[0],B=p[1],ue={},V={},ve=0,X=0,me=Object.keys(a.properties);X<me.length;X++){var S=me[X];C.d.event[S]&&C.d.event[S].hide&&(ve+=1,D&&(V[S]=a.properties[S])),(!C.d.event[S]||!C.d.event[S].hide)&&(ue[S]=a.properties[S])}return b.a.createElement(ce.a,{"data-attr":"event-details",defaultActiveKey:"properties",style:{float:"left",width:"100%"},tabBarStyle:{margin:0}},b.a.createElement(de,{tab:"Properties",key:"properties"},b.a.createElement(re.a,{properties:g(g({$timestamp:Object(W.a)(a.timestamp).toISOString()},ue),V),useDetectedPropertyType:!0}),ve>0&&b.a.createElement("small",null,b.a.createElement(Oe.a,{style:{margin:"8px 0 0 8px"},type:"link",onClick:function(){return B(!D)}},D?"Showing ":"",ve," hidden properties. Click to ",D?"hide":"show","."))),b.a.createElement(de,{tab:"JSON",key:"json"},b.a.createElement(oe,{event:a})),a.elements&&a.elements.length>0&&b.a.createElement(de,{tab:"Elements",key:"elements"},b.a.createElement(U.a,{event:a})))}try{Y.displayName="EventDetails",Y.__docgenInfo={description:"",displayName:"EventDetails",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"EventType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventDetails.tsx#EventDetails"]={docgenInfo:Y.__docgenInfo,name:"EventDetails",path:"frontend/src/scenes/events/EventDetails.tsx#EventDetails"})}catch(m){}},"./frontend/src/scenes/events/EventElements.tsx":function(pe,I,e){"use strict";e.d(I,"a",function(){return k});var H=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),N=e.n(H),ee=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),te=e.n(ee),le=e("./node_modules/core-js/modules/es.array.join.js"),ie=e.n(le),Z=e("./node_modules/core-js/modules/es.array.fill.js"),z=e.n(Z),ne=e("./node_modules/core-js/modules/es.array.slice.js"),G=e.n(ne),Q=e("./node_modules/core-js/modules/es.array.map.js"),o=e.n(Q),b=e("./node_modules/core-js/modules/es.object.entries.js"),C=e.n(b),re=e("./node_modules/core-js/modules/es.array.concat.js"),U=e.n(re),ce=e("./node_modules/core-js/modules/es.regexp.exec.js"),Oe=e.n(ce),he=e("./node_modules/core-js/modules/es.string.replace.js"),xe=e.n(he),fe=e("./node_modules/react/index.js"),se=e.n(fe);function Ee(F){return Array(F).fill("    ").join("")}function k(F){var oe=F.event,W=te()(oe.elements||[]).reverse();return W=W.slice(Math.max(W.length-10,1)),se.a.createElement("div",null,W.map(function(w,g){return se.a.createElement("pre",{className:"code",key:g,style:{margin:0,padding:0,borderRadius:0,backgroundColor:g===W.length-1?"var(--primary)":void 0}},Ee(g),"<",w.tag_name,w.attr_id&&' id="'.concat(w.attr_id,'"'),Object.entries(w.attributes).map(function(de){var Y=N()(de,2),m=Y[0],a=Y[1];return se.a.createElement("span",{key:m}," ".concat(m.replace("attr__",""),'="').concat(a,'"'))}),">",w.text,g===W.length-1&&se.a.createElement("span",null,"</",w.tag_name,">"))}),te()(W).reverse().slice(1).map(function(w,g){return se.a.createElement("pre",{className:"code",key:g,style:{margin:0,padding:0,borderRadius:0}},Ee(W.length-g-2),"</",w.tag_name,">")}))}try{k.displayName="EventElements",k.__docgenInfo={description:"",displayName:"EventElements",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"EventType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventElements.tsx#EventElements"]={docgenInfo:k.__docgenInfo,name:"EventElements",path:"frontend/src/scenes/events/EventElements.tsx#EventElements"})}catch(F){}},"./frontend/src/scenes/events/EventsTable.tsx":function(pe,I,e){"use strict";e.d(I,"a",function(){return M});var H=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),N=e.n(H),ee=e("./node_modules/core-js/modules/es.array.splice.js"),te=e("./node_modules/core-js/modules/es.array.map.js"),le=e("./node_modules/core-js/modules/es.array.find.js"),ie=e("./node_modules/core-js/modules/es.object.to-string.js"),Z=e("./node_modules/core-js/modules/es.array.concat.js"),z=e("./node_modules/core-js/modules/es.array.join.js"),ne=e("./node_modules/core-js/modules/es.object.keys.js"),G=e("./node_modules/core-js/modules/es.regexp.to-string.js"),Q=e("./node_modules/react/index.js"),o=e.n(Q),b=e("./node_modules/kea/lib/index.esm.js"),C=e("./frontend/src/scenes/events/EventDetails.tsx"),re=e("./frontend/src/lib/components/Link.tsx"),U=e("./node_modules/antd/es/button/index.js"),ce=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),Oe=e.n(ce),he=e("./node_modules/core-js/modules/es.array.filter.js"),xe=e("./node_modules/core-js/modules/es.symbol.js"),fe=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),se=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Ee=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),k=e("./node_modules/kea-router/lib/index.js"),F=e("./node_modules/@babel/runtime/helpers/typeof.js"),oe=e.n(F),W=e("./node_modules/core-js/modules/es.regexp.exec.js"),w=e("./node_modules/core-js/modules/es.string.replace.js");function g(l){var u=l.value;return o.a.createElement("span",{title:u},oe()(u)==="object"?JSON.stringify(u):u&&u.toString().replace(/(^\w+:|^)\/\//,""))}try{g.displayName="Property",g.__docgenInfo={description:"",displayName:"Property",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Property.tsx#Property"]={docgenInfo:g.__docgenInfo,name:"Property",path:"frontend/src/lib/components/Property.tsx#Property"})}catch(l){}var de=e("./frontend/src/lib/components/PropertyFilters/utils.ts");function Y(l,u){var d=Object.keys(l);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(l);u&&(_=_.filter(function(P){return Object.getOwnPropertyDescriptor(l,P).enumerable})),d.push.apply(d,_)}return d}function m(l){for(var u=1;u<arguments.length;u++){var d=arguments[u]!=null?arguments[u]:{};u%2?Y(Object(d),!0).forEach(function(_){Oe()(l,_,d[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(d)):Y(Object(d)).forEach(function(_){Object.defineProperty(l,_,Object.getOwnPropertyDescriptor(d,_))})}return l}function a(l){var u=l.property,d=l.value,_=l.filters,P=l.onClick,ae=l.className,y=Object(de.c)(_.properties),Te=y.find(function(K){return K.key===u&&K.value===d&&!K.operator})?y.filter(function(K){return K.key!==u||K.value!==d||K.operator}):[].concat(N()(y),[{key:u,value:d}]),j=Object(k.combineUrl)(window.location.pathname,m(m({},_),{},{properties:Te}),{}),_e=j.url;return o.a.createElement(re.a,{to:_e,className:ae,onClick:function(){P&&P(u,d)}},o.a.createElement(g,{value:d}))}try{a.displayName="FilterPropertyLink",a.__docgenInfo={description:"",displayName:"FilterPropertyLink",props:{property:{defaultValue:null,description:"",name:"property",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string | number"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((property: string, value: string | number) => void)"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/FilterPropertyLink.tsx#FilterPropertyLink"]={docgenInfo:a.__docgenInfo,name:"FilterPropertyLink",path:"frontend/src/lib/components/FilterPropertyLink.tsx#FilterPropertyLink"})}catch(l){}var E=e("./frontend/src/lib/utils.tsx"),p=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),D=e.n(p),B=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/events/EventsTable.scss"),ue=e.n(B),V={};V.insert="head",V.singleton=!1;var ve=D()(ue.a,V),X=ue.a.locals||{},me=e("./frontend/src/scenes/events/eventsTableLogic.ts"),S=e("./frontend/src/scenes/persons/PersonHeader.tsx"),Pe=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),A=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),ge=e("./frontend/src/types.ts"),Ke=e("./frontend/src/scenes/actions/EventName.tsx"),Se=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),Me=e("./frontend/src/lib/components/Tooltip.tsx"),be=e("./node_modules/clsx/dist/clsx.m.js"),Ne=e("./frontend/src/lib/components/ResizableTable/tableConfigLogic.ts"),s=e("./frontend/src/scenes/urls.ts"),t=e("./frontend/src/lib/components/LemonTable/index.ts"),n=e("./frontend/src/lib/components/icons.tsx"),r=e("./frontend/src/lib/components/LemonButton/index.ts"),c=e("./frontend/src/lib/components/LemonButton/More.tsx"),f=e("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),O=e("./frontend/src/scenes/teamLogic.ts"),R=e("./frontend/src/scenes/events/createActionFromEvent.tsx");function $(l){Object(Q.useEffect)(function(){var u="hidden",d="visibilitychange";typeof document.msHidden!="undefined"?(u="msHidden",d="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(u="webkitHidden",d="webkitvisibilitychange");var _=function(){l(!document[u])};return document.addEventListener(d,_),function(){document.removeEventListener(d,_)}},[])}var J=e("./frontend/src/lib/components/ResizableTable/TableConfig.tsx");function M(l){var u=l.pageKey,d=l.fixedFilters,_=l.fixedColumns,P=l.sceneUrl,ae=l.fetchMonths,y=ae===void 0?12:ae,Te=l.startingColumns,j=l.showCustomizeColumns,_e=j===void 0?!0:j,K=l.showExport,Ce=K===void 0?!0:K,De=l.showAutoload,Re=De===void 0?!0:De,ye=l.showEventFilter,Ze=ye===void 0?!0:ye,Ve=l.showRowExpanders,ke=Ve===void 0?!0:Ve,$e=l.showActionsButton,qe=$e===void 0?!0:$e,Ye=l.showPersonColumn,et=Ye===void 0?!0:Ye,Je=l.linkPropertiesToFilters,Ue=Je===void 0?!0:Je,tt=Object(b.useValues)(O.a),Fe=tt.currentTeam,He=Object(me.a)({fixedFilters:d,key:u,sceneUrl:P||s.a.events(),fetchMonths:y}),q=Object(b.useValues)(He),Ae=q.properties,nt=q.eventsFormatted,ze=q.isLoading,rt=q.hasNext,Ge=q.isLoadingNext,Ie=q.eventFilter,st=q.automaticLoadEnabled,ot=q.exportUrl,at=q.highlightEvents,lt=q.months,Qe=Object(b.useValues)(Object(Ne.a)({startingColumns:Te})),We=Qe.tableWidth,Le=Qe.selectedColumns,je=Object(b.useActions)(He),it=je.fetchNextEvents,ct=je.prependNewEvents,dt=je.setEventFilter,ut=je.toggleAutomaticLoad,vt=je.startDownload,mt=je.setPollingActive,pt=je.setProperties,ft=!(d!=null&&d.person_id);$(mt);var Xe=function(i,T){var h=i.date_break,v=i.new_events;return{children:h||(v?o.a.createElement(r.a,{icon:o.a.createElement(n.IconSync,null),style:{borderRadius:0},onClick:function(){return ct()},center:!0,fullWidth:!0},"There are new events. Click here to load them"):"???"),props:{colSpan:T+1,style:v?{padding:0}:void 0}}},Et={title:"Person",key:"person",render:function(i,T){var h,v,x=T.event;return x?ft&&(h=x.person)!==null&&h!==void 0&&(v=h.distinct_ids)!==null&&v!==void 0&&v.length?o.a.createElement(re.a,{to:s.a.person(x.person.distinct_ids[0])},o.a.createElement(S.a,{withIcon:!0,person:x.person})):o.a.createElement(S.a,{withIcon:!0,person:x.person}):{props:{colSpan:0}}}},we=Object(Q.useMemo)(function(){var L=[{title:"Event",key:"event",width:"16rem",render:function(T,h){if(!h.event)return Xe(h,We);var v=h.event;return o.a.createElement(A.a,{value:Object(E.f)(v)})}},{title:"URL / Screen",key:"url",width:"4rem",render:function(T,h){var v=h.event;if(!v)return{props:{colSpan:0}};var x=v.properties.$current_url?"$current_url":"$screen_name";return Ue?o.a.createElement(a,{className:"ph-no-capture",property:x,value:v.properties[x],filters:{properties:Ae}}):o.a.createElement(g,{value:v.properties[x]})}},{title:o.a.createElement(Me.a,{title:'This is the "Library" property on events. Sent by the SDK as "$lib"'},"Source"),key:"source",render:function(T,h){var v=h.event;return v?Ue?o.a.createElement(a,{property:"$lib",value:v.properties.$lib,filters:{properties:Ae}}):o.a.createElement(g,{value:v.properties.$lib}):{props:{colSpan:0}}}}];return et&&L.splice(1,0,Et),L},[We]),_t=Object(Q.useMemo)(function(){var L=Le==="DEFAULT"?N()(we):Le.map(function(i,T){return we.find(function(h){return h.key===i})||{title:A.d.event[i]?A.d.event[i].label:i,key:i,render:function(v,x){var Be=x.event;return Be?Ue?o.a.createElement(a,{className:"ph-no-capture ",property:i,value:Be.properties[i],filters:{properties:Ae}}):o.a.createElement(g,{value:Be.properties[i]}):T===0?Xe(x,We):{props:{colSpan:0}}}}});return L.push({title:"Time",key:"time",render:function(T,h){var v=h.event;return v?o.a.createElement(Pe.b,{time:v.timestamp,showSeconds:!0}):{props:{colSpan:0}}}}),qe&&L.push({key:"actions",width:0,render:function(T,h){var v=h.event;if(!v)return{props:{colSpan:0}};var x;return v.event==="$pageview"?x={insight:ge.y.TRENDS,interval:"day",display:ge.i.ActionsLineGraph,actions:[],events:[{id:"$pageview",name:"$pageview",type:"events",order:0,properties:[{key:"$current_url",value:v.properties.$current_url,type:"event"}]}]}:v.event!=="$autocapture"&&(x={insight:ge.y.TRENDS,interval:"day",display:ge.i.ActionsLineGraph,actions:[],events:[{id:v.event,name:v.event,type:"events",order:0,properties:[]}]}),o.a.createElement(c.a,{overlay:o.a.createElement(o.a.Fragment,null,Fe&&o.a.createElement(r.a,{type:"stealth",onClick:function(){return Object(R.a)(Fe.id,v,0,Fe.data_attributes||[])},fullWidth:!0,"data-attr":"events-table-create-action"},"Create action from event"),x&&o.a.createElement(r.a,{type:"stealth",to:s.a.insightNew(x),fullWidth:!0,"data-attr":"events-table-usage"},"Try out in Insights"))})}}),_?L.concat(_):L},[Le]);return o.a.createElement("div",{"data-attr":"manage-events-table"},o.a.createElement("div",{className:"events","data-attr":"events-table",style:{paddingTop:"1rem",borderTop:"1px solid var(--border)"}},o.a.createElement("div",{className:"mb",style:{display:"flex",gap:"1rem",flexWrap:"wrap",justifyContent:"space-between",alignItems:"start"}},o.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",flexDirection:"row",alignItems:"center",width:"100%"}},o.a.createElement(Se.a,{propertyFilters:Ae,onChange:pt,pageKey:u,taxonomicPopoverPlacement:"bottom-start",style:{marginBottom:0,marginTop:0},eventNames:Ie?[Ie]:[],useLemonButton:!0,prefixComponent:Ze?o.a.createElement(Ke.b,{value:Ie,onChange:function(i){dt(i||"")}}):o.a.createElement(o.a.Fragment,null)})),o.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",gap:"1rem",borderTop:Re||_e||Ce?"1px solid var(--border)":0,width:"100%",paddingTop:Re||_e||Ce?"1rem":0}},Re&&o.a.createElement(f.a,{type:"primary",id:"autoload-switch",label:"Automatically load new events",checked:st,onChange:ut}),o.a.createElement("div",{style:{display:"flex",gap:"0.5rem",flexDirection:"row"}},_e&&o.a.createElement(J.a,{immutableColumns:["event","person"],defaultColumns:we.map(function(L){return L.key||""})}),Ce&&ot&&o.a.createElement(Me.a,{title:"Export up to 10,000 latest events.",placement:"left"},o.a.createElement(r.a,{type:"secondary",icon:o.a.createElement(n.IconExport,{style:{color:"var(--primary)"}}),onClick:vt},"Export"))))),o.a.createElement(t.a,{dataSource:nt,loading:ze,columns:_t,key:Le==="DEFAULT"?"default":Le.join("-"),className:"ph-no-capture",loadingSkeletonRows:20,emptyState:ze?void 0:Ae.some(function(L){return Object.keys(L).length})||Ie?"No events matching filters found in the last ".concat(lt," months!"):o.a.createElement(o.a.Fragment,null,"This project doesn't have any events. If you haven't integrated PostHog yet,"," ",o.a.createElement(re.a,{to:"/project/settings"},"click here to instrument analytics with PostHog in your product"),"."),rowKey:function(i){var T;return i.event?i.event.id+"-"+i.event.event:((T=i.date_break)===null||T===void 0?void 0:T.toString())||""},rowClassName:function(i){return Object(be.a)({"event-row":i.event,highlighted:i.event&&at[i.event.id],"event-row-is-exception":i.event&&i.event.event==="$exception","event-row-date-separator":i.date_break,"event-row-new":i.new_events})},expandable:ke?{expandedRowRender:function(i){var T=i.event;return T&&o.a.createElement(C.a,{event:T})},rowExpandable:function(i){var T=i.event,h=i.date_break,v=i.new_events;return h||v?-1:!!T}}:void 0}),o.a.createElement(U.a,{type:"primary",onClick:it,loading:Ge,style:{display:rt||Ge?"block":"none",margin:"2rem auto 1rem"}},"Load more events")))}try{M.displayName="EventsTable",M.__docgenInfo={description:"",displayName:"EventsTable",props:{pageKey:{defaultValue:null,description:"",name:"pageKey",required:!0,type:{name:"string"}},fixedFilters:{defaultValue:null,description:"",name:"fixedFilters",required:!1,type:{name:"FixedFilters"}},fixedColumns:{defaultValue:null,description:"",name:"fixedColumns",required:!1,type:{name:"LemonTableColumn<EventsTableRowItem, keyof EventsTableRowItem>[]"}},sceneUrl:{defaultValue:null,description:"",name:"sceneUrl",required:!1,type:{name:"string"}},fetchMonths:{defaultValue:{value:"12"},description:"",name:"fetchMonths",required:!1,type:{name:"number"}},startingColumns:{defaultValue:null,description:"",name:"startingColumns",required:!1,type:{name:"ColumnChoice"}},showCustomizeColumns:{defaultValue:{value:"true"},description:"",name:"showCustomizeColumns",required:!1,type:{name:"boolean"}},showExport:{defaultValue:{value:"true"},description:"",name:"showExport",required:!1,type:{name:"boolean"}},showAutoload:{defaultValue:{value:"true"},description:"",name:"showAutoload",required:!1,type:{name:"boolean"}},showEventFilter:{defaultValue:{value:"true"},description:"",name:"showEventFilter",required:!1,type:{name:"boolean"}},showRowExpanders:{defaultValue:{value:"true"},description:"",name:"showRowExpanders",required:!1,type:{name:"boolean"}},showActionsButton:{defaultValue:{value:"true"},description:"",name:"showActionsButton",required:!1,type:{name:"boolean"}},showPersonColumn:{defaultValue:{value:"true"},description:"",name:"showPersonColumn",required:!1,type:{name:"boolean"}},linkPropertiesToFilters:{defaultValue:{value:"true"},description:"",name:"linkPropertiesToFilters",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventsTable.tsx#EventsTable"]={docgenInfo:M.__docgenInfo,name:"EventsTable",path:"frontend/src/scenes/events/EventsTable.tsx#EventsTable"})}catch(l){}},"./frontend/src/scenes/events/eventsTableLogic.ts":function(pe,I,e){"use strict";e.d(I,"a",function(){return Ne});var H=e("./node_modules/core-js/modules/es.object.keys.js"),N=e.n(H),ee=e("./node_modules/core-js/modules/es.symbol.js"),te=e.n(ee),le=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),ie=e.n(le),Z=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),z=e.n(Z),ne=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),G=e.n(ne),Q=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=e.n(Q),b=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),C=e.n(b),re=e("./node_modules/@babel/runtime/regenerator/index.js"),U=e.n(re),ce=e("./node_modules/core-js/modules/es.array.map.js"),Oe=e.n(ce),he=e("./node_modules/core-js/modules/es.object.to-string.js"),xe=e.n(he),fe=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),se=e.n(fe),Ee=e("./node_modules/core-js/modules/es.array.splice.js"),k=e.n(Ee),F=e("./node_modules/core-js/modules/es.array.join.js"),oe=e.n(F),W=e("./node_modules/core-js/modules/es.array.filter.js"),w=e.n(W),g=e("./node_modules/core-js/modules/es.array.concat.js"),de=e.n(g),Y=e("./node_modules/core-js/modules/es.array.iterator.js"),m=e.n(Y),a=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),E=e.n(a),p=e("./node_modules/kea/lib/index.esm.js"),D=e("./frontend/src/lib/utils.tsx"),B=e("./node_modules/kea-router/lib/index.js"),ue=e.n(B),V=e("./frontend/src/lib/api.ts"),ve=e("./frontend/src/scenes/teamLogic.ts"),X=e("./frontend/src/lib/dayjs.ts"),me=e("./frontend/src/lib/logic/featureFlagLogic.ts"),S=e("./frontend/src/lib/components/lemonToast.tsx");function Pe(s,t){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable})),n.push.apply(n,r)}return n}function A(s){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Pe(Object(n),!0).forEach(function(r){o()(s,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(n,r))})}return s}var ge=5,Ke=365,Se=5e3,Me=function(t,n){var r=[];return r=t.map(function(c){return{event:c}}),r.forEach(function(c,f){var O=r[f-1];f>0&&c.event&&O.event&&!Object(X.a)(c.event.timestamp).isSame(O.event.timestamp,"day")&&r.splice(f,0,{date_break:Object(X.a)(c.event.timestamp).format("LL")})}),n.length>0&&r.splice(0,0,{new_events:!0}),r},be=function(t){return Object(X.b)().subtract(t,"day").toISOString()},Ne=Object(p.kea)({path:function(t){return["scenes","events","eventsTableLogic",t]},props:{},key:function(t){return[t.fixedFilters?JSON.stringify(t.fixedFilters):"all",t.key,t.sceneUrl].filter(function(n){return!!n}).join("-")},connect:{values:[ve.a,["currentTeamId"],me.a,["featureFlags"]]},actions:{setPollingActive:function(t){return{pollingActive:t}},setProperties:function(t){return Array.isArray(t)?t.length===0?{properties:[{}]}:{properties:t}:{properties:[t]}},fetchEvents:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return{nextParams:t}},fetchEventsSuccess:function(t){return t},fetchNextEvents:!0,fetchOrPollFailure:function(t){return{error:t}},pollEvents:!0,pollEventsSuccess:function(t){return{events:t}},prependEvents:function(t){return{events:t}},prependNewEvents:!0,setSelectedEvent:function(t){return{selectedEvent:t}},setPollTimeout:function(t){return{pollTimeout:t}},setEventFilter:function(t){return{event:t}},toggleAutomaticLoad:function(t){return{automaticLoadEnabled:t}},noop:function(t){return t},startDownload:!0},reducers:{pollingIsActive:[!0,{setPollingActive:function(t,n){var r=n.pollingActive;return r},pollEventsSuccess:function(t,n){var r=n.events;return r&&r.length?!1:t},prependNewEvents:function(){return!0},toggleAutomaticLoad:function(){return!0}}],properties:[[],{setProperties:function(t,n){var r=n.properties;return Object(D.r)(r)}}],eventFilter:["",{setEventFilter:function(t,n){var r=n.event;return r}}],isLoading:[!0,{fetchEvents:function(){return!0},fetchEventsSuccess:function(){return!1},fetchOrPollFailure:function(){return!1}}],isLoadingNext:[!1,{fetchNextEvents:function(){return!0},fetchEventsSuccess:function(){return!1}}],events:[[],{fetchEventsSuccess:function(t,n){var r=n.events,c=n.isNext;return c?[].concat(C()(t),C()(r)):r},prependEvents:function(t,n){var r=n.events;return[].concat(C()(r),C()(t))}}],hasNext:[!1,{fetchEvents:function(){return!1},fetchNextEvents:function(){return!1},fetchEventsSuccess:function(t,n){var r=n.hasNext;return r}}],orderBy:["-timestamp",{}],selectedEvent:[null,{setSelectedEvent:function(t,n){var r=n.selectedEvent;return r}}],newEvents:[[],{setProperties:function(){return[]},pollEventsSuccess:function(t,n){var r=n.events;return r||[]},prependEvents:function(){return[]}}],highlightEvents:[{},{prependEvents:function(t,n){var r=n.events;return r.reduce(function(c,f){return c[f.id]=!0,c},{})}}],pollTimeout:[0,{setPollTimeout:function(t,n){return n.pollTimeout}}],automaticLoadEnabled:[!1,{persist:!0},{toggleAutomaticLoad:function(t,n){var r=n.automaticLoadEnabled;return r}}]},selectors:function(t){var n=t.selectors,r=t.props;return{eventsFormatted:[function(){return[n.events,n.newEvents]},function(c,f){return Me(c,f)}],exportUrl:[function(){return[n.currentTeamId,n.eventFilter,n.orderBy,n.properties,n.minimumQueryDate]},function(c,f,O,R,$){var J;return"/api/projects/".concat(c,"/events.csv?").concat(Object(D.yb)(A(A(A({},r.fixedFilters||{}),{},{properties:[].concat(C()(R),C()(((J=r.fixedFilters)===null||J===void 0?void 0:J.properties)||[]))},f?{event:f}:{}),{},{orderBy:[O],after:$})))}],months:[function(){return[function(c,f){return f.fetchMonths}]},function(c){return c||12}],minimumQueryDate:[function(){return[n.months]},function(c){return Object(X.b)().subtract(c,"months").toISOString()}],pollAfter:[function(){return[n.events]},function(c){return(c==null?void 0:c.length)>0&&c[0].timestamp?c[0].timestamp:be(0)}]}},actionToUrl:function(t){var n=t.values;return{setProperties:function(){return[B.router.values.location.pathname,A(A({},B.router.values.searchParams),{},{properties:n.properties.length===0?void 0:n.properties}),B.router.values.hashParams,{replace:!0}]},setEventFilter:function(){return[B.router.values.location.pathname,A(A({},B.router.values.searchParams),{},{eventFilter:n.eventFilter}),B.router.values.hashParams,{replace:!0}]}}},urlToAction:function(t){var n=t.actions,r=t.values,c=t.props;return o()({},c.sceneUrl,function(f,O){n.setProperties(O.properties||r.properties||{}),O.eventFilter&&n.setEventFilter(O.eventFilter)})},events:function(t){var n=t.values;return{beforeUnmount:function(){return clearTimeout(n.pollTimeout||void 0)}}},listeners:function(t){var n=t.actions,r=t.values,c=t.props;return{startDownload:function(){S.b.success("The export is starting. It should finish soon"),window.location.href=r.exportUrl},setProperties:function(){return n.fetchEvents()},setEventFilter:function(){return n.fetchEvents()},fetchNextEvents:function(){var f=G()(U.a.mark(function R(){var $;return U.a.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:$=r.events,$.length===0?n.fetchEvents():n.fetchEvents({before:$[$.length-1].timestamp});case 2:case"end":return M.stop()}},R)}));function O(){return f.apply(this,arguments)}return O}(),fetchEvents:function(){var f=G()(U.a.mark(function R($,J){var M,l,u,d,_,P,ae,y;return U.a.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(_=function(){return _=G()(U.a.mark(function K(Ce){var De;return U.a.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:return De=A(A(A(A({after:Ce},c.fixedFilters||{}),{},{properties:u},l||{}),r.eventFilter?{event:r.eventFilter}:{}),{},{orderBy:[r.orderBy]}),ye.abrupt("return",V.b.get("api/projects/".concat(r.currentTeamId,"/events/?").concat(Object(D.yb)(De))));case 2:case"end":return ye.stop()}},K)})),_.apply(this,arguments)},d=function(K){return _.apply(this,arguments)},l=$.nextParams,clearTimeout(r.pollTimeout),!(r.events.length>0)){j.next=9;break}return j.next=7,J(300);case 7:j.next=11;break;case 9:return j.next=11,J(1);case 11:return u=[].concat(C()(r.properties),C()(((M=c.fixedFilters)===null||M===void 0?void 0:M.properties)||[])),P=null,ae=!1,j.prev=14,j.next=17,d(be(ge));case 17:if(P=j.sent,P.results.length!==0){j.next=23;break}return j.next=21,d(be(Ke));case 21:P=j.sent,ae=!0;case 23:j.next=29;break;case 25:return j.prev=25,j.t0=j.catch(14),n.fetchOrPollFailure(j.t0),j.abrupt("return");case 29:J(),n.fetchEventsSuccess({events:P.results,hasNext:!!P.next||!ae,isNext:!!l}),y=window.setTimeout(n.pollEvents,Se),n.setPollTimeout(y);case 33:case"end":return j.stop()}},R,null,[[14,25]])}));function O(R,$){return f.apply(this,arguments)}return O}(),pollEvents:function(){var f=G()(U.a.mark(function R($,J){var M,l,u,d,_,P;return U.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(l=function(){var j=window.setTimeout(n.pollEvents,Se);n.setPollTimeout(j)},r.orderBy==="-timestamp"){y.next=3;break}return y.abrupt("return");case 3:if(c.sceneUrl===B.router.values.location.pathname){y.next=5;break}return y.abrupt("return");case 5:if(r.pollingIsActive){y.next=8;break}return l(),y.abrupt("return");case 8:return u=[].concat(C()(r.properties),C()(((M=c.fixedFilters)===null||M===void 0?void 0:M.properties)||[])),d=A(A(A({},c.fixedFilters||{}),{},{properties:u},r.eventFilter?{event:r.eventFilter}:{}),{},{orderBy:[r.orderBy],after:r.pollAfter}),_=Object(D.yb)(d),P=null,y.prev=12,y.next=15,V.b.get("api/projects/".concat(r.currentTeamId,"/events/?").concat(_));case 15:P=y.sent,y.next=21;break;case 18:return y.prev=18,y.t0=y.catch(12),y.abrupt("return");case 21:J(),r.automaticLoadEnabled?n.prependEvents(P.results):n.pollEventsSuccess(P.results),l();case 24:case"end":return y.stop()}},R,null,[[12,18]])}));function O(R,$){return f.apply(this,arguments)}return O}(),prependNewEvents:function(){r.newEvents.length&&n.prependEvents(r.newEvents)},fetchOrPollFailure:function(O){var R=O.error;S.b.error("There was a problem fetching your events: ".concat(R.statusText))},toggleAutomaticLoad:function(O){var R=O.automaticLoadEnabled;R&&n.prependNewEvents()}}}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/events/EventsTable.scss":function(pe,I,e){var H=e("./node_modules/css-loader/dist/runtime/api.js");I=H(!1),I.push([pe.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.events .events-table-button-clear{padding:0 4px;margin-left:4px}.events .events-table-button-clear.visible,.events .events-table-button-clear:focus,.events .events-table-button-clear:hover{border:1px solid #5375ff}.events .event-row-new{height:2.5rem}.events .event-row-date-separator{background-color:var(--bg-mid);color:var(--text-muted);font-weight:600;font-size:.75rem;height:2rem;text-align:center}.events .event-row-is-exception{background-color:#fffaf8}.events td{max-width:20rem}",""]),pe.exports=I}}]);
