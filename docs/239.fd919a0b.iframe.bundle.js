(window.webpackJsonp=window.webpackJsonp||[]).push([[239],{4401:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return normalizeColumnTitle}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),lib_hooks_useWindowSize__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1909),lib_utils_responsiveUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(503);function normalizeColumnTitle(title){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{style:{whiteSpace:"nowrap"}},title)}var useIsTableScrolling=function useIsTableScrolling(scrollBreakpoint){var width=Object(lib_hooks_useWindowSize__WEBPACK_IMPORTED_MODULE_1__.a)().width,tableScrollBreakpoint=Object(lib_utils_responsiveUtils__WEBPACK_IMPORTED_MODULE_2__.b)(scrollBreakpoint),isTableScrolling=!!width&&width<=tableScrollBreakpoint;return{isTableScrolling:isTableScrolling,tableScrollBreakpoint:tableScrollBreakpoint,tableScrollX:isTableScrolling?"max-content":"".concat(tableScrollBreakpoint,"px")}};try{normalizeColumnTitle.displayName="normalizeColumnTitle",normalizeColumnTitle.__docgenInfo={description:"",displayName:"normalizeColumnTitle",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Table/utils.tsx#normalizeColumnTitle"]={docgenInfo:normalizeColumnTitle.__docgenInfo,name:"normalizeColumnTitle",path:"frontend/src/lib/components/Table/utils.tsx#normalizeColumnTitle"})}catch(__react_docgen_typescript_loader_error){}try{useIsTableScrolling.displayName="useIsTableScrolling",useIsTableScrolling.__docgenInfo={description:"",displayName:"useIsTableScrolling",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Table/utils.tsx#useIsTableScrolling"]={docgenInfo:useIsTableScrolling.__docgenInfo,name:"useIsTableScrolling",path:"frontend/src/lib/components/Table/utils.tsx#useIsTableScrolling"})}catch(__react_docgen_typescript_loader_error){}},4402:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return featureFlagsLogic}));__webpack_require__(42),__webpack_require__(61),__webpack_require__(115),__webpack_require__(46),__webpack_require__(34),__webpack_require__(40),__webpack_require__(86),__webpack_require__(308),__webpack_require__(51);var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(15),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_9__),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(7),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_10__),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_12__=(__webpack_require__(68),__webpack_require__(13)),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_12__),kea__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(1),lib_api__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(22),fuse_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(310),_teamLogic__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(26),scenes_urls__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(18),featureFlagsLogic=Object(kea__WEBPACK_IMPORTED_MODULE_13__.kea)({path:["scenes","feature-flags","featureFlagsLogic"],connect:{values:[_teamLogic__WEBPACK_IMPORTED_MODULE_16__.a,["currentTeamId"]]},actions:{updateFlag:function updateFlag(flag){return{flag:flag}},deleteFlag:function deleteFlag(id){return{id:id}},setSearchTerm:function setSearchTerm(searchTerm){return{searchTerm:searchTerm}}},loaders:function loaders(_ref){var _updateFeatureFlag,_loadFeatureFlags,values=_ref.values;return{featureFlags:{__default:[],loadFeatureFlags:(_loadFeatureFlags=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_12___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_10___default.a.mark((function _callee(){var response;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_10___default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,lib_api__WEBPACK_IMPORTED_MODULE_14__.a.get("api/projects/".concat(values.currentTeamId,"/feature_flags/"));case 2:return response=_context.sent,_context.abrupt("return",response.results);case 4:case"end":return _context.stop()}}),_callee)}))),function loadFeatureFlags(){return _loadFeatureFlags.apply(this,arguments)}),updateFeatureFlag:(_updateFeatureFlag=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_12___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_10___default.a.mark((function _callee2(_ref2){var id,payload,response;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_10___default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return id=_ref2.id,payload=_ref2.payload,_context2.next=3,lib_api__WEBPACK_IMPORTED_MODULE_14__.a.update("api/projects/".concat(values.currentTeamId,"/feature_flags/").concat(id),payload);case 3:return response=_context2.sent,_context2.abrupt("return",_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_9___default()(values.featureFlags).map((function(flag){return flag.id===response.id?response:flag})));case 5:case"end":return _context2.stop()}}),_callee2)}))),function updateFeatureFlag(_x){return _updateFeatureFlag.apply(this,arguments)})}}},selectors:{searchedFeatureFlags:[function(selectors){return[selectors.featureFlags,selectors.searchTerm]},function(featureFlags,searchTerm){return searchTerm?new fuse_js__WEBPACK_IMPORTED_MODULE_15__.a(featureFlags,{keys:["key","name"],threshold:.3}).search(searchTerm).map((function(result){return result.item})):featureFlags}],breadcrumbs:[function(){return[]},function(){return[{name:"Feature Flags",path:scenes_urls__WEBPACK_IMPORTED_MODULE_17__.a.featureFlags()}]}]},reducers:{searchTerm:{setSearchTerm:function setSearchTerm(_,_ref3){return _ref3.searchTerm}},featureFlags:{updateFlag:function updateFlag(state,_ref4){var flag=_ref4.flag;return state.find((function(_ref5){return _ref5.id===flag.id}))?state.map((function(stateFlag){return stateFlag.id===flag.id?flag:stateFlag})):[flag].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_9___default()(state))},deleteFlag:function deleteFlag(state,_ref6){var id=_ref6.id;return state.filter((function(flag){return flag.id!==id}))}}},events:function events(_ref7){var actions=_ref7.actions;return{afterMount:function afterMount(){actions.loadFeatureFlags()}}}})},4534:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene})),__webpack_require__.d(__webpack_exports__,"FeatureFlags",(function(){return FeatureFlags}));__webpack_require__(85),__webpack_require__(281),__webpack_require__(63),__webpack_require__(211);var react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_4__),kea__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1),_featureFlagsLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4402),antd__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(472),lib_components_Link__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(56),lib_utils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(10),_ant_design_icons__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2698),lib_components_PageHeader__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(209),lib_components_LinkButton__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(404),lib_components_Table_utils__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(4401),scenes_urls__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(18),lib_utils_stringWithWBR__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(1908),_teamLogic__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(26),_lib_components_LemonButton__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(58),_lib_components_LemonRow__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(100),_lib_components_LemonSwitch_LemonSwitch__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(408),_lib_components_LemonTable__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(246),_lib_components_LemonButton_More__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(520),_lib_components_LemonTable_columnUtils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(1252),lib_components_PropertyFilters_components_PropertyFiltersDisplay__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(2552),scene={component:FeatureFlags,logic:_featureFlagsLogic__WEBPACK_IMPORTED_MODULE_6__.a};function FeatureFlags(){var currentTeamId=Object(kea__WEBPACK_IMPORTED_MODULE_5__.useValues)(_teamLogic__WEBPACK_IMPORTED_MODULE_16__.a).currentTeamId,_useValues2=Object(kea__WEBPACK_IMPORTED_MODULE_5__.useValues)(_featureFlagsLogic__WEBPACK_IMPORTED_MODULE_6__.a),featureFlagsLoading=_useValues2.featureFlagsLoading,searchedFeatureFlags=_useValues2.searchedFeatureFlags,searchTerm=_useValues2.searchTerm,_useActions=Object(kea__WEBPACK_IMPORTED_MODULE_5__.useActions)(_featureFlagsLogic__WEBPACK_IMPORTED_MODULE_6__.a),updateFeatureFlag=_useActions.updateFeatureFlag,loadFeatureFlags=_useActions.loadFeatureFlags,setSearchTerm=_useActions.setSearchTerm,columns=[{title:Object(lib_components_Table_utils__WEBPACK_IMPORTED_MODULE_13__.a)("Key"),dataIndex:"key",className:"ph-no-capture",sticky:!0,width:"40%",sorter:function sorter(a,b){return(a.key||"").localeCompare(b.key||"")},render:function Render(_,featureFlag){return react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_4___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(lib_components_Link__WEBPACK_IMPORTED_MODULE_8__.a,{to:featureFlag.id?scenes_urls__WEBPACK_IMPORTED_MODULE_14__.a.featureFlag(featureFlag.id):void 0,className:"row-name"},Object(lib_utils_stringWithWBR__WEBPACK_IMPORTED_MODULE_15__.a)(featureFlag.key,17)),featureFlag.name&&react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement("span",{className:"row-description"},featureFlag.name))}},Object(_lib_components_LemonTable_columnUtils__WEBPACK_IMPORTED_MODULE_22__.b)(),Object(_lib_components_LemonTable_columnUtils__WEBPACK_IMPORTED_MODULE_22__.a)(),{title:"Rollout",width:200,render:function Render(_,featureFlag){return function groupFilters(groups){if(0===groups.length||!groups.some((function(group){return 0!==group.rollout_percentage})))return"No users";if(groups.some((function(group){var _group$properties;return!(null===(_group$properties=group.properties)||void 0===_group$properties?void 0:_group$properties.length)&&[null,void 0,100].includes(group.rollout_percentage)})))return"All users";if(1===groups.length){var _groups$=groups[0],properties=_groups$.properties,_groups$$rollout_perc=_groups$.rollout_percentage,rollout_percentage=void 0===_groups$$rollout_perc?null:_groups$$rollout_perc;return(null==properties?void 0:properties.length)>0&&null!=rollout_percentage?react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement("div",{style:{display:"flex",alignItems:"center"}},react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement("span",{style:{flexShrink:0,marginRight:5}},rollout_percentage,"% of"),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(lib_components_PropertyFilters_components_PropertyFiltersDisplay__WEBPACK_IMPORTED_MODULE_23__.a,{filters:properties,style:{margin:0,width:"100%"}})):(null==properties?void 0:properties.length)>0?react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(lib_components_PropertyFilters_components_PropertyFiltersDisplay__WEBPACK_IMPORTED_MODULE_23__.a,{filters:properties,style:{margin:0}}):null!==rollout_percentage?"".concat(rollout_percentage,"% of all users"):(console.error("A group with full rollout was not detected early"),"All users")}return"".concat(groups.length," groups")}(featureFlag.filters.groups)}},{title:"Status",dataIndex:"active",sorter:function sorter(a,b){return Number(a.active)-Number(b.active)},width:100,render:function RenderActive(_,featureFlag){var switchId="feature-flag-".concat(featureFlag.id,"-switch");return react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement("label",{htmlFor:switchId},featureFlag.active?"Enabled":"Disabled"),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_lib_components_LemonSwitch_LemonSwitch__WEBPACK_IMPORTED_MODULE_19__.a,{id:switchId,checked:featureFlag.active,onChange:function onChange(active){return featureFlag.id?updateFeatureFlag({id:featureFlag.id,payload:{active:active}}):null},style:{marginLeft:"0.5rem"}}))}},{width:0,render:function Render(_,featureFlag){return react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_lib_components_LemonButton_More__WEBPACK_IMPORTED_MODULE_21__.a,{overlay:react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_4___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_lib_components_LemonButton__WEBPACK_IMPORTED_MODULE_17__.a,{type:"stealth",onClick:function onClick(){Object(lib_utils__WEBPACK_IMPORTED_MODULE_9__.r)(featureFlag.key,"feature flag key")},fullWidth:!0},"Copy key"),featureFlag.id&&react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_lib_components_LemonButton__WEBPACK_IMPORTED_MODULE_17__.a,{type:"stealth",to:scenes_urls__WEBPACK_IMPORTED_MODULE_14__.a.featureFlag(featureFlag.id),fullWidth:!0},"Edit"),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_lib_components_LemonButton__WEBPACK_IMPORTED_MODULE_17__.a,{type:"stealth",to:scenes_urls__WEBPACK_IMPORTED_MODULE_14__.a.insightNew({events:[{id:"$pageview",name:"$pageview",type:"events",math:"dau"}],breakdown_type:"event",breakdown:"$feature/".concat(featureFlag.key)}),"data-attr":"usage",fullWidth:!0},"Try out in Insights"),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_lib_components_LemonRow__WEBPACK_IMPORTED_MODULE_18__.b,null),featureFlag.id&&react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_lib_components_LemonButton__WEBPACK_IMPORTED_MODULE_17__.a,{type:"stealth",style:{color:"var(--danger)"},onClick:function onClick(){Object(lib_utils__WEBPACK_IMPORTED_MODULE_9__.v)({endpoint:"projects/".concat(currentTeamId,"/feature_flags"),object:{name:featureFlag.name,id:featureFlag.id},callback:loadFeatureFlags})},fullWidth:!0},"Delete feature flag"))})}}];return react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement("div",{className:"feature_flags"},react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(lib_components_PageHeader__WEBPACK_IMPORTED_MODULE_11__.a,{title:"Feature Flags",caption:"Feature Flags are a way of turning functionality in your app on or off, based on user properties."}),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_7__.a.Search,{placeholder:"Search for feature flags",allowClear:!0,enterButton:!0,style:{maxWidth:400,width:"initial",flexGrow:1},value:searchTerm,onChange:function onChange(e){setSearchTerm(e.target.value)}}),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement("div",{className:"mb float-right"},react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(lib_components_LinkButton__WEBPACK_IMPORTED_MODULE_12__.a,{type:"primary",to:scenes_urls__WEBPACK_IMPORTED_MODULE_14__.a.featureFlag("new"),"data-attr":"new-feature-flag",icon:react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_ant_design_icons__WEBPACK_IMPORTED_MODULE_10__.a,null)},"New Feature Flag"))),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_lib_components_LemonTable__WEBPACK_IMPORTED_MODULE_20__.a,{dataSource:searchedFeatureFlags,columns:columns,rowKey:"key",loading:featureFlagsLoading,defaultSorting:{columnKey:"key",order:1},pagination:{pageSize:100},nouns:["feature flag","feature flags"],"data-attr":"feature-flag-table"}))}}}]);