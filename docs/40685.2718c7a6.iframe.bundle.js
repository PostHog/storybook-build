"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[40685],{"../../frontend/src/scenes/heatmaps/components/HeatmapsForbiddenURL.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>HeatmapsForbiddenURL});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),lib_components_AuthorizedUrlList_AuthorizedUrlList__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/components/AuthorizedUrlList/AuthorizedUrlList.tsx"),lib_components_AuthorizedUrlList_authorizedUrlListLogic__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/components/AuthorizedUrlList/authorizedUrlListLogic.ts"),scenes_heatmaps_scenes_heatmap_heatmapLogic__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/scenes/heatmaps/scenes/heatmap/heatmapLogic.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function HeatmapsForbiddenURL(){let{dataUrl}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(scenes_heatmaps_scenes_heatmap_heatmapLogic__WEBPACK_IMPORTED_MODULE_4__.X);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)("div",{className:"flex-1 gap-y-4 my-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Vp,{type:"error",children:[dataUrl," is not an authorized URL. Please add it to the list of authorized URLs to view heatmaps on this page."]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("h4",{className:"my-4",children:"Authorized Toolbar URLs"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(lib_components_AuthorizedUrlList_AuthorizedUrlList__WEBPACK_IMPORTED_MODULE_2__.t,{type:lib_components_AuthorizedUrlList_authorizedUrlListLogic__WEBPACK_IMPORTED_MODULE_3__.uw.TOOLBAR_URLS})]})}},"../../frontend/src/scenes/heatmaps/scenes/heatmap/HeatmapScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{HeatmapScene:()=>HeatmapScene});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.35.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),HeatmapCanvas=__webpack_require__("../../frontend/src/lib/components/heatmaps/HeatmapCanvas.tsx"),hedgehogs=__webpack_require__("../../frontend/src/lib/components/hedgehogs.tsx"),LemonButton=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/index.ts"),LoadingBar=__webpack_require__("../../frontend/src/lib/lemon-ui/LoadingBar/index.ts"),FilterPanel=__webpack_require__("../../frontend/src/scenes/heatmaps/components/FilterPanel.tsx"),HeatmapsForbiddenURL=__webpack_require__("../../frontend/src/scenes/heatmaps/components/HeatmapsForbiddenURL.tsx"),heatmapLogic=__webpack_require__("../../frontend/src/scenes/heatmaps/scenes/heatmap/heatmapLogic.ts"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function HeatmapHeader(){let{dataUrl,displayUrl,isBrowserUrlAuthorized,screenshotError}=(0,index_esm.useValues)(heatmapLogic.X),{setDataUrl}=(0,index_esm.useActions)(heatmapLogic.X);return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)("div",{className:"flex-none md:flex justify-between items-end gap-2 w-full",children:(0,jsx_runtime.jsx)("div",{className:"flex gap-2 flex-1 min-w-0",children:(0,jsx_runtime.jsxs)("div",{className:"flex-1",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(src.HQ,{children:"Heatmap data URL"}),(0,jsx_runtime.jsx)("div",{className:"flex gap-2 justify-between",children:(0,jsx_runtime.jsx)(src.DF,{size:"small",placeholder:displayUrl?`Same as display URL: ${displayUrl}`:"Enter a URL",value:null!=dataUrl?dataUrl:"",onChange:value=>{setDataUrl(value||null)},fullWidth:!0})}),(0,jsx_runtime.jsx)("div",{className:"text-xs text-muted mt-1",children:"Add * for wildcards to aggregate data from multiple pages"})]}),isBrowserUrlAuthorized?null:(0,jsx_runtime.jsx)(HeatmapsForbiddenURL.A,{}),screenshotError&&(0,jsx_runtime.jsx)("div",{className:"mt-2",children:(0,jsx_runtime.jsx)(src.Vp,{type:"error",children:screenshotError})})]})})})})}var urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),SceneContent=__webpack_require__("../../frontend/src/layout/scenes/components/SceneContent.tsx"),SceneDivider=__webpack_require__("../../frontend/src/layout/scenes/components/SceneDivider.tsx"),SceneTitleSection=__webpack_require__("../../frontend/src/layout/scenes/components/SceneTitleSection.tsx");function HeatmapScene(_ref){let{id}=_ref,logicProps={id:id},logic=(0,heatmapLogic.X)(logicProps),{name,loading,type,displayUrl,widthOverride,screenshotUrl,generatingScreenshot,screenshotLoaded}=(0,index_esm.useValues)(logic),{setName,updateHeatmap,onIframeLoad,setScreenshotLoaded,exportHeatmap}=(0,index_esm.useActions)(logic);return loading?(0,jsx_runtime.jsx)(SceneContent._,{children:(0,jsx_runtime.jsx)(src.$j,{})}):(0,jsx_runtime.jsx)(index_esm.BindLogic,{logic:heatmapLogic.X,props:logicProps,children:(0,jsx_runtime.jsxs)(SceneContent._,{children:[(0,jsx_runtime.jsx)(SceneTitleSection.s,{name:name||"No name",resourceType:{type:"heatmap"},description:null,canEdit:!0,onNameChange:setName,forceBackTo:{name:"Heatmaps",path:urls.j.heatmaps(),key:"heatmaps"},actions:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(LemonButton.J,{type:"primary",onClick:updateHeatmap,size:"small",children:"Save"}),(0,jsx_runtime.jsxs)(LemonButton.J,{onClick:exportHeatmap,"data-attr":"export-heatmap",type:"secondary",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconDownload,{}),size:"small",tooltip:"Export heatmap as PNG",tooltipPlacement:"bottom",disabledReason:"screenshot"!==type||screenshotUrl?void 0:"Screenshot is not ready",children:["Export"," ",(0,jsx_runtime.jsx)(src.oe,{type:"warning",className:"ml-2",children:"BETA"})]})]})}),(0,jsx_runtime.jsx)(HeatmapHeader,{}),(0,jsx_runtime.jsx)(FilterPanel.h,{}),(0,jsx_runtime.jsx)(SceneDivider.V,{}),(0,jsx_runtime.jsxs)("div",{className:"border mx-auto bg-white rounded-lg",style:{width:null!=widthOverride?widthOverride:"100%"},children:[(0,jsx_runtime.jsxs)("div",{className:"p-2 border-b text-muted-foreground gap-x-2 flex items-center",children:[(0,jsx_runtime.jsx)(posthog_icons_es.IconBrowser,{})," ",displayUrl]}),"screenshot"===type?(0,jsx_runtime.jsx)("div",{className:"relative flex w-full justify-center flex-1",style:{width:null!=widthOverride?widthOverride:"100%"},children:generatingScreenshot?(0,jsx_runtime.jsxs)("div",{className:"flex-1 flex items-center justify-center min-h-96",children:[(0,jsx_runtime.jsx)("style",{children:"@keyframes hog-wobble{from{transform:rotate(0deg)}to{transform:rotate(5deg)}}"}),(0,jsx_runtime.jsxs)("div",{className:"text-sm text-center font-semibold",children:[(0,jsx_runtime.jsx)(hedgehogs.FilmCameraHog,{className:"w-32 h-32 mx-auto mb-2",style:{animation:"hog-wobble 1.2s ease-in-out infinite alternate",transformOrigin:"50% 50%"}}),"Taking screenshots of your page...",(0,jsx_runtime.jsx)("div",{className:"text-muted text-xs mt-2",children:"This usually takes a few minutes"}),(0,jsx_runtime.jsx)(LoadingBar.F,{})]})]}):screenshotUrl?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[screenshotLoaded&&(0,jsx_runtime.jsx)(HeatmapCanvas.F,{positioning:"absolute",widthOverride:widthOverride,context:"in-app"},null!=widthOverride?widthOverride:"auto"),(0,jsx_runtime.jsx)("img",{id:"heatmap-screenshot",src:screenshotUrl,style:{maxWidth:null!=widthOverride?widthOverride:"100%",height:"auto",display:"block"},onLoad:()=>{setScreenshotLoaded(!0)},className:"rounded-b-lg border-l border-r border-b",onError:()=>{console.error("Failed to load screenshot")}})]}):null}):(0,jsx_runtime.jsxs)("div",{className:"relative min-h-screen",children:[(0,jsx_runtime.jsx)(HeatmapCanvas.F,{positioning:"absolute",widthOverride:widthOverride,context:"in-app"}),(0,jsx_runtime.jsx)("iframe",{id:"heatmap-iframe",className:"min-h-screen bg-white rounded-b-lg",style:{width:null!=widthOverride?widthOverride:"100%"},src:displayUrl||"",onLoad:onIframeLoad,sandbox:"allow-scripts allow-same-origin",allow:""})]})]})]})})}}}]);