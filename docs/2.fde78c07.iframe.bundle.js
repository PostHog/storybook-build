(window.webpackJsonp=window.webpackJsonp||[]).push([[2,6,8,12],{"./frontend/src/scenes/apps/AppMetricsScene.tsx":function(C,_,e){"use strict";e.r(_),e.d(_,"scene",function(){return x}),e.d(_,"AppMetrics",function(){return D});var M=e("./node_modules/core-js/modules/es.function.name.js"),f=e.n(M),d=e("./node_modules/antd/es/tabs/index.js"),o=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),P=e("./frontend/src/lib/components/PageHeader.tsx"),v=e("./node_modules/kea/lib/index.esm.js"),l=e("./frontend/src/scenes/apps/MetricsTab.tsx"),L=e("./frontend/src/scenes/apps/HistoricalExportsTab.tsx"),E=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),u=e("./frontend/src/scenes/apps/ErrorDetailsModal.tsx"),p=e("./frontend/src/lib/components/Tooltip.tsx"),O=e("./frontend/src/lib/components/icons.tsx"),t=e("./node_modules/react/jsx-runtime.js"),s=e.n(t),x={component:D,logic:o.appMetricsSceneLogic,paramsToProps:function(i){var a,c=i.params.pluginConfigId;return{pluginConfigId:(a=parseInt(c))!==null&&a!==void 0?a:0}}};function D(){var n=Object(v.useValues)(o.appMetricsSceneLogic),i=n.activeTab,a=n.pluginConfig,c=n.pluginConfigLoading,r=n.showTab,j=Object(v.useActions)(o.appMetricsSceneLogic),b=j.setActiveTab;return Object(t.jsxs)("div",{children:[Object(t.jsx)(P.a,{title:a?a.plugin_info.name:Object(t.jsx)(E.a,{}),caption:"An overview of metrics and export for this app."}),c||!i?Object(t.jsx)(E.a,{}):Object(t.jsxs)(d.a,{tabPosition:"top",animated:!1,activeKey:i,onTabClick:function(T){return b(T)},children:[r(o.AppMetricsTab.ProcessEvent)&&Object(t.jsx)(d.a.TabPane,{tab:"processEvent metrics",children:Object(t.jsx)(l.MetricsTab,{tab:o.AppMetricsTab.ProcessEvent})},o.AppMetricsTab.ProcessEvent),r(o.AppMetricsTab.OnEvent)&&Object(t.jsx)(d.a.TabPane,{tab:"onEvent metrics",children:Object(t.jsx)(l.MetricsTab,{tab:o.AppMetricsTab.OnEvent})},o.AppMetricsTab.OnEvent),r(o.AppMetricsTab.ExportEvents)&&Object(t.jsx)(d.a.TabPane,{tab:"exportEvents metrics",children:Object(t.jsx)(l.MetricsTab,{tab:o.AppMetricsTab.ExportEvents})},o.AppMetricsTab.ExportEvents),r(o.AppMetricsTab.ScheduledTask)&&Object(t.jsx)(d.a.TabPane,{tab:Object(t.jsxs)(t.Fragment,{children:["Scheduled tasks"," ",Object(t.jsx)(p.a,{title:"Shows metrics for app methods `runEveryMinute`, `runEveryHour` and `runEveryDay`",children:Object(t.jsx)(O.IconInfo,{})})]}),children:Object(t.jsx)(l.MetricsTab,{tab:o.AppMetricsTab.ScheduledTask})},o.AppMetricsTab.ScheduledTask),r(o.AppMetricsTab.HistoricalExports)&&Object(t.jsx)(d.a.TabPane,{tab:"Historical exports",children:Object(t.jsx)(L.HistoricalExportsTab,{})},o.AppMetricsTab.HistoricalExports)]}),Object(t.jsx)(u.ErrorDetailsModal,{})]})}},"./frontend/src/scenes/apps/ErrorDetailsModal.tsx":function(C,_,e){"use strict";e.r(_),e.d(_,"ErrorDetailsModal",function(){return D});var M=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),f=e.n(M),d=e("./node_modules/react/index.js"),o=e.n(d),P=e("./node_modules/kea/lib/index.esm.js"),v=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),l=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),L=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),E=e("./frontend/src/lib/components/LemonLabel/LemonLabel.tsx"),u=e("./frontend/src/lib/components/LemonButton/index.ts"),p=e("./frontend/src/lib/components/icons.tsx"),O=e("./frontend/src/lib/components/LemonModal/index.ts"),t=e("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),s=e("./node_modules/react/jsx-runtime.js"),x=e.n(s);function D(){var i,a,c=Object(P.useValues)(v.appMetricsSceneLogic),r=c.errorDetails,j=c.errorDetailsModalError,b=c.errorDetailsLoading,g=Object(P.useActions)(v.appMetricsSceneLogic),T=g.closeErrorDetailsModal,R=Object(d.useState)(0),I=f()(R,2),A=I[0],h=I[1],m=r[A];return Object(s.jsx)(O.a,{isOpen:!!j,onClose:T,title:j,width:"min(50vw, 80rem)",description:Object(s.jsx)("span",{children:m==null||(i=m.error_details)===null||i===void 0||(a=i.error.message)===null||a===void 0?void 0:a.substring(0,200)}),footer:Object(s.jsx)("div",{className:"flex items-center justify-end gap-1 h-",children:b?Object(s.jsx)(l.a,{className:"1-10"}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)("span",{children:[A+1," of ",r.length," sample",r.length>1?"s":""]}),Object(s.jsx)(u.a,{icon:Object(s.jsx)(p.IconChevronLeft,{}),onClick:function(){return h(A-1)},disabled:A==0}),Object(s.jsx)(u.a,{icon:Object(s.jsx)(p.IconChevronRight,{}),onClick:function(){return h(A+1)},disabled:A==r.length-1})]})}),children:!j||b?Object(s.jsx)(l.a,{className:"h-10"}):Object(s.jsxs)("div",{className:"flex flex-col space-y-2",style:{height:"80vh"},children:[Object(s.jsxs)("div",{children:[Object(s.jsx)(E.a,{children:"When:"})," ",Object(s.jsx)(L.b,{time:m.timestamp,showSeconds:!0})]}),m.error_details.eventCount&&Object(s.jsxs)("div",{children:[Object(s.jsx)(E.a,{children:"Event Count"}),Object(s.jsx)("div",{children:m.error_details.eventCount})]}),m.error_details.error.message&&Object(s.jsx)(n,{title:"Error message",defaultIsExpanded:!0,children:Object(s.jsx)(t.a,{wrap:!0,language:t.b.JavaScript,children:m.error_details.error.message})}),m.error_details.event&&Object(s.jsx)(n,{title:"Event payload",defaultIsExpanded:!1,children:Object(s.jsx)(t.a,{wrap:!0,language:t.b.JSON,children:JSON.stringify(m.error_details.event,null,2)})}),m.error_details.error.stack&&Object(s.jsx)(n,{title:"Stack trace",defaultIsExpanded:!1,children:Object(s.jsx)(t.a,{wrap:!0,language:t.b.JavaScript,children:m.error_details.error.stack})})]})})}function n(i){var a=Object(d.useState)(i.defaultIsExpanded),c=f()(a,2),r=c[0],j=c[1];return Object(s.jsxs)("div",{className:"bg-mid border rounded",children:[Object(s.jsx)(u.a,{status:"stealth",fullWidth:!0,onClick:function(){return j(!r)},sideIcon:r?Object(s.jsx)(p.IconUnfoldLess,{}):Object(s.jsx)(p.IconUnfoldMore,{}),title:r?"Show less":"Show more",className:"bg-mid",children:i.title}),r&&Object(s.jsx)("div",{className:"bg-light p-2",children:i.children})]})}},"./frontend/src/scenes/apps/HistoricalExport.tsx":function(C,_,e){"use strict";e.r(_),e.d(_,"HistoricalExport",function(){return E});var M=e("./node_modules/antd/es/card/index.js"),f=e("./node_modules/kea/lib/index.esm.js"),d=e("./frontend/src/scenes/apps/AppMetricsGraph.tsx"),o=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),P=e("./frontend/src/scenes/apps/historicalExportLogic.ts"),v=e("./frontend/src/scenes/apps/MetricsTab.tsx"),l=e("./node_modules/react/jsx-runtime.js"),L=e.n(l);function E(u){var p,O,t,s,x,D=Object(f.useValues)(Object(P.historicalExportLogic)(u)),n=D.data,i=D.dataLoading;return Object(l.jsxs)("div",{className:"mt-4 mb-4 mr-8",children:[Object(l.jsx)(M.a,{title:"Overview",children:Object(l.jsx)(v.MetricsOverview,{tab:o.AppMetricsTab.HistoricalExports,metrics:(p=n==null?void 0:n.metrics)!==null&&p!==void 0?p:null,metricsLoading:i,exportDuration:n==null||(O=n.summary)===null||O===void 0?void 0:O.duration,exportFailureReason:n==null||(t=n.summary)===null||t===void 0?void 0:t.failure_reason})}),Object(l.jsx)(M.a,{title:"Delivery trends",className:"mt-4",children:Object(l.jsx)(d.AppMetricsGraph,{tab:o.AppMetricsTab.HistoricalExports,metrics:(s=n==null?void 0:n.metrics)!==null&&s!==void 0?s:null,metricsLoading:i})}),Object(l.jsx)(M.a,{title:"Errors",className:"mt-4",children:Object(l.jsx)(v.ErrorsOverview,{errors:(n==null?void 0:n.errors)||[],loading:i,category:"exportEvents",jobId:n==null||(x=n.summary)===null||x===void 0?void 0:x.job_id})})]})}try{E.displayName="HistoricalExport",E.__docgenInfo={description:"",displayName:"HistoricalExport",props:{pluginConfigId:{defaultValue:null,description:"",name:"pluginConfigId",required:!0,type:{name:"number"}},jobId:{defaultValue:null,description:"",name:"jobId",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/apps/HistoricalExport.tsx#HistoricalExport"]={docgenInfo:E.__docgenInfo,name:"HistoricalExport",path:"frontend/src/scenes/apps/HistoricalExport.tsx#HistoricalExport"})}catch(u){}},"./frontend/src/scenes/apps/HistoricalExportsTab.tsx":function(C,_,e){"use strict";e.r(_),e.d(_,"HistoricalExportsTab",function(){return s});var M=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),f=e.n(M),d=e("./node_modules/core-js/modules/es.array.concat.js"),o=e.n(d),P=e("./node_modules/kea/lib/index.esm.js"),v=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),l=e("./frontend/src/lib/components/LemonTable/index.ts"),L=e("./frontend/src/scenes/apps/HistoricalExport.tsx"),E=e("./frontend/src/lib/components/LemonTable/columnUtils.tsx"),u=e("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),p=e("./node_modules/antd/es/progress/index.js"),O=e("./node_modules/react/jsx-runtime.js"),t=e.n(O);function s(){var x=Object(P.useValues)(v.appMetricsSceneLogic),D=x.historicalExports,n=x.historicalExportsLoading,i=x.pluginConfig;return Object(O.jsx)(l.a,{dataSource:D,loading:n,columns:[{title:"Dates exported",render:function(c,r){var j=f()(r.payload.dateRange,2),b=j[0],g=j[1];return b===g?b:"".concat(b," - ").concat(g)}},{title:"Progress",width:130,render:function(c,r){switch(r.status){case"success":return Object(O.jsx)(u.a,{type:"success",className:"uppercase",children:"Success"});case"fail":return Object(O.jsx)(u.a,{type:"danger",className:"uppercase",children:"Failed"});case"not_finished":return Object(O.jsx)(p.a,{percent:Math.floor((r.progress||0)*100)})}},align:"right"},Object(E.b)(),Object(E.a)()],expandable:{expandedRowRender:function(c){if(!!i)return Object(O.jsx)(L.HistoricalExport,{pluginConfigId:i.id,jobId:c.job_id})}},useURLForSorting:!1,noSortingCancellation:!0})}},"./frontend/src/scenes/apps/historicalExportLogic.ts":function(C,_,e){"use strict";e.r(_),e.d(_,"historicalExportLogic",function(){return i});var M=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),f=e.n(M),d=e("./node_modules/@babel/runtime/regenerator/index.js"),o=e.n(d),P=e("./node_modules/core-js/modules/es.array.concat.js"),v=e.n(P),l=e("./node_modules/core-js/modules/es.array.iterator.js"),L=e.n(l),E=e("./node_modules/core-js/modules/es.object.to-string.js"),u=e.n(E),p=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),O=e.n(p),t=e("./node_modules/kea/lib/index.esm.js"),s=e("./node_modules/kea-loaders/lib/index.js"),x=e.n(s),D=e("./frontend/src/lib/api.ts"),n=e("./frontend/src/scenes/teamLogic.tsx"),i=Object(t.kea)([Object(t.path)(["scenes","apps","historicalExportLogic"]),Object(t.props)({}),Object(t.key)(function(a){var c=a.pluginConfigId,r=a.jobId;return"".concat(c,"_").concat(r)}),Object(s.loaders)(function(a){var c=a.props;return{data:[null,{loadExportData:function(){var r=f()(o.a.mark(function b(){return o.a.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,D.b.get("api/projects/".concat(n.a.values.currentTeamId,"/app_metrics/").concat(c.pluginConfigId,"/historical_exports/").concat(c.jobId));case 2:return T.abrupt("return",T.sent);case 3:case"end":return T.stop()}},b)}));function j(){return r.apply(this,arguments)}return j}()}]}}),Object(t.events)(function(a){var c=a.actions;return{afterMount:c.loadExportData}})])}}]);
