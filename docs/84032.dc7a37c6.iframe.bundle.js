"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[84032],{"../../products/session_summaries/frontend/SessionGroupSummariesTable.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{SessionGroupSummariesTable:()=>SessionGroupSummariesTable,scene:()=>scene});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.35.2_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),MemberSelect=__webpack_require__("../../frontend/src/lib/components/MemberSelect.tsx"),useOnMountEffect=__webpack_require__("../../frontend/src/lib/hooks/useOnMountEffect.ts"),LemonMenu=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonMenu/index.ts"),LemonTable=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/index.ts"),columnUtils=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/columnUtils.tsx"),Link=__webpack_require__("../../frontend/src/lib/lemon-ui/Link/index.ts"),sceneTypes=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),scenes=__webpack_require__("../../frontend/src/scenes/scenes.ts"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),SceneContent=__webpack_require__("../../frontend/src/layout/scenes/components/SceneContent.tsx"),SceneTitleSection=__webpack_require__("../../frontend/src/layout/scenes/components/SceneTitleSection.tsx"),lib=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.7_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),api=__webpack_require__("../../frontend/src/lib/api.ts"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx");let DEFAULT_FILTERS={search:"",createdBy:null},DEFAULT_SORTING={columnKey:"-created_at",order:1},sessionGroupSummariesTableLogic=(0,index_esm.kea)([(0,index_esm.path)(["products","session_summaries","frontend","sessionGroupSummariesTableLogic"]),(0,index_esm.connect)({}),(0,index_esm.actions)({loadSessionGroupSummaries:!0,setFilters:filters=>({filters}),tableSortingChanged:sorting=>({sorting}),setPage:page=>({page}),deleteSessionGroupSummary:id=>({id})}),(0,index_esm.reducers)({filters:[DEFAULT_FILTERS,{setFilters:(state,_ref)=>{let{filters}=_ref;return(0,utils.hO)({...state,...filters})}}],page:[1,{setPage:(_,_ref2)=>{let{page}=_ref2;return page},setFilters:()=>1,tableSortingChanged:()=>1}],tableSorting:[DEFAULT_SORTING,{persist:!0},{tableSortingChanged:(_,_ref3)=>{let{sorting}=_ref3;return sorting||DEFAULT_SORTING}}]}),(0,lib.loaders)(_ref4=>{let{values}=_ref4;return{sessionGroupSummariesResponse:[null,{loadSessionGroupSummaries:async(_,breakpoint)=>{await breakpoint(100);let createdByForQuery=values.filters?.createdBy===DEFAULT_FILTERS.createdBy?void 0:values.filters?.createdBy,sortKey=values.tableSorting.columnKey||"-created_at",res=await api.ZP.sessionGroupSummaries.list({created_by:null!=createdByForQuery?createdByForQuery:void 0,search:values.filters?.search||void 0,order:sortKey,limit:50,offset:(values.page-1)*50});return breakpoint(),res},deleteSessionGroupSummary:async _ref5=>{let{id}=_ref5;return await api.ZP.sessionGroupSummaries.delete(id),null}}]}}),(0,index_esm.listeners)(_ref6=>{let{actions}=_ref6;return{setFilters:()=>actions.loadSessionGroupSummaries(),tableSortingChanged:()=>actions.loadSessionGroupSummaries(),setPage:()=>actions.loadSessionGroupSummaries(),deleteSessionGroupSummarySuccess:()=>actions.loadSessionGroupSummaries()}}),(0,index_esm.selectors)(_ref7=>{let{actions}=_ref7;return{sessionGroupSummaries:[s=>[s.sessionGroupSummariesResponse],sessionGroupSummariesResponse=>sessionGroupSummariesResponse?.results||[]],pagination:[s=>[s.page,s.sessionGroupSummariesResponse],(page,sessionGroupSummariesResponse)=>{var _sessionGroupSummarie;return{controlled:!0,pageSize:50,currentPage:page,entryCount:null!==(_sessionGroupSummarie=sessionGroupSummariesResponse?.count)&&void 0!==_sessionGroupSummarie?_sessionGroupSummarie:0,onBackward:()=>actions.setPage(page-1),onForward:()=>actions.setPage(page+1)}}]}}),(0,index_esm.selectors)({breadcrumbs:[()=>[],()=>[{key:"session-group-summaries",name:"Session summaries",iconType:"insight/hog"}]]})]);var jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let scene={component:SessionGroupSummariesTable};function titleColumn(){return{title:"Title",dataIndex:"title",width:"100%",render:function Render(title,_ref){let{id}=_ref;return(0,jsx_runtime.jsx)(Link.r,{"data-attr":"session-group-summary-title",to:urls.j.sessionSummary(id),className:"font-semibold",children:title||"Untitled"})},sorter:!0}}function sessionCountColumn(){return{title:"Sessions",dataIndex:"session_count",render:function Render(session_count){return session_count},sorter:!0}}function SessionGroupSummariesTable(){let{filters,sessionGroupSummariesResponseLoading,tableSorting,pagination,sessionGroupSummaries}=(0,index_esm.useValues)(sessionGroupSummariesTableLogic),{loadSessionGroupSummaries,setFilters,tableSortingChanged,deleteSessionGroupSummary}=(0,index_esm.useActions)(sessionGroupSummariesTableLogic);(0,useOnMountEffect.x)(loadSessionGroupSummaries);let columns=[titleColumn(),sessionCountColumn(),(0,columnUtils.JB)(),(0,columnUtils.pD)("created_at","Created"),{render:function Render(_,summary){return(0,jsx_runtime.jsx)(LemonMenu.d,{items:[{label:"Delete",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconTrash,{}),status:"danger",onClick:()=>{deleteSessionGroupSummary(summary.id)}}],children:(0,jsx_runtime.jsx)(src.Jp,{"aria-label":"more",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconEllipsis,{}),size:"small"})})}}],config=scenes.lc[sceneTypes.x.SessionGroupSummariesTable];return(0,jsx_runtime.jsxs)(SceneContent._,{children:[(0,jsx_runtime.jsx)(SceneTitleSection.s,{name:config.name,description:config.description,resourceType:{type:config.iconType||"notebook"},actions:(0,jsx_runtime.jsx)(src.oe,{type:"warning",children:"BETA"})}),(0,jsx_runtime.jsxs)("div",{className:"deprecated-space-y-4",children:[(0,jsx_runtime.jsxs)("div",{className:"flex justify-between gap-2 flex-wrap",children:[(0,jsx_runtime.jsx)(src.DF,{type:"search",placeholder:"Search for summaries",onChange:s=>{setFilters({search:s})},value:filters.search,"data-attr":"session-group-summaries-search"}),(0,jsx_runtime.jsx)("div",{className:"flex items-center gap-4 flex-wrap",children:(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)("span",{children:"Created by:"}),(0,jsx_runtime.jsx)(MemberSelect.a,{value:filters.createdBy,onChange:user=>setFilters({createdBy:user?.uuid||null})})]})})]}),(0,jsx_runtime.jsx)(LemonTable.g,{"data-attr":"session-group-summaries-table",pagination:pagination,dataSource:sessionGroupSummaries,rowKey:"id",columns:columns,loading:sessionGroupSummariesResponseLoading,defaultSorting:tableSorting,emptyState:"No session group summaries matching your filters!",nouns:["summary","summaries"],onSort:tableSortingChanged})]})]})}}}]);