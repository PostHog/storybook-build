(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"./frontend/src/scenes/session-recordings/SessionRecordingsTable.tsx":function(H,h,e){"use strict";e.d(h,"a",function(){return M});var K=e("./node_modules/react/index.js"),o=e.n(K),C=e("./node_modules/kea/lib/index.esm.js"),ue=e("./frontend/src/lib/utils.tsx"),L=e("./node_modules/antd/es/button/index.js"),I=e("./node_modules/antd/es/row/index.js"),B=e("./node_modules/antd/es/typography/index.js"),me=e("./frontend/src/scenes/session-recordings/sessionRecordingsTableLogic.ts"),k=e("./node_modules/@ant-design/icons/es/icons/PlayCircleOutlined.js"),q=e("./node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),ee=e("./node_modules/@ant-design/icons/es/icons/CalendarOutlined.js"),fe=e("./frontend/src/scenes/session-recordings/SessionPlayerDrawer.tsx"),te=e("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilter.tsx"),W=e("./node_modules/@ant-design/icons/es/icons/LeftOutlined.js"),ne=e("./node_modules/@ant-design/icons/es/icons/RightOutlined.js"),A=e("./frontend/src/types.ts"),se=e("./node_modules/antd/es/space/index.js"),re=e("./frontend/src/lib/components/PropertyFilters/components/OperatorValueSelect.tsx"),oe=e("./frontend/src/lib/components/Popup/Popup.tsx"),ae=e("./node_modules/core-js/modules/es.array.slice.js"),ge=e("./node_modules/core-js/modules/es.array.iterator.js"),De=e("./node_modules/core-js/modules/es.object.to-string.js"),pe=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),ie=e("./frontend/src/lib/components/DurationPicker/DurationPicker.tsx"),Q;(function(l){l.SECONDS="seconds",l.MINUTES="minutes",l.HOURS="hours"})(Q||(Q={}));var ve=Object(C.kea)({path:function(d){return["scenes","session-recordings","DurationFilterLogic",d]},key:function(d){return d.pageKey||"global"},props:{},actions:{setValue:function(d){return{value:d}},setIsOpen:function(d){return{isOpen:d}},setOperator:function(d){return{operator:d}}},reducers:function(d){var u,c,s=d.props;return{operator:[s==null||(u=s.initialFilter)===null||u===void 0?void 0:u.operator,{setOperator:function(r,t){var a=t.operator;return a}}],value:[s==null||(c=s.initialFilter)===null||c===void 0?void 0:c.value,{setValue:function(r,t){var a=t.value;return a}}],isOpen:[!1,{setIsOpen:function(r,t){var a=t.isOpen;return a}}]}},selectors:{durationString:[function(l){return[l.operator,l.value]},function(l,d){var u="";l===A.J.GreaterThan?u+="> ":u+="< ";var c=Object(ie.b)(d||0);return u+=c.timeValue||0,c.timeValue===1?u+=" "+c.unit.slice(0,-1):u+=" "+c.unit,u}]},listeners:function(d){var u=d.props,c=d.values,s=function(r){var t=r.value,a=r.operator;u.onChange({operator:a||c.operator,value:t||c.value||0,type:"recording",key:"duration"})};return{setValue:function(r){var t=r.value;return s({value:t})},setOperator:function(r){var t=r.operator;return s({operator:t})}}}});function U(l){var d=l.initialFilter,u=l.onChange,c=l.pageKey,s=ve({initialFilter:d,onChange:u,pageKey:c}),n=Object(C.useActions)(s),r=n.setValue,t=n.setIsOpen,a=n.setOperator,f=Object(C.useValues)(s),_=f.durationString,P=f.value,y=f.operator,D=f.isOpen;return o.a.createElement(oe.a,{visible:D,placement:"bottom-end",fallbackPlacements:["bottom-start"],onClickOutside:function(){return t(!1)},overlay:o.a.createElement(I.a,null,o.a.createElement(se.b,null,o.a.createElement(re.a,{operator:y,operators:[A.J.GreaterThan,A.J.LessThan],onChange:function(O){a(O)}}),o.a.createElement(ie.a,{onChange:r,initialValue:P||0})))},o.a.createElement(L.a,{onClick:function(){t(!0)}},_))}try{U.displayName="DurationFilter",U.__docgenInfo={description:"",displayName:"DurationFilter",props:{initialFilter:{defaultValue:null,description:"",name:"initialFilter",required:!0,type:{name:"RecordingDurationFilter"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: RecordingDurationFilter) => void"}},pageKey:{defaultValue:null,description:"",name:"pageKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/session-recordings/DurationFilter.tsx#DurationFilter"]={docgenInfo:U.__docgenInfo,name:"DurationFilter",path:"frontend/src/scenes/session-recordings/DurationFilter.tsx#DurationFilter"})}catch(l){}var _e=e("./frontend/src/scenes/persons/PersonHeader.tsx"),S=e("./frontend/src/lib/utils/eventUsageLogic.ts"),ye=e("./frontend/src/lib/components/DateFilter/DateFilter.tsx"),X=e("./frontend/src/lib/components/Tooltip.tsx"),j=e("./frontend/src/lib/components/TaxonomicFilter/types.ts"),le=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),Z=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),N=e.n(Z),Ee=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/session-recordings/SessionRecordingTable.scss"),V=e.n(Ee),Y={};Y.insert="head",Y.singleton=!1;var G=N()(V.a,Y),Pe=V.a.locals||{},de=e("./frontend/src/lib/components/LemonTable/index.ts"),ce=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),w=e("./frontend/src/lib/components/icons.tsx"),E=e("./frontend/src/lib/components/LemonButton/index.ts"),J=e("./frontend/src/scenes/insights/filters/ActionFilter/ActionFilterRow/ActionFilterRow.tsx");function M(l){var d=l.personUUID,u=l.isPersonPage,c=u===void 0?!1:u,s=Object(me.a)({personUUID:d}),n=Object(C.useValues)(s),r=n.sessionRecordings,t=n.sessionRecordingsResponseLoading,a=n.sessionRecordingId,f=n.entityFilters,_=n.propertyFilters,P=n.hasNext,y=n.hasPrev,D=n.fromDate,p=n.toDate,O=n.durationFilter,b=n.showFilters,i=Object(C.useActions)(s),T=i.openSessionPlayer,F=i.closeSessionPlayer,x=i.setEntityFilters,g=i.setPropertyFilters,z=i.loadNext,Oe=i.loadPrev,Re=i.setDateRange,je=i.setDurationFilter,be=i.enableFilter,$=i.reportRecordingsListFilterAdded,Te=[{title:"Start time",render:function(m,R){return o.a.createElement(ce.b,{time:R.start_time,formatDate:"MMMM DD, YYYY",formatTime:"h:mm A"})}},{title:"Duration",render:function(m,R){return o.a.createElement("span",null,Object(ue.N)(R.recording_duration))}},{title:"Person",key:"person",render:function(m,R){return o.a.createElement(_e.a,{withIcon:!0,person:R.person})}},{render:function(m,R){return o.a.createElement("div",{className:"play-button-container"},o.a.createElement(L.a,{className:R.viewed?"play-button viewed":"play-button","data-attr":"session-recordings-button",icon:o.a.createElement(k.a,null)},"Watch recording"))}}];return o.a.createElement("div",{className:"session-recordings-table","data-attr":"session-recordings-table"},o.a.createElement(I.a,{className:"filter-row"},o.a.createElement("div",{className:"filter-container",style:{display:b?void 0:"none"}},o.a.createElement("div",{className:"space-y-2"},o.a.createElement(B.a.Text,{strong:!0},"Filter by events and actions ",o.a.createElement(X.a,{title:"Show recordings where all of the events or actions listed below happen."},o.a.createElement(q.a,{className:"info-icon"}))),o.a.createElement(te.a,{bordered:!0,filters:f,setFilters:function(m){$(S.e.EventAndAction),x(m)},typeKey:c?"person-".concat(d):"session-recordings",mathAvailability:J.b.None,buttonCopy:"Add filter",hideRename:!0,hideDuplicate:!0,showNestedArrow:!1,actionsTaxonomicGroupTypes:[j.a.Actions,j.a.Events],propertiesTaxonomicGroupTypes:[j.a.EventProperties,j.a.EventFeatureFlags,j.a.Elements]})),!c&&o.a.createElement("div",{className:"mt-8 space-y-2"},o.a.createElement(B.a.Text,{strong:!0},"Filter by persons and cohorts ",o.a.createElement(X.a,{title:"Show recordings by persons who match the set criteria"},o.a.createElement(q.a,{className:"info-icon"}))),o.a.createElement(le.a,{pageKey:c?"person-".concat(d):"session-recordings",taxonomicGroupTypes:[j.a.PersonProperties,j.a.Cohorts],propertyFilters:_,onChange:function(m){$(S.e.PersonAndCohort),g(m)}}))),!b&&o.a.createElement(E.a,{type:"secondary",size:"small",icon:o.a.createElement(w.IconFilter,null),onClick:function(){if(be(),c){var m=document.querySelectorAll(".entity-filter-row button");m.length>0&&m[0].click()}}},"Filter recordings"),o.a.createElement(I.a,{className:"time-filter-row"},o.a.createElement(I.a,{className:"time-filter"},o.a.createElement(ye.a,{makeLabel:function(m){return o.a.createElement(o.a.Fragment,null,o.a.createElement(ee.a,null),o.a.createElement("span",null," ",m))},defaultValue:"Last 7 days",dateFrom:D!=null?D:void 0,dateTo:p!=null?p:void 0,onChange:function(m,R){$(S.e.DateRange),Re(m,R)},dateOptions:[{key:"Custom",values:[]},{key:"Last 24 hours",values:["-24h"]},{key:"Last 7 days",values:["-7d"]},{key:"Last 21 days",values:["-21d"]}]})),o.a.createElement(I.a,{className:"time-filter"},o.a.createElement(B.a.Text,{className:"filter-label"},"Duration"),o.a.createElement(U,{onChange:function(m){$(S.e.Duration),je(m)},initialFilter:O,pageKey:c?"person-".concat(d):"session-recordings"})))),o.a.createElement(de.a,{dataSource:r,columns:Te,loading:t,onRow:function(m){return{onClick:function(Fe){Fe.target.closest("a")||T(m.id,S.d.RecordingsList)}}},rowClassName:"cursor-pointer","data-attr":"session-recording-table","data-tooltip":"session-recording-table",emptyState:"No matching recordings found"}),(y||P)&&o.a.createElement(I.a,{className:"pagination-control"},o.a.createElement(L.a,{type:"link",disabled:!y,onClick:function(){Oe(),window.scrollTo(0,0)}},o.a.createElement(W.a,null)," Previous"),o.a.createElement(L.a,{type:"link",disabled:!P,onClick:function(){z(),window.scrollTo(0,0)}},"Next ",o.a.createElement(ne.a,null))),o.a.createElement("div",{style:{marginBottom:64}}),!!a&&o.a.createElement(fe.a,{isPersonPage:c,onClose:F}))}try{M.displayName="SessionRecordingsTable",M.__docgenInfo={description:"",displayName:"SessionRecordingsTable",props:{personUUID:{defaultValue:null,description:"",name:"personUUID",required:!1,type:{name:"string"}},isPersonPage:{defaultValue:{value:"false"},description:"",name:"isPersonPage",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/session-recordings/SessionRecordingsTable.tsx#SessionRecordingsTable"]={docgenInfo:M.__docgenInfo,name:"SessionRecordingsTable",path:"frontend/src/scenes/session-recordings/SessionRecordingsTable.tsx#SessionRecordingsTable"})}catch(l){}},"./frontend/src/scenes/session-recordings/sessionRecordingsTableLogic.ts":function(H,h,e){"use strict";e.d(h,"a",function(){return c});var K=e("./node_modules/core-js/modules/es.object.keys.js"),o=e.n(K),C=e("./node_modules/core-js/modules/es.symbol.js"),ue=e.n(C),L=e("./node_modules/core-js/modules/es.array.filter.js"),I=e.n(L),B=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),me=e.n(B),k=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),q=e.n(k),ee=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),fe=e.n(ee),te=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),W=e.n(te),ne=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),A=e.n(ne),se=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),re=e.n(se),oe=e("./node_modules/@babel/runtime/regenerator/index.js"),ae=e.n(oe),ge=e("./node_modules/core-js/modules/es.array.iterator.js"),De=e.n(ge),pe=e("./node_modules/core-js/modules/es.object.to-string.js"),ie=e.n(pe),Q=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),ve=e.n(Q),U=e("./node_modules/core-js/modules/es.array.concat.js"),_e=e.n(U),S=e("./node_modules/core-js/modules/es.array.map.js"),ye=e.n(S),X=e("./node_modules/kea/lib/index.esm.js"),j=e("./frontend/src/lib/api.ts"),le=e("./frontend/src/lib/utils.tsx"),Z=e("./frontend/src/types.ts"),N=e("./node_modules/kea-router/lib/index.js"),Ee=e.n(N),V=e("./frontend/src/lib/utils/eventUsageLogic.ts"),Y=e("./node_modules/fast-deep-equal/index.js"),G=e.n(Y),Pe=e("./frontend/src/scenes/teamLogic.tsx"),de=e("./frontend/src/lib/dayjs.ts"),ce=e("./frontend/src/lib/utils/getAppContext.ts");function w(s,n){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(s);n&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,t)}return r}function E(s){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?w(Object(r),!0).forEach(function(t){A()(s,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach(function(t){Object.defineProperty(s,t,Object.getOwnPropertyDescriptor(r,t))})}return s}var J=50,M={type:"recording",key:"duration",value:60,operator:Z.J.GreaterThan},l=[],d=Object(ce.b)(),u={events:[],actions:[],new_entity:[{id:d,type:Z.o.EVENTS,order:0,name:d}]},c=Object(X.kea)({path:function(n){return["scenes","session-recordings","sessionRecordingsTableLogic",n]},key:function(n){return n.key||n.personUUID||"global"},props:{},connect:{values:[Pe.a,["currentTeamId"]],actions:[V.f,["reportRecordingsListFetched","reportRecordingsListFilterAdded"]]},actions:{getSessionRecordings:!0,openSessionPlayer:function(n,r){return{sessionRecordingId:n,source:r}},closeSessionPlayer:!0,setEntityFilters:function(n){return{filters:n}},setPropertyFilters:function(n){return{filters:n}},loadNext:!0,loadPrev:!0,enableFilter:!0,setOffset:function(n){return{offset:n}},setDateRange:function(n,r){return{incomingFromDate:n,incomingToDate:r}},setDurationFilter:function(n){return{durationFilter:n}}},loaders:function(n){var r=n.props,t=n.values,a=n.actions;return{sessionRecordingsResponse:[{results:[],has_next:!1},{getSessionRecordings:function(){var f=re()(ae.a.mark(function P(y,D){var p,O,b,i,T,F;return ae.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return O=E(E({},t.filterQueryParams),{},{person_uuid:(p=r.personUUID)!==null&&p!==void 0?p:"",limit:J}),b=Object(le.Cb)(O),g.next=4,D(100);case 4:return i=performance.now(),g.next=7,j.b.get("api/projects/".concat(t.currentTeamId,"/session_recordings?").concat(b));case 7:return T=g.sent,F=performance.now()-i,a.reportRecordingsListFetched(F),D(),g.abrupt("return",T);case 12:case"end":return g.stop()}},P)}));function _(P,y){return f.apply(this,arguments)}return _}()}]}},events:function(n){var r=n.actions;return{afterMount:function(){r.getSessionRecordings()}}},reducers:{filterEnabled:[!1,{enableFilter:function(){return!0}}],sessionRecordings:[[],{getSessionRecordingsSuccess:function(n,r){var t=r.sessionRecordingsResponse;return W()(t.results)},openSessionPlayer:function(n,r){var t=r.sessionRecordingId;return W()(n.map(function(a){return a.id===t?E(E({},a),{},{viewed:!0}):E({},a)}))}}],sessionRecordingId:[null,{openSessionPlayer:function(n,r){var t=r.sessionRecordingId;return t},closeSessionPlayer:function(){return null}}],entityFilters:[u,{setEntityFilters:function(n,r){var t=r.filters;return E({},t)}}],propertyFilters:[l,{setPropertyFilters:function(n,r){var t=r.filters;return W()(t)}}],durationFilter:[M,{setDurationFilter:function(n,r){var t=r.durationFilter;return t}}],offset:[0,{loadNext:function(n){return n+J},loadPrev:function(n){return Math.max(n-J)},setOffset:function(n,r){var t=r.offset;return t}}],fromDate:[Object(de.a)().subtract(21,"days").format("YYYY-MM-DD"),{setDateRange:function(n,r){var t=r.incomingFromDate;return t!=null?t:null}}],toDate:[null,{setDateRange:function(n,r){var t=r.incomingToDate;return t!=null?t:null}}]},listeners:function(n){var r=n.actions;return{setEntityFilters:function(){r.getSessionRecordings()},setPropertyFilters:function(){r.getSessionRecordings()},setDateRange:function(){r.getSessionRecordings()},setDurationFilter:function(){r.getSessionRecordings()},loadNext:function(){r.getSessionRecordings()},loadPrev:function(){r.getSessionRecordings()}}},selectors:{hasPrev:[function(s){return[s.offset]},function(s){return s>0}],hasNext:[function(s){return[s.sessionRecordingsResponse]},function(s){return s.has_next}],showFilters:[function(s){return[s.filterEnabled,s.entityFilters,s.propertyFilters]},function(s,n,r){return s||n!==u||r!==l}],filterQueryParams:[function(s){return[s.entityFilters,s.fromDate,s.toDate,s.offset,s.durationFilter,s.propertyFilters]},function(s,n,r,t,a,f){return{actions:s.actions,events:s.events,properties:f,date_from:n,date_to:r,offset:t,session_recording_duration:a}}]},actionToUrl:function(n){var r=n.values,t=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=arguments.length>1?arguments[1]:void 0,P=E({filters:r.filterQueryParams},f),y=E({},N.router.values.hashParams);return r.sessionRecordingId?y.sessionRecordingId=r.sessionRecordingId:delete y.sessionRecordingId,[N.router.values.location.pathname,P,y,{replace:_}]};return{loadSessionRecordings:function(){return t({},!0)},openSessionPlayer:function(f){var _=f.source;return t({source:_},!1)},closeSessionPlayer:function(){return t({},!1)},setEntityFilters:function(){return t({},!0)},setPropertyFilters:function(){return t({},!0)},setDateRange:function(){return t({},!0)},setDurationFilter:function(){return t({},!0)},loadNext:function(){return t({},!0)},loadPrev:function(){return t({},!0)}}},urlToAction:function(n){var r=n.actions,t=n.values,a=n.props,f=function(y,D,p){var O,b=(O=p.sessionRecordingId)!==null&&O!==void 0?O:null;b!==t.sessionRecordingId&&r.openSessionPlayer(b,V.d.Direct);var i=D.filters;if(i){if((!G()(i.actions,t.entityFilters.actions)||!G()(i.events,t.entityFilters.events))&&r.setEntityFilters({events:i.events||[],actions:i.actions||[]}),!G()(i.properties,t.propertyFilters)){var T;r.setPropertyFilters((T=i.properties)!==null&&T!==void 0?T:[])}if(i.date_from!==t.fromDate||i.date_to!==t.toDate){var F,x;r.setDateRange((F=i.date_from)!==null&&F!==void 0?F:void 0,(x=i.date_to)!==null&&x!==void 0?x:void 0)}if(i.offset!==t.offset){var g;r.setOffset((g=i.offset)!==null&&g!==void 0?g:0)}if(!G()(i.session_recording_duration,t.durationFilter)){var z;r.setDurationFilter((z=i.session_recording_duration)!==null&&z!==void 0?z:M)}}},_=a.personUUID?"/person/*":"/recordings";return A()({},_,f)}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/session-recordings/SessionRecordingTable.scss":function(H,h,e){var K=e("./node_modules/css-loader/dist/runtime/api.js");h=K(!1),h.push([H.i,".session-recordings-table .filter-row{width:100%;justify-content:space-between;margin-bottom:1rem;align-items:flex-end}.session-recordings-table .filter-container{max-width:700px;padding:1rem;border:1px solid var(--border);flex:1;border-radius:var(--radius)}.session-recordings-table .filter-section{padding-bottom:1rem}.session-recordings-table .session-recording-action-property-filter{margin:0 0 0 68px;background-color:var(--antd-table-background-dark);border-top-width:1px;border:1px solid var(--border);border-top:0 solid var(--border);padding:.25rem 1rem}.session-recordings-table .time-filter-row{justify-content:flex-end;align-items:flex-end}.session-recordings-table .time-filter-row .time-filter{align-items:center;margin-left:1rem}.session-recordings-table .time-filter-row .time-filter .filter-label{margin-right:4px}.session-recordings-table .pagination-control{margin:1rem;justify-content:center}.session-recordings-table .entity-filter-row{width:100%;padding:1rem;border:1px solid var(--border);margin-top:1rem;border-radius:var(--radius)}.session-recordings-table .play-button-container{display:flex;justify-content:flex-end}.session-recordings-table .play-button-container .play-button .anticon-play-circle{color:var(--primary)}.session-recordings-table .play-button-container .play-button.viewed .anticon-play-circle{color:var(--muted)}.session-recordings-table .info-icon{color:var(--primary)}",""]),H.exports=h}}]);
