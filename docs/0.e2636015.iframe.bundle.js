(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"./frontend/src/scenes/actions/EventName.tsx":function(ue,U,e){"use strict";e.d(U,"a",function(){return z}),e.d(U,"b",function(){return j});var q=e("./node_modules/react/index.js"),ee=e.n(q),H=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),ce=e("./frontend/src/lib/components/TaxonomicPopup/TaxonomicPopup.tsx"),te=e("./frontend/src/lib/components/TaxonomicFilter/types.ts");function z(R){var G=R.value,ne=R.onChange;return ee.a.createElement(ce.c,{groupType:te.a.Events,onChange:ne,value:G,type:"secondary",style:{maxWidth:"24rem"},placeholder:"Choose an event",dataAttr:"event-name-box",renderValue:function(w){return ee.a.createElement(H.a,{value:w,disablePopover:!0})},allowClear:!0})}function j(R){var G=R.value,ne=R.onChange;return ee.a.createElement(ce.a,{groupType:te.a.Events,onChange:ne,value:G,type:"secondary",placeholder:"Select an event",dataAttr:"event-name-box",renderValue:function(w){return ee.a.createElement(H.a,{value:w,disablePopover:!0})},allowClear:!0})}try{z.displayName="EventName",z.__docgenInfo={description:"",displayName:"EventName",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/actions/EventName.tsx#EventName"]={docgenInfo:z.__docgenInfo,name:"EventName",path:"frontend/src/scenes/actions/EventName.tsx#EventName"})}catch(R){}try{j.displayName="LemonEventName",j.__docgenInfo={description:"",displayName:"LemonEventName",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/actions/EventName.tsx#LemonEventName"]={docgenInfo:j.__docgenInfo,name:"LemonEventName",path:"frontend/src/scenes/actions/EventName.tsx#LemonEventName"})}catch(R){}},"./frontend/src/scenes/events/EventDetails.tsx":function(ue,U,e){"use strict";e.d(U,"a",function(){return b});var q=e("./node_modules/core-js/modules/es.object.keys.js"),ee=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),H=e.n(ee),ce=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),te=e.n(ce),z=e("./node_modules/react/index.js"),j=e.n(z),R=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),G=e("./frontend/src/lib/components/PropertiesTable.tsx"),ne=e("./frontend/src/scenes/events/EventElements.tsx"),$=e("./node_modules/antd/es/tabs/index.js"),w=e("./node_modules/antd/es/button/index.js"),o=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),se=e.n(o),oe=e("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),de=e("./frontend/src/lib/utils.tsx");function ae(m,l){var d=Object.keys(m);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(m);l&&(i=i.filter(function(h){return Object.getOwnPropertyDescriptor(m,h).enumerable})),d.push.apply(d,i)}return d}function le(m){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?ae(Object(d),!0).forEach(function(i){H()(m,i,d[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(d)):ae(Object(d)).forEach(function(i){Object.defineProperty(m,i,Object.getOwnPropertyDescriptor(d,i))})}return m}function Q(m){var l=m.event,d=l.event,i=l.id,h=l.uuid,I=l.distinct_id,Y=l.properties,g=l.elements,J=l.timestamp,V=l.person,L=se()(l,["event","id","uuid","distinct_id","properties","elements","timestamp","person"]),B=le(le(le(le({},i?{id:i}:null),h?{uuid:h}:null),{},{timestamp:J,event:d,distinct_id:I,properties:Object(de.vb)(Y)},g&&g.length>0?{elements:g}:null),L);return j.a.createElement(oe.a,{language:oe.b.JSON},JSON.stringify(B,null,4))}try{Q.displayName="EventJSON",Q.__docgenInfo={description:"",displayName:"EventJSON",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"Record<string, any>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventJSON.tsx#EventJSON"]={docgenInfo:Q.__docgenInfo,name:"EventJSON",path:"frontend/src/scenes/events/EventJSON.tsx#EventJSON"})}catch(m){}var ve=e("./frontend/src/lib/dayjs.ts");function ie(m,l){var d=Object.keys(m);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(m);l&&(i=i.filter(function(h){return Object.getOwnPropertyDescriptor(m,h).enumerable})),d.push.apply(d,i)}return d}function X(m){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?ie(Object(d),!0).forEach(function(i){H()(m,i,d[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(d)):ie(Object(d)).forEach(function(i){Object.defineProperty(m,i,Object.getOwnPropertyDescriptor(d,i))})}return m}var re=$.a.TabPane;function b(m){for(var l=m.event,d=Object(z.useState)(!1),i=te()(d,2),h=i[0],I=i[1],Y={},g={},J=0,V=0,L=Object.keys(l.properties);V<L.length;V++){var B=L[V];R.d.event[B]&&R.d.event[B].hide&&(J+=1,h&&(g[B]=l.properties[B])),(!R.d.event[B]||!R.d.event[B].hide)&&(Y[B]=l.properties[B])}return j.a.createElement($.a,{"data-attr":"event-details",defaultActiveKey:"properties",style:{float:"left",width:"100%"},tabBarStyle:{margin:0}},j.a.createElement(re,{tab:"Properties",key:"properties"},j.a.createElement(G.a,{properties:X(X({$timestamp:Object(ve.a)(l.timestamp).toISOString()},Y),g),useDetectedPropertyType:!0}),J>0&&j.a.createElement("small",null,j.a.createElement(w.a,{style:{margin:"8px 0 0 8px"},type:"link",onClick:function(){return I(!h)}},h?"Showing ":"",J," hidden properties. Click to ",h?"hide":"show","."))),j.a.createElement(re,{tab:"JSON",key:"json"},j.a.createElement(Q,{event:l})),l.elements&&l.elements.length>0&&j.a.createElement(re,{tab:"Elements",key:"elements"},j.a.createElement(ne.a,{event:l})))}try{b.displayName="EventDetails",b.__docgenInfo={description:"",displayName:"EventDetails",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"EventType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventDetails.tsx#EventDetails"]={docgenInfo:b.__docgenInfo,name:"EventDetails",path:"frontend/src/scenes/events/EventDetails.tsx#EventDetails"})}catch(m){}},"./frontend/src/scenes/events/EventElements.tsx":function(ue,U,e){"use strict";e.d(U,"a",function(){return b});var q=e("./node_modules/core-js/modules/es.array.concat.js"),ee=e.n(q),H=e("./node_modules/core-js/modules/es.array.fill.js"),ce=e.n(H),te=e("./node_modules/core-js/modules/es.array.join.js"),z=e.n(te),j=e("./node_modules/core-js/modules/es.array.map.js"),R=e.n(j),G=e("./node_modules/core-js/modules/es.array.slice.js"),ne=e.n(G),$=e("./node_modules/core-js/modules/es.object.entries.js"),w=e.n($),o=e("./node_modules/core-js/modules/es.regexp.exec.js"),se=e.n(o),oe=e("./node_modules/core-js/modules/es.string.replace.js"),de=e.n(oe),ae=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),le=e.n(ae),Q=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),ve=e.n(Q),ie=e("./node_modules/react/index.js"),X=e.n(ie);function re(m){return Array(m).fill("    ").join("")}function b(m){var l=m.event,d=ve()(l.elements||[]).reverse();return d=d.slice(Math.max(d.length-10,1)),X.a.createElement("div",null,d.map(function(i,h){return X.a.createElement("pre",{className:"code",key:h,style:{margin:0,padding:0,borderRadius:0,backgroundColor:h===d.length-1?"var(--primary)":void 0}},re(h),"<",i.tag_name,i.attr_id&&' id="'.concat(i.attr_id,'"'),Object.entries(i.attributes).map(function(I){var Y=le()(I,2),g=Y[0],J=Y[1];return X.a.createElement("span",{key:g}," ".concat(g.replace("attr__",""),'="').concat(J,'"'))}),">",i.text,h===d.length-1&&X.a.createElement("span",null,"</",i.tag_name,">"))}),ve()(d).reverse().slice(1).map(function(i,h){return X.a.createElement("pre",{className:"code",key:h,style:{margin:0,padding:0,borderRadius:0}},re(d.length-h-2),"</",i.tag_name,">")}))}try{b.displayName="EventElements",b.__docgenInfo={description:"",displayName:"EventElements",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"EventType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventElements.tsx#EventElements"]={docgenInfo:b.__docgenInfo,name:"EventElements",path:"frontend/src/scenes/events/EventElements.tsx#EventElements"})}catch(m){}},"./frontend/src/scenes/events/EventsTable.tsx":function(ue,U,e){"use strict";e.d(U,"a",function(){return N});var q=e("./node_modules/core-js/modules/es.array.concat.js"),ee=e("./node_modules/core-js/modules/es.array.find.js"),H=e("./node_modules/core-js/modules/es.array.join.js"),ce=e("./node_modules/core-js/modules/es.array.map.js"),te=e("./node_modules/core-js/modules/es.array.some.js"),z=e("./node_modules/core-js/modules/es.array.splice.js"),j=e("./node_modules/core-js/modules/es.object.keys.js"),R=e("./node_modules/core-js/modules/es.object.to-string.js"),G=e("./node_modules/core-js/modules/es.regexp.to-string.js"),ne=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),$=e.n(ne),w=e("./node_modules/react/index.js"),o=e.n(w),se=e("./node_modules/kea/lib/index.esm.js"),oe=e("./frontend/src/scenes/events/EventDetails.tsx"),de=e("./frontend/src/lib/components/Link.tsx"),ae=e("./node_modules/antd/es/button/index.js"),le=e("./node_modules/core-js/modules/es.array.filter.js"),Q=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),ve=e.n(Q),ie=e("./node_modules/kea-router/lib/index.js"),X=e("./node_modules/core-js/modules/es.regexp.exec.js"),re=e("./node_modules/core-js/modules/es.string.replace.js"),b=e("./node_modules/@babel/runtime/helpers/typeof.js"),m=e.n(b);function l(a){var v=a.value;return o.a.createElement("span",{title:v},m()(v)==="object"?JSON.stringify(v):v&&v.toString().replace(/(^\w+:|^)\/\//,""))}try{l.displayName="Property",l.__docgenInfo={description:"",displayName:"Property",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Property.tsx#Property"]={docgenInfo:l.__docgenInfo,name:"Property",path:"frontend/src/lib/components/Property.tsx#Property"})}catch(a){}var d=e("./frontend/src/lib/components/PropertyFilters/utils.ts");function i(a,v){var p=Object.keys(a);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(a);v&&(_=_.filter(function(S){return Object.getOwnPropertyDescriptor(a,S).enumerable})),p.push.apply(p,_)}return p}function h(a){for(var v=1;v<arguments.length;v++){var p=arguments[v]!=null?arguments[v]:{};v%2?i(Object(p),!0).forEach(function(_){ve()(a,_,p[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(p)):i(Object(p)).forEach(function(_){Object.defineProperty(a,_,Object.getOwnPropertyDescriptor(p,_))})}return a}function I(a){var v=a.property,p=a.value,_=a.filters,S=a.onClick,M=a.className,Z=Object(d.c)(_.properties),O=Z.find(function(W){return W.key===v&&W.value===p&&!W.operator})?Z.filter(function(W){return W.key!==v||W.value!==p||W.operator}):[].concat($()(Z),[{key:v,value:p}]),Ee=Object(ie.combineUrl)(window.location.pathname,h(h({},_),{},{properties:O}),{}),y=Ee.url;return o.a.createElement(de.a,{to:y,className:M,onClick:function(){S&&S(v,p)}},o.a.createElement(l,{value:p}))}try{I.displayName="FilterPropertyLink",I.__docgenInfo={description:"",displayName:"FilterPropertyLink",props:{property:{defaultValue:null,description:"",name:"property",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string | number"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((property: string, value: string | number) => void)"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/FilterPropertyLink.tsx#FilterPropertyLink"]={docgenInfo:I.__docgenInfo,name:"FilterPropertyLink",path:"frontend/src/lib/components/FilterPropertyLink.tsx#FilterPropertyLink"})}catch(a){}var Y=e("./frontend/src/lib/utils.tsx"),g=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),J=e.n(g),V=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/events/EventsTable.scss"),L=e.n(V),B={};B.insert="head",B.singleton=!1;var be=J()(L.a,B),Fe=L.a.locals||{},pe=e("./frontend/src/scenes/events/eventsTableLogic.ts"),Te=e("./frontend/src/scenes/persons/PersonHeader.tsx"),Ce=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),fe=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),C=e("./frontend/src/types.ts"),Se=e("./frontend/src/scenes/actions/EventName.tsx"),Me=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),De=e("./frontend/src/lib/components/Tooltip.tsx"),Re=e("./node_modules/clsx/dist/clsx.m.js"),Oe=e("./frontend/src/lib/components/ResizableTable/tableConfigLogic.ts"),ge=e("./frontend/src/scenes/urls.ts"),s=e("./frontend/src/lib/components/LemonTable/index.ts"),t=e("./frontend/src/lib/components/icons.tsx"),n=e("./frontend/src/lib/components/LemonButton/index.ts"),r=e("./frontend/src/lib/components/LemonButton/More.tsx"),c=e("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),E=e("./frontend/src/scenes/teamLogic.ts"),T=e("./frontend/src/scenes/events/createActionFromEvent.tsx");function K(a){Object(w.useEffect)(function(){var v="hidden",p="visibilitychange";typeof document.msHidden!="undefined"?(v="msHidden",p="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(v="webkitHidden",p="webkitvisibilitychange");var _=function(){a(!document[v])};return document.addEventListener(p,_),function(){document.removeEventListener(p,_)}},[])}var F=e("./frontend/src/lib/components/ResizableTable/TableConfig.tsx");function N(a){var v=a.pageKey,p=a.fixedFilters,_=a.fixedColumns,S=a.sceneUrl,M=a.fetchMonths,Z=M===void 0?12:M,O=a.startingColumns,Ee=a.showCustomizeColumns,y=Ee===void 0?!0:Ee,W=a.showExport,ye=W===void 0?!0:W,Ae=a.showAutoload,_e=Ae===void 0?!0:Ae,Ie=a.showEventFilter,he=Ie===void 0?!0:Ie,We=a.showRowExpanders,Qe=We===void 0?!0:We,we=a.showActionsButton,Xe=we===void 0?!0:we,Ve=a.showPersonColumn,Ze=Ve===void 0?!0:Ve,$e=a.linkPropertiesToFilters,Be=$e===void 0?!0:$e,ke=Object(se.useValues)(E.a),Ke=ke.currentTeam,Ye=Object(pe.a)({fixedFilters:p,key:v,sceneUrl:S||ge.a.events(),fetchMonths:Z}),k=Object(se.useValues)(Ye),Pe=k.properties,qe=k.eventsFormatted,Je=k.isLoading,et=k.hasNext,He=k.isLoadingNext,xe=k.eventFilter,tt=k.automaticLoadEnabled,nt=k.exportUrl,rt=k.highlightEvents,st=k.months,ze=Object(se.useValues)(Object(Oe.a)({startingColumns:O})),Ne=ze.tableWidth,je=ze.selectedColumns,me=Object(se.useActions)(Ye),ot=me.fetchNextEvents,at=me.prependNewEvents,lt=me.setEventFilter,it=me.toggleAutomaticLoad,ut=me.startDownload,ct=me.setPollingActive,dt=me.setProperties,vt=!(p!=null&&p.person_id);K(ct);var Ge=function(u,D){var P=u.date_break,f=u.new_events;return{children:P||(f?o.a.createElement(n.a,{icon:o.a.createElement(t.IconSync,null),style:{borderRadius:0},onClick:function(){return at()},center:!0,fullWidth:!0},"There are new events. Click here to load them"):"???"),props:{colSpan:D+1,style:f?{padding:0}:void 0}}},mt={title:"Person",key:"person",render:function(u,D){var P,f,x=D.event;return x?vt&&((P=x.person)===null||P===void 0||(f=P.distinct_ids)===null||f===void 0?void 0:f.length)?o.a.createElement(de.a,{to:ge.a.person(x.person.distinct_ids[0])},o.a.createElement(Te.a,{withIcon:!0,person:x.person})):o.a.createElement(Te.a,{withIcon:!0,person:x.person}):{props:{colSpan:0}}}},Ue=Object(w.useMemo)(function(){var A=[{title:"Event",key:"event",width:"16rem",render:function(D,P){if(!P.event)return Ge(P,Ne);var f=P.event;return o.a.createElement(fe.a,{value:Object(Y.g)(f)})}},{title:"URL / Screen",key:"url",width:"4rem",render:function(D,P){var f=P.event;if(!f)return{props:{colSpan:0}};var x=f.properties.$current_url?"$current_url":"$screen_name";return Be?o.a.createElement(I,{className:"ph-no-capture",property:x,value:f.properties[x],filters:{properties:Pe}}):o.a.createElement(l,{value:f.properties[x]})}},{title:"Source",key:"source",render:function(D,P){var f=P.event;return f?Be?o.a.createElement(I,{property:"$lib",value:f.properties.$lib,filters:{properties:Pe}}):o.a.createElement(l,{value:f.properties.$lib}):{props:{colSpan:0}}}}];return Ze&&A.splice(1,0,mt),A},[Ne]),pt=Object(w.useMemo)(function(){var A=je==="DEFAULT"?$()(Ue):je.map(function(u,D){return Ue.find(function(P){return P.key===u})||{title:fe.d.event[u]?fe.d.event[u].label:u,key:u,render:function(f,x){var Le=x.event;return Le?Be?o.a.createElement(I,{className:"ph-no-capture ",property:u,value:Le.properties[u],filters:{properties:Pe}}):o.a.createElement(l,{value:Le.properties[u]}):D===0?Ge(x,Ne):{props:{colSpan:0}}}}});return A.push({title:"Time",key:"time",render:function(D,P){var f=P.event;return f?o.a.createElement(Ce.b,{time:f.timestamp,showSeconds:!0}):{props:{colSpan:0}}}}),Xe&&A.push({key:"actions",width:0,render:function(D,P){var f=P.event;if(!f)return{props:{colSpan:0}};var x;return f.event==="$pageview"?x={insight:C.y.TRENDS,interval:"day",display:C.i.ActionsLineGraph,actions:[],events:[{id:"$pageview",name:"$pageview",type:"events",order:0,properties:[{key:"$current_url",value:f.properties.$current_url,type:"event"}]}]}:f.event!=="$autocapture"&&(x={insight:C.y.TRENDS,interval:"day",display:C.i.ActionsLineGraph,actions:[],events:[{id:f.event,name:f.event,type:"events",order:0,properties:[]}]}),o.a.createElement(r.a,{overlay:o.a.createElement(o.a.Fragment,null,Ke&&o.a.createElement(n.a,{type:"stealth",onClick:function(){return Object(T.a)(Ke.id,f,0,Ke.data_attributes||[])},fullWidth:!0,"data-attr":"events-table-create-action"},"Create action from event"),x&&o.a.createElement(n.a,{type:"stealth",to:ge.a.insightNew(x),fullWidth:!0,"data-attr":"events-table-usage"},"Try out in Insights"))})}}),_?A.concat(_):A},[je]);return o.a.createElement("div",{"data-attr":"manage-events-table"},o.a.createElement("div",{className:"events","data-attr":"events-table",style:{paddingTop:"1rem",borderTop:"1px solid var(--border)"}},o.a.createElement("div",{className:"mb",style:{display:"flex",gap:"1rem",flexWrap:"wrap",justifyContent:"space-between",alignItems:"start"}},o.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",flexDirection:"row",alignItems:"center",width:"100%"}},o.a.createElement(Me.a,{propertyFilters:Pe,onChange:dt,pageKey:v,taxonomicPopoverPlacement:"bottom-start",style:{marginBottom:0,marginTop:0},eventNames:xe?[xe]:[],useLemonButton:!0,prefixComponent:he?o.a.createElement(Se.b,{value:xe,onChange:function(u){lt(u||"")}}):o.a.createElement(o.a.Fragment,null)})),o.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",gap:"1rem",borderTop:_e||y||ye?"1px solid var(--border)":0,width:"100%",paddingTop:_e||y||ye?"1rem":0}},_e&&o.a.createElement(c.a,{type:"primary",id:"autoload-switch",label:"Automatically load new events",checked:tt,onChange:it}),o.a.createElement("div",{style:{display:"flex",gap:"0.5rem",flexDirection:"row"}},y&&o.a.createElement(F.a,{immutableColumns:["event","person"],defaultColumns:Ue.map(function(A){return A.key||""})}),ye&&nt&&o.a.createElement(De.a,{title:"Export up to 10,000 latest events.",placement:"left"},o.a.createElement(n.a,{type:"secondary",icon:o.a.createElement(t.IconExport,{style:{color:"var(--primary)"}}),onClick:ut},"Export"))))),o.a.createElement(s.a,{dataSource:qe,loading:Je,columns:pt,key:je==="DEFAULT"?"default":je.join("-"),className:"ph-no-capture",loadingSkeletonRows:20,emptyState:Je?void 0:Pe.some(function(A){return Object.keys(A).length})||xe?"No events matching filters found in the last ".concat(st," months!"):o.a.createElement(o.a.Fragment,null,"This project doesn't have any events. If you haven't integrated PostHog yet,"," ",o.a.createElement(de.a,{to:"/project/settings"},"click here to instrument analytics with PostHog in your product"),"."),rowKey:function(u){var D;return u.event?u.event.id+"-"+u.event.event:((D=u.date_break)===null||D===void 0?void 0:D.toString())||""},rowClassName:function(u){return Object(Re.a)({"event-row":u.event,highlighted:u.event&&rt[u.event.id],"event-row-is-exception":u.event&&u.event.event==="$exception","event-row-date-separator":u.date_break,"event-row-new":u.new_events})},expandable:Qe?{expandedRowRender:function(u){var D=u.event;return D&&o.a.createElement(oe.a,{event:D})},rowExpandable:function(u){var D=u.event,P=u.date_break,f=u.new_events;return P||f?-1:!!D}}:void 0}),o.a.createElement(ae.a,{type:"primary",onClick:ot,loading:He,style:{display:et||He?"block":"none",margin:"2rem auto 1rem"}},"Load more events")))}try{N.displayName="EventsTable",N.__docgenInfo={description:"",displayName:"EventsTable",props:{pageKey:{defaultValue:null,description:"",name:"pageKey",required:!0,type:{name:"string"}},fixedFilters:{defaultValue:null,description:"",name:"fixedFilters",required:!1,type:{name:"FixedFilters"}},fixedColumns:{defaultValue:null,description:"",name:"fixedColumns",required:!1,type:{name:"LemonTableColumn<EventsTableRowItem, keyof EventsTableRowItem>[]"}},sceneUrl:{defaultValue:null,description:"",name:"sceneUrl",required:!1,type:{name:"string"}},fetchMonths:{defaultValue:{value:"12"},description:"",name:"fetchMonths",required:!1,type:{name:"number"}},startingColumns:{defaultValue:null,description:"",name:"startingColumns",required:!1,type:{name:"ColumnChoice"}},showCustomizeColumns:{defaultValue:{value:"true"},description:"",name:"showCustomizeColumns",required:!1,type:{name:"boolean"}},showExport:{defaultValue:{value:"true"},description:"",name:"showExport",required:!1,type:{name:"boolean"}},showAutoload:{defaultValue:{value:"true"},description:"",name:"showAutoload",required:!1,type:{name:"boolean"}},showEventFilter:{defaultValue:{value:"true"},description:"",name:"showEventFilter",required:!1,type:{name:"boolean"}},showRowExpanders:{defaultValue:{value:"true"},description:"",name:"showRowExpanders",required:!1,type:{name:"boolean"}},showActionsButton:{defaultValue:{value:"true"},description:"",name:"showActionsButton",required:!1,type:{name:"boolean"}},showPersonColumn:{defaultValue:{value:"true"},description:"",name:"showPersonColumn",required:!1,type:{name:"boolean"}},linkPropertiesToFilters:{defaultValue:{value:"true"},description:"",name:"linkPropertiesToFilters",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventsTable.tsx#EventsTable"]={docgenInfo:N.__docgenInfo,name:"EventsTable",path:"frontend/src/scenes/events/EventsTable.tsx#EventsTable"})}catch(a){}},"./frontend/src/scenes/events/eventsTableLogic.ts":function(ue,U,e){"use strict";e.d(U,"a",function(){return ge});var q=e("./node_modules/core-js/modules/es.array.concat.js"),ee=e.n(q),H=e("./node_modules/core-js/modules/es.array.filter.js"),ce=e.n(H),te=e("./node_modules/core-js/modules/es.array.for-each.js"),z=e.n(te),j=e("./node_modules/core-js/modules/es.array.iterator.js"),R=e.n(j),G=e("./node_modules/core-js/modules/es.array.join.js"),ne=e.n(G),$=e("./node_modules/core-js/modules/es.array.map.js"),w=e.n($),o=e("./node_modules/core-js/modules/es.array.reduce.js"),se=e.n(o),oe=e("./node_modules/core-js/modules/es.array.splice.js"),de=e.n(oe),ae=e("./node_modules/core-js/modules/es.object.to-string.js"),le=e.n(ae),Q=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),ve=e.n(Q),ie=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),X=e.n(ie),re=e("./node_modules/@babel/runtime/regenerator/index.js"),b=e.n(re),m=e("./node_modules/regenerator-runtime/runtime.js"),l=e.n(m),d=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),i=e.n(d),h=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),I=e.n(h),Y=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),g=e.n(Y),J=e("./node_modules/kea/lib/index.esm.js"),V=e("./frontend/src/lib/utils.tsx"),L=e("./node_modules/kea-router/lib/index.js"),B=e.n(L),be=e("./frontend/src/lib/api.ts"),Fe=e("./frontend/src/scenes/teamLogic.ts"),pe=e("./frontend/src/lib/dayjs.ts"),Te=e("./frontend/src/lib/logic/featureFlagLogic.ts"),Ce=e("./frontend/src/lib/components/lemonToast.tsx");function fe(s,t){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable})),n.push.apply(n,r)}return n}function C(s){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fe(Object(n),!0).forEach(function(r){I()(s,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(n,r))})}return s}var Se=5,Me=365,De=5e3,Re=function(t,n){var r=[];return r=t.map(function(c){return{event:c}}),r.forEach(function(c,E){var T=r[E-1];E>0&&c.event&&T.event&&!Object(pe.a)(c.event.timestamp).isSame(T.event.timestamp,"day")&&r.splice(E,0,{date_break:Object(pe.a)(c.event.timestamp).format("LL")})}),n.length>0&&r.splice(0,0,{new_events:!0}),r},Oe=function(t){return Object(pe.b)().subtract(t,"day").toISOString()},ge=Object(J.kea)({path:function(t){return["scenes","events","eventsTableLogic",t]},props:{},key:function(t){return[t.fixedFilters?JSON.stringify(t.fixedFilters):"all",t.key,t.sceneUrl].filter(function(n){return!!n}).join("-")},connect:{values:[Fe.a,["currentTeamId"],Te.a,["featureFlags"]]},actions:{setPollingActive:function(t){return{pollingActive:t}},setProperties:function(t){return Array.isArray(t)?t.length===0?{properties:[{}]}:{properties:t}:{properties:[t]}},fetchEvents:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return{nextParams:t}},fetchEventsSuccess:function(t){return t},fetchNextEvents:!0,fetchOrPollFailure:function(t){return{error:t}},pollEvents:!0,pollEventsSuccess:function(t){return{events:t}},prependEvents:function(t){return{events:t}},prependNewEvents:!0,setSelectedEvent:function(t){return{selectedEvent:t}},setPollTimeout:function(t){return{pollTimeout:t}},setEventFilter:function(t){return{event:t}},toggleAutomaticLoad:function(t){return{automaticLoadEnabled:t}},noop:function(t){return t},startDownload:!0},reducers:{pollingIsActive:[!0,{setPollingActive:function(t,n){var r=n.pollingActive;return r},pollEventsSuccess:function(t,n){var r=n.events;return r&&r.length?!1:t},prependNewEvents:function(){return!0},toggleAutomaticLoad:function(){return!0}}],properties:[[],{setProperties:function(t,n){var r=n.properties;return Object(V.s)(r)}}],eventFilter:["",{setEventFilter:function(t,n){var r=n.event;return r}}],isLoading:[!0,{fetchEvents:function(){return!0},fetchEventsSuccess:function(){return!1},fetchOrPollFailure:function(){return!1}}],isLoadingNext:[!1,{fetchNextEvents:function(){return!0},fetchEventsSuccess:function(){return!1}}],events:[[],{fetchEventsSuccess:function(t,n){var r=n.events,c=n.isNext;return c?[].concat(g()(t),g()(r)):r},prependEvents:function(t,n){var r=n.events;return[].concat(g()(r),g()(t))}}],hasNext:[!1,{fetchEvents:function(){return!1},fetchNextEvents:function(){return!1},fetchEventsSuccess:function(t,n){var r=n.hasNext;return r}}],orderBy:["-timestamp",{}],selectedEvent:[null,{setSelectedEvent:function(t,n){var r=n.selectedEvent;return r}}],newEvents:[[],{setProperties:function(){return[]},pollEventsSuccess:function(t,n){var r=n.events;return r||[]},prependEvents:function(){return[]}}],highlightEvents:[{},{prependEvents:function(t,n){var r=n.events;return r.reduce(function(c,E){return c[E.id]=!0,c},{})}}],pollTimeout:[0,{setPollTimeout:function(t,n){return n.pollTimeout}}],automaticLoadEnabled:[!1,{persist:!0},{toggleAutomaticLoad:function(t,n){var r=n.automaticLoadEnabled;return r}}]},selectors:function(t){var n=t.selectors,r=t.props;return{eventsFormatted:[function(){return[n.events,n.newEvents]},function(c,E){return Re(c,E)}],exportUrl:[function(){return[n.currentTeamId,n.eventFilter,n.orderBy,n.properties,n.minimumQueryDate]},function(c,E,T,K,F){var N;return"/api/projects/".concat(c,"/events.csv?").concat(Object(V.yb)(C(C(C({},r.fixedFilters||{}),{},{properties:[].concat(g()(K),g()(((N=r.fixedFilters)===null||N===void 0?void 0:N.properties)||[]))},E?{event:E}:{}),{},{orderBy:[T],after:F})))}],months:[function(){return[function(c,E){return E.fetchMonths}]},function(c){return c||12}],minimumQueryDate:[function(){return[n.months]},function(c){return Object(pe.b)().subtract(c,"months").toISOString()}],pollAfter:[function(){return[n.events]},function(c){return(c==null?void 0:c.length)>0&&c[0].timestamp?c[0].timestamp:Oe(0)}]}},actionToUrl:function(t){var n=t.values;return{setProperties:function(){return[L.router.values.location.pathname,C(C({},L.router.values.searchParams),{},{properties:n.properties.length===0?void 0:n.properties}),L.router.values.hashParams,{replace:!0}]},setEventFilter:function(){return[L.router.values.location.pathname,C(C({},L.router.values.searchParams),{},{eventFilter:n.eventFilter}),L.router.values.hashParams,{replace:!0}]}}},urlToAction:function(t){var n=t.actions,r=t.values,c=t.props;return I()({},c.sceneUrl,function(E,T){n.setProperties(T.properties||r.properties||{}),T.eventFilter&&n.setEventFilter(T.eventFilter)})},events:function(t){var n=t.values;return{beforeUnmount:function(){return clearTimeout(n.pollTimeout||void 0)}}},listeners:function(t){var n=t.actions,r=t.values,c=t.props;return{startDownload:function(){Ce.a.success("The export is starting. It should finish soon"),window.location.href=r.exportUrl},setProperties:function(){return n.fetchEvents()},setEventFilter:function(){return n.fetchEvents()},fetchNextEvents:function(){var E=i()(b.a.mark(function K(){var F;return b.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:F=r.events,F.length===0?n.fetchEvents():n.fetchEvents({before:F[F.length-1].timestamp});case 2:case"end":return a.stop()}},K)}));function T(){return E.apply(this,arguments)}return T}(),fetchEvents:function(){var E=i()(b.a.mark(function K(F,N){var a,v,p,_,S,M,Z,O;return b.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(S=function(){return S=i()(b.a.mark(function ye(Ae){var _e;return b.a.wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return _e=C(C(C(C({after:Ae},c.fixedFilters||{}),{},{properties:p},v||{}),r.eventFilter?{event:r.eventFilter}:{}),{},{orderBy:[r.orderBy]}),he.abrupt("return",be.b.get("api/projects/".concat(r.currentTeamId,"/events/?").concat(Object(V.yb)(_e))));case 2:case"end":return he.stop()}},ye)})),S.apply(this,arguments)},_=function(ye){return S.apply(this,arguments)},v=F.nextParams,clearTimeout(r.pollTimeout),!(r.events.length>0)){y.next=9;break}return y.next=7,N(300);case 7:y.next=11;break;case 9:return y.next=11,N(1);case 11:return p=[].concat(g()(r.properties),g()(((a=c.fixedFilters)===null||a===void 0?void 0:a.properties)||[])),M=null,Z=!1,y.prev=14,y.next=17,_(Oe(Se));case 17:if(M=y.sent,M.results.length!==0){y.next=23;break}return y.next=21,_(Oe(Me));case 21:M=y.sent,Z=!0;case 23:y.next=29;break;case 25:return y.prev=25,y.t0=y.catch(14),n.fetchOrPollFailure(y.t0),y.abrupt("return");case 29:N(),n.fetchEventsSuccess({events:M.results,hasNext:!!M.next||!Z,isNext:!!v}),O=window.setTimeout(n.pollEvents,De),n.setPollTimeout(O);case 33:case"end":return y.stop()}},K,null,[[14,25]])}));function T(K,F){return E.apply(this,arguments)}return T}(),pollEvents:function(){var E=i()(b.a.mark(function K(F,N){var a,v,p,_,S,M;return b.a.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(v=function(){var y=window.setTimeout(n.pollEvents,De);n.setPollTimeout(y)},r.orderBy==="-timestamp"){O.next=3;break}return O.abrupt("return");case 3:if(c.sceneUrl===L.router.values.location.pathname){O.next=5;break}return O.abrupt("return");case 5:if(r.pollingIsActive){O.next=8;break}return v(),O.abrupt("return");case 8:return p=[].concat(g()(r.properties),g()(((a=c.fixedFilters)===null||a===void 0?void 0:a.properties)||[])),_=C(C(C({},c.fixedFilters||{}),{},{properties:p},r.eventFilter?{event:r.eventFilter}:{}),{},{orderBy:[r.orderBy],after:r.pollAfter}),S=Object(V.yb)(_),M=null,O.prev=12,O.next=15,be.b.get("api/projects/".concat(r.currentTeamId,"/events/?").concat(S));case 15:M=O.sent,O.next=21;break;case 18:return O.prev=18,O.t0=O.catch(12),O.abrupt("return");case 21:N(),r.automaticLoadEnabled?n.prependEvents(M.results):n.pollEventsSuccess(M.results),v();case 24:case"end":return O.stop()}},K,null,[[12,18]])}));function T(K,F){return E.apply(this,arguments)}return T}(),prependNewEvents:function(){r.newEvents.length&&n.prependEvents(r.newEvents)},fetchOrPollFailure:function(T){var K=T.error;Ce.a.error("There was a problem fetching your events: ".concat(K.statusText))},toggleAutomaticLoad:function(T){var K=T.automaticLoadEnabled;K&&n.prependNewEvents()}}}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/events/EventsTable.scss":function(ue,U,e){var q=e("./node_modules/css-loader/dist/runtime/api.js");U=q(!1),U.push([ue.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.events .events-table-button-clear{padding:0 4px;margin-left:4px}.events .events-table-button-clear.visible,.events .events-table-button-clear:focus,.events .events-table-button-clear:hover{border:1px solid #5375ff}.events .event-row-new{height:2.5rem}.events .event-row-date-separator{background-color:var(--bg-mid);color:var(--text-muted);font-weight:600;font-size:.75rem;height:2rem;text-align:center}.events .event-row-is-exception{background-color:#fffaf8}.events td{max-width:20rem}",""]),ue.exports=U}}]);
