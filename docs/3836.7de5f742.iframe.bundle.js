"use strict";(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[3836],{"./frontend/src/scenes/data-warehouse/external/dataWarehouseSceneLogic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{M:()=>dataWarehouseSceneLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/lib/api.ts"),scenes_userLogic__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/scenes/userLogic.ts"),_types__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/types.ts");const dataWarehouseSceneLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","warehouse","dataWarehouseSceneLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)((()=>({values:[scenes_userLogic__WEBPACK_IMPORTED_MODULE_3__.userLogic,["user"]]}))),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({toggleSourceModal:isOpen=>({isOpen})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({isSourceModalOpen:[!1,{toggleSourceModal:(state,_ref)=>{let{isOpen}=_ref;return null!=isOpen?isOpen:!state}}]}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)({dataWarehouse:[null,{loadDataWarehouse:async()=>await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.dataWarehouseTables.list()}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({tables:[s=>[s.dataWarehouse],warehouse=>warehouse?warehouse.results.map((table=>({id:table.id,name:table.name,columns:table.columns,url_pattern:table.url_pattern,format:table.format,external_data_source:table.external_data_source,external_schema:table.external_schema}))):[]],shouldShowEmptyState:[s=>[s.tables,s.dataWarehouseLoading],(tables,dataWarehouseLoading)=>0==tables?.length&&!dataWarehouseLoading],shouldShowProductIntroduction:[s=>[s.user],user=>!user?.has_seen_product_intro_for?.[_types__WEBPACK_IMPORTED_MODULE_4__.Md.DATA_WAREHOUSE]]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.afterMount)((_ref2=>{let{actions}=_ref2;actions.loadDataWarehouse()}))])},"./frontend/src/scenes/data-warehouse/external/sourceFormLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>sourceFormLogic,l:()=>SOURCE_DETAILS});var _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),kea__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_forms__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.5/node_modules/kea-forms/lib/index.js"),kea_router__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.5/node_modules/kea-router/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/lib/api.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./frontend/src/scenes/urls.ts"),_sourceModalLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./frontend/src/scenes/data-warehouse/external/sourceModalLogic.ts");const SOURCE_DETAILS={Stripe:{name:"Stripe",caption:"Enter your Stripe credentials to link your Stripe to PostHog",fields:[{name:"account_id",label:"Account ID",type:"text",required:!0},{name:"client_secret",label:"Client Secret",type:"text",required:!0}]}},getErrorsDefaults=sourceType=>"Stripe"===sourceType?_ref=>{let{payload}=_ref;return{payload:{account_id:!payload.account_id&&"Please enter an account id.",client_secret:!payload.client_secret&&"Please enter a client secret."}}}:()=>({}),sourceFormLogic=(0,kea__WEBPACK_IMPORTED_MODULE_1__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_1__.path)(["scenes","data-warehouse","external","sourceFormLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_1__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_1__.connect)({actions:[_sourceModalLogic__WEBPACK_IMPORTED_MODULE_6__.ju,["onClear","toggleSourceModal","loadSources"]]}),(0,kea__WEBPACK_IMPORTED_MODULE_1__.actions)({onBack:!0,handleRedirect:(kind,searchParams)=>({kind,searchParams})}),(0,kea__WEBPACK_IMPORTED_MODULE_1__.listeners)((_ref2=>{let{actions}=_ref2;return{onBack:()=>{actions.resetExternalDataSource(),actions.onClear()},submitExternalDataSourceSuccess:()=>{_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.lemonToast.success("New Data Resource Created"),actions.toggleSourceModal(!1),actions.resetExternalDataSource(),actions.loadSources(),kea_router__WEBPACK_IMPORTED_MODULE_3__.router.actions.push(scenes_urls__WEBPACK_IMPORTED_MODULE_5__.j.dataWarehouseSettings())},submitExternalDataSourceFailure:_ref3=>{let{error}=_ref3;_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.lemonToast.error(error?.message||"Something went wrong")},handleRedirect:async _ref4=>{let{kind,searchParams}=_ref4;if("hubspot"===kind)return actions.setExternalDataSourceValue("payload",{code:searchParams.code,redirect_uri:(0,_sourceModalLogic__WEBPACK_IMPORTED_MODULE_6__.Eg)()}),void actions.setExternalDataSourceValue("source_type","Hubspot");_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.lemonToast.error("Something went wrong.")}}})),(0,kea_router__WEBPACK_IMPORTED_MODULE_3__.urlToAction)((_ref5=>{let{actions}=_ref5;return{"/data-warehouse/:kind/redirect":(_ref6,searchParams)=>{let{kind=""}=_ref6;actions.handleRedirect(kind,searchParams)}}})),(0,kea_forms__WEBPACK_IMPORTED_MODULE_2__.forms)((_ref7=>{let{props}=_ref7;return{externalDataSource:{defaults:{prefix:"",source_type:props.sourceType,payload:(sourceType=props.sourceType,"Stripe"===sourceType?{account_id:"",client_secret:""}:{})},errors:getErrorsDefaults(props.sourceType),submit:async payload=>await lib_api__WEBPACK_IMPORTED_MODULE_4__.ZP.externalDataSources.create(payload)}};var sourceType}))])},"./frontend/src/scenes/data-warehouse/external/sourceModalLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Eg:()=>getHubspotRedirectUri,ju:()=>sourceModalLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),scenes_PreflightCheck_preflightLogic__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),_new_table_dataWarehouseTableLogic__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/scenes/data-warehouse/new_table/dataWarehouseTableLogic.tsx"),_settings_dataWarehouseSettingsLogic__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/scenes/data-warehouse/settings/dataWarehouseSettingsLogic.ts"),_dataWarehouseSceneLogic__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/scenes/data-warehouse/external/dataWarehouseSceneLogic.tsx");const getHubspotRedirectUri=()=>`${window.location.origin}/data-warehouse/hubspot/redirect`,CONNECTORS=[{name:"Stripe",fields:["account_id","client_secret"],caption:"Enter your Stripe credentials to link your Stripe to PostHog",disabledReason:null},{name:"Hubspot",fields:[],caption:"",disabledReason:null}],sourceModalLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","data-warehouse","external","sourceModalLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({selectConnector:connector=>({connector}),toggleManualLinkFormVisible:visible=>({visible}),handleRedirect:(kind,searchParams)=>({kind,searchParams}),onClear:!0}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)({values:[_new_table_dataWarehouseTableLogic__WEBPACK_IMPORTED_MODULE_2__.U,["tableLoading"],_settings_dataWarehouseSettingsLogic__WEBPACK_IMPORTED_MODULE_3__.T,["dataWarehouseSources"],scenes_PreflightCheck_preflightLogic__WEBPACK_IMPORTED_MODULE_1__.preflightLogic,["preflight"]],actions:[_dataWarehouseSceneLogic__WEBPACK_IMPORTED_MODULE_4__.M,["toggleSourceModal"],_new_table_dataWarehouseTableLogic__WEBPACK_IMPORTED_MODULE_2__.U,["resetTable"],_settings_dataWarehouseSettingsLogic__WEBPACK_IMPORTED_MODULE_3__.T,["loadSources"]]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({selectedConnector:[null,{selectConnector:(_,_ref)=>{let{connector}=_ref;return connector}}],isManualLinkFormVisible:[!1,{toggleManualLinkFormVisible:(_,_ref2)=>{let{visible}=_ref2;return visible}}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({showFooter:[s=>[s.selectedConnector,s.isManualLinkFormVisible],(selectedConnector,isManualLinkFormVisible)=>selectedConnector||isManualLinkFormVisible],connectors:[s=>[s.dataWarehouseSources],sources=>CONNECTORS.map((connector=>({...connector,disabledReason:sources&&sources.results.find((source=>source.source_type===connector.name))?"Already linked":null})))],addToHubspotButtonUrl:[s=>[s.preflight],preflight=>()=>{const clientId=preflight?.data_warehouse_integrations?.hubspot.client_id;if(!clientId)return null;const params=new URLSearchParams;return params.set("client_id",clientId),params.set("redirect_uri",getHubspotRedirectUri()),params.set("scope",["crm.objects.contacts.read","crm.objects.companies.read","crm.objects.deals.read","tickets","crm.objects.quotes.read"].join(" ")),`https://app.hubspot.com/oauth/authorize?${params.toString()}`}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.listeners)((_ref3=>{let{actions}=_ref3;return{onClear:()=>{actions.selectConnector(null),actions.toggleManualLinkFormVisible(!1),actions.resetTable()}}}))])},"./frontend/src/scenes/data-warehouse/new_table/dataWarehouseTableLogic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{U:()=>dataWarehouseTableLogic});var _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),kea__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_forms__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.5/node_modules/kea-forms/lib/index.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),kea_router__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.5/node_modules/kea-router/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./frontend/src/lib/api.ts"),scenes_data_management_database_databaseTableListLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./frontend/src/scenes/data-management/database/databaseTableListLogic.ts"),scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./frontend/src/scenes/sceneTypes.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./frontend/src/scenes/urls.ts"),_external_dataWarehouseSceneLogic__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./frontend/src/scenes/data-warehouse/external/dataWarehouseSceneLogic.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");const NEW_WAREHOUSE_TABLE={id:"",name:"",url_pattern:"",format:"Parquet",credential:{access_key:"",access_secret:""},columns:[]},dataWarehouseTableLogic=(0,kea__WEBPACK_IMPORTED_MODULE_1__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_1__.path)(["scenes","data-warehouse","tableLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_1__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_1__.connect)((()=>({actions:[scenes_data_management_database_databaseTableListLogic__WEBPACK_IMPORTED_MODULE_6__.A,["loadDatabase"],_external_dataWarehouseSceneLogic__WEBPACK_IMPORTED_MODULE_9__.M,["loadDataWarehouse","toggleSourceModal"]]}))),(0,kea__WEBPACK_IMPORTED_MODULE_1__.actions)({editingTable:editing=>({editing}),updateTargetingFlagFilters:(index,properties)=>({index,properties}),addConditionSet:!0,removeConditionSet:index=>({index}),launchTable:!0,stopTable:!0,archiveTable:!0,setDataTableQuery:query=>({query})}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_3__.loaders)((_ref=>{let{props}=_ref;return{table:{loadTable:async()=>props.id&&"new"!==props.id?await lib_api__WEBPACK_IMPORTED_MODULE_5__.ZP.dataWarehouseTables.get(props.id):{...NEW_WAREHOUSE_TABLE},createTable:async tablePayload=>await lib_api__WEBPACK_IMPORTED_MODULE_5__.ZP.dataWarehouseTables.create({...tablePayload}),updateTable:async tablePayload=>await lib_api__WEBPACK_IMPORTED_MODULE_5__.ZP.dataWarehouseTables.update(props.id,tablePayload)}}})),(0,kea__WEBPACK_IMPORTED_MODULE_1__.listeners)((_ref2=>{let{actions}=_ref2;return{createTableSuccess:async _ref3=>{let{table}=_ref3;_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.lemonToast.success((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.Fragment,{children:["Table ",table.name," created"]})),actions.loadDatabase(),actions.loadDataWarehouse(),actions.toggleSourceModal(!1),kea_router__WEBPACK_IMPORTED_MODULE_4__.router.actions.replace(scenes_urls__WEBPACK_IMPORTED_MODULE_8__.j.dataWarehouse())},updateTableSuccess:async _ref4=>{let{table}=_ref4;_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.lemonToast.success((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.Fragment,{children:["Table ",table.name," updated"]})),actions.editingTable(!1),kea_router__WEBPACK_IMPORTED_MODULE_4__.router.actions.replace(scenes_urls__WEBPACK_IMPORTED_MODULE_8__.j.dataWarehouse())}}})),(0,kea__WEBPACK_IMPORTED_MODULE_1__.reducers)({isEditingTable:[!1,{editingTable:(_,_ref5)=>{let{editing}=_ref5;return editing}}],dataTableQuery:[null,{setDataTableQuery:(_,_ref6)=>{let{query}=_ref6;return query}}]}),(0,kea__WEBPACK_IMPORTED_MODULE_1__.selectors)({breadcrumbs:[()=>[],()=>[{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_7__.x.DataWarehouse,name:"Data warehouse",path:scenes_urls__WEBPACK_IMPORTED_MODULE_8__.j.dataWarehouseExternal()},{key:[scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_7__.x.DataWarehouseTable,"new"],name:"New"}]]}),(0,kea_forms__WEBPACK_IMPORTED_MODULE_2__.forms)((_ref7=>{let{actions,props}=_ref7;return{table:{defaults:{...NEW_WAREHOUSE_TABLE},errors:_ref8=>{let{name,url_pattern,credential,format}=_ref8;return{name:!name&&"Please enter a name.",url_pattern:!url_pattern&&"Please enter a url pattern.",credential:{access_secret:!credential.access_secret&&"Please enter an access secret.",access_key:!credential.access_key&&"Please enter an access key."},format:!format&&"Please enter the format of your files."}},submit:async tablePayload=>{props.id&&"new"!==props.id?actions.updateTable(tablePayload):actions.createTable(tablePayload)}}}}))])},"./frontend/src/scenes/data-warehouse/redirect/DataWarehouseRedirectScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DataWarehouseRedirectScene:()=>DataWarehouseRedirectScene,default:()=>__WEBPACK_DEFAULT_EXPORT__,scene:()=>scene});var _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),kea_forms__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.5/node_modules/kea-forms/lib/index.js"),lib_forms_Field__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/lib/forms/Field.tsx"),scenes_data_warehouse_external_sourceFormLogic__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/scenes/data-warehouse/external/sourceFormLogic.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");const scene={component:DataWarehouseRedirectScene,logic:scenes_data_warehouse_external_sourceFormLogic__WEBPACK_IMPORTED_MODULE_3__.c};function DataWarehouseRedirectScene(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:"text-left flex flex-col",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("h2",{children:"Configure"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("p",{children:"Add a prefix to your tables to avoid conflicts with other data sources"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(kea_forms__WEBPACK_IMPORTED_MODULE_1__.Form,{logic:scenes_data_warehouse_external_sourceFormLogic__WEBPACK_IMPORTED_MODULE_3__.c,formKey:"externalDataSource",className:"space-y-4 max-w-100",enableFormOnSubmit:!0,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(lib_forms_Field__WEBPACK_IMPORTED_MODULE_2__.g,{name:"prefix",label:"Table prefix",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.LemonInput,{})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.LemonButton,{type:"primary",htmlType:"submit",children:"Submit"})]})]})}const __WEBPACK_DEFAULT_EXPORT__=DataWarehouseRedirectScene},"./frontend/src/scenes/data-warehouse/settings/dataWarehouseSettingsLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{T:()=>dataWarehouseSettingsLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/lib/api.ts"),lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/lib/lemon-ui/LemonToast/LemonToast.tsx"),scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/scenes/sceneTypes.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./frontend/src/scenes/urls.ts");const dataWarehouseSettingsLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","data-warehouse","settings","dataWarehouseSettingsLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({deleteSource:source=>({source}),reloadSource:source=>({source}),loadingFinished:source=>({source}),updateSchema:schema=>({schema})}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)({dataWarehouseSources:[null,{loadSources:async()=>lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.externalDataSources.list()}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({sourceReloadingById:[{},{reloadSource:(state,_ref)=>{let{source}=_ref;return{...state,[source.id]:!0}},deleteSource:(state,_ref2)=>{let{source}=_ref2;return{...state,[source.id]:!0}},loadingFinished:(state,_ref3)=>{let{source}=_ref3;return{...state,[source.id]:!1}}}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({breadcrumbs:[()=>[],()=>[{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_4__.x.DataWarehouse,name:"Data Warehouse",path:scenes_urls__WEBPACK_IMPORTED_MODULE_5__.j.dataWarehouseExternal()},{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_4__.x.DataWarehouseSettings,name:"Data Warehouse Settings",path:scenes_urls__WEBPACK_IMPORTED_MODULE_5__.j.dataWarehouseSettings()}]]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.listeners)((_ref4=>{let{actions,cache}=_ref4;return{loadSourcesSuccess:()=>{clearTimeout(cache.refreshTimeout),cache.refreshTimeout=setTimeout((()=>{actions.loadSources()}),1e4)},deleteSource:async _ref5=>{let{source}=_ref5;await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.externalDataSources.delete(source.id),actions.loadSources(),actions.loadingFinished(source)},reloadSource:async _ref6=>{let{source}=_ref6;try{await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.externalDataSources.reload(source.id),actions.loadSources()}catch(e){e.message?lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_3__.UJ.error(e.message):lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_3__.UJ.error("Cant refresh source at this time")}actions.loadingFinished(source)},updateSchema:async _ref7=>{let{schema}=_ref7;await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.externalDataSchemas.update(schema.id,schema),actions.loadSources()}}})),(0,kea__WEBPACK_IMPORTED_MODULE_0__.afterMount)((_ref8=>{let{actions}=_ref8;actions.loadSources()}))])}}]);