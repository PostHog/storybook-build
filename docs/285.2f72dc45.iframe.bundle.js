(window.webpackJsonp=window.webpackJsonp||[]).push([[285],{"./frontend/src/scenes/actions/ActionsTable.tsx":function(re,P,e){"use strict";e.r(P),e.d(P,"scene",function(){return fe}),e.d(P,"ActionsTable",function(){return ce});var F=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),V=e.n(F),G=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),n=e.n(G),Q=e("./node_modules/core-js/modules/es.array.map.js"),L=e("./node_modules/core-js/modules/es.regexp.exec.js"),X=e("./node_modules/core-js/modules/es.string.search.js"),h=e("./node_modules/core-js/modules/es.array.concat.js"),Z=e("./node_modules/core-js/modules/es.function.name.js"),Y=e("./node_modules/core-js/modules/es.array.slice.js"),k=e("./node_modules/core-js/modules/es.number.constructor.js"),I=e("./node_modules/core-js/modules/es.array.filter.js"),_=e("./node_modules/core-js/modules/es.object.to-string.js"),A=e("./node_modules/react/index.js"),t=e.n(A),le=e("./frontend/src/scenes/actions/Actions.scss"),C=e("./frontend/src/lib/components/Link.tsx"),o=e("./node_modules/antd/es/radio/index.js"),x=e("./node_modules/@ant-design/icons/es/icons/CheckOutlined.js"),b=e("./frontend/src/lib/utils.tsx"),r=e("./node_modules/kea/lib/index.esm.js"),d=e("./frontend/src/models/actionsModel.ts"),E=e("./node_modules/kea-router/lib/index.js"),s=e("./frontend/src/scenes/urls.ts"),m=e("./frontend/src/scenes/toolbar-launch/AuthorizedUrls.tsx"),a=e("./frontend/src/lib/components/icons.tsx"),c=e("./frontend/src/lib/components/LemonButton/index.ts"),p=e("./frontend/@posthog/lemon-ui/src/index.ts");function O(){var q=Object(A.useState)(!1),D=n()(q,2),W=D[0],U=D[1],se=Object(A.useState)(!1),ee=n()(se,2),te=ee[0],S=ee[1];return t.a.createElement(t.a.Fragment,null,t.a.createElement(c.a,{type:"primary",onClick:function(){return U(!0)},"data-attr":"create-action"},"New action"),t.a.createElement(p.LemonModal,{isOpen:W,onClose:function(){U(!1),S(!1)},title:"Create new action",footer:t.a.createElement(t.a.Fragment,null,te&&t.a.createElement(c.a,{key:"back-button",type:"secondary",onClick:function(){return S(!1)}},"Back"),t.a.createElement(c.a,{key:"cancel-button",type:"secondary",onClick:function(){U(!1),S(!1)}},"Cancel"))},te?t.a.createElement("div",{style:{maxWidth:"40rem"}},t.a.createElement(m.a,null)):t.a.createElement("div",{className:"space-y-2"},t.a.createElement(c.a,{type:"secondary",icon:t.a.createElement(a.IconMagnifier,null),onClick:function(){return S(!0)},size:"large",fullWidth:!0,center:!0,"data-attr":"new-action-inspect"},"Inspect element on your site"),t.a.createElement(c.a,{type:"secondary",icon:t.a.createElement(a.IconEdit,null),onClick:function(){E.router.actions.push(s.a.createAction())},size:"large",fullWidth:!0,center:!0,"data-attr":"new-action-pageview"},"From event or pageview"))))}var i=e("./frontend/src/types.ts"),v=e("./node_modules/fuse.js/dist/fuse.esm.js"),g=e("./frontend/src/scenes/userLogic.ts"),u=e("./frontend/src/scenes/teamLogic.tsx"),R=e("./frontend/src/lib/api.ts"),y=e("./frontend/src/lib/components/LemonTable/columnUtils.tsx"),B=e("./frontend/src/lib/components/LemonTable/index.ts"),$=e("./frontend/src/lib/components/LemonDivider/index.ts"),ae=e("./frontend/src/lib/components/LemonButton/More.tsx"),j=e("./frontend/src/lib/components/ObjectTags/ObjectTags.tsx"),K=e("./frontend/src/scenes/data-management/DataManagementPageTabs.tsx"),w=e("./frontend/src/lib/components/PageHeader.tsx"),me=Object(r.kea)([Object(r.path)(["scenes","actions","actionsLogic"]),Object(r.selectors)({breadcrumbs:[function(){return[]},function(){return[{name:"Data Management",path:s.a.eventDefinitions()},{name:"Actions",path:s.a.actions()}]}]})]),Ee=function(D,W){return new v.a(D,{keys:["name","url"],threshold:.3}).search(W).map(function(U){return U.item})},fe={component:ce,logic:me};function ce(){var q=Object(r.useValues)(u.a),D=q.currentTeam,W=Object(r.useValues)(Object(d.a)({params:"include_count=1"})),U=W.actions,se=W.actionsLoading,ee=Object(r.useActions)(d.a),te=ee.loadActions,S=Object(A.useState)(""),M=n()(S,2),ne=M[0],ve=M[1],ge=Object(A.useState)(!1),ie=n()(ge,2),de=ie[0],be=ie[1],ue=Object(r.useValues)(g.a),oe=ue.user,he=ue.hasAvailableFeature,Oe=[{title:"Name",dataIndex:"name",width:"25%",sorter:function(l,f){return(l.name||"").localeCompare(f.name||"")},render:function(l,f,z){return t.a.createElement(C.a,{"data-attr":"action-link-"+z,to:s.a.action(f.id),className:"row-name"},l||t.a.createElement("i",null,"Unnamed action"))}}].concat(V()(he(i.d.TAGGING)?[{title:"Tags",dataIndex:"tags",width:250,key:"tags",render:function(l){return t.a.createElement(j.a,{tags:l,staticOnly:!0})}}]:[]),[{title:"Type",key:"type",render:function(l,f){var z;return t.a.createElement("span",null,(z=f.steps)!==null&&z!==void 0&&z.length?f.steps.map(function(J){return t.a.createElement("div",{key:J.id},function(){var N=Object(b.Bb)(J.url||"");switch(N=N.slice(0,40)+(N.length>40?"...":""),J.event){case"$autocapture":return"Autocapture";case"$pageview":switch(J.url_matching){case"regex":return t.a.createElement(t.a.Fragment,null,"Page view URL matches regex ",t.a.createElement("strong",null,N));case"exact":return t.a.createElement(t.a.Fragment,null,"Page view URL matches exactly ",t.a.createElement("strong",null,N));default:return t.a.createElement(t.a.Fragment,null,"Page view URL contains ",t.a.createElement("strong",null,N))}default:return t.a.createElement(t.a.Fragment,null,"Event: ",t.a.createElement("strong",null,J.event))}}())}):t.a.createElement("i",null,"Empty \u2013 set this action up"))}},Object(y.b)(),Object(y.a)()],V()(D!=null&&D.slack_incoming_webhook?[{title:"Webhook",dataIndex:"post_to_slack",sorter:function(l,f){return Number(l.post_to_slack)-Number(f.post_to_slack)},render:function(l){return l?t.a.createElement(x.a,null):null}}]:[]),[{width:0,render:function(l,f){return t.a.createElement(ae.a,{overlay:t.a.createElement(t.a.Fragment,null,t.a.createElement(c.a,{status:"stealth",to:s.a.action(f.id),fullWidth:!0},"Edit"),t.a.createElement(c.a,{status:"stealth",to:Object(E.combineUrl)(s.a.insightNew({insight:i.C.TRENDS,interval:"day",display:i.j.ActionsLineGraph,actions:[{id:f.id,name:f.name,type:"actions",order:0}]})).url,fullWidth:!0},"Try out in Insights"),t.a.createElement($.a,null),t.a.createElement(c.a,{status:"danger",onClick:function(){return Object(b.x)({endpoint:R.b.actions.determineDeleteEndpoint(),object:f,callback:te})},fullWidth:!0},"Delete action"))})}}]),H=U;return ne&&ne!==""&&(H=Ee(H,ne)),de&&(H=H.filter(function(T){var l;return((l=T.created_by)===null||l===void 0?void 0:l.uuid)===(oe==null?void 0:oe.uuid)})),t.a.createElement("div",{"data-attr":"manage-events-table"},t.a.createElement(w.a,{title:"Data Management",caption:"Use data management to organize events that come into PostHog. Reduce noise, clarify usage, and help collaborators get the most value from your data.",tabbedPage:!0,buttons:t.a.createElement(O,null)}),t.a.createElement(K.a,{tab:K.b.Actions}),t.a.createElement("div",{className:"flex items-center justify-between gap-2 mb-4"},t.a.createElement(p.LemonInput,{type:"search",placeholder:"Search for actions",onChange:ve,value:ne}),t.a.createElement(o.a.Group,{buttonStyle:"solid",value:de,onChange:function(l){return be(l.target.value)}},t.a.createElement(o.a.Button,{value:!1},"All actions"),t.a.createElement(o.a.Button,{value:!0},"My actions"))),t.a.createElement(B.a,{columns:Oe,loading:se,rowKey:"id",pagination:{pageSize:100},"data-attr":"actions-table",dataSource:H,defaultSorting:{columnKey:"created_by",order:-1},emptyState:"The first step to standardized analytics is creating your first action."}))}},"./frontend/src/scenes/data-management/DataManagementPageTabs.tsx":function(re,P,e){"use strict";e.d(P,"b",function(){return a}),e.d(P,"a",function(){return O});var F=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),V=e.n(F),G=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=e.n(G),Q=e("./node_modules/core-js/modules/es.array.iterator.js"),L=e.n(Q),X=e("./node_modules/core-js/modules/es.object.to-string.js"),h=e.n(X),Z=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Y=e.n(Z),k=e("./node_modules/core-js/modules/es.object.from-entries.js"),I=e.n(k),_=e("./node_modules/core-js/modules/es.array.map.js"),A=e.n(_),t=e("./node_modules/core-js/modules/es.object.entries.js"),le=e.n(t),C=e("./node_modules/react/index.js"),o=e.n(C),x=e("./node_modules/kea/lib/index.esm.js"),b=e("./node_modules/antd/es/tabs/index.js"),r=e("./frontend/src/scenes/urls.ts"),d=e("./frontend/src/lib/components/Tooltip.tsx"),E=e("./frontend/src/lib/components/icons.tsx"),s=e("./frontend/src/lib/components/TitleWithIcon.tsx"),m,a;(function(i){i.Actions="actions",i.EventDefinitions="events",i.EventPropertyDefinitions="properties"})(a||(a={}));var c=(m={},n()(m,a.EventPropertyDefinitions,r.a.eventPropertyDefinitions()),n()(m,a.EventDefinitions,r.a.eventDefinitions()),n()(m,a.Actions,r.a.actions()),m),p=Object(x.kea)({path:["scenes","events","eventsTabsLogic"],actions:{setTab:function(v){return{tab:v}}},reducers:{tab:[a.EventDefinitions,{setTab:function(v,g){var u=g.tab;return u}}]},actionToUrl:function(){return{setTab:function(g){var u=g.tab;return c[u]||r.a.events()}}},urlToAction:function(v){var g=v.actions,u=v.values;return Object.fromEntries(Object.entries(c).map(function(R){var y=V()(R,2),B=y[0],$=y[1];return[$,function(){u.tab!==B&&g.setTab(B)}]}))}});function O(i){var v=i.tab,g=Object(x.useActions)(p),u=g.setTab;return o.a.createElement(b.a,{tabPosition:"top",animated:!1,activeKey:v,onTabClick:function(y){return u(y)}},o.a.createElement(b.a.TabPane,{tab:o.a.createElement("span",{"data-attr":"data-management-events-tab"},"Events"),key:a.EventDefinitions}),o.a.createElement(b.a.TabPane,{tab:o.a.createElement(s.a,{icon:o.a.createElement(d.a,{title:"Actions consist of one or more events that you have decided to put into a deliberately-labeled bucket. They're used in insights and dashboards."},o.a.createElement(E.IconInfo,null)),"data-attr":"data-management-actions-tab"},"Actions"),key:a.Actions}),o.a.createElement(b.a.TabPane,{tab:o.a.createElement(s.a,{icon:o.a.createElement(d.a,{title:"Properties are additional data sent along with an event capture. Use properties to understand additional information about events and the actors that generate them."},o.a.createElement(E.IconInfo,null)),"data-attr":"data-management-event-properties-tab"},"Event Properties"),key:a.EventPropertyDefinitions}))}try{O.displayName="DataManagementPageTabs",O.__docgenInfo={description:"",displayName:"DataManagementPageTabs",props:{tab:{defaultValue:null,description:"",name:"tab",required:!0,type:{name:"enum",value:[{value:'"actions"'},{value:'"events"'},{value:'"properties"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/data-management/DataManagementPageTabs.tsx#DataManagementPageTabs"]={docgenInfo:O.__docgenInfo,name:"DataManagementPageTabs",path:"frontend/src/scenes/data-management/DataManagementPageTabs.tsx#DataManagementPageTabs"})}catch(i){}},"./frontend/src/scenes/toolbar-launch/AuthorizedUrls.tsx":function(re,P,e){"use strict";e.d(P,"a",function(){return r});var F=e("./node_modules/core-js/modules/es.array.map.js"),V=e.n(F),G=e("./node_modules/react/index.js"),n=e.n(G),Q=e("./node_modules/clsx/dist/clsx.m.js"),L=e("./node_modules/kea/lib/index.esm.js"),X=e("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),h=e("./frontend/src/lib/components/LemonButton/index.ts"),Z=e("./node_modules/antd/es/popconfirm/index.js"),Y=e("./frontend/src/scenes/toolbar-launch/authorizedUrlsLogic.ts"),k=e("./frontend/src/lib/utils.tsx"),I=e("./frontend/src/lib/components/LemonRow/index.ts"),_=e("./frontend/src/lib/components/icons.tsx"),A=e("./frontend/src/lib/components/Spinner/Spinner.tsx"),t=e("./node_modules/kea-forms/lib/index.js"),le=e.n(t),C=e("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),o=e("./frontend/src/lib/forms/Field.tsx");function x(d){var E=d.numberOfResults,s=d.isSearching,m=d.isAddingEntry;return E>0?null:s?n.a.createElement(I.a,{outlined:!0,fullWidth:!0,size:"large",className:"AuthorizedUrlRow"},"There are no authorized URLs that match your search."):m?null:n.a.createElement(I.a,{outlined:!0,fullWidth:!0,size:"large",className:"AuthorizedUrlRow"},"There are no authorized URLs or domains. Add one to get started.")}function b(d){var E=d.actionId,s=Object(Y.b)({actionId:E}),m=Object(L.useValues)(s),a=m.isProposedUrlSubmitting,c=Object(L.useActions)(s),p=c.cancelProposingUrl;return n.a.createElement(t.Form,{logic:Y.b,props:{actionId:E},formKey:"proposedUrl",enableFormOnSubmit:!0,className:"w-full space-y-2"},n.a.createElement(o.a,{name:"url"},n.a.createElement(C.a,{autoFocus:!0,placeholder:"Enter a URL or wildcard subdomain (e.g. https://*.posthog.com)","data-attr":"url-input"})),n.a.createElement("div",{className:"flex justify-end gap-2"},n.a.createElement(h.a,{type:"secondary",onClick:p},"Cancel"),n.a.createElement(h.a,{htmlType:"submit",type:"primary",disabled:a,"data-attr":"url-save"},"Save")))}function r(d){var E=d.pageKey,s=d.actionId,m=Object(Y.b)({actionId:s}),a=Object(L.useValues)(m),c=a.appUrlsKeyed,p=a.suggestionsLoading,O=a.searchTerm,i=a.launchUrl,v=a.editUrlIndex,g=a.isAddUrlFormVisible,u=Object(L.useActions)(m),R=u.addUrl,y=u.removeUrl,B=u.setSearchTerm,$=u.newUrl,ae=u.setEditUrlIndex;return n.a.createElement("div",null,n.a.createElement("div",{className:"flex items-center mb-4 gap-2 justify-between"},n.a.createElement(C.a,{type:"search",autoFocus:E==="toolbar-launch"&&!Object(k.ab)(),placeholder:"Search for authorized URLs",onChange:B,value:O}),n.a.createElement(h.a,{onClick:$,type:"secondary",icon:n.a.createElement(_.IconPlus,null),"data-attr":"toolbar-add-url"},"Add",E==="toolbar-launch"&&" authorized URL")),p?n.a.createElement(I.a,{outlined:!0,fullWidth:!0,size:"large",key:-1},n.a.createElement(A.a,{className:"text-xl"})):n.a.createElement("div",{className:"space-y-2"},g&&n.a.createElement(I.a,{outlined:!0,fullWidth:!0,size:"large"},n.a.createElement(b,{actionId:s})),n.a.createElement(x,{numberOfResults:c.length,isSearching:O.length>0,isAddingEntry:g}),c.map(function(j,K){return n.a.createElement("div",{key:K,className:Object(Q.a)("border rounded flex items-center py-2 px-4 min-h-14")},v===K?n.a.createElement(b,{actionId:s}):n.a.createElement(n.a.Fragment,null,j.type==="suggestion"&&n.a.createElement(X.a,{type:"highlight",className:"mr-4"},"Suggestion"),n.a.createElement("span",{title:j.url,className:"flex-1 truncate"},j.url),n.a.createElement("div",{className:"Actions flex space-x-2 shrink-0"},j.type==="suggestion"?n.a.createElement(h.a,{onClick:function(){return R(j.url)},icon:n.a.createElement(_.IconPlus,null),"data-attr":"toolbar-apply-suggestion"},"Apply suggestion"):n.a.createElement(n.a.Fragment,null,n.a.createElement(h.a,{icon:n.a.createElement(_.IconOpenInApp,null),to:i(j.url),targetBlank:!0,tooltip:"Launch toolbar",center:!0,className:"ActionButton","data-attr":"toolbar-open"},"Launch"),n.a.createElement(h.a,{icon:n.a.createElement(_.IconEdit,null),onClick:function(){return ae(j.originalIndex)},tooltip:"Edit",center:!0,className:"ActionButton"}),n.a.createElement(Z.a,{placement:"topRight",title:n.a.createElement(n.a.Fragment,null,"Are you sure you want to remove this authorized url?"),onConfirm:function(){return y(K)}},n.a.createElement(h.a,{icon:n.a.createElement(_.IconDelete,null),tooltip:"Remove URL",center:!0,className:"ActionButton"}))))))})))}try{r.displayName="AuthorizedUrls",r.__docgenInfo={description:"",displayName:"AuthorizedUrls",props:{pageKey:{defaultValue:null,description:"",name:"pageKey",required:!1,type:{name:"string"}},actionId:{defaultValue:null,description:"",name:"actionId",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/toolbar-launch/AuthorizedUrls.tsx#AuthorizedUrls"]={docgenInfo:r.__docgenInfo,name:"AuthorizedUrls",path:"frontend/src/scenes/toolbar-launch/AuthorizedUrls.tsx#AuthorizedUrls"})}catch(d){}}}]);
