"use strict";(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[5235],{"./frontend/src/scenes/pipeline/Pipeline.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Pipeline:()=>Pipeline,scene:()=>Pipeline_scene});var index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib=__webpack_require__("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.5/node_modules/kea-router/lib/index.js"),PageHeader=__webpack_require__("./frontend/src/lib/components/PageHeader.tsx"),LemonTabs=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTabs/index.ts"),urls=__webpack_require__("./frontend/src/scenes/urls.ts"),types=__webpack_require__("./frontend/src/types.ts"),src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),popconfirm=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_react-dom@18.2.0_react@18.2.0/node_modules/antd/es/popconfirm/index.js"),icons=__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts"),LemonButton=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/index.ts"),LemonInput=__webpack_require__("./frontend/src/lib/lemon-ui/LemonInput/index.ts"),Link=__webpack_require__("./frontend/src/lib/lemon-ui/Link/index.ts"),preflightLogic=__webpack_require__("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),appsManagementLogic=__webpack_require__("./frontend/src/scenes/pipeline/appsManagementLogic.tsx"),sourceAppInitialCode=__webpack_require__("./frontend/src/scenes/pipeline/sourceAppInitialCode.tsx"),utils=__webpack_require__("./frontend/src/scenes/pipeline/utils.tsx"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");appsManagementLogic.k;function AppsManagement(){const{canInstallPlugins,canGloballyManagePlugins,missingGlobalPlugins,shouldBeGlobalPlugins,shouldNotBeGlobalPlugins,globalPlugins,localPlugins}=(0,index_esm.useValues)(appsManagementLogic.k),{isDev,isCloudOrDev}=(0,index_esm.useValues)(preflightLogic.preflightLogic);return canInstallPlugins&&canGloballyManagePlugins?(0,jsx_runtime.jsxs)("div",{className:"pipeline-apps-management-scene",children:[isCloudOrDev&&(missingGlobalPlugins.length>0||shouldBeGlobalPlugins.length>0||shouldNotBeGlobalPlugins.length>0)&&(0,jsx_runtime.jsx)(OutOfSyncApps,{}),(0,jsx_runtime.jsx)("h2",{children:"Manual installation"}),(0,jsx_runtime.jsx)(InstallFromUrl,{}),isDev&&(0,jsx_runtime.jsx)(InstallLocalApp,{}),(0,jsx_runtime.jsx)(InstallSourceApp,{}),(0,jsx_runtime.jsx)(src.LemonDivider,{className:"my-6"}),(0,jsx_runtime.jsx)("h2",{children:"Installed apps"}),globalPlugins&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("h3",{className:"mt-3",children:"Global apps"}),(0,jsx_runtime.jsx)("p",{children:"These apps can be used in all organizations."}),(0,jsx_runtime.jsx)(AppsTable,{plugins:globalPlugins})]}),localPlugins&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("h3",{className:"mt-3",children:"Local apps"}),(0,jsx_runtime.jsx)("p",{children:"These apps can only be used by this organization, or ones with an existing plugin config."}),(0,jsx_runtime.jsx)(AppsTable,{plugins:localPlugins})]})]}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"You don't have permission to manage apps."})}function AppsTable(_ref){let{plugins}=_ref;const{unusedPlugins}=(0,index_esm.useValues)(appsManagementLogic.k),{uninstallPlugin,patchPlugin}=(0,index_esm.useActions)(appsManagementLogic.k),data=plugins.map((plugin=>({...plugin,key:plugin.id})));return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(src.LemonTable,{dataSource:data,columns:[{width:60,render:function RenderAppInfo(_,plugin){return(0,jsx_runtime.jsx)(utils.Wf,{plugin})}},{title:"Name",render:function RenderName(_,plugin){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"flex gap-2 items-center",children:(0,jsx_runtime.jsx)("span",{className:"font-semibold truncate",children:plugin.name})}),(0,jsx_runtime.jsx)("div",{className:"text-sm",children:plugin.description})]})}},{title:"Capabilities",width:"30%",render:function RenderCapabilities(_,plugin){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"text-sm",children:["Methods: ",JSON.stringify(plugin.capabilities?.methods)]}),(0,jsx_runtime.jsxs)("div",{className:"text-sm",children:["Jobs: ",JSON.stringify(plugin.capabilities?.jobs)]}),(0,jsx_runtime.jsxs)("div",{className:"text-sm",children:["Scheduled tasks: ",JSON.stringify(plugin.capabilities?.scheduled_tasks)]})]})}},{title:"Actions",width:240,align:"right",render:function RenderAccess(_,plugin){return(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[plugin.is_global?(0,jsx_runtime.jsx)(src.Tooltip,{title:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["This app can currently be used by other organizations in this instance of PostHog. This action will ",(0,jsx_runtime.jsx)("b",{children:"disable and hide it"})," for all organizations that do not have an existing pluginconfig."]}),children:(0,jsx_runtime.jsx)(LemonButton.J,{type:"secondary",size:"small",icon:(0,jsx_runtime.jsx)(icons._V1,{}),onClick:()=>patchPlugin(plugin.id,{is_global:!1}),children:"Make local"})}):(0,jsx_runtime.jsx)(src.Tooltip,{title:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["This action will mark this app as installed for"," ",(0,jsx_runtime.jsx)("b",{children:"all organizations"})," in this instance of PostHog."]}),children:(0,jsx_runtime.jsx)(LemonButton.J,{type:"secondary",size:"small",icon:(0,jsx_runtime.jsx)(icons.e0r,{}),onClick:()=>patchPlugin(plugin.id,{is_global:!0}),children:"Make global"})}),(0,jsx_runtime.jsx)(popconfirm.Z,{placement:"topLeft",title:"Are you sure you wish to uninstall this app completely?",onConfirm:()=>uninstallPlugin(plugin.id),okText:"Uninstall",cancelText:"Cancel",className:"Plugins__Popconfirm",children:(0,jsx_runtime.jsx)(LemonButton.J,{type:"secondary",status:"danger",size:"small",icon:(0,jsx_runtime.jsx)(icons.Fzz,{}),disabledReason:unusedPlugins.includes(plugin.id)?void 0:"This app is still in use.","data-attr":"plugin-uninstall",children:"Uninstall"})})]})}}]})})}function OutOfSyncApps(){const{shouldNotBeGlobalPlugins,shouldBeGlobalPlugins}=(0,index_esm.useValues)(appsManagementLogic.k);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("h2",{children:"Out-of-sync global apps"}),(0,jsx_runtime.jsx)(src.LemonBanner,{type:"warning",children:"This PostHog Cloud instance is currently out of sync with the GLOBAL_PLUGINS list."}),(0,jsx_runtime.jsx)(MissingGlobalPlugins,{}),shouldNotBeGlobalPlugins&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("h3",{className:"mt-3",children:"Apps that should NOT be global"}),(0,jsx_runtime.jsx)("p",{children:"These apps should NOT be global according to repo."}),(0,jsx_runtime.jsx)(AppsTable,{plugins:shouldNotBeGlobalPlugins})]}),shouldBeGlobalPlugins&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("h3",{className:"mt-3",children:"Apps that SHOULD be global"}),(0,jsx_runtime.jsx)("p",{children:"These already installed apps should be global according to repo."}),(0,jsx_runtime.jsx)(AppsTable,{plugins:shouldBeGlobalPlugins})]}),(0,jsx_runtime.jsx)(src.LemonDivider,{className:"my-6"})]})}function MissingGlobalPlugins(){const{missingGlobalPlugins,pluginsLoading,installingPluginUrl}=(0,index_esm.useValues)(appsManagementLogic.k),{installPlugin}=(0,index_esm.useActions)(appsManagementLogic.k);if(0===missingGlobalPlugins.length)return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{});const data=missingGlobalPlugins.map((url=>({url})));return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("h3",{className:"mt-3",children:"Missing global apps"}),(0,jsx_runtime.jsx)("p",{children:"These plugins are defined in the GLOBAL_PLUGINS list, but are not installed on this instance."}),(0,jsx_runtime.jsx)(src.LemonTable,{dataSource:data,columns:[{title:"URL",key:"url",render:function RenderUrl(_,_ref2){let{url}=_ref2;return(0,jsx_runtime.jsx)(Link.r,{to:url,target:"_blank",children:url})}},{title:"Actions",width:0,align:"right",render:function RenderInstallButton(_,_ref3){let{url}=_ref3;return(0,jsx_runtime.jsx)(LemonButton.J,{type:"secondary",size:"small",loading:pluginsLoading&&installingPluginUrl===url,onClick:()=>installPlugin(types.ak.Repository,url),id:`install-plugin-${url}`,children:"Install"})}}]})]})}function InstallFromUrl(){const{isCloudOrDev}=(0,index_esm.useValues)(preflightLogic.preflightLogic),{pluginUrl}=(0,index_esm.useValues)(appsManagementLogic.k),{setPluginUrl,installPlugin}=(0,index_esm.useActions)(appsManagementLogic.k);let disabledReason=pluginUrl?void 0:"Please enter a url";return isCloudOrDev&&(disabledReason=pluginUrl.startsWith("https://github.com/PostHog/")?void 0:"Please enter a PostHog org repo url"),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("h3",{className:"mt-3",children:"Install from GitHub"}),(0,jsx_runtime.jsx)("p",{children:isCloudOrDev?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Only PostHog organization repositories are allowed, i.e. starting with"," ",(0,jsx_runtime.jsx)(Link.r,{to:"https://github.com/PostHog/",target:"blank",children:"https://github.com/PostHog/"})," "]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["For private repositories, append ",(0,jsx_runtime.jsx)("code",{children:"?private_token=TOKEN"})," to the end of the URL."]})}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(LemonInput.D,{value:pluginUrl,onChange:setPluginUrl,placeholder:"https://github.com/PostHog/posthog-hello-world-plugin",className:"flex-1"}),(0,jsx_runtime.jsx)(LemonButton.J,{disabledReason,type:"primary",onClick:()=>installPlugin(types.ak.Custom),children:"Fetch and install"})]})]})}function InstallLocalApp(){const{localPluginPath}=(0,index_esm.useValues)(appsManagementLogic.k),{setLocalPluginPath,installPlugin}=(0,index_esm.useActions)(appsManagementLogic.k);return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h3",{className:"mt-3",children:"Install from local path"}),(0,jsx_runtime.jsx)("p",{children:"To install a local app from this computer/server, give its full path below."}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(LemonInput.D,{value:localPluginPath,onChange:setLocalPluginPath,placeholder:"/var/posthog/apps/helloworldapp",className:"flex-1"}),(0,jsx_runtime.jsx)(LemonButton.J,{disabledReason:localPluginPath?void 0:"Please enter a path",type:"primary",onClick:()=>installPlugin(types.ak.Local),children:"Install"})]})]})})}function InstallSourceApp(){const{sourcePluginName,sourcePluginKind}=(0,index_esm.useValues)(appsManagementLogic.k),{setSourcePluginName,installPlugin,setSourcePluginKind}=(0,index_esm.useActions)(appsManagementLogic.k),menuItems=Object.values(sourceAppInitialCode.n).map((kind=>({label:kind,onClick:()=>{setSourcePluginKind(kind)}})));return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h3",{className:"mt-3",children:"Install by writing source code"}),(0,jsx_runtime.jsxs)("p",{children:["To install a source app provide the name and start coding.",(0,jsx_runtime.jsxs)(Link.r,{to:"https://posthog.com/docs/apps",target:"_blank",children:[" ","Read the documentation for more information!"]})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(LemonInput.D,{value:sourcePluginName,onChange:setSourcePluginName,placeholder:"Hello World App",className:"flex-1"}),(0,jsx_runtime.jsx)(src.LemonMenu,{items:menuItems,placement:"bottom-end",children:(0,jsx_runtime.jsx)(LemonButton.J,{size:"small",children:sourcePluginKind})}),(0,jsx_runtime.jsx)(LemonButton.J,{disabledReason:sourcePluginName?void 0:"Please enter a name",type:"primary",onClick:()=>installPlugin(types.ak.Source),children:"Install"})]})]})}var ProductIntroduction=__webpack_require__("./frontend/src/lib/components/ProductIntroduction/ProductIntroduction.tsx"),constants=__webpack_require__("./frontend/src/lib/constants.tsx"),More=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/More.tsx"),LemonMarkdown=__webpack_require__("./frontend/src/lib/lemon-ui/LemonMarkdown/LemonMarkdown.tsx"),columnUtils=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTable/columnUtils.tsx"),featureFlagLogic=__webpack_require__("./frontend/src/lib/logic/featureFlagLogic.ts"),deleteWithUndo=__webpack_require__("./frontend/src/lib/utils/deleteWithUndo.tsx"),kea_loaders_lib=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),api=__webpack_require__("./frontend/src/lib/api.ts"),access=__webpack_require__("./frontend/src/scenes/plugins/access.ts"),teamLogic=__webpack_require__("./frontend/src/scenes/teamLogic.tsx"),userLogic=__webpack_require__("./frontend/src/scenes/userLogic.ts");const pipelineDestinationsLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","pipeline","destinationsLogic"]),(0,index_esm.connect)({values:[teamLogic.teamLogic,["currentTeamId"],userLogic.userLogic,["user"]]}),(0,index_esm.actions)({loadPluginConfigs:!0}),(0,kea_loaders_lib.loaders)((_ref=>{let{values}=_ref;return{plugins:[{},{loadPlugins:async()=>{const results=await api.ZP.loadPaginatedResults("api/organizations/@current/pipeline_destinations"),plugins={};for(const plugin of results)plugins[plugin.id]=plugin;return plugins}}],pluginConfigs:[{},{loadPluginConfigs:async()=>{const pluginConfigs={},results=await api.ZP.loadPaginatedResults(`api/projects/${values.currentTeamId}/pipeline_destinations_configs`);for(const pluginConfig of results)pluginConfigs[pluginConfig.id]={...pluginConfig,name:pluginConfig.name||values.plugins[pluginConfig.plugin]?.name||"Unknown app",description:pluginConfig.description||values.plugins[pluginConfig.plugin]?.description};return pluginConfigs},toggleEnabled:async _ref2=>{let{id,enabled}=_ref2;if(!values.canConfigurePlugins)return values.pluginConfigs;const{pluginConfigs,plugins}=values,pluginConfig=pluginConfigs[id],plugin=plugins[pluginConfig.plugin];(0,utils.SO)("plugin "+(enabled?"enabled":"disabled"),plugin,pluginConfig);const response=await api.ZP.update(`api/plugin_config/${id}`,{enabled});return{...pluginConfigs,[id]:response}}}]}})),(0,index_esm.selectors)({loading:[s=>[s.pluginsLoading,s.pluginConfigsLoading],(pluginsLoading,pluginConfigsLoading)=>pluginsLoading||pluginConfigsLoading],enabledPluginConfigs:[s=>[s.pluginConfigs],pluginConfigs=>Object.values(pluginConfigs).filter((pc=>pc.enabled))],disabledPluginConfigs:[s=>[s.pluginConfigs],pluginConfigs=>Object.values(pluginConfigs).filter((pc=>!pc.enabled))],canConfigurePlugins:[s=>[s.user],user=>(0,access.z9)(user?.organization)],shouldShowProductIntroduction:[s=>[s.user],user=>!user?.has_seen_product_intro_for?.[types.Md.PIPELINE_DESTINATIONS]]}),(0,index_esm.afterMount)((_ref3=>{let{actions}=_ref3;actions.loadPlugins(),actions.loadPluginConfigs()}))]);var pipelineLogic=__webpack_require__("./frontend/src/scenes/pipeline/pipelineLogic.tsx");function NewButton(_ref){let{tab}=_ref;const singular=(0,pipelineLogic.v9)(tab);return(0,jsx_runtime.jsxs)(LemonButton.J,{"data-attr":`new-${singular}`,to:urls.j.pipelineNew(tab),type:"primary",children:["New ",singular]})}function Destinations(){const{featureFlags}=(0,index_esm.useValues)(featureFlagLogic.h);if(!featureFlags[constants.y8.PIPELINE_UI])return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{});const{enabledPluginConfigs,disabledPluginConfigs,shouldShowProductIntroduction}=(0,index_esm.useValues)(pipelineDestinationsLogic),shouldShowEmptyState=0===enabledPluginConfigs.length&&0===disabledPluginConfigs.length;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(shouldShowEmptyState||shouldShowProductIntroduction)&&(0,jsx_runtime.jsx)(ProductIntroduction.C,{productName:"Pipeline destinations",thingName:"destination",productKey:types.Md.PIPELINE_DESTINATIONS,description:"Pipeline destinations allow you to export data outside of PostHog, such as webhooks to Slack.",docsURL:"https://posthog.com/docs/cdp",actionElementOverride:(0,jsx_runtime.jsx)(NewButton,{tab:types.OJ.Destinations}),isEmpty:!0}),(0,jsx_runtime.jsx)(Destinations_AppsTable,{}),(0,jsx_runtime.jsx)(BatchExportsTable,{})]})}function BatchExportsTable(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("h2",{children:"Batch exports"}),(0,jsx_runtime.jsx)("h2",{children:"Backfills"})]})}function Destinations_AppsTable(){const{loading,enabledPluginConfigs,disabledPluginConfigs,plugins,canConfigurePlugins}=(0,index_esm.useValues)(pipelineDestinationsLogic),{toggleEnabled,loadPluginConfigs}=(0,index_esm.useActions)(pipelineDestinationsLogic);return 0===enabledPluginConfigs.length&&0===disabledPluginConfigs.length?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("h2",{children:"Webhooks"}),(0,jsx_runtime.jsx)(src.LemonTable,{dataSource:[...enabledPluginConfigs,...disabledPluginConfigs],size:"xs",loading,columns:[{title:"Name",sticky:!0,render:function RenderPluginName(_,pluginConfig){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(src.Tooltip,{title:"Click to update configuration, view metrics, and more",children:(0,jsx_runtime.jsx)(src.Link,{to:urls.j.pipelineApp(pluginConfig.id,types.YU.Configuration),children:(0,jsx_runtime.jsx)("span",{className:"row-name",children:pluginConfig.name})})}),pluginConfig.description&&(0,jsx_runtime.jsx)(LemonMarkdown.j,{className:"row-description",lowKeyHeadings:!0,children:pluginConfig.description})]})}},{title:"App",render:function RenderAppInfo(_,pluginConfig){return(0,jsx_runtime.jsx)(utils.Wf,{plugin:plugins[pluginConfig.plugin]})}},{title:"24h",render:function Render24hDeliveryRate(_,pluginConfig){let tooltip="No events exported in the past 24 hours",value="-",tagType="muted";if(null!==pluginConfig.delivery_rate_24h&&void 0!==pluginConfig.delivery_rate_24h){const deliveryRate=pluginConfig.delivery_rate_24h;value=`${Math.floor(100*deliveryRate)}%`,tooltip="Success rate for past 24 hours",tagType=deliveryRate>=.99?"success":deliveryRate>=.75?"warning":"danger"}return(0,jsx_runtime.jsx)(src.Tooltip,{title:tooltip,children:(0,jsx_runtime.jsx)(src.Link,{to:urls.j.pipelineApp(pluginConfig.id,types.YU.Metrics),children:(0,jsx_runtime.jsx)(src.LemonTag,{type:tagType,children:value})})})}},(0,columnUtils.yI)(),{title:"Status",render:function RenderStatus(_,pluginConfig){return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:pluginConfig.enabled?(0,jsx_runtime.jsx)(src.LemonTag,{type:"success",className:"uppercase",children:"Enabled"}):(0,jsx_runtime.jsx)(src.LemonTag,{type:"default",className:"uppercase",children:"Disabled"})})}},{width:0,render:function Render(_,pluginConfig){return(0,jsx_runtime.jsx)(More.T,{overlay:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(src.LemonButton,{onClick:()=>{toggleEnabled({enabled:!pluginConfig.enabled,id:pluginConfig.id})},id:`app-${pluginConfig.id}-enable-switch`,disabledReason:canConfigurePlugins?void 0:"You do not have permission to enable/disable apps.",fullWidth:!0,children:[pluginConfig.enabled?"Disable":"Enable"," app"]}),(0,jsx_runtime.jsxs)(src.LemonButton,{to:urls.j.pipelineApp(pluginConfig.id,types.YU.Configuration),id:`app-${pluginConfig.id}-configuration`,fullWidth:!0,children:[canConfigurePlugins?"Edit":"View"," app configuration"]}),(0,jsx_runtime.jsx)(src.LemonButton,{to:urls.j.pipelineApp(pluginConfig.id,types.YU.Metrics),id:`app-${pluginConfig.id}-metrics`,fullWidth:!0,children:"View app metrics"}),(0,jsx_runtime.jsx)(src.LemonButton,{to:urls.j.pipelineApp(pluginConfig.id,types.YU.Logs),id:`app-${pluginConfig.id}-logs`,fullWidth:!0,children:"View app logs"}),plugins[pluginConfig.plugin].url&&(0,jsx_runtime.jsx)(src.LemonButton,{to:plugins[pluginConfig.plugin].url,targetBlank:!0,id:`app-${pluginConfig.id}-source-code`,fullWidth:!0,children:"View app source code"}),(0,jsx_runtime.jsx)(src.LemonDivider,{}),(0,jsx_runtime.jsx)(src.LemonButton,{status:"danger",onClick:()=>{(0,deleteWithUndo.S)({endpoint:"plugin_config",object:{id:pluginConfig.id,name:pluginConfig.name},callback:loadPluginConfigs})},id:"app-reorder",disabledReason:canConfigurePlugins?void 0:"You do not have permission to delete apps.",fullWidth:!0,children:"Delete app"})]})})}}]})]})}var core_esm=__webpack_require__("./node_modules/.pnpm/@dnd-kit+core@6.0.8_react-dom@18.2.0_react@18.2.0/node_modules/@dnd-kit/core/dist/core.esm.js"),modifiers_esm=__webpack_require__("./node_modules/.pnpm/@dnd-kit+modifiers@6.0.1_@dnd-kit+core@6.0.8_react@18.2.0/node_modules/@dnd-kit/modifiers/dist/modifiers.esm.js"),sortable_esm=__webpack_require__("./node_modules/.pnpm/@dnd-kit+sortable@7.0.2_@dnd-kit+core@6.0.8_react@18.2.0/node_modules/@dnd-kit/sortable/dist/sortable.esm.js"),utilities_esm=__webpack_require__("./node_modules/.pnpm/@dnd-kit+utilities@3.2.1_react@18.2.0/node_modules/@dnd-kit/utilities/dist/utilities.esm.js"),PluginImage=__webpack_require__("./frontend/src/scenes/plugins/plugin/PluginImage.tsx"),transformationsLogic=__webpack_require__("./frontend/src/scenes/pipeline/transformationsLogic.tsx");function Transformations(){const{featureFlags}=(0,index_esm.useValues)(featureFlagLogic.h);if(!featureFlags[constants.y8.PIPELINE_UI])return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{});const{loading,sortedEnabledPluginConfigs,disabledPluginConfigs,plugins,canConfigurePlugins,shouldShowProductIntroduction}=(0,index_esm.useValues)(transformationsLogic.P),{openReorderModal,toggleEnabled,loadPluginConfigs}=(0,index_esm.useActions)(transformationsLogic.P),shouldShowEmptyState=0===sortedEnabledPluginConfigs.length&&0===disabledPluginConfigs.length;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(shouldShowEmptyState||shouldShowProductIntroduction)&&(0,jsx_runtime.jsx)(ProductIntroduction.C,{productName:"Pipeline transformations",thingName:"transformation",productKey:types.Md.PIPELINE_TRANSFORMATIONS,description:"Pipeline transformations allow you to enrich your data with additional information, such as geolocation.",docsURL:"https://posthog.com/docs/cdp",actionElementOverride:(0,jsx_runtime.jsx)(NewButton,{tab:types.OJ.Transformations}),isEmpty:!0}),!shouldShowEmptyState&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[sortedEnabledPluginConfigs.length>1&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(ReorderModal,{}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:["Processed sequentially.",(0,jsx_runtime.jsx)(src.LemonButton,{onClick:openReorderModal,noPadding:!0,id:"app-reorder",disabledReason:canConfigurePlugins?void 0:"You do not have permission to reorder plugins.",children:"Change order"})]})]}),(0,jsx_runtime.jsx)(src.LemonTable,{dataSource:[...sortedEnabledPluginConfigs,...disabledPluginConfigs],size:"xs",loading,columns:[{title:"Order",key:"order",sticky:!0,render:function RenderOrdering(_,pluginConfig){return pluginConfig.enabled?sortedEnabledPluginConfigs.findIndex((pc=>pc===pluginConfig))+1:null}},{title:"Name",sticky:!0,render:function RenderPluginName(_,pluginConfig){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(src.Tooltip,{title:"Click to update configuration, view metrics, and more",children:(0,jsx_runtime.jsx)(src.Link,{to:urls.j.pipelineApp(pluginConfig.id,types.YU.Configuration),children:(0,jsx_runtime.jsx)("span",{className:"row-name",children:pluginConfig.name})})}),pluginConfig.description&&(0,jsx_runtime.jsx)(LemonMarkdown.j,{className:"row-description",lowKeyHeadings:!0,children:pluginConfig.description})]})}},{title:"App",render:function RenderAppInfo(_,pluginConfig){return(0,jsx_runtime.jsx)(utils.Wf,{plugin:plugins[pluginConfig.plugin]})}},(0,columnUtils.yI)(),{title:"Status",render:function RenderStatus(_,pluginConfig){return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:pluginConfig.enabled?(0,jsx_runtime.jsx)(src.LemonTag,{type:"success",className:"uppercase",children:"Enabled"}):(0,jsx_runtime.jsx)(src.LemonTag,{type:"default",className:"uppercase",children:"Disabled"})})}},{width:0,render:function Render(_,pluginConfig){return(0,jsx_runtime.jsx)(More.T,{overlay:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(src.LemonButton,{onClick:()=>{toggleEnabled({enabled:!pluginConfig.enabled,id:pluginConfig.id})},id:`app-${pluginConfig.id}-enable-switch`,disabledReason:canConfigurePlugins?void 0:"You do not have permission to enable/disable apps.",fullWidth:!0,children:[pluginConfig.enabled?"Disable":"Enable"," app"]}),pluginConfig.enabled&&(0,jsx_runtime.jsx)(src.LemonButton,{onClick:openReorderModal,id:"app-reorder",disabledReason:canConfigurePlugins?void 0:"You do not have permission to reorder apps.",fullWidth:!0,children:"Reorder apps"}),(0,jsx_runtime.jsxs)(src.LemonButton,{to:urls.j.pipelineApp(pluginConfig.id,types.YU.Configuration),id:`app-${pluginConfig.id}-configuration`,fullWidth:!0,children:[canConfigurePlugins?"Edit":"View"," app configuration"]}),(0,jsx_runtime.jsx)(src.LemonButton,{to:urls.j.pipelineApp(pluginConfig.id,types.YU.Metrics),id:`app-${pluginConfig.id}-metrics`,fullWidth:!0,children:"View app metrics"}),(0,jsx_runtime.jsx)(src.LemonButton,{to:urls.j.pipelineApp(pluginConfig.id,types.YU.Logs),id:`app-${pluginConfig.id}-logs`,fullWidth:!0,children:"View app logs"}),plugins[pluginConfig.plugin].url&&(0,jsx_runtime.jsx)(src.LemonButton,{to:plugins[pluginConfig.plugin].url,targetBlank:!0,id:`app-${pluginConfig.id}-source-code`,fullWidth:!0,children:"View app source code"}),(0,jsx_runtime.jsx)(src.LemonDivider,{}),(0,jsx_runtime.jsx)(src.LemonButton,{status:"danger",onClick:()=>{(0,deleteWithUndo.S)({endpoint:"plugin_config",object:{id:pluginConfig.id,name:pluginConfig.name},callback:loadPluginConfigs})},id:"app-reorder",disabledReason:canConfigurePlugins?void 0:"You do not have permission to delete apps.",fullWidth:!0,children:"Delete app"})]})})}}]})]})]})}function ReorderModal(){const{reorderModalOpen,sortedEnabledPluginConfigs,temporaryOrder,pluginConfigsLoading}=(0,index_esm.useValues)(transformationsLogic.P),{closeReorderModal,setTemporaryOrder,savePluginConfigsOrder}=(0,index_esm.useActions)(transformationsLogic.P);return(0,jsx_runtime.jsx)(src.LemonModal,{onClose:closeReorderModal,isOpen:reorderModalOpen,width:600,title:"Reorder apps",description:(0,jsx_runtime.jsxs)("p",{children:["The order of apps is important as they are processed sequentially. You can"," ",(0,jsx_runtime.jsx)("b",{children:"drag and drop the apps below"})," to change their order."]}),footer:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",onClick:closeReorderModal,children:"Cancel"}),(0,jsx_runtime.jsx)(src.LemonButton,{loading:pluginConfigsLoading,type:"primary",onClick:()=>savePluginConfigsOrder(temporaryOrder),children:"Save order"})]}),children:(0,jsx_runtime.jsx)("div",{className:"flex flex-col gap-2",children:(0,jsx_runtime.jsx)(core_esm.LB,{modifiers:[modifiers_esm.DL,modifiers_esm.F4],onDragEnd:_ref=>{let{active,over}=_ref;if(active.id&&over&&active.id!==over.id){const from=sortedEnabledPluginConfigs.findIndex((config=>config.id===active.id)),to=sortedEnabledPluginConfigs.findIndex((config=>config.id===over.id)),newTemporaryOrder=(0,sortable_esm.Rp)(sortedEnabledPluginConfigs,from,to).reduce(((acc,pluginConfig,index)=>({...acc,[pluginConfig.id]:index+1})),{});setTemporaryOrder(newTemporaryOrder)}},children:(0,jsx_runtime.jsx)(sortable_esm.Fo,{items:sortedEnabledPluginConfigs,strategy:sortable_esm.qw,children:sortedEnabledPluginConfigs.map(((item,index)=>(0,jsx_runtime.jsx)(MinimalAppView,{pluginConfig:item,order:index},item.id)))})})})})}const MinimalAppView=_ref2=>{let{pluginConfig,order}=_ref2;const{plugins}=(0,index_esm.useValues)(transformationsLogic.P),{attributes,listeners,setNodeRef,transform,transition,isDragging}=(0,sortable_esm.nB)({id:pluginConfig.id}),plugin=plugins[pluginConfig.plugin];return(0,jsx_runtime.jsxs)("div",{ref:setNodeRef,className:"flex gap-2 cursor-move border rounded p-2 items-center bg-bg-light",style:{position:"relative",transform:utilities_esm.ux.Transform.toString(transform),transition,zIndex:isDragging?999999:void 0},...attributes,...listeners,children:[(0,jsx_runtime.jsx)(src.LemonBadge.Number,{count:order+1,maxDigits:3}),(0,jsx_runtime.jsx)(PluginImage.c,{plugin,size:"small"}),(0,jsx_runtime.jsx)("span",{className:"font-semibold",children:pluginConfig.name})]})};function Pipeline(){const{currentTab}=(0,index_esm.useValues)(pipelineLogic.B2),tab_to_content={[types.OJ.Filters]:(0,jsx_runtime.jsx)("div",{children:"Coming soon"}),[types.OJ.Transformations]:(0,jsx_runtime.jsx)(Transformations,{}),[types.OJ.Destinations]:(0,jsx_runtime.jsx)(Destinations,{}),[types.OJ.AppsManagement]:(0,jsx_runtime.jsx)(AppsManagement,{})};return(0,jsx_runtime.jsxs)("div",{className:"pipeline-scene",children:[(0,jsx_runtime.jsx)(PageHeader.m,{title:"Pipeline",caption:"Add filters or transformations to the events sent to PostHog or export them to other tools.",buttons:(0,jsx_runtime.jsx)(NewButton,{tab:currentTab})}),(0,jsx_runtime.jsx)(LemonTabs.T,{activeKey:currentTab,onChange:tab=>lib.router.actions.push(urls.j.pipeline(tab)),tabs:Object.values(types.OJ).map((tab=>({label:(0,pipelineLogic.$Y)(tab),key:tab,content:tab_to_content[tab]})))})]})}const Pipeline_scene={component:Pipeline,logic:pipelineLogic.B2}},"./frontend/src/scenes/pipeline/appsManagementLogic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{k:()=>appsManagementLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/lib/api.ts"),lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/lib/lemon-ui/LemonToast/LemonToast.tsx"),posthog_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/.pnpm/posthog-js@1.96.0/node_modules/posthog-js/dist/es.js"),scenes_plugins_access__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./frontend/src/scenes/plugins/access.ts"),scenes_userLogic__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./frontend/src/scenes/userLogic.ts"),_types__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./frontend/src/types.ts"),_sourceAppInitialCode__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./frontend/src/scenes/pipeline/sourceAppInitialCode.tsx"),_utils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./frontend/src/scenes/pipeline/utils.tsx");const GLOBAL_PLUGINS=new Set(["https://github.com/PostHog/bug-report-app","https://github.com/PostHog/early-access-features-app","https://github.com/PostHog/notification-bar-app","https://github.com/PostHog/pineapple-mode-app","https://github.com/PostHog/downsampling-plugin","https://github.com/PostHog/posthog-filter-out-plugin","https://github.com/PostHog/language-url-splitter-app","https://github.com/PostHog/posthog-app-url-parameters-to-event-properties","https://github.com/PostHog/posthog-plugin-geoip","https://github.com/PostHog/posthog-url-normalizer-plugin","https://github.com/PostHog/property-filter-plugin","https://github.com/PostHog/semver-flattener-plugin","https://github.com/PostHog/taxonomy-plugin","https://github.com/PostHog/timestamp-parser-plugin","https://github.com/PostHog/user-agent-plugin","https://github.com/PostHog/customerio-plugin","https://github.com/PostHog/hubspot-plugin","https://github.com/PostHog/pace-posthog-integration","https://github.com/PostHog/posthog-avo-plugin","https://github.com/PostHog/posthog-engage-so-plugin","https://github.com/PostHog/posthog-intercom-plugin","https://github.com/PostHog/posthog-laudspeaker-app","https://github.com/PostHog/posthog-patterns-app","https://github.com/PostHog/posthog-twilio-plugin","https://github.com/PostHog/posthog-variance-plugin","https://github.com/PostHog/rudderstack-posthog-plugin","https://github.com/PostHog/salesforce-plugin","https://github.com/PostHog/sendgrid-plugin","https://github.com/posthog/posthog-plugin-replicator"]);function capturePluginEvent(event,plugin,type){posthog_js__WEBPACK_IMPORTED_MODULE_4__.ZP.capture(event,{plugin_name:plugin.name,plugin_url:plugin.url?.startsWith("file:")?"file://masked-local-path":plugin.url,plugin_tag:plugin.tag,plugin_installation_type:type})}const appsManagementLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","pipeline","appsManagementLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)({values:[scenes_userLogic__WEBPACK_IMPORTED_MODULE_6__.userLogic,["user"]]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setPluginUrl:pluginUrl=>({pluginUrl}),setLocalPluginPath:localPluginPath=>({localPluginPath}),setSourcePluginName:sourcePluginName=>({sourcePluginName}),setSourcePluginKind:sourcePluginKind=>({sourcePluginKind}),uninstallPlugin:id=>({id}),installPlugin:(pluginType,url)=>({pluginType,url}),installPluginFromUrl:url=>({url}),installSourcePlugin:name=>({name}),installLocalPlugin:path=>({path}),patchPlugin:function(id){return{id,pluginChanges:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}}}}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)((_ref=>{let{values}=_ref;return{plugins:[{},{loadPlugins:async()=>{const results=await(0,_utils__WEBPACK_IMPORTED_MODULE_9__.cw)("api/organizations/@current/plugins"),plugins={};for(const plugin of results)plugins[plugin.id]=plugin;return plugins},installPlugin:async _ref2=>{let{pluginType,url}=_ref2;if(!values.canInstallPlugins)return lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_3__.UJ.error("You don't have permission to install apps."),values.plugins;const payload={plugin_type:pluginType};if(url||pluginType===_types__WEBPACK_IMPORTED_MODULE_7__.ak.Repository)payload.url=url;else if(pluginType===_types__WEBPACK_IMPORTED_MODULE_7__.ak.Custom)payload.url=values.pluginUrl;else if(pluginType===_types__WEBPACK_IMPORTED_MODULE_7__.ak.Local)payload.url=`file:${values.localPluginPath}`;else{if(pluginType!==_types__WEBPACK_IMPORTED_MODULE_7__.ak.Source)return lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_3__.UJ.error("Unsupported installation type."),values.plugins;payload.name=values.sourcePluginName}const response=await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.create("api/organizations/@current/plugins",payload);return pluginType===_types__WEBPACK_IMPORTED_MODULE_7__.ak.Source&&await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.update(`api/organizations/@current/plugins/${response.id}/update_source`,(0,_sourceAppInitialCode__WEBPACK_IMPORTED_MODULE_8__.g)(values.sourcePluginName,values.sourcePluginKind)),capturePluginEvent("plugin installed",response,pluginType),{...values.plugins,[response.id]:response}},uninstallPlugin:async _ref3=>{let{id}=_ref3;values.canGloballyManagePlugins||lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_3__.UJ.error("You don't have permission to manage apps."),await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.delete(`api/organizations/@current/plugins/${id}`),capturePluginEvent("plugin uninstalled",values.plugins[id],values.plugins[id].plugin_type);const{[id]:_discard,...rest}=values.plugins;return rest},patchPlugin:async _ref4=>{let{id,pluginChanges}=_ref4;const response=await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.update(`api/organizations/@current/plugins/${id}`,pluginChanges);return{...values.plugins,[id]:response}}}],unusedPlugins:[[],{loadUnusedPlugins:async()=>await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.get("api/organizations/@current/plugins/unused")}]}})),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({installingPluginUrl:[null,{installPlugin:(_,_ref5)=>{let{url}=_ref5;return url||null},installPluginSuccess:()=>null,installPluginFailure:()=>null}],pluginUrl:["",{setPluginUrl:(_,_ref6)=>{let{pluginUrl}=_ref6;return pluginUrl},installPluginSuccess:()=>""}],localPluginPath:["",{setLocalPluginPath:(_,_ref7)=>{let{localPluginPath}=_ref7;return localPluginPath},installPluginSuccess:()=>""}],sourcePluginName:["",{setSourcePluginName:(_,_ref8)=>{let{sourcePluginName}=_ref8;return sourcePluginName},installPluginSuccess:()=>""}],sourcePluginKind:[_sourceAppInitialCode__WEBPACK_IMPORTED_MODULE_8__.n.FilterEvent,{setSourcePluginKind:(_,_ref9)=>{let{sourcePluginKind}=_ref9;return sourcePluginKind},installPluginSuccess:()=>_sourceAppInitialCode__WEBPACK_IMPORTED_MODULE_8__.n.FilterEvent}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({canInstallPlugins:[s=>[s.user],user=>(0,scenes_plugins_access__WEBPACK_IMPORTED_MODULE_5__.FZ)(user?.organization)],canGloballyManagePlugins:[s=>[s.user],user=>(0,scenes_plugins_access__WEBPACK_IMPORTED_MODULE_5__.YU)(user?.organization)],globalPlugins:[s=>[s.plugins],plugins=>Object.values(plugins).filter((plugin=>plugin.is_global))],localPlugins:[s=>[s.plugins],plugins=>Object.values(plugins).filter((plugin=>!plugin.is_global))],missingGlobalPlugins:[s=>[s.plugins],plugins=>{const existingUrls=new Set(Object.values(plugins).map((p=>p.url)));return Array.from(GLOBAL_PLUGINS).filter((url=>!existingUrls.has(url)))}],shouldBeGlobalPlugins:[s=>[s.plugins],plugins=>Object.values(plugins).filter((plugin=>plugin.url&&GLOBAL_PLUGINS.has(plugin.url)&&!plugin.is_global))],shouldNotBeGlobalPlugins:[s=>[s.plugins],plugins=>Object.values(plugins).filter((plugin=>!(plugin.url&&GLOBAL_PLUGINS.has(plugin.url))&&plugin.is_global))]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.afterMount)((_ref10=>{let{actions}=_ref10;actions.loadPlugins(),actions.loadUnusedPlugins()}))])},"./frontend/src/scenes/pipeline/pipelineLogic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$Y:()=>humanFriendlyTabName,B2:()=>pipelineLogic,v9:()=>singularName});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_router__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.5/node_modules/kea-router/lib/index.js"),scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/scenes/sceneTypes.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/scenes/urls.ts"),_types__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/types.ts");const singularName=tab=>{switch(tab){case _types__WEBPACK_IMPORTED_MODULE_4__.OJ.Filters:return"filter";case _types__WEBPACK_IMPORTED_MODULE_4__.OJ.Transformations:return"transformation";case _types__WEBPACK_IMPORTED_MODULE_4__.OJ.Destinations:return"destination";default:return""}},humanFriendlyTabName=tab=>{switch(tab){case _types__WEBPACK_IMPORTED_MODULE_4__.OJ.Filters:return"Filters";case _types__WEBPACK_IMPORTED_MODULE_4__.OJ.Transformations:return"Transformations";case _types__WEBPACK_IMPORTED_MODULE_4__.OJ.Destinations:return"Destinations";case _types__WEBPACK_IMPORTED_MODULE_4__.OJ.AppsManagement:return"Apps Management"}},pipelineLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","pipeline","pipelineLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setCurrentTab:function(){return{tab:arguments.length>0&&void 0!==arguments[0]?arguments[0]:_types__WEBPACK_IMPORTED_MODULE_4__.OJ.Destinations}}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({currentTab:[_types__WEBPACK_IMPORTED_MODULE_4__.OJ.Destinations,{setCurrentTab:(_,_ref)=>{let{tab}=_ref;return tab}}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)((()=>({breadcrumbs:[s=>[s.currentTab],tab=>[{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_2__.x.Pipeline,name:"Data pipeline"},{key:tab,name:humanFriendlyTabName(tab)}]]}))),(0,kea_router__WEBPACK_IMPORTED_MODULE_1__.actionToUrl)((_ref2=>{let{values}=_ref2;return{setCurrentTab:()=>[scenes_urls__WEBPACK_IMPORTED_MODULE_3__.j.pipeline(values.currentTab)]}})),(0,kea_router__WEBPACK_IMPORTED_MODULE_1__.urlToAction)((_ref3=>{let{actions,values}=_ref3;return{"/pipeline/:tab":_ref4=>{let{tab}=_ref4;tab!==values.currentTab&&actions.setCurrentTab(tab)}}}))])},"./frontend/src/scenes/pipeline/sourceAppInitialCode.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{g:()=>getInitialCode,n:()=>SourcePluginKind});let SourcePluginKind=function(SourcePluginKind){return SourcePluginKind.FilterEvent="filterEvent",SourcePluginKind.ModifyEvent="modifyEvent",SourcePluginKind.ComposeWebhook="composeWebhook",SourcePluginKind.Site="site",SourcePluginKind.Frontend="frontend",SourcePluginKind}({});function getInitialCode(name,kind){switch(kind){case SourcePluginKind.FilterEvent:return{"plugin.json":JSON.stringify({name,config:[{markdown:"Specify your config here"},{key:"eventToSkip",name:"Event to skip",type:"string",hint:"If the event name matches this, it will be skipped",default:"$pageview",required:!1}]},null,4),"index.ts":"// Learn more about plugins at: https://posthog.com/docs/apps/build\n\n// Processes each event, optionally dropping it\nexport function processEvent(event, { config }) {\n    if (event.event === config.eventToSkip) {\n        return null\n    }\n    return event\n}\n\n// Runs when the plugin is loaded, allows for preparing it as needed\nexport function setupPlugin (meta) {\n    console.log(`The date is ${new Date().toDateString()}`)\n}"};case SourcePluginKind.ModifyEvent:return{"plugin.json":JSON.stringify({name,config:[{markdown:"Specify your config here"},{key:"propertyToRemove",name:"Property to remove",type:"string",hint:"This property will be removed from all events",default:"$browser",required:!1}]},null,4),"index.ts":"// Learn more about plugins at: https://posthog.com/docs/apps/build\n\n// Processes each event, optionally modify it\nexport function processEvent(event, { config }) {\n    event.properties[config.propertyToRemove] = undefined\n    return event\n}\n\n// Runs when the plugin is loaded, allows for preparing it as needed\nexport function setupPlugin (meta) {\n    console.log(`The date is ${new Date().toDateString()}`)\n}"};case SourcePluginKind.ComposeWebhook:return{"plugin.json":JSON.stringify({name,config:[{markdown:"Specify your config here"},{key:"url",name:"The destination url",type:"string",hint:"Where the webhook will be sent to",default:"",required:!0}]},null,4),"index.ts":"// Learn more about plugins at: https://posthog.com/docs/apps/build\nimport { PostHogEvent, Webhook } from '@posthog/plugin-scaffold'\n\nexport function composeWebhook(event: PostHogEvent, { config }: any): Webhook {\n    return {\n        url: config.url,\n        body: JSON.stringify(event),\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        method: 'POST',\n    }\n}"};case SourcePluginKind.Site:return{"plugin.json":JSON.stringify({name,config:[{markdown:"Specify your config here"},{key:"name",name:"Person to greet",type:"string",hint:"Used to personalise the property `hello`",default:"world",required:!1}]},null,4),"site.ts":"export function inject({ config, posthog }) {\n    console.log('Hello from PostHog-JS')\n}\n\""};case SourcePluginKind.Frontend:return{"plugin.json":JSON.stringify({name,config:[{markdown:"Specify your config here"},{key:"name",name:"Person to greet",type:"string",hint:"Used to personalise the property `hello`",default:"world",required:!1}]},null,4),"frontend.tsx":'import React from "react"\n\n                export const scene = {\n                    title: "My Stuff",\n                    component: function MyStuff({ config }) {\n                        return (\n                            <div>\n                                <h1>My Favourite Links</h1>\n                                <ul>\n                                    <li>\n                                        <a href="https://news.ycombinator.com">The NEWS</a>\n                                    </li>\n                                </ul>\n                                <h1>My Favourite Cow</h1>\n                                <img src="https://media.giphy.com/media/RYKFEEjtYpxL2/giphy.gif" />\n                            </div>\n                        )\n                    },\n                }'}}}}}]);