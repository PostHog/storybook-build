(window.webpackJsonp=window.webpackJsonp||[]).push([[243],{"./frontend/src/scenes/billing/Billing.tsx":function(B,p,n){"use strict";n.r(p),n.d(p,"scene",function(){return pe}),n.d(p,"Billing",function(){return $});var g=n("./node_modules/react/index.js"),e=n.n(g),G=n("./frontend/src/lib/components/PageHeader.tsx"),H=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),W=n.n(H),K=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),T=n.n(K),ve=n("./node_modules/core-js/modules/es.function.name.js"),fe=n("./node_modules/core-js/modules/es.object.keys.js"),be=n("./node_modules/core-js/modules/es.symbol.js"),ye=n("./node_modules/core-js/modules/es.array.filter.js"),he=n("./node_modules/core-js/modules/es.object.to-string.js"),je=n("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Ee=n("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Oe=n("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),J=n("./node_modules/antd/es/alert/index.js"),E=n("./node_modules/antd/es/button/index.js"),h=n("./node_modules/antd/es/card/index.js"),U=n("./node_modules/antd/es/input-number/index.js"),v=n("./node_modules/kea/lib/index.esm.js"),L=n.p+"images/plan-default.64d2c4930c12267ba45d77bebf37405c.svg",N=n("./node_modules/@ant-design/icons/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),Q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M876.6 239.5c-.5-.9-1.2-1.8-2-2.5-5-5-13.1-5-18.1 0L684.2 409.3l-67.9-67.9L788.7 169c.8-.8 1.4-1.6 2-2.5 3.6-6.1 1.6-13.9-4.5-17.5-98.2-58-226.8-44.7-311.3 39.7-67 67-89.2 162-66.5 247.4l-293 293c-3 3-2.8 7.9.3 11l169.7 169.7c3.1 3.1 8.1 3.3 11 .3l292.9-292.9c85.5 22.8 180.5.7 247.6-66.4 84.4-84.5 97.7-213.1 39.7-311.3zM786 499.8c-58.1 58.1-145.3 69.3-214.6 33.6l-8.8 8.8-.1-.1-274 274.1-79.2-79.2 230.1-230.1s0 .1.1.1l52.8-52.8c-35.7-69.3-24.5-156.5 33.6-214.6a184.2 184.2 0 01144-53.5L537 318.9a32.05 32.05 0 000 45.3l124.5 124.5a32.05 32.05 0 0045.3 0l132.8-132.8c3.7 51.8-14.4 104.8-53.6 143.9z"}}]},name:"tool",theme:"outlined"},X=Q,Z=n("./node_modules/@ant-design/icons/es/components/AntdIcon.js"),I=function(t,s){return g.createElement(Z.a,Object(N.a)(Object(N.a)({},t),{},{ref:s,icon:X}))};I.displayName="ToolOutlined";var A=g.forwardRef(I),w=n("./node_modules/@ant-design/icons/es/icons/WarningOutlined.js"),f=n("./frontend/src/scenes/billing/billingLogic.ts"),k=n("./frontend/src/lib/logic/featureFlagLogic.ts"),q=n("./frontend/src/lib/constants.tsx");function M(r,t){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);t&&(a=a.filter(function(c){return Object.getOwnPropertyDescriptor(r,c).enumerable})),s.push.apply(s,a)}return s}function D(r){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?M(Object(s),!0).forEach(function(a){W()(r,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):M(Object(s)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(s,a))})}return r}function O(r){var t=r.plan,s=Object(v.useValues)(f.b),a=s.billing,c=Object(v.useActions)(f.b),l=c.setBillingLimit,u=e.a.useState((a==null?void 0:a.billing_limit)||0),d=T()(u,2),i=d[0],b=d[1],y=Object(v.useValues)(k.a),m=y.featureFlags,j=m[q.h.BILLING_LIMIT];return e.a.createElement(e.a.Fragment,null,e.a.createElement("div",{className:"space-top"}),a!=null&&a.should_setup_billing?e.a.createElement(J.a,{type:"warning",message:e.a.createElement(e.a.Fragment,null,"Your plan is ",e.a.createElement("b",null,"currently inactive")," as you haven't finished setting up your billing information."),action:a.subscription_url&&e.a.createElement(E.a,{href:a.subscription_url,icon:e.a.createElement(A,null)},"Finish setup"),showIcon:!0,icon:e.a.createElement(w.a,null)}):e.a.createElement(h.a,{title:"Organization billing plan"},e.a.createElement("div",{style:{display:"flex",alignItems:"center"}},e.a.createElement("div",null,e.a.createElement("img",{src:t.image_url||L,alt:"",height:100,width:100})),e.a.createElement("div",{style:{flexGrow:1,paddingLeft:16}},e.a.createElement("h3",{className:"l3",style:{marginBottom:8}},t.name),e.a.createElement("div",{style:{marginTop:4}},t.price_string),j&&e.a.createElement("div",{style:{marginTop:8,marginBottom:8,alignItems:"center",display:"flex"}},"Set monthly billing limit to"," ",e.a.createElement(U.a,{style:{width:250,marginLeft:8,marginRight:8},onChange:function(P){b(P)},value:i,min:0,step:10,addonBefore:"$",addonAfter:"USD / MONTH"})," ",e.a.createElement(E.a,{type:"primary",onClick:function(){a&&l(D(D({},a),{},{billing_limit:i}))}},"Submit")),e.a.createElement("div",{className:"text-muted mt-4"},"Click on ",e.a.createElement("b",null,"manage subscription")," to cancel your billing agreement,"," ",e.a.createElement("b",null,"update your card")," or other billing information.")),e.a.createElement("div",null,e.a.createElement(E.a,{type:"primary",href:"/billing/manage",icon:e.a.createElement(A,null)},"Manage subscription"),e.a.createElement("div",{className:"text-muted text-center"},"Get past invoices too")))))}try{O.displayName="CurrentPlan",O.__docgenInfo={description:"",displayName:"CurrentPlan",props:{plan:{defaultValue:null,description:"",name:"plan",required:!0,type:{name:"PlanInterface"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/billing/CurrentPlan.tsx#CurrentPlan"]={docgenInfo:O.__docgenInfo,name:"CurrentPlan",path:"frontend/src/scenes/billing/CurrentPlan.tsx#CurrentPlan"})}catch(r){}var _=n("./node_modules/antd/es/progress/index.js"),Y=n("./frontend/src/lib/utils.tsx"),ee=n("./frontend/src/lib/components/Tooltip.tsx"),ne=n("./frontend/src/lib/components/LemonTable/index.ts"),F=n("./frontend/src/lib/dayjs.ts");function te(){var r,t=Object(v.useValues)(f.b),s=t.eventAllocation,a=t.percentage,c=t.strokeColor,l=t.billing,u=l==null?void 0:l.plan;if(!l)return null;var d=[{title:"Tier",dataIndex:"name"},{title:"Price per event",render:function(y,m){return e.a.createElement("div",null,"$",m.price_per_event)}},{title:"Number of events",dataIndex:"number_of_events"},{title:"Sub-total",render:function(y,m){return e.a.createElement("div",null,"$",m.subtotal)}},{title:"Running total",render:function(y,m){return e.a.createElement("div",null,"$",m.running_total)}}],i=l.current_bill_usage||l.current_usage;return e.a.createElement(e.a.Fragment,null,e.a.createElement("div",{className:"space-top"}),e.a.createElement(h.a,{title:"Current monthly usage"},l.should_display_current_bill&&e.a.createElement(e.a.Fragment,null,e.a.createElement("h3",{className:"l3"},"Current bill amount"),(l==null?void 0:l.current_bill_amount)!==void 0&&(l==null?void 0:l.current_bill_amount)!==null?e.a.createElement(e.a.Fragment,null,"This is the amount (in dollars) of the bill for the currently ongoing period. The final amount will be billed a few days after the end of the month. Please note this number is reported on a daily basis,"," ",e.a.createElement("b",null,"so events ingested in the last 24 hours may not be reflected yet."),e.a.createElement("div",{className:"bill-amount"},"$".concat(l==null||(r=l.current_bill_amount)===null||r===void 0?void 0:r.toLocaleString())),e.a.createElement(ne.a,{columns:d,dataSource:l.tiers||[]})):e.a.createElement(e.a.Fragment,null,"We can't show your current bill amount right now. Please check back again in a few minutes or"," ",e.a.createElement("a",{href:"https://posthog.com/support/",target:"_blank"},"contact us")," ","if this message does not disappear.")),e.a.createElement("h3",{className:"l3 mt-4"},"Current event usage"),i!==null?e.a.createElement(e.a.Fragment,null,"Your organization has used"," ",e.a.createElement(ee.a,{title:"".concat(i.toLocaleString()," events")},e.a.createElement("b",null,Object(Y.p)(i)))," ","events ",l.current_bill_usage?"this billing period":"this month"," (calculated every day)."," ",s&&e.a.createElement(e.a.Fragment,null,"You can use up to ",e.a.createElement("b",null,Object(Y.p)(s))," events per month."),u&&!u.event_allowance&&!u.is_metered_billing&&"Your current plan has an unlimited event allocation.",e.a.createElement(_.a,{type:"line",percent:a!==null?Math.floor(a*100):100,strokeColor:c,status:a!==null?"normal":"success"})):e.a.createElement("div",null,"Currently we do not have information about the number of billed events. Please check back again in a few minutes or"," ",e.a.createElement("a",{href:"https://posthog.com/support/",target:"_blank"},"contact us")," ","if this message does not disappear."),(l==null?void 0:l.current_bill_cycle)&&e.a.createElement("div",{className:"mt-4 text-muted"},"Your current billing period runs from"," ",e.a.createElement("strong",null,F.a.unix(l.current_bill_cycle.current_period_start).format("MMMM DD, YYYY"))," ","until"," ",e.a.createElement("strong",null,F.a.unix(l.current_bill_cycle.current_period_end).format("MMMM DD, YYYY")),", which is when you'll be charged.")))}var le=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),ae=n.n(le),re=n("./node_modules/@babel/runtime/regenerator/index.js"),R=n.n(re),Se=n("./node_modules/core-js/modules/es.promise.js"),Pe=n("./node_modules/core-js/modules/es.array.map.js"),V=n("./node_modules/antd/es/skeleton/index.js"),se=n("./node_modules/antd/es/row/index.js"),oe=n("./node_modules/antd/es/col/index.js"),ie=n("./frontend/src/lib/components/Spinner/Spinner.tsx");function ce(r){var t=r.plan,s=r.onSubscribe,a=Object(g.useState)(""),c=T()(a,2),l=c[0],u=c[1],d=Object(g.useState)(!0),i=T()(d,2),b=i[0],y=i[1],m=function(){var j=ae()(R.a.mark(function S(P){var C;return R.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,fetch("/api/plans/".concat(P,"/template/"));case 2:if(C=o.sent,!C.ok){o.next=9;break}return o.t0=u,o.next=7,C.text();case 7:o.t1=o.sent,(0,o.t0)(o.t1);case 9:y(!1);case 10:case"end":return o.stop()}},S)}));return function(P){return j.apply(this,arguments)}}();return Object(g.useEffect)(function(){m(t.key)},[t.key]),e.a.createElement(h.a,null,e.a.createElement("div",{className:"cursor-pointer",onClick:function(){return s(t)}},e.a.createElement("img",{src:t.image_url||L,alt:"",height:100,width:100}),e.a.createElement("h3",{style:{fontSize:22}},t.name),e.a.createElement("div",{style:{fontWeight:"bold",marginBottom:16,fontSize:16}},t.price_string)),e.a.createElement("div",null,e.a.createElement(E.a,{"data-attr":"btn-subscribe-now","data-plan":t.key,type:"primary",onClick:function(){return s(t)}},"Subscribe now")),b?e.a.createElement(V.a,{paragraph:{rows:6},title:!1,className:"mt-4",active:!0}):e.a.createElement("div",{className:"plan-description",dangerouslySetInnerHTML:{__html:l}}))}function de(){var r=Object(v.useValues)(f.b),t=r.plans,s=r.plansLoading,a=r.billingSubscriptionLoading,c=Object(v.useActions)(f.b),l=c.subscribe,u=function(i){l(i.key)};return!t.length&&!s?null:e.a.createElement(e.a.Fragment,null,e.a.createElement("div",{className:"space-top"}),s?e.a.createElement(h.a,null,e.a.createElement(V.a,{active:!0})):e.a.createElement(h.a,{title:"Billing Plan Enrollment"},e.a.createElement(se.a,{gutter:16,className:"space-top",style:{display:"flex",justifyContent:"center"}},t.map(function(d){return e.a.createElement(oe.a,{sm:8,key:d.key,className:"text-center"},a?e.a.createElement(ie.a,{className:"text-2xl"}):e.a.createElement(ce,{plan:d,onSubscribe:u}))}))))}var ue=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),me=n.n(ue),ge=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/billing/Billing.scss"),z=n.n(ge),x={};x.insert="head",x.singleton=!1;var Be=me()(z.a,x),Te=z.a.locals||{},pe={component:$,logic:f.b};function $(){var r=Object(v.useValues)(f.b),t=r.billing;return e.a.createElement("div",{className:"BillingPage"},e.a.createElement(G.a,{title:"Billing & usage information"}),e.a.createElement(te,null),t!=null&&t.plan?e.a.createElement(O,{plan:t.plan}):e.a.createElement(de,null),e.a.createElement("div",{style:{marginBottom:128}}))}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/billing/Billing.scss":function(B,p,n){var g=n("./node_modules/css-loader/dist/runtime/api.js");p=g(!1),p.push([B.i,".BillingPage .plan-description ol,.BillingPage .plan-description ul{margin-top:1rem;padding-left:0;list-style:none;text-align:center}.BillingPage .plan-description ol li,.BillingPage .plan-description ul li{line-height:1.2rem;margin-bottom:1rem}.BillingPage .plan-description ol .disclaimer,.BillingPage .plan-description ul .disclaimer{font-size:10px;font-weight:700;vertical-align:top;padding-left:1px}.BillingPage .plan-description .disclaimer-details{font-size:.75rem;color:var(--muted);margin-top:1rem}.BillingPage .bill-amount{margin-top:.5rem;font-size:1.2rem;font-weight:700;text-align:center}",""]),B.exports=p}}]);
