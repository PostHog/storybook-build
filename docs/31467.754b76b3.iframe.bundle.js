"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[31467],{"../../frontend/src/scenes/pipeline/hogfunctions/integrations/IntegrationChoice.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{a:()=>IntegrationChoice});var _posthog_icons__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.11.6_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),kea__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib_api__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/api.ts"),lib_integrations_integrationsLogic__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/integrations/integrationsLogic.ts"),lib_integrations_IntegrationView__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/lib/integrations/IntegrationView.tsx"),lib_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/lib/utils.tsx"),scenes_urls__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/scenes/urls.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function IntegrationChoice(_ref){let{onChange,value,schema,integration,redirectUrl,beforeRedirect}=_ref,{integrationsLoading,integrations}=(0,kea__WEBPACK_IMPORTED_MODULE_2__.useValues)(lib_integrations_integrationsLogic__WEBPACK_IMPORTED_MODULE_4__.a),{newGoogleCloudKey}=(0,kea__WEBPACK_IMPORTED_MODULE_2__.useActions)(lib_integrations_integrationsLogic__WEBPACK_IMPORTED_MODULE_4__.a),integrationsOfKind=integrations?.filter(x=>x.kind===integration),integrationKind=integrationsOfKind?.find(integration=>integration.id===value);if(!integration)return null;if(integrationsLoading)return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.yW,{className:"h-10"});let kindName="google-pubsub"==integration?"Google Cloud Pub/Sub":"google-cloud-storage"==integration?"Google Cloud Storage":"google-ads"==integration?"Google Ads":"linkedin-ads"==integration?"LinkedIn Ads":(0,lib_utils__WEBPACK_IMPORTED_MODULE_6__.fm)(integration);function uploadKey(kind){let input=document.createElement("input");input.type="file",input.accept=".json",input.onchange=async e=>{let file=e.target.files?.[0];file&&newGoogleCloudKey(kind,file,integration=>onChange?.(integration.id))},input.click()}let button=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.d6,{items:[integrationsOfKind?.length?{items:[...integrationsOfKind?.map(integration=>({icon:react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx("img",{src:integration.icon_url,className:"w-6 h-6 rounded"}),onClick:()=>onChange?.(integration.id),active:integration.id===value,label:integration.display_name}))||[]]}:null,["google-pubsub","google-cloud-storage"].includes(integration)?{items:[{onClick:()=>uploadKey(integration),label:"Upload Google Cloud .json key file"}]}:{items:[{to:lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.integrations.authorizeUrl({kind:integration,next:redirectUrl}),disableClientSideRouting:!0,onClick:beforeRedirect,label:integrationsOfKind?.length?`Connect to a different integration for ${kindName}`:`Connect to ${kindName}`}]},{items:[{to:scenes_urls__WEBPACK_IMPORTED_MODULE_7__.j.settings("project-integrations"),label:"Manage integrations",sideIcon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_0__.IconExternal,{})},value?{onClick:()=>onChange?.(null),label:"Clear",sideIcon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_0__.IconX,{})}:null]}],children:integrationKind?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{type:"secondary",children:"Change"}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_1__.Jp,{type:"secondary",children:["Choose ",kindName," connection"]})});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.Fragment,{children:integrationKind?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(lib_integrations_IntegrationView__WEBPACK_IMPORTED_MODULE_5__.K,{schema:schema,integration:integrationKind,suffix:button}):button})}}}]);