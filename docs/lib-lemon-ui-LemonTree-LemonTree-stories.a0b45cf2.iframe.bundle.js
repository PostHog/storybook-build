"use strict";(self.webpackChunk_posthog_frontend=self.webpackChunk_posthog_frontend||[]).push([[87702],{"./frontend/src/lib/lemon-ui/LemonTree/LemonTree.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>LemonTree_stories});var posthog_icons_es=__webpack_require__("./node_modules/.pnpm/@posthog+icons@0.10.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),react=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),dist=__webpack_require__("./node_modules/.pnpm/@radix-ui+react-accordion@1.2.2_@types+react-dom@18.2.14_@types+react@17.0.52_react-dom@18.2._c6uf3s6x4crpw25xr5krnlyb7y/node_modules/@radix-ui/react-accordion/dist/index.mjs"),css_classes=__webpack_require__("./frontend/src/lib/utils/css-classes.ts"),LemonButton=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/index.ts"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let LemonTreeNode=(0,react.forwardRef)((_ref,ref)=>{let{className,data,selectedId,focusedId,handleClick,expandedItemIds,setExpandedItemIds,defaultNodeIcon,showFolderActiveState}=_ref,ICON_CLASSES="size-6 aspect-square flex place-items-center";function getIcon(item,expandedItemIds){return item.children?(0,jsx_runtime.jsx)("span",{className:ICON_CLASSES,children:(0,jsx_runtime.jsx)(posthog_icons_es.IconChevronRight,{className:(0,css_classes.cn)("transition-transform scale-75 stroke-2",expandedItemIds.includes(item.id)?"rotate-90":"")})}):(0,jsx_runtime.jsx)("span",{className:(0,css_classes.cn)(ICON_CLASSES,{"text-muted-alt":item.disabledReason}),children:item.icon||defaultNodeIcon||(0,jsx_runtime.jsx)("div",{className:ICON_CLASSES})})}return data instanceof Array||(data=[data]),(0,jsx_runtime.jsx)("ul",{className:(0,css_classes.cn)("list-none m-0 p-0",className),role:"group",children:data.map(item=>(0,jsx_runtime.jsx)(dist.fC,{type:"multiple",value:expandedItemIds,onValueChange:s=>setExpandedItemIds(s),ref:ref,disabled:!!item.disabledReason,children:(0,jsx_runtime.jsxs)(dist.ck,{value:item.id,className:"flex flex-col w-full",children:[(0,jsx_runtime.jsx)(dist.xz,{className:"flex items-center gap-2 w-full h-8",asChild:!0,children:(0,jsx_runtime.jsx)(LemonButton.J,{className:(0,css_classes.cn)("flex-1 flex items-center gap-2 cursor-pointer pl-0 font-normal"),onClick:()=>handleClick(item),type:selectedId===item.id?"secondary":"tertiary",role:"treeitem",tabIndex:-1,size:"small",fullWidth:!0,active:focusedId===item.id||selectedId===item.id||showFolderActiveState&&item.children&&expandedItemIds.includes(item.id),icon:getIcon(item,expandedItemIds),disabledReason:item.disabledReason,tooltipPlacement:"right",children:(0,jsx_runtime.jsx)("span",{className:(0,css_classes.cn)("",{"font-semibold":selectedId===item.id,"text-muted-alt":item.disabledReason}),children:item.name})})}),item.children&&(0,jsx_runtime.jsx)(dist.VY,{children:(0,jsx_runtime.jsx)(LemonTreeNode,{data:item.children,selectedId:selectedId,focusedId:focusedId,handleClick:handleClick,expandedItemIds:expandedItemIds,setExpandedItemIds:setExpandedItemIds,defaultNodeIcon:defaultNodeIcon,showFolderActiveState:showFolderActiveState,className:"ml-4 space-y-px"})})]})},item.id))})});LemonTreeNode.displayName="LemonTreeNode";let LemonTree=(0,react.forwardRef)((_ref2,ref)=>{let{data,defaultSelectedFolderOrNodeId,onFolderClick,onNodeClick,expandAllFolders=!1,defaultNodeIcon,className,showFolderActiveState=!1,contentRef,...props}=_ref2,[selectedId,setSelectedId]=(0,react.useState)(defaultSelectedFolderOrNodeId),[focusedId,setFocusedId]=(0,react.useState)(defaultSelectedFolderOrNodeId),[typeAheadBuffer,setTypeAheadBuffer]=(0,react.useState)(""),typeAheadTimeoutRef=(0,react.useRef)();function collectAllIds(items,allIds){items instanceof Array?items.forEach(item=>{item.disabledReason||allIds.push(item.id),item.children&&collectAllIds(item.children,allIds)}):(items.disabledReason||allIds.push(items.id),items.children&&collectAllIds(items.children,allIds))}let[expandedItemIds,setExpandedItemIds]=(0,react.useState)(()=>{if(expandAllFolders){let allIds=[];return collectAllIds(data,allIds),allIds}if(!defaultSelectedFolderOrNodeId)return[];let ids=[];function walkTreeItems(items,targetId){if(items instanceof Array)for(let item of items){if(ids.push(item.id),walkTreeItems(item,targetId))return!0;ids.pop()}else if(items.id===targetId)return!0;else if(items.children)return walkTreeItems(items.children,targetId);return!1}return walkTreeItems(data,defaultSelectedFolderOrNodeId),ids}),getVisibleItems=(0,react.useCallback)(()=>{let items=[],traverse=nodes=>{(nodes instanceof Array?nodes:[nodes]).forEach(node=>{items.push(node),node.children&&expandedItemIds.includes(node.id)&&traverse(node.children)})};return traverse(data),items},[data,expandedItemIds]),focusContent=(0,react.useCallback)(()=>{contentRef?.current&&(contentRef.current.focus(),setFocusedId(void 0))},[contentRef]),findPathToItem=function(items,targetId){let path=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let item of items){if(item.id===targetId)return path;if(item.children){let newPath=findPathToItem(item.children,targetId,[...path,item.id]);if(newPath.length>0)return newPath}}return[]},handleTypeAhead=(0,react.useCallback)(char=>{typeAheadTimeoutRef.current&&clearTimeout(typeAheadTimeoutRef.current);let newBuffer=typeAheadBuffer+char.toLowerCase();setTypeAheadBuffer(newBuffer),typeAheadTimeoutRef.current=setTimeout(()=>{setTypeAheadBuffer("")},500);let visibleItems=getVisibleItems(),currentIndex=visibleItems.findIndex(item=>item.id===focusedId),match=[...visibleItems.slice(currentIndex+1),...visibleItems.slice(0,currentIndex+1)].find(item=>item.name.toLowerCase().startsWith(newBuffer));if(match){setFocusedId(match.id);let path=findPathToItem(Array.isArray(data)?data:[data],match.id);path.length>0&&setExpandedItemIds([...new Set([...expandedItemIds,...path])])}},[typeAheadBuffer,focusedId,getVisibleItems,data,expandedItemIds,findPathToItem]),handleClick=(0,react.useCallback)(item=>{if(setFocusedId(item?.id),item?.children?onFolderClick&&onFolderClick(item):onNodeClick&&(setSelectedId(item?.id),onNodeClick(item),focusContent()),item?.onClick){let willBeOpen=item?.children?!expandedItemIds.includes(item.id):void 0;item.onClick(willBeOpen)}},[expandedItemIds,onFolderClick,onNodeClick,focusContent]),handleKeyDown=(0,react.useCallback)(e=>{if(1===e.key.length&&!e.ctrlKey&&!e.altKey&&!e.metaKey){handleTypeAhead(e.key);return}let visibleItems=getVisibleItems(),currentIndex=visibleItems.findIndex(item=>item.id===focusedId);switch(e.key){case"ArrowRight":{e.preventDefault();let currentItem=visibleItems[currentIndex];if(currentItem?.children&&!currentItem.disabledReason){if(expandedItemIds.includes(currentItem.id)){let nextItem=visibleItems[currentIndex+1];nextItem&&(setFocusedId(nextItem.id),setSelectedId(void 0))}else setExpandedItemIds([...expandedItemIds,currentItem.id])}break}case"ArrowLeft":{e.preventDefault();let currentItem=visibleItems[currentIndex];if(currentItem?.children&&expandedItemIds.includes(currentItem.id))setExpandedItemIds(expandedItemIds.filter(id=>id!==currentItem.id)),setFocusedId(currentItem.id);else{let findParent=(items,targetId)=>{for(let item of items){if(item.children?.some(child=>child.id===targetId))return item;if(item.children){let found=findParent(item.children,targetId);if(found)return found}}return null},parentItem=findParent(Array.isArray(data)?data:[data],currentItem.id);parentItem&&setFocusedId(parentItem.id)}break}case"ArrowDown":e.preventDefault(),-1===currentIndex?visibleItems.length>0&&(setFocusedId(visibleItems[0].id),setSelectedId(void 0)):currentIndex<visibleItems.length-1&&(setFocusedId(visibleItems[currentIndex+1].id),setSelectedId(void 0));break;case"ArrowUp":e.preventDefault(),-1===currentIndex?visibleItems.length>0&&(setFocusedId(visibleItems[0].id),setSelectedId(void 0)):currentIndex>0&&(setFocusedId(visibleItems[currentIndex-1].id),setSelectedId(void 0));break;case"Home":{e.preventDefault();let visibleItems=getVisibleItems();visibleItems.length>0&&setFocusedId(visibleItems[0].id);break}case"End":{e.preventDefault();let visibleItems=getVisibleItems();visibleItems.length>0&&setFocusedId(visibleItems[visibleItems.length-1].id);break}case"Enter":{e.preventDefault();let currentItem=visibleItems[currentIndex];!currentItem.disabledReason&&(currentItem.children?(handleClick(currentItem),expandedItemIds.includes(currentItem.id)?setExpandedItemIds(expandedItemIds.filter(id=>id!==currentItem.id)):setExpandedItemIds([...expandedItemIds,currentItem.id])):onNodeClick&&(onNodeClick(currentItem),setSelectedId(currentItem.id),currentItem.onClick&&currentItem.onClick(),focusContent()))}}},[focusedId,expandedItemIds,getVisibleItems,handleTypeAhead,data,focusContent,handleClick,onNodeClick,onFolderClick]);return(0,jsx_runtime.jsx)("div",{className:(0,css_classes.cn)("overflow-hidden relative p-2",className),tabIndex:0,role:"tree","aria-label":"Tree navigation",onKeyDown:handleKeyDown,onBlur:()=>setFocusedId(void 0),children:(0,jsx_runtime.jsx)(LemonTreeNode,{data:data,ref:ref,selectedId:selectedId,focusedId:focusedId,handleClick:handleClick,expandedItemIds:expandedItemIds,setExpandedItemIds:setExpandedItemIds,defaultNodeIcon:defaultNodeIcon,showFolderActiveState:showFolderActiveState,className:"space-y-px",...props})})});LemonTree.displayName="LemonTree";let LemonTree_stories={title:"Lemon UI/Lemon Tree",component:LemonTree,args:{defaultNodeIcon:(0,jsx_runtime.jsx)(posthog_icons_es.IconArchive,{}),onFolderClick:item=>{console.log("clicked folder",item)},onNodeClick:item=>{console.log("clicked node",item)},showFolderActiveState:!1,expandAllFolders:!1,data:[{id:"gt_7d8f9",name:"Growth team",children:[{id:"gsm_a1b2c",name:"Growth Support Metrics",onClick:open=>{console.log("clicked growth support metrics",open)}},{id:"ssc_3d4e5",name:"Self-serve credits",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconShieldPeople,{}),disabledReason:"you're not cool enough"},{id:"ot_f6g7h",name:"Onboarding things",children:[{id:"cf_8i9j0",name:"Conversion funnel",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconShieldPeople,{})},{id:"mpu_k1l2m",name:"Multi-product usage",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconShieldPeople,{})},{id:"pis_n3o4p",name:"Post-install survey",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconShieldPeople,{})}]},{id:"ob2_q5r6s",name:"Onboarding 2.0",disabledReason:"you're not cool enough",children:[{id:"hsc_t7u8v",name:"Hypothesis & success criteria",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconShieldPeople,{})},{id:"ob2a_w9x0y",name:"Onboarding 2.0",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconShieldPeople,{})},{id:"ob2b_z1a2b",name:"Onboarding 2.0",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconShieldPeople,{})},{id:"ob2c_c3d4e",name:"Onboarding 2.0",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconShieldPeople,{})}]},{id:"bt_f5g6h",name:"Billing test",children:[{id:"os_i7j8k",name:"other stuff",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconShieldPeople,{})}]}]},{id:"et_l9m0n",name:"Exec team"},{id:"wv_o1p2q",name:"Website & vibes"},{id:"pa_r3s4t",name:"Product analytics"},{id:"uf_u5v6w",name:"Unfilled"}]},tags:["autodocs"]},Default=(props=>{let ref=(0,react.useRef)(null);return(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsx)(src.rU,{to:"https://posthog.com",children:"PostHog"}),(0,jsx_runtime.jsxs)("div",{className:"space-y-1",children:[(0,jsx_runtime.jsx)("p",{children:"Keyboard navigation: when focused inside the tree, try [up] [right] [down] [left] [enter] [home] [end]"}),(0,jsx_runtime.jsx)("p",{children:"Type-ahead search: when focused inside the tree, try typing the first few letters of a item and it will focus it"})]}),(0,jsx_runtime.jsxs)("div",{className:"w-full h-full grid grid-cols-[250px_1fr]",children:[(0,jsx_runtime.jsx)(LemonTree,{...props,contentRef:ref}),(0,jsx_runtime.jsxs)("main",{className:"p-4 focus-visible:ring-2 ring-accent-primary ring-offset-1",ref:ref,role:"main",tabIndex:-1,children:[(0,jsx_runtime.jsx)("h1",{children:"Your scene here"}),(0,jsx_runtime.jsx)(src.rU,{to:"https://posthog.com",children:"some content link"})]})]})]})}).bind({});Default.args={},Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:'(props: LemonTreeProps) => {\n  const ref = useRef<HTMLDivElement>(null);\n  return <div className="space-y-4">\n            <Link to="https://posthog.com">PostHog</Link>\n            <div className="space-y-1">\n                <p>\n                    Keyboard navigation: when focused inside the tree, try [up] [right] [down] [left] [enter] [home]\n                    [end]\n                </p>\n                <p>\n                    Type-ahead search: when focused inside the tree, try typing the first few letters of a item and it\n                    will focus it\n                </p>\n            </div>\n\n            <div className="w-full h-full grid grid-cols-[250px_1fr]">\n                <LemonTree {...props} contentRef={ref} />\n                <main className="p-4 focus-visible:ring-2 ring-accent-primary ring-offset-1" ref={ref} role="main" tabIndex={-1}>\n                    <h1>Your scene here</h1>\n                    <Link to="https://posthog.com">some content link</Link>\n                </main>\n            </div>\n        </div>;\n}',...Default.parameters?.docs?.source}}};let __namedExportsOrder=["Default"]},"./frontend/src/lib/utils/css-classes.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{cn:()=>cn});var clsx__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),tailwind_merge__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/tailwind-merge@2.2.2/node_modules/tailwind-merge/dist/bundle-mjs.mjs");function cn(){for(var _len=arguments.length,inputs=Array(_len),_key=0;_key<_len;_key++)inputs[_key]=arguments[_key];return(0,tailwind_merge__WEBPACK_IMPORTED_MODULE_0__.m6)((0,clsx__WEBPACK_IMPORTED_MODULE_1__.clsx)(inputs))}}}]);