(window.webpackJsonp=window.webpackJsonp||[]).push([[240],{"./frontend/src/lib/forms/Field.tsx":function(Q,_,t){"use strict";t.d(_,"a",function(){return p});var L=t("./node_modules/core-js/modules/es.function.name.js"),re=t.n(L),V=t("./node_modules/@babel/runtime/helpers/extends.js"),ee=t.n(V),b=t("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),R=t.n(b),S=t("./node_modules/clsx/dist/clsx.m.js"),e=t("./node_modules/kea-forms/lib/components.js"),A=t.n(e),T=t("./node_modules/react/index.js"),m=t.n(T),p=function(D){var G=D.showOptional,Z=D.name,oe=R()(D,["showOptional","name"]),le=function(K){var O=K.label,M=K.kids,$=K.hint,U=K.error;return m.a.createElement("div",{className:Object(S.a)("ant-row","ant-form-item",$||U?"ant-form-item-with-help":"",U?"ant-form-item-has-error":"")},O?m.a.createElement("div",{className:"ant-col ant-form-item-label"},m.a.createElement("label",{htmlFor:String(Z),title:typeof O=="string"?O:void 0},G?m.a.createElement(m.a.Fragment,null,O,G?m.a.createElement("span",{className:"ant-form-item-optional",title:""},"(optional)"):null):O)):null,m.a.createElement("div",{className:"ant-col ant-form-item-control"},m.a.createElement("div",{className:"ant-form-item-control-input"},m.a.createElement("div",{className:"ant-form-item-control-input-content"},M)),$||U?m.a.createElement("div",{className:"ant-form-item-explain ant-form-item-explain-connected"},U?m.a.createElement("div",{role:"alert",className:"ant-form-item-explain-error"},"Error: ",U):null,$?m.a.createElement("div",{role:"alert",className:"ant-form-item-explain-warning"},"Hint: ",$):null):null))};return m.a.createElement(e.Field,ee()({},oe,{name:Z,template:le}))};try{p.displayName="Field",p.__docgenInfo={description:"Compatible replacement for Form.Item",displayName:"Field",props:{showOptional:{defaultValue:null,description:"",name:"showOptional",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/forms/Field.tsx#Field"]={docgenInfo:p.__docgenInfo,name:"Field",path:"frontend/src/lib/forms/Field.tsx#Field"})}catch(I){}},"./frontend/src/lib/forms/VerticalForm.tsx":function(Q,_,t){"use strict";t.d(_,"a",function(){return e});var L=t("./node_modules/@babel/runtime/helpers/extends.js"),re=t.n(L),V=t("./node_modules/react/index.js"),ee=t.n(V),b=t("./node_modules/kea-forms/lib/index.js"),R=t.n(b),S=t("./node_modules/clsx/dist/clsx.m.js");function e(A){return ee.a.createElement(b.Form,re()({},A,{className:Object(S.a)("antd-form ant-form-vertical",A.className)}),A.children)}try{e.displayName="VerticalForm",e.__docgenInfo={description:"",displayName:"VerticalForm",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/forms/VerticalForm.tsx#VerticalForm"]={docgenInfo:e.__docgenInfo,name:"VerticalForm",path:"frontend/src/lib/forms/VerticalForm.tsx#VerticalForm"})}catch(A){}},"./frontend/src/lib/introductions/GroupsIntroductionOption.tsx":function(Q,_,t){"use strict";t.d(_,"a",function(){return p});var L=t("./node_modules/core-js/modules/es.array.includes.js"),re=t.n(L),V=t("./node_modules/core-js/modules/es.string.includes.js"),ee=t.n(V),b=t("./node_modules/react/index.js"),R=t.n(b),S=t("./node_modules/kea/lib/index.esm.js"),e=t("./node_modules/@ant-design/icons/es/icons/LockOutlined.js"),A=t("./node_modules/rc-select/es/index.js"),T=t("./frontend/src/lib/components/Link.tsx"),m=t("./frontend/src/lib/introductions/groupsAccessLogic.ts");function p(I){var D=I.value,G=Object(S.useValues)(m.b),Z=G.groupsAccessStatus;return[m.a.HasAccess,m.a.HasGroupTypes,m.a.NoAccess].includes(Z)?R.a.createElement(A.default.Option,{key:"groups",value:D,disabled:!0,style:{height:"100%",width:"100%",overflow:"hidden",textOverflow:"ellipsis",backgroundColor:"var(--bg-side)",color:"var(--text-muted)"}},R.a.createElement(e.a,{style:{marginRight:6,color:"var(--warning)"}}),"Unique groups \u2013"," ",R.a.createElement(T.a,{to:"https://posthog.com/docs/user-guides/group-analytics?utm_medium=in-product&utm_campaign=group-analytics-learn-more",target:"_blank","data-attr":"group-analytics-learn-more",style:{fontWeight:600}},"Learn more")):null}try{p.displayName="GroupsIntroductionOption",p.__docgenInfo={description:"",displayName:"GroupsIntroductionOption",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"]={docgenInfo:p.__docgenInfo,name:"GroupsIntroductionOption",path:"frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"})}catch(I){}},"./frontend/src/scenes/feature-flags/FeatureFlag.tsx":function(Q,_,t){"use strict";t.r(_),t.d(_,"scene",function(){return yt}),t.d(_,"FeatureFlag",function(){return se});var L=t("./node_modules/core-js/modules/es.array.concat.js"),re=t("./node_modules/core-js/modules/es.array.map.js"),V=t("./node_modules/core-js/modules/es.object.to-string.js"),ee=t("./node_modules/core-js/modules/es.regexp.to-string.js"),b=t("./node_modules/@babel/runtime/helpers/slicedToArray.js"),R=t.n(b),S=t("./node_modules/react/index.js"),e=t.n(S),A=t("./node_modules/kea-forms/lib/index.js"),T=t("./node_modules/antd/es/button/index.js"),m=t("./node_modules/antd/es/row/index.js"),p=t("./node_modules/antd/es/col/index.js"),I=t("./node_modules/antd/es/input/index.js"),D=t("./node_modules/antd/es/collapse/index.js"),G=t("./node_modules/antd/es/popconfirm/index.js"),Z=t("./node_modules/antd/es/radio/index.js"),oe=t("./node_modules/antd/es/slider/index.js"),le=t("./node_modules/antd/es/input-number/index.js"),te=t("./node_modules/antd/es/select/index.js"),K=t("./node_modules/antd/es/card/index.js"),O=t("./node_modules/kea/lib/index.esm.js"),M=t("./frontend/src/lib/utils.tsx"),$=t("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),U=t("./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js"),ue=t("./node_modules/@ant-design/icons/es/icons/SaveOutlined.js"),de=t("./node_modules/@ant-design/icons/es/icons/ApiFilled.js"),Ce=t("./node_modules/@ant-design/icons/es/icons/LockOutlined.js"),ce=t("./node_modules/@ant-design/icons/es/icons/MergeCellsOutlined.js"),me=t("./node_modules/@ant-design/icons/es/icons/PlusOutlined.js"),Le=t("./node_modules/core-js/modules/es.array.every.js"),be=t("./node_modules/core-js/modules/es.array.filter.js"),Re=t("./node_modules/core-js/modules/es.array.find.js"),F=t("./node_modules/core-js/modules/es.array.for-each.js"),E=t("./node_modules/core-js/modules/es.array.iterator.js"),j=t("./node_modules/core-js/modules/es.array.reduce.js"),C=t("./node_modules/core-js/modules/es.array.splice.js"),x=t("./node_modules/core-js/modules/es.function.name.js"),w=t("./node_modules/core-js/modules/es.regexp.exec.js"),ae=t("./node_modules/core-js/modules/es.string.match.js"),fe=t("./node_modules/core-js/modules/es.string.replace.js"),B=t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),ge=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Ke=t("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),Y=t.n(Ke),pe=t("./node_modules/@babel/runtime/regenerator/index.js"),J=t.n(pe),Bt=t("./node_modules/regenerator-runtime/runtime.js"),tt=t("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),ve=t.n(tt),at=t("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),H=t.n(at),nt=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),Be=t.n(nt),Pe=t("./frontend/src/lib/api.ts"),We=t("./node_modules/kea-router/lib/index.js"),Ee=t("./frontend/src/scenes/urls.ts"),Ne=t("./frontend/src/scenes/teamLogic.ts"),Te=t("./frontend/src/scenes/feature-flags/featureFlagsLogic.ts"),Ue=t("./frontend/src/models/groupsModel.ts"),Ve=t("./frontend/src/lib/components/TaxonomicFilter/types.ts"),rt=t("./frontend/src/lib/components/lemonToast.tsx");function Ge(n,a){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);a&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),r.push.apply(r,o)}return r}function l(n){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?Ge(Object(r),!0).forEach(function(o){Be()(n,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Ge(Object(r)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(r,o))})}return n}var Me={id:null,created_at:null,key:"",name:"",filters:{groups:[{properties:[],rollout_percentage:null}],multivariate:null},deleted:!1,active:!0,created_by:null,is_simple_flag:!1,rollout_percentage:null},ot={key:"",name:"",rollout_percentage:0},lt={variants:[{key:"",name:"",rollout_percentage:100}]},ye=Object(O.kea)({path:function(a){return["scenes","feature-flags","featureFlagLogic",a]},props:{},key:function(a){var r=a.id;return r!=null?r:"new"},connect:{values:[Ne.a,["currentTeamId"],Ue.a,["groupTypes","groupsTaxonomicTypes","aggregationLabel"]]},actions:{setFeatureFlag:function(a){return{featureFlag:a}},addConditionSet:!0,setAggregationGroupTypeIndex:function(a){return{value:a}},removeConditionSet:function(a){return{index:a}},duplicateConditionSet:function(a){return{index:a}},updateConditionSet:function(a,r,o){return{index:a,newRolloutPercentage:r,newProperties:o}},deleteFeatureFlag:function(a){return{featureFlag:a}},setMultivariateEnabled:function(a){return{enabled:a}},setMultivariateOptions:function(a){return{multivariateOptions:a}},addVariant:!0,removeVariant:function(a){return{index:a}},distributeVariantsEqually:!0},forms:function(a){var r=a.actions;return{featureFlag:{defaults:l({},Me),validator:function(u){var i,s,f,d=u.key,P=u.filters;return{key:d?!((i=d.match)===null||i===void 0)&&i.call(d,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key",filters:{multivariate:{variants:P==null||(s=P.multivariate)===null||s===void 0||(f=s.variants)===null||f===void 0?void 0:f.map(function(h){var q,y=h.key;return{key:y?!((q=y.match)===null||q===void 0)&&q.call(y,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key"}})}}}},submit:function(u){r.saveFeatureFlag(u)}}}},reducers:{featureFlag:[l({},Me),{setFeatureFlag:function(a,r){var o=r.featureFlag;if(o.filters.groups){var u=o.filters.groups.map(function(i){return i.properties?l(l({},i),{},{properties:Object(M.s)(i.properties)}):i});return l(l({},o),{},{filters:l(l({},o==null?void 0:o.filters),{},{groups:u})})}return o},addConditionSet:function(a){if(!a)return a;var r=[].concat(H()(a==null?void 0:a.filters.groups),[{properties:[],rollout_percentage:null}]);return l(l({},a),{},{filters:l(l({},a.filters),{},{groups:r})})},updateConditionSet:function(a,r){var o=r.index,u=r.newRolloutPercentage,i=r.newProperties;if(!a)return a;var s=H()(a==null?void 0:a.filters.groups);return u!==void 0&&(s[o]=l(l({},s[o]),{},{rollout_percentage:u})),i!==void 0&&(s[o]=l(l({},s[o]),{},{properties:i})),l(l({},a),{},{filters:l(l({},a.filters),{},{groups:s})})},removeConditionSet:function(a,r){var o=r.index;if(!a)return a;var u=H()(a.filters.groups);return u.splice(o,1),l(l({},a),{},{filters:l(l({},a.filters),{},{groups:u})})},duplicateConditionSet:function(a,r){var o=r.index;if(!a)return a;var u=a.filters.groups.concat([a.filters.groups[o]]);return l(l({},a),{},{filters:l(l({},a.filters),{},{groups:u})})},setMultivariateOptions:function(a,r){var o=r.multivariateOptions;return a&&l(l({},a),{},{filters:l(l({},a.filters),{},{multivariate:o})})},addVariant:function(a){var r;if(!a)return a;var o=H()(((r=a.filters.multivariate)===null||r===void 0?void 0:r.variants)||[]);return l(l({},a),{},{filters:l(l({},a.filters),{},{multivariate:l(l({},a.filters.multivariate||{}),{},{variants:[].concat(H()(o),[ot])})})})},removeVariant:function(a,r){var o,u=r.index;if(!a)return a;var i=H()(((o=a.filters.multivariate)===null||o===void 0?void 0:o.variants)||[]);return i.splice(u,1),l(l({},a),{},{filters:l(l({},a.filters),{},{multivariate:l(l({},a.filters.multivariate),{},{variants:i})})})},distributeVariantsEqually:function(a){var r;if(!a)return a;var o=H()(((r=a.filters.multivariate)===null||r===void 0?void 0:r.variants)||[]),u=o.length;if(u>0&&u<=100){var i=Math.round(100/u),s=i*u,f=s-100;o.forEach(function(d,P){o[P]=l(l({},d),{},{rollout_percentage:i})}),o[u-1]=l(l({},o[u-1]),{},{rollout_percentage:i-f})}return l(l({},a),{},{filters:l(l({},a.filters),{},{multivariate:l(l({},a.filters.multivariate),{},{variants:o})})})},setAggregationGroupTypeIndex:function(a,r){var o=r.value;return!a||a.filters.aggregation_group_type_index==o?a:l(l({},a),{},{filters:l(l({},a.filters),{},{aggregation_group_type_index:o,groups:[{properties:[],rollout_percentage:null}]})})}}]},loaders:function(a){var r=a.values,o=a.props;return{featureFlag:{loadFeatureFlag:function(){var u=ve()(J.a.mark(function s(){return J.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!(o.id&&o.id!=="new")){d.next=4;break}return d.next=3,Pe.a.get("api/projects/".concat(r.currentTeamId,"/feature_flags/").concat(o.id));case 3:return d.abrupt("return",d.sent);case 4:return d.abrupt("return",Me);case 5:case"end":return d.stop()}},s)}));function i(){return u.apply(this,arguments)}return i}(),saveFeatureFlag:function(){var u=ve()(J.a.mark(function s(f){var d,P,h;return J.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(d=f.created_at,P=f.id,h=Y()(f,["created_at","id"]),f.id){y.next=7;break}return y.next=4,Pe.a.create("api/projects/".concat(r.currentTeamId,"/feature_flags"),h);case 4:return y.abrupt("return",y.sent);case 7:return y.next=9,Pe.a.update("api/projects/".concat(r.currentTeamId,"/feature_flags/").concat(f.id),h);case 9:return y.abrupt("return",y.sent);case 10:case"end":return y.stop()}},s)}));function i(s){return u.apply(this,arguments)}return i}()}}},listeners:function(a){var r=a.actions,o=a.values;return{saveFeatureFlagSuccess:function(i){var s,f=i.featureFlag;rt.a.success("Feature flag saved"),(s=Te.a.findMounted())===null||s===void 0||s.actions.updateFlag(f),We.router.actions.replace(Ee.a.featureFlag(f.id))},deleteFeatureFlag:function(){var u=ve()(J.a.mark(function s(f){var d;return J.a.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:d=f.featureFlag,Object(M.x)({endpoint:"projects/".concat(o.currentTeamId,"/feature_flags"),object:{name:d.name,id:d.id},callback:function(){var y;d.id&&((y=Te.a.findMounted())===null||y===void 0||y.actions.deleteFlag(d.id)),We.router.actions.push(Ee.a.featureFlags())}});case 2:case"end":return h.stop()}},s)}));function i(s){return u.apply(this,arguments)}return i}(),setMultivariateEnabled:function(){var u=ve()(J.a.mark(function s(f){var d;return J.a.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:d=f.enabled,d?r.setMultivariateOptions(lt):r.setMultivariateOptions(null);case 2:case"end":return h.stop()}},s)}));function i(s){return u.apply(this,arguments)}return i}()}},selectors:{multivariateEnabled:[function(n){return[n.featureFlag]},function(n){return!!(n!=null&&n.filters.multivariate)}],variants:[function(n){return[n.featureFlag]},function(n){var a;return(n==null||(a=n.filters.multivariate)===null||a===void 0?void 0:a.variants)||[]}],nonEmptyVariants:[function(n){return[n.variants]},function(n){return n.filter(function(a){var r=a.key;return!!r})}],variantRolloutSum:[function(n){return[n.variants]},function(n){return n.reduce(function(a,r){var o=r.rollout_percentage;return a+o},0)}],areVariantRolloutsValid:[function(n){return[n.variants,n.variantRolloutSum]},function(n,a){return n.every(function(r){var o=r.rollout_percentage;return o>=0&&o<=100})&&a===100}],aggregationTargetName:[function(n){return[n.featureFlag,n.groupTypes,n.aggregationLabel]},function(n,a,r){return n&&n.filters.aggregation_group_type_index!=null&&a.length>0?r(n.filters.aggregation_group_type_index).plural:"users"}],taxonomicGroupTypes:[function(n){return[n.featureFlag,n.groupsTaxonomicTypes]},function(n,a){return n&&n.filters.aggregation_group_type_index!=null&&a.length>0?[a[n.filters.aggregation_group_type_index]]:[Ve.a.PersonProperties,Ve.a.Cohorts]}],breadcrumbs:[function(n){return[n.featureFlag]},function(n){return[{name:"Feature Flags",path:Ee.a.featureFlags()}].concat(H()(n?[{name:n.key||"Unnamed"}]:[]))}]},urlToAction:function(a){var r,o=a.actions,u=a.props;return Be()({},Ee.a.featureFlag((r=u.id)!==null&&r!==void 0?r:"new"),function(i,s,f,d){var P=d.method;P==="PUSH"&&(u.id?o.loadFeatureFlag():o.resetFeatureFlag())})},events:function(a){var r=a.props,o=a.actions;return{afterMount:function(){var i,s=(i=Te.a.findMounted())===null||i===void 0?void 0:i.values.featureFlags.find(function(f){return f.id===r.id});s?o.setFeatureFlag(s):r.id!=="new"&&o.loadFeatureFlag()}}}}),st=t("./frontend/src/lib/components/PageHeader.tsx"),it=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),ut=t.n(it),dt=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss"),$e=t.n(dt),Se={};Se.insert="head",Se.singleton=!1;var Wt=ut()($e.a,Se),Nt=$e.a.locals||{},z=t("./frontend/src/lib/components/icons.tsx"),he=t("./frontend/src/lib/components/Tooltip.tsx"),ne=t("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),_e="?utm_medium=in-product&utm_campaign=feature-flag";function Oe(n){var a=n.flagKey;return e.a.createElement(e.a.Fragment,null,e.a.createElement(ne.a,{language:ne.b.JavaScript,wrap:!0},"if\xA0(posthog.isFeatureEnabled('".concat(a!=null?a:"",`')) {
    // run your activation code here
}`)),e.a.createElement("div",{className:"mt"},"Need more information?"," ",e.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://posthog.com/docs/integrations/js-integration".concat(_e,"#feature-flags")},"Check the docs ",e.a.createElement(z.IconOpenInNew,null))))}function Fe(n){var a=n.flagKey;return e.a.createElement(e.a.Fragment,null,e.a.createElement(ne.a,{language:ne.b.Python,wrap:!0},'if\xA0posthog.feature_enabled("'.concat(a,`", "user_distinct_id"):
    runAwesomeFeature()
`)),e.a.createElement("div",{className:"mt"},"Need more information?"," ",e.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://posthog.com/docs/integrations/python-integration".concat(_e,"#feature-flags")},"Check the docs ",e.a.createElement(z.IconOpenInNew,null))))}function ct(){var n=Object(O.useValues)(Ne.a),a=n.currentTeam;return e.a.createElement(e.a.Fragment,null,e.a.createElement(ne.a,{language:ne.b.Bash,wrap:!0},"curl ".concat(window.location.origin,`/decide/ \\
-X POST -H 'Content-Type: application/json' \\
-d '{
    "api_key": "`).concat(a?a.api_token:"[project_api_key]",`",
    "distinct_id": "[user distinct id]"
}'
                `)),e.a.createElement("div",{className:"mt"},"Need more information?"," ",e.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://posthog.com/docs/api/feature-flags".concat(_e)},"Check the docs ",e.a.createElement(z.IconOpenInNew,null))))}try{Oe.displayName="JSSnippet",Oe.__docgenInfo={description:"",displayName:"JSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"]={docgenInfo:Oe.__docgenInfo,name:"JSSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"})}catch(n){}try{Fe.displayName="PythonSnippet",Fe.__docgenInfo={description:"",displayName:"PythonSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"]={docgenInfo:Fe.__docgenInfo,name:"PythonSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"})}catch(n){}var Ye=t("./frontend/src/lib/components/LemonRow/index.ts"),mt=t("./frontend/src/lib/introductions/GroupsIntroductionOption.tsx"),ft=t("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),gt=t("./frontend/src/scenes/userLogic.ts"),Ae=t("./frontend/src/types.ts"),pt=t("./frontend/src/lib/components/Link.tsx"),Je=t("./frontend/src/lib/components/LemonButton/index.ts"),vt=t("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),k=t("./frontend/src/lib/forms/Field.tsx"),Et=t("./frontend/src/lib/forms/VerticalForm.tsx"),yt={component:se,logic:ye,paramsToProps:function(a){var r=a.params.id;return{id:r&&r!=="new"?parseInt(r):"new"}}};function He(n){setTimeout(function(){var a;return(a=document.querySelector('.variant-form-list input[data-key-index="'.concat(n,'"]')))===null||a===void 0?void 0:a.focus()},50)}function se(){var n,a,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=r.id,u={id:o&&o!=="new"?parseInt(o):"new"},i=Object(O.useValues)(ye(u)),s=i.featureFlag,f=i.multivariateEnabled,d=i.variants,P=i.nonEmptyVariants,h=i.areVariantRolloutsValid,q=i.variantRolloutSum,y=i.groupTypes,ie=i.aggregationTargetName,ht=i.taxonomicGroupTypes,_t=i.featureFlagLoading,W=Object(O.useActions)(ye(u)),Ot=W.addConditionSet,ze=W.updateConditionSet,Ft=W.removeConditionSet,jt=W.duplicateConditionSet,Ct=W.deleteFeatureFlag,Xe=W.setMultivariateEnabled,Pt=W.addVariant,Tt=W.removeVariant,Mt=W.distributeVariantsEqually,St=W.setAggregationGroupTypeIndex,Qe=Object(O.useValues)(Ue.a),At=Qe.showGroupsOptions,It=Qe.aggregationLabel,Ze=Object(O.useValues)(gt.a),Ie=Ze.hasAvailableFeature,Dt=Ze.upgradeLink,xt=Object(S.useState)(!1),we=R()(xt,2),ke=we[0],Lt=we[1],bt=Object(S.useState)(!1),qe=R()(bt,2),Rt=qe[0],De=qe[1],Kt=Object(mt.a)({value:-2});return e.a.createElement("div",{className:"feature-flag"},s?e.a.createElement(Et.a,{logic:ye,props:u,formKey:"featureFlag"},e.a.createElement(st.a,{title:"Feature Flag",buttons:e.a.createElement("div",{style:{display:"flex"}},e.a.createElement(k.a,{name:"active"},function(g){var c=g.value,v=g.onValueChange;return e.a.createElement(vt.a,{checked:c,onChange:v,label:c?e.a.createElement("span",{className:"text-success"},"Enabled"):e.a.createElement("span",{className:"text-danger"},"Disabled")})}),(s==null?void 0:s.id)&&e.a.createElement(T.a,{"data-attr":"delete-flag",danger:!0,icon:e.a.createElement(U.a,null),onClick:function(){Ct(s)},style:{marginRight:16}},"Delete"),e.a.createElement(T.a,{icon:e.a.createElement(ue.a,null),type:"primary","data-attr":"feature-flag-submit",loading:_t,htmlType:"submit"},"Save changes"))}),e.a.createElement("h3",{className:"l3"},"General configuration"),e.a.createElement("div",{className:"text-muted mb"},"General settings for your feature flag and integration instructions."),e.a.createElement(m.a,{gutter:16,style:{marginBottom:32}},e.a.createElement(p.a,{span:12},e.a.createElement(k.a,{name:"key",label:"Key (must be unique)",validateStatus:ke?"warning":void 0,hint:ke&&o!=="new"?e.a.createElement("small",null,e.a.createElement("b",null,"Warning! "),"Changing this key will",e.a.createElement("a",{href:"https://posthog.com/docs/features/feature-flags".concat(_e,"#feature-flag-persistence"),target:"_blank",rel:"noopener"}," ","affect the persistence of your flag ",e.a.createElement(z.IconOpenInNew,null))):void 0},function(g){var c=g.value,v=g.onChange;return e.a.createElement(I.a,{value:c,onChange:function(N){N.target.value!==c&&Lt(!0),v(N)},"data-attr":"feature-flag-key",className:"ph-ignore-input",autoFocus:!0,placeholder:"examples: new-landing-page, betaFeature, ab_test_1",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})}),e.a.createElement(k.a,{name:"name",label:"Description"},function(g){var c=g.value,v=g.onChange;return e.a.createElement(I.a.TextArea,{value:c,onChange:v,className:"ph-ignore-input","data-attr":"feature-flag-description",placeholder:"Adding a helpful description can ensure others know what this feature is for."})})),e.a.createElement(p.a,{span:12,style:{paddingTop:31}},e.a.createElement(D.a,null,e.a.createElement(D.a.Panel,{header:e.a.createElement("div",{style:{display:"flex",fontWeight:"bold",alignItems:"center"}},e.a.createElement(z.IconJavascript,{style:{marginRight:6}})," Javascript integration instructions"),key:"js"},e.a.createElement(Oe,{flagKey:s.key||"my-flag"})),e.a.createElement(D.a.Panel,{header:e.a.createElement("div",{style:{display:"flex",fontWeight:"bold",alignItems:"center"}},e.a.createElement(z.IconPython,{style:{marginRight:6}})," Python integration instructions"),key:"python"},e.a.createElement(Fe,{flagKey:s.key||"my-flag"})),e.a.createElement(D.a.Panel,{header:e.a.createElement("div",{style:{display:"flex",fontWeight:"bold",alignItems:"center"}},e.a.createElement(de.a,{style:{marginRight:6}})," API integration instructions"),key:"api"},e.a.createElement(ct,null))))),e.a.createElement("div",{className:"mb-2"},e.a.createElement("h3",{className:"l3"},"Served value"),e.a.createElement("div",{className:"mb-05"},e.a.createElement(G.a,{placement:"top",title:"Change value type? The variants below will be lost.",visible:Rt,onConfirm:function(){Xe(!1),De(!1)},onCancel:function(){return De(!1)},okText:"OK",cancelText:"Cancel"},e.a.createElement(Z.a.Group,{options:[{label:"Boolean value (A/B test)",value:!1},{label:e.a.createElement(he.a,{title:Ie(Ae.c.MULTIVARIATE_FLAGS)?"":"This feature is not available on your current plan."},e.a.createElement("div",null,!Ie(Ae.c.MULTIVARIATE_FLAGS)&&e.a.createElement(pt.a,{to:Dt,target:"_blank"},e.a.createElement(Ce.a,{style:{marginRight:4,color:"var(--warning)"}})),"String value (Multivariate test)"," ",e.a.createElement(ft.a,{type:"warning"},"Beta"))),value:!0,disabled:!Ie(Ae.c.MULTIVARIATE_FLAGS)}],onChange:function(c){var v=c.target.value;v===!1&&P.length?De(!0):(Xe(v),He(0))},value:f,optionType:"button"}))),e.a.createElement("div",{className:"text-muted mb"},Object(M.j)(ie)," will be served"," ",f?e.a.createElement(e.a.Fragment,null,e.a.createElement("strong",null,"a variant key")," according to the below distribution"):e.a.createElement("strong",null,e.a.createElement("code",null,"true"))," ","if they match one or more release condition groups."),f&&e.a.createElement("div",{className:"variant-form-list"},e.a.createElement(m.a,{gutter:8,className:"label-row"},e.a.createElement(p.a,{span:7},"Variant key"),e.a.createElement(p.a,{span:7},"Description"),e.a.createElement(p.a,{span:9},e.a.createElement("span",null,"Rollout percentage"),e.a.createElement(T.a,{type:"link",onClick:Mt,icon:e.a.createElement(ce.a,null),style:{padding:"0 0 0 0.5em"},title:"Distribute variants equally"},"Distribute"))),d.map(function(g,c){return e.a.createElement(A.Group,{key:c,name:["filters","multivariate","variants",c]},e.a.createElement(m.a,{gutter:8},e.a.createElement(p.a,{span:7},e.a.createElement(k.a,{name:"key"},e.a.createElement(I.a,{"data-attr":"feature-flag-variant-key","data-key-index":c.toString(),className:"ph-ignore-input",placeholder:"example-variant-".concat(c+1),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}))),e.a.createElement(p.a,{span:7},e.a.createElement(k.a,{name:"name"},e.a.createElement(I.a,{"data-attr":"feature-flag-variant-name",className:"ph-ignore-input",placeholder:"Description"}))),e.a.createElement(p.a,{span:7},e.a.createElement(k.a,{name:"rollout_percentage"},function(v){var X=v.value,N=v.onValueChange;return e.a.createElement(oe.a,{tooltipPlacement:"top",value:X,onChange:N})})),e.a.createElement(p.a,{span:2},e.a.createElement(k.a,{name:"rollout_percentage"},function(v){var X=v.value,N=v.onValueChange;return e.a.createElement(le.a,{min:0,max:100,value:X,onChange:function(xe){if(xe!=null){var et=parseInt(xe.toString());isNaN(et)||N(et)}},style:{width:"100%",borderColor:h?void 0:"var(--danger)"}})})),d.length>1&&e.a.createElement(p.a,{span:1},e.a.createElement(he.a,{title:"Delete this variant",placement:"bottomLeft"},e.a.createElement(T.a,{type:"link",icon:e.a.createElement(U.a,null),onClick:function(){return Tt(c)},style:{color:"var(--danger)"}})))))}),d.length>0&&!h&&e.a.createElement("p",{className:"text-danger"},"Percentage rollouts for variants must sum to 100 (currently ",q,")."),e.a.createElement(T.a,{type:"dashed",block:!0,icon:e.a.createElement(me.a,null),onClick:function(){var c=d.length;Pt(),He(c)},style:{marginBottom:16}},"Add Variant"))),e.a.createElement("div",{className:"feature-flag-form-row"},e.a.createElement("div",null,e.a.createElement("h3",{className:"l3"},"Release conditions"),e.a.createElement("div",{className:"text-muted mb"},"Specify the ",ie," to which you want to release this flag. Note that condition sets are rolled out independently of each other.")),At&&e.a.createElement("div",{className:"centered"},"Match by",e.a.createElement(te.a,{value:((n=s.filters)===null||n===void 0?void 0:n.aggregation_group_type_index)!=null?(a=s.filters)===null||a===void 0?void 0:a.aggregation_group_type_index:-1,onChange:function(c){var v=c!==-1?c:null;St(v)},style:{marginLeft:8},"data-attr":"feature-flag-aggregation-filter",dropdownMatchSelectWidth:!1,dropdownAlign:{points:["tr","br"]}},e.a.createElement(te.a.Option,{key:-1,value:-1},"Users"),y.map(function(g){return e.a.createElement(te.a.Option,{key:g.group_type_index,value:g.group_type_index},Object(M.j)(It(g.group_type_index).plural))}),Kt))),e.a.createElement(m.a,{gutter:16},s.filters.groups.map(function(g,c){var v,X;return e.a.createElement(p.a,{span:24,md:24,key:"".concat(c,"-").concat(s.filters.groups.length)},c>0&&e.a.createElement("div",{style:{display:"flex",marginLeft:16}},e.a.createElement("div",{className:"stateful-badge or-light-grey mb"},"OR")),e.a.createElement(K.a,{style:{marginBottom:16}},e.a.createElement("div",{className:"feature-flag-form-row",style:{height:24}},e.a.createElement("div",null,e.a.createElement("span",{className:"simple-tag tag-light-blue",style:{marginRight:8}},"Set ",c+1),!((v=g.properties)===null||v===void 0)&&v.length?e.a.createElement(e.a.Fragment,null,"Matching ",e.a.createElement("b",null,ie)," with filters"):e.a.createElement(e.a.Fragment,null,"Condition set will match ",e.a.createElement("b",null,"all ",ie))),e.a.createElement(m.a,{align:"middle"},e.a.createElement(he.a,{title:"Duplicate this condition set",placement:"bottomLeft"},e.a.createElement(Je.a,{icon:e.a.createElement(z.IconCopy,null),compact:!0,onClick:function(){return jt(c)}})),s.filters.groups.length>1&&e.a.createElement(he.a,{title:"Delete this condition set",placement:"bottomLeft"},e.a.createElement(Je.a,{icon:e.a.createElement(z.IconDelete,null),compact:!0,onClick:function(){return Ft(c)}})))),e.a.createElement(Ye.b,{large:!0}),e.a.createElement($.a,{style:{marginLeft:15},pageKey:"feature-flag-".concat(s.id,"-").concat(c,"-").concat(s.filters.groups.length,"-").concat((X=s.filters.aggregation_group_type_index)!==null&&X!==void 0?X:""),propertyFilters:g==null?void 0:g.properties,onChange:function(je){return ze(c,void 0,je)},taxonomicGroupTypes:ht,showConditionBadge:!0}),e.a.createElement(Ye.b,{large:!0}),e.a.createElement("div",{className:"feature-flag-form-row"},e.a.createElement("div",{className:"centered"},"Roll out to"," ",e.a.createElement(le.a,{style:{width:100,marginLeft:8,marginRight:8},onChange:function(je){ze(c,je)},value:g.rollout_percentage!=null?g.rollout_percentage:100,min:0,max:100,addonAfter:"%"})," ","of ",e.a.createElement("b",null,ie)," in this set"))))})),e.a.createElement(K.a,{size:"small",style:{marginBottom:16}},e.a.createElement(T.a,{type:"link",onClick:Ot,style:{marginLeft:5}},e.a.createElement(me.a,{style:{marginRight:15}})," Add condition set")),e.a.createElement("div",{className:"text-right"},e.a.createElement(T.a,{icon:e.a.createElement(ue.a,null),htmlType:"submit",type:"primary","data-attr":"feature-flag-submit-bottom"},"Save changes"))):e.a.createElement(M.c,null))}try{se.displayName="FeatureFlag",se.__docgenInfo={description:"",displayName:"FeatureFlag",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"]={docgenInfo:se.__docgenInfo,name:"FeatureFlag",path:"frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"})}catch(n){}},"./frontend/src/scenes/feature-flags/featureFlagsLogic.ts":function(Q,_,t){"use strict";t.d(_,"a",function(){return Re});var L=t("./node_modules/core-js/modules/es.array.concat.js"),re=t.n(L),V=t("./node_modules/core-js/modules/es.array.filter.js"),ee=t.n(V),b=t("./node_modules/core-js/modules/es.array.find.js"),R=t.n(b),S=t("./node_modules/core-js/modules/es.array.iterator.js"),e=t.n(S),A=t("./node_modules/core-js/modules/es.array.map.js"),T=t.n(A),m=t("./node_modules/core-js/modules/es.object.to-string.js"),p=t.n(m),I=t("./node_modules/core-js/modules/es.regexp.exec.js"),D=t.n(I),G=t("./node_modules/core-js/modules/es.string.search.js"),Z=t.n(G),oe=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),le=t.n(oe),te=t("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),K=t.n(te),O=t("./node_modules/@babel/runtime/regenerator/index.js"),M=t.n(O),$=t("./node_modules/regenerator-runtime/runtime.js"),U=t.n($),ue=t("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),de=t.n(ue),Ce=t("./node_modules/kea/lib/index.esm.js"),ce=t("./frontend/src/lib/api.ts"),me=t("./node_modules/fuse.js/dist/fuse.esm.js"),Le=t("./frontend/src/scenes/teamLogic.ts"),be=t("./frontend/src/scenes/urls.ts"),Re=Object(Ce.kea)({path:["scenes","feature-flags","featureFlagsLogic"],connect:{values:[Le.a,["currentTeamId"]]},actions:{updateFlag:function(E){return{flag:E}},deleteFlag:function(E){return{id:E}},setSearchTerm:function(E){return{searchTerm:E}}},loaders:function(E){var j=E.values;return{featureFlags:{__default:[],loadFeatureFlags:function(){var C=de()(M.a.mark(function w(){var ae;return M.a.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,ce.a.get("api/projects/".concat(j.currentTeamId,"/feature_flags/"));case 2:return ae=B.sent,B.abrupt("return",ae.results);case 4:case"end":return B.stop()}},w)}));function x(){return C.apply(this,arguments)}return x}(),updateFeatureFlag:function(){var C=de()(M.a.mark(function w(ae){var fe,B,ge;return M.a.wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return fe=ae.id,B=ae.payload,Y.next=3,ce.a.update("api/projects/".concat(j.currentTeamId,"/feature_flags/").concat(fe),B);case 3:return ge=Y.sent,Y.abrupt("return",K()(j.featureFlags).map(function(pe){return pe.id===ge.id?ge:pe}));case 5:case"end":return Y.stop()}},w)}));function x(w){return C.apply(this,arguments)}return x}()}}},selectors:{searchedFeatureFlags:[function(F){return[F.featureFlags,F.searchTerm]},function(F,E){return E?new me.a(F,{keys:["key","name"],threshold:.3}).search(E).map(function(j){return j.item}):F}],breadcrumbs:[function(){return[]},function(){return[{name:"Feature Flags",path:be.a.featureFlags()}]}]},reducers:{searchTerm:{setSearchTerm:function(E,j){var C=j.searchTerm;return C}},featureFlags:{updateFlag:function(E,j){var C=j.flag;return E.find(function(x){var w=x.id;return w===C.id})?E.map(function(x){return x.id===C.id?C:x}):[C].concat(K()(E))},deleteFlag:function(E,j){var C=j.id;return E.filter(function(x){return x.id!==C})}}},events:function(E){var j=E.actions;return{afterMount:function(){j.loadFeatureFlags()}}}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss":function(Q,_,t){var L=t("./node_modules/css-loader/dist/runtime/api.js");_=L(!1),_.push([Q.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.feature-flag .LemonSwitch{margin-right:1rem!important}.variant-form-list .ant-form-item{min-height:32px}.variant-form-list .label-row{margin-bottom:4px;font-weight:700}.variant-form-list .label-row .ant-col{min-height:32px;display:flex;justify-content:space-between;align-items:center}.feature-flag-form-row{display:flex;justify-content:space-between;align-items:center;width:100%}.feature-flag-form-row .centered{display:flex;align-items:center;white-space:pre-wrap}",""]),Q.exports=_}}]);
