"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[55666],{"../../products/llm_analytics/frontend/LLMAnalyticsUsers.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{LLMAnalyticsUsers:()=>LLMAnalyticsUsers});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_router__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),lib_lemon_ui_Tooltip__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/lemon-ui/Tooltip/index.ts"),scenes_persons_PersonDisplay__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/scenes/persons/PersonDisplay.tsx"),scenes_urls__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/scenes/urls.ts"),_queries_nodes_DataTable_DataTable__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/queries/nodes/DataTable/DataTable.tsx"),_queries_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/queries/utils.ts"),_types__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/types.ts"),_hooks_useSortableColumns__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../products/llm_analytics/frontend/hooks/useSortableColumns.tsx"),_llmAnalyticsLogic__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../products/llm_analytics/frontend/llmAnalyticsLogic.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let mapPerson=person=>{if(!Array.isArray(person)||0===person.length)return{distinct_id:"",created_at:"",properties:{}};let[distinctId,createdAt,propertiesJson]=person,properties={};try{properties=JSON.parse(propertiesJson)}catch(e){console.error("Error parsing person properties_json:",e)}return{distinct_id:distinctId,created_at:createdAt,properties}};function LLMAnalyticsUsers(){let{setDates,setShouldFilterTestAccounts,setPropertyFilters,setUsersSort}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(_llmAnalyticsLogic__WEBPACK_IMPORTED_MODULE_9__.BK),{usersQuery,usersSort}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(_llmAnalyticsLogic__WEBPACK_IMPORTED_MODULE_9__.BK),{renderSortableColumnTitle}=(0,_hooks_useSortableColumns__WEBPACK_IMPORTED_MODULE_8__.h)(usersSort,setUsersSort);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_queries_nodes_DataTable_DataTable__WEBPACK_IMPORTED_MODULE_5__.w,{query:{...usersQuery,showSavedFilters:!0},setQuery:query=>{if(!(0,_queries_utils__WEBPACK_IMPORTED_MODULE_6__.tE)(query.source)){console.warn("LLMAnalyticsUsers received a non-events query:",query.source);return}let{filters={}}=query.source,{dateRange={}}=filters;setDates(dateRange.date_from||null,dateRange.date_to||null),setShouldFilterTestAccounts(filters.filterTestAccounts||!1),setPropertyFilters(filters.properties||[])},context:{columns:{user:{title:"Person",render:function RenderPerson(x){let person=mapPerson(x.value);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(scenes_persons_PersonDisplay__WEBPACK_IMPORTED_MODULE_3__.I,{person:person,withIcon:!0,noPopover:!0,href:(0,kea_router__WEBPACK_IMPORTED_MODULE_1__.combineUrl)(scenes_urls__WEBPACK_IMPORTED_MODULE_4__.j.llmAnalyticsTraces(),{filters:[{type:_types__WEBPACK_IMPORTED_MODULE_7__.FT.HogQL,key:`distinct_id == '${person.distinct_id}'`,value:null}]}).url})}},first_seen:{renderTitle:()=>renderSortableColumnTitle("first_seen","First Seen")},last_seen:{renderTitle:()=>renderSortableColumnTitle("last_seen","Last Seen")},traces:{renderTitle:()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(lib_lemon_ui_Tooltip__WEBPACK_IMPORTED_MODULE_2__.u,{title:"Number of traces created by this user",children:renderSortableColumnTitle("traces","Traces")})},generations:{renderTitle:()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(lib_lemon_ui_Tooltip__WEBPACK_IMPORTED_MODULE_2__.u,{title:"Number of generations created by this user",children:renderSortableColumnTitle("generations","Generations")})},errors:{renderTitle:()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(lib_lemon_ui_Tooltip__WEBPACK_IMPORTED_MODULE_2__.u,{title:"Number of errors encountered by this user",children:renderSortableColumnTitle("errors","Errors")})},total_cost:{renderTitle:()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(lib_lemon_ui_Tooltip__WEBPACK_IMPORTED_MODULE_2__.u,{title:"Total cost of all generations for this user",children:renderSortableColumnTitle("total_cost","Cost")}),render:function RenderCost(_ref){let{value}=_ref;return value&&Number(value)?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsxs)("span",{children:["$",Number(value).toFixed(4)]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)("span",{children:"N/A"})}}}},uniqueKey:"llm-analytics-users"})}},"../../products/llm_analytics/frontend/hooks/useSortableColumns.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{h:()=>useSortableColumns});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function useSortableColumns(currentSort,setSort){let handleColumnClick=column=>{let newDirection=currentSort.column===column&&"DESC"===currentSort.direction?"ASC":"DESC";setSort(column,newDirection)};return{handleColumnClick,renderSortableColumnTitle:(column,title)=>{let isSorted=currentSort.column===column,direction=currentSort.direction;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{onClick:()=>handleColumnClick(column),style:{cursor:"pointer",userSelect:"none"},className:"flex items-center gap-1",children:[title,isSorted&&("DESC"===direction?" ▼":" ▲")]})}}}}}]);