(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[5021],{"./frontend/src/lib/components/AnimatedCollapsible.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{r:()=>AnimatedCollapsible});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function AnimatedCollapsible(_ref){let{collapsed,children}=_ref;const collapsibleSectionRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),[height,setHeight]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)();return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{collapsed?setHeight(0):collapsibleSectionRef.current&&setHeight(collapsibleSectionRef.current?.getBoundingClientRect().height)}),[collapsed,children]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{className:"collapsible overflow-hidden",style:{height,transition:"height 0.3s ease-in-out"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{ref:collapsibleSectionRef,children})})}try{AnimatedCollapsible.displayName="AnimatedCollapsible",AnimatedCollapsible.__docgenInfo={description:"",displayName:"AnimatedCollapsible",props:{collapsed:{defaultValue:null,description:"",name:"collapsed",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/AnimatedCollapsible.tsx#AnimatedCollapsible"]={docgenInfo:AnimatedCollapsible.__docgenInfo,name:"AnimatedCollapsible",path:"frontend/src/lib/components/AnimatedCollapsible.tsx#AnimatedCollapsible"})}catch(__react_docgen_typescript_loader_error){}},"./frontend/src/scenes/actions/hints.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{i:()=>URL_MATCHING_HINTS});var _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");const URL_MATCHING_HINTS={exact:void 0,contains:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment,{children:["Use ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("code",{children:"%"})," for wildcard, for example: ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("code",{children:"/user/%/edit"}),"."]}),regex:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.Link,{to:"https://github.com/google/re2/wiki/Syntax",target:"_blank",children:"RE2 syntax applies."})}},"./frontend/src/toolbar/Toolbar.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Actions:()=>Actions,ActionsDark:()=>ActionsDark,Default:()=>Default,DefaultDark:()=>DefaultDark,FeatureFlags:()=>FeatureFlags,FeatureFlagsDark:()=>FeatureFlagsDark,Heatmap:()=>Heatmap,HeatmapDark:()=>HeatmapDark,Inspect:()=>Inspect,InspectDark:()=>InspectDark,Minimized:()=>Minimized,MinimizedDark:()=>MinimizedDark,Unauthenticated:()=>Unauthenticated,default:()=>Toolbar_stories});__webpack_require__("./frontend/src/styles/index.tsx");var injectStylesIntoStyleTag=__webpack_require__("./node_modules/.pnpm/style-loader@2.0.0_webpack@5.88.2/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),toolbar_styles=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.31_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/toolbar/styles.scss"),styles_default=__webpack_require__.n(toolbar_styles),options={insert:"head",singleton:!1};injectStylesIntoStyleTag_default()(styles_default(),options);styles_default().locals;var index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),react=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),browser=__webpack_require__("./frontend/src/mocks/browser.tsx");var react_shadow_esm=__webpack_require__("./node_modules/.pnpm/react-shadow@20.4.0_prop-types@15.8.1_react-dom@18.2.0_react@18.2.0/node_modules/react-shadow/react-shadow.esm.js"),react_toastify_esm=__webpack_require__("./node_modules/.pnpm/react-toastify@8.2.0_react-dom@18.2.0_react@18.2.0/node_modules/react-toastify/dist/react-toastify.esm.js"),lib=__webpack_require__("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.5/node_modules/kea-router/lib/index.js"),lemonToast=__webpack_require__("./frontend/src/lib/lemon-ui/lemonToast.tsx"),lib_index_esm=__webpack_require__("./node_modules/.pnpm/posthog-js-lite@2.0.0-alpha5/node_modules/posthog-js-lite/lib/index.esm.js");const runningOnPosthog=!!window.POSTHOG_APP_CONTEXT,apiKey=runningOnPosthog?window.JS_POSTHOG_API_KEY:"sTMFPsFhdP1Ssg",apiHost=runningOnPosthog?window.JS_POSTHOG_HOST:"https://app.posthog.com",posthog=new lib_index_esm.Z(apiKey||"sTMFPsFhdP1Ssg",{host:apiHost,enable:!1,persistence:"memory",persistence_name:apiKey+"_toolbar"});runningOnPosthog&&window.JS_POSTHOG_SELF_CAPTURE&&posthog.debug();var finder=__webpack_require__("./node_modules/.pnpm/@medv+finder@2.1.0/node_modules/@medv/finder/finder.js"),actionUtils=__webpack_require__("./frontend/src/lib/actionUtils.ts"),cssEscape=__webpack_require__("./frontend/src/lib/utils/cssEscape.ts"),querySelectorDeep=__webpack_require__("./node_modules/.pnpm/query-selector-shadow-dom@1.0.0/node_modules/query-selector-shadow-dom/src/querySelectorDeep.js"),index_es=__webpack_require__("./node_modules/.pnpm/wildcard-match@5.1.2/node_modules/wildcard-match/build/index.es.mjs"),types=__webpack_require__("./frontend/src/types.ts");function getSafeText(el){if(!el.childNodes||!el.childNodes.length)return"";let elText="";return el.childNodes.forEach((child=>{3===child.nodeType&&child.textContent&&(elText+=child.textContent.trim().replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255))})),elText}function elementToActionStep(element,dataAttributes){const query=function elementToQuery(element,dataAttributes){if(element){for(const{name,value}of Array.from(element.attributes)){if(!dataAttributes.includes(name))continue;const selector=`[${(0,cssEscape.Q)(name)}="${(0,cssEscape.Q)(value)}"]`;if(1==(0,querySelectorDeep.Jp)(selector).length)return selector}try{return(0,finder.w)(element,{attr:name=>dataAttributes.some((dataAttribute=>(0,index_es.Z)(dataAttribute)(name))),tagName:name=>!actionUtils.Kr.includes(name),seedMinLength:5})}catch(error){return void console.warn("Error while trying to find a selector for element",element,error)}}}(element,dataAttributes);return{event:"$autocapture",href:element.getAttribute("href")||"",name:element.getAttribute("name")||"",text:getSafeText(element)||"",selector:query||"",url:window.location.protocol+"//"+window.location.host+window.location.pathname,url_matching:types.E_.Exact}}function getToolbarElement(){return window.document.getElementById("__POSTHOG_TOOLBAR__")||null}function getShadowRoot(){return getToolbarElement()?.shadowRoot||null}function getToolbarContainer(){return getShadowRoot()?.getElementById("button-toolbar")}function getShadowRootPopoverContainer(){return getShadowRoot()}function getParent(element){const parent=element.parentNode;return parent?.nodeType===window.Node.DOCUMENT_FRAGMENT_NODE?parent.host:parent?.nodeType===window.Node.ELEMENT_NODE?parent:null}function trimElement(element){if(!element)return null;const toolbarElement=getToolbarElement();if(toolbarElement&&isParentOf(element,toolbarElement))return null;let loopElement=element;for(;1===loopElement.children.length;)loopElement=loopElement.children[0];for(;loopElement;){const parent=getParent(loopElement);if(!parent)return null;if(loopElement.matches?.(actionUtils.cR))return loopElement;if("pointer"===window.getComputedStyle(loopElement).getPropertyValue("cursor")){const parentStyles=parent?window.getComputedStyle(parent):null;if(!parentStyles||"pointer"!==parentStyles.getPropertyValue("cursor"))return loopElement}loopElement=parent}return null}function inBounds(min,value,max){return Math.max(min,Math.min(max,value))}function getAllClickTargets(){let startNode=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const elements=startNode.querySelectorAll(actionUtils.cR),allElements=[...startNode.querySelectorAll("*")],selectedElements=[...elements,...allElements.filter((el=>{if(actionUtils.OK.indexOf(el.tagName.toLowerCase())>=0)return!1;return"pointer"===window.getComputedStyle(el).getPropertyValue("cursor")})),...allElements.filter((el=>el.shadowRoot&&"__POSTHOG_TOOLBAR__"!==el.getAttribute("id"))).map((el=>el.shadowRoot?getAllClickTargets(el.shadowRoot):[])).reduce(((a,b)=>[...a,...b]),[])].map((e=>trimElement(e))).filter((e=>e));return Array.from(new Set(selectedElements))}function isParentOf(element,possibleParent){let loopElement=element;for(;loopElement;){if(loopElement!==element&&loopElement===possibleParent)return!0;loopElement=getParent(loopElement)}return!1}function getElementForStep(step,allElements){if(!step)return null;let selector="";step.selector&&(step.selector_selected||void 0===step.selector_selected)&&(selector=step.selector),step.href&&(step.href_selected||void 0===step.href_selected)&&(selector+=`[href="${(0,cssEscape.Q)(step.href)}"]`);const hasText=step.text&&step.text.trim()&&(step.text_selected||void 0===step.text_selected);if(!selector&&!hasText)return null;let elements=[];try{elements=[...(0,querySelectorDeep.Jp)(selector||"*",document,allElements)]}catch(e){return console.error("Cannot use selector:",selector,". with exception: ",e),null}if(hasText&&step?.text){const textToSearch=step.text.toString().trim();elements=elements.filter((e=>-1===actionUtils.Kr.indexOf(e.tagName.toLowerCase())&&e.innerText?.trim()===textToSearch&&(e.matches(actionUtils.cR)||function hasCursorPointer(element){return"pointer"===window.getComputedStyle(element)?.getPropertyValue("cursor")}(e)))),elements=elements.filter((e=>!elements.find((e2=>isParentOf(e2,e)))))}return 1===elements.length?elements[0]:null}function getBoxColors(color){let hover=arguments.length>1&&void 0!==arguments[1]&&arguments[1],opacity=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2;return"blue"===color?{backgroundBlendMode:"multiply",background:`hsla(240, 90%, 58%, ${opacity})`,boxShadow:`hsla(240, 90%, 27%, 0.5) 0px 3px 10px ${hover?4:2}px`}:"red"===color?{backgroundBlendMode:"multiply",background:`hsla(4, 90%, 58%, ${opacity})`,boxShadow:`hsla(4, 90%, 27%, 0.8) 0px 3px 10px ${hover?4:2}px`}:"green"===color?{backgroundBlendMode:"multiply",background:`hsla(97, 90%, 58%, ${opacity})`,boxShadow:`hsla(97, 90%, 27%, 0.8) 0px 3px 10px ${hover?4:2}px`}:void 0}function actionStepToActionStepFormItem(step){let isNew=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!step)return{};if(void 0!==step.selector_selected)return step;if(isNew){const hasSelector=!!step.selector;return"a"===step.tag_name?{...step,href_selected:!0,selector_selected:hasSelector,text_selected:!1,url_selected:!1}:"button"===step.tag_name?{...step,text_selected:!0,selector_selected:hasSelector,href_selected:!1,url_selected:!1}:{...step,selector_selected:hasSelector,text_selected:!1,url_selected:!1,href_selected:!1}}return{...step,url_matching:step.url_matching||types.E_.Exact,href_selected:void 0!==step.href&&null!==step.href,text_selected:void 0!==step.text&&null!==step.text,selector_selected:void 0!==step.selector&&null!==step.selector,url_selected:void 0!==step.url&&null!==step.url}}function stepToDatabaseFormat(step){const{href_selected,text_selected,selector_selected,url_selected,...rest}=step;return{...rest,href:href_selected&&rest.href||null,text:text_selected&&rest.text||null,selector:selector_selected&&rest.selector||null,url:url_selected&&rest.url||null}}function clearSessionToolbarToken(){window.sessionStorage?.removeItem("_postHogToolbarParams"),window.localStorage?.removeItem("_postHogToolbarParams"),window.sessionStorage?.removeItem("_postHogEditorParams"),window.localStorage?.removeItem("_postHogEditorParams")}function getRectForElement(element){const elements=[elementToAreaRect(element)];let loopElement=element;for(;1===loopElement.children.length;)loopElement=loopElement.children[0],elements.push(elementToAreaRect(loopElement));let maxArea=0,maxRect=elements[0].rect;for(const{rect,area}of elements)area>=maxArea&&(maxArea=area,maxRect=rect);return maxRect}const getRect=el=>{if(!el)return{x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0};const rect=el?.getBoundingClientRect(),zooms=(el=>{const zooms=[],getZoom=el=>{const zoom=window.getComputedStyle(el).getPropertyValue("zoom"),rzoom=zoom?parseFloat(zoom):1;1!==rzoom&&zooms.push(rzoom),el.parentElement?.parentElement&&getZoom(el.parentElement)};return getZoom(el),zooms.reverse(),zooms})(el);return{bottom:zooms.reduce(((a,b)=>a*b),rect.bottom),height:zooms.reduce(((a,b)=>a*b),rect.height),left:zooms.reduce(((a,b)=>a*b),rect.left),right:zooms.reduce(((a,b)=>a*b),rect.right),top:zooms.reduce(((a,b)=>a*b),rect.top),width:zooms.reduce(((a,b)=>a*b),rect.width),x:zooms.reduce(((a,b)=>a*b),rect.x),y:zooms.reduce(((a,b)=>a*b),rect.y)}};function elementToAreaRect(element){var _rect$width,_rect$height;const rect=getRect(element);return{element,rect,area:(null!==(_rect$width=rect.width)&&void 0!==_rect$width?_rect$width:0)*(null!==(_rect$height=rect.height)&&void 0!==_rect$height?_rect$height:0)}}function getHeatMapHue(count,maxCount){return 0===maxCount?60:60-count/maxCount*40}const toolbarConfigLogic=(0,index_esm.kea)([(0,index_esm.path)(["toolbar","toolbarConfigLogic"]),(0,index_esm.props)({}),(0,index_esm.actions)({authenticate:!0,logout:!0,tokenExpired:!0,clearUserIntent:!0,showButton:!0,hideButton:!0}),(0,index_esm.reducers)((_ref=>{var _props$posthog;let{props}=_ref;return{rawApiURL:[props.apiURL],rawJsURL:[props.jsURL||props.apiURL],temporaryToken:[props.temporaryToken||null,{logout:()=>null,tokenExpired:()=>null}],actionId:[props.actionId||null,{logout:()=>null,clearUserIntent:()=>null}],userIntent:[props.userIntent||null,{logout:()=>null,clearUserIntent:()=>null}],source:[props.source||null,{logout:()=>null}],buttonVisible:[!0,{showButton:()=>!0,hideButton:()=>!1,logout:()=>!1}],dataAttributes:[props.dataAttributes||[]],posthog:[null!==(_props$posthog=props.posthog)&&void 0!==_props$posthog?_props$posthog:null]}})),(0,index_esm.selectors)({apiURL:[s=>[s.rawApiURL],apiURL=>`${apiURL.endsWith("/")?apiURL.replace(/\/+$/,""):apiURL}`],jsURL:[s=>[s.rawJsURL,s.apiURL],(rawJsURL,apiUrl)=>`${rawJsURL?rawJsURL.endsWith("/")?rawJsURL.replace(/\/+$/,""):rawJsURL:apiUrl}`],isAuthenticated:[s=>[s.temporaryToken],temporaryToken=>!!temporaryToken]}),(0,index_esm.listeners)((_ref2=>{let{values}=_ref2;return{authenticate:()=>{posthog.capture("toolbar authenticate",{is_authenticated:values.isAuthenticated});const encodedUrl=encodeURIComponent(window.location.href);window.location.href=`${values.apiURL}/authorize_and_redirect/?redirect=${encodedUrl}`,clearSessionToolbarToken()},logout:()=>{posthog.capture("toolbar logout"),clearSessionToolbarToken()},tokenExpired:()=>{posthog.capture("toolbar token expired"),console.warn("PostHog Toolbar API token expired. Clearing session."),"localstorage"!==values.source&&lemonToast.UJ.error("PostHog Toolbar API token expired."),clearSessionToolbarToken()}}})),(0,index_esm.afterMount)((_ref3=>{let{props,values}=_ref3;if(props.instrument){const distinctId=props.distinctId;distinctId&&posthog.identify(distinctId,props.userEmail?{email:props.userEmail}:{}),posthog.optIn()}posthog.capture("toolbar loaded",{is_authenticated:values.isAuthenticated})}))]);async function toolbarFetch(url){let method=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",payload=arguments.length>2?arguments[2]:void 0,urlConstruction=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"full";const temporaryToken=toolbarConfigLogic.findMounted()?.values.temporaryToken,apiURL=toolbarConfigLogic.findMounted()?.values.apiURL;let fullUrl;if("use-as-provided"===urlConstruction)fullUrl=url;else if("only-add-token"===urlConstruction)fullUrl=`${url}&temporary_token=${temporaryToken}`;else{const{pathname,searchParams}=(0,lib.combineUrl)(url),params={...searchParams,temporary_token:temporaryToken};fullUrl=`${apiURL}${pathname}${(0,lib.encodeParams)(params,"?")}`}const payloadData=payload?{body:JSON.stringify(payload),headers:{"Content-Type":"application/json"}}:{},response=await fetch(fullUrl,{method,...payloadData});if(403===response.status){"You don't have access to the project."!==(await response.json()).detail&&toolbarConfigLogic.actions.authenticate()}return response}var Fade=__webpack_require__("./frontend/src/lib/components/Fade/Fade.tsx"),Toolbar=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.31_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/toolbar/bar/Toolbar.scss"),Toolbar_default=__webpack_require__.n(Toolbar),Toolbar_options={insert:"head",singleton:!1};injectStylesIntoStyleTag_default()(Toolbar_default(),Toolbar_options);Toolbar_default().locals;var posthog_icons_es=__webpack_require__("./node_modules/.pnpm/@posthog+icons@0.4.11_react-dom@18.2.0_react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),clsx_m=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),useKeyboardHotkeys=__webpack_require__("./frontend/src/lib/hooks/useKeyboardHotkeys.tsx"),icons=__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts"),LemonMenu=__webpack_require__("./frontend/src/lib/lemon-ui/LemonMenu/index.ts"),LemonButton=__webpack_require__("./frontend/src/lib/lemon-ui/LemonButton/index.ts"),LemonInput=__webpack_require__("./frontend/src/lib/lemon-ui/LemonInput/index.ts"),Link=__webpack_require__("./frontend/src/lib/lemon-ui/Link/index.ts"),Spinner=__webpack_require__("./frontend/src/lib/lemon-ui/Spinner/index.ts"),urls=__webpack_require__("./frontend/src/scenes/urls.ts"),src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),kea_forms_lib=__webpack_require__("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.5/node_modules/kea-forms/lib/index.js"),kea_subscriptions_lib=__webpack_require__("./node_modules/.pnpm/kea-subscriptions@3.0.0_kea@3.1.5/node_modules/kea-subscriptions/lib/index.js"),api=__webpack_require__("./frontend/src/lib/api.ts"),fuse_esm=__webpack_require__("./node_modules/.pnpm/fuse.js@6.6.2/node_modules/fuse.js/dist/fuse.esm.js"),kea_loaders_lib=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js");const actionsLogic=(0,index_esm.kea)([(0,index_esm.path)(["toolbar","actions","actionsLogic"]),(0,index_esm.actions)({setSearchTerm:searchTerm=>({searchTerm})}),(0,kea_loaders_lib.loaders)((_ref=>{let{values}=_ref;return{allActions:[[],{getActions:async function(){let breakpoint=arguments.length>1?arguments[1]:void 0;const response=await toolbarFetch("/api/projects/@current/actions/"),results=await response.json();if(403===response.status)return toolbarConfigLogic.actions.authenticate(),[];if(breakpoint(),!Array.isArray(results?.results))throw new Error("Error loading actions!");return results.results},updateAction:_ref2=>{let{action}=_ref2;return values.allActions.filter((r=>r.id!==action.id)).concat([action])},deleteAction:_ref3=>{let{id}=_ref3;return values.allActions.filter((r=>r.id!==id))}}]}})),(0,index_esm.reducers)({searchTerm:["",{setSearchTerm:(_,_ref4)=>{let{searchTerm}=_ref4;return searchTerm}}]}),(0,index_esm.selectors)({sortedActions:[s=>[s.allActions,s.searchTerm],(allActions,searchTerm)=>[...searchTerm?new fuse_esm.Z(allActions,{threshold:.3,keys:["name"]}).search(searchTerm).map((_ref5=>{let{item}=_ref5;return item})):allActions].sort(((a,b)=>{var _a$name,_b$name;return(null!==(_a$name=a.name)&&void 0!==_a$name?_a$name:"Untitled").localeCompare(null!==(_b$name=b.name)&&void 0!==_b$name?_b$name:"Untitled")}))],actionCount:[s=>[s.allActions],allActions=>allActions.length]})]);var kea_window_values_lib=__webpack_require__("./node_modules/.pnpm/kea-window-values@3.0.0_kea@3.1.5/node_modules/kea-window-values/lib/index.js"),sprites=__webpack_require__("./frontend/src/lib/components/HedgehogBuddy/sprites/sprites.tsx");const currentPageLogic=(0,index_esm.kea)([(0,index_esm.path)(["toolbar","stats","currentPageLogic"]),(0,index_esm.actions)((()=>({setHref:href=>({href}),setWildcardHref:href=>({href})}))),(0,index_esm.reducers)((()=>({href:[window.location.href,{setHref:(_,_ref)=>{let{href}=_ref;return href}}],wildcardHref:[window.location.href,{setHref:(_,_ref2)=>{let{href}=_ref2;return href},setWildcardHref:(_,_ref3)=>{let{href}=_ref3;return href}}]}))),(0,index_esm.afterMount)((_ref4=>{let{actions,values,cache}=_ref4;cache.interval=window.setInterval((()=>{window.location.href!==values.href&&actions.setHref(window.location.href)}),500)})),(0,index_esm.beforeUnmount)((_ref5=>{let{cache}=_ref5;window.clearInterval(cache.interval)}))]);var utils=__webpack_require__("./frontend/src/lib/utils.tsx");const emptyElementsStatsPages={next:void 0,previous:void 0,results:[]},heatmapLogic=(0,index_esm.kea)([(0,index_esm.path)(["toolbar","elements","heatmapLogic"]),(0,index_esm.connect)({values:[toolbarConfigLogic,["apiURL"],currentPageLogic,["href","wildcardHref"]],actions:[currentPageLogic,["setHref","setWildcardHref"]]}),(0,index_esm.actions)({getElementStats:url=>({url}),enableHeatmap:!0,disableHeatmap:!0,setShowHeatmapTooltip:showHeatmapTooltip=>({showHeatmapTooltip}),setShiftPressed:shiftPressed=>({shiftPressed}),setHeatmapFilter:filter=>({filter}),loadMoreElementStats:!0,setMatchLinksByHref:matchLinksByHref=>({matchLinksByHref})}),(0,index_esm.reducers)({matchLinksByHref:[!1,{setMatchLinksByHref:(_,_ref)=>{let{matchLinksByHref}=_ref;return matchLinksByHref}}],canLoadMoreElementStats:[!0,{getElementStatsSuccess:(_,_ref2)=>{let{elementStats}=_ref2;return null!==elementStats.next},getElementStatsFailure:()=>!0}],heatmapEnabled:[!1,{enableHeatmap:()=>!0,disableHeatmap:()=>!1,getElementStatsFailure:()=>!1}],heatmapLoading:[!1,{getElementStats:()=>!0,getElementStatsSuccess:()=>!1,getElementStatsFailure:()=>!1,resetElementStats:()=>!1}],showHeatmapTooltip:[!1,{setShowHeatmapTooltip:(_,_ref3)=>{let{showHeatmapTooltip}=_ref3;return showHeatmapTooltip}}],shiftPressed:[!1,{setShiftPressed:(_,_ref4)=>{let{shiftPressed}=_ref4;return shiftPressed}}],heatmapFilter:[{},{setHeatmapFilter:(_,_ref5)=>{let{filter}=_ref5;return filter}}]}),(0,kea_loaders_lib.loaders)((_ref6=>{let{values}=_ref6;return{elementStats:[null,{resetElementStats:()=>emptyElementsStatsPages,getElementStats:async(_ref7,breakpoint)=>{let{url}=_ref7;const{href,wildcardHref}=values;let defaultUrl="";if(!url){const params={properties:[wildcardHref===href?{key:"$current_url",value:href,operator:types.WV.Exact,type:types.FT.Event}:{key:"$current_url",value:`^${wildcardHref.split("*").map(actionUtils.yI).join(".*")}$`,operator:types.WV.Regex,type:types.FT.Event}],...values.heatmapFilter},includeEventsParams="&include=$autocapture&include=$rageclick";defaultUrl=`${values.apiURL}/api/element/stats/${(0,lib.encodeParams)({...params,paginate_response:!0},"?")}${includeEventsParams}`}const response=await toolbarFetch(url||defaultUrl,"GET",void 0,url?"use-as-provided":"only-add-token");if(403===response.status)return toolbarConfigLogic.actions.authenticate(),emptyElementsStatsPages;const paginatedResults=await response.json();if(breakpoint(),!Array.isArray(paginatedResults.results))throw new Error("Error loading HeatMap data!");return{results:[...values.elementStats?.results||[],...paginatedResults.results],next:paginatedResults.next,previous:paginatedResults.previous}}}]}})),(0,index_esm.selectors)((_ref8=>{let{cache}=_ref8;return{dateRange:[s=>[s.heatmapFilter],heatmapFilter=>(0,utils.Kl)(heatmapFilter.date_from,heatmapFilter.date_to,"Last 7 days")],elements:[selectors=>[selectors.elementStats,toolbarConfigLogic.selectors.dataAttributes,selectors.href,selectors.matchLinksByHref],(elementStats,dataAttributes,href,matchLinksByHref)=>{cache.pageElements=cache.lastHref==href?cache.pageElements:(0,querySelectorDeep.n8)("*",document),cache.selectorToElements=cache.lastHref==href?cache.selectorToElements:{},cache.lastHref=href;const elements=[];return elementStats?.results.forEach((event=>{let combinedSelector,lastSelector;for(let i=0;i<event.elements.length;i++){const element=event.elements[i],selector=(0,actionUtils.nr)(matchLinksByHref?element:{...element,href:void 0},dataAttributes)||"*";combinedSelector=lastSelector?`${selector} > ${lastSelector}`:selector;try{let domElements=cache.selectorToElements?.[combinedSelector];if(void 0===domElements&&(domElements=Array.from((0,querySelectorDeep.Jp)(combinedSelector,document,cache.pageElements)),cache.selectorToElements[combinedSelector]=domElements),1===domElements.length){const e=event.elements[i];if(0!==i||!e.tag_name||e.attr_class||e.attr_id||e.href||e.text||1!==e.nth_child||1!==e.nth_of_type||e.attributes["attr__data-attr"])return elements.push({element:domElements[0],count:event.count,selector,hash:event.hash,type:event.type}),null}if(0===domElements.length){if(i===event.elements.length-1)return null;if(i>0&&lastSelector){lastSelector=lastSelector?`* > ${lastSelector}`:"*";continue}}}catch(error){break}lastSelector=combinedSelector}})),elements}],countedElements:[selectors=>[selectors.elements,toolbarConfigLogic.selectors.dataAttributes],(elements,dataAttributes)=>{const normalisedElements=new Map;(elements||[]).forEach((countedElement=>{const trimmedElement=trimElement(countedElement.element);if(trimmedElement)if(normalisedElements.has(trimmedElement)){const existing=normalisedElements.get(trimmedElement);existing&&(existing.count+=countedElement.count,existing.clickCount+="$rageclick"===countedElement.type?0:countedElement.count,existing.rageclickCount+="$rageclick"===countedElement.type?countedElement.count:0)}else normalisedElements.set(trimmedElement,{...countedElement,clickCount:"$rageclick"===countedElement.type?0:countedElement.count,rageclickCount:"$rageclick"===countedElement.type?countedElement.count:0,element:trimmedElement,actionStep:elementToActionStep(trimmedElement,dataAttributes)})}));const countedElements=Array.from(normalisedElements.values());return countedElements.sort(((a,b)=>b.count-a.count)),countedElements.map(((e,i)=>({...e,position:i+1})))}],elementCount:[selectors=>[selectors.countedElements],countedElements=>countedElements.length],clickCount:[selectors=>[selectors.countedElements],countedElements=>countedElements?countedElements.map((e=>e.count)).reduce(((a,b)=>a+b),0):0],highestClickCount:[selectors=>[selectors.countedElements],countedElements=>countedElements?countedElements.map((e=>e.count)).reduce(((a,b)=>b>a?b:a),0):0]}})),(0,index_esm.afterMount)((_ref9=>{let{actions,values,cache}=_ref9;values.heatmapEnabled&&actions.getElementStats(),cache.keyDownListener=event=>{event.shiftKey&&!values.shiftPressed&&actions.setShiftPressed(!0)},cache.keyUpListener=event=>{!event.shiftKey&&values.shiftPressed&&actions.setShiftPressed(!1)},window.addEventListener("keydown",cache.keyDownListener),window.addEventListener("keyup",cache.keyUpListener)})),(0,index_esm.beforeUnmount)((_ref10=>{let{cache}=_ref10;window.removeEventListener("keydown",cache.keyDownListener),window.removeEventListener("keyup",cache.keyUpListener)})),(0,index_esm.listeners)((_ref11=>{let{actions,values}=_ref11;return{loadMoreElementStats:()=>{values.elementStats?.next&&actions.getElementStats(values.elementStats.next)},setHref:()=>{values.heatmapEnabled&&(actions.resetElementStats(),actions.getElementStats())},setWildcardHref:async(_,breakpoint)=>{await breakpoint(100),values.heatmapEnabled&&(actions.resetElementStats(),actions.getElementStats())},enableHeatmap:()=>{actions.getElementStats(),posthog.capture("toolbar mode triggered",{mode:"heatmap",enabled:!0})},disableHeatmap:()=>{actions.resetElementStats(),actions.setShowHeatmapTooltip(!1),posthog.capture("toolbar mode triggered",{mode:"heatmap",enabled:!1})},getElementStatsSuccess:()=>{actions.setShowHeatmapTooltip(!0)},setShowHeatmapTooltip:async(_ref12,breakpoint)=>{let{showHeatmapTooltip}=_ref12;showHeatmapTooltip&&(await breakpoint(1e3),actions.setShowHeatmapTooltip(!1))},setHeatmapFilter:()=>{actions.resetElementStats(),actions.getElementStats()}}}))]);const elementsLogic=(0,index_esm.kea)([(0,index_esm.path)(["toolbar","elements","elementsLogic"]),(0,index_esm.connect)((()=>({values:[actionsTabLogic,["actionForm"],currentPageLogic,["href"]],actions:[actionsTabLogic,["selectAction","newAction"]]}))),(0,index_esm.actions)({enableInspect:!0,disableInspect:!0,selectElement:element=>({element}),createAction:element=>({element}),updateRects:!0,setHoverElement:element=>({element}),setHighlightElement:element=>({element}),setSelectedElement:element=>({element}),setRelativePositionCompensation:compensation=>({compensation})}),(0,index_esm.reducers)((()=>({inspectEnabledRaw:[!1,{enableInspect:()=>!0,disableInspect:()=>!1}],rectUpdateCounter:[0,{updateRects:state=>state+1}],hoverElement:[null,{setHoverElement:(_,_ref)=>{let{element}=_ref;return element},enableInspect:()=>null,disableInspect:()=>null,createAction:()=>null,selectElement:()=>null}],highlightElement:[null,{setHighlightElement:(_,_ref2)=>{let{element}=_ref2;return element},setHoverElement:()=>null,setSelectedElement:()=>null,selectElement:()=>null,disableInspect:()=>null,createAction:()=>null}],selectedElement:[null,{setSelectedElement:(_,_ref3)=>{let{element}=_ref3;return element},disableInspect:()=>null,createAction:()=>null,[heatmapLogic.actionTypes.disableHeatmap]:()=>null,selectAction:()=>null}],enabledLast:[null,{enableInspect:()=>"inspect",[heatmapLogic.actionTypes.enableHeatmap]:()=>"heatmap"}],relativePositionCompensation:[0,{setRelativePositionCompensation:(_,_ref4)=>{let{compensation}=_ref4;return compensation}}]}))),(0,index_esm.selectors)({activeMetaIsSelected:[s=>[s.selectedElementMeta,s.activeMeta],(selectedElementMeta,activeMeta)=>!!selectedElementMeta&&!!activeMeta&&selectedElementMeta.element===activeMeta.element],inspectEnabled:[s=>[s.inspectEnabledRaw,actionsTabLogic.selectors.inspectingElement,actionsTabLogic.selectors.buttonActionsVisible],(inspectEnabledRaw,inspectingElement,buttonActionsVisible)=>inspectEnabledRaw||buttonActionsVisible&&null!==inspectingElement],heatmapEnabled:[()=>[heatmapLogic.selectors.heatmapEnabled],heatmapEnabled=>heatmapEnabled],heatmapElements:[s=>[heatmapLogic.selectors.countedElements,s.rectUpdateCounter,toolbarConfigLogic.selectors.buttonVisible],countedElements=>countedElements.map((e=>({...e,rect:getRectForElement(e.element)})))],allInspectElements:[s=>[s.inspectEnabled,s.href],inspectEnabled=>inspectEnabled?getAllClickTargets():[]],inspectElements:[s=>[s.allInspectElements,s.rectUpdateCounter,toolbarConfigLogic.selectors.buttonVisible],allInspectElements=>allInspectElements.map((element=>({element,rect:getRectForElement(element)}))).filter((e=>e.rect&&e.rect.width*e.rect.height>0))],displayActionElements:[()=>[actionsTabLogic.selectors.buttonActionsVisible],buttonActionsVisible=>buttonActionsVisible],allActionElements:[s=>[s.displayActionElements,s.actionForm],(displayActionElements,actionForm)=>{if(displayActionElements&&actionForm?.steps){const allElements=(0,querySelectorDeep.n8)("*",document),steps=[];return actionForm.steps.forEach(((step,index)=>{const element=getElementForStep(step,allElements);element&&steps.push({element,index})})),steps}return[]}],actionElements:[s=>[s.allActionElements,s.rectUpdateCounter,toolbarConfigLogic.selectors.buttonVisible],allActionElements=>allActionElements.map((element=>element.element?{...element,rect:getRectForElement(element.element)}:element))],elementMap:[s=>[s.heatmapElements,s.inspectElements,s.actionElements,s.actionsListElements],(heatmapElements,inspectElements,actionElements,actionsListElements)=>{const elementMap=new Map;return[...inspectElements,...heatmapElements,...actionElements,...actionsListElements].forEach((e=>{const elementWithMetadata={...e};elementMap.get(e.element)?elementMap.set(e.element,{...elementMap.get(e.element),...elementWithMetadata}):elementMap.set(e.element,elementWithMetadata)})),elementMap}],actionsForElementMap:[s=>[actionsLogic.selectors.sortedActions,s.rectUpdateCounter,toolbarConfigLogic.selectors.buttonVisible],sortedActions=>{const allElements=(0,querySelectorDeep.n8)("*",document),actionsForElementMap=new Map;return sortedActions.forEach(((action,index)=>{action.steps?.filter((step=>"$autocapture"===step.event)).forEach((step=>{const element=getElementForStep(step,allElements);if(element){const rect=getRectForElement(element);let array=actionsForElementMap.get(element);array||(array=[],actionsForElementMap.set(element,array)),array.push({action,step,element,rect,index})}}))})),actionsForElementMap}],elementsWithActions:[s=>[s.actionsForElementMap],actionsForElementMap=>[...actionsForElementMap.keys()]],actionsListElements:[s=>[s.actionsForElementMap],actionsForElementMap=>[...actionsForElementMap.values()].map((a=>a[0]))],elementsToDisplayRaw:[s=>[s.displayActionElements,s.actionElements,s.inspectElements,s.actionsListElements,actionsTabLogic.selectors.selectedAction],(displayActionElements,actionElements,inspectElements,actionsListElements,selectedAction)=>inspectElements.length>0?inspectElements:displayActionElements&&selectedAction&&actionElements.length>0?actionElements:displayActionElements&&!selectedAction&&actionsListElements.length>0?actionsListElements:[]],elementsToDisplay:[s=>[s.elementsToDisplayRaw],elementsToDisplayRaw=>elementsToDisplayRaw.filter((_ref5=>{let{rect}=_ref5;return rect&&(0!==rect.width||0!==rect.height)}))],labelsToDisplay:[s=>[s.displayActionElements,s.actionElements,s.actionsListElements,actionsTabLogic.selectors.selectedAction],(displayActionElements,actionElements,actionsListElements,selectedAction)=>displayActionElements&&selectedAction&&actionElements.length>0?actionElements:displayActionElements&&!selectedAction&&actionsListElements.length>0?actionsListElements:[]],selectedElementMeta:[s=>[s.selectedElement,s.elementMap,s.actionsForElementMap,toolbarConfigLogic.selectors.dataAttributes],(selectedElement,elementMap,actionsForElementMap,dataAttributes)=>{if(selectedElement){const meta=elementMap.get(selectedElement);if(meta){const actions=actionsForElementMap.get(selectedElement);return{...meta,actionStep:elementToActionStep(meta.element,dataAttributes),actions:actions||[]}}}return null}],hoverElementMeta:[s=>[s.hoverElement,s.elementMap,s.actionsForElementMap,toolbarConfigLogic.selectors.dataAttributes],(hoverElement,elementMap,actionsForElementMap,dataAttributes)=>{if(hoverElement){const meta=elementMap.get(hoverElement);if(meta){const actions=actionsForElementMap.get(hoverElement);return{...meta,actionStep:elementToActionStep(meta.element,dataAttributes),actions:actions||[]}}}return null}],highlightElementMeta:[s=>[s.highlightElement,s.elementMap,s.actionsForElementMap,toolbarConfigLogic.selectors.dataAttributes],(highlightElement,elementMap,actionsForElementMap,dataAttributes)=>{if(highlightElement){const meta=elementMap.get(highlightElement);if(meta){const actions=actionsForElementMap.get(highlightElement);return{...meta,actionStep:elementToActionStep(meta.element,dataAttributes),actions:actions||[]}}}return null}],activeMeta:[s=>[s.selectedElementMeta,s.hoverElementMeta],(selectedElementMeta,hoverElementMeta)=>selectedElementMeta||hoverElementMeta]}),(0,index_esm.listeners)((_ref6=>{let{actions}=_ref6;return{enableInspect:()=>{posthog.capture("toolbar mode triggered",{mode:"inspect",enabled:!0}),actionsLogic.actions.getActions()},disableInspect:()=>{posthog.capture("toolbar mode triggered",{mode:"inspect",enabled:!1})},selectElement:_ref7=>{let{element}=_ref7;actionsTabLogic.values.buttonActionsVisible&&null!==actionsTabLogic.values.inspectingElement?(actions.setHoverElement(null),element&&actionsTabLogic.actions.inspectElementSelected(element,actionsTabLogic.values.inspectingElement)):actions.setSelectedElement(element);const data_attributes=[];if(element?.attributes)for(let i=0;i<element.attributes.length;i++){const name=element.attributes.item(i)?.nodeName;name&&name.indexOf("data-")>-1&&data_attributes.push(name)}posthog.capture("toolbar selected HTML element",{element_tag:element?.tagName.toLowerCase(),element_type:element?.type,has_href:!!element?.href,has_class:!!element?.className,has_id:!!element?.id,has_name:!!element?.name,has_data_attr:data_attributes.includes("data-attr"),data_attributes,attribute_length:element?.attributes.length})},createAction:_ref8=>{let{element}=_ref8;actions.selectElement(null),actions.newAction(element)}}})),(0,index_esm.events)((_ref9=>{let{cache,values,actions}=_ref9;return{afterMount:()=>{cache.updateRelativePosition=function debounce(func,waitFor){let timeout;return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];clearTimeout(timeout),timeout=setTimeout((()=>func(...args)),waitFor)}}((()=>{const relativePositionCompensation="relative"===window.getComputedStyle(document.body).position?document.documentElement.getBoundingClientRect().y-document.body.getBoundingClientRect().y:0;relativePositionCompensation!==values.relativePositionCompensation&&actions.setRelativePositionCompensation(relativePositionCompensation)}),100),cache.onClick=()=>actions.updateRects(),cache.onScrollResize=()=>{window.clearTimeout(cache.clickDelayTimeout),actions.updateRects(),cache.clickDelayTimeout=window.setTimeout(actions.updateRects,100),cache.updateRelativePosition()},cache.onKeyDown=e=>{27===e.keyCode&&(values.hoverElement&&actions.setHoverElement(null),values.selectedElement?actions.setSelectedElement(null):"heatmap"===values.enabledLast&&values.heatmapEnabled?heatmapLogic.actions.disableHeatmap():values.inspectEnabled?actions.disableInspect():values.heatmapEnabled&&heatmapLogic.actions.disableHeatmap())},window.addEventListener("click",cache.onClick),window.addEventListener("resize",cache.onScrollResize),window.addEventListener("keydown",cache.onKeyDown),window.document.addEventListener("scroll",cache.onScrollResize,!0),cache.updateRelativePosition()},beforeUnmount:()=>{window.removeEventListener("click",cache.onClick),window.removeEventListener("resize",cache.onScrollResize),window.removeEventListener("keydown",cache.onKeyDown),window.document.removeEventListener("scroll",cache.onScrollResize,!0)}}}))]),toolbarLogic=(0,index_esm.kea)([(0,index_esm.path)(["toolbar","bar","toolbarLogic"]),(0,index_esm.connect)((()=>({actions:[actionsTabLogic,["showButtonActions","hideButtonActions"],elementsLogic,["enableInspect","disableInspect","createAction"],heatmapLogic,["enableHeatmap","disableHeatmap"]]}))),(0,index_esm.actions)((()=>({toggleTheme:theme=>({theme}),toggleMinimized:minimized=>({minimized}),setHedgehogMode:hedgehogMode=>({hedgehogMode}),setDragPosition:(x,y)=>({x,y}),setHedgehogActor:actor=>({actor}),syncWithHedgehog:!0,setVisibleMenu:visibleMenu=>({visibleMenu}),onMouseDown:event=>({event}),setDragging:function(){return{dragging:!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}},setElement:element=>({element}),setMenu:element=>({element})}))),(0,kea_window_values_lib.windowValues)((()=>({windowHeight:window=>window.innerHeight,windowWidth:window=>Math.min(window.innerWidth,window.document.body.clientWidth)}))),(0,index_esm.reducers)((()=>({element:[null,{setElement:(_,_ref)=>{let{element}=_ref;return element}}],menu:[null,{setMenu:(_,_ref2)=>{let{element}=_ref2;return element}}],visibleMenu:["none",{setVisibleMenu:(_,_ref3)=>{let{visibleMenu}=_ref3;return visibleMenu},setHedgehogMode:(state,_ref4)=>{let{hedgehogMode}=_ref4;return hedgehogMode?"hedgehog":"hedgehog"===state?"none":state}}],minimized:[!1,{persist:!0},{toggleMinimized:(state,_ref5)=>{let{minimized}=_ref5;return null!=minimized?minimized:!state}}],theme:["dark",{persist:!0},{toggleTheme:(state,_ref6)=>{let{theme}=_ref6;return null!=theme?theme:"light"===state?"dark":"light"}}],isDragging:[!1,{setDragging:(_,_ref7)=>{let{dragging}=_ref7;return dragging}}],lastDragPosition:[null,{persist:!0},{setDragPosition:(_,_ref8)=>{let{x,y}=_ref8;return{x,y}}}],hedgehogMode:[!1,{persist:!0},{setHedgehogMode:(_,_ref9)=>{let{hedgehogMode}=_ref9;return hedgehogMode}}],hedgehogActor:[null,{setHedgehogActor:(_,_ref10)=>{let{actor}=_ref10;return actor}}]}))),(0,index_esm.selectors)({dragPosition:[s=>[s.element,s.lastDragPosition,s.windowWidth,s.windowHeight],(element,lastDragPosition,windowWidth,windowHeight)=>{var _element$offsetWidth,_element$offsetHeight;lastDragPosition??={x:.5*windowWidth,y:.5*windowHeight};const elWidth=(null!==(_element$offsetWidth=element?.offsetWidth)&&void 0!==_element$offsetWidth?_element$offsetWidth:40)+2,elHeight=(null!==(_element$offsetHeight=element?.offsetHeight)&&void 0!==_element$offsetHeight?_element$offsetHeight:40)+2;return{x:inBounds(2,lastDragPosition.x,windowWidth-elWidth-2),y:inBounds(2,lastDragPosition.y,windowHeight-elHeight-2)}}],menuProperties:[s=>[s.element,s.menu,s.dragPosition,s.windowWidth,s.windowHeight],(element,menu,dragPosition,windowWidth,windowHeight)=>{if(!element||!menu)return{};const elWidth=element.offsetWidth+2,elHeight=element.offsetHeight+2,isBelow=dragPosition.y+.5*elHeight<.5*windowHeight;let maxHeight=isBelow?windowHeight-dragPosition.y-elHeight-20:dragPosition.y-20;maxHeight=inBounds(0,maxHeight,.6*windowHeight);const desiredY=isBelow?dragPosition.y+elHeight+10:dragPosition.y-10,desiredX=dragPosition.x+.5*elWidth,top=inBounds(2,desiredY,windowHeight-elHeight);return{transform:`translate(${inBounds(2+.5*menu.clientWidth,desiredX,windowWidth-.5*menu.clientWidth-2)}px, ${top}px)`,maxHeight,isBelow}}]}),(0,index_esm.listeners)((_ref11=>{let{actions,values}=_ref11;return{setVisibleMenu:_ref12=>{let{visibleMenu}=_ref12;"heatmap"===visibleMenu?(actions.enableHeatmap(),values.hedgehogActor?.setAnimation("heatmaps")):"actions"===visibleMenu?(actions.showButtonActions(),values.hedgehogActor?.setAnimation("action")):"flags"===visibleMenu?values.hedgehogActor?.setAnimation("flag"):"inspect"===visibleMenu?(actions.enableInspect(),values.hedgehogActor?.setAnimation("inspect")):(actions.disableInspect(),actions.disableHeatmap(),actions.hideButtonActions(),actionsTabLogic.actions.selectAction(null))},onMouseDown:_ref13=>{let{event}=_ref13;if(!values.element||0!==event.button)return;const originContainerBounds=values.element.getBoundingClientRect(),offsetX=event.pageX-originContainerBounds.left,offsetY=event.pageY-originContainerBounds.top;let movedCount=0;const onMouseMove=e=>{movedCount+=1,movedCount>5&&(actions.setDragging(!0),actions.setDragPosition(e.pageX-offsetX,e.pageY-offsetY))},onMouseUp=e=>{0===e.button&&(actions.setDragging(!1),document.removeEventListener("mousemove",onMouseMove),document.removeEventListener("mouseup",onMouseUp))};document.addEventListener("mousemove",onMouseMove),document.addEventListener("mouseup",onMouseUp)},setDragging:_ref14=>{let{dragging}=_ref14;values.hedgehogActor&&(values.hedgehogActor.isDragging=dragging,values.hedgehogActor.update())},syncWithHedgehog:()=>{var _values$element$getBo,_values$element$getBo2;const actor=values.hedgehogActor;if(!values.hedgehogMode||!actor)return;const pageX=actor.x+.5*sprites.TE-.5*(null!==(_values$element$getBo=values.element?.getBoundingClientRect().width)&&void 0!==_values$element$getBo?_values$element$getBo:0),pageY=values.windowHeight-actor.y-sprites.TE-(null!==(_values$element$getBo2=values.element?.getBoundingClientRect().height)&&void 0!==_values$element$getBo2?_values$element$getBo2:0);actions.setDragPosition(pageX,pageY)},toggleMinimized:()=>{const sync=()=>{actions.syncWithHedgehog(),values.lastDragPosition&&actions.setDragPosition(values.lastDragPosition.x,values.lastDragPosition.y)};sync(),setTimeout((()=>sync()),150),setTimeout((()=>sync()),300),setTimeout((()=>sync()),550)},createAction:()=>{actions.setVisibleMenu("actions")}}})),(0,kea_subscriptions_lib.subscriptions)({theme:theme=>{const toolbarElement=getShadowRoot()?.getElementById("button-toolbar");toolbarElement?.setAttribute("theme",theme)}})]);function toElementsChain(element){const chain=[];let currentElement=element;for(;currentElement&&currentElement!==document.documentElement;)chain.push(currentElement),currentElement=currentElement.parentElement;return chain.map(((element,index)=>({attr_class:element.getAttribute("class")?.split(" "),attr_id:element.getAttribute("id")||void 0,attributes:Array.from(element.attributes).reduce(((acc,attr)=>(acc[attr.name]?acc[attr.name]+=` ${attr.value}`:acc[attr.name]=attr.value,acc)),{}),href:element.getAttribute("href")||void 0,tag_name:element.tagName.toLowerCase(),text:0===index?element.innerText:void 0})))}const actionsTabLogic=(0,index_esm.kea)([(0,index_esm.path)(["toolbar","actions","actionsTabLogic"]),(0,index_esm.actions)({selectAction:id=>({id:id||null}),newAction:element=>({element:element||null}),inspectForElementWithIndex:index=>({index}),editSelectorWithIndex:index=>({index}),inspectElementSelected:(element,index)=>({element,index}),incrementCounter:!0,saveAction:formValues=>({formValues}),deleteAction:!0,showButtonActions:!0,hideButtonActions:!0,setShowActionsTooltip:showActionsTooltip=>({showActionsTooltip}),setElementSelector:(selector,index)=>({selector,index})}),(0,index_esm.connect)((()=>({values:[toolbarConfigLogic,["dataAttributes","apiURL","temporaryToken","buttonVisible","userIntent","actionId","dataAttributes"],actionsLogic,["allActions"]]}))),(0,index_esm.reducers)({actionFormElementsChains:[{},{inspectElementSelected:(state,_ref)=>{let{element,index}=_ref;return null===index?[]:{...state,[index]:toElementsChain(element)}},newAction:(_,_ref2)=>{let{element}=_ref2;return{0:element?toElementsChain(element):[]}}}],buttonActionsVisible:[!1,{showButtonActions:()=>!0,hideButtonActions:()=>!1}],selectedActionId:[null,{selectAction:(_,_ref3)=>{let{id}=_ref3;return id},newAction:()=>"new"}],newActionForElement:[null,{newAction:(_,_ref4)=>{let{element}=_ref4;return element},selectAction:()=>null}],inspectingElement:[null,{inspectForElementWithIndex:(_,_ref5)=>{let{index}=_ref5;return index},inspectElementSelected:()=>null,selectAction:()=>null,newAction:()=>null}],editingSelector:[null,{editSelectorWithIndex:(_,_ref6)=>{let{index}=_ref6;return index}}],counter:[0,{incrementCounter:state=>state+1}],showActionsTooltip:[!1,{setShowActionsTooltip:(_,_ref7)=>{let{showActionsTooltip}=_ref7;return showActionsTooltip}}]}),(0,kea_forms_lib.forms)((_ref8=>{let{values,actions}=_ref8;return{actionForm:{defaults:{name:null,steps:[{}]},errors:_ref9=>{let{name}=_ref9;return{name:name&&name.length?void 0:"Must name this action"}},submit:async(formValues,breakpoint)=>{const actionToSave={...formValues,steps:formValues.steps?.map(stepToDatabaseFormat)||[]},{apiURL,temporaryToken}=values,{selectedActionId}=values;let response;response=selectedActionId&&"new"!==selectedActionId?await api.ZP.update(`${apiURL}/api/projects/@current/actions/${selectedActionId}/?temporary_token=${temporaryToken}`,actionToSave):await api.ZP.create(`${apiURL}/api/projects/@current/actions/?temporary_token=${temporaryToken}`,actionToSave),breakpoint(),actionsLogic.actions.updateAction({action:response}),actions.selectAction(null),lemonToast.UJ.success("Action saved",{button:{label:"Open in PostHog",action:()=>window.open(`${apiURL}${urls.j.action(response.id)}`,"_blank")}})},showErrorsOnTouch:!0,alwaysShowErrors:!1}}})),(0,index_esm.selectors)({editingSelectorValue:[s=>[s.editingSelector,s.actionForm],(editingSelector,actionForm)=>{if(null===editingSelector)return null;{const selector=actionForm.steps?.[editingSelector].selector;return selector||null}}],elementsChainBeingEdited:[s=>[s.editingSelector,s.actionFormElementsChains],(editingSelector,elementChains)=>null===editingSelector?[]:elementChains[editingSelector]||[]],selectedAction:[s=>[s.selectedActionId,s.newActionForElement,s.allActions,s.dataAttributes],(selectedActionId,newActionForElement,allActions,dataAttributes)=>"new"===selectedActionId?function newAction(element){return{name:"",steps:[element?actionStepToActionStepFormItem(elementToActionStep(element,arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]),!0):{}]}}(newActionForElement,dataAttributes):allActions.find((a=>a.id===selectedActionId))||null]}),(0,kea_subscriptions_lib.subscriptions)((_ref10=>{let{actions}=_ref10;return{selectedAction:selectedAction=>{selectedAction?actions.setActionFormValues({...selectedAction,steps:selectedAction.steps?selectedAction.steps.map((step=>actionStepToActionStepFormItem(step,!1))):[{}]}):actions.setActionFormValues({name:null,steps:[{}]})}}})),(0,index_esm.listeners)((_ref11=>{let{actions,values}=_ref11;return{setElementSelector:_ref12=>{let{selector,index}=_ref12;if(values.actionForm){const steps=[...values.actionForm.steps||[]];steps&&steps[index]&&(steps[index].selector=selector),actions.setActionFormValue("steps",steps)}},selectAction:_ref13=>{let{id}=_ref13;id&&(values.buttonVisible||toolbarConfigLogic.actions.showButton(),values.buttonActionsVisible||actions.showButtonActions(),toolbarLogic.actions.setVisibleMenu("actions"))},inspectElementSelected:_ref14=>{let{element,index}=_ref14;if(values.actionForm){const actionStep=actionStepToActionStepFormItem(elementToActionStep(element,values.dataAttributes),!0),newSteps=(values.actionForm.steps||[]).map(((step,i)=>i===(null!=index?index:0)?actionStep:step));actions.setActionFormValue("steps",newSteps),actions.incrementCounter()}},deleteAction:async()=>{const{selectedActionId,apiURL,temporaryToken}=values;selectedActionId&&"new"!==selectedActionId&&(await api.ZP.delete(`${apiURL}/api/projects/@current/actions/${selectedActionId}/?temporary_token=${temporaryToken}`),actionsLogic.actions.deleteAction({id:selectedActionId}),actions.selectAction(null),lemonToast.UJ.info("Action deleted"))},showButtonActions:()=>{actionsLogic.actions.getActions(),posthog.capture("toolbar mode triggered",{mode:"actions",enabled:!0})},hideButtonActions:()=>{actions.setShowActionsTooltip(!1),posthog.capture("toolbar mode triggered",{mode:"actions",enabled:!1})},[actionsLogic.actionTypes.getActionsSuccess]:()=>{const{userIntent,actionId}=values;"edit-action"===userIntent?(actions.selectAction(actionId),toolbarConfigLogic.actions.clearUserIntent()):"add-action"===userIntent?(actions.newAction(),toolbarConfigLogic.actions.clearUserIntent()):actions.setShowActionsTooltip(!0)},setShowActionsTooltip:async(_ref15,breakpoint)=>{let{showActionsTooltip}=_ref15;showActionsTooltip&&(await breakpoint(1e3),actions.setShowActionsTooltip(!1))}}}))]);var LemonCheckbox=__webpack_require__("./frontend/src/lib/lemon-ui/LemonCheckbox/index.ts"),LemonInput_LemonInput=__webpack_require__("./frontend/src/lib/lemon-ui/LemonInput/LemonInput.tsx"),LemonSegmentedButton=__webpack_require__("./frontend/src/lib/lemon-ui/LemonSegmentedButton/index.ts"),LemonTextArea=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTextArea/LemonTextArea.tsx"),hints=__webpack_require__("./frontend/src/scenes/actions/hints.tsx"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function SelectorCount(_ref){let{selector}=_ref;const[matches,selectorError]=(0,react.useMemo)((()=>{let _selectorError=!1,_matches=0;if(selector)try{_matches=(0,querySelectorDeep.Jp)(selector).length}catch{_selectorError=!0}return[_matches,_selectorError]}),[selector]);return(0,jsx_runtime.jsx)("small",{className:`float-right ${selectorError&&"text-danger"}`,children:selectorError?"Invalid selector":`Matches ${matches} element${1===matches?"":"s"}`})}try{SelectorCount.displayName="SelectorCount",SelectorCount.__docgenInfo={description:"",displayName:"SelectorCount",props:{selector:{defaultValue:null,description:"",name:"selector",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/actions/SelectorCount.tsx#SelectorCount"]={docgenInfo:SelectorCount.__docgenInfo,name:"SelectorCount",path:"frontend/src/toolbar/actions/SelectorCount.tsx#SelectorCount"})}catch(__react_docgen_typescript_loader_error){}function StepField(_ref){let{step,item,label,caption}=_ref;const selected=step&&step[`${item}_selected`];return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.default)("action-field my-1",selected&&"action-field-selected"),children:[(0,jsx_runtime.jsxs)("div",{children:["href"===item&&step?.href&&(0,jsx_runtime.jsx)(SelectorCount,{selector:`a[href="${(0,cssEscape.Q)(step.href)}"]`}),"selector"===item&&step?.selector&&(0,jsx_runtime.jsx)(SelectorCount,{selector:step.selector}),(0,jsx_runtime.jsx)(kea_forms_lib.Field,{name:`${item}_selected`,noStyle:!0,children:_ref2=>{let{onChange,value}=_ref2;return(0,jsx_runtime.jsx)(LemonCheckbox.H,{label,onChange,checked:value})}}),caption&&(0,jsx_runtime.jsx)("div",{className:"action-field-caption",children:caption})]}),["url","href","text"].includes(item)?(0,jsx_runtime.jsx)(kea_forms_lib.Field,{name:`${item}_matching`,children:_ref3=>{let{value,onChange}=_ref3;return null==value&&(value="url"===item?types.E_.Contains:types.E_.Exact),(0,jsx_runtime.jsx)(LemonSegmentedButton.P,{fullWidth:!0,className:(0,clsx_m.default)("mb-1",!selected&&"opacity-50"),size:"small",options:[{value:types.E_.Exact,label:"Exact"},{value:types.E_.Regex,label:"Regex"},{value:types.E_.Contains,label:"Contains"}],value,onChange})}}):null,(0,jsx_runtime.jsx)(kea_forms_lib.Field,{name:item,children:_ref4=>{let{value,onChange}=_ref4;return"selector"===item?(0,jsx_runtime.jsx)(LemonTextArea._,{className:(0,clsx_m.default)(!selected&&"opacity-50"),onChange,value:null!=value?value:"",stopPropagation:!0}):(0,jsx_runtime.jsx)(LemonInput_LemonInput.D,{className:(0,clsx_m.default)(!selected&&"opacity-50"),onChange,value:null!=value?value:"",stopPropagation:!0})}}),"url"===item&&step?.url_matching&&step.url_matching in hints.i?(0,jsx_runtime.jsx)("div",{className:"action-field-hint",children:hints.i[step.url_matching]}):null]})})}try{StepField.displayName="StepField",StepField.__docgenInfo={description:"",displayName:"StepField",props:{item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"enum",value:[{value:'"href"'},{value:'"text"'},{value:'"url"'},{value:'"selector"'}]}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"ActionStepForm"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},caption:{defaultValue:null,description:"",name:"caption",required:!1,type:{name:"string | Element"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/actions/StepField.tsx#StepField"]={docgenInfo:StepField.__docgenInfo,name:"StepField",path:"frontend/src/toolbar/actions/StepField.tsx#StepField"})}catch(__react_docgen_typescript_loader_error){}function ToolbarMenu(_ref){let{children}=_ref;return(0,jsx_runtime.jsx)("div",{className:"w-full h-full flex flex-col overflow-hidden",children})}ToolbarMenu.Header=function ToolbarMenuHeader(_ref2){let{children}=_ref2;return(0,jsx_runtime.jsx)("div",{className:"pt-1 px-1",children})},ToolbarMenu.Body=function ToolbarMenuBody(_ref3){let{children}=_ref3;return(0,jsx_runtime.jsx)("div",{className:"flex flex-col flex-1 h-full overflow-y-auto px-1 min-h-20",children})},ToolbarMenu.Footer=function ToolbarMenufooter(_ref4){let{children}=_ref4;return(0,jsx_runtime.jsx)("div",{className:"flex flex-row items-center p-2 border-t",children})};try{ToolbarMenu.displayName="ToolbarMenu",ToolbarMenu.__docgenInfo={description:"",displayName:"ToolbarMenu",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/bar/ToolbarMenu.tsx#ToolbarMenu"]={docgenInfo:ToolbarMenu.__docgenInfo,name:"ToolbarMenu",path:"frontend/src/toolbar/bar/ToolbarMenu.tsx#ToolbarMenu"})}catch(__react_docgen_typescript_loader_error){}try{Header.displayName="ToolbarMenu.Header",Header.__docgenInfo={description:"",displayName:"ToolbarMenu.Header",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/bar/ToolbarMenu.tsx#ToolbarMenu.Header"]={docgenInfo:ToolbarMenu.Header.__docgenInfo,name:"ToolbarMenu.Header",path:"frontend/src/toolbar/bar/ToolbarMenu.tsx#ToolbarMenu.Header"})}catch(__react_docgen_typescript_loader_error){}try{Body.displayName="ToolbarMenu.Body",Body.__docgenInfo={description:"",displayName:"ToolbarMenu.Body",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/bar/ToolbarMenu.tsx#ToolbarMenu.Body"]={docgenInfo:ToolbarMenu.Body.__docgenInfo,name:"ToolbarMenu.Body",path:"frontend/src/toolbar/bar/ToolbarMenu.tsx#ToolbarMenu.Body"})}catch(__react_docgen_typescript_loader_error){}try{Footer.displayName="ToolbarMenu.Footer",Footer.__docgenInfo={description:"",displayName:"ToolbarMenu.Footer",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/bar/ToolbarMenu.tsx#ToolbarMenu.Footer"]={docgenInfo:ToolbarMenu.Footer.__docgenInfo,name:"ToolbarMenu.Footer",path:"frontend/src/toolbar/bar/ToolbarMenu.tsx#ToolbarMenu.Footer"})}catch(__react_docgen_typescript_loader_error){}var HTMLElementsDisplay=__webpack_require__("./frontend/src/lib/components/HTMLElementsDisplay/HTMLElementsDisplay.tsx"),LemonModal=__webpack_require__("./frontend/src/lib/lemon-ui/LemonModal/index.ts");const SelectorEditingModal=_ref=>{let{isOpen,setIsOpen,activeElementChain,onChange,startingSelector}=_ref;const[chosenSelector,setChosenSelector]=(0,react.useState)(null);return(0,jsx_runtime.jsx)(LemonModal.f,{forceAbovePopovers:!0,getPopupContainer:getShadowRootPopoverContainer,description:"Click on elements and their attributes to build a selector",footer:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"secondary",onClick:()=>setIsOpen(!1),children:"Cancel"}),(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"primary",onClick:e=>{e.stopPropagation(),onChange?.(chosenSelector),setIsOpen(!1)},children:"Apply"})]}),onClose:()=>setIsOpen(!1),isOpen,title:"Edit the selector",children:(0,jsx_runtime.jsx)(HTMLElementsDisplay.t,{editable:!0,highlight:!1,elements:activeElementChain,checkUniqueness:!0,onChange:setChosenSelector,startingSelector:null!=startingSelector?startingSelector:void 0})})};try{SelectorEditingModal.displayName="SelectorEditingModal",SelectorEditingModal.__docgenInfo={description:"",displayName:"SelectorEditingModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},setIsOpen:{defaultValue:null,description:"",name:"setIsOpen",required:!0,type:{name:"(open: boolean) => void"}},activeElementChain:{defaultValue:null,description:"",name:"activeElementChain",required:!0,type:{name:"ElementType[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((selector: string | null) => void)"}},startingSelector:{defaultValue:null,description:"",name:"startingSelector",required:!1,type:{name:"string | null"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/elements/SelectorEditingModal.tsx#SelectorEditingModal"]={docgenInfo:SelectorEditingModal.__docgenInfo,name:"SelectorEditingModal",path:"frontend/src/toolbar/elements/SelectorEditingModal.tsx#SelectorEditingModal"})}catch(__react_docgen_typescript_loader_error){}const ActionsEditingToolbarMenu=()=>{const{selectedActionId,inspectingElement,editingSelector,elementsChainBeingEdited,editingSelectorValue,actionForm}=(0,index_esm.useValues)(actionsTabLogic),{setActionFormValue,selectAction,inspectForElementWithIndex,deleteAction,setElementSelector,editSelectorWithIndex}=(0,index_esm.useActions)(actionsTabLogic);return(0,jsx_runtime.jsxs)(ToolbarMenu,{children:[(0,jsx_runtime.jsx)(SelectorEditingModal,{isOpen:null!==editingSelector,setIsOpen:()=>editSelectorWithIndex(null),activeElementChain:elementsChainBeingEdited,startingSelector:editingSelectorValue,onChange:selector=>{selector&&null!==editingSelector&&(posthog.capture("toolbar_manual_selector_applied",{chosenSelector:selector}),setElementSelector(selector,editingSelector))}}),(0,jsx_runtime.jsxs)(kea_forms_lib.Form,{name:"action_step",logic:actionsTabLogic,formKey:"actionForm",enableFormOnSubmit:!0,className:"flex flex-col overflow-hidden flex-1",children:[(0,jsx_runtime.jsx)(ToolbarMenu.Header,{children:(0,jsx_runtime.jsxs)("h1",{className:"p-1 font-bold text-sm mb-0",children:["new"===selectedActionId?"New ":"Edit ","action"]})}),(0,jsx_runtime.jsx)(ToolbarMenu.Body,{children:(0,jsx_runtime.jsxs)("div",{className:"p-1",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("p",{children:"What did your user do?"}),(0,jsx_runtime.jsx)(kea_forms_lib.Field,{name:"name",children:(0,jsx_runtime.jsx)(LemonInput.D,{placeholder:"E.g: Clicked Sign Up",className:"action-title-field",stopPropagation:!0})})]}),actionForm.steps?.map(((step,index)=>(0,jsx_runtime.jsxs)(kea_forms_lib.Group,{name:["steps",index],children:[(0,jsx_runtime.jsx)(src.LemonDivider,{}),(0,jsx_runtime.jsxs)("div",{className:"p-1 flex flex-col gap-2",children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,jsx_runtime.jsxs)("h3",{children:[index>0?"OR ":null,"Element #",index+1]}),(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"tertiary",status:"muted",size:"small",onClick:()=>setActionFormValue("steps",actionForm.steps?.filter(((_,i)=>i!==index))),sideIcon:(0,jsx_runtime.jsx)(icons.Y29,{}),children:"Remove"})]}),(0,jsx_runtime.jsx)("div",{className:"action-inspect",children:(0,jsx_runtime.jsx)(LemonButton.Jp,{size:"small",type:inspectingElement===index?"primary":"secondary",onClick:e=>{e.stopPropagation(),inspectForElementWithIndex(inspectingElement===index?null:index)},icon:(0,jsx_runtime.jsx)(icons.j$p,{}),children:"$autocapture"===step?.event?"Change Element":"Select Element"})}),"$autocapture"===step?.event||inspectingElement===index?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(StepField,{step,item:"selector",label:"Selector",caption:"CSS selector that uniquely identifies your element"}),(0,jsx_runtime.jsx)("div",{className:"flex flex-row justify-end mb-2",children:(0,jsx_runtime.jsx)(LemonButton.Jp,{size:"small",type:"secondary",icon:(0,jsx_runtime.jsx)(icons.yl5,{}),onClick:e=>{e.stopPropagation(),posthog.capture("toolbar_manual_selector_modal_opened",{selector:step?.selector}),editSelectorWithIndex(index)},getTooltipPopupContainer:getShadowRootPopoverContainer,children:"Edit the selector"})}),(0,jsx_runtime.jsx)(StepField,{step,item:"href",label:"Link target",caption:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["If your element is a link, the location that the link opens (",(0,jsx_runtime.jsx)("code",{children:"href"})," tag)"]})}),(0,jsx_runtime.jsx)(StepField,{step,item:"text",label:"Text",caption:"Text content inside your element"}),(0,jsx_runtime.jsx)(StepField,{step,item:"url",label:"Page URL",caption:"Elements will match only when triggered from the URL."})]}):null,index===(actionForm.steps?.length||0)-1?(0,jsx_runtime.jsx)("div",{className:"text-right mt-4",children:(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"secondary",status:"muted",size:"small",sideIcon:(0,jsx_runtime.jsx)(icons.SC9,{}),onClick:()=>setActionFormValue("steps",[...actionForm.steps||[],{}]),children:"Add Another Element"})}):null]},index)]},index))),0===(actionForm.steps||[]).length?(0,jsx_runtime.jsx)(LemonButton.Jp,{icon:(0,jsx_runtime.jsx)(icons.SC9,{}),size:"small",type:"primary",onClick:()=>setActionFormValue("steps",[...actionForm.steps||[],{}]),className:"my-2",children:"Add An Element"}):null]})}),(0,jsx_runtime.jsxs)(ToolbarMenu.Footer,{children:[(0,jsx_runtime.jsx)("span",{className:"flex-1",children:(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"secondary",status:"muted",size:"small",onClick:()=>selectAction(null),sideIcon:(0,jsx_runtime.jsx)(icons.bMz,{}),children:"Cancel"})}),(0,jsx_runtime.jsxs)(LemonButton.Jp,{type:"primary",htmlType:"submit",children:["new"===selectedActionId?"Create ":"Save ","action"]}),"new"!==selectedActionId?(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"secondary",status:"danger",onClick:deleteAction,icon:(0,jsx_runtime.jsx)(icons.Fzz,{})}):null]})]})]})};function ActionsListView(_ref){let{actions}=_ref;const{allActionsLoading,searchTerm}=(0,index_esm.useValues)(actionsLogic),{selectAction}=(0,index_esm.useActions)(actionsTabLogic);return(0,jsx_runtime.jsx)("div",{className:"flex flex-col h-full overflow-y-scoll space-y-x",children:allActionsLoading?(0,jsx_runtime.jsx)("div",{className:"flex items-center",children:(0,jsx_runtime.jsx)(Spinner.$,{className:"text-4xl"})}):actions.length?actions.map(((action,index)=>(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)(src.Link,{subtle:!0,onClick:()=>selectAction(action.id||null),className:"font-medium my-1",children:[(0,jsx_runtime.jsxs)("span",{className:"min-w-8 inline-block text-left",children:[index+1,"."]}),(0,jsx_runtime.jsx)("span",{className:"flex-grow",children:action.name||(0,jsx_runtime.jsx)("span",{className:"italic text-muted-alt",children:"Untitled"})})]},action.id)}))):(0,jsx_runtime.jsxs)("div",{className:"p-2",children:["No ",searchTerm.length?"matching ":"","actions found."]})})}try{ActionsListView.displayName="ActionsListView",ActionsListView.__docgenInfo={description:"",displayName:"ActionsListView",props:{actions:{defaultValue:null,description:"",name:"actions",required:!0,type:{name:"ActionType[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/actions/ActionsListView.tsx#ActionsListView"]={docgenInfo:ActionsListView.__docgenInfo,name:"ActionsListView",path:"frontend/src/toolbar/actions/ActionsListView.tsx#ActionsListView"})}catch(__react_docgen_typescript_loader_error){}const ActionsListToolbarMenu=()=>{const{searchTerm}=(0,index_esm.useValues)(actionsLogic),{setSearchTerm}=(0,index_esm.useActions)(actionsLogic),{newAction}=(0,index_esm.useActions)(actionsTabLogic),{allActions,sortedActions,allActionsLoading}=(0,index_esm.useValues)(actionsLogic),{apiURL}=(0,index_esm.useValues)(toolbarConfigLogic);return(0,jsx_runtime.jsxs)(ToolbarMenu,{children:[(0,jsx_runtime.jsx)(ToolbarMenu.Header,{children:(0,jsx_runtime.jsx)(LemonInput.D,{autoFocus:!0,fullWidth:!0,placeholder:"Search",type:"search",value:searchTerm,onChange:s=>setSearchTerm(s),className:"Toolbar__top_input"})}),(0,jsx_runtime.jsx)(ToolbarMenu.Body,{children:(0,jsx_runtime.jsx)("div",{className:"px-1 space-y-px py-2",children:0===allActions.length&&allActionsLoading?(0,jsx_runtime.jsx)("div",{className:"text-center my-4",children:(0,jsx_runtime.jsx)(Spinner.$,{})}):(0,jsx_runtime.jsx)(ActionsListView,{actions:sortedActions})})}),(0,jsx_runtime.jsx)(ToolbarMenu.Footer,{children:(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between flex-1",children:[(0,jsx_runtime.jsxs)(Link.r,{to:`${apiURL}${urls.j.actions()}`,target:"_blank",children:["View & edit all actions ",(0,jsx_runtime.jsx)(icons.pFn,{})]}),(0,jsx_runtime.jsx)(LemonButton.Jp,{type:"primary",size:"small",onClick:()=>newAction(),icon:(0,jsx_runtime.jsx)(icons.SC9,{}),children:"New action"})]})})]})},ActionsToolbarMenu=()=>{const{selectedAction}=(0,index_esm.useValues)(actionsTabLogic);return selectedAction?(0,jsx_runtime.jsx)(ActionsEditingToolbarMenu,{}):(0,jsx_runtime.jsx)(ActionsListToolbarMenu,{})};var AnimatedCollapsible=__webpack_require__("./frontend/src/lib/components/AnimatedCollapsible.tsx"),LemonSwitch=__webpack_require__("./frontend/src/lib/lemon-ui/LemonSwitch/index.ts");const featureFlagsLogic=(0,index_esm.kea)([(0,index_esm.path)(["toolbar","flags","featureFlagsLogic"]),(0,index_esm.connect)((()=>({values:[toolbarConfigLogic,["posthog"]]}))),(0,index_esm.actions)({getUserFlags:!0,setOverriddenUserFlag:(flagKey,overrideValue)=>({flagKey,overrideValue}),deleteOverriddenUserFlag:flagKey=>({flagKey}),setSearchTerm:searchTerm=>({searchTerm}),checkLocalOverrides:!0,storeLocalOverrides:localOverrides=>({localOverrides})}),(0,kea_loaders_lib.loaders)((_ref=>{let{values}=_ref;return{userFlags:[[],{getUserFlags:async(_,breakpoint)=>{const params={groups:getGroups(values.posthog)},response=await toolbarFetch(`/api/projects/@current/feature_flags/my_flags${(0,lib.encodeParams)(params,"?")}`);return response.status>=400?(toolbarConfigLogic.actions.tokenExpired(),[]):(breakpoint(),response.ok?await response.json():[])}}]}})),(0,index_esm.reducers)({localOverrides:[{},{storeLocalOverrides:(_,_ref2)=>{let{localOverrides}=_ref2;return localOverrides}}],searchTerm:["",{setSearchTerm:(_,_ref3)=>{let{searchTerm}=_ref3;return searchTerm}}]}),(0,index_esm.selectors)({userFlagsWithOverrideInfo:[s=>[s.userFlags,s.localOverrides],(userFlags,localOverrides)=>userFlags.map((flag=>{const hasVariants=(flag.feature_flag.filters?.multivariate?.variants?.length||0)>0,currentValue=flag.feature_flag.key in localOverrides?localOverrides[flag.feature_flag.key]:flag.value;return{...flag,hasVariants,currentValue,hasOverride:flag.feature_flag.key in localOverrides}}))],filteredFlags:[s=>[s.searchTerm,s.userFlagsWithOverrideInfo],(searchTerm,userFlagsWithOverrideInfo)=>searchTerm?new fuse_esm.Z(userFlagsWithOverrideInfo,{threshold:.3,keys:["feature_flag.key","feature_flag.name"]}).search(searchTerm).map((_ref4=>{let{item}=_ref4;return item})):userFlagsWithOverrideInfo],countFlagsOverridden:[s=>[s.localOverrides],localOverrides=>Object.keys(localOverrides).length]}),(0,index_esm.listeners)((_ref5=>{let{actions,values}=_ref5;return{checkLocalOverrides:()=>{const clientPostHog=values.posthog;if(clientPostHog){const locallyOverrideFeatureFlags=clientPostHog.get_property("$override_feature_flags")||{};actions.storeLocalOverrides(locallyOverrideFeatureFlags)}},setOverriddenUserFlag:_ref6=>{let{flagKey,overrideValue}=_ref6;const clientPostHog=values.posthog;clientPostHog&&(clientPostHog.featureFlags.override({...values.localOverrides,[flagKey]:overrideValue}),posthog.capture("toolbar feature flag overridden"),actions.checkLocalOverrides(),clientPostHog.featureFlags.reloadFeatureFlags())},deleteOverriddenUserFlag:_ref7=>{let{flagKey}=_ref7;const clientPostHog=values.posthog;if(clientPostHog){const updatedFlags={...values.localOverrides};delete updatedFlags[flagKey],Object.keys(updatedFlags).length>0?clientPostHog.featureFlags.override({...updatedFlags}):clientPostHog.featureFlags.override(!1),posthog.capture("toolbar feature flag override removed"),actions.checkLocalOverrides(),clientPostHog.featureFlags.reloadFeatureFlags()}}}})),(0,index_esm.events)((_ref8=>{let{actions}=_ref8;return{afterMount:()=>{actions.getUserFlags(),actions.checkLocalOverrides()}}}))]);function getGroups(posthogInstance){try{return posthogInstance?.getGroups()||{}}catch{return{}}}const FlagsToolbarMenu=()=>{const{searchTerm,filteredFlags,userFlagsLoading}=(0,index_esm.useValues)(featureFlagsLogic),{setSearchTerm,setOverriddenUserFlag,deleteOverriddenUserFlag}=(0,index_esm.useActions)(featureFlagsLogic),{apiURL}=(0,index_esm.useValues)(toolbarConfigLogic);return(0,jsx_runtime.jsxs)(ToolbarMenu,{children:[(0,jsx_runtime.jsx)(ToolbarMenu.Header,{children:(0,jsx_runtime.jsx)(LemonInput.D,{autoFocus:!0,placeholder:"Search",fullWidth:!0,type:"search",value:searchTerm,onChange:s=>setSearchTerm(s)})}),(0,jsx_runtime.jsx)(ToolbarMenu.Body,{children:(0,jsx_runtime.jsx)("div",{className:"space-y-px",children:filteredFlags.length>0?filteredFlags.map((_ref=>{let{feature_flag,value,hasOverride,hasVariants,currentValue}=_ref;return(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.default)("p-1 rounded",hasOverride&&"bg-mark"),children:[(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.default)("flex flex-row items-center"),children:[(0,jsx_runtime.jsx)("div",{className:"flex-1 truncate",children:(0,jsx_runtime.jsxs)(Link.r,{className:"font-medium",to:`${apiURL}${feature_flag.id?urls.j.featureFlag(feature_flag.id):urls.j.featureFlags()}`,subtle:!0,target:"_blank",children:[feature_flag.key,(0,jsx_runtime.jsx)(icons.pFn,{})]})}),(0,jsx_runtime.jsx)(LemonSwitch.f,{checked:!!currentValue,onChange:checked=>{const newValue=hasVariants&&checked?feature_flag.filters?.multivariate?.variants[0]?.key:checked;newValue===value&&hasOverride?deleteOverriddenUserFlag(feature_flag.key):setOverriddenUserFlag(feature_flag.key,newValue)}})]}),(0,jsx_runtime.jsx)(AnimatedCollapsible.r,{collapsed:!hasVariants||!currentValue,children:(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.default)("flex flex-col px-2 ml-2",hasOverride&&"overridden"),children:feature_flag.filters?.multivariate?.variants.map((variant=>(0,jsx_runtime.jsx)(LemonCheckbox.H,{fullWidth:!0,checked:currentValue===variant.key,label:`${variant.key} - ${variant.name} (${variant.rollout_percentage}%)`,onChange:()=>{const newValue=variant.key;newValue===value&&hasOverride?deleteOverriddenUserFlag(feature_flag.key):setOverriddenUserFlag(feature_flag.key,newValue)},className:(0,clsx_m.default)(currentValue===variant.key&&"font-bold rounded bg-primary-highlight","px-2 py-1")},variant.key)))})})]},feature_flag.key)})):(0,jsx_runtime.jsx)("div",{className:"flex flex-row items-center px-2 py-1",children:userFlagsLoading?(0,jsx_runtime.jsx)("span",{className:"flex-1 flex justify-center items-center p-4",children:(0,jsx_runtime.jsx)(Spinner.$,{className:"text-2xl"})}):`No ${searchTerm.length?"matching ":""}feature flags found.`})})}),(0,jsx_runtime.jsx)(ToolbarMenu.Footer,{children:(0,jsx_runtime.jsx)("span",{className:"text-xs",children:"Note: overriding feature flags will only affect this browser."})})]})};var DateFilter=__webpack_require__("./frontend/src/lib/components/DateFilter/DateFilter.tsx"),Tooltip=__webpack_require__("./frontend/src/lib/lemon-ui/Tooltip/index.ts");const HeatmapToolbarMenu=()=>{var _heatmapFilter$date_f;const{wildcardHref}=(0,index_esm.useValues)(currentPageLogic),{setWildcardHref}=(0,index_esm.useActions)(currentPageLogic),{matchLinksByHref,countedElements,clickCount,heatmapLoading,heatmapFilter,canLoadMoreElementStats}=(0,index_esm.useValues)(heatmapLogic),{setHeatmapFilter,loadMoreElementStats,setMatchLinksByHref}=(0,index_esm.useActions)(heatmapLogic),{setHighlightElement,setSelectedElement}=(0,index_esm.useActions)(elementsLogic);return(0,jsx_runtime.jsxs)(ToolbarMenu,{children:[(0,jsx_runtime.jsxs)(ToolbarMenu.Header,{children:[(0,jsx_runtime.jsx)(LemonInput.D,{value:wildcardHref,onChange:setWildcardHref}),(0,jsx_runtime.jsxs)("div",{className:"space-y-1 border-b px-1 pb-2",children:[(0,jsx_runtime.jsx)("div",{className:"text-muted p-1",children:"Use * as a wildcard"}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-row items-center space-x-2",children:[(0,jsx_runtime.jsx)(DateFilter.f,{dateFrom:null!==(_heatmapFilter$date_f=heatmapFilter.date_from)&&void 0!==_heatmapFilter$date_f?_heatmapFilter$date_f:"-7d",dateTo:heatmapFilter.date_to,onChange:(date_from,date_to)=>setHeatmapFilter({date_from,date_to}),getPopupContainer:getShadowRootPopoverContainer}),(0,jsx_runtime.jsx)(LemonButton.Jp,{icon:(0,jsx_runtime.jsx)(icons.JKM,{}),type:"secondary",status:"primary-alt",size:"small",onClick:loadMoreElementStats,disabledReason:canLoadMoreElementStats?void 0:"Loaded all elements in this data range.",getTooltipPopupContainer:getShadowRootPopoverContainer,children:"Load more"}),heatmapLoading?(0,jsx_runtime.jsx)(Spinner.$,{}):null]}),(0,jsx_runtime.jsxs)("div",{children:["Found: ",countedElements.length," elements / ",clickCount," clicks!"]}),(0,jsx_runtime.jsx)(Tooltip.u,{title:"Matching links by their target URL can exclude clicks from the heatmap if the URL is too unique.",getPopupContainer:getShadowRootPopoverContainer,children:(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(LemonSwitch.f,{checked:matchLinksByHref,label:"Match links by their target URL",onChange:checked=>setMatchLinksByHref(checked),fullWidth:!0,bordered:!0})})})]})]}),(0,jsx_runtime.jsx)(ToolbarMenu.Body,{children:(0,jsx_runtime.jsx)("div",{className:"flex flex-col space-y-2",children:(0,jsx_runtime.jsx)("div",{className:"flex flex-col w-full h-full",children:heatmapLoading?(0,jsx_runtime.jsx)("span",{className:"flex-1 flex justify-center items-center p-4",children:(0,jsx_runtime.jsx)(Spinner.$,{className:"text-2xl"})}):countedElements.length?countedElements.map(((_ref,index)=>{let{element,count,actionStep}=_ref;return(0,jsx_runtime.jsxs)("div",{className:"p-2 flex flex-row justify-between cursor-pointer hover:bg-primary-highlight",onClick:()=>setSelectedElement(element),onMouseEnter:()=>setHighlightElement(element),onMouseLeave:()=>setHighlightElement(null),children:[(0,jsx_runtime.jsxs)("div",{children:[index+1,".",actionStep?.text||(actionStep?.tag_name?(0,jsx_runtime.jsxs)("code",{children:["<",actionStep.tag_name,">"]}):(0,jsx_runtime.jsx)("em",{children:"Element"}))]}),(0,jsx_runtime.jsxs)("div",{children:[count," clicks"]})]},index)})):(0,jsx_runtime.jsx)("div",{className:"p-2",children:"No elements found."})})})})]})};var HedgehogAccessories=__webpack_require__("./frontend/src/lib/components/HedgehogBuddy/HedgehogAccessories.tsx");const HedgehogMenu=()=>{const{theme}=(0,index_esm.useValues)(toolbarLogic),{setHedgehogMode,setVisibleMenu}=(0,index_esm.useActions)(toolbarLogic);return(0,jsx_runtime.jsxs)(ToolbarMenu,{children:[(0,jsx_runtime.jsx)(ToolbarMenu.Body,{children:(0,jsx_runtime.jsx)("div",{className:"p-1",children:(0,jsx_runtime.jsx)(HedgehogAccessories._,{isDarkModeOn:"dark"===theme})})}),(0,jsx_runtime.jsx)(ToolbarMenu.Footer,{children:(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 justify-between flex-1",children:[(0,jsx_runtime.jsx)(src.LemonButton,{type:"secondary",size:"small",onClick:()=>setHedgehogMode(!1),children:"Go away..."}),(0,jsx_runtime.jsx)(src.LemonButton,{type:"primary",size:"small",onClick:()=>setVisibleMenu("none"),children:"Carry on!"})]})})]})};var ToolbarButton=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.31_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/toolbar/bar/ToolbarButton.scss"),ToolbarButton_default=__webpack_require__.n(ToolbarButton),ToolbarButton_options={insert:"head",singleton:!1};injectStylesIntoStyleTag_default()(ToolbarButton_default(),ToolbarButton_options);ToolbarButton_default().locals;const ToolbarButton_ToolbarButton=react.forwardRef(((_ref,ref)=>{let{icon,title,onClick,titleMinimized,menuId,...props}=_ref;const{visibleMenu,minimized,isDragging}=(0,index_esm.useValues)(toolbarLogic),{setVisibleMenu}=(0,index_esm.useActions)(toolbarLogic),active=visibleMenu===menuId,theTitle=null!=title?title:menuId?(0,utils.fm)(menuId):void 0,delayedIsDragging=react.useRef(!1);(0,react.useEffect)((()=>{isDragging?delayedIsDragging.current=!0:setTimeout((()=>{delayedIsDragging.current=!1}),100)}),[isDragging]);const theButton=(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.default)("ToolbarButton",active&&"ToolbarButton--active"),"aria-label":theTitle,ref,children:(0,jsx_runtime.jsx)("button",{className:"ToolbarButton__button",...props,onClick:e=>{delayedIsDragging.current||(e.preventDefault(),onClick?.(),menuId&&setVisibleMenu(visibleMenu===menuId?"none":menuId))},children:icon})});return!(minimized&&titleMinimized||theTitle)||active||isDragging?theButton:(0,jsx_runtime.jsx)(src.Tooltip,{title:minimized?titleMinimized:theTitle,getPopupContainer:getShadowRootPopoverContainer,children:theButton})}));ToolbarButton_ToolbarButton.displayName="ToolbarButton";try{ToolbarButton_ToolbarButton.displayName="ToolbarButton",ToolbarButton_ToolbarButton.__docgenInfo={description:"",displayName:"ToolbarButton",props:{icon:{defaultValue:null,description:"",name:"icon",required:!0,type:{name:"ReactElement<any, string | JSXElementConstructor<any>> | null"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void)"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},titleMinimized:{defaultValue:null,description:"",name:"titleMinimized",required:!1,type:{name:"string | Element"}},menuId:{defaultValue:null,description:"",name:"menuId",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"actions"'},{value:'"flags"'},{value:'"heatmap"'},{value:'"inspect"'},{value:'"hedgehog"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/bar/ToolbarButton.tsx#ToolbarButton"]={docgenInfo:ToolbarButton_ToolbarButton.__docgenInfo,name:"ToolbarButton",path:"frontend/src/toolbar/bar/ToolbarButton.tsx#ToolbarButton"})}catch(__react_docgen_typescript_loader_error){}const HELP_URL="https://posthog.com/docs/user-guides/toolbar?utm_medium=in-product&utm_campaign=toolbar-help-button";function MoreMenu(){const{hedgehogMode,theme}=(0,index_esm.useValues)(toolbarLogic),{setHedgehogMode,toggleTheme,setVisibleMenu}=(0,index_esm.useActions)(toolbarLogic),currentlyLightMode=!theme||"light"===theme,{logout}=(0,index_esm.useActions)(toolbarConfigLogic);return(0,jsx_runtime.jsx)(LemonMenu.d,{placement:"top-end",fallbackPlacements:["bottom-end"],getPopupContainer:getToolbarContainer,items:[{icon:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:""}),label:hedgehogMode?"Disable hedgehog mode":"Hedgehog mode",onClick:()=>{setHedgehogMode(!hedgehogMode)}},hedgehogMode?{icon:(0,jsx_runtime.jsx)(icons.yfQ,{}),label:"Hedgehog accessories",onClick:()=>{setVisibleMenu("hedgehog")}}:void 0,{icon:currentlyLightMode?(0,jsx_runtime.jsx)(posthog_icons_es.IconNight,{}):(0,jsx_runtime.jsx)(posthog_icons_es.IconDay,{}),label:`Switch to ${currentlyLightMode?"dark":"light"} mode`,onClick:()=>toggleTheme()},{icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconQuestion,{}),label:"Help",onClick:()=>{window.open(HELP_URL,"_blank")?.focus()}},{icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconX,{}),label:"Logout",onClick:logout}].filter(Boolean),maxContentWidth:!0,children:(0,jsx_runtime.jsx)(ToolbarButton_ToolbarButton,{icon:(0,jsx_runtime.jsx)(icons.dcc,{}),title:"More options"})})}function ToolbarInfoMenu(){const ref=(0,react.useRef)(null),{visibleMenu,isDragging,menuProperties,minimized}=(0,index_esm.useValues)(toolbarLogic),{setMenu}=(0,index_esm.useActions)(toolbarLogic),content=minimized?null:"flags"===visibleMenu?(0,jsx_runtime.jsx)(FlagsToolbarMenu,{}):"heatmap"===visibleMenu?(0,jsx_runtime.jsx)(HeatmapToolbarMenu,{}):"actions"===visibleMenu?(0,jsx_runtime.jsx)(ActionsToolbarMenu,{}):"hedgehog"===visibleMenu?(0,jsx_runtime.jsx)(HedgehogMenu,{}):null;return(0,react.useEffect)((()=>(setMenu(ref.current),()=>setMenu(null))),[ref.current]),(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.default)("ToolbarMenu",!!content&&"ToolbarMenu--visible",isDragging&&"ToolbarMenu--dragging",menuProperties.isBelow&&"ToolbarMenu--below"),style:{transform:menuProperties.transform},children:(0,jsx_runtime.jsx)("div",{ref,className:"ToolbarMenu__content",style:{maxHeight:menuProperties.maxHeight},children:content})})}function Toolbar_Toolbar(){const ref=(0,react.useRef)(null),{minimized,dragPosition,isDragging,hedgehogMode}=(0,index_esm.useValues)(toolbarLogic),{setVisibleMenu,toggleMinimized,onMouseDown,setElement}=(0,index_esm.useActions)(toolbarLogic),{isAuthenticated,userIntent}=(0,index_esm.useValues)(toolbarConfigLogic),{authenticate}=(0,index_esm.useActions)(toolbarConfigLogic);return(0,react.useEffect)((()=>(setElement(ref.current),()=>setElement(null))),[ref.current]),(0,useKeyboardHotkeys.l)({escape:{action:()=>setVisibleMenu("none"),willHandleEvent:!0}},[]),(0,react.useEffect)((()=>{"add-action"!==userIntent&&"edit-action"!==userIntent||setVisibleMenu("actions")}),[userIntent]),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(ToolbarInfoMenu,{}),(0,jsx_runtime.jsxs)("div",{ref,className:(0,clsx_m.default)("Toolbar",minimized&&"Toolbar--minimized",!isAuthenticated&&"Toolbar--unauthenticated",hedgehogMode&&"Toolbar--hedgehog-mode",isDragging&&"Toolbar--dragging"),onMouseDown:e=>onMouseDown(e),style:{"--toolbar-button-x":`${dragPosition.x}px`,"--toolbar-button-y":`${dragPosition.y}px`},children:[(0,jsx_runtime.jsx)(ToolbarButton_ToolbarButton,{icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconLogomark,{}),onClick:isAuthenticated?toggleMinimized:authenticate,title:isAuthenticated?"Minimize":"Authenticate the PostHog Toolbar",titleMinimized:isAuthenticated?"Expand the toolbar":"Authenticate the PostHog Toolbar"}),isAuthenticated?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(ToolbarButton_ToolbarButton,{icon:(0,jsx_runtime.jsx)(icons.l54,{}),menuId:"inspect"}),(0,jsx_runtime.jsx)(ToolbarButton_ToolbarButton,{icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconCursorClick,{}),menuId:"heatmap"}),(0,jsx_runtime.jsx)(ToolbarButton_ToolbarButton,{icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconBolt,{}),menuId:"actions"}),(0,jsx_runtime.jsx)(ToolbarButton_ToolbarButton,{icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconToggle,{}),menuId:"flags",title:"Feature flags"})]}):null,(0,jsx_runtime.jsx)(MoreMenu,{})]})]})}var Elements=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.31_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/toolbar/elements/Elements.scss"),Elements_default=__webpack_require__.n(Elements),Elements_options={insert:"head",singleton:!1};injectStylesIntoStyleTag_default()(Elements_default(),Elements_options);Elements_default().locals;function FocusRect(_ref){let{rect}=_ref;const widths=[0,rect.left+window.pageXOffset,rect.left+window.pageXOffset+rect.width,window.innerWidth],heights=[0,rect.top+window.pageYOffset,rect.top+window.pageYOffset+rect.height,document.body.scrollHeight],rects=[];for(let i=0;i<3;i++)for(let j=0;j<3;j++)1===i&&1===j||rects.push({id:3*j+i,x:widths[i],w:widths[i+1]-widths[i],y:heights[j],h:heights[j+1]-heights[j],bg:1===i||1===j?`linear-gradient(${1===j?180:90}deg, rgba(0,0,0,0.1) calc(50% - 12px), rgba(255,255,255,0.1) calc(50% - 4px), rgba(255,255,255,0.1) calc(50% + 4px), rgba(0,0,0,0.1) calc(50% + 12px)`:"rgba(0,0,0,0.1)"});return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:rects.map((r=>(0,jsx_runtime.jsx)("div",{style:{position:"absolute",top:r.y,left:r.x,width:r.w,height:r.h,zIndex:10,background:r.bg,backgroundBlendMode:"multiply",transition:"opacity 0.3s"}},r.id)))})}try{FocusRect.displayName="FocusRect",FocusRect.__docgenInfo={description:"",displayName:"FocusRect",props:{rect:{defaultValue:null,description:"",name:"rect",required:!0,type:{name:"ElementRect"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/elements/FocusRect.tsx#FocusRect"]={docgenInfo:FocusRect.__docgenInfo,name:"FocusRect",path:"frontend/src/toolbar/elements/FocusRect.tsx#FocusRect"})}catch(__react_docgen_typescript_loader_error){}function HeatmapElement(_ref){let{rect,style={},onClick,onMouseOver,onMouseOut}=_ref;return rect?(0,jsx_runtime.jsx)("div",{style:{position:"absolute",top:`${rect.top+window.pageYOffset}px`,left:`${rect.left+window.pageXOffset}px`,width:rect.right-rect.left+"px",height:rect.bottom-rect.top+"px",...style},onClick,onMouseOver,onMouseOut}):null}try{HeatmapElement.displayName="HeatmapElement",HeatmapElement.__docgenInfo={description:"",displayName:"HeatmapElement",props:{rect:{defaultValue:null,description:"",name:"rect",required:!1,type:{name:"ElementRect"}},style:{defaultValue:{value:"{}"},description:"",name:"style",required:!1,type:{name:"Record<string, any>"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"(event: MouseEvent<Element, MouseEvent>) => void"}},onMouseOver:{defaultValue:null,description:"",name:"onMouseOver",required:!0,type:{name:"(event: MouseEvent<Element, MouseEvent>) => void"}},onMouseOut:{defaultValue:null,description:"",name:"onMouseOut",required:!0,type:{name:"(event: MouseEvent<Element, MouseEvent>) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/elements/HeatmapElement.tsx#HeatmapElement"]={docgenInfo:HeatmapElement.__docgenInfo,name:"HeatmapElement",path:"frontend/src/toolbar/elements/HeatmapElement.tsx#HeatmapElement"})}catch(__react_docgen_typescript_loader_error){}const heatmapLabelStyle={lineHeight:"14px",padding:"1px 4px",color:"hsla(54, 20%, 12%, 1)",background:"#FFEB3B",boxShadow:"hsla(54, 100%, 32%, 1) 0px 1px 5px 1px",fontSize:16,fontWeight:"bold",fontFamily:"monospace"};function HeatmapLabel(_ref){let{rect,style={},align="right",children,...props}=_ref;if(!rect)return null;const width="string"==typeof children?10*children.length+4:14;return(0,jsx_runtime.jsx)("div",{style:{position:"absolute",top:`${inBounds(window.pageYOffset-1,rect.top-7+window.pageYOffset,window.pageYOffset+window.innerHeight-14)}px`,left:`${inBounds(window.pageXOffset,rect.left+("left"===align?10:rect.width)-width+window.pageXOffset,window.pageXOffset+window.innerWidth-14)}px`,...heatmapLabelStyle,...style},...props,children})}try{HeatmapLabel.displayName="HeatmapLabel",HeatmapLabel.__docgenInfo={description:"",displayName:"HeatmapLabel",props:{rect:{defaultValue:null,description:"",name:"rect",required:!1,type:{name:"ElementRect"}},align:{defaultValue:{value:"right"},description:"",name:"align",required:!1,type:{name:"enum",value:[{value:'"left"'},{value:'"right"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/elements/HeatmapLabel.tsx#HeatmapLabel"]={docgenInfo:HeatmapLabel.__docgenInfo,name:"HeatmapLabel",path:"frontend/src/toolbar/elements/HeatmapLabel.tsx#HeatmapLabel"})}catch(__react_docgen_typescript_loader_error){}function SelectorString(_ref){let{value}=_ref;const[last,...rest]=value.split(" ").reverse();return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[rest.reverse().join(" ")," ",(0,jsx_runtime.jsx)("strong",{children:last})]})}function ActionAttribute(_ref2){let{attribute,value}=_ref2;const icon="text"===attribute?(0,jsx_runtime.jsx)(icons.eec,{}):"href"===attribute?(0,jsx_runtime.jsx)(icons.JHz,{}):"selector"===attribute?(0,jsx_runtime.jsx)(icons.$Mr,{}):(0,jsx_runtime.jsx)(icons.yKb,{}),text="href"===attribute?(0,jsx_runtime.jsx)(src.Link,{to:value,target:"_blank",children:value}):"selector"===attribute?value?(0,jsx_runtime.jsx)("span",{className:"font-mono",children:(0,jsx_runtime.jsx)(SelectorString,{value})}):(0,jsx_runtime.jsxs)("span",{children:["Could not generate a unique selector for this element. Please instrument it with a unique"," ",(0,jsx_runtime.jsx)("code",{children:"id"})," or ",(0,jsx_runtime.jsx)("code",{children:"data-attr"})," attribute."]}):value;return(0,jsx_runtime.jsxs)("div",{className:"flex flex-row gap-2 justify-between items-center",children:[(0,jsx_runtime.jsx)("div",{className:"text-muted text-xl",children:icon}),(0,jsx_runtime.jsx)("div",{className:"grow",children:text})]},attribute)}try{ActionAttribute.displayName="ActionAttribute",ActionAttribute.__docgenInfo={description:"",displayName:"ActionAttribute",props:{attribute:{defaultValue:null,description:"",name:"attribute",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/elements/ActionAttribute.tsx#ActionAttribute"]={docgenInfo:ActionAttribute.__docgenInfo,name:"ActionAttribute",path:"frontend/src/toolbar/elements/ActionAttribute.tsx#ActionAttribute"})}catch(__react_docgen_typescript_loader_error){}function ActionStep(_ref){let{actionStep}=_ref;return(0,jsx_runtime.jsx)("div",{className:"flex flex-col gap-2",children:["text","name","href","selector"].map((attr=>actionStep[attr]||"selector"===attr?(0,jsx_runtime.jsx)(ActionAttribute,{attribute:attr,value:actionStep[attr]||void 0},attr):null))})}try{ActionStep.displayName="ActionStep",ActionStep.__docgenInfo={description:"",displayName:"ActionStep",props:{actionStep:{defaultValue:null,description:"",name:"actionStep",required:!0,type:{name:"ActionStepType"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/elements/ActionStep.tsx#ActionStep"]={docgenInfo:ActionStep.__docgenInfo,name:"ActionStep",path:"frontend/src/toolbar/elements/ActionStep.tsx#ActionStep"})}catch(__react_docgen_typescript_loader_error){}function ElementStatistic(_ref){let{prefix,suffix,title,value}=_ref;return(0,jsx_runtime.jsxs)("div",{className:"flex flex-col",children:[(0,jsx_runtime.jsx)("div",{children:title}),(0,jsx_runtime.jsxs)("div",{className:"text-2xl",children:[prefix,value," ",suffix]})]})}function ElementInfo(){const{clickCount:totalClickCount,dateRange}=(0,index_esm.useValues)(heatmapLogic),{activeMeta}=(0,index_esm.useValues)(elementsLogic),{createAction}=(0,index_esm.useActions)(elementsLogic);if(!activeMeta)return null;const{element,position,count,clickCount,rageclickCount,actionStep}=activeMeta;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"p-3",style:{borderLeft:"5px solid #8F98FF",background:"hsla(235, 100%, 99%, 1)"},children:[(0,jsx_runtime.jsx)("h1",{className:"section-title",children:"Selected Element"}),(0,jsx_runtime.jsx)(ActionStep,{actionStep})]}),position?(0,jsx_runtime.jsxs)("div",{className:"p-3",style:{borderLeft:"5px solid #FF9870",background:"hsla(19, 99%, 99%, 1)"},children:[(0,jsx_runtime.jsx)("h1",{className:"section-title",children:"Stats"}),(0,jsx_runtime.jsxs)("p",{children:[(0,jsx_runtime.jsx)(icons.jt6,{})," ",(0,jsx_runtime.jsx)("u",{children:dateRange})]}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,jsx_runtime.jsx)("div",{className:"w-2/3",children:(0,jsx_runtime.jsx)(ElementStatistic,{title:"Clicks",value:count||0,suffix:`/ ${totalClickCount} (${0===totalClickCount?"-":Math.round((count||0)/totalClickCount*1e4)/100}%)`})}),(0,jsx_runtime.jsx)("div",{className:"w-1/3",children:(0,jsx_runtime.jsx)(ElementStatistic,{title:"Ranking",prefix:"#",value:position||0})})]}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-row gap-4 mt-2",children:[(0,jsx_runtime.jsx)(ElementStatistic,{title:"Autocapture clicks",value:clickCount||0}),(0,jsx_runtime.jsx)(ElementStatistic,{title:"Rageclicks",value:rageclickCount||0})]})]}):null,(0,jsx_runtime.jsxs)("div",{className:"p-3",style:{borderLeft:"5px solid #94D674",background:"hsla(100, 74%, 98%, 1)"},children:[(0,jsx_runtime.jsxs)("h1",{className:"section-title",children:["Actions (",activeMeta.actions.length,")"]}),0===activeMeta.actions.length?(0,jsx_runtime.jsx)("p",{children:"No actions include this element"}):(0,jsx_runtime.jsx)(ActionsListView,{actions:activeMeta.actions.map((a=>a.action))}),(0,jsx_runtime.jsx)(src.LemonButton,{size:"small",type:"secondary",status:"primary-alt",onClick:()=>createAction(element),icon:(0,jsx_runtime.jsx)(icons.SC9,{}),children:"Create a new action"})]})]})}function InfoWindow(){const{hoverElement,hoverElementMeta,selectedElement,selectedElementMeta,relativePositionCompensation,activeMetaIsSelected}=(0,index_esm.useValues)(elementsLogic),{setSelectedElement}=(0,index_esm.useActions)(elementsLogic);(0,index_esm.useValues)(elementsLogic).rectUpdateCounter;const activeMeta=hoverElementMeta||selectedElementMeta;if(!activeMeta||!activeMeta.rect)return null;const pointerEvents=selectedElementMeta&&(!hoverElement||hoverElement===selectedElement),onClose=activeMetaIsSelected?()=>setSelectedElement(null):null,{rect}=activeMeta,windowWidth=Math.min(document.documentElement.clientWidth,window.innerWidth),windowHeight=Math.min(document.documentElement.clientHeight,window.innerHeight);let positioningHeight=windowHeight;"relative"===window.getComputedStyle(document.body).position&&(positioningHeight=document.documentElement.offsetHeight);let left=rect.left+window.pageXOffset+(rect.width>300?(rect.width-300)/2:0),width=300;left+width>windowWidth-10&&(left-=left+width-(windowWidth-10),left<0&&(left=5,width=windowWidth-10));let bottom,top=Math.max(window.pageYOffset+16,rect.top+rect.height+10+window.pageYOffset)+relativePositionCompensation;let maxHeight;const spaceAbove=Math.max(50,rect.top-20),spaceBelow=Math.max(50,windowHeight-top+window.pageYOffset-10);return spaceAbove>spaceBelow?(top=void 0,bottom=positioningHeight-rect.top+10-window.pageYOffset-relativePositionCompensation,maxHeight=spaceAbove):maxHeight=spaceBelow,(0,jsx_runtime.jsxs)("div",{style:{pointerEvents:pointerEvents?"all":"none",position:"absolute",top,bottom,left,width,minHeight:50,maxHeight,zIndex:1,opacity:1,transformOrigin:"top left",transition:"opacity 0.2s, box-shadow 0.2s",backgroundBlendMode:"multiply",background:"white",boxShadow:"hsla(4, 30%, 27%, 0.6) 0px 3px 10px 2px"},children:[onClose?(0,jsx_runtime.jsx)("div",{onClick:onClose,style:{pointerEvents:pointerEvents?"all":"none",position:"absolute",top:-8,right:left+width>windowWidth-20?-6:-12,transformOrigin:"top left",background:"black",color:"white",boxShadow:"hsla(4, 30%, 27%, 0.6) 0px 3px 10px 2px",borderRadius:"100%",width:24,height:24,zIndex:7,display:"flex",alignItems:"center",justifyContent:"space-around",textAlign:"center",cursor:"pointer"},children:(0,jsx_runtime.jsx)(icons.bMz,{})}):null,(0,jsx_runtime.jsx)("div",{style:{minHeight:50,maxHeight,overflow:"auto"},children:(0,jsx_runtime.jsx)(ElementInfo,{})})]})}function Elements_Elements(){const{heatmapElements,elementsToDisplay,labelsToDisplay,hoverElement,selectedElement,inspectEnabled,highlightElementMeta,relativePositionCompensation}=(0,index_esm.useValues)(elementsLogic),{setHoverElement,selectElement}=(0,index_esm.useActions)(elementsLogic),{highestClickCount,shiftPressed}=(0,index_esm.useValues)(heatmapLogic),heatmapPointerEvents=shiftPressed?"none":"all";return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{id:"posthog-infowindow-container",className:"w-full h-full absolute top-0 left-0 pointer-events-none",style:{zIndex:2147483021},children:(0,jsx_runtime.jsx)(InfoWindow,{})}),(0,jsx_runtime.jsxs)("div",{id:"posthog-toolbar-elements",className:"w-full h-full absolute top-0 pointer-events-none",style:{top:relativePositionCompensation,zIndex:2147483010},children:[highlightElementMeta?.rect?(0,jsx_runtime.jsx)(FocusRect,{rect:highlightElementMeta.rect}):null,elementsToDisplay.map(((_ref,index)=>{let{rect,element}=_ref;return(0,jsx_runtime.jsx)(HeatmapElement,{rect,style:{pointerEvents:heatmapPointerEvents,cursor:"pointer",zIndex:0,opacity:!hoverElement&&!selectedElement||selectedElement===element||hoverElement===element?1:.4,transition:"opacity 0.2s, box-shadow 0.2s",...getBoxColors("blue",hoverElement===element||selectedElement===element)},onClick:()=>selectElement(element),onMouseOver:()=>null===selectedElement&&setHoverElement(element),onMouseOut:()=>null===selectedElement&&setHoverElement(null)},`inspect-${index}`)})),heatmapElements.map(((_ref2,index)=>{let{rect,count,clickCount,rageclickCount,element}=_ref2;return(0,jsx_runtime.jsxs)(react.Fragment,{children:[(0,jsx_runtime.jsx)(HeatmapElement,{rect,style:{pointerEvents:inspectEnabled?"none":heatmapPointerEvents,zIndex:1,opacity:hoverElement&&hoverElement!==element?.4:1,transition:"opacity 0.2s, box-shadow 0.2s",cursor:"pointer",...getBoxColors("red",hoverElement===element,(count||0)/highestClickCount*.4)},onClick:()=>selectElement(element),onMouseOver:()=>null===selectedElement&&setHoverElement(element),onMouseOut:()=>null===selectedElement&&setHoverElement(null)}),!!clickCount&&(0,jsx_runtime.jsx)(HeatmapLabel,{rect,style:{pointerEvents:heatmapPointerEvents,zIndex:5,opacity:hoverElement&&hoverElement!==element?.4:1,transition:"opacity 0.2s, transform 0.2s linear",transform:hoverElement===element?"scale(1.3)":"none",cursor:"pointer",color:`hsla(${getHeatMapHue(clickCount||0,highestClickCount)}, 20%, 12%, 1)`,background:`hsla(${getHeatMapHue(clickCount||0,highestClickCount)}, 100%, 62%, 1)`,boxShadow:`hsla(${getHeatMapHue(clickCount||0,highestClickCount)}, 100%, 32%, 1) 0px 1px 5px 1px`},onClick:()=>selectElement(element),onMouseOver:()=>null===selectedElement&&setHoverElement(element),onMouseOut:()=>null===selectedElement&&setHoverElement(null),children:(0,utils.JP)(clickCount||0)}),!!rageclickCount&&(0,jsx_runtime.jsxs)(HeatmapLabel,{rect,style:{pointerEvents:heatmapPointerEvents,zIndex:5,opacity:hoverElement&&hoverElement!==element?.4:1,transition:"opacity 0.2s, transform 0.2s linear",transform:hoverElement===element?"scale(1.3)":"none",cursor:"pointer",color:`hsla(${getHeatMapHue(rageclickCount||0,highestClickCount)}, 20%, 12%, 1)`,background:`hsla(${getHeatMapHue(rageclickCount||0,highestClickCount)}, 100%, 62%, 1)`,boxShadow:`hsla(${getHeatMapHue(rageclickCount||0,highestClickCount)}, 100%, 32%, 1) 0px 1px 5px 1px`},align:"left",onClick:()=>selectElement(element),onMouseOver:()=>null===selectedElement&&setHoverElement(element),onMouseOut:()=>null===selectedElement&&setHoverElement(null),children:[(0,utils.JP)(rageclickCount),""]})]},`heatmap-${index}`)})),labelsToDisplay.map(((_ref3,loopIndex)=>{let{element,rect,index}=_ref3;if(rect)return(0,jsx_runtime.jsx)(HeatmapLabel,{rect,align:"left",style:{zIndex:5,opacity:hoverElement&&hoverElement!==element?.4:1,transition:"opacity 0.2s, transform 0.2s linear",transform:hoverElement===element?"scale(1.3)":"none",pointerEvents:heatmapPointerEvents,cursor:"pointer",color:"hsla(141, 21%, 12%, 1)",background:"hsl(147, 100%, 62%)",boxShadow:"hsla(141, 100%, 32%, 1) 0px 1px 5px 1px"},onClick:()=>selectElement(element),onMouseOver:()=>null===selectedElement&&setHoverElement(element),onMouseOut:()=>null===selectedElement&&setHoverElement(null),children:(index||loopIndex)+1},`label-${loopIndex}`)}))]})]})}var HedgehogBuddy=__webpack_require__("./frontend/src/lib/components/HedgehogBuddy/HedgehogBuddy.tsx");function HedgehogButton(){const{hedgehogMode,theme}=(0,index_esm.useValues)(toolbarLogic),{syncWithHedgehog,setHedgehogActor,toggleMinimized}=(0,index_esm.useActions)(toolbarLogic),{heatmapEnabled}=(0,index_esm.useValues)(heatmapLogic),actorRef=(0,react.useRef)();return(0,react.useEffect)((()=>{heatmapEnabled&&actorRef.current?.setAnimation("heatmaps")}),[heatmapEnabled]),(0,react.useEffect)((()=>{actorRef.current&&setHedgehogActor(actorRef.current)}),[actorRef.current,hedgehogMode]),(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:hedgehogMode&&(0,jsx_runtime.jsx)(HedgehogBuddy.C,{onClose:()=>{},actorRef,isDarkModeOn:"dark"===theme,onPositionChange:()=>{syncWithHedgehog()},onClick:()=>toggleMinimized()})})}function ToolbarContainer(){const{buttonVisible}=(0,index_esm.useValues)(toolbarConfigLogic),{theme}=(0,index_esm.useValues)(toolbarLogic),themeProps={theme};return(0,jsx_runtime.jsxs)(Fade.p,{visible:buttonVisible,className:"toolbar-global-fade-container ph-no-capture posthog-3000",children:[(0,jsx_runtime.jsx)(Elements_Elements,{}),(0,jsx_runtime.jsx)("div",{id:"button-toolbar",className:"ph-no-capture posthog-3000",...themeProps,children:(0,jsx_runtime.jsx)(Toolbar_Toolbar,{})}),(0,jsx_runtime.jsx)(HedgehogButton,{})]})}function ToolbarApp(){let props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{jsURL}=(0,index_esm.useValues)(toolbarConfigLogic(props)),shadowRef=(0,react.useRef)(null),[didLoadStyles,setDidLoadStyles]=(0,react.useState)(!1),didRender=function useSecondRender(callback){const[secondRender,setSecondRender]=(0,react.useState)(!1);return(0,react.useEffect)((()=>{requestAnimationFrame((()=>{setSecondRender(!0),callback()}))}),[]),secondRender}(props.disableExternalStyles?()=>{}:()=>{const styleLink=document.createElement("link");styleLink.rel="stylesheet",styleLink.type="text/css";const timestampToNearestFiveMinutes=3e5*Math.floor(Date.now()/3e5);styleLink.href=`${jsURL}/static/toolbar.css?t=${timestampToNearestFiveMinutes}`,styleLink.onload=()=>setDidLoadStyles(!0);const shadowRoot=shadowRef.current?.shadowRoot||window.document.getElementById("__POSTHOG_TOOLBAR__")?.shadowRoot;shadowRoot?.getElementById("posthog-toolbar-styles")?.appendChild(styleLink)});return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)(react_shadow_esm.ZP.div,{id:"__POSTHOG_TOOLBAR__",className:"ph-no-capture",ref:shadowRef,children:[(0,jsx_runtime.jsx)("div",{id:"posthog-toolbar-styles"}),didRender&&(didLoadStyles||props.disableExternalStyles)?(0,jsx_runtime.jsx)(ToolbarContainer,{}):null,(0,jsx_runtime.jsx)(react_toastify_esm.Ix,{autoClose:6e4,transition:react_toastify_esm.Mi,closeOnClick:!1,draggable:!1,position:"bottom-center"})]})})}try{ToolbarApp.displayName="ToolbarApp",ToolbarApp.__docgenInfo={description:"",displayName:"ToolbarApp",props:{posthog:{defaultValue:null,description:"",name:"posthog",required:!1,type:{name:"PostHog"}},disableExternalStyles:{defaultValue:null,description:"",name:"disableExternalStyles",required:!1,type:{name:"boolean"}},apiURL:{defaultValue:null,description:"",name:"apiURL",required:!1,type:{name:"string"}},jsURL:{defaultValue:null,description:"",name:"jsURL",required:!1,type:{name:"string"}},token:{defaultValue:null,description:"",name:"token",required:!1,type:{name:"string"}},temporaryToken:{defaultValue:null,description:"",name:"temporaryToken",required:!1,type:{name:"string"}},actionId:{defaultValue:null,description:"",name:"actionId",required:!1,type:{name:"number"}},userIntent:{defaultValue:null,description:"",name:"userIntent",required:!1,type:{name:"enum",value:[{value:'"add-action"'},{value:'"edit-action"'}]}},source:{defaultValue:null,description:"",name:"source",required:!1,type:{name:"enum",value:[{value:'"url"'},{value:'"localstorage"'}]}},toolbarVersion:{defaultValue:null,description:"",name:"toolbarVersion",required:!1,type:{name:"enum",value:[{value:'"toolbar"'}]}},instrument:{defaultValue:null,description:"",name:"instrument",required:!1,type:{name:"boolean"}},distinctId:{defaultValue:null,description:"",name:"distinctId",required:!1,type:{name:"string"}},userEmail:{defaultValue:null,description:"",name:"userEmail",required:!1,type:{name:"string"}},dataAttributes:{defaultValue:null,description:"",name:"dataAttributes",required:!1,type:{name:"string[]"}},featureFlags:{defaultValue:null,description:"",name:"featureFlags",required:!1,type:{name:"Record<string, string | boolean>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/toolbar/ToolbarApp.tsx#ToolbarApp"]={docgenInfo:ToolbarApp.__docgenInfo,name:"ToolbarApp",path:"frontend/src/toolbar/ToolbarApp.tsx#ToolbarApp"})}catch(__react_docgen_typescript_loader_error){}const listActionsAPIResponse={results:[{id:49103,name:"Clicked notification row",description:"",post_to_slack:!1,slack_message_format:"",steps:[{id:"60889",event:"$autocapture",tag_name:null,text:null,text_matching:null,href:null,href_matching:null,selector:".notifications-menu .activity-log-row",url:null,name:null,url_matching:"contains",properties:[]}],created_at:"2023-08-22T06:31:40.495488Z",created_by:{id:5042,uuid:"017bcbcf-2391-0000-1868-14fb987285c5",distinct_id:"PqMBBFBfKo638PwvjCWTSZ6dnswYzJ3RtH8VIHCBWAy",first_name:"Paul",email:"paul@posthog.com",is_email_verified:!0},deleted:!1,is_calculating:!1,last_calculated_at:"2023-08-22T06:31:40.495197Z",team_id:2,is_action:!0,bytecode_error:null,tags:[]},{id:49059,name:"clicked nav bar2",description:"",post_to_slack:!1,slack_message_format:"",steps:[{id:"60829",event:"$autocapture",tag_name:null,text:"Products",text_matching:null,href:"/product-analytics",href_matching:null,selector:null,url:null,name:"",url_matching:"exact",properties:[]},{id:"60830",event:"$autocapture",tag_name:null,text:null,text_matching:null,href:null,href_matching:null,selector:".border-b .h-full:nth-child(2) > .text-\\[13\\.5px\\]",url:null,name:"",url_matching:"exact",properties:[]}],created_at:"2023-08-21T20:54:17.218311Z",created_by:{id:6352,uuid:"017d5334-911a-0000-6954-2d394263f3ca",distinct_id:"48vHN2rW28SvzA6D4NdgHajLOjBP1ulsI0Rr5DNas4i",first_name:"Cameron",email:"cameron@posthog.com",is_email_verified:!0},deleted:!1,is_calculating:!1,last_calculated_at:"2023-08-21T20:54:17.218023Z",team_id:2,is_action:!0,bytecode_error:null,tags:[]},{id:49050,name:"Clicked Products in nav bar",description:"",post_to_slack:!1,slack_message_format:"",steps:[{id:"60819",event:"$autocapture",tag_name:null,text:"Products",text_matching:null,href:"/product-analytics",href_matching:null,selector:null,url:null,name:"",url_matching:"exact",properties:[]},{id:"60820",event:"$autocapture",tag_name:null,text:"Pricing",text_matching:null,href:"/pricing",href_matching:null,selector:null,url:null,name:null,url_matching:"contains",properties:[]}],created_at:"2023-08-21T18:46:13.210958Z",created_by:{id:6352,uuid:"017d5334-911a-0000-6954-2d394263f3ca",distinct_id:"48vHN2rW28SvzA6D4NdgHajLOjBP1ulsI0Rr5DNas4i",first_name:"Cameron",email:"cameron@posthog.com",is_email_verified:!0},deleted:!1,is_calculating:!1,last_calculated_at:"2023-08-21T18:46:13.210590Z",team_id:2,is_action:!0,bytecode_error:null,tags:[]}]},listHeatmapStatsAPIResponse={results:[{count:780,hash:null,type:"$autocapture",elements:[{tag_name:"button",$el_text:"Click Me",nth_child:2,nth_of_type:1},{tag_name:"div",nth_child:1,nth_of_type:1},{tag_name:"div",attr__id:"storybook-root",nth_child:5,nth_of_type:5},{tag_name:"body",classes:["sb-main-fullscreen","sb-show-main"],attributes:{attr__class:"sb-main-fullscreen sb-show-main",attr__theme:"light"},nth_child:2,nth_of_type:1}]}],next:null,previous:null},listMyFlagsAPIResponse=[{feature_flag:{id:15927,name:"Example flag",key:"example-one",deleted:!1,active:!0,created_at:"2023-08-17T19:37:05.259538Z",filters:{}},value:!1},{feature_flag:{id:15927,name:"Another example flag",key:"example-two",deleted:!1,active:!0,created_at:"2023-08-17T19:37:05.259538Z",filters:{}},value:!0},{feature_flag:{id:13859,name:"Example multivariate flag",key:"my-multi-example",filters:{multivariate:{variants:[{key:"control",rollout_percentage:50},{key:"test",rollout_percentage:50}]}},deleted:!1,active:!0},value:"control"},{feature_flag:{id:13859,name:"Example overridden multivariate flag",key:"my-other-multi-example",filters:{multivariate:{variants:[{key:"control",rollout_percentage:50},{key:"test",rollout_percentage:50}]}},deleted:!1,active:!0},value:"control"}];const Toolbar_stories={title:"Scenes-Other/Toolbar",tags:["test-skip-webkit"],parameters:{layout:"fullscreen",viewMode:"story"}},BasicTemplate=props=>{var _props$unauthenticate;const toolbarParams={temporaryToken:props.unauthenticated?void 0:"UExb1dCsoqBtrhrZYxzmxXQ7XdjVH5Ea_zbQjTFuJqk",actionId:void 0,userIntent:void 0,dataAttributes:["data-attr"],apiURL:"/",jsURL:"http://localhost:8234/",userEmail:"foobar@posthog.com"};!function useToolbarStyles(){(0,react.useEffect)((()=>{const head=document.getElementsByTagName("head")[0],shadowRoot=window.document.getElementById("__POSTHOG_TOOLBAR__")?.shadowRoot;Array.from(head.getElementsByTagName("style")).forEach((tag=>{const style=document.createElement("style"),text=tag.innerText;style.appendChild(document.createTextNode(text)),shadowRoot?.appendChild(style)}))}),[])}(),(0,browser.ok)({get:{"/decide":{config:{enable_collect_everything:!0},toolbarParams:{toolbarVersion:"toolbar",jsURL:"http://localhost:8234/"},isAuthenticated:null===(_props$unauthenticate=props.unauthenticated)||void 0===_props$unauthenticate||_props$unauthenticate,supportedCompression:["gzip","gzip-js","lz64"],featureFlags:{},sessionRecording:{endpoint:"/s/"}},"/api/element/stats/":listHeatmapStatsAPIResponse,"/api/projects/@current/feature_flags/my_flags":listMyFlagsAPIResponse,"/api/projects/@current/actions/":listActionsAPIResponse}}),(0,index_esm.useMountedLogic)(toolbarConfigLogic(toolbarParams));const theToolbarLogic=toolbarLogic(),{setVisibleMenu,setDragPosition,toggleMinimized,toggleTheme}=(0,index_esm.useActions)(theToolbarLogic);return(0,react.useEffect)((()=>{var _props$minimized;setDragPosition(50,50),setVisibleMenu(props.menu||"none"),toggleMinimized(null!==(_props$minimized=props.minimized)&&void 0!==_props$minimized&&_props$minimized),toggleTheme(props.theme||"light")}),[Object.values(props)]),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{children:"The toolbar should show up now! Click it to open."}),(0,jsx_runtime.jsx)("button",{children:"Click Me"}),(0,jsx_runtime.jsx)(ToolbarApp,{...toolbarParams,disableExternalStyles:!0})]})},Default=()=>(0,jsx_runtime.jsx)(BasicTemplate,{}),Unauthenticated=()=>(0,jsx_runtime.jsx)(BasicTemplate,{unauthenticated:!0}),Minimized=()=>(0,jsx_runtime.jsx)(BasicTemplate,{minimized:!0}),Heatmap=()=>(0,jsx_runtime.jsx)(BasicTemplate,{menu:"heatmap"}),Inspect=()=>(0,jsx_runtime.jsx)(BasicTemplate,{menu:"inspect"}),Actions=()=>(0,jsx_runtime.jsx)(BasicTemplate,{menu:"actions"}),FeatureFlags=()=>(0,jsx_runtime.jsx)(BasicTemplate,{menu:"flags"}),DefaultDark=()=>(0,jsx_runtime.jsx)(BasicTemplate,{theme:"dark"}),MinimizedDark=()=>(0,jsx_runtime.jsx)(BasicTemplate,{theme:"dark",minimized:!0}),HeatmapDark=()=>(0,jsx_runtime.jsx)(BasicTemplate,{theme:"dark",menu:"heatmap"}),InspectDark=()=>(0,jsx_runtime.jsx)(BasicTemplate,{theme:"dark",menu:"inspect"}),ActionsDark=()=>(0,jsx_runtime.jsx)(BasicTemplate,{theme:"dark",menu:"actions"}),FeatureFlagsDark=()=>(0,jsx_runtime.jsx)(BasicTemplate,{theme:"dark",menu:"flags"});Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"(): JSX.Element => {\n  return <BasicTemplate />;\n}",...Default.parameters?.docs?.source}}},Unauthenticated.parameters={...Unauthenticated.parameters,docs:{...Unauthenticated.parameters?.docs,source:{originalSource:"(): JSX.Element => {\n  return <BasicTemplate unauthenticated />;\n}",...Unauthenticated.parameters?.docs?.source}}},Minimized.parameters={...Minimized.parameters,docs:{...Minimized.parameters?.docs,source:{originalSource:"(): JSX.Element => {\n  return <BasicTemplate minimized />;\n}",...Minimized.parameters?.docs?.source}}},Heatmap.parameters={...Heatmap.parameters,docs:{...Heatmap.parameters?.docs,source:{originalSource:'(): JSX.Element => {\n  return <BasicTemplate menu="heatmap" />;\n}',...Heatmap.parameters?.docs?.source}}},Inspect.parameters={...Inspect.parameters,docs:{...Inspect.parameters?.docs,source:{originalSource:'(): JSX.Element => {\n  return <BasicTemplate menu="inspect" />;\n}',...Inspect.parameters?.docs?.source}}},Actions.parameters={...Actions.parameters,docs:{...Actions.parameters?.docs,source:{originalSource:'(): JSX.Element => {\n  return <BasicTemplate menu="actions" />;\n}',...Actions.parameters?.docs?.source}}},FeatureFlags.parameters={...FeatureFlags.parameters,docs:{...FeatureFlags.parameters?.docs,source:{originalSource:'(): JSX.Element => {\n  return <BasicTemplate menu="flags" />;\n}',...FeatureFlags.parameters?.docs?.source}}},DefaultDark.parameters={...DefaultDark.parameters,docs:{...DefaultDark.parameters?.docs,source:{originalSource:'(): JSX.Element => {\n  return <BasicTemplate theme="dark" />;\n}',...DefaultDark.parameters?.docs?.source}}},MinimizedDark.parameters={...MinimizedDark.parameters,docs:{...MinimizedDark.parameters?.docs,source:{originalSource:'(): JSX.Element => {\n  return <BasicTemplate theme="dark" minimized />;\n}',...MinimizedDark.parameters?.docs?.source}}},HeatmapDark.parameters={...HeatmapDark.parameters,docs:{...HeatmapDark.parameters?.docs,source:{originalSource:'(): JSX.Element => {\n  return <BasicTemplate theme="dark" menu="heatmap" />;\n}',...HeatmapDark.parameters?.docs?.source}}},InspectDark.parameters={...InspectDark.parameters,docs:{...InspectDark.parameters?.docs,source:{originalSource:'(): JSX.Element => {\n  return <BasicTemplate theme="dark" menu="inspect" />;\n}',...InspectDark.parameters?.docs?.source}}},ActionsDark.parameters={...ActionsDark.parameters,docs:{...ActionsDark.parameters?.docs,source:{originalSource:'(): JSX.Element => {\n  return <BasicTemplate theme="dark" menu="actions" />;\n}',...ActionsDark.parameters?.docs?.source}}},FeatureFlagsDark.parameters={...FeatureFlagsDark.parameters,docs:{...FeatureFlagsDark.parameters?.docs,source:{originalSource:'(): JSX.Element => {\n  return <BasicTemplate theme="dark" menu="flags" />;\n}',...FeatureFlagsDark.parameters?.docs?.source}}}},"./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.31_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/toolbar/bar/Toolbar.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,"#button-toolbar{position:fixed;top:0;left:0;z-index:2147483020;-webkit-user-select:none;-moz-user-select:none;user-select:none;opacity:1;transition:opacity .5s ease;--text-3000:var(--text-3000-light);--text-secondary-3000:var(--text-secondary-3000-light);--muted-3000:var(--muted-3000-light);--trace-3000:var(--trace-3000-light);--primary-3000:var(--primary-3000-light);--primary-3000-highlight:var(--primary-3000-highlight-light);--primary-3000-hover:var(--primary-3000-hover-light);--primary-3000-active:var(--primary-3000-active-light);--secondary-3000:var(--secondary-3000-light);--secondary-3000-hover:var(--secondary-3000-hover-light);--accent-3000:var(--accent-3000-light);--bg-3000:var(--bg-3000-light);--border-3000:var(--border-3000-light);--border-bold-3000:var(--border-bold-3000-light);--glass-bg-3000:var(--glass-bg-3000-light);--glass-border-3000:var(--glass-border-3000-light);--bg-light:#fff;--bg-table:#f9faf7;--link:var(--link-3000-light);--shadow-elevation-3000:var(--shadow-elevation-3000-light);--primary-3000-frame-bg:var(--primary-3000-frame-bg-light);--primary-3000-frame-border:var(--primary-3000-frame-border-light);--primary-3000-button-bg:var(--primary-3000-button-bg-light);--primary-3000-button-border:var(--primary-3000-button-border-light);--primary-3000-button-border-hover:var(--primary-3000-button-border-hover-light);--primary-alt-highlight-3000:var(--primary-alt-highlight-3000-light);--secondary-3000-frame-bg:var(--secondary-3000-frame-bg-light);--secondary-3000-frame-border:var(--secondary-3000-frame-border-light);--secondary-3000-button-bg:var(--secondary-3000-button-bg-light);--secondary-3000-button-border:var(--secondary-3000-button-border-light);--secondary-3000-button-border-hover:var(--secondary-3000-button-border-hover-light);--default:var(--text-3000);--text-secondary:var(--text-secondary-3000);--muted:var(--muted-3000);--muted-alt:var(--muted-3000);--primary-alt:var(--text-3000);--border:var(--border-3000);--border-bold:var(--border-bold-3000);--mid:var(--bg-3000);--side:var(--bg-3000);--primary-alt-highlight:var(--primary-alt-highlight-3000);--data-color-1:#1d4aff;--data-color-10:#35416b}#button-toolbar *>::-webkit-scrollbar{width:.5rem;height:.5rem}#button-toolbar *>::-webkit-scrollbar-track{background:var(--accent-3000)}#button-toolbar *>::-webkit-scrollbar-thumb{background:var(--trace-3000);border-radius:.25rem}#button-toolbar *>::-webkit-scrollbar-thumb:hover{background:var(--muted-3000)}#button-toolbar+.HedgehogBuddy{z-index:2147483020}#button-toolbar[theme=dark]{--mark:var(--secondary-3000-hover-dark);--text-3000:var(--text-3000-dark);--text-secondary-3000:var(--text-secondary-3000-dark);--muted-3000:var(--muted-3000-dark);--trace-3000:var(--trace-3000-dark);--primary-3000:var(--primary-3000-dark);--primary-3000-highlight:var(--primary-3000-highlight-dark);--primary-3000-hover:var(--primary-3000-hover-dark);--primary-3000-active:var(--primary-3000-active-dark);--secondary-3000:var(--secondary-3000-dark);--secondary-3000-hover:var(--secondary-3000-hover-dark);--accent-3000:var(--accent-3000-dark);--bg-3000:var(--bg-3000-dark);--border-3000:var(--border-3000-dark);--border-bold-3000:var(--border-bold-3000-dark);--glass-bg-3000:var(--glass-bg-3000-dark);--glass-border-3000:var(--glass-border-3000-dark);--bg-light:var(--accent-3000);--bg-table:#232429;--brand-key:#fff;--link:var(--link-3000-dark);--shadow-elevation-3000:var(--shadow-elevation-3000-dark);--primary-3000-frame-bg:var(--primary-3000-frame-bg-dark);--primary-3000-frame-border:var(--primary-3000-frame-border-dark);--primary-3000-button-bg:var(--primary-3000-button-bg-dark);--primary-3000-button-border:var(--primary-3000-button-border-dark);--primary-3000-button-border-hover:var(--primary-3000-button-border-hover-dark);--primary-alt-highlight-3000:var(--primary-alt-highlight-3000-dark);--secondary-3000-frame-bg:var(--secondary-3000-frame-bg-dark);--secondary-3000-frame-border:var(--secondary-3000-frame-border-dark);--secondary-3000-button-bg:var(--secondary-3000-button-bg-dark);--secondary-3000-button-border:var(--secondary-3000-button-border-dark);--secondary-3000-button-border-hover:var(--secondary-3000-button-border-hover-dark);--data-color-2:#7f26d9;--data-color-3:#3e7a76;--data-color-4:#bf0d6c;--data-color-5:#f0474f;--data-color-6:#b36114;--data-color-10:#6576b3}.ToolbarMenu{position:fixed;z-index:2;max-width:calc(100% - 2rem);height:0}.ToolbarMenu .ToolbarMenu__content{position:absolute;bottom:0;display:flex;flex-direction:column;width:30rem;max-height:0;margin-left:-15rem;overflow:hidden;overflow-y:auto;color:var(--text-3000);background-color:var(--bg-3000);filter:drop-shadow(0 5px 10px var(--trace-3000));border-radius:var(--radius)}.ToolbarMenu--visible .ToolbarMenu__content{border:1px solid var(--border-bold-3000)}.ToolbarMenu.ToolbarMenu--below .ToolbarMenu__content{top:0;bottom:auto}.ToolbarMenu form .form-error{color:var(--danger)}.Toolbar{--toolbar-button-x:0;--toolbar-button-y:0;--toolbar-translate:translate(var(--toolbar-button-x),var(--toolbar-button-y));position:fixed;z-index:1;display:flex;flex-direction:row;justify-content:space-between;width:15.2rem;overflow:hidden;color:var(--text-3000);background-color:var(--bg-3000);filter:drop-shadow(0 5px 10px var(--trace-3000));border:1px solid var(--border-bold-3000);border-radius:var(--radius);transition-timing-function:ease;transition-duration:.15s;transition-property:filter,width,transform;transform:var(--toolbar-translate)}.Toolbar>:first-child{border-right:1px solid var(--border-bold-3000)}.Toolbar>:last-child{border-left:1px solid var(--border-bold-3000)}.Toolbar--dragging{transition-property:filter,width;transform:var(--toolbar-translate) scale(1.1)}.Toolbar--minimized{width:calc(2.5rem + 1px)}.Toolbar--minimized.Toolbar--hedgehog-mode{transform:var(--toolbar-translate) scale(0)}.Toolbar--unauthenticated{width:calc(5rem + 1px)}",""]),module.exports=exports},"./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.31_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/toolbar/bar/ToolbarButton.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,".ToolbarButton{flex-shrink:0;width:2.5rem;height:2.5rem}.ToolbarButton,.ToolbarButton button{display:flex;align-items:center;justify-content:center}.ToolbarButton button{position:relative;flex-direction:column;width:2rem;height:2rem;min-height:var(--lemon-button-height);color:var(--muted-alt);-webkit-appearance:none!important;-moz-appearance:none!important;appearance:none!important;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none;background:none;border:none;border-radius:var(--radius);transition:transform .1s ease}.ToolbarButton button>svg{font-size:1.5rem}.ToolbarButton--active button,.ToolbarButton:not([aria-disabled=true]):hover button{color:var(--default);background:var(--border)}.Toolbar--dragging .ToolbarButton--active button,.Toolbar--dragging .ToolbarButton:not([aria-disabled=true]):hover button{color:var(--muted-alt);background:none}",""]),module.exports=exports},"./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.31_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/toolbar/elements/Elements.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,"#posthog-infowindow-container,#posthog-toolbar-elements{color:#333;pointer-events:none}",""]),module.exports=exports},"./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_postcss@8.4.31_webpack@5.88.2/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0_webpack@5.88.2/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./frontend/src/toolbar/styles.scss":(module,exports,__webpack_require__)=>{(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@5.88.2/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,'*,:after,:before{box-sizing:border-box}:host{all:initial;font-family:var(--font-sans);font-size:14px;line-height:1.5;--primary-bg-hover:var(--primary-highlight);--primary-bg-active:rgba(29,74,255,0.2);--bg-charcoal:#2d2d2d;--bg-bridge:#ebece8;--radius:4px;--shadow-elevation:0px 16px 16px -16px rgba(0,0,0,0.35000000000000003);--opacity-disabled:0.6;--font-medium:500;--font-semibold:600;--font-sans:-apple-system,BlinkMacSystemFont,"Inter","Segoe UI","Roboto","Helvetica Neue",helvetica,arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--font-title:"MatterSQ",-apple-system,BlinkMacSystemFont,"Inter","Segoe UI","Roboto","Helvetica Neue",helvetica,arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--font-mono:ui-monospace,"SFMono-Regular","SF Mono","Menlo","Consolas","Liberation Mono",monospace;--blue:#597dce;--purple:#c278cf;--green:var(--success);--black:var(--default);--purple-light:#dcb1e3;--data-color-1:#1d4aff;--data-color-2:#621da6;--data-color-3:#42827e;--data-color-4:#ce0e74;--data-color-5:#f14f58;--data-color-6:#7c440e;--data-color-7:#529a0a;--data-color-8:#0476fb;--data-color-9:#fe729e;--data-color-10:#35416b;--data-color-11:#41cbc4;--data-color-12:#b64b02;--data-color-13:#e4a604;--data-color-14:#a56eff;--data-color-15:#30d5c8;--lifecycle-new:#1d4aff;--lifecycle-returning:#388600;--lifecycle-resurrecting:#a56eff;--lifecycle-dormant:#db3707;--lifecycle-new-hover:#0024b6;--lifecycle-returning-hover:#0d2000;--lifecycle-resurrecting-hover:#6608ff;--lifecycle-dormant-hover:#781e04;--funnel-background:var(--border-light);--funnel-axis:var(--border);--funnel-grid:#ddd;--antd-table-background-dark:#fafafa;--recording-spacing:0.66667rem;--recording-player-container-bg:#797973;--recording-buffer-bg:#faaf8c;--recording-seekbar-red:var(--brand-red);--recording-hover-event:var(--primary-bg-hover);--recording-hover-event-mid:var(--primary-bg-active);--recording-hover-event-dark:var(--primary-3000);--recording-current-event:#eef2ff;--recording-current-event-dark:var(--primary-alt);--recording-failure-event:#fee9e2;--recording-failure-event-dark:#cd3000;--recording-highlight-event:var(--mark);--recording-highlight-event-dark:#946508;--z-bottom-notice:5100;--z-command-palette:1875;--z-force-modal-above-popovers:1850;--z-ant-message:1070;--z-ant-select-dropdown:1065;--z-definition-popover:1064;--z-popover:1063;--z-graph-tooltip:1062;--z-annotation-popover:1061;--z-modal:1060;--z-ant-modal-wrap:1060;--z-hedgehog-buddy:1059;--z-ant-modal-mask:1050;--z-drawer:950;--z-notifications-popover:949;--z-main-nav:948;--z-lemon-sidebar:940;--z-lemon-activation-sidebar:939;--z-mobile-nav-overlay:931;--z-top-navigation:800;--z-content-overlay:488;--z-raised:5;--toastify-color-dark:var(--accent-3000-dark);--toastify-color-light:var(--bg-light);--toastify-color-info:var(--primary-3000);--toastify-color-success:var(--success);--toastify-color-warning:var(--warning);--toastify-color-error:var(--danger);--toastify-toast-background:var(--bg-light);--toastify-toast-width:26rem;--toastify-toast-min-height:3.5rem;--toastify-toast-max-height:16rem;--toastify-text-color-light:#757575;--toastify-color-progress-success:var(--toastify-color-success);--toastify-color-progress-warning:var(--toastify-color-warning);--toastify-color-progress-error:var(--toastify-color-error);--in-app-prompts-width:26rem;--lettermark-1-bg:#dcb1e3;--lettermark-1-text:#572e5e;--lettermark-2-bg:#ffc4b2;--lettermark-2-text:#3e5891;--lettermark-3-bg:#fdedc9;--lettermark-3-text:#3e5891;--lettermark-4-bg:#3e5891;--lettermark-4-text:#ffc4b2;--lettermark-5-bg:#8da9e7;--lettermark-5-text:#572e5e;--lettermark-6-bg:#572e5e;--lettermark-6-text:#dcb1e3;--lettermark-7-bg:#ffc035;--lettermark-7-text:#35416b;--lettermark-8-bg:#ff906e;--lettermark-8-text:#2a3d65;--modal-backdrop-blur:5px;--modal-backdrop-color:rgba(0,0,0,0.2);--modal-transition-time:200ms;--notebook-popover-transition-properties:150ms cubic-bezier(0,0.5,0.5,1);--notebook-column-left-width:27rem;--notebook-column-right-width:20rem;--primary-highlight:rgba(29,74,255,0.1);--primary-light:#345cff;--primary:#1d4aff;--primary-dark:#1330a6;--danger-highlight:rgba(219,55,7,0.1);--danger-lighter:#ffa599;--danger-light:#df4b20;--danger:#db3707;--danger-dark:#992705;--warning-highlight:rgba(247,165,1,0.1);--warning-light:#f8b633;--warning:#f7a501;--warning-dark:#a06b01;--success-highlight:rgba(56,134,0,0.1);--success-light:#5f9d32;--success:#388600;--success-dark:#245700;--primary-alt-highlight:rgba(53,65,107,0.1);--primary-alt:#35416b;--primary-alt-dark:#222a46;--default:#2d2d2d;--default-dark:#050505;--muted:#5f5f5f;--muted-dark:#403939;--muted-alt:#747ea1;--muted-alt-dark:#515871;--mark:hsla(42,93%,86%,0.8);--white:#fff;--bg-light:#fff;--side:#fafaf9;--mid:#f2f2f2;--border:rgba(0,0,0,0.15);--border-light:rgba(0,0,0,0.08);--border-bold:rgba(0,0,0,0.24);--border-active:rgba(0,0,0,0.36);--transparent:transparent;--link:var(--primary-3000);--brand-blue:#1d4aff;--brand-red:#f54e00;--brand-yellow:#f9bd2b;--brand-key:#000;--text-3000-light:#111;--text-secondary-3000-light:rgba(17,17,17,0.7);--muted-3000-light:rgba(17,17,17,0.5);--trace-3000-light:rgba(17,17,17,0.25);--primary-3000-light:#f54e01;--primary-3000-highlight-light:rgba(245,78,1,0.1);--primary-3000-hover-light:#f54e01;--primary-3000-active-light:#f54e01;--secondary-3000-light:hsla(68,14%,79%,0.6);--secondary-3000-hover-light:#cfd1c2;--accent-3000-light:#eeefe9;--bg-3000-light:#f3f4ef;--bg-hover-3000-light:#f3f4ef;--border-3000-light:#dadbd2;--border-bold-3000-light:#c1c2b9;--glass-bg-3000-light:rgba(228,229,222,0.7019607843);--glass-border-3000-light:#e4e5de;--link-3000-light:#f54e00;--primary-3000-frame-bg-light:#eb9d2a;--primary-3000-frame-border-light:#c28926;--primary-3000-button-bg-light:#fff;--primary-3000-button-border-light:#b17816;--primary-3000-button-border-hover-light:#8e5b03;--secondary-3000-frame-bg-light:#e1dddd;--secondary-3000-frame-border-light:#d7d7d7;--secondary-3000-button-bg-light:#f3f4ef;--secondary-3000-button-border-light:#ccc;--secondary-3000-button-border-hover-light:#aaa;--shadow-elevation-3000-light:0 2px 0 var(--border-3000-light);--shadow-elevation-3000-dark:0 2px 0 var(--border-3000-dark);--text-3000-dark:#fff;--text-secondary-3000-dark:hsla(0,0%,100%,0.7);--muted-3000-dark:hsla(0,0%,100%,0.5);--trace-3000-dark:hsla(0,0%,100%,0.25);--primary-3000-dark:#f7a503;--primary-3000-highlight-dark:rgba(247,165,3,0.1);--primary-3000-hover-dark:#f7a503;--primary-3000-active-dark:#f7a503;--primary-alt-highlight-3000-light:#e5e7e0;--secondary-3000-dark:#1d1f27;--secondary-3000-hover-dark:#575d77;--accent-3000-dark:#21242b;--bg-3000-dark:#1d1f27;--bg-hover-3000-dark:#292b36;--border-3000-dark:#35373e;--border-bold-3000-dark:#3f4046;--glass-bg-3000-dark:rgba(33,36,43,0.7019607843);--glass-border-3000-dark:var(--border-3000-dark);--link-3000-dark:#f1a82c;--primary-3000-frame-bg-dark:#926826;--primary-3000-frame-border-dark:#a97a2f;--primary-3000-button-bg-dark:#e0a045;--primary-3000-button-border-dark:#b17816;--primary-3000-button-border-hover-dark:#8e5b03;--primary-alt-highlight-3000-dark:#232429;--secondary-3000-frame-bg-dark:#323232;--secondary-3000-frame-border-dark:#383838;--secondary-3000-button-bg-dark:#1d1f27;--secondary-3000-button-border-dark:#4a4c52;--secondary-3000-button-border-hover-dark:#5e6064;--text-3000:var(--text-3000);--text-secondary-3000:var(--text-secondary-3000);--muted-3000:var(--muted-3000);--trace-3000:var(--trace-3000);--primary-3000:var(--primary-3000);--primary-3000-hover:var(--primary-3000-hover);--secondary-3000:var(--secondary-3000);--secondary-3000-hover:var(--secondary-3000-hover);--accent-3000:var(--accent-3000);--bg-3000:var(--bg-3000);--bg-hover-3000:var(--bg-hover-3000);--border-3000:var(--border-3000);--border-bold-3000:var(--border-bold-3000);--glass-bg-3000:var(--glass-bg-3000);--glass-border-3000:var(--border-3000);--link-3000:var(--link-3000);--primary-3000-frame-bg:var(--primary-3000-frame-bg);--primary-3000-frame-border:var(--primary-3000-frame-border);--primary-3000-button-bg:var(--primary-3000-button-bg);--primary-3000-button-border:var(--primary-3000-button-border);--primary-3000-button-border-hover:var(--primary-3000-button-border-hover);--secondary-3000-frame-bg:var(--secondary-3000-frame-bg);--secondary-3000-frame-border:var(--secondary-3000-frame-border);--secondary-3000-button-bg:var(--secondary-3000-button-bg);--secondary-3000-button-border:var(--secondary-3000-button-border);--secondary-3000-button-border-hover:var(--secondary-3000-button-border-hover)}.LemonModal__overlay--force-modal-above-popovers{z-index:2147483033!important}.section-title{margin-bottom:10px;font-size:12px;font-weight:700;color:#6a7790;text-transform:uppercase}.fade-component-container{position:fixed;z-index:2147483020}.Toastify__toast-container{z-index:2147483040}.toolbar-global-fade-container{position:absolute;inset:0;pointer-events:none}.toolbar-global-fade-container>*{pointer-events:auto}.Popover{z-index:2147483020!important}',""]),module.exports=exports}}]);