"use strict";(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[87608],{"./frontend/src/scenes/error-tracking/ErrorTrackingScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ErrorTrackingScene:()=>ErrorTrackingScene,scene:()=>scene});var src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),DateFilter=__webpack_require__("./frontend/src/lib/components/DateFilter/DateFilter.tsx"),types=__webpack_require__("./frontend/src/lib/components/TaxonomicFilter/types.ts"),UniversalFilters=__webpack_require__("./frontend/src/lib/components/UniversalFilters/UniversalFilters.tsx"),universalFiltersLogic=__webpack_require__("./frontend/src/lib/components/UniversalFilters/universalFiltersLogic.ts"),LemonTableLink=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTable/LemonTableLink.tsx"),TestAccountFilter=__webpack_require__("./frontend/src/scenes/insights/filters/TestAccountFilter/index.ts"),urls=__webpack_require__("./frontend/src/scenes/urls.ts"),Query=__webpack_require__("./frontend/src/queries/Query/Query.tsx"),schema=__webpack_require__("./frontend/src/queries/schema.ts"),src_types=__webpack_require__("./frontend/src/types.ts");let errorTrackingSceneLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","error-tracking","errorTrackingSceneLogic"]),(0,index_esm.actions)({setDateRange:dateRange=>({dateRange}),setOrder:order=>({order}),setFilterGroup:filterGroup=>({filterGroup}),setFilterTestAccounts:filterTestAccounts=>({filterTestAccounts})}),(0,index_esm.reducers)({dateRange:[{date_from:"-7d",date_to:null},{setDateRange:(_,_ref)=>{let{dateRange}=_ref;return dateRange}}],order:["last_seen",{setOrder:(_,_ref2)=>{let{order}=_ref2;return order}}],filterGroup:[{type:src_types.J2.And,values:[]},{setFilterGroup:(_,_ref3)=>{let{filterGroup}=_ref3;return filterGroup}}],filterTestAccounts:[!1,{setFilterTestAccounts:(_,_ref4)=>{let{filterTestAccounts}=_ref4;return filterTestAccounts}}]})]);var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let scene={component:ErrorTrackingScene,logic:errorTrackingSceneLogic};function ErrorTrackingScene(){let{dateRange,order,filterTestAccounts,filterGroup}=(0,index_esm.useValues)(errorTrackingSceneLogic);return(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsx)(Filters,{}),(0,jsx_runtime.jsx)(Query.A,{query:{kind:schema.OH.DataTableNode,source:{kind:schema.OH.EventsQuery,select:["any(properties) -- Error","properties.$exception_type","count() as unique_occurrences -- Occurrences","count(distinct $session_id) as unique_sessions -- Sessions","count(distinct distinct_id) as unique_users -- Users","max(timestamp) as last_seen","min(timestamp) as first_seen"],event:"$exception",orderBy:[order],after:dateRange.date_from,before:dateRange.date_to,filterTestAccounts,properties:filterGroup.values},hiddenColumns:["properties.$exception_type","first_value(properties)","max(timestamp) as last_seen","min(timestamp) as first_seen"],showActions:!1,showTimings:!1},context:{columns:{"any(properties) -- Error":{width:"50%",render:CustomGroupTitleColumn}},showOpenEditorButton:!1}})]})}let CustomGroupTitleColumn=props=>{let{value}=props,properties=JSON.parse(value);return(0,jsx_runtime.jsx)(LemonTableLink.i,{title:properties.$exception_type,description:(0,jsx_runtime.jsx)("div",{className:"line-clamp-1",children:properties.$exception_message}),to:urls.j.errorTrackingGroup(properties.$exception_type)})},Filters=()=>{let{dateRange,order,filterGroup,filterTestAccounts}=(0,index_esm.useValues)(errorTrackingSceneLogic),{setDateRange,setOrder,setFilterGroup,setFilterTestAccounts}=(0,index_esm.useActions)(errorTrackingSceneLogic);return(0,jsx_runtime.jsx)(UniversalFilters.Z,{rootKey:"session-recordings",group:filterGroup,taxonomicGroupTypes:[types.t.PersonProperties,types.t.Cohorts],onChange:filterGroup=>{setFilterGroup(filterGroup)},children:(0,jsx_runtime.jsxs)("div",{className:"divide-y bg-bg-light rounded border",children:[(0,jsx_runtime.jsxs)("div",{className:"flex space-x-1 justify-between px-2 py-1.5",children:[(0,jsx_runtime.jsxs)("div",{className:"flex space-x-1",children:[(0,jsx_runtime.jsx)(DateFilter.f,{dateFrom:dateRange.date_from,dateTo:dateRange.date_to,onChange:(changedDateFrom,changedDateTo)=>{setDateRange({date_from:changedDateFrom,date_to:changedDateTo})},size:"small"}),(0,jsx_runtime.jsx)(src.LemonSelect,{onSelect:setOrder,onChange:setOrder,value:order,options:[{value:"last_seen",label:"Last seen"},{value:"first_seen",label:"First seen"},{value:"unique_occurrences",label:"Occurrences"},{value:"unique_users",label:"Users"},{value:"unique_sessions",label:"Sessions"}],size:"small"})]}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(TestAccountFilter.z,{filters:{filter_test_accounts:filterTestAccounts},onChange:_ref=>{let{filter_test_accounts}=_ref;setFilterTestAccounts(filter_test_accounts||!1)},size:"small"})})]}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-1 items-center space-x-2 px-2 py-1.5",children:[(0,jsx_runtime.jsx)(RecordingsUniversalFilterGroup,{}),(0,jsx_runtime.jsx)(UniversalFilters.Z.AddFilterButton,{type:"secondary",size:"small"})]})]})})},RecordingsUniversalFilterGroup=()=>{let{filterGroup}=(0,index_esm.useValues)(universalFiltersLogic.d),{replaceGroupValue,removeGroupValue}=(0,index_esm.useActions)(universalFiltersLogic.d),values=filterGroup.values;return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:values.map((filter,index)=>(0,jsx_runtime.jsx)(UniversalFilters.Z.Value,{index:index,filter:filter,onRemove:()=>removeGroupValue(index),onChange:value=>replaceGroupValue(index,value)},index))})}}}]);