(window.webpackJsonp=window.webpackJsonp||[]).push([[237],{"./frontend/src/lib/forms/Field.tsx":function(G,h,a){"use strict";a.d(h,"a",function(){return F});var T=a("./node_modules/@babel/runtime/helpers/extends.js"),D=a.n(T),$=a("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),z=a.n($),V=a("./node_modules/core-js/modules/es.function.name.js"),Y=a.n(V),O=a("./node_modules/clsx/dist/clsx.m.js"),e=a("./node_modules/kea-forms/lib/components.js"),C=a.n(e),A=a("./node_modules/react/index.js"),d=a.n(A),j=["showOptional","name"],F=function(N){var K=N.showOptional,Z=N.name,k=z()(N,j),J=function(p){var b=p.label,ie=p.kids,P=p.hint,B=p.error;return d.a.createElement("div",{className:Object(O.a)("ant-row","ant-form-item",P||B?"ant-form-item-with-help":"",B?"ant-form-item-has-error":"")},b?d.a.createElement("div",{className:"ant-col ant-form-item-label"},d.a.createElement("label",{htmlFor:String(Z),title:typeof b=="string"?b:void 0},K?d.a.createElement(d.a.Fragment,null,b,K?d.a.createElement("span",{className:"ant-form-item-optional",title:""},"(optional)"):null):b)):null,d.a.createElement("div",{className:"ant-col ant-form-item-control"},d.a.createElement("div",{className:"ant-form-item-control-input"},d.a.createElement("div",{className:"ant-form-item-control-input-content"},ie)),P||B?d.a.createElement("div",{className:"ant-form-item-explain ant-form-item-explain-connected"},B?d.a.createElement("div",{role:"alert",className:"ant-form-item-explain-error"},"Error: ",B):null,P?d.a.createElement("div",{role:"alert",className:"ant-form-item-explain-warning"},"Hint: ",P):null):null))};return d.a.createElement(e.Field,D()({},k,{name:Z,template:J}))};try{F.displayName="Field",F.__docgenInfo={description:"Compatible replacement for Form.Item",displayName:"Field",props:{showOptional:{defaultValue:null,description:"",name:"showOptional",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/forms/Field.tsx#Field"]={docgenInfo:F.__docgenInfo,name:"Field",path:"frontend/src/lib/forms/Field.tsx#Field"})}catch(H){}},"./frontend/src/lib/forms/VerticalForm.tsx":function(G,h,a){"use strict";a.d(h,"a",function(){return e});var T=a("./node_modules/@babel/runtime/helpers/extends.js"),D=a.n(T),$=a("./node_modules/react/index.js"),z=a.n($),V=a("./node_modules/kea-forms/lib/index.js"),Y=a.n(V),O=a("./node_modules/clsx/dist/clsx.m.js");function e(C){return z.a.createElement(V.Form,D()({},C,{className:Object(O.a)("antd-form ant-form-vertical",C.className)}),C.children)}try{e.displayName="VerticalForm",e.__docgenInfo={description:"",displayName:"VerticalForm",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/forms/VerticalForm.tsx#VerticalForm"]={docgenInfo:e.__docgenInfo,name:"VerticalForm",path:"frontend/src/lib/forms/VerticalForm.tsx#VerticalForm"})}catch(C){}},"./frontend/src/lib/introductions/GroupsIntroductionOption.tsx":function(G,h,a){"use strict";a.d(h,"a",function(){return j});var T=a("./node_modules/core-js/modules/es.array.includes.js"),D=a.n(T),$=a("./node_modules/core-js/modules/es.string.includes.js"),z=a.n($),V=a("./node_modules/react/index.js"),Y=a.n(V),O=a("./node_modules/kea/lib/index.esm.js"),e=a("./node_modules/@ant-design/icons/es/icons/LockOutlined.js"),C=a("./node_modules/rc-select/es/index.js"),A=a("./frontend/src/lib/components/Link.tsx"),d=a("./frontend/src/lib/introductions/groupsAccessLogic.ts");function j(F){var H=F.value,N=Object(O.useValues)(d.b),K=N.groupsAccessStatus;return[d.a.HasAccess,d.a.HasGroupTypes,d.a.NoAccess].includes(K)?Y.a.createElement(C.default.Option,{key:"groups",value:H,disabled:!0,style:{height:"100%",width:"100%",overflow:"hidden",textOverflow:"ellipsis",backgroundColor:"var(--bg-side)",color:"var(--text-muted)"}},Y.a.createElement(e.a,{style:{marginRight:6,color:"var(--warning)"}}),"Unique groups \u2013"," ",Y.a.createElement(A.a,{to:"https://posthog.com/docs/user-guides/group-analytics?utm_medium=in-product&utm_campaign=group-analytics-learn-more",target:"_blank","data-attr":"group-analytics-learn-more",style:{fontWeight:600}},"Learn more")):null}try{j.displayName="GroupsIntroductionOption",j.__docgenInfo={description:"",displayName:"GroupsIntroductionOption",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"]={docgenInfo:j.__docgenInfo,name:"GroupsIntroductionOption",path:"frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"})}catch(F){}},"./frontend/src/scenes/feature-flags/FeatureFlag.tsx":function(G,h,a){"use strict";a.r(h),a.d(h,"scene",function(){return mt}),a.d(h,"FeatureFlag",function(){return X});var T=a("./node_modules/@babel/runtime/helpers/slicedToArray.js"),D=a.n(T),$=a("./node_modules/core-js/modules/es.array.map.js"),z=a("./node_modules/core-js/modules/es.object.to-string.js"),V=a("./node_modules/core-js/modules/es.regexp.to-string.js"),Y=a("./node_modules/core-js/modules/es.array.concat.js"),O=a("./node_modules/react/index.js"),e=a.n(O),C=a("./node_modules/kea-forms/lib/index.js"),A=a("./node_modules/antd/es/row/index.js"),d=a("./node_modules/antd/es/col/index.js"),j=a("./node_modules/antd/es/input/index.js"),F=a("./node_modules/antd/es/collapse/index.js"),H=a("./node_modules/antd/es/popconfirm/index.js"),N=a("./node_modules/antd/es/radio/index.js"),K=a("./node_modules/antd/es/button/index.js"),Z=a("./node_modules/antd/es/slider/index.js"),k=a("./node_modules/antd/es/input-number/index.js"),J=a("./node_modules/antd/es/select/index.js"),se=a("./node_modules/antd/es/card/index.js"),p=a("./node_modules/kea/lib/index.esm.js"),b=a("./frontend/src/lib/utils.tsx"),ie=a("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),P=a("./node_modules/@ant-design/icons/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),B={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917.7 148.8l-42.4-42.4c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-76.1 76.1a199.27 199.27 0 00-112.1-34.3c-51.2 0-102.4 19.5-141.5 58.6L432.3 308.7a8.03 8.03 0 000 11.3L704 591.7c1.6 1.6 3.6 2.3 5.7 2.3 2 0 4.1-.8 5.7-2.3l101.9-101.9c68.9-69 77-175.7 24.3-253.5l76.1-76.1c3.1-3.2 3.1-8.3 0-11.4zM578.9 546.7a8.03 8.03 0 00-11.3 0L501 613.3 410.7 523l66.7-66.7c3.1-3.1 3.1-8.2 0-11.3L441 408.6a8.03 8.03 0 00-11.3 0L363 475.3l-43-43a7.85 7.85 0 00-5.7-2.3c-2 0-4.1.8-5.7 2.3L206.8 534.2c-68.9 68.9-77 175.7-24.3 253.5l-76.1 76.1a8.03 8.03 0 000 11.3l42.4 42.4c1.6 1.6 3.6 2.3 5.7 2.3s4.1-.8 5.7-2.3l76.1-76.1c33.7 22.9 72.9 34.3 112.1 34.3 51.2 0 102.4-19.5 141.5-58.6l101.9-101.9c3.1-3.1 3.1-8.2 0-11.3l-43-43 66.7-66.7c3.1-3.1 3.1-8.2 0-11.3l-36.6-36.2z"}}]},name:"api",theme:"filled"},Ne=B,ye=a("./node_modules/@ant-design/icons/es/components/AntdIcon.js"),he=function(t,l){return O.createElement(ye.a,Object(P.a)(Object(P.a)({},t),{},{ref:l,icon:Ne}))};he.displayName="ApiFilled";var Ke=O.forwardRef(he),Be=a("./node_modules/@ant-design/icons/es/icons/LockOutlined.js"),We={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482.2 508.4L331.3 389c-3-2.4-7.3-.2-7.3 3.6V478H184V184h204v128c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V144c0-15.5-12.5-28-28-28H144c-15.5 0-28 12.5-28 28v736c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v128H184V546h140v85.4c0 3.8 4.4 6 7.3 3.6l150.9-119.4a4.5 4.5 0 000-7.2zM880 116H596c-15.5 0-28 12.5-28 28v168c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V184h204v294H700v-85.4c0-3.8-4.3-6-7.3-3.6l-151 119.4a4.52 4.52 0 000 7.1l151 119.5c2.9 2.3 7.3.2 7.3-3.6V546h140v294H636V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v168c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V144c0-15.5-12.5-28-28-28z"}}]},name:"merge-cells",theme:"outlined"},Ue=We,Oe=function(t,l){return O.createElement(ye.a,Object(P.a)(Object(P.a)({},t),{},{ref:l,icon:Ue}))};Oe.displayName="MergeCellsOutlined";var Ge=O.forwardRef(Oe),$e=a("./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js"),Mt=a("./node_modules/core-js/modules/es.object.keys.js"),_t=a("./node_modules/core-js/modules/es.symbol.js"),Rt=a("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Dt=a("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Ye=a("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),we=a.n(Ye),ze=a("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),q=a.n(ze),He=a("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),I=a.n(He),Je=a("./node_modules/@babel/runtime/helpers/defineProperty.js"),Fe=a.n(Je),Xe=a("./node_modules/@babel/runtime/regenerator/index.js"),L=a.n(Xe),Vt=a("./node_modules/core-js/modules/es.regexp.exec.js"),Nt=a("./node_modules/core-js/modules/es.string.match.js"),Kt=a("./node_modules/core-js/modules/es.array.splice.js"),Bt=a("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Wt=a("./node_modules/core-js/modules/es.array.iterator.js"),Ut=a("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Gt=a("./node_modules/core-js/modules/es.string.replace.js"),$t=a("./node_modules/core-js/modules/es.function.name.js"),Yt=a("./node_modules/core-js/modules/es.array.filter.js"),wt=a("./node_modules/core-js/modules/es.array.find.js"),ue=a("./frontend/src/lib/api.ts"),ce=a("./node_modules/kea-router/lib/index.js"),ee=a("./frontend/src/scenes/urls.ts"),je=a("./frontend/src/scenes/teamLogic.ts"),de=a("./frontend/src/scenes/feature-flags/featureFlagsLogic.ts"),be=a("./frontend/src/models/groupsModel.ts"),Ce=a("./frontend/src/lib/components/TaxonomicFilter/types.ts"),Qe=a("./frontend/src/lib/components/lemonToast.tsx"),Ze=a("./node_modules/kea-loaders/lib/index.js"),ke=["created_at","id"];function Se(n,t){var l=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),l.push.apply(l,r)}return l}function o(n){for(var t=1;t<arguments.length;t++){var l=arguments[t]!=null?arguments[t]:{};t%2?Se(Object(l),!0).forEach(function(r){Fe()(n,r,l[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(l)):Se(Object(l)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(l,r))})}return n}var me={id:null,created_at:null,key:"",name:"",filters:{groups:[{properties:[],rollout_percentage:null}],multivariate:null},deleted:!1,active:!0,created_by:null,is_simple_flag:!1,rollout_percentage:null},qe={key:"",name:"",rollout_percentage:0},et={variants:[{key:"",name:"",rollout_percentage:100}]},te=Object(p.kea)([Object(p.path)(["scenes","feature-flags","featureFlagLogic"]),Object(p.props)({}),Object(p.key)(function(n){var t=n.id;return t!=null?t:"new"}),Object(p.connect)({values:[je.a,["currentTeamId"],be.a,["groupTypes","groupsTaxonomicTypes","aggregationLabel"]]}),Object(p.actions)({setFeatureFlag:function(t){return{featureFlag:t}},addConditionSet:!0,setAggregationGroupTypeIndex:function(t){return{value:t}},removeConditionSet:function(t){return{index:t}},duplicateConditionSet:function(t){return{index:t}},updateConditionSet:function(t,l,r){return{index:t,newRolloutPercentage:l,newProperties:r}},deleteFeatureFlag:function(t){return{featureFlag:t}},setMultivariateEnabled:function(t){return{enabled:t}},setMultivariateOptions:function(t){return{multivariateOptions:t}},addVariant:!0,removeVariant:function(t){return{index:t}},distributeVariantsEqually:!0}),Object(C.forms)(function(n){var t=n.actions;return{featureFlag:{defaults:o({},me),errors:function(r){var s,u,i,c=r.key,y=r.filters;return{key:c?(s=c.match)!==null&&s!==void 0&&s.call(c,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key",filters:{multivariate:{variants:y==null||(u=y.multivariate)===null||u===void 0||(i=u.variants)===null||i===void 0?void 0:i.map(function(E){var _,v=E.key;return{key:v?(_=v.match)!==null&&_!==void 0&&_.call(v,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key"}})}}}},submit:function(r){t.saveFeatureFlag(r)}}}}),Object(p.reducers)({featureFlag:[o({},me),{setFeatureFlag:function(t,l){var r=l.featureFlag;if(r.filters.groups){var s=r.filters.groups.map(function(u){return u.properties?o(o({},u),{},{properties:Object(b.r)(u.properties)}):u});return o(o({},r),{},{filters:o(o({},r==null?void 0:r.filters),{},{groups:s})})}return r},addConditionSet:function(t){if(!t)return t;var l=[].concat(I()(t==null?void 0:t.filters.groups),[{properties:[],rollout_percentage:null}]);return o(o({},t),{},{filters:o(o({},t.filters),{},{groups:l})})},updateConditionSet:function(t,l){var r=l.index,s=l.newRolloutPercentage,u=l.newProperties;if(!t)return t;var i=I()(t==null?void 0:t.filters.groups);return s!==void 0&&(i[r]=o(o({},i[r]),{},{rollout_percentage:s})),u!==void 0&&(i[r]=o(o({},i[r]),{},{properties:u})),o(o({},t),{},{filters:o(o({},t.filters),{},{groups:i})})},removeConditionSet:function(t,l){var r=l.index;if(!t)return t;var s=I()(t.filters.groups);return s.splice(r,1),o(o({},t),{},{filters:o(o({},t.filters),{},{groups:s})})},duplicateConditionSet:function(t,l){var r=l.index;if(!t)return t;var s=t.filters.groups.concat([t.filters.groups[r]]);return o(o({},t),{},{filters:o(o({},t.filters),{},{groups:s})})},setMultivariateOptions:function(t,l){var r=l.multivariateOptions;return t&&o(o({},t),{},{filters:o(o({},t.filters),{},{multivariate:r})})},addVariant:function(t){var l;if(!t)return t;var r=I()(((l=t.filters.multivariate)===null||l===void 0?void 0:l.variants)||[]);return o(o({},t),{},{filters:o(o({},t.filters),{},{multivariate:o(o({},t.filters.multivariate||{}),{},{variants:[].concat(I()(r),[qe])})})})},removeVariant:function(t,l){var r,s=l.index;if(!t)return t;var u=I()(((r=t.filters.multivariate)===null||r===void 0?void 0:r.variants)||[]);return u.splice(s,1),o(o({},t),{},{filters:o(o({},t.filters),{},{multivariate:o(o({},t.filters.multivariate),{},{variants:u})})})},distributeVariantsEqually:function(t){var l;if(!t)return t;var r=I()(((l=t.filters.multivariate)===null||l===void 0?void 0:l.variants)||[]),s=r.length;if(s>0&&s<=100){var u=Math.round(100/s),i=u*s,c=i-100;r.forEach(function(y,E){r[E]=o(o({},y),{},{rollout_percentage:u})}),r[s-1]=o(o({},r[s-1]),{},{rollout_percentage:u-c})}return o(o({},t),{},{filters:o(o({},t.filters),{},{multivariate:o(o({},t.filters.multivariate),{},{variants:r})})})},setAggregationGroupTypeIndex:function(t,l){var r=l.value;return!t||t.filters.aggregation_group_type_index==r?t:o(o({},t),{},{filters:o(o({},t.filters),{},{aggregation_group_type_index:r,groups:[{properties:[],rollout_percentage:null}]})})}}]}),Object(Ze.loaders)(function(n){var t=n.values,l=n.props;return{featureFlag:{loadFeatureFlag:function(){var r=q()(L.a.mark(function u(){return L.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(l.id&&l.id!=="new")){c.next=4;break}return c.next=3,ue.b.get("api/projects/".concat(t.currentTeamId,"/feature_flags/").concat(l.id));case 3:return c.abrupt("return",c.sent);case 4:return c.abrupt("return",me);case 5:case"end":return c.stop()}},u)}));function s(){return r.apply(this,arguments)}return s}(),saveFeatureFlag:function(){var r=q()(L.a.mark(function u(i){var c,y,E;return L.a.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(c=i.created_at,y=i.id,E=we()(i,ke),i.id){v.next=7;break}return v.next=4,ue.b.create("api/projects/".concat(t.currentTeamId,"/feature_flags"),E);case 4:return v.abrupt("return",v.sent);case 7:return v.next=9,ue.b.update("api/projects/".concat(t.currentTeamId,"/feature_flags/").concat(i.id),E);case 9:return v.abrupt("return",v.sent);case 10:case"end":return v.stop()}},u)}));function s(u){return r.apply(this,arguments)}return s}()}}}),Object(p.listeners)(function(n){var t=n.actions,l=n.values;return{saveFeatureFlagSuccess:function(s){var u,i=s.featureFlag;Qe.b.success("Feature flag saved"),(u=de.a.findMounted())===null||u===void 0||u.actions.updateFlag(i),ce.router.actions.replace(ee.a.featureFlag(i.id))},deleteFeatureFlag:function(){var r=q()(L.a.mark(function u(i){var c;return L.a.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:c=i.featureFlag,Object(b.w)({endpoint:"projects/".concat(l.currentTeamId,"/feature_flags"),object:{name:c.name,id:c.id},callback:function(){var v;c.id&&((v=de.a.findMounted())===null||v===void 0||v.actions.deleteFlag(c.id)),ce.router.actions.push(ee.a.featureFlags())}});case 2:case"end":return E.stop()}},u)}));function s(u){return r.apply(this,arguments)}return s}(),setMultivariateEnabled:function(){var r=q()(L.a.mark(function u(i){var c;return L.a.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:c=i.enabled,c?t.setMultivariateOptions(et):t.setMultivariateOptions(null);case 2:case"end":return E.stop()}},u)}));function s(u){return r.apply(this,arguments)}return s}()}}),Object(p.selectors)({props:[function(){return[function(n,t){return t}]},function(n){return n}],multivariateEnabled:[function(n){return[n.featureFlag]},function(n){return!!(n!=null&&n.filters.multivariate)}],variants:[function(n){return[n.featureFlag]},function(n){var t;return(n==null||(t=n.filters.multivariate)===null||t===void 0?void 0:t.variants)||[]}],nonEmptyVariants:[function(n){return[n.variants]},function(n){return n.filter(function(t){var l=t.key;return!!l})}],variantRolloutSum:[function(n){return[n.variants]},function(n){return n.reduce(function(t,l){var r=l.rollout_percentage;return t+r},0)}],areVariantRolloutsValid:[function(n){return[n.variants,n.variantRolloutSum]},function(n,t){return n.every(function(l){var r=l.rollout_percentage;return r>=0&&r<=100})&&t===100}],aggregationTargetName:[function(n){return[n.featureFlag,n.groupTypes,n.aggregationLabel]},function(n,t,l){return n&&n.filters.aggregation_group_type_index!=null&&t.length>0?l(n.filters.aggregation_group_type_index).plural:"users"}],taxonomicGroupTypes:[function(n){return[n.featureFlag,n.groupsTaxonomicTypes]},function(n,t){return n&&n.filters.aggregation_group_type_index!=null&&t.length>0?[t[n.filters.aggregation_group_type_index]]:[Ce.a.PersonProperties,Ce.a.Cohorts]}],breadcrumbs:[function(n){return[n.featureFlag]},function(n){return[{name:"Feature Flags",path:ee.a.featureFlags()}].concat(I()(n?[{name:n.key||"Unnamed"}]:[]))}]}),Object(ce.urlToAction)(function(n){var t,l=n.actions,r=n.props;return Fe()({},ee.a.featureFlag((t=r.id)!==null&&t!==void 0?t:"new"),function(s,u,i,c){var y=c.method;y==="PUSH"&&(r.id?l.loadFeatureFlag():l.resetFeatureFlag())})}),Object(p.afterMount)(function(n){var t,l=n.props,r=n.actions,s=(t=de.a.findMounted())===null||t===void 0?void 0:t.values.featureFlags.find(function(u){return u.id===l.id});s?r.setFeatureFlag(s):l.id!=="new"&&r.loadFeatureFlag()})]),tt=a("./frontend/src/lib/components/PageHeader.tsx"),at=a("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),nt=a.n(at),rt=a("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss"),xe=a.n(rt),fe={};fe.insert="head",fe.singleton=!1;var zt=nt()(xe.a,fe),Ht=xe.a.locals||{},M=a("./frontend/src/lib/components/icons.tsx"),ae=a("./frontend/src/lib/components/Tooltip.tsx"),w=a("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),ne="?utm_medium=in-product&utm_campaign=feature-flag";function re(n){var t=n.flagKey;return e.a.createElement(e.a.Fragment,null,e.a.createElement(w.a,{language:w.b.JavaScript,wrap:!0},"if\xA0(posthog.isFeatureEnabled('".concat(t!=null?t:"",`')) {
    // run your activation code here
}`)),e.a.createElement("div",{className:"mt"},"Need more information?"," ",e.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://posthog.com/docs/integrations/js-integration".concat(ne,"#feature-flags")},"Check the docs ",e.a.createElement(M.IconOpenInNew,null))))}function le(n){var t=n.flagKey;return e.a.createElement(e.a.Fragment,null,e.a.createElement(w.a,{language:w.b.Python,wrap:!0},'if\xA0posthog.feature_enabled("'.concat(t,`", "user_distinct_id"):
    runAwesomeFeature()
`)),e.a.createElement("div",{className:"mt"},"Need more information?"," ",e.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://posthog.com/docs/integrations/python-integration".concat(ne,"#feature-flags")},"Check the docs ",e.a.createElement(M.IconOpenInNew,null))))}function lt(){var n=Object(p.useValues)(je.a),t=n.currentTeam;return e.a.createElement(e.a.Fragment,null,e.a.createElement(w.a,{language:w.b.Bash,wrap:!0},"curl ".concat(window.location.origin,`/decide/ \\
-X POST -H 'Content-Type: application/json' \\
-d '{
    "api_key": "`).concat(t?t.api_token:"[project_api_key]",`",
    "distinct_id": "[user distinct id]"
}'
                `)),e.a.createElement("div",{className:"mt"},"Need more information?"," ",e.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://posthog.com/docs/api/feature-flags".concat(ne)},"Check the docs ",e.a.createElement(M.IconOpenInNew,null))))}try{re.displayName="JSSnippet",re.__docgenInfo={description:"",displayName:"JSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"]={docgenInfo:re.__docgenInfo,name:"JSSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"})}catch(n){}try{le.displayName="PythonSnippet",le.__docgenInfo={description:"",displayName:"PythonSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"]={docgenInfo:le.__docgenInfo,name:"PythonSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"})}catch(n){}var Te=a("./frontend/src/lib/components/LemonDivider/index.ts"),ot=a("./frontend/src/lib/introductions/GroupsIntroductionOption.tsx"),st=a("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),it=a("./frontend/src/scenes/userLogic.ts"),ge=a("./frontend/src/types.ts"),ut=a("./frontend/src/lib/components/Link.tsx"),W=a("./frontend/src/lib/components/LemonButton/index.ts"),ct=a("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),U=a("./frontend/src/lib/forms/Field.tsx"),dt=a("./frontend/src/lib/forms/VerticalForm.tsx"),mt={component:X,logic:te,paramsToProps:function(t){var l=t.params.id;return{id:l&&l!=="new"?parseInt(l):"new"}}};function Ae(n){setTimeout(function(){var t;return(t=document.querySelector('.variant-form-list input[data-key-index="'.concat(n,'"]')))===null||t===void 0?void 0:t.focus()},50)}function X(){var n,t,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=l.id,s=Object(p.useValues)(te),u=s.props,i=s.featureFlag,c=s.multivariateEnabled,y=s.variants,E=s.nonEmptyVariants,_=s.areVariantRolloutsValid,v=s.variantRolloutSum,ft=s.groupTypes,Q=s.aggregationTargetName,gt=s.taxonomicGroupTypes,pt=s.featureFlagLoading,S=Object(p.useActions)(te),vt=S.addConditionSet,Pe=S.updateConditionSet,Et=S.removeConditionSet,yt=S.duplicateConditionSet,ht=S.deleteFeatureFlag,Ie=S.setMultivariateEnabled,Ot=S.addVariant,Ft=S.removeVariant,jt=S.distributeVariantsEqually,bt=S.setAggregationGroupTypeIndex,Le=Object(p.useValues)(be.a),Ct=Le.showGroupsOptions,St=Le.aggregationLabel,Me=Object(p.useValues)(it.a),pe=Me.hasAvailableFeature,xt=Me.upgradeLink,Tt=Object(O.useState)(!1),_e=D()(Tt,2),Re=_e[0],At=_e[1],Pt=Object(O.useState)(!1),De=D()(Pt,2),It=De[0],ve=De[1],Lt=Object(ot.a)({value:-2});return e.a.createElement("div",{className:"feature-flag"},i?e.a.createElement(dt.a,{logic:te,props:u,formKey:"featureFlag",enableFormOnSubmit:!0},e.a.createElement(tt.a,{title:"Feature Flag",buttons:e.a.createElement("div",{className:"flex-center"},e.a.createElement(U.a,{name:"active"},function(f){var m=f.value,g=f.onValueChange;return e.a.createElement(ct.a,{checked:m,onChange:g,label:m?e.a.createElement("span",{className:"text-success"},"Enabled"):e.a.createElement("span",{className:"text-danger"},"Disabled")})}),(i==null?void 0:i.id)&&e.a.createElement(W.a,{"data-attr":"delete-flag",status:"danger",type:"secondary",onClick:function(){ht(i)},style:{marginRight:16}},"Delete"),e.a.createElement(W.a,{type:"primary","data-attr":"feature-flag-submit",loading:pt,htmlType:"submit"},"Save changes"))}),e.a.createElement("h3",{className:"l3"},"General configuration"),e.a.createElement("div",{className:"text-muted mb"},"General settings for your feature flag and integration instructions."),e.a.createElement(A.a,{gutter:16,style:{marginBottom:32}},e.a.createElement(d.a,{span:12},e.a.createElement(U.a,{name:"key",label:"Key (must be unique)",validateStatus:Re?"warning":void 0,hint:Re&&r!=="new"?e.a.createElement("small",null,e.a.createElement("b",null,"Warning! "),"Changing this key will",e.a.createElement("a",{href:"https://posthog.com/docs/features/feature-flags".concat(ne,"#feature-flag-persistence"),target:"_blank",rel:"noopener"}," ","affect the persistence of your flag ",e.a.createElement(M.IconOpenInNew,null))):void 0},function(f){var m=f.value,g=f.onChange;return e.a.createElement(j.a,{value:m,onChange:function(x){x.target.value!==m&&At(!0),g(x)},"data-attr":"feature-flag-key",className:"ph-ignore-input",autoFocus:!0,placeholder:"examples: new-landing-page, betaFeature, ab_test_1",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})}),e.a.createElement(U.a,{name:"name",label:"Description"},function(f){var m=f.value,g=f.onChange;return e.a.createElement(j.a.TextArea,{value:m,onChange:g,className:"ph-ignore-input","data-attr":"feature-flag-description",placeholder:"Adding a helpful description can ensure others know what this feature is for."})})),e.a.createElement(d.a,{span:12,style:{paddingTop:31}},e.a.createElement(F.a,null,e.a.createElement(F.a.Panel,{header:e.a.createElement("div",{style:{display:"flex",fontWeight:"bold",alignItems:"center"}},e.a.createElement(M.IconJavascript,{style:{marginRight:6}})," Javascript integration instructions"),key:"js"},e.a.createElement(re,{flagKey:i.key||"my-flag"})),e.a.createElement(F.a.Panel,{header:e.a.createElement("div",{style:{display:"flex",fontWeight:"bold",alignItems:"center"}},e.a.createElement(M.IconPython,{style:{marginRight:6}})," Python integration instructions"),key:"python"},e.a.createElement(le,{flagKey:i.key||"my-flag"})),e.a.createElement(F.a.Panel,{header:e.a.createElement("div",{style:{display:"flex",fontWeight:"bold",alignItems:"center"}},e.a.createElement(Ke,{style:{marginRight:6}})," API integration instructions"),key:"api"},e.a.createElement(lt,null))))),e.a.createElement("div",{className:"mb-2"},e.a.createElement("h3",{className:"l3"},"Served value"),e.a.createElement("div",{className:"mb-05"},e.a.createElement(H.a,{placement:"top",title:"Change value type? The variants below will be lost.",visible:It,onConfirm:function(){Ie(!1),ve(!1)},onCancel:function(){return ve(!1)},okText:"OK",cancelText:"Cancel"},e.a.createElement(N.a.Group,{options:[{label:"Boolean value (A/B test)",value:!1},{label:e.a.createElement(ae.a,{title:pe(ge.d.MULTIVARIATE_FLAGS)?"":"This feature is not available on your current plan."},e.a.createElement("div",null,!pe(ge.d.MULTIVARIATE_FLAGS)&&e.a.createElement(ut.a,{to:xt,target:"_blank"},e.a.createElement(Be.a,{style:{marginRight:4,color:"var(--warning)"}})),"String value (Multivariate test)"," ",e.a.createElement(st.a,{type:"warning"},"Beta"))),value:!0,disabled:!pe(ge.d.MULTIVARIATE_FLAGS)}],onChange:function(m){var g=m.target.value;g===!1&&E.length?ve(!0):(Ie(g),Ae(0))},value:c,optionType:"button"}))),e.a.createElement("div",{className:"text-muted mb"},Object(b.i)(Q)," will be served"," ",c?e.a.createElement(e.a.Fragment,null,e.a.createElement("strong",null,"a variant key")," according to the below distribution"):e.a.createElement("strong",null,e.a.createElement("code",null,"true"))," ","if they match one or more release condition groups."),c&&e.a.createElement("div",{className:"variant-form-list"},e.a.createElement(A.a,{gutter:8,className:"label-row"},e.a.createElement(d.a,{span:7},"Variant key"),e.a.createElement(d.a,{span:7},"Description"),e.a.createElement(d.a,{span:9},e.a.createElement("span",null,"Rollout percentage"),e.a.createElement(K.a,{type:"link",onClick:jt,icon:e.a.createElement(Ge,null),style:{padding:"0 0 0 0.5em"},title:"Distribute variants equally"},"Distribute"))),y.map(function(f,m){return e.a.createElement(C.Group,{key:m,name:["filters","multivariate","variants",m]},e.a.createElement(A.a,{gutter:8},e.a.createElement(d.a,{span:7},e.a.createElement(U.a,{name:"key"},e.a.createElement(j.a,{"data-attr":"feature-flag-variant-key","data-key-index":m.toString(),className:"ph-ignore-input",placeholder:"example-variant-".concat(m+1),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}))),e.a.createElement(d.a,{span:7},e.a.createElement(U.a,{name:"name"},e.a.createElement(j.a,{"data-attr":"feature-flag-variant-name",className:"ph-ignore-input",placeholder:"Description"}))),e.a.createElement(d.a,{span:7},e.a.createElement(U.a,{name:"rollout_percentage"},function(g){var R=g.value,x=g.onValueChange;return e.a.createElement(Z.a,{tooltipPlacement:"top",value:R,onChange:x})})),e.a.createElement(d.a,{span:2},e.a.createElement(U.a,{name:"rollout_percentage"},function(g){var R=g.value,x=g.onValueChange;return e.a.createElement(k.a,{min:0,max:100,value:R,onChange:function(Ee){if(Ee!=null){var Ve=parseInt(Ee.toString());isNaN(Ve)||x(Ve)}},style:{width:"100%",borderColor:_?void 0:"var(--danger)"}})})),y.length>1&&e.a.createElement(d.a,{span:1},e.a.createElement(ae.a,{title:"Delete this variant",placement:"bottomLeft"},e.a.createElement(K.a,{type:"link",icon:e.a.createElement($e.a,null),onClick:function(){return Ft(m)},style:{color:"var(--danger)"}})))))}),y.length>0&&!_&&e.a.createElement("p",{className:"text-danger"},"Percentage rollouts for variants must sum to 100 (currently ",v,")."),e.a.createElement(W.a,{type:"secondary",onClick:function(){var m=y.length;Ot(),Ae(m)},style:{margin:"1rem 0"},size:"small",fullWidth:!0,center:!0},"Add variant"))),e.a.createElement("div",{className:"feature-flag-form-row"},e.a.createElement("div",null,e.a.createElement("h3",{className:"l3"},"Release conditions"),e.a.createElement("div",{className:"text-muted mb"},"Specify the ",Q," to which you want to release this flag. Note that condition sets are rolled out independently of each other.")),Ct&&e.a.createElement("div",{className:"centered"},"Match by",e.a.createElement(J.a,{value:((n=i.filters)===null||n===void 0?void 0:n.aggregation_group_type_index)!=null?(t=i.filters)===null||t===void 0?void 0:t.aggregation_group_type_index:-1,onChange:function(m){var g=m!==-1?m:null;bt(g)},style:{marginLeft:8},"data-attr":"feature-flag-aggregation-filter",dropdownMatchSelectWidth:!1,dropdownAlign:{points:["tr","br"]}},e.a.createElement(J.a.Option,{key:-1,value:-1},"Users"),ft.map(function(f){return e.a.createElement(J.a.Option,{key:f.group_type_index,value:f.group_type_index},Object(b.i)(St(f.group_type_index).plural))}),Lt))),e.a.createElement(A.a,{gutter:16},i.filters.groups.map(function(f,m){var g,R;return e.a.createElement(d.a,{span:24,md:24,key:"".concat(m,"-").concat(i.filters.groups.length)},m>0&&e.a.createElement("div",{style:{display:"flex",marginLeft:16}},e.a.createElement("div",{className:"stateful-badge or-light-grey mb"},"OR")),e.a.createElement(se.a,{style:{marginBottom:16}},e.a.createElement("div",{className:"feature-flag-form-row",style:{height:24}},e.a.createElement("div",null,e.a.createElement("span",{className:"simple-tag tag-light-blue",style:{marginRight:8}},"Set ",m+1),(g=f.properties)!==null&&g!==void 0&&g.length?e.a.createElement(e.a.Fragment,null,"Matching ",e.a.createElement("b",null,Q)," with filters"):e.a.createElement(e.a.Fragment,null,"Condition set will match ",e.a.createElement("b",null,"all ",Q))),e.a.createElement(A.a,{align:"middle"},e.a.createElement(ae.a,{title:"Duplicate this condition set",placement:"bottomLeft"},e.a.createElement(W.a,{icon:e.a.createElement(M.IconCopy,null),size:"small",onClick:function(){return yt(m)}})),i.filters.groups.length>1&&e.a.createElement(ae.a,{title:"Delete this condition set",placement:"bottomLeft"},e.a.createElement(W.a,{icon:e.a.createElement(M.IconDelete,null),size:"small",onClick:function(){return Et(m)}})))),e.a.createElement(Te.a,{large:!0}),e.a.createElement(ie.a,{style:{marginLeft:15},pageKey:"feature-flag-".concat(i.id,"-").concat(m,"-").concat(i.filters.groups.length,"-").concat((R=i.filters.aggregation_group_type_index)!==null&&R!==void 0?R:""),propertyFilters:f==null?void 0:f.properties,onChange:function(oe){return Pe(m,void 0,oe)},taxonomicGroupTypes:gt,showConditionBadge:!0}),e.a.createElement(Te.a,{large:!0}),e.a.createElement("div",{className:"feature-flag-form-row"},e.a.createElement("div",{className:"centered"},"Roll out to"," ",e.a.createElement(k.a,{style:{width:100,marginLeft:8,marginRight:8},onChange:function(oe){Pe(m,oe)},value:f.rollout_percentage!=null?f.rollout_percentage:100,min:0,max:100,addonAfter:"%"})," ","of ",e.a.createElement("b",null,Q)," in this set"))))})),e.a.createElement(se.a,{size:"small",style:{marginBottom:16}},e.a.createElement(W.a,{onClick:vt,fullWidth:!0},"Add condition set")),e.a.createElement("div",{className:"text-right"},e.a.createElement(W.a,{htmlType:"submit",type:"primary","data-attr":"feature-flag-submit-bottom"},"Save changes"))):e.a.createElement(b.b,null))}try{X.displayName="FeatureFlag",X.__docgenInfo={description:"",displayName:"FeatureFlag",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"]={docgenInfo:X.__docgenInfo,name:"FeatureFlag",path:"frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"})}catch(n){}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss":function(G,h,a){var T=a("./node_modules/css-loader/dist/runtime/api.js");h=T(!1),h.push([G.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.variant-form-list .ant-form-item{min-height:32px}.variant-form-list .label-row{margin-bottom:4px;font-weight:700}.variant-form-list .label-row .ant-col{min-height:32px;display:flex;justify-content:space-between;align-items:center}.feature-flag-form-row{display:flex;justify-content:space-between;align-items:center;width:100%}.feature-flag-form-row .centered{display:flex;align-items:center;white-space:pre-wrap}",""]),G.exports=h}}]);
