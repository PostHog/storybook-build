(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"./frontend/src/scenes/actions/EventName.tsx":function(pe,M,e){"use strict";e.d(M,"a",function(){return ie}),e.d(M,"b",function(){return q});var G=e("./node_modules/react/index.js"),I=e.n(G),te=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),ne=e("./frontend/src/lib/components/TaxonomicPopup/TaxonomicPopup.tsx"),le=e("./frontend/src/lib/components/TaxonomicFilter/types.ts");function ie(Q){var re=Q.value,X=Q.onChange;return I.a.createElement(ne.d,{groupType:le.a.Events,onChange:X,value:re,type:"secondary",style:{maxWidth:"24rem"},placeholder:"Choose an event",dataAttr:"event-name-box",renderValue:function(o){return I.a.createElement(te.a,{value:o,disablePopover:!0})},allowClear:!0})}function q(Q){var re=Q.value,X=Q.onChange;return I.a.createElement(ne.b,{groupType:le.a.Events,onChange:X,value:re,type:"secondary",placeholder:"Select an event",dataAttr:"event-name-box",renderValue:function(o){return I.a.createElement(te.a,{value:o,disablePopover:!0})},allowClear:!0})}try{ie.displayName="EventName",ie.__docgenInfo={description:"",displayName:"EventName",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/actions/EventName.tsx#EventName"]={docgenInfo:ie.__docgenInfo,name:"EventName",path:"frontend/src/scenes/actions/EventName.tsx#EventName"})}catch(Q){}try{q.displayName="LemonEventName",q.__docgenInfo={description:"",displayName:"LemonEventName",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/actions/EventName.tsx#LemonEventName"]={docgenInfo:q.__docgenInfo,name:"LemonEventName",path:"frontend/src/scenes/actions/EventName.tsx#LemonEventName"})}catch(Q){}},"./frontend/src/scenes/events/EventDetails.tsx":function(pe,M,e){"use strict";e.d(M,"a",function(){return J});var G=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),I=e.n(G),te=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),ne=e.n(te),le=e("./node_modules/core-js/modules/es.object.keys.js"),ie=e("./node_modules/core-js/modules/es.symbol.js"),q=e("./node_modules/core-js/modules/es.array.filter.js"),Q=e("./node_modules/core-js/modules/es.object.to-string.js"),re=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),X=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Z=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),o=e("./node_modules/react/index.js"),b=e.n(o),T=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),se=e("./frontend/src/lib/components/PropertiesTable.tsx"),B=e("./frontend/src/scenes/events/EventElements.tsx"),ce=e("./node_modules/antd/es/tabs/index.js"),Te=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),he=e.n(Te),Ce=e("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),fe=e("./frontend/src/lib/utils.tsx"),oe=["event","id","uuid","distinct_id","properties","elements","timestamp","person"];function de(m,a){var _=Object.keys(m);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(m);a&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(m,A).enumerable})),_.push.apply(_,f)}return _}function Y(m){for(var a=1;a<arguments.length;a++){var _=arguments[a]!=null?arguments[a]:{};a%2?de(Object(_),!0).forEach(function(f){I()(m,f,_[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(_)):de(Object(_)).forEach(function(f){Object.defineProperty(m,f,Object.getOwnPropertyDescriptor(_,f))})}return m}function K(m){var a=m.event,_=a.event,f=a.id,A=a.uuid,R=a.distinct_id,ve=a.properties,F=a.elements,me=a.timestamp,k=a.person,ae=he()(a,oe),S=Y(Y(Y(Y({},f?{id:f}:null),A?{uuid:A}:null),{},{timestamp:me,event:_,distinct_id:R,properties:Object(fe.wb)(ve)},F&&F.length>0?{elements:F}:null),ae);return b.a.createElement(Ce.a,{language:Ce.b.JSON},JSON.stringify(S,null,4))}try{K.displayName="EventJSON",K.__docgenInfo={description:"",displayName:"EventJSON",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"Record<string, any>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventJSON.tsx#EventJSON"]={docgenInfo:K.__docgenInfo,name:"EventJSON",path:"frontend/src/scenes/events/EventJSON.tsx#EventJSON"})}catch(m){}var Oe=e("./frontend/src/lib/dayjs.ts"),N=e("./frontend/src/lib/components/LemonButton/index.ts");function U(m,a){var _=Object.keys(m);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(m);a&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(m,A).enumerable})),_.push.apply(_,f)}return _}function O(m){for(var a=1;a<arguments.length;a++){var _=arguments[a]!=null?arguments[a]:{};a%2?U(Object(_),!0).forEach(function(f){I()(m,f,_[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(_)):U(Object(_)).forEach(function(f){Object.defineProperty(m,f,Object.getOwnPropertyDescriptor(_,f))})}return m}var ue=ce.a.TabPane;function J(m){for(var a=m.event,_=Object(o.useState)(!1),f=ne()(_,2),A=f[0],R=f[1],ve={},F={},me=0,k=0,ae=Object.keys(a.properties);k<ae.length;k++){var S=ae[k];T.d.event[S]&&T.d.event[S].hide&&(me+=1,A&&(F[S]=a.properties[S])),(!T.d.event[S]||!T.d.event[S].hide)&&(ve[S]=a.properties[S])}return b.a.createElement(ce.a,{"data-attr":"event-details",defaultActiveKey:"properties",style:{float:"left",width:"100%"},tabBarStyle:{margin:0}},b.a.createElement(ue,{tab:"Properties",key:"properties"},b.a.createElement(se.a,{properties:O(O({$timestamp:Object(Oe.a)(a.timestamp).toISOString()},ve),F),useDetectedPropertyType:!0}),me>0&&b.a.createElement(N.a,{className:"mb-05",onClick:function(){return R(!A)},size:"small"},A?"Hide":"Show"," ",Object(fe.qb)(me,"hidden property","hidden properties"))),b.a.createElement(ue,{tab:"JSON",key:"json"},b.a.createElement(K,{event:a})),a.elements&&a.elements.length>0&&b.a.createElement(ue,{tab:"Elements",key:"elements"},b.a.createElement(B.a,{event:a})))}try{J.displayName="EventDetails",J.__docgenInfo={description:"",displayName:"EventDetails",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"EventType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventDetails.tsx#EventDetails"]={docgenInfo:J.__docgenInfo,name:"EventDetails",path:"frontend/src/scenes/events/EventDetails.tsx#EventDetails"})}catch(m){}},"./frontend/src/scenes/events/EventElements.tsx":function(pe,M,e){"use strict";e.d(M,"a",function(){return Y});var G=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),I=e.n(G),te=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),ne=e.n(te),le=e("./node_modules/core-js/modules/es.array.join.js"),ie=e.n(le),q=e("./node_modules/core-js/modules/es.array.fill.js"),Q=e.n(q),re=e("./node_modules/core-js/modules/es.array.slice.js"),X=e.n(re),Z=e("./node_modules/core-js/modules/es.array.map.js"),o=e.n(Z),b=e("./node_modules/core-js/modules/es.object.entries.js"),T=e.n(b),se=e("./node_modules/core-js/modules/es.array.concat.js"),B=e.n(se),ce=e("./node_modules/core-js/modules/es.regexp.exec.js"),Te=e.n(ce),he=e("./node_modules/core-js/modules/es.string.replace.js"),Ce=e.n(he),fe=e("./node_modules/react/index.js"),oe=e.n(fe);function de(K){return Array(K).fill("    ").join("")}function Y(K){var Oe=K.event,N=ne()(Oe.elements||[]).reverse();return N=N.slice(Math.max(N.length-10,1)),oe.a.createElement("div",null,N.map(function(U,O){return oe.a.createElement("pre",{className:"code",key:O,style:{margin:0,padding:0,borderRadius:0,backgroundColor:O===N.length-1?"var(--primary)":void 0}},de(O),"<",U.tag_name,U.attr_id&&' id="'.concat(U.attr_id,'"'),Object.entries(U.attributes).map(function(ue){var J=I()(ue,2),m=J[0],a=J[1];return oe.a.createElement("span",{key:m}," ".concat(m.replace("attr__",""),'="').concat(a,'"'))}),">",U.text,O===N.length-1&&oe.a.createElement("span",null,"</",U.tag_name,">"))}),ne()(N).reverse().slice(1).map(function(U,O){return oe.a.createElement("pre",{className:"code",key:O,style:{margin:0,padding:0,borderRadius:0}},de(N.length-O-2),"</",U.tag_name,">")}))}try{Y.displayName="EventElements",Y.__docgenInfo={description:"",displayName:"EventElements",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"EventType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventElements.tsx#EventElements"]={docgenInfo:Y.__docgenInfo,name:"EventElements",path:"frontend/src/scenes/events/EventElements.tsx#EventElements"})}catch(K){}},"./frontend/src/scenes/events/EventsTable.tsx":function(pe,M,e){"use strict";e.d(M,"a",function(){return H});var G=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),I=e.n(G),te=e("./node_modules/core-js/modules/es.array.splice.js"),ne=e("./node_modules/core-js/modules/es.array.map.js"),le=e("./node_modules/core-js/modules/es.array.find.js"),ie=e("./node_modules/core-js/modules/es.object.to-string.js"),q=e("./node_modules/core-js/modules/es.array.concat.js"),Q=e("./node_modules/core-js/modules/es.array.join.js"),re=e("./node_modules/core-js/modules/es.object.keys.js"),X=e("./node_modules/core-js/modules/es.regexp.to-string.js"),Z=e("./node_modules/react/index.js"),o=e.n(Z),b=e("./node_modules/kea/lib/index.esm.js"),T=e("./frontend/src/scenes/events/EventDetails.tsx"),se=e("./frontend/src/lib/components/Link.tsx"),B=e("./node_modules/antd/es/button/index.js"),ce=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),Te=e.n(ce),he=e("./node_modules/core-js/modules/es.array.filter.js"),Ce=e("./node_modules/core-js/modules/es.symbol.js"),fe=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),oe=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),de=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Y=e("./node_modules/kea-router/lib/index.js"),K=e("./node_modules/@babel/runtime/helpers/typeof.js"),Oe=e.n(K),N=e("./node_modules/core-js/modules/es.regexp.exec.js"),U=e("./node_modules/core-js/modules/es.string.replace.js");function O(l){var u=l.value;return o.a.createElement("span",{title:u},Oe()(u)==="object"?JSON.stringify(u):u&&u.toString().replace(/(^\w+:|^)\/\//,""))}try{O.displayName="Property",O.__docgenInfo={description:"",displayName:"Property",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Property.tsx#Property"]={docgenInfo:O.__docgenInfo,name:"Property",path:"frontend/src/lib/components/Property.tsx#Property"})}catch(l){}var ue=e("./frontend/src/lib/components/PropertyFilters/utils.ts");function J(l,u){var d=Object.keys(l);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(l);u&&(p=p.filter(function(V){return Object.getOwnPropertyDescriptor(l,V).enumerable})),d.push.apply(d,p)}return d}function m(l){for(var u=1;u<arguments.length;u++){var d=arguments[u]!=null?arguments[u]:{};u%2?J(Object(d),!0).forEach(function(p){Te()(l,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(d)):J(Object(d)).forEach(function(p){Object.defineProperty(l,p,Object.getOwnPropertyDescriptor(d,p))})}return l}function a(l){var u=l.property,d=l.value,p=l.filters,V=l.onClick,y=l.className,Ee=Object(ue.c)(p.properties),j=Ee.find(function($){return $.key===u&&$.value===d&&!$.operator})?Ee.filter(function($){return $.key!==u||$.value!==d||$.operator}):[].concat(I()(Ee),[{key:u,value:d}]),be=Object(Y.combineUrl)(window.location.pathname,m(m({},p),{},{properties:j}),{}),_e=be.url;return o.a.createElement(se.a,{to:_e,className:y,onClick:function(){V&&V(u,d)}},o.a.createElement(O,{value:d}))}try{a.displayName="FilterPropertyLink",a.__docgenInfo={description:"",displayName:"FilterPropertyLink",props:{property:{defaultValue:null,description:"",name:"property",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string | number"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((property: string, value: string | number) => void)"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/FilterPropertyLink.tsx#FilterPropertyLink"]={docgenInfo:a.__docgenInfo,name:"FilterPropertyLink",path:"frontend/src/lib/components/FilterPropertyLink.tsx#FilterPropertyLink"})}catch(l){}var _=e("./frontend/src/lib/utils.tsx"),f=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),A=e.n(f),R=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/events/EventsTable.scss"),ve=e.n(R),F={};F.insert="head",F.singleton=!1;var me=A()(ve.a,F),k=ve.a.locals||{},ae=e("./frontend/src/scenes/events/eventsTableLogic.ts"),S=e("./frontend/src/scenes/persons/PersonHeader.tsx"),L=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),De=e("./frontend/src/lib/components/PropertyKeyInfo.tsx"),ge=e("./frontend/src/types.ts"),xe=e("./frontend/src/scenes/actions/EventName.tsx"),Ie=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),Pe=e("./frontend/src/lib/components/Tooltip.tsx"),Be=e("./node_modules/clsx/dist/clsx.m.js"),s=e("./frontend/src/lib/components/ResizableTable/tableConfigLogic.ts"),t=e("./frontend/src/scenes/urls.ts"),n=e("./frontend/src/lib/components/LemonTable/index.ts"),r=e("./frontend/src/lib/components/icons.tsx"),i=e("./frontend/src/lib/components/LemonButton/index.ts"),E=e("./frontend/src/lib/components/LemonButton/More.tsx"),g=e("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),x=e("./frontend/src/scenes/teamLogic.tsx"),W=e("./frontend/src/scenes/events/createActionFromEvent.tsx");function z(l){Object(Z.useEffect)(function(){var u="hidden",d="visibilitychange";typeof document.msHidden!="undefined"?(u="msHidden",d="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(u="webkitHidden",d="webkitvisibilitychange");var p=function(){l(!document[u])};return document.addEventListener(d,p),function(){document.removeEventListener(d,p)}},[])}var w=e("./frontend/src/lib/components/ResizableTable/TableConfig.tsx");function H(l){var u=l.pageKey,d=l.fixedFilters,p=l.fixedColumns,V=l.sceneUrl,y=l.fetchMonths,Ee=y===void 0?12:y,j=l.startingColumns,be=l.showCustomizeColumns,_e=be===void 0?!0:be,$=l.showExport,Ae=$===void 0?!0:$,Ke=l.showAutoload,ye=Ke===void 0?!0:Ke,we=l.showEventFilter,Ze=we===void 0?!0:we,Ve=l.showRowExpanders,ke=Ve===void 0?!0:Ve,$e=l.showActionsButton,qe=$e===void 0?!0:$e,Ye=l.showPersonColumn,et=Ye===void 0?!0:Ye,Je=l.linkPropertiesToFilters,Ne=Je===void 0?!0:Je,tt=Object(b.useValues)(x.a),Ue=tt.currentTeam,ze=Object(ae.a)({fixedFilters:d,key:u,sceneUrl:V||t.a.events(),fetchMonths:Ee}),ee=Object(b.useValues)(ze),Le=ee.properties,nt=ee.eventsFormatted,He=ee.isLoading,rt=ee.hasNext,Ge=ee.isLoadingNext,Me=ee.eventFilter,st=ee.automaticLoadEnabled,ot=ee.exportUrl,at=ee.highlightEvents,lt=ee.months,Qe=Object(b.useValues)(Object(s.a)({startingColumns:j})),Fe=Qe.tableWidth,Se=Qe.selectedColumns,je=Object(b.useActions)(ze),it=je.fetchNextEvents,ct=je.prependNewEvents,dt=je.setEventFilter,ut=je.toggleAutomaticLoad,vt=je.startDownload,mt=je.setPollingActive,pt=je.setProperties,ft=!(d!=null&&d.person_id);z(mt);var Xe=function(c,P){var h=c.date_break,v=c.new_events;return{children:h||(v?o.a.createElement(i.a,{icon:o.a.createElement(r.IconSync,null),style:{borderRadius:0},onClick:function(){return ct()},center:!0,fullWidth:!0},"There are new events. Click here to load them"):"???"),props:{colSpan:P+1,style:v?{padding:0}:void 0}}},Et={title:"Person",key:"person",render:function(c,P){var h,v,D=P.event;return D?ft&&(h=D.person)!==null&&h!==void 0&&(v=h.distinct_ids)!==null&&v!==void 0&&v.length?o.a.createElement(se.a,{to:t.a.person(D.person.distinct_ids[0])},o.a.createElement(S.a,{withIcon:!0,person:D.person})):o.a.createElement(S.a,{withIcon:!0,person:D.person}):{props:{colSpan:0}}}},We=Object(Z.useMemo)(function(){var C=[{title:"Event",key:"event",width:"16rem",render:function(P,h){if(!h.event)return Xe(h,Fe);var v=h.event;return o.a.createElement(De.a,{value:Object(_.f)(v)})}},{title:"URL / Screen",key:"url",width:"4rem",render:function(P,h){var v=h.event;if(!v)return{props:{colSpan:0}};var D=v.properties.$current_url?"$current_url":"$screen_name";return Ne?o.a.createElement(a,{className:"ph-no-capture",property:D,value:v.properties[D],filters:{properties:Le}}):o.a.createElement(O,{value:v.properties[D]})}},{title:o.a.createElement(Pe.a,{title:'This is the "Library" property on events. Sent by the SDK as "$lib"'},"Source"),key:"source",render:function(P,h){var v=h.event;return v?Ne?o.a.createElement(a,{property:"$lib",value:v.properties.$lib,filters:{properties:Le}}):o.a.createElement(O,{value:v.properties.$lib}):{props:{colSpan:0}}}}];return et&&C.splice(1,0,Et),C},[Fe]),_t=Object(Z.useMemo)(function(){var C=Se==="DEFAULT"?I()(We):Se.map(function(c,P){return We.find(function(h){return h.key===c})||{title:De.d.event[c]?De.d.event[c].label:c,key:c,render:function(v,D){var Re=D.event;return Re?Ne?o.a.createElement(a,{className:"ph-no-capture ",property:c,value:Re.properties[c],filters:{properties:Le}}):o.a.createElement(O,{value:Re.properties[c]}):P===0?Xe(D,Fe):{props:{colSpan:0}}}}});return C.push({title:"Time",key:"time",render:function(P,h){var v=h.event;return v?o.a.createElement(L.b,{time:v.timestamp,showSeconds:!0}):{props:{colSpan:0}}}}),qe&&C.push({key:"actions",width:0,render:function(P,h){var v=h.event;if(!v)return{props:{colSpan:0}};var D;return v.event==="$pageview"?D={insight:ge.y.TRENDS,interval:"day",display:ge.i.ActionsLineGraph,actions:[],events:[{id:"$pageview",name:"$pageview",type:"events",order:0,properties:[{key:"$current_url",value:v.properties.$current_url,type:"event"}]}]}:v.event!=="$autocapture"&&(D={insight:ge.y.TRENDS,interval:"day",display:ge.i.ActionsLineGraph,actions:[],events:[{id:v.event,name:v.event,type:"events",order:0,properties:[]}]}),o.a.createElement(E.a,{overlay:o.a.createElement(o.a.Fragment,null,Ue&&o.a.createElement(i.a,{type:"stealth",onClick:function(){return Object(W.a)(Ue.id,v,0,Ue.data_attributes||[])},fullWidth:!0,"data-attr":"events-table-create-action"},"Create action from event"),D&&o.a.createElement(i.a,{type:"stealth",to:t.a.insightNew(D),fullWidth:!0,"data-attr":"events-table-usage"},"Try out in Insights"))})}}),p?C.concat(p):C},[Se]);return o.a.createElement("div",{"data-attr":"manage-events-table"},o.a.createElement("div",{className:"events","data-attr":"events-table"},o.a.createElement("div",{className:"flex pt pb border-top space-x"},Ze?o.a.createElement(xe.b,{value:Me,onChange:function(c){dt(c||"")}}):null,o.a.createElement(Ie.a,{propertyFilters:Le,onChange:pt,pageKey:u,taxonomicPopoverPlacement:"bottom-start",style:{marginBottom:0,marginTop:0},eventNames:Me?[Me]:[],useLemonButton:!0})),ye||_e||Ae?o.a.createElement("div",{className:"space-between-items pt pb border-top"},ye&&o.a.createElement(g.a,{type:"primary",id:"autoload-switch",label:"Automatically load new events",checked:st,onChange:ut}),o.a.createElement("div",{className:"flex space-x-05"},_e&&o.a.createElement(w.a,{immutableColumns:["event","person"],defaultColumns:We.map(function(C){return C.key||""})}),Ae&&ot&&o.a.createElement(Pe.a,{title:"Export up to 10,000 latest events.",placement:"left"},o.a.createElement(i.a,{type:"secondary",icon:o.a.createElement(r.IconExport,{style:{color:"var(--primary)"}}),onClick:vt},"Export")))):null,o.a.createElement(n.a,{dataSource:nt,loading:He,columns:_t,key:Se==="DEFAULT"?"default":Se.join("-"),className:"ph-no-capture",loadingSkeletonRows:20,emptyState:He?void 0:Le.some(function(C){return Object.keys(C).length})||Me?"No events matching filters found in the last ".concat(lt," months!"):o.a.createElement(o.a.Fragment,null,"This project doesn't have any events. If you haven't integrated PostHog yet,"," ",o.a.createElement(se.a,{to:"/project/settings"},"click here to instrument analytics with PostHog in your product"),"."),rowKey:function(c){var P;return c.event?c.event.id+"-"+c.event.event:((P=c.date_break)===null||P===void 0?void 0:P.toString())||""},rowClassName:function(c){return Object(Be.a)({"event-row":c.event,highlighted:c.event&&at[c.event.id],"event-row-is-exception":c.event&&c.event.event==="$exception","event-row-date-separator":c.date_break,"event-row-new":c.new_events})},expandable:ke?{expandedRowRender:function(c){var P=c.event;return P&&o.a.createElement(T.a,{event:P})},rowExpandable:function(c){var P=c.event,h=c.date_break,v=c.new_events;return h||v?-1:!!P}}:void 0}),o.a.createElement(B.a,{type:"primary",onClick:it,loading:Ge,style:{display:rt||Ge?"block":"none",margin:"2rem auto 1rem"}},"Load more events")))}try{H.displayName="EventsTable",H.__docgenInfo={description:"",displayName:"EventsTable",props:{pageKey:{defaultValue:null,description:"",name:"pageKey",required:!0,type:{name:"string"}},fixedFilters:{defaultValue:null,description:"",name:"fixedFilters",required:!1,type:{name:"FixedFilters"}},fixedColumns:{defaultValue:null,description:"",name:"fixedColumns",required:!1,type:{name:"LemonTableColumn<EventsTableRowItem, keyof EventsTableRowItem>[]"}},sceneUrl:{defaultValue:null,description:"",name:"sceneUrl",required:!1,type:{name:"string"}},fetchMonths:{defaultValue:{value:"12"},description:"",name:"fetchMonths",required:!1,type:{name:"number"}},startingColumns:{defaultValue:null,description:"",name:"startingColumns",required:!1,type:{name:"ColumnChoice"}},showCustomizeColumns:{defaultValue:{value:"true"},description:"",name:"showCustomizeColumns",required:!1,type:{name:"boolean"}},showExport:{defaultValue:{value:"true"},description:"",name:"showExport",required:!1,type:{name:"boolean"}},showAutoload:{defaultValue:{value:"true"},description:"",name:"showAutoload",required:!1,type:{name:"boolean"}},showEventFilter:{defaultValue:{value:"true"},description:"",name:"showEventFilter",required:!1,type:{name:"boolean"}},showRowExpanders:{defaultValue:{value:"true"},description:"",name:"showRowExpanders",required:!1,type:{name:"boolean"}},showActionsButton:{defaultValue:{value:"true"},description:"",name:"showActionsButton",required:!1,type:{name:"boolean"}},showPersonColumn:{defaultValue:{value:"true"},description:"",name:"showPersonColumn",required:!1,type:{name:"boolean"}},linkPropertiesToFilters:{defaultValue:{value:"true"},description:"",name:"linkPropertiesToFilters",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/events/EventsTable.tsx#EventsTable"]={docgenInfo:H.__docgenInfo,name:"EventsTable",path:"frontend/src/scenes/events/EventsTable.tsx#EventsTable"})}catch(l){}},"./frontend/src/scenes/events/eventsTableLogic.ts":function(pe,M,e){"use strict";e.d(M,"a",function(){return Be});var G=e("./node_modules/core-js/modules/es.object.keys.js"),I=e.n(G),te=e("./node_modules/core-js/modules/es.symbol.js"),ne=e.n(te),le=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),ie=e.n(le),q=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Q=e.n(q),re=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),X=e.n(re),Z=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=e.n(Z),b=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),T=e.n(b),se=e("./node_modules/@babel/runtime/regenerator/index.js"),B=e.n(se),ce=e("./node_modules/core-js/modules/es.array.map.js"),Te=e.n(ce),he=e("./node_modules/core-js/modules/es.object.to-string.js"),Ce=e.n(he),fe=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),oe=e.n(fe),de=e("./node_modules/core-js/modules/es.array.splice.js"),Y=e.n(de),K=e("./node_modules/core-js/modules/es.array.join.js"),Oe=e.n(K),N=e("./node_modules/core-js/modules/es.array.filter.js"),U=e.n(N),O=e("./node_modules/core-js/modules/es.array.concat.js"),ue=e.n(O),J=e("./node_modules/core-js/modules/es.array.iterator.js"),m=e.n(J),a=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),_=e.n(a),f=e("./node_modules/kea/lib/index.esm.js"),A=e("./frontend/src/lib/utils.tsx"),R=e("./node_modules/kea-router/lib/index.js"),ve=e.n(R),F=e("./frontend/src/lib/api.ts"),me=e("./frontend/src/scenes/teamLogic.tsx"),k=e("./frontend/src/lib/dayjs.ts"),ae=e("./frontend/src/lib/components/lemonToast.tsx");function S(s,t){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),n.push.apply(n,r)}return n}function L(s){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?S(Object(n),!0).forEach(function(r){o()(s,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(n,r))})}return s}var De=5,ge=365,xe=5e3,Ie=function(t,n){var r=[];return r=t.map(function(i){return{event:i}}),r.forEach(function(i,E){var g=r[E-1];E>0&&i.event&&g.event&&!Object(k.a)(i.event.timestamp).isSame(g.event.timestamp,"day")&&r.splice(E,0,{date_break:Object(k.a)(i.event.timestamp).format("LL")})}),n.length>0&&r.splice(0,0,{new_events:!0}),r},Pe=function(t){return Object(k.b)().subtract(t,"day").toISOString()},Be=Object(f.kea)({path:function(t){return["scenes","events","eventsTableLogic",t]},props:{},key:function(t){return[t.fixedFilters?JSON.stringify(t.fixedFilters):"all",t.key,t.sceneUrl].filter(function(n){return!!n}).join("-")},connect:{values:[me.a,["currentTeamId"]]},actions:{setPollingActive:function(t){return{pollingActive:t}},setProperties:function(t){return Array.isArray(t)?t.length===0?{properties:[{}]}:{properties:t}:{properties:[t]}},fetchEvents:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return{nextParams:t}},fetchEventsSuccess:function(t){return t},fetchNextEvents:!0,fetchOrPollFailure:function(t){return{error:t}},pollEvents:!0,pollEventsSuccess:function(t){return{events:t}},prependEvents:function(t){return{events:t}},prependNewEvents:!0,setSelectedEvent:function(t){return{selectedEvent:t}},setPollTimeout:function(t){return{pollTimeout:t}},setEventFilter:function(t){return{event:t}},toggleAutomaticLoad:function(t){return{automaticLoadEnabled:t}},noop:function(t){return t},startDownload:!0},reducers:{pollingIsActive:[!0,{setPollingActive:function(t,n){var r=n.pollingActive;return r},pollEventsSuccess:function(t,n){var r=n.events;return r&&r.length?!1:t},prependNewEvents:function(){return!0},toggleAutomaticLoad:function(){return!0}}],properties:[[],{setProperties:function(t,n){var r=n.properties;return Object(A.s)(r)}}],eventFilter:["",{setEventFilter:function(t,n){var r=n.event;return r}}],isLoading:[!0,{fetchEvents:function(){return!0},fetchEventsSuccess:function(){return!1},fetchOrPollFailure:function(){return!1}}],isLoadingNext:[!1,{fetchNextEvents:function(){return!0},fetchEventsSuccess:function(){return!1}}],events:[[],{fetchEventsSuccess:function(t,n){var r=n.events,i=n.isNext;return i?[].concat(T()(t),T()(r)):r},prependEvents:function(t,n){var r=n.events;return[].concat(T()(r),T()(t))}}],hasNext:[!1,{fetchEvents:function(){return!1},fetchNextEvents:function(){return!1},fetchEventsSuccess:function(t,n){var r=n.hasNext;return r}}],orderBy:["-timestamp",{}],selectedEvent:[null,{setSelectedEvent:function(t,n){var r=n.selectedEvent;return r}}],newEvents:[[],{setProperties:function(){return[]},pollEventsSuccess:function(t,n){var r=n.events;return r||[]},prependEvents:function(){return[]}}],highlightEvents:[{},{prependEvents:function(t,n){var r=n.events;return r.reduce(function(i,E){return i[E.id]=!0,i},{})}}],pollTimeout:[0,{setPollTimeout:function(t,n){return n.pollTimeout}}],automaticLoadEnabled:[!1,{persist:!0},{toggleAutomaticLoad:function(t,n){var r=n.automaticLoadEnabled;return r}}]},selectors:function(t){var n=t.selectors,r=t.props;return{eventsFormatted:[function(){return[n.events,n.newEvents]},function(i,E){return Ie(i,E)}],exportUrl:[function(){return[n.currentTeamId,n.eventFilter,n.orderBy,n.properties,n.minimumQueryDate]},function(i,E,g,x,W){var z;return"/api/projects/".concat(i,"/events.csv?").concat(Object(A.zb)(L(L(L({},r.fixedFilters||{}),{},{properties:[].concat(T()(x),T()(((z=r.fixedFilters)===null||z===void 0?void 0:z.properties)||[]))},E?{event:E}:{}),{},{orderBy:[g],after:W})))}],months:[function(){return[function(i,E){return E.fetchMonths}]},function(i){return i||12}],minimumQueryDate:[function(){return[n.months]},function(i){return Object(k.b)().subtract(i,"months").toISOString()}],pollAfter:[function(){return[n.events]},function(i){return(i==null?void 0:i.length)>0&&i[0].timestamp?i[0].timestamp:Pe(0)}]}},actionToUrl:function(t){var n=t.values;return{setProperties:function(){return[R.router.values.location.pathname,L(L({},R.router.values.searchParams),{},{properties:n.properties.length===0?void 0:n.properties}),R.router.values.hashParams,{replace:!0}]},setEventFilter:function(){return[R.router.values.location.pathname,L(L({},R.router.values.searchParams),{},{eventFilter:n.eventFilter}),R.router.values.hashParams,{replace:!0}]}}},urlToAction:function(t){var n=t.actions,r=t.values,i=t.props;return o()({},i.sceneUrl,function(E,g){n.setProperties(g.properties||r.properties||{}),g.eventFilter&&n.setEventFilter(g.eventFilter)})},events:function(t){var n=t.values;return{beforeUnmount:function(){return clearTimeout(n.pollTimeout||void 0)}}},listeners:function(t){var n=t.actions,r=t.values,i=t.props;return{startDownload:function(){ae.b.success("The export is starting. It should finish soon"),window.location.href=r.exportUrl},setProperties:function(){return n.fetchEvents()},setEventFilter:function(){return n.fetchEvents()},fetchNextEvents:function(){var E=X()(B.a.mark(function x(){var W;return B.a.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:W=r.events,W.length===0?n.fetchEvents():n.fetchEvents({before:W[W.length-1].timestamp});case 2:case"end":return w.stop()}},x)}));function g(){return E.apply(this,arguments)}return g}(),fetchEvents:function(){var E=X()(B.a.mark(function x(W,z){var w,H,l,u,d,p,V,y;return B.a.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(d=function(){return d=X()(B.a.mark(function _e($){var Ae;return B.a.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:return Ae=L(L(L(L({after:$},i.fixedFilters||{}),{},{properties:l},H||{}),r.eventFilter?{event:r.eventFilter}:{}),{},{orderBy:[r.orderBy]}),ye.abrupt("return",F.b.get("api/projects/".concat(r.currentTeamId,"/events/?").concat(Object(A.zb)(Ae))));case 2:case"end":return ye.stop()}},_e)})),d.apply(this,arguments)},u=function(_e){return d.apply(this,arguments)},H=W.nextParams,clearTimeout(r.pollTimeout),!(r.events.length>0)){j.next=9;break}return j.next=7,z(300);case 7:j.next=11;break;case 9:return j.next=11,z(1);case 11:return l=[].concat(T()(r.properties),T()(((w=i.fixedFilters)===null||w===void 0?void 0:w.properties)||[])),p=null,V=!1,j.prev=14,j.next=17,u(Pe(De));case 17:if(p=j.sent,p.results.length!==0){j.next=23;break}return j.next=21,u(Pe(ge));case 21:p=j.sent,V=!0;case 23:j.next=29;break;case 25:return j.prev=25,j.t0=j.catch(14),n.fetchOrPollFailure(j.t0),j.abrupt("return");case 29:z(),n.fetchEventsSuccess({events:p.results,hasNext:!!p.next||!V,isNext:!!H}),y=window.setTimeout(n.pollEvents,xe),n.setPollTimeout(y);case 33:case"end":return j.stop()}},x,null,[[14,25]])}));function g(x,W){return E.apply(this,arguments)}return g}(),pollEvents:function(){var E=X()(B.a.mark(function x(W,z){var w,H,l,u,d,p;return B.a.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(H=function(){var j=window.setTimeout(n.pollEvents,xe);n.setPollTimeout(j)},r.orderBy==="-timestamp"){y.next=3;break}return y.abrupt("return");case 3:if(i.sceneUrl===R.router.values.location.pathname){y.next=5;break}return y.abrupt("return");case 5:if(r.pollingIsActive){y.next=8;break}return H(),y.abrupt("return");case 8:return l=[].concat(T()(r.properties),T()(((w=i.fixedFilters)===null||w===void 0?void 0:w.properties)||[])),u=L(L(L({},i.fixedFilters||{}),{},{properties:l},r.eventFilter?{event:r.eventFilter}:{}),{},{orderBy:[r.orderBy],after:r.pollAfter}),d=Object(A.zb)(u),p=null,y.prev=12,y.next=15,F.b.get("api/projects/".concat(r.currentTeamId,"/events/?").concat(d));case 15:p=y.sent,y.next=21;break;case 18:return y.prev=18,y.t0=y.catch(12),y.abrupt("return");case 21:z(),r.automaticLoadEnabled?n.prependEvents(p.results):n.pollEventsSuccess(p.results),H();case 24:case"end":return y.stop()}},x,null,[[12,18]])}));function g(x,W){return E.apply(this,arguments)}return g}(),prependNewEvents:function(){r.newEvents.length&&n.prependEvents(r.newEvents)},fetchOrPollFailure:function(g){var x=g.error;ae.b.error("There was a problem fetching your events: ".concat(x.statusText))},toggleAutomaticLoad:function(g){var x=g.automaticLoadEnabled;x&&n.prependNewEvents()}}}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/events/EventsTable.scss":function(pe,M,e){var G=e("./node_modules/css-loader/dist/runtime/api.js");M=G(!1),M.push([pe.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.events .events-table-button-clear{padding:0 4px;margin-left:4px}.events .events-table-button-clear.visible,.events .events-table-button-clear:focus,.events .events-table-button-clear:hover{border:1px solid #5375ff}.events .event-row-new{height:2.5rem}.events .event-row-date-separator{background-color:var(--bg-mid);color:var(--text-muted);font-weight:600;font-size:.75rem;height:2rem;text-align:center}.events .event-row-is-exception{background-color:#fffaf8}.events td{max-width:20rem}",""]),pe.exports=M}}]);
