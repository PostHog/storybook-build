(window.webpackJsonp=window.webpackJsonp||[]).push([[249],{"./frontend/src/lib/components/Table/utils.tsx":function(te,D,e){"use strict";e.d(D,"a",function(){return M});var C=e("./node_modules/react/index.js"),G=e.n(C),b=e("./frontend/src/lib/hooks/useWindowSize.js"),Y=e("./frontend/src/lib/utils/responsiveUtils.tsx");function M(y){return G.a.createElement("span",{style:{whiteSpace:"nowrap"}},y)}var R=function(H){var p=Object(b.a)(),n=p.width,m=Object(Y.b)(H),v=!!n&&n<=m;return{isTableScrolling:v,tableScrollBreakpoint:m,tableScrollX:v?"max-content":"".concat(m,"px")}};try{M.displayName="normalizeColumnTitle",M.__docgenInfo={description:"",displayName:"normalizeColumnTitle",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Table/utils.tsx#normalizeColumnTitle"]={docgenInfo:M.__docgenInfo,name:"normalizeColumnTitle",path:"frontend/src/lib/components/Table/utils.tsx#normalizeColumnTitle"})}catch(y){}try{R.displayName="useIsTableScrolling",R.__docgenInfo={description:"",displayName:"useIsTableScrolling",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Table/utils.tsx#useIsTableScrolling"]={docgenInfo:R.__docgenInfo,name:"useIsTableScrolling",path:"frontend/src/lib/components/Table/utils.tsx#useIsTableScrolling"})}catch(y){}},"./frontend/src/scenes/feature-flags/FeatureFlags.tsx":function(te,D,e){"use strict";e.r(D),e.d(D,"scene",function(){return B}),e.d(D,"FeatureFlags",function(){return K}),e.d(D,"groupFilters",function(){return I});var C=e("./node_modules/core-js/modules/es.array.includes.js"),G=e.n(C),b=e("./node_modules/core-js/modules/es.array.some.js"),Y=e.n(b),M=e("./node_modules/core-js/modules/es.function.name.js"),R=e.n(M),y=e("./node_modules/core-js/modules/es.number.constructor.js"),H=e.n(y),p=e("./node_modules/react/index.js"),n=e.n(p),m=e("./node_modules/kea/lib/index.esm.js"),v=e("./frontend/src/scenes/feature-flags/featureFlagsLogic.ts"),$=e("./node_modules/antd/es/input/index.js"),F=e("./node_modules/antd/es/tabs/index.js"),J=e("./frontend/src/lib/components/Link.tsx"),X=e("./frontend/src/lib/utils.tsx"),Q=e("./frontend/src/lib/components/PageHeader.tsx"),ne=e("./frontend/src/lib/components/Table/utils.tsx"),L=e("./frontend/src/scenes/urls.ts"),ae=e("./frontend/src/lib/utils/stringWithWBR.tsx"),Z=e("./frontend/src/scenes/teamLogic.ts"),j=e("./frontend/src/lib/components/LemonButton/index.ts"),w=e("./frontend/src/lib/components/LemonRow/index.ts"),re=e("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),k=e("./frontend/src/lib/components/LemonTable/index.ts"),S=e("./frontend/src/lib/components/LemonButton/More.tsx"),x=e("./frontend/src/lib/components/LemonTable/columnUtils.tsx"),W=e("./frontend/src/lib/components/PropertyFilters/components/PropertyFiltersDisplay.tsx"),V=e("./frontend/src/lib/logic/featureFlagLogic.ts"),g=e("./frontend/src/lib/constants.tsx"),q=e("./frontend/src/lib/components/ActivityLog/ActivityLog.tsx"),se=e("./frontend/src/scenes/feature-flags/activityDescriptions.tsx"),ee=e("./frontend/src/lib/components/ActivityLog/humanizeActivity.tsx"),B={component:K,logic:v.a};function N(){var E=Object(m.useValues)(Z.a),P=E.currentTeamId,l=Object(m.useValues)(v.a),h=l.featureFlagsLoading,f=l.searchedFeatureFlags,O=l.searchTerm,c=Object(m.useActions)(v.a),z=c.updateFeatureFlag,r=c.loadFeatureFlags,a=c.setSearchTerm,s=Object(m.useValues)(V.a),o=s.featureFlags,_=o[g.i.FEATURE_FLAGS_ACTIVITY_LOG],i=[{title:Object(ne.a)("Key"),dataIndex:"key",className:"ph-no-capture",sticky:!0,width:"40%",sorter:function(u,t){return(u.key||"").localeCompare(t.key||"")},render:function(u,t){return n.a.createElement(n.a.Fragment,null,n.a.createElement(J.a,{to:t.id?L.a.featureFlag(t.id):void 0,className:"row-name"},Object(ae.a)(t.key,17)),t.name&&n.a.createElement("span",{className:"row-description"},t.name))}},Object(x.b)(),Object(x.a)(),{title:"Rollout",width:200,render:function(u,t){return I(t.filters.groups)}},{title:"Status",dataIndex:"active",sorter:function(u,t){return Number(u.active)-Number(t.active)},width:100,render:function(u,t){var T="feature-flag-".concat(t.id,"-switch");return n.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},n.a.createElement("label",{htmlFor:T},t.active?"Enabled":"Disabled"),n.a.createElement(re.a,{id:T,checked:t.active,onChange:function(A){return t.id?z({id:t.id,payload:{active:A}}):null},style:{marginLeft:"0.5rem"}}))}},{width:0,render:function(u,t){return n.a.createElement(S.a,{overlay:n.a.createElement(n.a.Fragment,null,n.a.createElement(j.a,{type:"stealth",onClick:function(){Object(X.t)(t.key,"feature flag key")},fullWidth:!0},"Copy key"),t.id&&n.a.createElement(j.a,{type:"stealth",to:L.a.featureFlag(t.id),fullWidth:!0},"Edit"),n.a.createElement(j.a,{type:"stealth",to:L.a.insightNew({events:[{id:"$pageview",name:"$pageview",type:"events",math:"dau"}],breakdown_type:"event",breakdown:"$feature/".concat(t.key)}),"data-attr":"usage",fullWidth:!0},"Try out in Insights"),n.a.createElement(w.b,null),t.id&&n.a.createElement(j.a,{type:"stealth",style:{color:"var(--danger)"},onClick:function(){Object(X.x)({endpoint:"projects/".concat(P,"/feature_flags"),object:{name:t.key,id:t.id},callback:r})},fullWidth:!0},"Delete feature flag"))})}}];return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",null,n.a.createElement($.a.Search,{placeholder:"Search for feature flags",allowClear:!0,enterButton:!0,style:{maxWidth:400,width:"initial",flexGrow:1,marginBottom:"1rem"},value:O,onChange:function(u){a(u.target.value)}}),!_&&n.a.createElement("div",{className:"mb float-right"},n.a.createElement(j.a,{type:"primary",to:L.a.featureFlag("new"),"data-attr":"new-feature-flag"},"New feature flag"))),n.a.createElement(k.a,{dataSource:f,columns:i,rowKey:"key",loading:h,defaultSorting:{columnKey:"key",order:1},pagination:{pageSize:100},nouns:["feature flag","feature flags"],"data-attr":"feature-flag-table"}))}function K(){var E=Object(m.useValues)(V.a),P=E.featureFlags,l=P[g.i.FEATURE_FLAGS_ACTIVITY_LOG],h=Object(m.useValues)(v.a),f=h.activeTab,O=Object(m.useActions)(v.a),c=O.setActiveTab;return n.a.createElement("div",{className:"feature_flags"},n.a.createElement(Q.a,{title:"Feature Flags",caption:l?"":"Feature Flags are a way of turning functionality in your app on or off, based on user properties.",buttons:l?n.a.createElement(j.a,{type:"primary",to:L.a.featureFlag("new"),"data-attr":"new-feature-flag"},"New feature flag"):!1}),l?n.a.createElement(F.a,{activeKey:f,destroyInactiveTabPane:!0,onChange:function(r){return c(r)}},n.a.createElement(F.a.TabPane,{tab:"Overview",key:"overview"},n.a.createElement(N,null)),n.a.createElement(F.a.TabPane,{tab:"History",key:"history"},n.a.createElement(q.a,{scope:ee.a.FEATURE_FLAG,describer:se.b}))):n.a.createElement(N,null))}function I(E){if(E.length===0||!E.some(function(O){return O.rollout_percentage!==0}))return"No users";if(E.some(function(O){var c;return!(!((c=O.properties)===null||c===void 0)&&c.length)&&[null,void 0,100].includes(O.rollout_percentage)}))return"All users";if(E.length===1){var P=E[0],l=P.properties,h=P.rollout_percentage,f=h===void 0?null:h;return(l==null?void 0:l.length)>0&&f!=null?n.a.createElement("div",{style:{display:"flex",alignItems:"center"}},n.a.createElement("span",{style:{flexShrink:0,marginRight:5}},f,"% of"),n.a.createElement(W.a,{filters:l,style:{margin:0,width:"100%"}})):(l==null?void 0:l.length)>0?n.a.createElement(W.a,{filters:l,style:{margin:0}}):f!==null?"".concat(f,"% of all users"):(console.error("A group with full rollout was not detected early"),"All users")}return"".concat(E.length," groups")}try{I.displayName="groupFilters",I.__docgenInfo={description:"",displayName:"groupFilters",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlags.tsx#groupFilters"]={docgenInfo:I.__docgenInfo,name:"groupFilters",path:"frontend/src/scenes/feature-flags/FeatureFlags.tsx#groupFilters"})}catch(E){}},"./frontend/src/scenes/feature-flags/featureFlagsLogic.ts":function(te,D,e){"use strict";e.d(D,"a",function(){return z});var C=e("./node_modules/core-js/modules/es.array.concat.js"),G=e.n(C),b=e("./node_modules/core-js/modules/es.array.filter.js"),Y=e.n(b),M=e("./node_modules/core-js/modules/es.array.find.js"),R=e.n(M),y=e("./node_modules/core-js/modules/es.array.includes.js"),H=e.n(y),p=e("./node_modules/core-js/modules/es.array.iterator.js"),n=e.n(p),m=e("./node_modules/core-js/modules/es.array.map.js"),v=e.n(m),$=e("./node_modules/core-js/modules/es.object.to-string.js"),F=e.n($),J=e("./node_modules/core-js/modules/es.object.values.js"),X=e.n(J),Q=e("./node_modules/core-js/modules/es.regexp.exec.js"),ne=e.n(Q),L=e("./node_modules/core-js/modules/es.string.includes.js"),ae=e.n(L),Z=e("./node_modules/core-js/modules/es.string.search.js"),j=e.n(Z),w=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),re=e.n(w),k=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),S=e.n(k),x=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),W=e.n(x),V=e("./node_modules/@babel/runtime/regenerator/index.js"),g=e.n(V),q=e("./node_modules/regenerator-runtime/runtime.js"),se=e.n(q),ee=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),B=e.n(ee),N=e("./node_modules/kea/lib/index.esm.js"),K=e("./frontend/src/lib/api.ts"),I=e("./node_modules/fuse.js/dist/fuse.esm.js"),E=e("./frontend/src/scenes/teamLogic.ts"),P=e("./frontend/src/scenes/urls.ts"),l=e("./node_modules/kea-router/lib/index.js"),h=e.n(l);function f(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);a&&(o=o.filter(function(_){return Object.getOwnPropertyDescriptor(r,_).enumerable})),s.push.apply(s,o)}return s}function O(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?f(Object(s),!0).forEach(function(o){S()(r,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):f(Object(s)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(s,o))})}return r}var c;(function(r){r.OVERVIEW="overview",r.HISTORY="history"})(c||(c={}));var z=Object(N.kea)({path:["scenes","feature-flags","featureFlagsLogic"],connect:{values:[E.a,["currentTeamId"]]},actions:{updateFlag:function(a){return{flag:a}},deleteFlag:function(a){return{id:a}},setSearchTerm:function(a){return{searchTerm:a}},setActiveTab:function(a){return{tabKey:a}}},loaders:function(a){var s=a.values;return{featureFlags:{__default:[],loadFeatureFlags:function(){var o=B()(g.a.mark(function i(){var d;return g.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,K.b.get("api/projects/".concat(s.currentTeamId,"/feature_flags/"));case 2:return d=t.sent,t.abrupt("return",d.results);case 4:case"end":return t.stop()}},i)}));function _(){return o.apply(this,arguments)}return _}(),updateFeatureFlag:function(){var o=B()(g.a.mark(function i(d){var u,t,T;return g.a.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return u=d.id,t=d.payload,A.next=3,K.b.update("api/projects/".concat(s.currentTeamId,"/feature_flags/").concat(u),t);case 3:return T=A.sent,A.abrupt("return",W()(s.featureFlags).map(function(oe){return oe.id===T.id?T:oe}));case 5:case"end":return A.stop()}},i)}));function _(i){return o.apply(this,arguments)}return _}()}}},selectors:{searchedFeatureFlags:[function(r){return[r.featureFlags,r.searchTerm]},function(r,a){return a?new I.a(r,{keys:["key","name"],threshold:.3}).search(a).map(function(s){return s.item}):r}],breadcrumbs:[function(){return[]},function(){return[{name:"Feature Flags",path:P.a.featureFlags()}]}]},reducers:{searchTerm:{setSearchTerm:function(a,s){var o=s.searchTerm;return o}},featureFlags:{updateFlag:function(a,s){var o=s.flag;return a.find(function(_){var i=_.id;return i===o.id})?a.map(function(_){return _.id===o.id?o:_}):[o].concat(W()(a))},deleteFlag:function(a,s){var o=s.id;return a.filter(function(_){return _.id!==o})}},activeTab:[c.OVERVIEW,{setActiveTab:function(a,s){var o=s.tabKey;return Object.values(c).includes(o)?o:a}}]},actionToUrl:function(a){var s=a.values;return{setActiveTab:function(){var _=O({},l.router.values.searchParams),i=!1;return!_.tab&&s.activeTab===c.OVERVIEW&&(i=!0),_.tab=s.activeTab,[l.router.values.location.pathname,_,l.router.values.hashParams,{replace:i}]}}},urlToAction:function(a){var s=a.actions,o=a.values;return S()({},P.a.featureFlags(),function(){var _=B()(g.a.mark(function i(d,u){var t;return g.a.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:t=u.tab,t?t!==o.activeTab&&s.setActiveTab(t):o.activeTab!==c.OVERVIEW&&s.setActiveTab(c.OVERVIEW);case 2:case"end":return U.stop()}},i)}));return function(i,d){return _.apply(this,arguments)}}())},events:function(a){var s=a.actions;return{afterMount:function(){s.loadFeatureFlags()}}}})}}]);
