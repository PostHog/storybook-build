(window.webpackJsonp=window.webpackJsonp||[]).push([[282],{"./frontend/src/lib/introductions/GroupsIntroductionOption.tsx":function(P,E,n){"use strict";n.d(E,"a",function(){return _});var N=n("./node_modules/core-js/modules/es.array.includes.js"),W=n.n(N),je=n("./node_modules/core-js/modules/es.string.includes.js"),We=n.n(je),be=n("./node_modules/react/index.js"),w=n.n(be),C=n("./node_modules/kea/lib/index.esm.js"),t=n("./node_modules/@ant-design/icons/es/icons/LockOutlined.js"),G=n("./node_modules/rc-select/es/index.js"),I=n("./frontend/src/lib/components/Link.tsx"),y=n("./frontend/src/lib/introductions/groupsAccessLogic.ts");function _(Y){var J=Y.value,ue=Object(C.useValues)(y.b),z=ue.groupsAccessStatus;return[y.a.HasAccess,y.a.HasGroupTypes,y.a.NoAccess].includes(z)?w.a.createElement(G.c.Option,{key:"groups",value:J,disabled:!0,style:{height:"100%",width:"100%",overflow:"hidden",textOverflow:"ellipsis",backgroundColor:"var(--side)",color:"var(--muted)"}},w.a.createElement(t.a,{style:{marginRight:6,color:"var(--warning)"}}),"Unique groups \u2013"," ",w.a.createElement(I.a,{to:"https://posthog.com/docs/user-guides/group-analytics?utm_medium=in-product&utm_campaign=group-analytics-learn-more",target:"_blank","data-attr":"group-analytics-learn-more",className:"font-semibold"},"Learn more")):null}try{_.displayName="GroupsIntroductionOption",_.__docgenInfo={description:"",displayName:"GroupsIntroductionOption",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"]={docgenInfo:_.__docgenInfo,name:"GroupsIntroductionOption",path:"frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"})}catch(Y){}},"./frontend/src/scenes/feature-flags/FeatureFlag.tsx":function(P,E,n){"use strict";n.r(E),n.d(E,"scene",function(){return xt}),n.d(E,"FeatureFlag",function(){return $});var N=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),W=n.n(N),je=n("./node_modules/core-js/modules/es.array.map.js"),We=n("./node_modules/core-js/modules/es.object.to-string.js"),be=n("./node_modules/core-js/modules/es.regexp.to-string.js"),w=n("./node_modules/core-js/modules/es.array.concat.js"),C=n("./node_modules/react/index.js"),t=n.n(C),G=n("./node_modules/kea-forms/lib/index.js"),I=n("./node_modules/antd/es/row/index.js"),y=n("./node_modules/antd/es/col/index.js"),_=n("./node_modules/antd/es/popconfirm/index.js"),Y=n("./node_modules/antd/es/radio/index.js"),J=n("./node_modules/antd/es/button/index.js"),ue=n("./node_modules/antd/es/slider/index.js"),z=n("./node_modules/antd/es/input-number/index.js"),B=n("./node_modules/antd/es/select/index.js"),ce=n("./node_modules/antd/es/card/index.js"),h=n("./node_modules/kea/lib/index.esm.js"),k=n("./frontend/src/lib/utils.tsx"),we=n("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),Ye=n("./node_modules/@ant-design/icons/es/icons/LockOutlined.js"),Ce=n("./node_modules/@ant-design/icons/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),Je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482.2 508.4L331.3 389c-3-2.4-7.3-.2-7.3 3.6V478H184V184h204v128c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V144c0-15.5-12.5-28-28-28H144c-15.5 0-28 12.5-28 28v736c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v128H184V546h140v85.4c0 3.8 4.4 6 7.3 3.6l150.9-119.4a4.5 4.5 0 000-7.2zM880 116H596c-15.5 0-28 12.5-28 28v168c0 2.2 1.8 4 4 4h60c2.2 0 4-1.8 4-4V184h204v294H700v-85.4c0-3.8-4.3-6-7.3-3.6l-151 119.4a4.52 4.52 0 000 7.1l151 119.5c2.9 2.3 7.3.2 7.3-3.6V546h140v294H636V712c0-2.2-1.8-4-4-4h-60c-2.2 0-4 1.8-4 4v168c0 15.5 12.5 28 28 28h284c15.5 0 28-12.5 28-28V144c0-15.5-12.5-28-28-28z"}}]},name:"merge-cells",theme:"outlined"},ze=Je,ke=n("./node_modules/@ant-design/icons/es/components/AntdIcon.js"),Ie=function(e,o){return C.createElement(ke.a,Object(Ce.a)(Object(Ce.a)({},e),{},{ref:o,icon:ze}))};Ie.displayName="MergeCellsOutlined";var Xe=C.forwardRef(Ie),Qe=n("./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js"),zt=n("./node_modules/core-js/modules/es.object.keys.js"),kt=n("./node_modules/core-js/modules/es.symbol.js"),Xt=n("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Qt=n("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Ze=n("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),qe=n.n(Ze),et=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),X=n.n(et),tt=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),x=n.n(tt),at=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),xe=n.n(at),nt=n("./node_modules/@babel/runtime/regenerator/index.js"),T=n.n(nt),Zt=n("./node_modules/core-js/modules/es.regexp.exec.js"),qt=n("./node_modules/core-js/modules/es.string.match.js"),ea=n("./node_modules/core-js/modules/es.array.splice.js"),ta=n("./node_modules/core-js/modules/web.dom-collections.for-each.js"),aa=n("./node_modules/core-js/modules/es.array.iterator.js"),na=n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),ra=n("./node_modules/core-js/modules/es.string.replace.js"),oa=n("./node_modules/core-js/modules/es.function.name.js"),sa=n("./node_modules/core-js/modules/es.array.filter.js"),la=n("./node_modules/core-js/modules/es.array.find.js"),de=n("./frontend/src/lib/api.ts"),fe=n("./node_modules/kea-router/lib/index.js"),H=n("./frontend/src/scenes/urls.ts"),Te=n("./frontend/src/scenes/teamLogic.tsx"),Q=n("./frontend/src/scenes/feature-flags/featureFlagsLogic.ts"),Ae=n("./frontend/src/models/groupsModel.ts"),Le=n("./frontend/src/lib/components/TaxonomicFilter/types.ts"),rt=n("./frontend/src/lib/components/lemonToast.tsx"),ot=n("./frontend/src/lib/utils/eventUsageLogic.ts"),st=n("./node_modules/kea-loaders/lib/index.js"),lt=["created_at","id"];function Pe(a,e){var o=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),o.push.apply(o,r)}return o}function s(a){for(var e=1;e<arguments.length;e++){var o=arguments[e]!=null?arguments[e]:{};e%2?Pe(Object(o),!0).forEach(function(r){xe()(a,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):Pe(Object(o)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(o,r))})}return a}var me={id:null,created_at:null,key:"",name:"",filters:{groups:[{properties:[],rollout_percentage:null}],multivariate:null},deleted:!1,active:!0,created_by:null,is_simple_flag:!1,rollout_percentage:null,ensure_experience_continuity:!1,experiment_set:null},it={key:"",name:"",rollout_percentage:0},ut={variants:[{key:"",name:"",rollout_percentage:100}]},Z=Object(h.kea)([Object(h.path)(["scenes","feature-flags","featureFlagLogic"]),Object(h.props)({}),Object(h.key)(function(a){var e=a.id;return e!=null?e:"unknown"}),Object(h.connect)({values:[Te.a,["currentTeamId"],Ae.a,["groupTypes","groupsTaxonomicTypes","aggregationLabel"]]}),Object(h.actions)({setFeatureFlag:function(e){return{featureFlag:e}},setFeatureFlagMissing:!0,addConditionSet:!0,setAggregationGroupTypeIndex:function(e){return{value:e}},removeConditionSet:function(e){return{index:e}},duplicateConditionSet:function(e){return{index:e}},updateConditionSet:function(e,o,r){return{index:e,newRolloutPercentage:o,newProperties:r}},deleteFeatureFlag:function(e){return{featureFlag:e}},setMultivariateEnabled:function(e){return{enabled:e}},setMultivariateOptions:function(e){return{multivariateOptions:e}},addVariant:!0,removeVariant:function(e){return{index:e}},distributeVariantsEqually:!0}),Object(G.forms)(function(a){var e=a.actions;return{featureFlag:{defaults:s({},me),errors:function(r){var i,l,c,u=r.key,d=r.filters;return{key:u?(i=u.match)!==null&&i!==void 0&&i.call(u,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key",filters:{multivariate:{variants:d==null||(l=d.multivariate)===null||l===void 0||(c=l.variants)===null||c===void 0?void 0:c.map(function(p){var S,O=p.key;return{key:O?(S=O.match)!==null&&S!==void 0&&S.call(O,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key"}})}}}},submit:function(r){e.saveFeatureFlag(r)}}}}),Object(h.reducers)({featureFlag:[s({},me),{setFeatureFlag:function(e,o){var r=o.featureFlag;if(r.filters.groups){var i=r.filters.groups.map(function(l){return l.properties?s(s({},l),{},{properties:Object(k.r)(l.properties)}):l});return s(s({},r),{},{filters:s(s({},r==null?void 0:r.filters),{},{groups:i})})}return r},addConditionSet:function(e){if(!e)return e;var o=[].concat(x()(e==null?void 0:e.filters.groups),[{properties:[],rollout_percentage:null}]);return s(s({},e),{},{filters:s(s({},e.filters),{},{groups:o})})},updateConditionSet:function(e,o){var r=o.index,i=o.newRolloutPercentage,l=o.newProperties;if(!e)return e;var c=x()(e==null?void 0:e.filters.groups);return i!==void 0&&(c[r]=s(s({},c[r]),{},{rollout_percentage:i})),l!==void 0&&(c[r]=s(s({},c[r]),{},{properties:l})),s(s({},e),{},{filters:s(s({},e.filters),{},{groups:c})})},removeConditionSet:function(e,o){var r=o.index;if(!e)return e;var i=x()(e.filters.groups);return i.splice(r,1),s(s({},e),{},{filters:s(s({},e.filters),{},{groups:i})})},duplicateConditionSet:function(e,o){var r=o.index;if(!e)return e;var i=e.filters.groups.concat([e.filters.groups[r]]);return s(s({},e),{},{filters:s(s({},e.filters),{},{groups:i})})},setMultivariateOptions:function(e,o){var r=o.multivariateOptions;return e&&s(s({},e),{},{filters:s(s({},e.filters),{},{multivariate:r})})},addVariant:function(e){var o;if(!e)return e;var r=x()(((o=e.filters.multivariate)===null||o===void 0?void 0:o.variants)||[]);return s(s({},e),{},{filters:s(s({},e.filters),{},{multivariate:s(s({},e.filters.multivariate||{}),{},{variants:[].concat(x()(r),[it])})})})},removeVariant:function(e,o){var r,i=o.index;if(!e)return e;var l=x()(((r=e.filters.multivariate)===null||r===void 0?void 0:r.variants)||[]);return l.splice(i,1),s(s({},e),{},{filters:s(s({},e.filters),{},{multivariate:s(s({},e.filters.multivariate),{},{variants:l})})})},distributeVariantsEqually:function(e){var o;if(!e)return e;var r=x()(((o=e.filters.multivariate)===null||o===void 0?void 0:o.variants)||[]),i=r.length;if(i>0&&i<=100){var l=Math.round(100/i),c=l*i,u=c-100;r.forEach(function(d,p){r[p]=s(s({},d),{},{rollout_percentage:l})}),r[i-1]=s(s({},r[i-1]),{},{rollout_percentage:l-u})}return s(s({},e),{},{filters:s(s({},e.filters),{},{multivariate:s(s({},e.filters.multivariate),{},{variants:r})})})},setAggregationGroupTypeIndex:function(e,o){var r=o.value;return!e||e.filters.aggregation_group_type_index==r?e:s(s({},e),{},{filters:s(s({},e.filters),{},{aggregation_group_type_index:r,groups:[{properties:[],rollout_percentage:null}]})})}}],featureFlagMissing:[!1,{setFeatureFlagMissing:function(){return!0}}]}),Object(st.loaders)(function(a){var e=a.values,o=a.props,r=a.actions;return{featureFlag:{loadFeatureFlag:function(){var i=X()(T.a.mark(function c(){return T.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!(o.id&&o.id!=="new")){d.next=11;break}return d.prev=1,d.next=4,de.b.get("api/projects/".concat(e.currentTeamId,"/feature_flags/").concat(o.id));case 4:return d.abrupt("return",d.sent);case 7:throw d.prev=7,d.t0=d.catch(1),r.setFeatureFlagMissing(),d.t0;case 11:return d.abrupt("return",me);case 12:case"end":return d.stop()}},c,null,[[1,7]])}));function l(){return i.apply(this,arguments)}return l}(),saveFeatureFlag:function(){var i=X()(T.a.mark(function c(u){var d,p,S;return T.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(d=u.created_at,p=u.id,S=qe()(u,lt),m.prev=1,u.id){m.next=8;break}return m.next=5,de.b.create("api/projects/".concat(e.currentTeamId,"/feature_flags"),S);case 5:return m.abrupt("return",m.sent);case 8:return m.next=10,de.b.update("api/projects/".concat(e.currentTeamId,"/feature_flags/").concat(u.id),S);case 10:return m.abrupt("return",m.sent);case 11:m.next=17;break;case 13:throw m.prev=13,m.t0=m.catch(1),(m.t0.code==="behavioral_cohort_found"||m.t0.code==="cohort_does_not_exist")&&ot.e.actions.reportFailedToCreateFeatureFlagWithCohort(m.t0.code,m.t0.detail),m.t0;case 17:case"end":return m.stop()}},c,null,[[1,13]])}));function l(c){return i.apply(this,arguments)}return l}()}}}),Object(h.listeners)(function(a){var e=a.actions,o=a.values;return{saveFeatureFlagSuccess:function(i){var l,c=i.featureFlag;rt.d.success("Feature flag saved"),(l=Q.a.findMounted())===null||l===void 0||l.actions.updateFlag(c),fe.router.actions.replace(H.a.featureFlag(c.id))},deleteFeatureFlag:function(){var r=X()(T.a.mark(function l(c){var u;return T.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:u=c.featureFlag,Object(k.x)({endpoint:"projects/".concat(o.currentTeamId,"/feature_flags"),object:{name:u.name,id:u.id},callback:function(){var O,m;u.id&&((O=Q.a.findMounted())===null||O===void 0||O.actions.deleteFlag(u.id)),(m=Q.a.findMounted())===null||m===void 0||m.actions.loadFeatureFlags(),fe.router.actions.push(H.a.featureFlags())}});case 2:case"end":return p.stop()}},l)}));function i(l){return r.apply(this,arguments)}return i}(),setMultivariateEnabled:function(){var r=X()(T.a.mark(function l(c){var u;return T.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:u=c.enabled,u?e.setMultivariateOptions(ut):e.setMultivariateOptions(null);case 2:case"end":return p.stop()}},l)}));function i(l){return r.apply(this,arguments)}return i}()}}),Object(h.selectors)({props:[function(){return[function(a,e){return e}]},function(a){return a}],multivariateEnabled:[function(a){return[a.featureFlag]},function(a){return!!(a!=null&&a.filters.multivariate)}],variants:[function(a){return[a.featureFlag]},function(a){var e;return(a==null||(e=a.filters.multivariate)===null||e===void 0?void 0:e.variants)||[]}],nonEmptyVariants:[function(a){return[a.variants]},function(a){return a.filter(function(e){var o=e.key;return!!o})}],variantRolloutSum:[function(a){return[a.variants]},function(a){return a.reduce(function(e,o){var r=o.rollout_percentage;return e+r},0)}],areVariantRolloutsValid:[function(a){return[a.variants,a.variantRolloutSum]},function(a,e){return a.every(function(o){var r=o.rollout_percentage;return r>=0&&r<=100})&&e===100}],aggregationTargetName:[function(a){return[a.featureFlag,a.groupTypes,a.aggregationLabel]},function(a,e,o){return a&&a.filters.aggregation_group_type_index!=null&&e.length>0?o(a.filters.aggregation_group_type_index).plural:"users"}],taxonomicGroupTypes:[function(a){return[a.featureFlag,a.groupsTaxonomicTypes]},function(a,e){return a&&a.filters.aggregation_group_type_index!=null&&e.length>0?[e[a.filters.aggregation_group_type_index]]:[Le.a.PersonProperties,Le.a.Cohorts]}],breadcrumbs:[function(a){return[a.featureFlag]},function(a){return[{name:"Feature Flags",path:H.a.featureFlags()}].concat(x()(a?[{name:a.key||"Unnamed"}]:[]))}]}),Object(fe.urlToAction)(function(a){var e,o=a.actions,r=a.props;return xe()({},H.a.featureFlag((e=r.id)!==null&&e!==void 0?e:"new"),function(i,l,c,u){var d=u.method;d==="PUSH"&&(r.id?o.loadFeatureFlag():o.resetFeatureFlag())})}),Object(h.afterMount)(function(a){var e,o=a.props,r=a.actions,i=(e=Q.a.findMounted())===null||e===void 0?void 0:e.values.featureFlags.find(function(l){return l.id===o.id});i?r.setFeatureFlag(i):o.id!=="new"&&r.loadFeatureFlag()})]),j=n("./frontend/src/lib/components/icons.tsx"),q=n("./frontend/src/lib/components/LemonDivider/index.ts"),F=n("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),ct="?utm_medium=in-product&utm_campaign=feature-flag";function ee(a){var e=a.flagKey;return t.a.createElement(t.a.Fragment,null,t.a.createElement(F.a,{language:F.b.JavaScript,wrap:!0},"const isMyFlagEnabledForUser = await client.isFeatureEnabled('".concat(e,`', 'user distinct id')

if (isMyFlagEnabledForUser) {
    // Do something differently for this user
}`)))}function te(a){var e=a.flagKey;return t.a.createElement(t.a.Fragment,null,t.a.createElement(F.a,{language:F.b.JavaScript,wrap:!0},"if\xA0(posthog.isFeatureEnabled('".concat(e!=null?e:"",`')) {
    // run your activation code here
}`)))}function ae(a){var e=a.flagKey;return t.a.createElement(t.a.Fragment,null,t.a.createElement(F.a,{language:F.b.PHP,wrap:!0},"if (PostHog::isFeatureEnabled('".concat(e,`', 'some distinct id')) {
    // do something here
}`)))}function ne(a){var e=a.flagKey;return t.a.createElement(t.a.Fragment,null,t.a.createElement(F.a,{language:F.b.Go,wrap:!0},"isFlagEnabledForUser, err := client.IsFeatureEnabled('".concat(e,`', 'user distinct id', false)

if (isFlagEnabledForUser) {
  // Do something differently for this user
}`)))}function re(a){var e=a.flagKey;return t.a.createElement(t.a.Fragment,null,t.a.createElement(F.a,{language:F.b.Ruby,wrap:!0},"is_my_flag_enabled = posthog.is_feature_enabled('".concat(e,`', 'user distinct id')

if is_my_flag_enabled
  # Do something differently for this user
end`)))}function oe(a){var e=a.flagKey;return t.a.createElement(t.a.Fragment,null,t.a.createElement(F.a,{language:F.b.Python,wrap:!0},'if\xA0posthog.feature_enabled("'.concat(e,`", "user_distinct_id"):
    runAwesomeFeature()
`)))}function dt(){var a=Object(h.useValues)(Te.a),e=a.currentTeam;return t.a.createElement(t.a.Fragment,null,t.a.createElement(F.a,{language:F.b.Bash,wrap:!0},"curl ".concat(window.location.origin,`/decide/ \\
-X POST -H 'Content-Type: application/json' \\
-d '{
    "api_key": "`).concat(e?e.api_token:"[project_api_key]",`",
    "distinct_id": "[user distinct id]"
}'
                `)))}try{ee.displayName="NodeJSSnippet",ee.__docgenInfo={description:"",displayName:"NodeJSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#NodeJSSnippet"]={docgenInfo:ee.__docgenInfo,name:"NodeJSSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#NodeJSSnippet"})}catch(a){}try{te.displayName="JSSnippet",te.__docgenInfo={description:"",displayName:"JSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"]={docgenInfo:te.__docgenInfo,name:"JSSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"})}catch(a){}try{ae.displayName="PHPSnippet",ae.__docgenInfo={description:"",displayName:"PHPSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PHPSnippet"]={docgenInfo:ae.__docgenInfo,name:"PHPSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PHPSnippet"})}catch(a){}try{ne.displayName="GolangSnippet",ne.__docgenInfo={description:"",displayName:"GolangSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#GolangSnippet"]={docgenInfo:ne.__docgenInfo,name:"GolangSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#GolangSnippet"})}catch(a){}try{re.displayName="RubySnippet",re.__docgenInfo={description:"",displayName:"RubySnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#RubySnippet"]={docgenInfo:re.__docgenInfo,name:"RubySnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#RubySnippet"})}catch(a){}try{oe.displayName="PythonSnippet",oe.__docgenInfo={description:"",displayName:"PythonSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"]={docgenInfo:oe.__docgenInfo,name:"PythonSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"})}catch(a){}var ft=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),Ne=n.n(ft),mt=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlagInstructions.scss"),Re=n.n(mt),ge={};ge.insert="head",ge.singleton=!1;var ia=Ne()(Re.a,ge),ua=Re.a.locals||{},R="?utm_medium=in-product&utm_campaign=feature-flag",M="https://posthog.com/docs/",D="#feature-flags",pe=[{value:"JavaScript",documentationLink:"".concat(M,"integrations/js-integration").concat(R).concat(D),Icon:j.IconJavascript,Snippet:te},{value:"Node.js",documentationLink:"".concat(M,"integrations/node-integration").concat(R).concat(D),Icon:j.IconNodeJS,Snippet:ee},{value:"PHP",documentationLink:"".concat(M,"integrations/php-integration").concat(R).concat(D),Icon:j.IconPHP,Snippet:ae},{value:"Ruby",documentationLink:"".concat(M,"integrations/ruby-integration").concat(R).concat(D),Icon:j.IconRuby,Snippet:re},{value:"Golang",documentationLink:"".concat(M,"integrations/go-integration").concat(R).concat(D),Icon:j.IconGolang,Snippet:ne},{value:"Python",documentationLink:"".concat(M,"integrations/python-integration").concat(R).concat(D),Icon:j.IconPython,Snippet:oe},{value:"API",documentationLink:"".concat(M,"api/feature-flags").concat(R),Icon:j.IconOpenInNew,Snippet:dt}];function gt(a){var e=a.selectedOptionValue,o=a.selectOption;return t.a.createElement(I.a,{className:"FeatureFlagInstructionsHeader",justify:"space-between",align:"middle"},t.a.createElement("div",{className:"FeatureFlagInstructionsHeader__header-title"},t.a.createElement(j.IconFlag,{className:"FeatureFlagInstructionsHeader__header-title__icon"}),t.a.createElement("b",null,"Learn how to use feature flags in your code")),t.a.createElement(B.a,{"data-attr":"feature-flag-instructions-select",value:e,style:{width:140},onChange:o},pe.map(function(r,i){var l=r.value,c=r.Icon;return t.a.createElement(B.a.Option,{"data-attr":"feature-flag-instructions-select-option-"+l,key:i,value:l},t.a.createElement("div",{className:"FeatureFlagInstructionsHeader__option"},t.a.createElement("div",{className:"FeatureFlagInstructionsHeader__option__icon"},t.a.createElement(c,null)),t.a.createElement("div",null,l)))})))}function pt(a){var e=a.documenrationLink;return t.a.createElement("div",{className:"mt-4"},"Need more information?"," ",t.a.createElement("a",{"data-attr":"feature-flag-doc-link",target:"_blank",rel:"noopener",href:e},"Check the docs ",t.a.createElement(j.IconOpenInNew,null)))}function se(a){var e=a.featureFlagKey,o=pe[0],r=Object(C.useState)(o),i=W()(r,2),l=i[0],c=i[1],u=function(p){var S=pe.find(function(O){return O.value===p});S&&c(S)};return t.a.createElement(ce.a,{size:"small"},t.a.createElement(gt,{selectedOptionValue:l.value,selectOption:u}),t.a.createElement(q.a,null),t.a.createElement("div",{className:"mt mb"},t.a.createElement(l.Snippet,{"data-attr":"feature-flag-instructions-snippet",flagKey:e})),t.a.createElement(q.a,null),t.a.createElement(pt,{documenrationLink:l.documentationLink}))}try{se.displayName="FeatureFlagInstructions",se.__docgenInfo={description:"",displayName:"FeatureFlagInstructions",props:{featureFlagKey:{defaultValue:null,description:"",name:"featureFlagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagInstructions.tsx#FeatureFlagInstructions"]={docgenInfo:se.__docgenInfo,name:"FeatureFlagInstructions",path:"frontend/src/scenes/feature-flags/FeatureFlagInstructions.tsx#FeatureFlagInstructions"})}catch(a){}var vt=n("./frontend/src/lib/components/PageHeader.tsx"),yt=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss"),Me=n.n(yt),ve={};ve.insert="head",ve.singleton=!1;var ca=Ne()(Me.a,ve),da=Me.a.locals||{},le=n("./frontend/src/lib/components/Tooltip.tsx"),ht=n("./frontend/src/lib/introductions/GroupsIntroductionOption.tsx"),Ft=n("./frontend/src/scenes/userLogic.ts"),ye=n("./frontend/src/types.ts"),Ke=n("./frontend/src/lib/components/Link.tsx"),K=n("./frontend/src/lib/components/LemonButton/index.ts"),Et=n("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),A=n("./frontend/src/lib/forms/Field.tsx"),St=n("./frontend/src/lib/components/LemonTextArea/LemonTextArea.tsx"),he=n("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),Ot=n("./frontend/src/lib/components/LemonCheckbox/index.ts"),jt=n("./frontend/src/scenes/events/EventBufferNotice.tsx"),bt=n("./frontend/src/lib/components/AlertMessage/index.ts"),Ct=n("./frontend/src/lib/components/Spinner/Spinner.tsx"),It=n("./frontend/src/lib/components/NotFound/index.tsx"),xt={component:$,logic:Z,paramsToProps:function(e){var o=e.params.id;return{id:o&&o!=="new"?parseInt(o):"new"}}};function Ve(a){setTimeout(function(){var e;return(e=document.querySelector('.variant-form-list input[data-key-index="'.concat(a,'"]')))===null||e===void 0?void 0:e.focus()},50)}function $(){var a,e,o,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=r.id,l=Object(h.useValues)(Z),c=l.props,u=l.featureFlag,d=l.multivariateEnabled,p=l.variants,S=l.nonEmptyVariants,O=l.areVariantRolloutsValid,m=l.variantRolloutSum,Tt=l.groupTypes,U=l.aggregationTargetName,At=l.taxonomicGroupTypes,Fe=l.featureFlagLoading,Lt=l.featureFlagMissing,b=Object(h.useActions)(Z),Pt=b.addConditionSet,_e=b.updateConditionSet,Nt=b.removeConditionSet,Rt=b.duplicateConditionSet,Mt=b.deleteFeatureFlag,De=b.setMultivariateEnabled,Kt=b.addVariant,Vt=b.removeVariant,_t=b.distributeVariantsEqually,Dt=b.setAggregationGroupTypeIndex,Ge=Object(h.useValues)(Ae.a),Gt=Ge.showGroupsOptions,Bt=Ge.aggregationLabel,Be=Object(h.useValues)(Ft.a),Ee=Be.hasAvailableFeature,Ht=Be.upgradeLink,$t=Object(C.useState)(!1),He=W()($t,2),Ut=He[0],Wt=He[1],wt=Object(C.useState)(!1),$e=W()(wt,2),Yt=$e[0],Se=$e[1],Jt=Object(ht.a)({value:-2});return Lt?t.a.createElement(It.a,{object:"feature flag"}):Fe?t.a.createElement(Ct.b,null):t.a.createElement(G.Form,{logic:Z,props:c,formKey:"featureFlag",enableFormOnSubmit:!0,className:"space-y-4"},t.a.createElement(vt.a,{title:"Feature Flag",buttons:t.a.createElement("div",{className:"flex items-center gap-2"},t.a.createElement(A.a,{name:"active"},function(g){var f=g.value,v=g.onChange;return t.a.createElement(Et.a,{"data-attr":"feature-flag-enabled-toggle",checked:f,onChange:v,label:f?t.a.createElement("span",{className:"text-success"},"Enabled"):t.a.createElement("span",{className:"text-danger"},"Disabled")})}),(u==null?void 0:u.id)&&t.a.createElement(K.a,{"data-attr":"delete-flag",status:"danger",type:"secondary",onClick:function(){Mt(u)}},"Delete"),t.a.createElement(K.a,{type:"primary","data-attr":"feature-flag-submit",loading:Fe,htmlType:"submit"},"Save changes"))}),u.experiment_set&&((a=u.experiment_set)===null||a===void 0?void 0:a.length)>0&&t.a.createElement(bt.a,{type:"warning"},"This feature flag is linked to an experiment. It's recommended to only make changes to this flag"," ",t.a.createElement(Ke.a,{to:H.a.experiment(u.experiment_set[0])},"using the experiment creation screen.")),t.a.createElement(jt.a,{additionalInfo:", meaning it can take around 60 seconds for some flags to update for recently-identified persons"}),t.a.createElement("h3",{className:"l3 mt-4"},"General configuration"),t.a.createElement("div",{className:"text-muted mb-4"},"General settings for your feature flag and integration instructions."),t.a.createElement(I.a,{gutter:16,style:{marginBottom:32}},t.a.createElement(y.a,{span:12,className:"space-y-4"},t.a.createElement(A.a,{name:"key",label:"Key (must be unique)",help:Ut&&i!=="new"?t.a.createElement("span",{className:"text-warning"},t.a.createElement("b",null,"Warning! "),"Changing this key will",t.a.createElement("a",{href:"https://posthog.com/docs/features/feature-flags".concat(ct,"#feature-flag-persistence"),target:"_blank",rel:"noopener"}," ","affect the persistence of your flag ",t.a.createElement(j.IconOpenInNew,null))):void 0},function(g){var f=g.value,v=g.onChange;return t.a.createElement(he.a,{value:f,onChange:function(L){L!==f&&Wt(!0),v(L)},"data-attr":"feature-flag-key",className:"ph-ignore-input",autoFocus:!0,placeholder:"examples: new-landing-page, betaFeature, ab_test_1",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})}),t.a.createElement(A.a,{name:"name",label:"Description"},t.a.createElement(St.a,{className:"ph-ignore-input","data-attr":"feature-flag-description",placeholder:"Adding a helpful description can ensure others know what this feature is for."})),t.a.createElement(A.a,{name:"ensure_experience_continuity"},function(g){var f=g.value,v=g.onChange;return t.a.createElement("div",{className:"border rounded p-4"},t.a.createElement(Ot.a,{id:"continuity-checkbox",label:"Persist flag across authentication steps",onChange:function(){return v(!f)},fullWidth:!0,checked:f}),t.a.createElement("div",{className:"text-muted text-sm pl-7"},"If your feature flag is applied prior to an identify or authentication event, use this to ensure that feature flags are not reset after a person is identified. This ensures the experience for the anonymous person is carried forward to the authenticated person."))})),t.a.createElement(y.a,{span:12},t.a.createElement(se,{featureFlagKey:u.key||"my-flag"}))),t.a.createElement("div",{className:"mb-8"},t.a.createElement("h3",{className:"l3"},"Served value"),t.a.createElement("div",{className:"mb-2"},t.a.createElement(_.a,{placement:"top",title:"Change value type? The variants below will be lost.",visible:Yt,onConfirm:function(){De(!1),Se(!1)},onCancel:function(){return Se(!1)},okText:"OK",cancelText:"Cancel"},t.a.createElement(Y.a.Group,{options:[{label:"Boolean value (A/B test)",value:!1},{label:t.a.createElement(le.a,{title:Ee(ye.d.MULTIVARIATE_FLAGS)?"":"This feature is not available on your current plan."},t.a.createElement("div",null,!Ee(ye.d.MULTIVARIATE_FLAGS)&&t.a.createElement(Ke.a,{to:Ht,target:"_blank"},t.a.createElement(Ye.a,{style:{marginRight:4,color:"var(--warning)"}})),"String value (Multivariate test)"," ")),value:!0,disabled:!Ee(ye.d.MULTIVARIATE_FLAGS)}],onChange:function(f){var v=f.target.value;v===!1&&S.length?Se(!0):(De(v),Ve(0))},value:d,optionType:"button"}))),t.a.createElement("div",{className:"text-muted mb-4"},Object(k.i)(U)," will be served"," ",d?t.a.createElement(t.a.Fragment,null,t.a.createElement("strong",null,"a variant key")," according to the below distribution"):t.a.createElement("strong",null,t.a.createElement("code",null,"true"))," ","if they match one or more release condition groups."),d&&t.a.createElement("div",{className:"variant-form-list space-y-2"},t.a.createElement(I.a,{gutter:8,className:"label-row"},t.a.createElement(y.a,{span:7},"Variant key"),t.a.createElement(y.a,{span:7},"Description"),t.a.createElement(y.a,{span:9},t.a.createElement("span",null,"Rollout percentage"),t.a.createElement(J.a,{type:"link",onClick:_t,icon:t.a.createElement(Xe,null),style:{padding:"0 0 0 0.5em"},title:"Distribute variants equally"},"Distribute"))),p.map(function(g,f){return t.a.createElement(G.Group,{key:f,name:["filters","multivariate","variants",f]},t.a.createElement(I.a,{gutter:8},t.a.createElement(y.a,{span:7},t.a.createElement(A.a,{name:"key"},t.a.createElement(he.a,{"data-attr":"feature-flag-variant-key","data-key-index":f.toString(),className:"ph-ignore-input",placeholder:"example-variant-".concat(f+1),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}))),t.a.createElement(y.a,{span:7},t.a.createElement(A.a,{name:"name"},t.a.createElement(he.a,{"data-attr":"feature-flag-variant-name",className:"ph-ignore-input",placeholder:"Description"}))),t.a.createElement(y.a,{span:7},t.a.createElement(A.a,{name:"rollout_percentage"},t.a.createElement(ue.a,{tooltipPlacement:"top"}))),t.a.createElement(y.a,{span:2},t.a.createElement(A.a,{name:"rollout_percentage"},function(v){var V=v.value,L=v.onChange;return t.a.createElement(z.a,{min:0,max:100,value:V,onChange:function(Oe){if(Oe!=null){var Ue=parseInt(Oe.toString());isNaN(Ue)||L(Ue)}},style:{width:"100%",borderColor:O?void 0:"var(--danger)"}})})),p.length>1&&t.a.createElement(y.a,{span:1},t.a.createElement(le.a,{title:"Delete this variant",placement:"bottomLeft"},t.a.createElement(J.a,{type:"link",icon:t.a.createElement(Qe.a,null),onClick:function(){return Vt(f)},style:{color:"var(--danger)"}})))))}),p.length>0&&!O&&t.a.createElement("p",{className:"text-danger"},"Percentage rollouts for variants must sum to 100 (currently ",m,")."),t.a.createElement(K.a,{type:"secondary",onClick:function(){var f=p.length;Kt(),Ve(f)},fullWidth:!0,center:!0},"Add variant"))),t.a.createElement("div",{className:"feature-flag-form-row"},t.a.createElement("div",{"data-attr":"feature-flag-release-conditions"},t.a.createElement("h3",{className:"l3"},"Release conditions"),t.a.createElement("div",{className:"text-muted mb-4"},"Specify the ",U," to which you want to release this flag. Note that condition sets are rolled out independently of each other.")),Gt&&t.a.createElement("div",{className:"centered"},"Match by",t.a.createElement(B.a,{value:((e=u.filters)===null||e===void 0?void 0:e.aggregation_group_type_index)!=null?(o=u.filters)===null||o===void 0?void 0:o.aggregation_group_type_index:-1,onChange:function(f){var v=f!==-1?f:null;Dt(v)},style:{marginLeft:8},"data-attr":"feature-flag-aggregation-filter",dropdownMatchSelectWidth:!1,dropdownAlign:{points:["tr","br"]}},t.a.createElement(B.a.Option,{key:-1,value:-1},"Users"),Tt.map(function(g){return t.a.createElement(B.a.Option,{key:g.group_type_index,value:g.group_type_index},Object(k.i)(Bt(g.group_type_index).plural))}),Jt))),t.a.createElement(I.a,{gutter:16},u.filters.groups.map(function(g,f){var v,V;return t.a.createElement(y.a,{span:24,md:24,key:"".concat(f,"-").concat(u.filters.groups.length)},f>0&&t.a.createElement("div",{style:{display:"flex",marginLeft:16}},t.a.createElement("div",{className:"stateful-badge or-light-grey mb-4"},"OR")),t.a.createElement(ce.a,{style:{marginBottom:16}},t.a.createElement("div",{className:"feature-flag-form-row",style:{height:24}},t.a.createElement("div",null,t.a.createElement("span",{className:"simple-tag tag-light-blue",style:{marginRight:8}},"Set ",f+1),(v=g.properties)!==null&&v!==void 0&&v.length?t.a.createElement(t.a.Fragment,null,"Matching ",t.a.createElement("b",null,U)," with filters"):t.a.createElement(t.a.Fragment,null,"Condition set will match ",t.a.createElement("b",null,"all ",U))),t.a.createElement(I.a,{align:"middle"},t.a.createElement(le.a,{title:"Duplicate this condition set",placement:"bottomLeft"},t.a.createElement(K.a,{icon:t.a.createElement(j.IconCopy,null),size:"small",onClick:function(){return Rt(f)}})),u.filters.groups.length>1&&t.a.createElement(le.a,{title:"Delete this condition set",placement:"bottomLeft"},t.a.createElement(K.a,{icon:t.a.createElement(j.IconDelete,null),size:"small",onClick:function(){return Nt(f)}})))),t.a.createElement(q.a,{className:"my-4"}),t.a.createElement("div",{className:"ml-4"},t.a.createElement(we.a,{pageKey:"feature-flag-".concat(u.id,"-").concat(f,"-").concat(u.filters.groups.length,"-").concat((V=u.filters.aggregation_group_type_index)!==null&&V!==void 0?V:""),propertyFilters:g==null?void 0:g.properties,onChange:function(ie){return _e(f,void 0,ie)},taxonomicGroupTypes:At,showConditionBadge:!0})),t.a.createElement(q.a,{className:"my-4"}),t.a.createElement("div",{className:"feature-flag-form-row"},t.a.createElement("div",{className:"centered"},"Roll out to"," ",t.a.createElement(z.a,{style:{width:100,marginLeft:8,marginRight:8},onChange:function(ie){_e(f,ie)},value:g.rollout_percentage!=null?g.rollout_percentage:100,min:0,max:100,addonAfter:"%"})," ","of ",t.a.createElement("b",null,U)," in this set"))))})),t.a.createElement(ce.a,{size:"small",style:{marginBottom:16}},t.a.createElement(K.a,{onClick:Pt,fullWidth:!0},"Add condition set")),t.a.createElement("div",{className:"text-right"},t.a.createElement(K.a,{htmlType:"submit",loading:Fe,type:"primary","data-attr":"feature-flag-submit-bottom"},"Save changes")))}try{$.displayName="FeatureFlag",$.__docgenInfo={description:"",displayName:"FeatureFlag",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"]={docgenInfo:$.__docgenInfo,name:"FeatureFlag",path:"frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"})}catch(a){}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss":function(P,E,n){var N=n("./node_modules/css-loader/dist/runtime/api.js");E=N(!1),E.push([P.i,".variant-form-list .ant-form-item{min-height:32px}.variant-form-list .label-row{font-weight:700}.variant-form-list .label-row .ant-col{min-height:32px;display:flex;justify-content:space-between;align-items:center}.feature-flag-form-row{display:flex;justify-content:space-between;align-items:center;width:100%}.feature-flag-form-row .centered{display:flex;align-items:center;white-space:pre-wrap}",""]),P.exports=E},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlagInstructions.scss":function(P,E,n){var N=n("./node_modules/css-loader/dist/runtime/api.js");E=N(!1),E.push([P.i,".FeatureFlagInstructionsHeader{flex-wrap:nowrap}.FeatureFlagInstructionsHeader .FeatureFlagInstructionsHeader__header-title{display:flex;justify-items:center}.FeatureFlagInstructionsHeader .FeatureFlagInstructionsHeader__header-title .FeatureFlagInstructionsHeader__header-title__icon{color:var(--text-muted-alt);margin-right:12px;font-size:1.6em}.FeatureFlagInstructionsHeader__option{display:flex;justify-items:center}.FeatureFlagInstructionsHeader__option .FeatureFlagInstructionsHeader__option__icon{margin-top:2px;margin-right:8px}",""]),P.exports=E}}]);
