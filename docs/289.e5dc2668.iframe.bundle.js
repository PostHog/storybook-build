(window.webpackJsonp=window.webpackJsonp||[]).push([[289],{"./frontend/src/lib/components/Table/utils.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return normalizeColumnTitle}));var lib_hooks_useWindowSize__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./frontend/src/lib/hooks/useWindowSize.js"),lib_utils_responsiveUtils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./frontend/src/lib/utils/responsiveUtils.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function normalizeColumnTitle(title){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{style:{whiteSpace:"nowrap"},children:title})}const useIsTableScrolling=scrollBreakpoint=>{const{width:width}=Object(lib_hooks_useWindowSize__WEBPACK_IMPORTED_MODULE_0__.a)(),tableScrollBreakpoint=Object(lib_utils_responsiveUtils__WEBPACK_IMPORTED_MODULE_1__.b)(scrollBreakpoint),isTableScrolling=!!width&&width<=tableScrollBreakpoint;return{isTableScrolling:isTableScrolling,tableScrollBreakpoint:tableScrollBreakpoint,tableScrollX:isTableScrolling?"max-content":`${tableScrollBreakpoint}px`}};try{normalizeColumnTitle.displayName="normalizeColumnTitle",normalizeColumnTitle.__docgenInfo={description:"",displayName:"normalizeColumnTitle",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Table/utils.tsx#normalizeColumnTitle"]={docgenInfo:normalizeColumnTitle.__docgenInfo,name:"normalizeColumnTitle",path:"frontend/src/lib/components/Table/utils.tsx#normalizeColumnTitle"})}catch(__react_docgen_typescript_loader_error){}try{useIsTableScrolling.displayName="useIsTableScrolling",useIsTableScrolling.__docgenInfo={description:"",displayName:"useIsTableScrolling",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/Table/utils.tsx#useIsTableScrolling"]={docgenInfo:useIsTableScrolling.__docgenInfo,name:"useIsTableScrolling",path:"frontend/src/lib/components/Table/utils.tsx#useIsTableScrolling"})}catch(__react_docgen_typescript_loader_error){}},"./frontend/src/scenes/feature-flags/FeatureFlags.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene})),__webpack_require__.d(__webpack_exports__,"FeatureFlags",(function(){return FeatureFlags})),__webpack_require__.d(__webpack_exports__,"groupFilters",(function(){return groupFilters}));var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),_featureFlagsLogic__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./frontend/src/scenes/feature-flags/featureFlagsLogic.ts"),antd__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/tabs/index.js"),lib_components_Link__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/lib/components/Link.tsx"),lib_utils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/lib/utils.tsx"),lib_components_PageHeader__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./frontend/src/lib/components/PageHeader.tsx"),_types__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./frontend/src/types.ts"),lib_components_Table_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./frontend/src/lib/components/Table/utils.tsx"),scenes_urls__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./frontend/src/scenes/urls.ts"),lib_utils_stringWithWBR__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./frontend/src/lib/utils/stringWithWBR.tsx"),_teamLogic__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./frontend/src/scenes/teamLogic.tsx"),lib_components_LemonButton__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./frontend/src/lib/components/LemonButton/index.ts"),lib_components_LemonDivider__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./frontend/src/lib/components/LemonDivider/index.ts"),lib_components_LemonTable__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./frontend/src/lib/components/LemonTable/index.ts"),lib_components_LemonButton_More__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./frontend/src/lib/components/LemonButton/More.tsx"),lib_components_LemonTable_columnUtils__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./frontend/src/lib/components/LemonTable/columnUtils.tsx"),lib_components_PropertyFilters_components_PropertyFiltersDisplay__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./frontend/src/lib/components/PropertyFilters/components/PropertyFiltersDisplay.tsx"),lib_components_ActivityLog_ActivityLog__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./frontend/src/lib/components/ActivityLog/ActivityLog.tsx"),lib_components_ActivityLog_humanizeActivity__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./frontend/src/lib/components/ActivityLog/humanizeActivity.tsx"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),lib_components_Tooltip__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("./frontend/src/lib/components/Tooltip.tsx"),lib_components_icons__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("./frontend/src/lib/components/icons.tsx"),kea_router__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("./node_modules/.pnpm/kea-router@3.1.3_kea@3.1.0/node_modules/kea-router/lib/index.js"),lib_components_ObjectTags_ObjectTags__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("./frontend/src/lib/components/ObjectTags/ObjectTags.tsx"),scenes_userLogic__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("./frontend/src/scenes/userLogic.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");const scene={component:FeatureFlags,logic:_featureFlagsLogic__WEBPACK_IMPORTED_MODULE_1__.b};function OverViewTab(){const{currentTeamId:currentTeamId}=Object(kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(_teamLogic__WEBPACK_IMPORTED_MODULE_10__.a),{featureFlagsLoading:featureFlagsLoading,searchedFeatureFlags:searchedFeatureFlags,searchTerm:searchTerm,uniqueCreators:uniqueCreators,filters:filters}=Object(kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(_featureFlagsLogic__WEBPACK_IMPORTED_MODULE_1__.b),{updateFeatureFlag:updateFeatureFlag,loadFeatureFlags:loadFeatureFlags,setSearchTerm:setSearchTerm,setFeatureFlagsFilters:setFeatureFlagsFilters}=Object(kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(_featureFlagsLogic__WEBPACK_IMPORTED_MODULE_1__.b),{hasAvailableFeature:hasAvailableFeature}=Object(kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(scenes_userLogic__WEBPACK_IMPORTED_MODULE_24__.a),columns=[{title:Object(lib_components_Table_utils__WEBPACK_IMPORTED_MODULE_7__.a)("Key"),dataIndex:"key",className:"ph-no-capture",sticky:!0,width:"40%",sorter:(a,b)=>(a.key||"").localeCompare(b.key||""),render:function Render(_,featureFlag){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsxs)("div",{className:"flex flex-row items-center",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_Link__WEBPACK_IMPORTED_MODULE_3__.a,{to:featureFlag.id?scenes_urls__WEBPACK_IMPORTED_MODULE_8__.a.featureFlag(featureFlag.id):void 0,className:"row-name",children:Object(lib_utils_stringWithWBR__WEBPACK_IMPORTED_MODULE_9__.a)(featureFlag.key,17)}),!featureFlag.can_edit&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_Tooltip__WEBPACK_IMPORTED_MODULE_20__.a,{title:"You don't have edit permissions for this feature flag.",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_icons__WEBPACK_IMPORTED_MODULE_21__.IconLock,{style:{marginLeft:6,verticalAlign:"-0.125em",display:"inline"}})})]}),featureFlag.name&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)("span",{className:"row-description",style:{maxWidth:"24rem"},children:featureFlag.name})]})}},...hasAvailableFeature(_types__WEBPACK_IMPORTED_MODULE_6__.e.TAGGING)?[{title:"Tags",dataIndex:"tags",render:function Render(tags){return tags?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_ObjectTags_ObjectTags__WEBPACK_IMPORTED_MODULE_23__.a,{tags:tags,staticOnly:!0}):null}}]:[],Object(lib_components_LemonTable_columnUtils__WEBPACK_IMPORTED_MODULE_15__.b)(),Object(lib_components_LemonTable_columnUtils__WEBPACK_IMPORTED_MODULE_15__.a)(),{title:"Release conditions",width:100,render:function Render(_,featureFlag){const releaseText=groupFilters(featureFlag.filters.groups);return"100% of all users"==releaseText?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_19__.LemonTag,{type:"highlight",children:releaseText}):releaseText}},{title:"Status",dataIndex:"active",sorter:(a,b)=>Number(a.active)-Number(b.active),width:100,render:function RenderActive(_,featureFlag){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.Fragment,{children:featureFlag.performed_rollback?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_19__.LemonTag,{type:"warning",className:"uppercase",children:"Rolled Back"}):featureFlag.active?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_19__.LemonTag,{type:"success",className:"uppercase",children:"Enabled"}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_19__.LemonTag,{type:"default",className:"uppercase",children:"Disabled"})})}},{width:0,render:function Render(_,featureFlag){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_LemonButton_More__WEBPACK_IMPORTED_MODULE_14__.a,{overlay:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_LemonButton__WEBPACK_IMPORTED_MODULE_11__.a,{status:"stealth",onClick:()=>{Object(lib_utils__WEBPACK_IMPORTED_MODULE_4__.s)(featureFlag.key,"feature flag key")},fullWidth:!0,children:"Copy feature flag key"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsxs)(lib_components_LemonButton__WEBPACK_IMPORTED_MODULE_11__.a,{status:"stealth",onClick:()=>{featureFlag.id&&updateFeatureFlag({id:featureFlag.id,payload:{active:!featureFlag.active}})},id:`feature-flag-${featureFlag.id}-switch`,disabled:!featureFlag.can_edit,fullWidth:!0,children:[featureFlag.active?"Disable":"Enable"," feature flag"]}),featureFlag.id&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_LemonButton__WEBPACK_IMPORTED_MODULE_11__.a,{status:"stealth",fullWidth:!0,disabled:!featureFlag.can_edit,onClick:()=>featureFlag.id&&kea_router__WEBPACK_IMPORTED_MODULE_22__.router.actions.push(scenes_urls__WEBPACK_IMPORTED_MODULE_8__.a.featureFlag(featureFlag.id)),children:"Edit"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_LemonButton__WEBPACK_IMPORTED_MODULE_11__.a,{status:"stealth",to:scenes_urls__WEBPACK_IMPORTED_MODULE_8__.a.insightNew({events:[{id:"$pageview",name:"$pageview",type:"events",math:"dau"}],breakdown_type:"event",breakdown:`$feature/${featureFlag.key}`}),"data-attr":"usage",fullWidth:!0,children:"Try out in Insights"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_LemonDivider__WEBPACK_IMPORTED_MODULE_12__.a,{}),featureFlag.id&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_LemonButton__WEBPACK_IMPORTED_MODULE_11__.a,{status:"danger",onClick:()=>{Object(lib_utils__WEBPACK_IMPORTED_MODULE_4__.x)({endpoint:`projects/${currentTeamId}/feature_flags`,object:{name:featureFlag.key,id:featureFlag.id},callback:loadFeatureFlags})},disabled:!featureFlag.can_edit,fullWidth:!0,children:"Delete feature flag"})]})})}}];return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)("div",{children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsxs)("div",{className:"flex justify-between mb-4",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_19__.LemonInput,{type:"search",placeholder:"Search for feature flags",onChange:setSearchTerm,value:searchTerm}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsxs)("div",{className:"flex items-center gap-2",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)("span",{children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)("b",{children:"Status"})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_19__.LemonSelect,{onChange:status=>{if(status)if("all"===status){if(filters){const{active:active,...restFilters}=filters;setFeatureFlagsFilters(restFilters,!0)}}else setFeatureFlagsFilters({active:status})},options:[{label:"All",value:"all"},{label:"Enabled",value:"true"},{label:"Disabled",value:"false"}],value:"all",dropdownMaxContentWidth:!0}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)("span",{className:"ml-1",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)("b",{children:"Created by"})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_19__.LemonSelect,{onChange:user=>{if(user)if("any"===user){if(filters){const{created_by:created_by,...restFilters}=filters;setFeatureFlagsFilters(restFilters,!0)}}else setFeatureFlagsFilters({created_by:user})},options:uniqueCreators,value:"any"})]})]})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_LemonTable__WEBPACK_IMPORTED_MODULE_13__.a,{dataSource:searchedFeatureFlags,columns:columns,rowKey:"key",defaultSorting:{columnKey:"created_at",order:-1},noSortingCancellation:!0,loading:featureFlagsLoading,pagination:{pageSize:100},nouns:["feature flag","feature flags"],"data-attr":"feature-flag-table"})]})}function FeatureFlags(){const{activeTab:activeTab}=Object(kea__WEBPACK_IMPORTED_MODULE_0__.useValues)(_featureFlagsLogic__WEBPACK_IMPORTED_MODULE_1__.b),{setActiveTab:setActiveTab}=Object(kea__WEBPACK_IMPORTED_MODULE_0__.useActions)(_featureFlagsLogic__WEBPACK_IMPORTED_MODULE_1__.b);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsxs)("div",{className:"feature_flags",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_PageHeader__WEBPACK_IMPORTED_MODULE_5__.a,{title:"Feature Flags",buttons:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_LemonButton__WEBPACK_IMPORTED_MODULE_11__.a,{type:"primary",to:scenes_urls__WEBPACK_IMPORTED_MODULE_8__.a.featureFlag("new"),"data-attr":"new-feature-flag",children:"New feature flag"})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsxs)(antd__WEBPACK_IMPORTED_MODULE_2__.a,{activeKey:activeTab,destroyInactiveTabPane:!0,onChange:t=>setActiveTab(t),children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(antd__WEBPACK_IMPORTED_MODULE_2__.a.TabPane,{tab:"Overview",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(OverViewTab,{})},"overview"),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(antd__WEBPACK_IMPORTED_MODULE_2__.a.TabPane,{tab:"History",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_ActivityLog_ActivityLog__WEBPACK_IMPORTED_MODULE_17__.a,{scope:lib_components_ActivityLog_humanizeActivity__WEBPACK_IMPORTED_MODULE_18__.a.FEATURE_FLAG})},"history")]})]})}function groupFilters(groups){if(0===groups.length||!groups.some((group=>0!==group.rollout_percentage)))return"No users";if(groups.some((group=>{var _group$properties;return!(null!==(_group$properties=group.properties)&&void 0!==_group$properties&&_group$properties.length)&&[null,void 0,100].includes(group.rollout_percentage)})))return"100% of all users";if(1===groups.length){const{properties:properties,rollout_percentage:rollout_percentage=null}=groups[0];return(null==properties?void 0:properties.length)>0?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsxs)("div",{style:{display:"flex",alignItems:"center",flexDirection:"row"},children:[null!=rollout_percentage&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsxs)("span",{style:{flexShrink:0,marginRight:5},children:[rollout_percentage,"% of"]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_25__.jsx)(lib_components_PropertyFilters_components_PropertyFiltersDisplay__WEBPACK_IMPORTED_MODULE_16__.a,{filters:properties,style:{margin:0,flexDirection:"column"}})]}):null!==rollout_percentage?`${rollout_percentage}% of all users`:(console.error("A group with full rollout was not detected early"),"All users")}return"Multiple groups"}try{groupFilters.displayName="groupFilters",groupFilters.__docgenInfo={description:"",displayName:"groupFilters",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlags.tsx#groupFilters"]={docgenInfo:groupFilters.__docgenInfo,name:"groupFilters",path:"frontend/src/scenes/feature-flags/FeatureFlags.tsx#groupFilters"})}catch(__react_docgen_typescript_loader_error){}}}]);