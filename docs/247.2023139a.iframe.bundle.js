(window.webpackJsonp=window.webpackJsonp||[]).push([[247],{"./frontend/src/scenes/billing/Billing.tsx":function(x,p,n){"use strict";n.r(p),n.d(p,"scene",function(){return ge}),n.d(p,"Billing",function(){return M});var g=n("./node_modules/react/index.js"),e=n.n(g),G=n("./frontend/src/lib/components/PageHeader.tsx"),Y=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),w=n.n(Y),H=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),T=n.n(H),pe=n("./node_modules/core-js/modules/es.function.name.js"),fe=n("./node_modules/core-js/modules/es.object.keys.js"),ve=n("./node_modules/core-js/modules/es.symbol.js"),be=n("./node_modules/core-js/modules/es.array.filter.js"),he=n("./node_modules/core-js/modules/es.object.to-string.js"),ye=n("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),je=n("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Ee=n("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),W=n("./node_modules/antd/es/alert/index.js"),j=n("./node_modules/antd/es/button/index.js"),h=n("./node_modules/antd/es/card/index.js"),K=n("./node_modules/antd/es/input-number/index.js"),f=n("./node_modules/kea/lib/index.esm.js"),B=n.p+"images/plan-default.64d2c4930c12267ba45d77bebf37405c.svg",I=n("./node_modules/@ant-design/icons/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M876.6 239.5c-.5-.9-1.2-1.8-2-2.5-5-5-13.1-5-18.1 0L684.2 409.3l-67.9-67.9L788.7 169c.8-.8 1.4-1.6 2-2.5 3.6-6.1 1.6-13.9-4.5-17.5-98.2-58-226.8-44.7-311.3 39.7-67 67-89.2 162-66.5 247.4l-293 293c-3 3-2.8 7.9.3 11l169.7 169.7c3.1 3.1 8.1 3.3 11 .3l292.9-292.9c85.5 22.8 180.5.7 247.6-66.4 84.4-84.5 97.7-213.1 39.7-311.3zM786 499.8c-58.1 58.1-145.3 69.3-214.6 33.6l-8.8 8.8-.1-.1-274 274.1-79.2-79.2 230.1-230.1s0 .1.1.1l52.8-52.8c-35.7-69.3-24.5-156.5 33.6-214.6a184.2 184.2 0 01144-53.5L537 318.9a32.05 32.05 0 000 45.3l124.5 124.5a32.05 32.05 0 0045.3 0l132.8-132.8c3.7 51.8-14.4 104.8-53.6 143.9z"}}]},name:"tool",theme:"outlined"},U=J,Q=n("./node_modules/@ant-design/icons/es/components/AntdIcon.js"),N=function(t,r){return g.createElement(Q.a,Object(I.a)(Object(I.a)({},t),{},{ref:r,icon:U}))};N.displayName="ToolOutlined";var A=g.forwardRef(N),X=n("./node_modules/@ant-design/icons/es/icons/WarningOutlined.js"),v=n("./frontend/src/scenes/billing/billingLogic.ts"),Z=n("./frontend/src/lib/logic/featureFlagLogic.ts"),k=n("./frontend/src/lib/constants.tsx");function F(a,t){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(a);t&&(l=l.filter(function(c){return Object.getOwnPropertyDescriptor(a,c).enumerable})),r.push.apply(r,l)}return r}function R(a){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F(Object(r),!0).forEach(function(l){w()(a,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach(function(l){Object.defineProperty(a,l,Object.getOwnPropertyDescriptor(r,l))})}return a}function E(a){var t=a.plan,r=Object(f.useValues)(v.b),l=r.billing,c=Object(f.useActions)(v.b),s=c.setBillingLimit,o=e.a.useState((l==null?void 0:l.billing_limit)||0),d=T()(o,2),u=d[0],b=d[1],m=Object(f.useValues)(Z.a),C=m.featureFlags,y=C[k.h.BILLING_LIMIT];return e.a.createElement(e.a.Fragment,null,e.a.createElement("div",{className:"space-top"}),l!=null&&l.should_setup_billing?e.a.createElement(W.a,{type:"warning",message:e.a.createElement(e.a.Fragment,null,"Your plan is ",e.a.createElement("b",null,"currently inactive")," as you haven't finished setting up your billing information."),action:l.subscription_url&&e.a.createElement(j.a,{href:l.subscription_url,icon:e.a.createElement(A,null)},"Finish setup"),showIcon:!0,icon:e.a.createElement(X.a,null)}):e.a.createElement(h.a,{title:"Organization billing plan"},e.a.createElement("div",{style:{display:"flex",alignItems:"center"}},e.a.createElement("div",null,e.a.createElement("img",{src:t.image_url||B,alt:"",height:100,width:100})),e.a.createElement("div",{style:{flexGrow:1,paddingLeft:16}},e.a.createElement("h3",{className:"l3",style:{marginBottom:8}},t.name),e.a.createElement("div",{style:{marginTop:4}},t.price_string),y&&e.a.createElement("div",{style:{marginTop:8,marginBottom:8,alignItems:"center",display:"flex"}},"Set monthly billing limit to"," ",e.a.createElement(K.a,{style:{width:250,marginLeft:8,marginRight:8},onChange:function(S){b(S)},value:u,min:0,step:10,addonBefore:"$",addonAfter:"USD / MONTH"})," ",e.a.createElement(j.a,{type:"primary",onClick:function(){l&&s(R(R({},l),{},{billing_limit:u}))}},"Submit")),e.a.createElement("div",{className:"text-muted mt"},"Click on ",e.a.createElement("b",null,"manage subscription")," to cancel your billing agreement,"," ",e.a.createElement("b",null,"update your card")," or other billing information.")),e.a.createElement("div",null,e.a.createElement(j.a,{type:"primary",href:"/billing/manage",icon:e.a.createElement(A,null)},"Manage subscription"),e.a.createElement("div",{className:"text-muted text-center"},"Get past invoices too")))))}try{E.displayName="CurrentPlan",E.__docgenInfo={description:"",displayName:"CurrentPlan",props:{plan:{defaultValue:null,description:"",name:"plan",required:!0,type:{name:"PlanInterface"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/billing/CurrentPlan.tsx#CurrentPlan"]={docgenInfo:E.__docgenInfo,name:"CurrentPlan",path:"frontend/src/scenes/billing/CurrentPlan.tsx#CurrentPlan"})}catch(a){}var q=n("./node_modules/antd/es/progress/index.js"),V=n("./frontend/src/lib/utils.tsx"),_=n("./frontend/src/lib/components/Tooltip.tsx"),ee=n("./frontend/src/lib/components/LemonTable/index.ts");function ne(){var a,t=Object(f.useValues)(v.b),r=t.eventAllocation,l=t.percentage,c=t.strokeColor,s=t.billing,o=s==null?void 0:s.plan;if(!s)return null;var d=[{title:"Tier",dataIndex:"name"},{title:"Price per event",render:function(b,m){return e.a.createElement("div",null,"$",m.price_per_event)}},{title:"Number of events",dataIndex:"number_of_events"},{title:"Sub-total",render:function(b,m){return e.a.createElement("div",null,"$",m.subtotal)}},{title:"Running total",render:function(b,m){return e.a.createElement("div",null,"$",m.running_total)}}];return e.a.createElement(e.a.Fragment,null,e.a.createElement("div",{className:"space-top"}),e.a.createElement(h.a,{title:"Current monthly usage"},s.should_display_current_bill&&e.a.createElement(e.a.Fragment,null,e.a.createElement("h3",{className:"l3"},"Current bill amount"),(s==null?void 0:s.current_bill_amount)!==void 0&&(s==null?void 0:s.current_bill_amount)!==null?e.a.createElement(e.a.Fragment,null,"This is the amount (in dollars) of the bill for the currently ongoing period. The final amount will be billed a few days after the end of the month. Please note this number is reported on a daily basis,"," ",e.a.createElement("b",null,"so events ingested in the last 24 hours may not be reflected yet."),e.a.createElement("div",{className:"bill-amount"},"$".concat(s==null||(a=s.current_bill_amount)===null||a===void 0?void 0:a.toLocaleString())),e.a.createElement(ee.a,{columns:d,dataSource:s.tiers||[]})):e.a.createElement(e.a.Fragment,null,"We can't show your current bill amount right now. Please check back again in a few minutes or"," ",e.a.createElement("a",{href:"https://posthog.com/support/",target:"_blank"},"contact us")," ","if this message does not disappear.")),e.a.createElement("h3",{className:"l3 mt"},"Current event usage"),s.current_usage!==null?e.a.createElement(e.a.Fragment,null,"Your organization has used"," ",e.a.createElement(_.a,{title:"".concat(s.current_usage.toLocaleString()," events")},e.a.createElement("b",null,Object(V.p)(s.current_usage)))," ","events this month (calculated roughly every hour)."," ",r&&e.a.createElement(e.a.Fragment,null,"You can use up to ",e.a.createElement("b",null,Object(V.p)(r))," events per month."),o&&!o.event_allowance&&!o.is_metered_billing&&"Your current plan has an unlimited event allocation.",e.a.createElement(q.a,{type:"line",percent:l!==null?Math.floor(l*100):100,strokeColor:c,status:l!==null?"normal":"success"}),(o==null?void 0:o.is_metered_billing)&&e.a.createElement("div",{className:"mt text-muted"},"This is the number of events that your organization has ingested across all your projects for the ",e.a.createElement("b",null,"current month")," and that ",e.a.createElement("b",null,"will be billed")," a few days after the end of the month.")):e.a.createElement("div",null,"Currently we do not have information about the number of billed events. Please check back again in a few minutes or"," ",e.a.createElement("a",{href:"https://posthog.com/support/",target:"_blank"},"contact us")," ","if this message does not disappear.")))}var te=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),le=n.n(te),ae=n("./node_modules/@babel/runtime/regenerator/index.js"),D=n.n(ae),Oe=n("./node_modules/core-js/modules/es.promise.js"),Se=n("./node_modules/core-js/modules/es.array.map.js"),z=n("./node_modules/antd/es/skeleton/index.js"),se=n("./node_modules/antd/es/row/index.js"),re=n("./node_modules/antd/es/col/index.js"),oe=n("./frontend/src/lib/components/Spinner/Spinner.tsx");function ie(a){var t=a.plan,r=a.onSubscribe,l=Object(g.useState)(""),c=T()(l,2),s=c[0],o=c[1],d=Object(g.useState)(!0),u=T()(d,2),b=u[0],m=u[1],C=function(){var y=le()(D.a.mark(function O(S){var L;return D.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,fetch("/api/plans/".concat(S,"/template/"));case 2:if(L=i.sent,!L.ok){i.next=9;break}return i.t0=o,i.next=7,L.text();case 7:i.t1=i.sent,(0,i.t0)(i.t1);case 9:m(!1);case 10:case"end":return i.stop()}},O)}));return function(S){return y.apply(this,arguments)}}();return Object(g.useEffect)(function(){C(t.key)},[t.key]),e.a.createElement(h.a,null,e.a.createElement("div",{className:"cursor-pointer",onClick:function(){return r(t)}},e.a.createElement("img",{src:t.image_url||B,alt:"",height:100,width:100}),e.a.createElement("h3",{style:{fontSize:22}},t.name),e.a.createElement("div",{style:{fontWeight:"bold",marginBottom:16,fontSize:16}},t.price_string)),e.a.createElement("div",null,e.a.createElement(j.a,{"data-attr":"btn-subscribe-now","data-plan":t.key,type:"primary",onClick:function(){return r(t)}},"Subscribe now")),b?e.a.createElement(z.a,{paragraph:{rows:6},title:!1,className:"mt",active:!0}):e.a.createElement("div",{className:"plan-description",dangerouslySetInnerHTML:{__html:s}}))}function ce(){var a=Object(f.useValues)(v.b),t=a.plans,r=a.plansLoading,l=a.billingSubscriptionLoading,c=Object(f.useActions)(v.b),s=c.subscribe,o=function(u){s(u.key)};return!t.length&&!r?null:e.a.createElement(e.a.Fragment,null,e.a.createElement("div",{className:"space-top"}),r?e.a.createElement(h.a,null,e.a.createElement(z.a,{active:!0})):e.a.createElement(h.a,{title:"Billing Plan Enrollment"},e.a.createElement(se.a,{gutter:16,className:"space-top",style:{display:"flex",justifyContent:"center"}},t.map(function(d){return e.a.createElement(re.a,{sm:8,key:d.key,className:"text-center"},l?e.a.createElement(oe.a,null):e.a.createElement(ie,{plan:d,onSubscribe:o}))}))))}var de=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),ue=n.n(de),me=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/billing/Billing.scss"),$=n.n(me),P={};P.insert="head",P.singleton=!1;var xe=ue()($.a,P),Te=$.a.locals||{},ge={component:M,logic:v.b};function M(){var a=Object(f.useValues)(v.b),t=a.billing;return e.a.createElement("div",{className:"billing-page"},e.a.createElement(G.a,{title:"Billing & usage information"}),e.a.createElement(ne,null),t!=null&&t.plan?e.a.createElement(E,{plan:t.plan}):e.a.createElement(ce,null),e.a.createElement("div",{style:{marginBottom:128}}))}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/billing/Billing.scss":function(x,p,n){var g=n("./node_modules/css-loader/dist/runtime/api.js");p=g(!1),p.push([x.i,".text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.billing-page .plan-description ol,.billing-page .plan-description ul{margin-top:1rem;padding-left:0;list-style:none;text-align:center}.billing-page .plan-description ol li,.billing-page .plan-description ul li{line-height:1.2rem;margin-bottom:1rem}.billing-page .plan-description ol .disclaimer,.billing-page .plan-description ul .disclaimer{font-size:10px;font-weight:700;vertical-align:top;padding-left:1px}.billing-page .plan-description .disclaimer-details{font-size:.75rem;color:rgba(0,0,0,.5);margin-top:1rem}.billing-page .bill-amount{margin-top:.5rem;font-size:1.2rem;font-weight:700;text-align:center}",""]),x.exports=p}}]);
