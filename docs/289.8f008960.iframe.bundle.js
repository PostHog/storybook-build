(window.webpackJsonp=window.webpackJsonp||[]).push([[289],{"./frontend/src/scenes/billing/Billing.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"scene",(function(){return scene})),__webpack_require__.d(__webpack_exports__,"Billing",(function(){return Billing_Billing}));var PageHeader=__webpack_require__("./frontend/src/lib/components/PageHeader.tsx"),Plan=__webpack_require__("./frontend/src/scenes/billing/Plan.tsx"),progress=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/progress/index.js"),index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),utils=__webpack_require__("./frontend/src/lib/utils.tsx"),billingLogic=__webpack_require__("./frontend/src/scenes/billing/billingLogic.ts"),Tooltip=__webpack_require__("./frontend/src/lib/lemon-ui/Tooltip.tsx"),LemonTable=__webpack_require__("./frontend/src/lib/lemon-ui/LemonTable/index.ts"),dayjs=__webpack_require__("./frontend/src/lib/dayjs.ts"),src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),featureFlagLogic=__webpack_require__("./frontend/src/lib/logic/featureFlagLogic.ts"),constants=__webpack_require__("./frontend/src/lib/constants.tsx"),react=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function CurrentUsage(){var _billing$current_bill;const{eventAllocation:eventAllocation,percentage:percentage,strokeColor:strokeColor,showUsageTiers:showUsageTiers,billing:billing}=Object(index_esm.useValues)(billingLogic.a),{toggleUsageTiers:toggleUsageTiers,setBillingLimit:setBillingLimit}=Object(index_esm.useActions)(billingLogic.a),{featureFlags:featureFlags}=Object(index_esm.useValues)(featureFlagLogic.a),[billingLimitValue,setbillingLimitValue]=Object(react.useState)((null==billing?void 0:billing.billing_limit)||0),plan=null==billing?void 0:billing.plan;if(!billing)return null;const columns=[{title:"Tier",dataIndex:"name"},{title:"Price per event",render:function Render(_,billingTier){return Object(jsx_runtime.jsxs)("div",{children:["$",billingTier.price_per_event]})}},{title:"Number of events",dataIndex:"number_of_events"},{title:"Sub-total",render:function Render(_,billingTier){return Object(jsx_runtime.jsxs)("div",{children:["$",billingTier.subtotal]})}},{title:"Running total",render:function Render(_,billingTier){return Object(jsx_runtime.jsxs)("div",{children:["$",billingTier.running_total]})}}],usage=billing.current_bill_usage||billing.current_usage,showBillingLimit=featureFlags[constants.i.BILLING_LIMIT];return Object(jsx_runtime.jsxs)("div",{className:"border rounded p-4",children:[billing.should_display_current_bill&&Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("h3",{className:"text-xs uppercase font-semibold text-muted",children:"Current Bill Amount"}),void 0!==(null==billing?void 0:billing.current_bill_amount)&&null!==(null==billing?void 0:billing.current_bill_amount)?Object(jsx_runtime.jsxs)("div",{className:"flex flex-col space-y-2",children:[Object(jsx_runtime.jsx)("div",{className:"text-5xl font-extrabold",children:`$${null==billing||null===(_billing$current_bill=billing.current_bill_amount)||void 0===_billing$current_bill?void 0:_billing$current_bill.toLocaleString()}`}),Object(jsx_runtime.jsxs)("p",{children:["This is the amount (in dollars) of the bill for the currently ongoing period. The final amount will be billed a few days after the end of the month. Please note this number is reported on a daily basis,"," ",Object(jsx_runtime.jsx)("b",{children:"so events ingested in the last 24 hours may not be reflected yet."})]}),showUsageTiers&&Object(jsx_runtime.jsx)(LemonTable.a,{columns:columns,dataSource:billing.tiers||[]}),Object(jsx_runtime.jsx)("div",{className:"flex-none",children:Object(jsx_runtime.jsxs)(src.LemonButton,{type:"secondary",onClick:toggleUsageTiers,children:[showUsageTiers?"Hide":"Show"," usage tiers"]})})]}):Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["We can't show your current bill amount right now. Please check back again in a few minutes or"," ",Object(jsx_runtime.jsx)("a",{href:"https://posthog.com/support/",target:"_blank",children:"contact us"})," ","if this message does not disappear."]}),(null==billing?void 0:billing.current_bill_cycle)&&Object(jsx_runtime.jsxs)("p",{className:"mt-4 text-muted",children:["Your current billing period runs from"," ",Object(jsx_runtime.jsx)("strong",{children:dayjs.a.unix(billing.current_bill_cycle.current_period_start).format("MMMM DD, YYYY")})," ","until"," ",Object(jsx_runtime.jsx)("strong",{children:dayjs.a.unix(billing.current_bill_cycle.current_period_end).format("MMMM DD, YYYY")}),", which is when you'll be charged."]}),Object(jsx_runtime.jsx)(src.LemonDivider,{className:"my-6"})]}),Object(jsx_runtime.jsx)("h3",{className:"text-xs uppercase font-semibold text-muted",children:"Current Usage"}),null!==usage?Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Your organization has used"," ",Object(jsx_runtime.jsx)(Tooltip.a,{title:`${usage.toLocaleString()} events`,children:Object(jsx_runtime.jsx)("b",{children:Object(utils.p)(usage)})})," ","events ",billing.current_bill_usage?"this billing period":"this month"," (calculated every day)."," ",eventAllocation&&Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["You can use up to ",Object(jsx_runtime.jsx)("b",{children:Object(utils.p)(eventAllocation)})," events per month."]}),plan&&!plan.event_allowance&&!plan.is_metered_billing&&"Your current plan has an unlimited event allocation.",Object(jsx_runtime.jsx)(progress.a,{type:"line",percent:null!==percentage?Math.floor(100*percentage):100,strokeColor:strokeColor,status:null!==percentage?"normal":"success"}),Object(jsx_runtime.jsx)("p",{children:"This is the number of events that your organization has ingested across all your projects for the current month and that will be billed a few days after the end of the month."})]}):Object(jsx_runtime.jsxs)("div",{children:["Currently we do not have information about the number of billed events. Please check back again in a few minutes or"," ",Object(jsx_runtime.jsx)("a",{href:"https://posthog.com/support/",target:"_blank",children:"contact us"})," ","if this message does not disappear."]}),showBillingLimit&&billing.plan&&Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.LemonDivider,{className:"my-6"}),Object(jsx_runtime.jsx)("h3",{className:"text-xs uppercase font-semibold text-muted",children:"Billing Limit"}),Object(jsx_runtime.jsxs)("div",{className:"flex flex-row space-x-2 my-2",children:[Object(jsx_runtime.jsx)("div",{className:"flex-none",children:Object(jsx_runtime.jsx)(src.LemonInput,{type:"number",onChange:value=>{setbillingLimitValue(value||0)},value:billingLimitValue,min:0,step:10,prefix:Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"$"}),suffix:Object(jsx_runtime.jsx)("div",{className:"shrink-0",children:"USD / MONTH"})})}),Object(jsx_runtime.jsx)(src.LemonButton,{type:"secondary",onClick:()=>{billing&&setBillingLimit({...billing,billing_limit:billingLimitValue})},children:"Submit"})]}),Object(jsx_runtime.jsxs)("p",{children:["Set a billing limit to control your recurring costs."," ",Object(jsx_runtime.jsx)("b",{children:"Your critical data will still be ingested and available in the product."})," Some features may cease operation if your usage greatly exceeds your billing cap."]})]})]})}var BillingEnrollment=__webpack_require__("./frontend/src/scenes/billing/BillingEnrollment.tsx"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/.pnpm/style-loader@2.0.0_webpack@4.46.0/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),Billing=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/billing/Billing.scss"),Billing_default=__webpack_require__.n(Billing),options={insert:"head",singleton:!1},AlertMessage=(injectStylesIntoStyleTag_default()(Billing_default.a,options),Billing_default.a.locals,__webpack_require__("./frontend/src/lib/lemon-ui/AlertMessage/index.ts")),v2_Billing=__webpack_require__("./frontend/src/scenes/billing/v2/Billing.tsx"),Spinner=__webpack_require__("./frontend/src/lib/lemon-ui/Spinner/Spinner.tsx");const scene={component:Billing_Billing,logic:billingLogic.a};function Billing_Billing(){const{billing:billing,isSmallScreen:isSmallScreen,billingVersion:billingVersion}=Object(index_esm.useValues)(billingLogic.a);return billingVersion?"v2"===billingVersion?Object(jsx_runtime.jsxs)("div",{children:[Object(jsx_runtime.jsx)(PageHeader.a,{title:"Billing & usage"}),Object(jsx_runtime.jsx)(v2_Billing.a,{})]}):Object(jsx_runtime.jsxs)("div",{className:"flex flex-col space-y-6",children:[Object(jsx_runtime.jsx)(PageHeader.a,{title:"Billing & usage"}),Object(jsx_runtime.jsx)(src.LemonDivider,{}),(null==billing?void 0:billing.should_setup_billing)&&Object(jsx_runtime.jsxs)(AlertMessage.a,{type:"warning",action:{children:billing.subscription_url?Object(jsx_runtime.jsx)("a",{href:billing.subscription_url,children:Object(jsx_runtime.jsx)(src.LemonButton,{children:"Finish setup"})}):void 0},children:["Your plan is ",Object(jsx_runtime.jsx)("b",{children:"currently inactive"})," as you haven't finished setting up your billing information."]}),isSmallScreen?Object(jsx_runtime.jsxs)("div",{className:"flex flex-col space-y-4",children:[Object(jsx_runtime.jsx)(CurrentUsage,{}),null!=billing&&billing.plan?Object(jsx_runtime.jsx)(Plan.a,{plan:billing.plan,currentPlan:!0}):Object(jsx_runtime.jsx)(BillingEnrollment.a,{})]}):Object(jsx_runtime.jsxs)("div",{className:"flex flex-row space-x-4",children:[Object(jsx_runtime.jsx)("div",{className:"w-2/3",children:Object(jsx_runtime.jsx)(CurrentUsage,{})}),Object(jsx_runtime.jsx)("div",{className:"w-1/3",children:null==billing||!billing.plan||null!=billing&&billing.should_setup_billing?Object(jsx_runtime.jsx)(BillingEnrollment.a,{}):Object(jsx_runtime.jsx)(Plan.a,{plan:billing.plan,currentPlan:!0})})]})]}):Object(jsx_runtime.jsx)(Spinner.b,{})}},"./frontend/src/scenes/billing/BillingEnrollment.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return BillingEnrollment}));var antd__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/card/index.js"),antd__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/skeleton/index.js"),kea__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),_billingLogic__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/scenes/billing/billingLogic.ts"),_Plan__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/scenes/billing/Plan.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function BillingEnrollment(){const{plans:plans,plansLoading:plansLoading,billingSubscriptionLoading:billingSubscriptionLoading}=Object(kea__WEBPACK_IMPORTED_MODULE_2__.useValues)(_billingLogic__WEBPACK_IMPORTED_MODULE_3__.a),{subscribe:subscribe}=Object(kea__WEBPACK_IMPORTED_MODULE_2__.useActions)(_billingLogic__WEBPACK_IMPORTED_MODULE_3__.a),handleBillingSubscribe=plan=>{subscribe(plan.key)};return plans.length||plansLoading?plansLoading||billingSubscriptionLoading?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(antd__WEBPACK_IMPORTED_MODULE_0__.a,{children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(antd__WEBPACK_IMPORTED_MODULE_1__.a,{active:!0})}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:"flex flex-row space-x-2 justify-center",children:plans.map((plan=>Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_Plan__WEBPACK_IMPORTED_MODULE_4__.a,{plan:plan,onSubscribe:handleBillingSubscribe,canHideDetails:!1},plan.key)))}):null}},"./frontend/src/scenes/billing/Plan.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Plan}));var antd__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/skeleton/index.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),clsx__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),lib_lemon_ui_icons__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts"),_billingLogic__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./frontend/src/scenes/billing/billingLogic.ts"),kea__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function Plan(_ref){let{plan:plan,onSubscribe:onSubscribe,currentPlan:currentPlan,canHideDetails:canHideDetails=!0,primaryCallToAction:primaryCallToAction=!0}=_ref;const[showDetails,setShowDetails]=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),{planDetails:planDetails,planDetailsLoading:planDetailsLoading,billing:billing}=Object(kea__WEBPACK_IMPORTED_MODULE_6__.useValues)(_billingLogic__WEBPACK_IMPORTED_MODULE_5__.a),{loadPlanDetails:loadPlanDetails}=Object(kea__WEBPACK_IMPORTED_MODULE_6__.useActions)(_billingLogic__WEBPACK_IMPORTED_MODULE_5__.a);return Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{loadPlanDetails(plan.key)}),[plan.key]),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)("div",{className:"BillingPlan border rounded p-4",children:[currentPlan&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("p",{className:"text-xs uppercase font-semibold text-muted",children:"Current Plan"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)("div",{className:Object(clsx__WEBPACK_IMPORTED_MODULE_2__.default)({"cursor-pointer":!!onSubscribe}),onClick:()=>onSubscribe&&onSubscribe(plan),children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("h3",{className:"text-2xl",children:plan.name}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("p",{children:plan.price_string})]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)("div",{className:"flex flex-col space-y-2",children:[currentPlan&&!(null!=billing&&billing.should_setup_billing)&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_3__.LemonButton,{"data-attr":"btn-manage-subscription","data-plan":plan.key,fullWidth:!0,center:!0,type:primaryCallToAction?"primary":"secondary",size:"large",to:"/billing/manage",children:"Manage subscription"}),onSubscribe&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_3__.LemonButton,{"data-attr":"btn-subscribe-now","data-plan":plan.key,fullWidth:!0,center:!0,type:"primary",size:"large",onClick:()=>onSubscribe(plan),children:"Subscribe now"}),canHideDetails&&planDetails&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_3__.LemonButton,{"data-attr":"btn-pricing-info",fullWidth:!0,center:!0,type:"tertiary",onClick:()=>setShowDetails(!showDetails),children:[showDetails?"Hide":"See more"," details"]})]}),(showDetails||!canHideDetails)&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_3__.LemonDivider,{className:"my-4"}),planDetailsLoading?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(antd__WEBPACK_IMPORTED_MODULE_0__.a,{paragraph:{rows:6},title:!1,className:"mt-4",active:!0}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.Fragment,{children:planDetails&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("div",{className:"BillingPlan__description",dangerouslySetInnerHTML:{__html:planDetails}})})]}),currentPlan&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_3__.LemonDivider,{className:"my-4"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)("div",{className:"flex flex-row space-x-2 items-center text-muted justify-center",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(lib_lemon_ui_icons__WEBPACK_IMPORTED_MODULE_4__.Eb,{className:"shrink-0"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("p",{className:"my-0",children:"Your payment information is safe and secure."})]})]})]})}try{Plan.displayName="Plan",Plan.__docgenInfo={description:"",displayName:"Plan",props:{plan:{defaultValue:null,description:"",name:"plan",required:!0,type:{name:"PlanInterface"}},canHideDetails:{defaultValue:{value:"true"},description:"",name:"canHideDetails",required:!1,type:{name:"boolean"}},onSubscribe:{defaultValue:null,description:"",name:"onSubscribe",required:!1,type:{name:"((plan: PlanInterface) => void)"}},currentPlan:{defaultValue:null,description:"",name:"currentPlan",required:!1,type:{name:"boolean"}},primaryCallToAction:{defaultValue:{value:"true"},description:"",name:"primaryCallToAction",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/billing/Plan.tsx#Plan"]={docgenInfo:Plan.__docgenInfo,name:"Plan",path:"frontend/src/scenes/billing/Plan.tsx#Plan"})}catch(__react_docgen_typescript_loader_error){}},"./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/postcss-loader@4.3.0_dhonik3q6ff6ozbzdscnovq2ka/node_modules/postcss-loader/dist/cjs.js!./node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/billing/Billing.scss":function(module,exports,__webpack_require__){(exports=__webpack_require__("./node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.i,".BillingPlan{max-width:500px;flex-grow:1}.BillingPlan .BillingPlan__description ol,.BillingPlan .BillingPlan__description ul{margin-top:1rem;padding-left:0;list-style:none;text-align:center}.BillingPlan .BillingPlan__description ol li,.BillingPlan .BillingPlan__description ul li{line-height:1.2rem;margin-bottom:1rem}.BillingPlan .BillingPlan__description ol .disclaimer,.BillingPlan .BillingPlan__description ul .disclaimer{font-size:10px;font-weight:700;vertical-align:top;padding-left:1px}.BillingPlan .BillingPlan__description .disclaimer-details{font-size:.75rem;color:var(--muted);margin-top:1rem}",""]),module.exports=exports}}]);