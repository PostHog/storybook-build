var qe=Object.defineProperty,en=Object.defineProperties;var nn=Object.getOwnPropertyDescriptors;var de=Object.getOwnPropertySymbols;var Le=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable;var Me=(L,v,t)=>v in L?qe(L,v,{enumerable:!0,configurable:!0,writable:!0,value:t}):L[v]=t,ue=(L,v)=>{for(var t in v||(v={}))Le.call(v,t)&&Me(L,t,v[t]);if(de)for(var t of de(v))Ae.call(v,t)&&Me(L,t,v[t]);return L},Oe=(L,v)=>en(L,nn(v));var Re=(L,v)=>{var t={};for(var j in L)Le.call(L,j)&&v.indexOf(j)<0&&(t[j]=L[j]);if(L!=null&&de)for(var j of de(L))v.indexOf(j)<0&&Ae.call(L,j)&&(t[j]=L[j]);return t};var N=(L,v,t)=>new Promise((j,U)=>{var r=V=>{try{R(t.next(V))}catch($){U($)}},y=V=>{try{R(t.throw(V))}catch($){U($)}},R=V=>V.done?j(V.value):Promise.resolve(V.value).then(r,y);R((t=t.apply(L,v)).next())});(window.webpackJsonp=window.webpackJsonp||[]).push([[285],{"./frontend/src/lib/hooks/useAnchor.ts":function(L,v,t){"use strict";t.d(v,"a",function(){return r});var j=t("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),U=t.n(j);function r(y){Object(j.useEffect)(()=>{if(y&&document.getElementById(y.substr(1))){const R=document.getElementById(y.substr(1));if(!R)return;R.classList.add("highlighted");const V=R.getBoundingClientRect().top+window.pageYOffset;window.scrollTo({top:V-50-32,behavior:"smooth"})}},[y])}},"./frontend/src/scenes/organization/Settings/Permissions/Roles/rolesLogic.tsx":function(L,v,t){"use strict";t.d(v,"a",function(){return G});var j=t("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),U=t("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js"),r=t.n(U),y=t("./frontend/src/lib/api.ts"),R=t("./frontend/src/lib/utils/eventUsageLogic.ts"),V=t("./frontend/src/scenes/project/Settings/teamMembersLogic.tsx"),$=t("./frontend/src/types.ts");const G=Object(j.kea)([Object(j.path)(["scenes","organization","rolesLogic"]),Object(j.connect)({values:[V.b,["allMembers"]]}),Object(j.actions)({setCreateRoleModalShown:O=>({shown:O}),setRoleInFocus:O=>({role:O}),setRoleMembersInFocus:O=>({roleMembers:O}),setRoleMembersToAdd:O=>({uuids:O}),openCreateRoleModal:!0,setPermission:(O,b)=>({resource:O,access:b}),clearPermission:!0,updateRole:O=>({role:O})}),Object(j.reducers)({createRoleModalShown:[!1,{setCreateRoleModalShown:(O,b)=>{let{shown:c}=b;return c}}],roleInFocus:[null,{setRoleInFocus:(O,b)=>{let{role:c}=b;return c}}],roleMembersInFocus:[[],{setRoleMembersInFocus:(O,b)=>{let{roleMembers:c}=b;return c}}],roleMembersToAdd:[[],{setRoleMembersToAdd:(O,b)=>{let{uuids:c}=b;return c}}],roles:[[],{updateRole:(O,b)=>{let{role:c}=b;return O.map(u=>u.id==c.id?c:u)}}]}),Object(U.loaders)(O=>{let{values:b,actions:c}=O;return{roles:{loadRoles:()=>N(this,null,function*(){const u=yield y.b.roles.list();return(u==null?void 0:u.results)||[]}),createRole:u=>N(this,null,function*(){const{roles:S,roleMembersToAdd:e}=b,f=yield y.b.roles.create(u);return yield c.addRoleMembers({role:f,membersToAdd:e}),R.e.actions.reportRoleCreated(u),c.setRoleMembersInFocus([]),c.setRoleMembersToAdd([]),c.clearPermission(),c.setCreateRoleModalShown(!1),[f,...S]}),deleteRole:u=>N(this,null,function*(){return yield y.b.roles.delete(u.id),b.roles.filter(S=>S.id!==u.id)})},roleMembersInFocus:[[],{loadRoleMembers:u=>N(this,null,function*(){let{roleId:S}=u;const e=yield y.b.roles.members.list(S);return(e==null?void 0:e.results)||[]}),addRoleMembers:u=>N(this,null,function*(){let{role:S,membersToAdd:e}=u;const f=yield Promise.all(e.map(A=>N(this,null,function*(){return yield y.b.roles.members.create(S.id,A)})));return c.setRoleMembersToAdd([]),[...b.roleMembersInFocus,...f]}),deleteRoleMember:u=>N(this,null,function*(){let{roleMemberUuid:S}=u;return b.roleInFocus&&(yield y.b.roles.members.delete(b.roleInFocus.id,S)),b.roleMembersInFocus.filter(e=>e.id!==S)})}]}}),Object(j.listeners)(O=>{let{actions:b,values:c}=O;return{setRoleInFocus:u=>{let{role:S}=u;S&&b.loadRoleMembers({roleId:S.id}),b.setCreateRoleModalShown(!0)},openCreateRoleModal:()=>{b.setRoleInFocus(null),b.setRoleMembersInFocus([]),b.setCreateRoleModalShown(!0)},setCreateRoleModalShown:()=>{c.roleInFocus?b.setPermission($.T.FEATURE_FLAGS,c.roleInFocus.feature_flags_access_level):b.setPermission($.T.FEATURE_FLAGS,$.a.WRITE)},deleteRoleSuccess:()=>{b.setCreateRoleModalShown(!1)}}}),Object(j.selectors)({addableMembers:[O=>[O.allMembers,O.roleMembersInFocus],(O,b)=>{const c=[];for(const u of O)b.some(S=>S.user.uuid===u.user.uuid)||c.push(u.user);return c.sort((u,S)=>u.first_name.localeCompare(S.first_name)),c}]}),Object(j.afterMount)(O=>{let{actions:b}=O;b.loadRoles()})])},"./frontend/src/scenes/organization/Settings/Permissions/permissionsLogic.tsx":function(L,v,t){"use strict";t.d(v,"a",function(){return u}),t.d(v,"b",function(){return e});var j=t("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),U=t("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js"),r=t.n(U),y=t("./frontend/src/lib/api.ts"),R=t("./frontend/src/types.ts"),V=t("./frontend/src/lib/logic/featureFlagLogic.ts"),$=t("./frontend/src/lib/constants.tsx"),G=t("./frontend/src/scenes/organization/Settings/Permissions/Roles/rolesLogic.tsx"),O=t("./frontend/@posthog/lemon-ui/src/index.ts"),b=t("./frontend/src/lib/utils/eventUsageLogic.ts");const c={[R.T.FEATURE_FLAGS]:"Feature Flags"},u={[R.a.WRITE]:"View & Edit",[R.a.READ]:"View Only"},S={[R.T.FEATURE_FLAGS]:"feature_flags_access_level"},e=Object(j.kea)([Object(j.path)(["scenes","organization","Settings","Permissions","permissionsLogic"]),Object(j.connect)({values:[V.a,["featureFlags"],G.a,["roles"]],actions:[G.a,["updateRole"]]}),Object(j.actions)({updatePermission:(f,A,C,D)=>({checked:f,role:A,resourceId:C,resourceType:D})}),Object(U.loaders)(f=>{let{values:A}=f;return{organizationResourcePermissions:[[],{loadOrganizationResourcePermissions:()=>N(this,null,function*(){const C=yield y.b.resourcePermissions.list();return(C==null?void 0:C.results)||[]}),updateOrganizationResourcePermission:C=>N(this,null,function*(){let{id:D,resource:p,access_level:I}=C;if(D){const _=yield y.b.resourcePermissions.update(D,{access_level:I});return A.organizationResourcePermissions.map(B=>B.id==_.id?_:B)}else{const _=yield y.b.resourcePermissions.create({resource:p,access_level:I});return[...A.organizationResourcePermissions,_]}})}]}}),Object(j.listeners)(f=>{let{actions:A}=f;return{updatePermission:C=>N(this,null,function*(){let{checked:D,role:p,resourceId:I,resourceType:_}=C;const B=D?R.a.WRITE:R.a.READ;if(p.id){const te=yield y.b.roles.update(p.id,{[S[_]]:B});te&&(A.updateRole(te),O.lemonToast.success(`${p.name} role ${_} edit access updated`))}else A.updateOrganizationResourcePermission({id:I,access_level:B});b.e.actions.reportResourceAccessLevelUpdated(_,p.name,B)}),updateOrganizationResourcePermissionSuccess:()=>{O.lemonToast.success("Organizational edit access updated")}}}),Object(j.selectors)({organizationResourcePermissionsMap:[f=>[f.organizationResourcePermissions],f=>f.reduce((A,C)=>Oe(ue({},A),{[C.resource]:C}),{})],allPermissions:[f=>[f.organizationResourcePermissionsMap],f=>Object.keys(c).map(A=>{var C,D;return{id:((C=f[A])===null||C===void 0?void 0:C.id)||null,resource:A,name:c[A],access_level:((D=f[A])===null||D===void 0?void 0:D.access_level)||R.a.WRITE}})],shouldShowPermissionsTable:[f=>[f.featureFlags],f=>f[$.i.ROLE_BASED_ACCESS]==="control"],resourceRolesAccess:[f=>[f.allPermissions,f.roles],(f,A)=>{const C=f.map(D=>({[D.resource]:{organization_default:D.access_level,id:D.id}}));for(const D of A)for(const p of C){const I=Object.keys(p)[0];p[I][`${D.name}`]=D[S[I]]}return C}]}),Object(j.afterMount)(f=>{let{actions:A}=f;A.loadOrganizationResourcePermissions()})])},"./frontend/src/scenes/organization/Settings/index.tsx":function(L,v,t){"use strict";t.r(v),t.d(v,"scene",function(){return Je}),t.d(v,"OrganizationSettingsTabs",function(){return ce}),t.d(v,"OrganizationSettings",function(){return Se});var j=t("./node_modules/.pnpm/react@16.14.0/node_modules/react/index.js"),U=t("./frontend/src/lib/components/PageHeader.tsx"),r=t("./node_modules/.pnpm/kea@3.1.0_react@16.14.0/node_modules/kea/lib/index.esm.js"),y=t("./frontend/src/lib/components/CopyToClipboard.tsx"),R=t("./frontend/src/lib/components/ProfilePicture/index.ts"),V=t("./frontend/src/scenes/organization/Settings/inviteLogic.ts"),$=t("./frontend/src/scenes/organization/Settings/InviteModal.tsx"),G=t("./frontend/src/lib/components/LemonTable/index.ts"),O=t("./frontend/src/lib/components/LemonTable/columnUtils.tsx"),b=t("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),c=t("./frontend/src/lib/components/LemonButton/index.ts"),u=t("./frontend/src/lib/components/icons.tsx"),S=t("./frontend/src/lib/components/LemonDialog/index.ts"),e=t("./node_modules/.pnpm/react@16.14.0/node_modules/react/jsx-runtime.js");function f(n,s){const o=new URL(`/signup/${n}`,document.baseURI).href;return s.is_expired?Object(e.jsx)("b",{children:"Expired! Delete and recreate"}):Object(e.jsx)(y.a,{"data-attr":"invite-link",description:"invite link",children:o})}function A(n){return function(o,i){return Object(e.jsx)(c.a,{title:"Cancel the invite","data-attr":"invite-delete",icon:Object(e.jsx)(u.IconClose,{}),status:"danger",onClick:()=>{i.is_expired?n(i):S.a.open({title:`Do you want to cancel the invite for ${i.target_email}?`,primaryButton:{children:"Yes, cancel invite",status:"danger",onClick:()=>n(i)},secondaryButton:{children:"No, keep invite"}})}})}}function C(){const{invites:n,invitesLoading:s}=Object(r.useValues)(V.a),{deleteInvite:o,showInviteModal:i}=Object(r.useActions)(V.a),{preflight:a}=Object(r.useValues)(b.a),d=[{key:"user_profile_picture",render:function(m,l){return Object(e.jsx)(R.b,{name:l.first_name,email:l.target_email})},width:32},{title:"Invitee",dataIndex:"target_email",key:"target_email",render:function(m,l){return l.target_email?Object(e.jsxs)("div",{className:"flex items-center",children:[l.target_email,l.first_name?` (${l.first_name})`:""]}):Object(e.jsx)("i",{children:"no one"})},width:"20%"},Object(O.b)(),Object(O.a)(),{title:"Invite Link",dataIndex:"id",key:"link",render:(h,m)=>f(m.id,m)},{title:"",key:"actions",width:24,render:A(o)}];return Object(e.jsxs)("div",{children:[Object(e.jsxs)("h2",{id:"invites",className:"subtitle",style:{justifyContent:"space-between"},children:["Pending Invites",Object(e.jsx)(c.a,{type:"primary",onClick:i,"data-attr":"invite-teammate-button",children:"Invite team member"})]}),!(a!=null&&a.email_service_available)&&Object(e.jsx)($.a,{}),Object(e.jsx)(G.a,{dataSource:n,columns:d,rowKey:"id",loading:s,style:{marginTop:"1rem"},"data-attr":"invites-table",emptyState:"There are no outstanding invitations. You can invite another team member above."})]})}var D=t("./frontend/src/scenes/organization/Settings/membersLogic.tsx"),p=t("./frontend/src/lib/constants.tsx"),I=t("./frontend/src/scenes/organizationLogic.tsx"),_=t("./frontend/src/scenes/userLogic.ts"),B=t("./frontend/src/lib/utils/permissioning.ts"),te=t("./frontend/src/lib/components/TZLabel/index.tsx"),fe=t("./frontend/src/lib/components/LemonButton/More.tsx"),me=t("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),Ce=t("./frontend/src/lib/components/LemonDivider/index.ts"),E=t("./frontend/@posthog/lemon-ui/src/index.ts");function De(n,s){var o;const{user:i}=Object(r.useValues)(_.a),{currentOrganization:a}=Object(r.useValues)(I.a),{removeMember:d,changeMemberAccessLevel:h}=Object(r.useActions)(D.a);if(!i)return null;const m=(o=a==null?void 0:a.membership_level)!==null&&o!==void 0?o:-1,l=(m>=p.p.Admin&&s.level<=m||s.user.uuid===i.uuid)&&s.level!==p.p.Owner,M=a?a.membership_level:null,x=B.c.filter(g=>!Object(B.a)(M,i,s,g)),w=Object(B.a)(M,i,s,x);return Object(e.jsx)(fe.a,{overlay:Object(e.jsxs)(e.Fragment,{children:[w?Object(e.jsx)("div",{children:w}):x.map(g=>Object(e.jsx)(c.a,{status:"stealth",fullWidth:!0,onClick:P=>{if(P.preventDefault(),!i)throw Error;if(g===p.p.Owner){var T;S.a.open({title:`Transfer organization ownership to ${s.user.first_name}?`,description:`You will no longer be the owner of ${(T=i.organization)===null||T===void 0?void 0:T.name}. After the transfer you will become an administrator.`,primaryButton:{status:"danger",children:"Transfer Ownership",onClick:()=>h(s,g)},secondaryButton:{children:"Cancel"}})}else h(s,g)},"data-test-level":g,children:g===p.p.Owner?Object(e.jsx)(e.Fragment,{children:"Transfer organization ownership"}):g>s.level?Object(e.jsxs)(e.Fragment,{children:["Upgrade to ",B.b.get(g)]}):Object(e.jsxs)(e.Fragment,{children:["Downgrade to ",B.b.get(g)]})},`${s.user.uuid}-level-${g}`)),l?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Ce.a,{}),Object(e.jsx)(c.a,{status:"danger","data-attr":"delete-org-membership",onClick:()=>{var g;if(!i)throw Error;S.a.open({title:`${s.user.uuid==i.uuid?"Leave":`Remove ${s.user.first_name} from`} organization ${(g=i.organization)===null||g===void 0?void 0:g.name}?`,primaryButton:{children:s.user.uuid==i.uuid?"Leave":"Remove",status:"danger",onClick:()=>d(s)},secondaryButton:{children:"Cancel"}})},fullWidth:!0,children:s.user.uuid!==i.uuid?"Remove from organization":"Leave organization"})]}):null]})})}function se(n){let{user:s}=n;const{filteredMembers:o,membersLoading:i,search:a}=Object(r.useValues)(D.a),{setSearch:d}=Object(r.useActions)(D.a),h=[{key:"user_profile_picture",render:function(l,M){return Object(e.jsx)(R.b,{name:M.user.first_name,email:M.user.email})},width:32},{title:"Name",key:"user_first_name",render:(m,l)=>l.user.uuid==s.uuid?`${l.user.first_name} (me)`:l.user.first_name,sorter:(m,l)=>m.user.first_name.localeCompare(l.user.first_name)},{title:"Email",key:"user_email",render:(m,l)=>l.user.email,sorter:(m,l)=>m.user.email.localeCompare(l.user.email)},{title:"Level",dataIndex:"level",key:"level",render:function(l,M){var x;return Object(e.jsx)(me.a,{"data-attr":"membership-level",children:M.level===p.p.Owner?"Organization owner":`Project ${(x=B.b.get(M.level))!==null&&x!==void 0?x:`unknown (${M.level})`}`})},sorter:(m,l)=>m.level-l.level},{title:"Joined",dataIndex:"joined_at",key:"joined_at",render:function(l){return Object(e.jsx)("div",{className:"whitespace-nowrap",children:Object(e.jsx)(te.a,{time:l})})},sorter:(m,l)=>m.joined_at.localeCompare(l.joined_at)},{key:"actions",width:0,render:De}];return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h2",{className:"subtitle",children:"Members"}),Object(e.jsx)(E.LemonInput,{type:"search",placeholder:"Search for members",value:a,onChange:d}),Object(e.jsx)(G.a,{dataSource:o,columns:h,rowKey:"id",style:{marginTop:"1rem"},loading:i,"data-attr":"org-members-table",defaultSorting:{columnKey:"level",order:-1},pagination:{pageSize:50}})]})}try{se.displayName="Members",se.__docgenInfo={description:"",displayName:"Members",props:{user:{defaultValue:null,description:"Currently logged-in user.",name:"user",required:!0,type:{name:"UserType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/organization/Settings/Members.tsx#Members"]={docgenInfo:se.__docgenInfo,name:"Members",path:"frontend/src/scenes/organization/Settings/Members.tsx#Members"})}catch(n){}function ie(n){let{isOpen:s,setIsOpen:o}=n;const{currentOrganization:i,organizationBeingDeleted:a}=Object(r.useValues)(I.a),{deleteOrganization:d}=Object(r.useActions)(I.a),[h,m]=Object(j.useState)(!1),l=!!i&&(a==null?void 0:a.id)===i.id;return Object(e.jsxs)(E.LemonModal,{title:"Delete the entire organization?",onClose:l?void 0:()=>o(!1),footer:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(E.LemonButton,{disabled:l,type:"secondary",onClick:()=>o(!1),children:"Cancel"}),Object(e.jsx)(E.LemonButton,{type:"primary",disabled:!h,loading:l,"data-attr":"delete-organization-ok",status:"danger",onClick:i?()=>d(i):void 0,children:`Delete ${i?i.name:"the current organization"}`})]}),isOpen:s,children:[Object(e.jsxs)("p",{children:["Organization deletion ",Object(e.jsx)("b",{children:"cannot be undone"}),". You will lose all data, ",Object(e.jsx)("b",{children:"including all events"}),", related to all projects within this organization."]}),Object(e.jsxs)("p",{children:["Please type"," ",Object(e.jsx)("strong",{children:i?i.name:"this organization's name"})," to confirm."]}),Object(e.jsx)(E.LemonInput,{type:"text",onChange:M=>{i&&m(M.toLowerCase()===i.name.toLowerCase())}})]})}function oe(n){let{isRestricted:s}=n;const{currentOrganization:o}=Object(r.useValues)(I.a),[i,a]=Object(j.useState)(!1);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"text-danger",children:[Object(e.jsx)("h2",{className:"text-danger subtitle",children:"Danger Zone"}),Object(e.jsxs)("div",{className:"mt-4",children:[!s&&Object(e.jsxs)("p",{className:"text-danger",children:["This is ",Object(e.jsx)("b",{children:"irreversible"}),". Please be certain."]}),Object(e.jsxs)(E.LemonButton,{status:"danger",type:"secondary",onClick:()=>a(!0),"data-attr":"delete-organization-button",icon:Object(e.jsx)(u.IconDelete,{}),disabled:s,children:["Delete ",(o==null?void 0:o.name)||"the current organization"]})]})]}),Object(e.jsx)(ie,{isOpen:i,setIsOpen:a})]})}try{ie.displayName="DeleteOrganizationModal",ie.__docgenInfo={description:"",displayName:"DeleteOrganizationModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},setIsOpen:{defaultValue:null,description:"",name:"setIsOpen",required:!0,type:{name:"Dispatch<SetStateAction<boolean>>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/organization/Settings/DangerZone.tsx#DeleteOrganizationModal"]={docgenInfo:ie.__docgenInfo,name:"DeleteOrganizationModal",path:"frontend/src/scenes/organization/Settings/DangerZone.tsx#DeleteOrganizationModal"})}catch(n){}try{oe.displayName="DangerZone",oe.__docgenInfo={description:"",displayName:"DangerZone",props:{isRestricted:{defaultValue:null,description:"",name:"isRestricted",required:!0,type:{name:"boolean"}},restrictionReason:{defaultValue:null,description:"",name:"restrictionReason",required:!0,type:{name:"string | null"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/organization/Settings/DangerZone.tsx#DangerZone"]={docgenInfo:oe.__docgenInfo,name:"DangerZone",path:"frontend/src/scenes/organization/Settings/DangerZone.tsx#DangerZone"})}catch(n){}var X=t("./frontend/src/lib/components/RestrictedArea.tsx"),Ee=t("./frontend/src/lib/hooks/useAnchor.ts"),q=t("./frontend/src/lib/components/Tooltip.tsx"),J=t("./frontend/src/lib/api.ts"),ae=t("./frontend/src/lib/components/lemonToast.tsx"),ee=t("./frontend/src/types.ts"),ge=t("./node_modules/.pnpm/kea-forms@3.0.3_kea@3.1.0/node_modules/kea-forms/lib/index.js"),Ie=t("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.0/node_modules/kea-loaders/lib/index.js");const k=Object(r.kea)([Object(r.path)(["scenes","organization","verifiedDomainsLogic"]),Object(r.connect)({values:[I.a,["currentOrganization"]]}),Object(r.actions)({replaceDomain:n=>({domain:n}),setAddModalShown:n=>({shown:n}),setConfigureSAMLModalId:n=>({id:n}),setVerifyModal:n=>({id:n})}),Object(r.reducers)({verifiedDomains:[[],{replaceDomain:(n,s)=>{let{domain:o}=s;const i=[...n.filter(a=>{let{id:d}=a;return d!==o.id}),o];return i.sort((a,d)=>a.domain.localeCompare(d.domain)),i}}],addModalShown:[!1,{setAddModalShown:(n,s)=>{let{shown:o}=s;return o},addVerifiedDomainSuccess:()=>!1}],configureSAMLModalId:[null,{setConfigureSAMLModalId:(n,s)=>{let{id:o}=s;return o}}],verifyModal:[null,{setVerifyModal:(n,s)=>{let{id:o}=s;return o}}]}),Object(Ie.loaders)(n=>{let{values:s,actions:o}=n;return{verifiedDomains:[[],{loadVerifiedDomains:()=>N(this,null,function*(){var i;return(yield J.b.get(`api/organizations/${(i=s.currentOrganization)===null||i===void 0?void 0:i.id}/domains`)).results}),addVerifiedDomain:i=>N(this,null,function*(){var a;return[yield J.b.create(`api/organizations/${(a=s.currentOrganization)===null||a===void 0?void 0:a.id}/domains`,{domain:i}),...s.verifiedDomains]}),deleteVerifiedDomain:i=>N(this,null,function*(){var a;return yield J.b.delete(`api/organizations/${(a=s.currentOrganization)===null||a===void 0?void 0:a.id}/domains/${i}`),[...s.verifiedDomains.filter(d=>d.id!==i)]})}],updatingDomain:[!1,{updateDomain:i=>N(this,null,function*(){var a;const d=yield J.b.update(`api/organizations/${(a=s.currentOrganization)===null||a===void 0?void 0:a.id}/domains/${i.id}`,Oe(ue({},i),{id:void 0}));return ae.d.success("Domain updated successfully! Changes will take immediately."),o.replaceDomain(d),!1}),verifyDomain:()=>N(this,null,function*(){var i;const a=yield J.b.create(`api/organizations/${(i=s.currentOrganization)===null||i===void 0?void 0:i.id}/domains/${s.verifyModal}/verify`);return a.is_verified?ae.d.success("Domain verified successfully."):ae.d.warning("We could not verify your domain yet. DNS propagation may take up to 72 hours. Please try again later."),o.replaceDomain(a),o.setVerifyModal(null),!1})}]}}),Object(r.listeners)(n=>{let{actions:s,values:o}=n;return{setConfigureSAMLModalId:i=>{let{id:a}=i;const d=o.verifiedDomains.find(h=>{let{id:m}=h;return m===a});if(a&&d){const{saml_acs_url:h,saml_entity_id:m,saml_x509_cert:l}=d;s.setSamlConfigValues({saml_acs_url:h,saml_entity_id:m,saml_x509_cert:l,id:a})}}}}),Object(r.selectors)({domainBeingVerified:[n=>[n.verifiedDomains,n.verifyModal],(n,s)=>s&&n.find(o=>{let{id:i}=o;return i===s})||null],isSSOEnforcementAvailable:[n=>[n.currentOrganization],n=>{var s;return(s=n==null?void 0:n.available_features.includes(ee.e.SSO_ENFORCEMENT))!==null&&s!==void 0?s:!1}],isSAMLAvailable:[n=>[n.currentOrganization],n=>{var s;return(s=n==null?void 0:n.available_features.includes(ee.e.SAML))!==null&&s!==void 0?s:!1}]}),Object(r.afterMount)(n=>{let{actions:s}=n;return s.loadVerifiedDomains()}),Object(ge.forms)(n=>{let{actions:s,values:o}=n;return{samlConfig:{defaults:{},errors:i=>({saml_acs_url:i.saml_acs_url&&!i.saml_acs_url.match(p.w)?"Please enter a valid URL, including https://":void 0}),submit:(i,a)=>N(this,null,function*(){var d;const M=i,{id:h}=M,m=Re(M,["id"]);if(!h)return;const l=yield J.b.update(`api/organizations/${(d=o.currentOrganization)===null||d===void 0?void 0:d.id}/domains/${i.id}`,ue({},m));a(),s.replaceDomain(l),s.setConfigureSAMLModalId(null),s.setSamlConfigValues({}),ae.d.success(`SAML configuration for ${l.domain} updated successfully.`)})}}})]);var je=t("./node_modules/.pnpm/@ant-design+icons@4.7.0_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),H=t("./frontend/src/lib/components/LemonModal/index.ts");function Te(){const{addModalShown:n,verifiedDomainsLoading:s}=Object(r.useValues)(k),{setAddModalShown:o,addVerifiedDomain:i}=Object(r.useActions)(k),[a,d]=Object(j.useState)(""),[h,m]=Object(j.useState)(!1),l=!a||!a.match(p.e),M=()=>{d(""),m(!1)},x=()=>{o(!1),M()},w=()=>{m(!0),l||(i(a),M())};return Object(e.jsxs)(H.a,{onClose:x,isOpen:n,title:"Add authentication domain",footer:Object(e.jsx)(c.a,{type:"primary",disabled:a===""||h&&l||s,onClick:w,children:"Add domain"}),children:[Object(e.jsx)(E.LemonInput,{placeholder:"posthog.com",autoFocus:!0,value:a,onChange:d,onPressEnter:w}),h&&l&&Object(e.jsx)("span",{className:"text-danger text-xs",children:"Please enter a valid domain or subdomain name (e.g. my.posthog.com)"})]})}var Pe=t("./frontend/src/scenes/organization/Settings/VerifiedDomains/SSOSelect.tsx"),Y=t("./frontend/src/lib/forms/Field.tsx");function ze(){const{domainBeingVerified:n,updatingDomainLoading:s}=Object(r.useValues)(k),{setVerifyModal:o,verifyDomain:i}=Object(r.useActions)(k),a=`_posthog-challenge.${n==null?void 0:n.domain}.`;return Object(e.jsx)(H.a,{isOpen:!!n,onClose:()=>o(null),title:"Verify your domain",description:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(me.a,{className:"uppercase",children:(n==null?void 0:n.domain)||""}),Object(e.jsx)("p",{children:"To verify your domain, you need to add a record to your DNS zone."})]}),footer:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(c.a,{type:"secondary",onClick:()=>o(null),children:"Verify later"}),Object(e.jsx)(c.a,{type:"primary",disabled:s,onClick:i,children:"Verify"})]}),children:Object(e.jsx)("div",{children:Object(e.jsxs)("ol",{children:[Object(e.jsx)("li",{children:"Sign in to your DNS provider."}),Object(e.jsxs)("li",{children:["Add the following ",Object(e.jsx)("b",{children:"TXT"})," record.",Object(e.jsxs)("div",{className:"my-4 space-y-2",children:[Object(e.jsx)(Y.b,{label:"Name",children:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)("div",{className:"border rounded p-2 h-10 flex-1",children:a}),Object(e.jsx)(y.a,{explicitValue:a})]})}),Object(e.jsx)(Y.b,{label:"Value or content",children:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)("div",{className:"border rounded p-2 h-10 flex-1",children:n==null?void 0:n.verification_challenge}),Object(e.jsx)(y.a,{explicitValue:n==null?void 0:n.verification_challenge})]})}),Object(e.jsx)(Y.b,{label:"TTL",children:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)("div",{className:"border rounded p-2 h-10 flex-1",children:"Default or 3600"}),Object(e.jsx)(y.a,{explicitValue:"3600"})]})})]})]}),Object(e.jsx)("li",{children:"Press verify below."})]})})})}var he=t("./frontend/src/lib/components/Link.tsx"),Ne=t("./frontend/src/lib/components/LemonSwitch/LemonSwitch.tsx"),Ve=t("./frontend/src/lib/components/AlertMessage/index.ts"),ve=t("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),Fe=t("./frontend/src/lib/components/LemonTextArea/LemonTextArea.tsx");function we(){var n;const{configureSAMLModalId:s,isSamlConfigSubmitting:o,samlConfig:i}=Object(r.useValues)(k),{setConfigureSAMLModalId:a}=Object(r.useActions)(k),{preflight:d}=Object(r.useValues)(b.a),h=(n=d==null?void 0:d.site_url)!==null&&n!==void 0?n:window.location.origin,m=i.saml_acs_url&&i.saml_entity_id&&i.saml_x509_cert,l=()=>{a(null)};return Object(e.jsx)(H.a,{onClose:l,isOpen:!!s,title:"",simple:!0,children:Object(e.jsxs)(ge.Form,{logic:k,formKey:"samlConfig",enableFormOnSubmit:!0,className:"LemonModal__layout ",children:[Object(e.jsx)(H.a.Header,{children:Object(e.jsx)("h3",{children:"Configure SAML authentication and provisioning"})}),Object(e.jsxs)(H.a.Content,{className:"space-y-2",children:[Object(e.jsx)(Y.a,{label:"ACS Consumer URL",name:"_ACSConsumerUrl",children:Object(e.jsx)(y.a,{children:`${h}/complete/saml`})}),Object(e.jsx)(Y.a,{label:"RelayState",name:"_RelayState",children:Object(e.jsx)(y.a,{children:s!=null?s:void 0})}),Object(e.jsx)(Y.a,{name:"saml_acs_url",label:"SAML ACS URL",children:Object(e.jsx)(ve.a,{className:"ph-ignore-input",placeholder:"Your IdP's ACS or single sign-on URL."})}),Object(e.jsx)(Y.a,{name:"saml_entity_id",label:"SAML Entity ID",children:Object(e.jsx)(ve.a,{className:"ph-ignore-input",placeholder:"Entity ID provided by your IdP."})}),Object(e.jsx)(Y.a,{name:"saml_x509_cert",label:"SAML X.509 Certificate",children:Object(e.jsx)(Fe.a,{className:"ph-ignore-input",minRows:10,placeholder:`Enter the public certificate of your IdP. Keep all line breaks.
-----BEGIN CERTIFICATE-----
MIICVjCCAb+gAwIBAgIBADANBgkqhkiG9w0BAQ0FADBIMQswCQYDVQQGEwJ1czEL
-----END CERTIFICATE-----`})}),!m&&Object(e.jsx)(Ve.a,{type:"info",children:"SAML will not be enabled unless you enter all attributes above. However you can still settings as draft."})]}),Object(e.jsx)(H.a.Footer,{children:Object(e.jsx)(c.a,{loading:o,type:"primary",htmlType:"submit",children:"Save settings"})})]})})}const Q={marginRight:4,fontSize:"1.15em",paddingTop:2};function Be(){const{verifiedDomainsLoading:n,updatingDomainLoading:s}=Object(r.useValues)(k),{setAddModalShown:o}=Object(r.useActions)(k);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"flex items-center",children:[Object(e.jsxs)("div",{style:{flexGrow:1},children:[Object(e.jsx)("div",{id:"domain-whitelist"})," ",Object(e.jsx)("h2",{id:"authentication-domains",className:"subtitle",children:"Authentication domains"}),Object(e.jsx)("p",{className:"text-muted-alt",children:"Enable users to sign up automatically with an email address on verified domains and enforce SSO for accounts under your domains."})]}),Object(e.jsx)(c.a,{type:"primary",onClick:()=>o(!0),disabled:n||s,children:"Add domain"})]}),Object(e.jsx)(Ue,{})]})}function Ue(){const{verifiedDomains:n,verifiedDomainsLoading:s,currentOrganization:o,updatingDomainLoading:i,isSSOEnforcementAvailable:a,isSAMLAvailable:d}=Object(r.useValues)(k),{updateDomain:h,deleteVerifiedDomain:m,setVerifyModal:l,setConfigureSAMLModalId:M}=Object(r.useActions)(k),{preflight:x}=Object(r.useValues)(b.a),w=[{key:"domain",title:"Domain name",dataIndex:"domain",render:function(P,T){let{domain:z}=T;return Object(e.jsx)(me.a,{children:z})}},...x!=null&&x.cloud?[{key:"is_verified",title:Object(e.jsxs)(e.Fragment,{children:["Verification",Object(e.jsx)(q.a,{title:"Verification (through DNS) is required to use domains for authentication (e.g. SAML or enforce SSO).",children:Object(e.jsx)(je.a,{style:{marginLeft:4}})})]}),render:function(P,T){let{is_verified:z,verified_at:F}=T;return z?Object(e.jsxs)("div",{className:"flex items-center text-success",children:[Object(e.jsx)(u.IconCheckmark,{style:Q})," Verified"]}):F?Object(e.jsxs)("div",{className:"flex items-center text-danger",children:[Object(e.jsx)(u.IconExclamation,{style:Q})," Verification expired"]}):Object(e.jsxs)("div",{className:"flex items-center text-warning",children:[Object(e.jsx)(u.IconWarning,{style:Q})," Pending verification"]})}}]:[],{key:"jit_provisioning_enabled",title:Object(e.jsxs)(e.Fragment,{children:["Automatic provisioning"," ",Object(e.jsx)(q.a,{title:`Enables just-in-time provisioning. If a user logs in with SSO with an email address on this domain an account will be created in ${(o==null?void 0:o.name)||"this organization"} if it does not exist.`,children:Object(e.jsx)(je.a,{})})]}),render:function(P,T){let{jit_provisioning_enabled:z,id:F,is_verified:W}=T;return W?Object(e.jsx)("div",{className:"flex items-center",children:Object(e.jsx)(Ne.a,{checked:z,disabled:i||!W,onChange:K=>h({id:F,jit_provisioning_enabled:K}),label:Object(e.jsx)("span",{className:"font-normal",children:z?"Enabled":"Disabled"})})}):Object(e.jsx)("i",{className:"text-muted-alt",children:"Verify domain to enable automatic provisioning"})}},{key:"sso_enforcement",title:Object(e.jsxs)(e.Fragment,{children:["Enforce SSO"," ",Object(e.jsx)(q.a,{title:"Require users with email addresses on this domain to always log in using a specific SSO provider.",children:Object(e.jsx)(je.a,{})})]}),render:function(P,T,z){let{sso_enforcement:F,is_verified:W,id:K,has_saml:Z}=T;return a?W?Object(e.jsx)(Pe.a,{value:F,loading:i,onChange:ne=>h({id:K,sso_enforcement:ne}),samlAvailable:Z}):Object(e.jsx)("i",{className:"text-muted-alt",children:"Verify domain to enable"}):z===0?Object(e.jsxs)(he.a,{to:Object(p.D)(x==null?void 0:x.cloud).url,target:Object(p.D)(x==null?void 0:x.cloud).target,className:"flex items-center",children:[Object(e.jsx)(u.IconLock,{style:{color:"var(--warning)",marginLeft:4}})," Upgrade to enable SSO enforcement"]}):Object(e.jsx)(e.Fragment,{})}},{key:"saml",title:"SAML",render:function(P,T,z){let{is_verified:F,saml_acs_url:W,saml_entity_id:K,saml_x509_cert:Z,has_saml:ne}=T;return d?F?Object(e.jsx)(e.Fragment,{children:ne?Object(e.jsxs)("div",{className:"flex items-center text-success",children:[Object(e.jsx)(u.IconCheckmark,{style:Q})," SAML enabled"]}):W||K||Z?Object(e.jsxs)("div",{className:"flex items-center text-warning",children:[Object(e.jsx)(u.IconWarning,{style:Q})," SAML partially configured"]}):Object(e.jsxs)("div",{className:"flex items-center",children:[Object(e.jsx)(u.IconOffline,{style:Q})," SAML not set up"]})}):Object(e.jsx)("i",{className:"text-muted-alt",children:"Verify domain to enable"}):z===0?Object(e.jsxs)(he.a,{to:Object(p.D)(x==null?void 0:x.cloud).url,target:Object(p.D)(x==null?void 0:x.cloud).target,className:"flex items-center",children:[Object(e.jsx)(u.IconLock,{style:{color:"var(--warning)",marginLeft:4}})," Upgrade to enable SAML"]}):Object(e.jsx)(e.Fragment,{})}},{key:"actions",width:32,align:"center",render:function(P,T){let{is_verified:z,id:F,domain:W}=T;return z?Object(e.jsx)(fe.a,{overlay:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(c.a,{status:"stealth",onClick:()=>M(F),fullWidth:!0,disabled:!d,title:d?void 0:"Upgrade to enable SAML",children:"Configure SAML"}),Object(e.jsxs)(c.a,{status:"danger",onClick:()=>S.a.open({title:`Remove ${W}?`,description:"This cannot be undone. If you have SAML configured or SSO enforced,it will be immediately disabled.",primaryButton:{status:"danger",children:"Remove domain",onClick:()=>m(F)},secondaryButton:{children:"Cancel"}}),fullWidth:!0,children:[Object(e.jsx)(u.IconDelete,{})," Remove domain"]})]}),style:{display:"inline-block"}}):Object(e.jsx)(c.a,{type:"primary",onClick:()=>l(F),children:"Verify"})}}];return Object(e.jsxs)("div",{children:[Object(e.jsx)(G.a,{dataSource:n,columns:w,loading:s,rowKey:"id",emptyState:"You haven't registered any authentication domains yet."}),Object(e.jsx)(Te,{}),Object(e.jsx)(we,{}),Object(e.jsx)(ze,{})]})}var $e=t("./frontend/src/lib/components/PayGateMini/PayGateMini.tsx"),_e=t("./frontend/src/lib/logic/featureFlagLogic.ts"),be=t("./node_modules/.pnpm/antd@4.17.1_wcqkhtmu7mswc6yz4uyexck3ty/node_modules/antd/es/tabs/index.js"),xe=t("./frontend/src/scenes/urls.ts"),ke=t("./frontend/src/lib/components/TitleWithIcon.tsx"),pe=t("./frontend/src/scenes/organization/Settings/Permissions/permissionsLogic.tsx"),Ke=t("./frontend/src/lib/components/LemonSelectMultiple/LemonSelectMultiple.tsx"),We=t("./frontend/src/lib/components/Spinner/Spinner.tsx"),Ge=t("./frontend/src/lib/components/UserSelectItem.tsx"),re=t("./frontend/src/scenes/organization/Settings/Permissions/Roles/rolesLogic.tsx");function Ye(){const{roleInFocus:n,createRoleModalShown:s,roleMembersToAdd:o,roleMembersInFocusLoading:i,addableMembers:a,rolesLoading:d,roleMembersInFocus:h}=Object(r.useValues)(re.a),{setCreateRoleModalShown:m,setRoleMembersToAdd:l,createRole:M,deleteRoleMember:x,addRoleMembers:w,deleteRole:g}=Object(r.useActions)(re.a),{isAdminOrOwner:P}=Object(r.useValues)(I.a),[T,z]=Object(j.useState)(""),F=()=>{m(!1),l([])},W=()=>{M(T),z("")},K=!n;return Object(e.jsxs)(H.a,{onClose:F,isOpen:s,title:K?"Create role":P?`Edit ${n.name} role`:`${n.name} role`,footer:d?Object(e.jsx)(We.a,{monocolor:!0}):P?Object(e.jsxs)("div",{className:"flex flex-row justify-between w-full",children:[Object(e.jsx)("div",{children:!K&&Object(e.jsx)(c.a,{htmlType:"submit",type:"primary",status:"danger",onClick:()=>g(n),"data-attr":"role-delete-submit",children:"Delete role"})}),Object(e.jsx)(c.a,{type:"primary",onClick:W,children:"Save"})]}):void 0,children:[K&&Object(e.jsxs)("div",{className:"mb-5",children:[Object(e.jsx)("h5",{children:"Role Name"}),Object(e.jsx)(E.LemonInput,{placeholder:"Product",autoFocus:!0,value:T,onChange:z})]}),P&&Object(e.jsxs)("div",{className:"mb-5",children:[Object(e.jsx)("h5",{children:"Members"}),Object(e.jsxs)("div",{className:"flex gap-2",children:[Object(e.jsx)("div",{className:"flex-1",children:Object(e.jsx)(Ke.a,{placeholder:"Search for team members to add\u2026",value:o,loading:i,onChange:Z=>l(Z),filterOption:!0,mode:"multiple","data-attr":"subscribed-emails",options:Object(Ge.a)(a,"uuid")})}),!K&&Object(e.jsx)(c.a,{type:"primary",loading:i,disabled:o.length===0,onClick:()=>w({role:n,membersToAdd:o}),children:"Add"})]})]}),!K&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h5",{children:"Role Members"}),h.length>0?Object(e.jsx)("div",{className:"mt-2 pb-2 rounded overflow-y-auto",style:{maxHeight:300},children:h.map(Z=>Object(e.jsx)(Ze,{member:Z,deleteMember:ne=>x({roleMemberUuid:ne}),isAdminOrOwner:!!P},Z.id))}):Object(e.jsx)("div",{className:"text-muted mb-2",children:"No members added yet"})]})]})}function Ze(n){let{member:s,deleteMember:o,isAdminOrOwner:i}=n;const{user:a}=s;return Object(e.jsxs)("div",{className:"flex items-center justify-between mt-2 h-8",children:[Object(e.jsx)(R.b,{email:a.email,name:a.first_name,size:"md",showName:!0}),i&&o&&Object(e.jsx)(c.a,{icon:Object(e.jsx)(u.IconDelete,{}),onClick:()=>o(s.id),tooltip:"Remove user from role",status:"primary-alt",type:"tertiary",size:"small"})]})}function He(n){switch(n){case ee.T.FEATURE_FLAGS:return"flag";default:return"resource"}}function le(n){let{isRestricted:s}=n;const{resourceRolesAccess:o,organizationResourcePermissionsLoading:i}=Object(r.useValues)(pe.b),{updatePermission:a}=Object(r.useActions)(pe.b),{roles:d,rolesLoading:h}=Object(r.useValues)(re.a),{setRoleInFocus:m,openCreateRoleModal:l}=Object(r.useActions)(re.a),{isAdminOrOwner:M}=Object(r.useValues)(I.a),x=[{key:"role",title:"",width:150,render:function(g,P){return Object(e.jsx)(e.Fragment,{children:P.name=="organization_default"?Object(e.jsx)("b",{children:"All users by default"}):Object(e.jsx)(E.LemonButton,{type:"tertiary",noPadding:!0,onClick:()=>m(P),children:P.name})})}},...o.flatMap(w=>{const g=Object.keys(w)[0];return[{key:"view",title:Object(e.jsx)(q.a,{title:"View defaults cannot be changed",children:Object(e.jsxs)("div",{className:"text-center",children:[g," ",Object(e.jsx)("br",{})," View"]})}),align:"center",render:function(){return Object(e.jsx)("div",{className:"flex justify-center",children:Object(e.jsx)(E.LemonCheckbox,{defaultChecked:!0,disabled:!0,color:"gray"})})}},{key:"edit",title:Object(e.jsx)(ke.a,{icon:Object(e.jsx)(q.a,{title:`You can extend permissions on a per ${He(g)} basis.`,children:Object(e.jsx)(u.IconInfo,{})}),children:Object(e.jsxs)(e.Fragment,{children:[g," ",Object(e.jsx)("br",{})," Edit"]})}),align:"center",render:function(T,z){return Object(e.jsx)("div",{className:"flex justify-center",children:Object(e.jsx)(E.LemonCheckbox,{onChange:F=>{a(F,z,w[g].id,g)},checked:w[`${g}`][z.name]>=ee.a.WRITE,disabled:!M,color:M?"":"gray"})})}}]})];return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"flex flex-row justify-between items-center mb-4",children:[Object(e.jsx)("div",{className:"text-muted-alt",children:"Edit organizational default permission levels for posthog resources. Use roles to apply permissions to specific sets of users."}),!s&&Object(e.jsx)(E.LemonButton,{type:"primary",onClick:l,"data-attr":"create-role-button",children:"Create role"})]}),Object(e.jsx)(E.LemonTable,{bordered:!0,columns:x,loading:h||i,dataSource:[{name:"organization_default"},...d]}),Object(e.jsx)(Ye,{})]})}try{le.displayName="PermissionsGrid",le.__docgenInfo={description:"",displayName:"PermissionsGrid",props:{isRestricted:{defaultValue:null,description:"",name:"isRestricted",required:!0,type:{name:"boolean"}},restrictionReason:{defaultValue:null,description:"",name:"restrictionReason",required:!0,type:{name:"string | null"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/organization/Settings/Permissions/PermissionsGrid.tsx#PermissionsGrid"]={docgenInfo:le.__docgenInfo,name:"PermissionsGrid",path:"frontend/src/scenes/organization/Settings/Permissions/PermissionsGrid.tsx#PermissionsGrid"})}catch(n){}const Je={component:Se,logic:I.a};let ce;(function(n){n.GENERAL="general",n.ROLE_BASED_ACCESS="role_based_access"})(ce||(ce={}));function Qe(n){let{isRestricted:s}=n;const{currentOrganization:o,currentOrganizationLoading:i}=Object(r.useValues)(I.a),{updateOrganization:a}=Object(r.useActions)(I.a),[d,h]=Object(j.useState)((o==null?void 0:o.name)||"");return Object(e.jsxs)("div",{style:{maxWidth:"40rem"},children:[Object(e.jsx)("h2",{id:"name",className:"subtitle mt-0",children:"Display Name"}),Object(e.jsx)(E.LemonInput,{className:"mb-4",value:d,onChange:h,disabled:s}),Object(e.jsx)(E.LemonButton,{type:"primary",onClick:m=>{m.preventDefault(),a({name:d})},disabled:s||!d||!o||d===o.name,loading:i,children:"Rename Organization"})]})}function Xe(n){let{isRestricted:s}=n;const{currentOrganization:o}=Object(r.useValues)(I.a),{updateOrganization:i}=Object(r.useActions)(I.a);return Object(e.jsxs)("div",{children:[Object(e.jsx)("h2",{id:"notification-preferences",className:"subtitle",children:"Notification Preferences"}),Object(e.jsx)("div",{children:Object(e.jsx)(E.LemonSwitch,{"data-attr":"is-member-join-email-enabled-switch",onChange:a=>{i({is_member_join_email_enabled:a})},checked:!!(o!=null&&o.is_member_join_email_enabled),disabled:s||!o,label:"Email all current members when a new member joins",bordered:!0})})]})}const ye=Object(r.kea)({path:["scenes","organization","Settings","index"],actions:{setTab:n=>({tab:n})},reducers:{tab:[ce.GENERAL,{setTab:(n,s)=>{let{tab:o}=s;return o}}]},actionToUrl:()=>({setTab:n=>{let{tab:s}=n;return`${xe.a.organizationSettings()}?tab=${s}`}}),urlToAction:n=>{let{values:s,actions:o}=n;return{[xe.a.organizationSettings()]:(i,a)=>{a.tab&&s.tab!==a.tab&&o.setTab(a.tab)}}}});function Se(){const{user:n}=Object(r.useValues)(_.a),{featureFlags:s}=Object(r.useValues)(_e.a);Object(Ee.a)(location.hash);const{tab:o}=Object(r.useValues)(ye),{setTab:i}=Object(r.useActions)(ye);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(U.a,{title:"Organization Settings",caption:"View and manage your organization here. Build an even better product together."}),Object(e.jsxs)(be.a,{activeKey:o,destroyInactiveTabPane:!0,onChange:a=>i(a),children:[Object(e.jsx)(be.a.TabPane,{tab:"General",children:Object(e.jsxs)("div",{className:"border rounded p-6",children:[Object(e.jsx)(X.a,{Component:Qe,minimumAccessLevel:p.p.Admin}),Object(e.jsx)(E.LemonDivider,{className:"my-6"}),Object(e.jsx)(C,{}),Object(e.jsx)(E.LemonDivider,{className:"my-6"}),n&&Object(e.jsx)(se,{user:n}),Object(e.jsx)(E.LemonDivider,{className:"my-6"}),Object(e.jsx)(X.a,{Component:Be,minimumAccessLevel:p.p.Admin}),Object(e.jsx)(E.LemonDivider,{className:"my-6"}),Object(e.jsx)(X.a,{Component:Xe,minimumAccessLevel:p.p.Admin}),Object(e.jsx)(E.LemonDivider,{className:"my-6"}),Object(e.jsx)(X.a,{Component:oe,minimumAccessLevel:p.p.Owner})]})},"general"),s[p.i.ROLE_BASED_ACCESS]&&Object(e.jsx)(be.a.TabPane,{tab:"Role-based access",children:Object(e.jsx)($e.a,{feature:ee.e.ROLE_BASED_ACCESS,children:Object(e.jsx)(X.a,{Component:le,minimumAccessLevel:p.p.Admin})})},"role_based_access")]})]})}}}]);
