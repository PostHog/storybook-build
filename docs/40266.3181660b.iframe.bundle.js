"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[40266,4235,12666],{"../../frontend/src/lib/components/FilterBar.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{f:()=>FilterBar});var clsx__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),_posthog_icons__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.30.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),_layout_scenes_components_SceneStickyBar__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/layout/scenes/components/SceneStickyBar.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let FilterBar=_ref=>{let{top,left,right,className}=_ref,[expanded,setExpanded]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(_layout_scenes_components_SceneStickyBar__WEBPACK_IMPORTED_MODULE_3__.S,{className:className,children:[top,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between gap-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"flex items-start shrink-0",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:"flex flex-1 flex-row gap-2 items-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"flex flex-row gap-1 items-center flex-1 md:flex-none",children:left}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_2__.Jp,{type:"secondary",size:"small",className:"sm:hidden",onClick:()=>setExpanded(expanded=>!expanded),icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_posthog_icons__WEBPACK_IMPORTED_MODULE_1__.IconFilter,{})})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"hidden sm:flex gap-2",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(FoldableFilters,{children:right})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:(0,clsx__WEBPACK_IMPORTED_MODULE_5__.default)("flex sm:hidden flex-col gap-2 overflow-hidden transition-all duration-200",expanded?"max-h-[500px]":"max-h-0"),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(FoldableFilters,{children:right})})]})]})},FoldableFilters=_ref2=>{let{children}=_ref2;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"flex flex-row md:flex-row-reverse flex-wrap gap-2 md:[&>*]:grow-0 [&>*]:grow w-full",children:children})}},"../../frontend/src/scenes/data-warehouse/editor/outputPaneLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{R:()=>OutputTab,o:()=>outputPaneLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js");let OutputTab=function(OutputTab){return OutputTab.Results="results",OutputTab.Visualization="visualization",OutputTab.Variables="variables",OutputTab.Materialization="materialization",OutputTab.QueryEndpoint="query-endpoint",OutputTab}({}),outputPaneLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["data-warehouse","editor","outputPaneLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.key)(props=>props.tabId),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setActiveTab:tab=>({tab})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({activeTab:[OutputTab.Results,{setActiveTab:(_,_ref)=>{let{tab}=_ref;return tab}}]})])},"../../products/embedded_analytics/frontend/EmbeddedAnalyticsScene.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{EmbeddedAnalyticsScene:()=>EmbeddedAnalyticsScene,scene:()=>scene});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_router__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),lib_components_ProductIntroduction_ProductIntroduction__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/components/ProductIntroduction/ProductIntroduction.tsx"),lib_components_hedgehogs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/components/hedgehogs.tsx"),lib_lemon_ui_LemonBanner__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonBanner/index.ts"),lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/index.ts"),lib_lemon_ui_LemonTabs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTabs/index.ts"),scenes_data_warehouse_editor_outputPaneLogic__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/scenes/data-warehouse/editor/outputPaneLogic.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../frontend/src/scenes/urls.ts"),_layout_scenes_components_SceneContent__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../frontend/src/layout/scenes/components/SceneContent.tsx"),_layout_scenes_components_SceneDivider__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../frontend/src/layout/scenes/components/SceneDivider.tsx"),_layout_scenes_components_SceneTitleSection__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../frontend/src/layout/scenes/components/SceneTitleSection.tsx"),_types__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("../../frontend/src/types.ts"),_QueryEndpoints__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("../../products/embedded_analytics/frontend/QueryEndpoints.tsx"),_Usage__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("../../products/embedded_analytics/frontend/Usage.tsx"),_embeddedAnalyticsLogic__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("../../products/embedded_analytics/frontend/embeddedAnalyticsLogic.tsx"),_queryEndpointsLogic__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("../../products/embedded_analytics/frontend/queryEndpointsLogic.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let scene={component:EmbeddedAnalyticsScene,logic:_embeddedAnalyticsLogic__WEBPACK_IMPORTED_MODULE_15__.s};function EmbeddedAnalyticsScene(_ref){let{tabId}=_ref,{activeTab}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)((0,_embeddedAnalyticsLogic__WEBPACK_IMPORTED_MODULE_15__.s)({tabId:tabId||""})),tabs=[{key:"query-endpoints",label:"Query endpoints",content:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.jsx)(_QueryEndpoints__WEBPACK_IMPORTED_MODULE_13__.QueryEndpoints,{tabId:tabId||""}),link:scenes_urls__WEBPACK_IMPORTED_MODULE_8__.j.embeddedAnalyticsQueryEndpoints()},{key:"usage",label:"API usage",content:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.jsx)(_Usage__WEBPACK_IMPORTED_MODULE_14__.Usage,{tabId:tabId||""}),link:scenes_urls__WEBPACK_IMPORTED_MODULE_8__.j.embeddedAnalyticsUsage()}];return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.jsx)(kea__WEBPACK_IMPORTED_MODULE_0__.BindLogic,{logic:_embeddedAnalyticsLogic__WEBPACK_IMPORTED_MODULE_15__.s,props:{key:"embeddedAnalyticsScene",tabId:tabId||""},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.jsx)(kea__WEBPACK_IMPORTED_MODULE_0__.BindLogic,{logic:_queryEndpointsLogic__WEBPACK_IMPORTED_MODULE_16__.N,props:{key:"queryEndpointsLogic",tabId:tabId||""},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.jsxs)(_layout_scenes_components_SceneContent__WEBPACK_IMPORTED_MODULE_9__._,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.jsx)(_layout_scenes_components_SceneTitleSection__WEBPACK_IMPORTED_MODULE_11__.s,{name:"Embedded analytics",description:"Define queries your application will use via the API and monitor their cost and usage.",resourceType:{type:"embedded_analytics"},actions:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_5__.J,{size:"small","data-attr":"new-query-endpoint",onClick:()=>{kea_router__WEBPACK_IMPORTED_MODULE_1__.router.actions.push(scenes_urls__WEBPACK_IMPORTED_MODULE_8__.j.sqlEditor(void 0,void 0,void 0,void 0,scenes_data_warehouse_editor_outputPaneLogic__WEBPACK_IMPORTED_MODULE_7__.R.QueryEndpoint))},type:"primary",tooltip:"Redirects you to the SQL Editor.",children:"New query endpoint"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.jsx)(lib_lemon_ui_LemonBanner__WEBPACK_IMPORTED_MODULE_4__.V,{type:"warning",dismissKey:"embedded-analytics-beta-banner",action:{children:"Send feedback",id:"embedded-analytics-feedback-button"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.jsx)("p",{children:"Embedded analytics is in alpha and it may not be fully reliable. We are actively working on it and it may change while we work with you on what works best. Please let us know what you'd like to see here and/or report any issues directly to us!"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.jsx)(_layout_scenes_components_SceneDivider__WEBPACK_IMPORTED_MODULE_10__.V,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.jsx)(lib_components_ProductIntroduction_ProductIntroduction__WEBPACK_IMPORTED_MODULE_2__.C,{productName:"embedded analytics",productKey:_types__WEBPACK_IMPORTED_MODULE_12__.Md.EMBEDDED_ANALYTICS,thingName:"query endpoint",description:"query-endpoints"===activeTab?"Embedded analytics help you create pre-built SQL queries that you can easily use in your application via our API. Please note that embedded analytics is in alpha and may not be fully reliable or set in stone.":"Monitor your API usage and cost. Please note that embedded analytics is in alpha and may not be fully reliable or set in stone.",docsURL:"https://posthog.com/docs/embedded-analytics",customHog:lib_components_hedgehogs__WEBPACK_IMPORTED_MODULE_3__.BigLeaguesHog,isEmpty:!1,action:()=>kea_router__WEBPACK_IMPORTED_MODULE_1__.router.actions.push(scenes_urls__WEBPACK_IMPORTED_MODULE_8__.j.sqlEditor(void 0,void 0,void 0,void 0,scenes_data_warehouse_editor_outputPaneLogic__WEBPACK_IMPORTED_MODULE_7__.R.QueryEndpoint))}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.jsx)(lib_lemon_ui_LemonTabs__WEBPACK_IMPORTED_MODULE_6__.T,{activeKey:activeTab,"data-attr":"embedded-analytics-tabs",tabs:tabs,sceneInset:!0})]})})})}},"../../products/embedded_analytics/frontend/QueryEndpoints.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{QueryEndpoints:()=>QueryEndpoints,QueryEndpointsTable:()=>QueryEndpointsTable});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_router__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/index.ts"),lib_lemon_ui_LemonButton_More__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/More.tsx"),lib_lemon_ui_LemonDivider__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonDivider/index.ts"),lib_lemon_ui_LemonInput__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonInput/index.ts"),lib_lemon_ui_LemonTable__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/index.ts"),lib_lemon_ui_LemonTable_LemonTableLink__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/LemonTableLink.tsx"),lib_lemon_ui_LemonTable_columnUtils__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/columnUtils.tsx"),lib_lemon_ui_LemonTag__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTag/index.ts"),lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonToast/LemonToast.tsx"),scenes_urls__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../frontend/src/scenes/urls.ts"),_queryEndpointLogic__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("../../products/embedded_analytics/frontend/queryEndpointLogic.tsx"),_queryEndpointsLogic__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("../../products/embedded_analytics/frontend/queryEndpointsLogic.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function QueryEndpoints(_ref){let{tabId}=_ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.Fragment,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)(QueryEndpointsTable,{tabId:tabId})})}let QueryEndpointsTable=_ref2=>{let{tabId}=_ref2,{setFilters}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)((0,_queryEndpointsLogic__WEBPACK_IMPORTED_MODULE_13__.N)({tabId})),{queryEndpoints,queryEndpointsLoading,filters}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useValues)((0,_queryEndpointsLogic__WEBPACK_IMPORTED_MODULE_13__.N)({tabId})),{deleteQueryEndpoint,deactivateQueryEndpoint}=(0,kea__WEBPACK_IMPORTED_MODULE_0__.useActions)((0,_queryEndpointLogic__WEBPACK_IMPORTED_MODULE_12__.$)({tabId})),columns=[{title:"Name",key:"name",dataIndex:"name",width:"25%",render:function Render(_,record){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)(lib_lemon_ui_LemonTable_LemonTableLink__WEBPACK_IMPORTED_MODULE_7__.i,{title:record.name,description:record.description})},sorter:(a,b)=>a.name.localeCompare(b.name)},(0,lib_lemon_ui_LemonTable_columnUtils__WEBPACK_IMPORTED_MODULE_8__.rw)(),(0,lib_lemon_ui_LemonTable_columnUtils__WEBPACK_IMPORTED_MODULE_8__.JB)(),(0,lib_lemon_ui_LemonTable_columnUtils__WEBPACK_IMPORTED_MODULE_8__.pD)("last_executed_at","Last executed at"),{title:"Endpoint path",key:"endpoint_path",dataIndex:"endpoint_path",render:(_,record)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_2__.J,{type:"secondary",size:"xsmall",onClick:()=>{navigator.clipboard.writeText(record.endpoint_path),lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_10__.UJ.success("Endpoint URL copied to clipboard")},className:"font-mono text-xs",children:record.endpoint_path})},{title:"Status",key:"is_active",dataIndex:"is_active",align:"center",render:(_,record)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)("span",{children:record.is_active?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)(lib_lemon_ui_LemonTag__WEBPACK_IMPORTED_MODULE_9__.o,{type:"success",children:"Active"}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)(lib_lemon_ui_LemonTag__WEBPACK_IMPORTED_MODULE_9__.o,{type:"danger",children:"Inactive"})}),sorter:(a,b)=>Number(b.is_active)-Number(a.is_active)},{key:"actions",width:0,render:(_,record)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)(lib_lemon_ui_LemonButton_More__WEBPACK_IMPORTED_MODULE_3__.T,{overlay:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_2__.J,{onClick:()=>{kea_router__WEBPACK_IMPORTED_MODULE_1__.router.actions.push(scenes_urls__WEBPACK_IMPORTED_MODULE_11__.j.embeddedAnalyticsUsage({requestNameFilter:[record.name]}))},fullWidth:!0,children:"View usage"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)(lib_lemon_ui_LemonDivider__WEBPACK_IMPORTED_MODULE_4__.p,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_2__.J,{onClick:()=>{deactivateQueryEndpoint(record.name)},fullWidth:!0,status:"alt",children:"Deactivate query endpoint"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)(lib_lemon_ui_LemonButton__WEBPACK_IMPORTED_MODULE_2__.J,{onClick:()=>{deleteQueryEndpoint(record.name)},fullWidth:!0,status:"danger",children:"Delete query endpoint"})]})})}];return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)("div",{className:"flex justify-between gap-2 flex-wrap",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)(lib_lemon_ui_LemonInput__WEBPACK_IMPORTED_MODULE_5__.D,{type:"search",className:"w-1/3",placeholder:"Search for query endpoints",onChange:x=>setFilters({search:x}),value:filters.search})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__.jsx)(lib_lemon_ui_LemonTable__WEBPACK_IMPORTED_MODULE_6__.g,{"data-attr":"query-endpoints-table",pagination:{pageSize:20},dataSource:queryEndpoints,rowKey:"id",rowClassName:record=>record._highlight?"highlighted":null,columns:columns,loading:queryEndpointsLoading,emptyState:"No query endpoints matching your filters!",nouns:["query endpoint","query endpoints"]})]})}},"../../products/embedded_analytics/frontend/Usage.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Usage:()=>Usage});var clsx_m=__webpack_require__("../../node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),Query=__webpack_require__("../../frontend/src/queries/Query/Query.tsx"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),DateFilter=__webpack_require__("../../frontend/src/lib/components/DateFilter/DateFilter.tsx"),FilterBar=__webpack_require__("../../frontend/src/lib/components/FilterBar.tsx"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),embeddedAnalyticsLogic=__webpack_require__("../../products/embedded_analytics/frontend/embeddedAnalyticsLogic.tsx"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let embeddedAnalyticsDateMapping=[{key:"Last 24 hours",values:["-24h"],getFormattedDate:date=>(0,utils._Q)(date.subtract(24,"h"),date.endOf("d")),defaultInterval:"hour"},{key:"Last 48 hours",values:["-48h"],getFormattedDate:date=>(0,utils._Q)(date.subtract(48,"h"),date.endOf("d")),defaultInterval:"hour"},{key:"Last 7 days",values:["-7d"],getFormattedDate:date=>(0,utils._Q)(date.subtract(7,"d"),date.endOf("d")),defaultInterval:"day"},{key:"Last 14 days",values:["-14d"],getFormattedDate:date=>(0,utils._Q)(date.subtract(14,"d"),date.endOf("d")),defaultInterval:"day"},{key:"Last 30 days",values:["-30d"],getFormattedDate:date=>(0,utils._Q)(date.subtract(30,"d"),date.endOf("d")),defaultInterval:"day"},{key:"Last 90 days",values:["-90d"],getFormattedDate:date=>(0,utils._Q)(date.subtract(90,"d"),date.endOf("d")),defaultInterval:"day"},{key:"Year to date",values:["yStart"],getFormattedDate:date=>(0,utils._Q)(date.startOf("y"),date.endOf("d")),defaultInterval:"day"}],RequestNameBreakdownToggle=_ref=>{let{tabId}=_ref,{requestNameBreakdownEnabled}=(0,index_esm.useValues)((0,embeddedAnalyticsLogic.s)({tabId})),{setRequestNameBreakdownEnabled}=(0,index_esm.useActions)((0,embeddedAnalyticsLogic.s)({tabId}));return(0,jsx_runtime.jsxs)(src.Jp,{onClick:()=>setRequestNameBreakdownEnabled(!requestNameBreakdownEnabled),type:"secondary",size:"small",children:["Breakdown by request name ",(0,jsx_runtime.jsx)(src.f4,{checked:requestNameBreakdownEnabled,className:"ml-1"})]})},RequestNameFilter=_ref2=>{let{value,onChange,tabId}=_ref2,{requestNames,requestNamesLoading}=(0,index_esm.useValues)((0,embeddedAnalyticsLogic.s)({tabId})),options=requestNames.map(requestName=>({key:requestName,label:requestName,value:requestName}));return(0,jsx_runtime.jsx)(src.nt,{title:"Request names",autoWidth:!1,popoverClassName:"max-h-60 max-w-s overflow-y-auto",className:"max-h-30 max-w-s overflow-y-auto",value:value.map(v=>v.toString()),loading:requestNamesLoading,onChange:newValues=>{onChange(requestNames.filter(requestName=>newValues.includes(requestName)))},mode:"multiple",options:options,"data-attr":"request-names",bulkActions:"select-and-clear-all",displayMode:"count"})},UsageFilters=_ref3=>{let{tabs,tabId}=_ref3,{dateFilter,activeTab,requestNameFilter}=(0,index_esm.useValues)((0,embeddedAnalyticsLogic.s)({tabId})),{setDates,setRequestNameFilter}=(0,index_esm.useActions)((0,embeddedAnalyticsLogic.s)({tabId}));return"usage"===activeTab?(0,jsx_runtime.jsx)(FilterBar.f,{className:"m-0 px-0 rounded-none",top:tabs,left:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(DateFilter.f,{dateFrom:dateFilter.dateFrom,dateTo:dateFilter.dateTo,onChange:setDates,forceGranularity:"day",dateOptions:embeddedAnalyticsDateMapping}),(0,jsx_runtime.jsx)(RequestNameBreakdownToggle,{tabId:tabId}),(0,jsx_runtime.jsx)(RequestNameFilter,{value:requestNameFilter,onChange:setRequestNameFilter,tabId:tabId})]})}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})};function Usage(_ref){let{tabId}=_ref,{tiles}=(0,index_esm.useValues)((0,embeddedAnalyticsLogic.s)({tabId}));return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(UsageFilters,{tabId:tabId}),(0,jsx_runtime.jsx)(UsageTiles,{tiles:tiles})]})}let UsageTiles=props=>{let{tiles}=props;return(0,jsx_runtime.jsx)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-4 gap-x-4 gap-y-8",children:tiles.map((tile,i)=>"query"===tile.kind?(0,jsx_runtime.jsx)(UsageQueryTileItem,{tile:tile},i):null)})},UsageQueryTileItem=_ref2=>{var _layout$colSpanClassN,_layout$rowSpanClassN,_layout$orderWhenLarg;let{tile}=_ref2,{query,title,layout}=tile;return(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.default)("col-span-1 row-span-1 flex flex-col",null!==(_layout$colSpanClassN=layout.colSpanClassName)&&void 0!==_layout$colSpanClassN?_layout$colSpanClassN:"md:col-span-6",null!==(_layout$rowSpanClassN=layout.rowSpanClassName)&&void 0!==_layout$rowSpanClassN?_layout$rowSpanClassN:"md:row-span-1",null!==(_layout$orderWhenLarg=layout.orderWhenLargeClassName)&&void 0!==_layout$orderWhenLarg?_layout$orderWhenLarg:"xxl:order-12",layout.className),children:[title&&(0,jsx_runtime.jsx)("div",{className:"flex flex-row items-center mb-3",children:(0,jsx_runtime.jsx)("h2",{children:title})}),(0,jsx_runtime.jsx)(Query.A,{query:query,readOnly:!0},`${tile.tileId}-${"DataVisualizationNode"===query.kind?JSON.stringify(query.chartSettings?.seriesBreakdownColumn):"no-breakdown"}`)]})}},"../../products/embedded_analytics/frontend/embeddedAnalyticsLogic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{s:()=>embeddedAnalyticsLogic});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.7_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),kea_router_lib=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),api=__webpack_require__("../../frontend/src/lib/api.ts"),dayjs=__webpack_require__("../../frontend/src/lib/dayjs.ts"),tabAwareActionToUrl=__webpack_require__("../../frontend/src/lib/logic/scenes/tabAwareActionToUrl.ts"),tabAwareUrlToAction=__webpack_require__("../../frontend/src/lib/logic/scenes/tabAwareUrlToAction.ts"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),sceneLogic=__webpack_require__("../../frontend/src/scenes/sceneLogic.tsx"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),schema_general=__webpack_require__("../../frontend/src/queries/schema/schema-general.ts"),queries_utils=__webpack_require__("../../frontend/src/queries/utils.ts"),types=__webpack_require__("../../frontend/src/types.ts");let EmbeddedAnalyticsTileId=function(EmbeddedAnalyticsTileId){return EmbeddedAnalyticsTileId.API_QUERIES_COUNT="API_QUERIES_COUNT",EmbeddedAnalyticsTileId.API_READ_TB="API_READ_TB",EmbeddedAnalyticsTileId.API_CPU_SECONDS="API_CPU_SECONDS",EmbeddedAnalyticsTileId.API_QUERIES_PER_KEY="API_QUERIES_PER_KEY",EmbeddedAnalyticsTileId.API_LAST_20_QUERIES="API_LAST_20_QUERIES",EmbeddedAnalyticsTileId.API_EXPENSIVE_QUERIES="API_EXPENSIVE_QUERIES",EmbeddedAnalyticsTileId.API_FAILED_QUERIES="API_FAILED_QUERIES",EmbeddedAnalyticsTileId}({});EmbeddedAnalyticsTileId.API_QUERIES_COUNT,EmbeddedAnalyticsTileId.API_READ_TB,EmbeddedAnalyticsTileId.API_CPU_SECONDS,EmbeddedAnalyticsTileId.API_QUERIES_PER_KEY,EmbeddedAnalyticsTileId.API_LAST_20_QUERIES,EmbeddedAnalyticsTileId.API_EXPENSIVE_QUERIES,EmbeddedAnalyticsTileId.API_FAILED_QUERIES;let createRequestNameFilterClause=requestNameFilter=>{if(0===requestNameFilter.length)return"";let escapedNames=requestNameFilter.map(name=>`'${name.replace(/'/g,"''")}'`).join(", ");return`and name in (${escapedNames})`},createExpensiveQueriesColumns=requestNameBreakdownEnabled=>{let baseColumns=[{column:"query_start_time",settings:{formatting:{prefix:"",suffix:""}}},{column:"query",settings:{formatting:{prefix:"",suffix:""}}},{column:"query_duration_ms",settings:{formatting:{prefix:"",suffix:""}}},{column:"read_tb",settings:{formatting:{prefix:"",suffix:""}}},{column:"cpu_sec",settings:{formatting:{prefix:"",suffix:""}}},{column:"created_by",settings:{formatting:{prefix:"",suffix:""}}}];return requestNameBreakdownEnabled?[...baseColumns,{column:"name",settings:{formatting:{prefix:"",suffix:""}}}]:baseColumns},createLast20QueriesColumns=requestNameBreakdownEnabled=>{let baseColumns=[{column:"finished_at",settings:{formatting:{prefix:"",suffix:""}}},{column:"query_duration_ms",settings:{formatting:{prefix:"",suffix:""}}},{column:"query",settings:{formatting:{prefix:"",suffix:""}}},{column:"created_by",settings:{formatting:{prefix:"",suffix:""}}}];return requestNameBreakdownEnabled?[...baseColumns,{column:"name",settings:{formatting:{prefix:"",suffix:""}}}]:baseColumns},createFailedQueriesColumns=()=>[{column:"finished_at",settings:{formatting:{prefix:"",suffix:""}}},{column:"query_id",settings:{formatting:{prefix:"",suffix:""}}},{column:"query",settings:{formatting:{prefix:"",suffix:""}}},{column:"endpoint",settings:{formatting:{prefix:"",suffix:""}}},{column:"query_duration_ms",settings:{formatting:{prefix:"",suffix:""}}},{column:"name",settings:{formatting:{prefix:"",suffix:""}}},{column:"read_tb",settings:{formatting:{prefix:"",suffix:""}}},{column:"human_readable_read_size",settings:{formatting:{prefix:"",suffix:""}}},{column:"cpu_sec",settings:{formatting:{prefix:"",suffix:""}}},{column:"memory_usage",settings:{formatting:{prefix:"",suffix:""}}},{column:"status",settings:{formatting:{prefix:"",suffix:""}}},{column:"exception_code",settings:{formatting:{prefix:"",suffix:""}}},{column:"exception_name",settings:{formatting:{prefix:"",suffix:""}}}],createApiQueriesCountQuery=_ref=>{let{dateFrom,dateTo,requestNameBreakdownEnabled,requestNameFilter}=_ref;return`
    select 
        event_date, 
        ${requestNameBreakdownEnabled?"name,":""} 
        count(1) as number_of_queries
    from query_log
    where is_personal_api_key_request 
        and event_date >= '${dateFrom}' 
        and event_date <= '${dateTo}'
        ${createRequestNameFilterClause(requestNameFilter)}
    group by event_date ${requestNameBreakdownEnabled?", name":""}
    order by event_date asc ${requestNameBreakdownEnabled?", name asc":""}`},createApiReadTbQuery=_ref2=>{let{dateFrom,dateTo,requestNameBreakdownEnabled,requestNameFilter}=_ref2;return`
    select 
        event_date, 
        ${requestNameBreakdownEnabled?"name,":""}
        sum(read_bytes)/1e12 as read_tb
    from query_log
    where 
        is_personal_api_key_request 
        and event_date >= '${dateFrom}' 
        and event_date <= '${dateTo}'
        ${createRequestNameFilterClause(requestNameFilter)}
    group by event_date ${requestNameBreakdownEnabled?", name":""}
    order by event_date asc ${requestNameBreakdownEnabled?", name asc":""}`},createApiCpuSecondsQuery=_ref3=>{let{dateFrom,dateTo,requestNameBreakdownEnabled,requestNameFilter}=_ref3;return`
    select 
        event_date, 
        ${requestNameBreakdownEnabled?"name,":""}
        sum(cpu_microseconds)/1e6 as cpu_sec
    from query_log
    where 
        is_personal_api_key_request 
        and event_date >= '${dateFrom}' 
        and event_date <= '${dateTo}'
        ${createRequestNameFilterClause(requestNameFilter)}
    group by event_date ${requestNameBreakdownEnabled?", name":""}
    order by event_date asc ${requestNameBreakdownEnabled?", name asc":""}`},createApiQueriesPerKeyQuery=_ref4=>{let{dateFrom,dateTo}=_ref4;return`
    select 
        event_date, 
        api_key_label, 
        count(1) as total_queries
    from query_log 
    where 
        event_date >= '${dateFrom}'
        and event_date <= '${dateTo}'
        and is_personal_api_key_request
    group by event_date, api_key_label
    order by event_date`},createLast20QueriesQuery=_ref5=>{let{dateFrom,dateTo,requestNameBreakdownEnabled,requestNameFilter}=_ref5;return`
    select 
        event_time as finished_at, 
        ${requestNameBreakdownEnabled?"name,":""}
        query, 
        query_duration_ms, 
        api_key_label,
        created_by 
    from query_log
    where
        is_personal_api_key_request
        and event_date >= '${dateFrom}'
        and event_date <= '${dateTo}'
        ${createRequestNameFilterClause(requestNameFilter)}
    order by event_time desc
    limit 20`},createExpensiveQueriesQuery=_ref6=>{let{dateFrom,dateTo,requestNameBreakdownEnabled,requestNameFilter}=_ref6;return`
    select 
        query_start_time, 
        ${requestNameBreakdownEnabled?"name,":""}
        query,
        query_duration_ms,
        api_key_label,
        read_bytes / 1e12 as read_tb,
        formatReadableSize(read_bytes) as human_readable_read_size,
        cpu_microseconds / 1e6 as cpu_sec,
        memory_usage,
        created_by
    from query_log
    where 
        is_personal_api_key_request
        and event_date >= '${dateFrom}'
        and event_date <= '${dateTo}'
        ${createRequestNameFilterClause(requestNameFilter)}
    order by read_tb desc, event_time desc
    limit 25`},createFailedQueriesQuery=_ref7=>{let{dateFrom,dateTo}=_ref7;return`
    select 
        event_time as finished_at,
        query_id,
        endpoint,
        query, 
        query_duration_ms,
        name,
        read_bytes / 1e12 as read_tb,
        formatReadableSize(read_bytes) as human_readable_read_size,
        cpu_microseconds / 1e6 as cpu_sec,
        memory_usage,
        status,
        exception_code, 
        exception_name,
    from query_log 
    where 
        is_personal_api_key_request
        and exception_code != 0 
        and event_date >= '${dateFrom}'
        and event_date <= '${dateTo}'
    order by read_tb desc, event_time desc
    limit 25`},embeddedAnalyticsLogic=(0,index_esm.kea)([(0,index_esm.path)(["products","embedded_analytics","frontend","embeddedAnalyticsLogic"]),(0,index_esm.props)({}),(0,index_esm.key)(props=>props.tabId),(0,index_esm.connect)(()=>({values:[sceneLogic.k,["sceneKey"]]})),(0,index_esm.actions)({setDates:(dateFrom,dateTo)=>({dateFrom,dateTo}),setRequestNameFilter:requestNameFilter=>({requestNameFilter}),setRequestNameBreakdownEnabled:requestNameBreakdownEnabled=>({requestNameBreakdownEnabled}),setSearch:search=>({search})}),(0,index_esm.reducers)({dateFilter:[{dateFrom:"-7d",dateTo:null},{setDates:(_,_ref)=>{let{dateFrom,dateTo}=_ref;return{dateFrom,dateTo}}}],requestNameFilter:[[],{setRequestNameFilter:(_,_ref2)=>{let{requestNameFilter}=_ref2;return requestNameFilter}}],requestNameBreakdownEnabled:[!1,{setRequestNameBreakdownEnabled:(_,_ref3)=>{let{requestNameBreakdownEnabled}=_ref3;return requestNameBreakdownEnabled}}],search:["",{setSearch:(_,_ref4)=>{let{search}=_ref4;return search}}]}),(0,lib.loaders)({requestNames:[[],{loadRequestNames:async()=>{let query=(0,queries_utils.zP)`
                        SELECT DISTINCT name
                        FROM query_log
                        WHERE is_personal_api_key_request
                            AND name IS NOT NULL
                            AND name != ''
                        ORDER BY name ASC
                    `,response=await api.ZP.queryHogQL(query,{refresh:"force_blocking"});return response.results?.map(row=>row[0])||[]}}]}),(0,index_esm.selectors)({activeTab:[s=>[s.sceneKey],sceneKey=>"embeddedAnalyticsUsage"===sceneKey?"usage":"query-endpoints"],tiles:[s=>[s.dateFilter,s.requestNameBreakdownEnabled,s.requestNameFilter,s.activeTab],(dateFilter,requestNameBreakdownEnabled,requestNameFilter,activeTab)=>{if("query-endpoints"===activeTab)return[];let dateFromDayjs=(0,utils.FZ)(dateFilter.dateFrom),dateToDayjs=dateFilter.dateTo?(0,utils.FZ)(dateFilter.dateTo):null,queryConfig={dateFrom:dateFromDayjs?dateFromDayjs.format("YYYY-MM-DD"):(0,dayjs.Bv)().subtract(7,"day").format("YYYY-MM-DD"),dateTo:dateToDayjs?dateToDayjs.format("YYYY-MM-DD"):(0,dayjs.Bv)().format("YYYY-MM-DD"),requestNameBreakdownEnabled,requestNameFilter},expensiveQueriesColumns=createExpensiveQueriesColumns(requestNameBreakdownEnabled),last20QueriesColumns=createLast20QueriesColumns(requestNameBreakdownEnabled),failedQueriesColumns=createFailedQueriesColumns(),apiQueriesCountQuery=createApiQueriesCountQuery(queryConfig),apiReadTbQuery=createApiReadTbQuery(queryConfig),apiCpuSecondsQuery=createApiCpuSecondsQuery(queryConfig),apiQueriesPerKeyQuery=createApiQueriesPerKeyQuery(queryConfig),last20QueriesQuery=createLast20QueriesQuery(queryConfig),expensiveQueriesQuery=createExpensiveQueriesQuery(queryConfig),failedQueriesQuery=createFailedQueriesQuery(queryConfig);return[{kind:"query",tileId:EmbeddedAnalyticsTileId.API_QUERIES_COUNT,title:"Number of API requests per day",layout:{colSpanClassName:"md:col-span-2"},query:{kind:schema_general.OH.DataVisualizationNode,source:{kind:schema_general.OH.HogQLQuery,query:apiQueriesCountQuery},display:types.Qb.ActionsBar,chartSettings:{xAxis:{column:"event_date"},yAxis:[{column:"number_of_queries",settings:{formatting:{prefix:"",suffix:""}}}],showLegend:!!requestNameBreakdownEnabled,seriesBreakdownColumn:requestNameBreakdownEnabled?"name":null}},insightProps:{dashboardItemId:"embedded_analytics_api_queries",cachedInsight:null},canOpenInsight:!1,canOpenModal:!1},{kind:"query",tileId:EmbeddedAnalyticsTileId.API_READ_TB,title:"TB read by API requests per day",layout:{colSpanClassName:"md:col-span-2"},query:{kind:schema_general.OH.DataVisualizationNode,source:{kind:schema_general.OH.HogQLQuery,query:apiReadTbQuery},display:types.Qb.ActionsBar,chartSettings:{xAxis:{column:"event_date"},yAxis:[{column:"read_tb",settings:{formatting:{prefix:"",suffix:""}}}],showLegend:!!requestNameBreakdownEnabled,seriesBreakdownColumn:requestNameBreakdownEnabled?"name":null}},insightProps:{dashboardItemId:"embedded_analytics_read_tb",cachedInsight:null},canOpenInsight:!1,canOpenModal:!1},{kind:"query",tileId:EmbeddedAnalyticsTileId.API_CPU_SECONDS,title:"CPU seconds used by API requests per day",layout:{colSpanClassName:"md:col-span-2"},query:{kind:schema_general.OH.DataVisualizationNode,source:{kind:schema_general.OH.HogQLQuery,query:apiCpuSecondsQuery},display:types.Qb.ActionsLineGraph,chartSettings:{xAxis:{column:"event_date"},yAxis:[{column:"cpu_sec",settings:{formatting:{prefix:"",suffix:""}}}],showLegend:!!requestNameBreakdownEnabled,seriesBreakdownColumn:requestNameBreakdownEnabled?"name":null}},insightProps:{dashboardItemId:"embedded_analytics_cpu_sec",cachedInsight:null},canOpenInsight:!1,canOpenModal:!1},{kind:"query",tileId:EmbeddedAnalyticsTileId.API_QUERIES_PER_KEY,title:"Number of API requests by personal api key per day",layout:{colSpanClassName:"md:col-span-2"},query:{kind:schema_general.OH.DataVisualizationNode,source:{kind:schema_general.OH.HogQLQuery,query:apiQueriesPerKeyQuery},display:types.Qb.ActionsLineGraph,chartSettings:{xAxis:{column:"event_date"},yAxis:[{column:"total_queries",settings:{formatting:{prefix:"",suffix:""}}}],showLegend:!0,seriesBreakdownColumn:"api_key_label"}},insightProps:{dashboardItemId:"embedded_analytics_queries_per_key",cachedInsight:null},canOpenInsight:!1,canOpenModal:!1},{kind:"query",tileId:EmbeddedAnalyticsTileId.API_LAST_20_QUERIES,title:"Last 20 API requests",layout:{colSpanClassName:"md:col-span-full"},query:{kind:schema_general.OH.DataVisualizationNode,source:{kind:schema_general.OH.HogQLQuery,query:last20QueriesQuery},display:types.Qb.ActionsTable,tableSettings:{columns:last20QueriesColumns,conditionalFormatting:[]}},insightProps:{dashboardItemId:"embedded_analytics_last_20_queries",cachedInsight:null},canOpenInsight:!1,canOpenModal:!1},{kind:"query",tileId:EmbeddedAnalyticsTileId.API_EXPENSIVE_QUERIES,title:"25 most expensive API request queries",layout:{colSpanClassName:"md:col-span-full"},query:{kind:schema_general.OH.DataVisualizationNode,source:{kind:schema_general.OH.HogQLQuery,query:expensiveQueriesQuery},display:types.Qb.ActionsTable,tableSettings:{columns:expensiveQueriesColumns,conditionalFormatting:[]}},insightProps:{dashboardItemId:"embedded_analytics_expensive_queries",cachedInsight:null},canOpenInsight:!1,canOpenModal:!1},{kind:"query",tileId:EmbeddedAnalyticsTileId.API_FAILED_QUERIES,title:"Recently failed API request queries",layout:{colSpanClassName:"md:col-span-full"},query:{kind:schema_general.OH.DataVisualizationNode,source:{kind:schema_general.OH.HogQLQuery,query:failedQueriesQuery},display:types.Qb.ActionsTable,tableSettings:{columns:failedQueriesColumns,conditionalFormatting:[]}},insightProps:{dashboardItemId:"embedded_analytics_failed_queries",cachedInsight:null},canOpenInsight:!1,canOpenModal:!1}]}],breadcrumbs:[s=>[s.activeTab],()=>[{key:"EmbeddedAnalytics",name:"Embedded analytics",iconType:"embedded_analytics"}]]}),(0,index_esm.afterMount)(_ref5=>{let{actions}=_ref5;actions.loadRequestNames()}),(0,tabAwareActionToUrl.N)(_ref6=>{let{values}=_ref6,actionToUrl=_ref7=>{let{dateFilter=values.dateFilter,requestNameBreakdownEnabled=values.requestNameBreakdownEnabled,requestNameFilter=values.requestNameFilter}=_ref7,{dateFrom,dateTo}=dateFilter,searchParams={...kea_router_lib.router.values.searchParams};return"usage"==values.activeTab?("-7d"!==dateFrom?searchParams.dateFrom=dateFrom:delete searchParams.dateFrom,null!==dateTo?searchParams.dateTo=dateTo:delete searchParams.dateTo,!1!==requestNameBreakdownEnabled?searchParams.requestNameBreakdownEnabled=requestNameBreakdownEnabled:delete searchParams.requestNameBreakdownEnabled,requestNameFilter.length>0?searchParams.requestNameFilter=requestNameFilter.join(","):delete searchParams.requestNameFilter):(delete searchParams.dateFrom,delete searchParams.dateTo,delete searchParams.requestNameBreakdownEnabled,delete searchParams.requestNameFilter),[kea_router_lib.router.values.location.pathname,searchParams,kea_router_lib.router.values.location.hash]};return{setDates:actionToUrl,setRequestNameBreakdownEnabled:actionToUrl,setRequestNameFilter:actionToUrl}}),(0,tabAwareUrlToAction.O)(_ref8=>{let{actions}=_ref8;return{[urls.j.embeddedAnalyticsUsage()]:(_,searchParams)=>{let{dateFrom,dateTo,requestNameBreakdownEnabled,requestNameFilter}=searchParams;actions.setDates(null!=dateFrom?dateFrom:"-7d",null!=dateTo?dateTo:null),actions.setRequestNameBreakdownEnabled(null!=requestNameBreakdownEnabled&&requestNameBreakdownEnabled),actions.setRequestNameFilter(requestNameFilter?requestNameFilter.split(","):[])}}})])},"../../products/embedded_analytics/frontend/queryEndpointLogic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$:()=>queryEndpointLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_router__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/api.ts"),lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonToast/LemonToast.tsx"),lib_utils_kea_logic_builders__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/utils/kea-logic-builders.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/scenes/urls.ts"),_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/queries/schema/schema-general.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let queryEndpointLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["products","embedded_analytics","frontend","queryEndpointLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.key)(props=>props.tabId),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setQueryEndpointName:queryEndpointName=>({queryEndpointName}),setQueryEndpointDescription:queryEndpointDescription=>({queryEndpointDescription}),setActiveCodeExampleTab:tab=>({tab}),createQueryEndpoint:request=>({request}),createQueryEndpointSuccess:response=>({response}),createQueryEndpointFailure:error=>({error}),deleteQueryEndpoint:name=>({name}),deleteQueryEndpointSuccess:response=>({response}),deleteQueryEndpointFailure:error=>({error}),deactivateQueryEndpoint:name=>({name}),deactivateQueryEndpointSuccess:response=>({response}),deactivateQueryEndpointFailure:error=>({error})}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({queryEndpointName:[null,{setQueryEndpointName:(_,_ref)=>{let{queryEndpointName}=_ref;return queryEndpointName}}],queryEndpointDescription:[null,{setQueryEndpointDescription:(_,_ref2)=>{let{queryEndpointDescription}=_ref2;return queryEndpointDescription}}],activeCodeExampleTab:["terminal",{setActiveCodeExampleTab:(_,_ref3)=>{let{tab}=_ref3;return tab}}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.listeners)(_ref4=>{let{actions}=_ref4;return{createQueryEndpoint:async _ref5=>{let{request}=_ref5;try{let response=await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.queryEndpoint.create(request);actions.createQueryEndpointSuccess(response)}catch(error){console.error("Failed to create query endpoint:",error),actions.createQueryEndpointFailure(error)}},createQueryEndpointSuccess:()=>{actions.setQueryEndpointName(""),actions.setQueryEndpointDescription(""),lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_3__.UJ.success((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.Fragment,{children:["Query endpoint created successfully!",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("br",{}),"You will be redirected to the query endpoints page."]}),{onClose:()=>{kea_router__WEBPACK_IMPORTED_MODULE_1__.router.actions.push(scenes_urls__WEBPACK_IMPORTED_MODULE_5__.j.embeddedAnalyticsQueryEndpoints())}})},createQueryEndpointFailure:_ref6=>{let{error}=_ref6;console.error("Failed to create query endpoint:",error),lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_3__.UJ.error("Failed to create query endpoint")},deleteQueryEndpoint:async _ref7=>{let{name}=_ref7;try{await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.queryEndpoint.delete(name),actions.deleteQueryEndpointSuccess(name)}catch(error){console.error("Failed to delete query endpoint:",error),actions.deleteQueryEndpointFailure(error)}},deleteQueryEndpointSuccess:()=>{lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_3__.UJ.success("Query endpoint deleted successfully")},deleteQueryEndpointFailure:_ref8=>{let{error}=_ref8;console.error("Failed to delete query endpoint:",error),lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_3__.UJ.error("Failed to delete query endpoint")},deactivateQueryEndpoint:async _ref9=>{let{name}=_ref9;try{await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.queryEndpoint.update(name,{query:{kind:_queries_schema_schema_general__WEBPACK_IMPORTED_MODULE_6__.OH.HogQLQuery,query:""},is_active:!1}),actions.deactivateQueryEndpointSuccess({})}catch(error){console.error("Failed to deactivate query endpoint:",error),actions.deactivateQueryEndpointFailure(error)}},deactivateQueryEndpointSuccess:()=>{lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_3__.UJ.success("Query endpoint deactivated successfully")},deactivateQueryEndpointFailure:_ref10=>{let{error}=_ref10;console.error("Failed to deactivate query endpoint:",error),lib_lemon_ui_LemonToast_LemonToast__WEBPACK_IMPORTED_MODULE_3__.UJ.error("Failed to deactivate query endpoint")}}}),(0,lib_utils_kea_logic_builders__WEBPACK_IMPORTED_MODULE_4__.Y)()])},"../../products/embedded_analytics/frontend/queryEndpointsLogic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{N:()=>queryEndpointsLogic});var fuse_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/.pnpm/fuse.js@6.6.2/node_modules/fuse.js/dist/fuse.esm.js"),kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.7_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../frontend/src/lib/api.ts");let queryEndpointsLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["products","embedded_analytics","frontend","queryEndpointsLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.key)(props=>props.tabId),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setFilters:filters=>({filters})}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)(_ref=>{let{values}=_ref;return{queryEndpoints:[[],{loadQueryEndpoints:async()=>{let haystack=(await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.queryEndpoint.list()).results||[];if(haystack.length>0){let names=haystack.map(endpoint=>endpoint.name),lastExecutionTimes=await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.queryEndpoint.getLastExecutionTimes(names);haystack=haystack.map(endpoint=>({...endpoint,last_executed_at:lastExecutionTimes[endpoint.name]}))}return values.filters.search&&(haystack=new fuse_js__WEBPACK_IMPORTED_MODULE_3__.Z(haystack,{keys:["name","description","query.query"],threshold:.3}).search(values.filters.search).map(result=>result.item)),haystack}}]}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({filters:[{search:""},{setFilters:(state,_ref2)=>{let{filters}=_ref2;return{...state,...filters}}}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.listeners)(_ref3=>{let{actions}=_ref3;return{setFilters:()=>{actions.loadQueryEndpoints()}}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.afterMount)(_ref4=>{let{actions}=_ref4;actions.loadQueryEndpoints()})])}}]);
//# sourceMappingURL=40266.3181660b.iframe.bundle.js.map