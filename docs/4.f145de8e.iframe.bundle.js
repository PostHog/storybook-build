(window.webpackJsonp=window.webpackJsonp||[]).push([[4,6,7,8,9,11,307],{"./frontend/src/scenes/apps/AppMetricsGraph.scss":function(h,l,e){"use strict";e.r(l);var O=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),t=e.n(O),m=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/apps/AppMetricsGraph.scss"),o=e.n(m),u={};u.insert="head",u.singleton=!1;var A=t()(o.a,u);l.default=o.a.locals||{}},"./frontend/src/scenes/apps/AppMetricsGraph.tsx":function(h,l,e){"use strict";e.r(l),e.d(l,"AppMetricsGraph",function(){return F});var O=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),t=e.n(O),m=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=e.n(m),u=e("./node_modules/core-js/modules/es.array.concat.js"),A=e.n(u),R=e("./node_modules/core-js/modules/es.object.keys.js"),S=e.n(R),K=e("./node_modules/core-js/modules/es.symbol.js"),B=e.n(K),g=e("./node_modules/core-js/modules/es.array.filter.js"),T=e.n(g),p=e("./node_modules/core-js/modules/es.object.to-string.js"),d=e.n(p),i=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),j=e.n(i),C=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),y=e.n(C),c=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),L=e.n(c),b=e("./node_modules/react/index.js"),W=e.n(b),P=e("./frontend/src/lib/colors.ts"),V=e("./node_modules/chart.js/dist/chart.mjs"),U=e("./frontend/src/scenes/apps/constants.tsx"),G=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),Y=e("./frontend/src/scenes/apps/AppMetricsGraph.scss"),H=e("./frontend/src/lib/utils.tsx");function N(E,f){var s=Object.keys(E);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(E);f&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(E,r).enumerable})),s.push.apply(s,n)}return s}function J(E){for(var f=1;f<arguments.length;f++){var s=arguments[f]!=null?arguments[f]:{};f%2?N(Object(s),!0).forEach(function(n){t()(E,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(s)):N(Object(s)).forEach(function(n){Object.defineProperty(E,n,Object.getOwnPropertyDescriptor(s,n))})}return E}function F(E){var f=E.tab,s=E.metrics,n=E.metricsLoading,r=Object(b.useRef)(null),_=U.DescriptionColumns[f];return Object(b.useEffect)(function(){var a;if(r.current&&s){var v;a=new V.a((v=r.current)===null||v===void 0?void 0:v.getContext("2d"),{type:"line",data:{labels:s.dates,datasets:[J({label:_.successes,data:s.successes,borderColor:""},M("data-brand-blue"))].concat(o()(_.successes_on_retry?[J({label:_.successes_on_retry,data:s.successes_on_retry},M("data-yellow"))]:[]),[J({label:_.failures,data:s.failures},M("data-pink"))])},options:{scales:{x:{ticks:{maxRotation:0},grid:{display:!1}},y:{beginAtZero:!0}},plugins:{crosshair:!1,legend:{display:!1}},maintainAspectRatio:!1,interaction:{mode:"index",axis:"x",intersect:!1}}})}return function(){var I;(I=a)===null||I===void 0||I.destroy()}},[s]),n||!s?W.a.createElement(G.a,{className:"AppMetricsGraph"}):W.a.createElement("div",{className:"AppMetricsGraph"},W.a.createElement("canvas",{ref:r}))}function M(E){var f=Object(P.b)(E);return{borderColor:f,hoverBorderColor:Object(H.lb)(f,-20),hoverBackgroundColor:Object(H.lb)(f,-20),backgroundColor:f,fill:!1,borderWidth:2,pointRadius:0}}try{F.displayName="AppMetricsGraph",F.__docgenInfo={description:"",displayName:"AppMetricsGraph",props:{tab:{defaultValue:null,description:"",name:"tab",required:!0,type:{name:"enum",value:[{value:'"processEvent"'},{value:'"onEvent"'},{value:'"exportEvents"'},{value:'"historical_exports"'}]}},metrics:{defaultValue:null,description:"",name:"metrics",required:!0,type:{name:"AppMetrics | null"}},metricsLoading:{defaultValue:null,description:"",name:"metricsLoading",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/apps/AppMetricsGraph.tsx#AppMetricsGraph"]={docgenInfo:F.__docgenInfo,name:"AppMetricsGraph",path:"frontend/src/scenes/apps/AppMetricsGraph.tsx#AppMetricsGraph"})}catch(E){}},"./frontend/src/scenes/apps/HistoricalExport.tsx":function(h,l,e){"use strict";e.r(l),e.d(l,"HistoricalExport",function(){return B});var O=e("./node_modules/antd/es/card/index.js"),t=e("./node_modules/kea/lib/index.esm.js"),m=e("./node_modules/react/index.js"),o=e.n(m),u=e("./frontend/src/lib/utils.tsx"),A=e("./frontend/src/scenes/apps/AppMetricsGraph.tsx"),R=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),S=e("./frontend/src/scenes/apps/historicalExportLogic.ts"),K=e("./frontend/src/scenes/apps/MetricsTab.tsx");function B(g){var T,p,d=Object(t.useValues)(Object(S.historicalExportLogic)(g)),i=d.data,j=d.dataLoading;return o.a.createElement("div",{className:"mt-4 mb-4 mr-8"},o.a.createElement(O.a,{title:"Overview"},i&&i.summary.duration?o.a.createElement("div",null,o.a.createElement("div",{className:"card-secondary"},"Export duration"),o.a.createElement("div",null,Object(u.O)(i.summary.duration))):null,o.a.createElement(K.MetricsOverview,{tab:R.AppMetricsTab.HistoricalExports,metrics:(T=i==null?void 0:i.metrics)!==null&&T!==void 0?T:null,metricsLoading:j})),o.a.createElement(O.a,{title:"Delivery trends",className:"mt-4"},o.a.createElement(A.AppMetricsGraph,{tab:R.AppMetricsTab.HistoricalExports,metrics:(p=i==null?void 0:i.metrics)!==null&&p!==void 0?p:null,metricsLoading:j})))}try{B.displayName="HistoricalExport",B.__docgenInfo={description:"",displayName:"HistoricalExport",props:{pluginConfigId:{defaultValue:null,description:"",name:"pluginConfigId",required:!0,type:{name:"number"}},jobId:{defaultValue:null,description:"",name:"jobId",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/apps/HistoricalExport.tsx#HistoricalExport"]={docgenInfo:B.__docgenInfo,name:"HistoricalExport",path:"frontend/src/scenes/apps/HistoricalExport.tsx#HistoricalExport"})}catch(g){}},"./frontend/src/scenes/apps/MetricsTab.tsx":function(h,l,e){"use strict";e.r(l),e.d(l,"MetricsTab",function(){return g}),e.d(l,"MetricsOverview",function(){return T});var O=e("./node_modules/react/index.js"),t=e.n(O),m=e("./node_modules/antd/es/card/index.js"),o=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),u=e("./frontend/src/scenes/apps/constants.tsx"),A=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),R=e("./frontend/src/lib/utils.tsx"),S=e("./frontend/src/scenes/apps/AppMetricsGraph.tsx"),K=e("./frontend/src/lib/components/LemonSelect.tsx"),B=e("./node_modules/kea/lib/index.esm.js");function g(d){var i=d.tab,j=Object(B.useValues)(o.appMetricsSceneLogic),C=j.metrics,y=j.metricsLoading,c=j.dateFrom,L=Object(B.useActions)(o.appMetricsSceneLogic),b=L.setDateFrom;return t.a.createElement("div",{className:"mt-4"},t.a.createElement(m.a,{title:t.a.createElement("div",{className:"flex items-center justify-between gap-2"},t.a.createElement("span",null,"Metrics overview"),t.a.createElement(K.a,{value:c,onChange:function(P){return b(P)},options:[{label:"Last 30 days",value:"-30d"},{label:"Last 7 days",value:"-7d"},{label:"Last 24 hours",value:"-24h"}]}))},t.a.createElement(T,{tab:i,metrics:C,metricsLoading:y})),t.a.createElement(m.a,{title:"Delivery trends",className:"mt-4"},t.a.createElement(S.AppMetricsGraph,{tab:i,metrics:C,metricsLoading:y})))}function T(d){var i,j,C,y=d.tab,c=d.metrics,L=d.metricsLoading;return L?t.a.createElement(A.a,{className:"h-20"}):t.a.createElement(t.a.Fragment,null,t.a.createElement("div",null,t.a.createElement("div",{className:"card-secondary"},u.DescriptionColumns[y].successes),t.a.createElement("div",null,p(c==null||(i=c.totals)===null||i===void 0?void 0:i.successes))),u.DescriptionColumns[y].successes_on_retry&&t.a.createElement("div",null,t.a.createElement("div",{className:"card-secondary"},u.DescriptionColumns[y].successes_on_retry),t.a.createElement("div",null,p(c==null||(j=c.totals)===null||j===void 0?void 0:j.successes_on_retry))),t.a.createElement("div",null,t.a.createElement("div",{className:"card-secondary"},u.DescriptionColumns[y].failures),t.a.createElement("div",null,p(c==null||(C=c.totals)===null||C===void 0?void 0:C.failures))))}function p(d){return t.a.createElement(t.a.Fragment,null,d&&Object(R.P)(d))}try{g.displayName="MetricsTab",g.__docgenInfo={description:"",displayName:"MetricsTab",props:{tab:{defaultValue:null,description:"",name:"tab",required:!0,type:{name:"enum",value:[{value:'"processEvent"'},{value:'"onEvent"'},{value:'"exportEvents"'},{value:'"historical_exports"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/apps/MetricsTab.tsx#MetricsTab"]={docgenInfo:g.__docgenInfo,name:"MetricsTab",path:"frontend/src/scenes/apps/MetricsTab.tsx#MetricsTab"})}catch(d){}try{T.displayName="MetricsOverview",T.__docgenInfo={description:"",displayName:"MetricsOverview",props:{tab:{defaultValue:null,description:"",name:"tab",required:!0,type:{name:"enum",value:[{value:'"processEvent"'},{value:'"onEvent"'},{value:'"exportEvents"'},{value:'"historical_exports"'}]}},metrics:{defaultValue:null,description:"",name:"metrics",required:!0,type:{name:"AppMetrics | null"}},metricsLoading:{defaultValue:null,description:"",name:"metricsLoading",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/apps/MetricsTab.tsx#MetricsOverview"]={docgenInfo:T.__docgenInfo,name:"MetricsOverview",path:"frontend/src/scenes/apps/MetricsTab.tsx#MetricsOverview"})}catch(d){}},"./frontend/src/scenes/apps/appMetricsSceneLogic.ts":function(h,l,e){"use strict";e.r(l),e.d(l,"AppMetricsTab",function(){return M}),e.d(l,"appMetricsSceneLogic",function(){return f});var O=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),t=e.n(O),m=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),o=e.n(m),u=e("./node_modules/@babel/runtime/regenerator/index.js"),A=e.n(u),R=e("./node_modules/core-js/modules/es.array.iterator.js"),S=e.n(R),K=e("./node_modules/core-js/modules/es.object.to-string.js"),B=e.n(K),g=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),T=e.n(g),p=e("./node_modules/core-js/modules/es.array.concat.js"),d=e.n(p),i=e("./node_modules/core-js/modules/es.function.name.js"),j=e.n(i),C=e("./node_modules/core-js/modules/es.array.includes.js"),y=e.n(C),c=e("./node_modules/core-js/modules/es.string.includes.js"),L=e.n(c),b=e("./node_modules/core-js/modules/es.array.filter.js"),W=e.n(b),P=e("./node_modules/kea/lib/index.esm.js"),V=e("./node_modules/kea-loaders/lib/index.js"),U=e.n(V),G=e("./frontend/src/scenes/urls.ts"),Y=e("./frontend/src/lib/api.ts"),H=e("./frontend/src/scenes/teamLogic.tsx"),N=e("./node_modules/kea-router/lib/index.js"),J=e.n(N),F=e("./frontend/src/lib/utils.tsx"),M;(function(s){s.ProcessEvent="processEvent",s.OnEvent="onEvent",s.ExportEvents="exportEvents",s.HistoricalExports="historical_exports"})(M||(M={}));var E=[M.ProcessEvent,M.OnEvent,M.ExportEvents],f=Object(P.kea)([Object(P.path)(function(s){return["scenes","apps","appMetricsSceneLogic",s]}),Object(P.props)({}),Object(P.key)(function(s){return s.pluginConfigId}),Object(P.actions)({setActiveTab:function(n){return{tab:n}},setDateFrom:function(n){return{dateFrom:n}}}),Object(P.reducers)({activeTab:[null,{setActiveTab:function(n,r){var _=r.tab;return _}}],dateFrom:["-30d",{setDateFrom:function(n,r){var _=r.dateFrom;return _}}]}),Object(V.loaders)(function(s){var n=s.values,r=s.props;return{pluginConfig:[null,{loadPluginConfig:function(){var _=o()(A.a.mark(function v(){return A.a.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,Y.b.get("api/projects/".concat(H.a.values.currentTeamId,"/plugin_configs/").concat(r.pluginConfigId));case 2:return D.abrupt("return",D.sent);case 3:case"end":return D.stop()}},v)}));function a(){return _.apply(this,arguments)}return a}()}],metrics:[null,{loadMetrics:function(){var _=o()(A.a.mark(function v(){var I,D,Z;return A.a.wrap(function($){for(;;)switch($.prev=$.next){case 0:return I=Object(F.Eb)({category:n.activeTab,date_from:n.dateFrom}),$.next=3,Y.b.get("api/projects/".concat(H.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"?").concat(I));case 3:return D=$.sent,Z=D.results,$.abrupt("return",Z);case 6:case"end":return $.stop()}},v)}));function a(){return _.apply(this,arguments)}return a}()}],historicalExports:[[],{loadHistoricalExports:function(){var _=o()(A.a.mark(function v(){var I,D;return A.a.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,Y.b.get("api/projects/".concat(H.a.values.currentTeamId,"/app_metrics/").concat(r.pluginConfigId,"/historical_exports"));case 2:return I=x.sent,D=I.results,x.abrupt("return",D);case 5:case"end":return x.stop()}},v)}));function a(){return _.apply(this,arguments)}return a}()}]}}),Object(P.selectors)(function(s){var n=s.values;return{breadcrumbs:[function(r){return[r.pluginConfig,function(_,a){return a.pluginConfigId}]},function(r,_){var a;return[{name:"Apps",path:G.a.projectApps()},{name:r==null||(a=r.plugin_info)===null||a===void 0?void 0:a.name,path:G.a.appMetrics(_)}]}],showTab:[function(){return[]},function(){return function(r){var _;if(n.pluginConfigLoading||!n.pluginConfig)return!1;var a=((_=n.pluginConfig.plugin_info.capabilities)===null||_===void 0?void 0:_.methods)||[];return r===M.HistoricalExports?a.includes("exportEvents"):r===M.OnEvent&&a.includes("exportEvents")?!1:a.includes(r)}}]}}),Object(P.listeners)(function(s){var n=s.values,r=s.actions;return{loadPluginConfigSuccess:function(){if(!n.activeTab){var a=E.filter(function(D){return n.showTab(D)}),v=t()(a,1),I=v[0];r.setActiveTab(I)}},setActiveTab:function(a){var v=a.tab;v===M.HistoricalExports?r.loadHistoricalExports():r.loadMetrics()},setDateFrom:function(){r.loadMetrics()}}}),Object(N.actionToUrl)(function(s){var n=s.values,r=s.props;return{setActiveTab:function(){var a;return n.activeTab===M.HistoricalExports?G.a.appHistoricalExports(r.pluginConfigId):G.a.appMetrics(r.pluginConfigId,(a=n.activeTab)!==null&&a!==void 0?a:void 0)}}}),Object(N.urlToAction)(function(s){var n=s.values,r=s.actions;return{"/app/:pluginConfigId/:page":function(a,v){n.pluginConfig||r.loadPluginConfig(),a.page===M.HistoricalExports?r.setActiveTab(M.HistoricalExports):v.tab&&E.includes(v.tab)&&r.setActiveTab(v.tab)}}})])},"./frontend/src/scenes/apps/constants.tsx":function(h,l,e){"use strict";e.r(l),e.d(l,"DescriptionColumns",function(){return u});var O=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),t=e.n(O),m=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),o,u=(o={},t()(o,m.AppMetricsTab.ProcessEvent,{successes:"Events processed",failures:"Failed events"}),t()(o,m.AppMetricsTab.OnEvent,{successes:"Events processed",successes_on_retry:"Events processed on retry",failures:"Failed events"}),t()(o,m.AppMetricsTab.ExportEvents,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),t()(o,m.AppMetricsTab.HistoricalExports,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),o)},"./frontend/src/scenes/apps/historicalExportLogic.ts":function(h,l,e){"use strict";e.r(l),e.d(l,"historicalExportLogic",function(){return y});var O=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),t=e.n(O),m=e("./node_modules/@babel/runtime/regenerator/index.js"),o=e.n(m),u=e("./node_modules/core-js/modules/es.array.concat.js"),A=e.n(u),R=e("./node_modules/core-js/modules/es.array.iterator.js"),S=e.n(R),K=e("./node_modules/core-js/modules/es.object.to-string.js"),B=e.n(K),g=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),T=e.n(g),p=e("./node_modules/kea/lib/index.esm.js"),d=e("./node_modules/kea-loaders/lib/index.js"),i=e.n(d),j=e("./frontend/src/lib/api.ts"),C=e("./frontend/src/scenes/teamLogic.tsx"),y=Object(p.kea)([Object(p.path)(["scenes","apps","historicalExportLogic"]),Object(p.props)({}),Object(p.key)(function(c){var L=c.pluginConfigId,b=c.jobId;return"".concat(L,"_").concat(b)}),Object(d.loaders)(function(c){var L=c.props;return{data:[null,{loadExportData:function(){var b=t()(o.a.mark(function P(){return o.a.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,j.b.get("api/projects/".concat(C.a.values.currentTeamId,"/app_metrics/").concat(L.pluginConfigId,"/historical_exports/").concat(L.jobId));case 2:return U.abrupt("return",U.sent);case 3:case"end":return U.stop()}},P)}));function W(){return b.apply(this,arguments)}return W}()}]}}),Object(p.events)(function(c){var L=c.actions;return{afterMount:L.loadExportData}})])},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/apps/AppMetricsGraph.scss":function(h,l,e){var O=e("./node_modules/css-loader/dist/runtime/api.js");l=O(!1),l.push([h.i,".AppMetricsGraph{height:300px}",""]),h.exports=l}}]);
