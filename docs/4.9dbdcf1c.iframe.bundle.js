(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"./frontend/src/lib/components/ExportButton/ExportButton.tsx":function(Q,E,e){"use strict";e.d(E,"a",function(){return s});var z=e("./node_modules/@babel/runtime/helpers/extends.js"),Oe=e.n(z),B=e("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),t=e.n(B),i=e("./node_modules/core-js/modules/es.array.map.js"),g=e.n(i),q=e("./node_modules/core-js/modules/es.regexp.exec.js"),he=e.n(q),le=e("./node_modules/core-js/modules/es.string.split.js"),Ke=e.n(le),ee=e("./node_modules/react/index.js"),V=e.n(ee),Z=e("./frontend/src/lib/components/LemonButton/index.ts"),Y=e("./node_modules/kea/lib/index.esm.js"),S=e("./frontend/src/lib/components/ExportButton/exporterLogic.ts"),te=e("./frontend/src/lib/components/LemonDivider/index.ts"),$=e("./frontend/src/scenes/insights/insightLogic.ts"),L=["dashboardId","insightShortId"];function s(f){var x=f.dashboardId,J=f.insightShortId,A=t()(f,L),ae={dashboardItemId:J,doNotLoad:!0},l=Object(Y.useValues)(Object($.c)(ae)),_=l.supportsCsvExport,T=l.csvExportUrl,m=l.insight,se=Object(Y.useActions)(Object(S.b)({dashboardId:x,insightId:m==null?void 0:m.id})),pe=se.exportItem,ie=Object(Y.useValues)(Object(S.b)({dashboardId:x,insightId:m==null?void 0:m.id})),Fe=ie.exportInProgress,R=[];(x||J)&&R.push(S.a.PNG),_&&R.push(S.a.CSV);var Ne=function(w){if(w===S.a.CSV){window.open(T,"_blank");return}pe(w)};return V.a.createElement(Z.b,Oe()({type:"stealth",loading:Fe,"data-attr":"export-button"},A,{popup:{actionable:!0,placement:"right-start",overlay:V.a.createElement(V.a.Fragment,null,V.a.createElement("h5",null,"File type"),V.a.createElement(te.a,null),R.map(function(K){return V.a.createElement(Z.a,{key:K,fullWidth:!0,type:"stealth",onClick:function(){return Ne(K)},"data-attr":"export-button-".concat(K.split("/").pop())},".",K.split("/").pop())}))}}),"Export")}try{s.displayName="ExportButton",s.__docgenInfo={description:"",displayName:"ExportButton",props:{dashboardId:{defaultValue:null,description:"",name:"dashboardId",required:!1,type:{name:"number"}},insightShortId:{defaultValue:null,description:"",name:"insightShortId",required:!1,type:{name:"InsightShortId"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"alt"'},{value:'"highlighted"'},{value:'"primary"'},{value:'"secondary"'},{value:'"tertiary"'},{value:'"stealth"'}]}},icon:{defaultValue:null,description:"",name:"icon",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>> | null"}},fullWidth:{defaultValue:null,description:"Whether the row should take up the parent's full width.",name:"fullWidth",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/ExportButton/ExportButton.tsx#ExportButton"]={docgenInfo:s.__docgenInfo,name:"ExportButton",path:"frontend/src/lib/components/ExportButton/ExportButton.tsx#ExportButton"})}catch(f){}},"./frontend/src/lib/components/ExportButton/exporterLogic.ts":function(Q,E,e){"use strict";e.d(E,"a",function(){return Ae}),e.d(E,"b",function(){return xe});var z=e("./node_modules/core-js/modules/es.object.keys.js"),Oe=e.n(z),B=e("./node_modules/core-js/modules/es.symbol.js"),t=e.n(B),i=e("./node_modules/core-js/modules/es.array.filter.js"),g=e.n(i),q=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),he=e.n(q),le=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Ke=e.n(le),ee=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),V=e.n(ee),Z=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),Y=e.n(Z),S=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),te=e.n(S),$=e("./node_modules/@babel/runtime/regenerator/index.js"),L=e.n($),s=e("./node_modules/core-js/modules/es.array.concat.js"),f=e.n(s),x=e("./node_modules/core-js/modules/es.object.to-string.js"),J=e.n(x),A=e("./node_modules/core-js/modules/es.promise.js"),ae=e.n(A),l=e("./node_modules/core-js/modules/es.array.iterator.js"),_=e.n(l),T=e("./node_modules/core-js/modules/es.string.iterator.js"),m=e.n(T),se=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),pe=e.n(se),ie=e("./node_modules/core-js/modules/web.url.js"),Fe=e.n(ie),R=e("./node_modules/core-js/modules/web.url-search-params.js"),Ne=e.n(R),K=e("./node_modules/kea/lib/index.esm.js"),w=e("./frontend/src/lib/api.ts"),De=e("./frontend/src/lib/utils.tsx"),X=e("./node_modules/posthog-js/dist/es.js"),W=e("./frontend/src/lib/components/lemonToast.tsx");function Le(c,j){var h=Object.keys(c);if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(c);j&&(M=M.filter(function(re){return Object.getOwnPropertyDescriptor(c,re).enumerable})),h.push.apply(h,M)}return h}function ce(c){for(var j=1;j<arguments.length;j++){var h=arguments[j]!=null?arguments[j]:{};j%2?Le(Object(h),!0).forEach(function(M){Y()(c,M,h[M])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(h)):Le(Object(h)).forEach(function(M){Object.defineProperty(c,M,Object.getOwnPropertyDescriptor(h,M))})}return c}var F=1e3,ze=10,Ae;(function(c){c.PNG="image/png",c.CSV="text/csv",c.PDF="application/pdf"})(Ae||(Ae={}));function ke(c){return ye.apply(this,arguments)}function ye(){return ye=te()(L.a.mark(function c(j){var h,M,re,ue,U;return L.a.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return h=w.b.exports.determineExportUrl(j.id),N.next=3,w.b.getRaw(h);case 3:return M=N.sent,N.next=6,M.blob();case 6:re=N.sent,ue=window.URL.createObjectURL(re),U=document.createElement("a"),U.style.display="none",U.href=ue,U.download=j.filename,document.body.appendChild(U),U.click(),window.URL.revokeObjectURL(ue);case 15:case"end":return N.stop()}},c)})),ye.apply(this,arguments)}var xe=Object(K.kea)([Object(K.path)(["lib","components","ExportButton","ExporterLogic"]),Object(K.props)({}),Object(K.key)(function(c){var j=c.dashboardId,h=c.insightId;return"dash:".concat(j,"::insight:").concat(h)}),Object(K.actions)({exportItem:function(j,h,M,re){return{exportFormat:j,exportContext:h,exportParams:M,successCallback:re}},exportItemSuccess:!0,exportItemFailure:!0}),Object(K.reducers)({exportInProgress:[!1,{exportItem:function(){return!0},exportItemSuccess:function(){return!1},exportItemFailure:function(){return!1}}]}),Object(K.listeners)(function(c){var j=c.actions,h=c.props;return{exportItem:function(){var M=te()(L.a.mark(function ue(U){var Pe,N,Ve,Me,we;return L.a.wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:return Pe=U.exportFormat,N=U.exportContext,Ve=U.exportParams,Me=U.successCallback,we=new Promise(function(){var qe=te()(L.a.mark(function He(Te,Re){var fe,Be,_e,Ge;return L.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return fe={export_format:Pe,dashboard:h.dashboardId,insight:h.insightId,total_time_ms:0},Be=performance.now(),p.prev=2,p.next=5,w.b.exports.create(ce({export_format:Pe,dashboard:h.dashboardId,insight:h.insightId},N||{}),Ve);case 5:if(_e=p.sent,_e.id){p.next=9;break}return Re("Missing export_id from response"),p.abrupt("return");case 9:Ge=0;case 10:if(!(Ge<ze)){p.next=28;break}if(Ge++,!_e.has_content){p.next=21;break}return j.exportItemSuccess(),Me==null||Me(),p.next=17,ke(_e);case 17:return fe.total_time_ms=performance.now()-Be,X.a.capture("export succeeded",fe),Te("Export complete"),p.abrupt("return");case 21:return p.next=23,Object(De.w)(F);case 23:return p.next=25,w.b.exports.get(_e.id);case 25:_e=p.sent,p.next=10;break;case 28:Re("Content not loaded in time..."),p.next=37;break;case 31:p.prev=31,p.t0=p.catch(2),j.exportItemFailure(),fe.total_time_ms=performance.now()-Be,X.a.capture("export failed",fe),Re("Export failed: ".concat(JSON.stringify(p.t0)));case 37:case"end":return p.stop()}},He,null,[[2,31]])}));return function(He,Te){return qe.apply(this,arguments)}}()),Ee.next=4,W.d.promise(we,{pending:"Export started...",success:"Export complete!",error:"Export failed!"});case 4:case"end":return Ee.stop()}},ue)}));function re(ue){return M.apply(this,arguments)}return re}()}})])},"./frontend/src/lib/hooks/useKeyboardHotkeys.tsx":function(Q,E,e){"use strict";e.d(E,"a",function(){return te});var z=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),Oe=e.n(z),B=e("./node_modules/core-js/modules/es.array.includes.js"),t=e.n(B),i=e("./node_modules/core-js/modules/es.string.includes.js"),g=e.n(i),q=e("./node_modules/core-js/modules/es.object.to-string.js"),he=e.n(q),le=e("./node_modules/core-js/modules/es.object.keys.js"),Ke=e.n(le),ee=e("./node_modules/core-js/modules/es.array.concat.js"),V=e.n(ee),Z=e("./frontend/src/lib/hooks/useEventListener.ts"),Y=function(L,s){var f=L.composedPath()||L.path;if(!f)return!1;var x=f[0],J=x.tagName||"not an html element";return s.includes(J.toLowerCase())},S=[".hotkey-block",".hotkey-block *"];function te($,L){var s=["input","textarea"];Object(Z.a)("keydown",function(f){var x=f.key;if(!(f.metaKey||f.ctrlKey||f.altKey)&&!S.some(function(T){return f.target.matches(T)})){var J=s.includes(f.target.tagName.toLowerCase());if(!(x!=="Escape"&&(J||Y(f,s))))for(var A=0,ae=Object.keys($);A<ae.length;A++){var l=ae[A],_=$[l];if(!(!_||_.disabled)&&x.toLowerCase()===l){f.preventDefault(),_.action();break}}}},void 0,[$].concat(Oe()(L||[])))}},"./frontend/src/scenes/dashboard/Dashboard.tsx":function(Q,E,e){"use strict";e.r(E),e.d(E,"scene",function(){return xt}),e.d(E,"Dashboard",function(){return Je});var z=e("./node_modules/core-js/modules/es.array.includes.js"),Oe=e("./node_modules/core-js/modules/es.string.includes.js"),B=e("./node_modules/react/index.js"),t=e.n(B),i=e("./node_modules/kea/lib/index.esm.js"),g=e("./frontend/src/scenes/dashboard/dashboardLogic.ts"),q=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),he=e.n(q),le=e("./node_modules/core-js/modules/es.array.map.js"),Ke=e("./node_modules/core-js/modules/es.function.name.js"),ee=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),V=e.n(ee),Z=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/DashboardItems.scss"),Y=e.n(Z),S={};S.insert="head",S.singleton=!1;var te=V()(Y.a,S),$=Y.a.locals||{},L=e("./node_modules/react-grid-layout/index.js"),s=e("./frontend/src/types.ts"),f=e("./frontend/src/models/insightsModel.tsx"),x=e("./node_modules/clsx/dist/clsx.m.js"),J=e("./frontend/src/lib/components/InsightCard/index.tsx"),A=e("./frontend/src/lib/hooks/useResizeObserver.ts");function ae(){var r=Object(i.useValues)(g.c),a=r.dashboard,n=r.items,d=r.layouts,o=r.dashboardMode,C=r.placement,O=r.isRefreshing,D=r.highlightedInsightId,y=r.refreshStatus,P=Object(i.useActions)(g.c),oe=P.updateLayouts,I=P.updateContainerWidth,u=P.updateItemColor,H=P.removeItem,ve=P.refreshAllDashboardItems,ne=Object(i.useActions)(f.a),Ce=ne.duplicateInsight,Se=ne.renameInsight,be=ne.moveToDashboard,Ie=Object(B.useState)(null),Xe=he()(Ie,2),We=Xe[0],Qe=Xe[1],Ue=Object(B.useRef)(!1),ge=Object(B.useRef)(null),tt=Object(x.a)({"dashboard-view-mode":o!==s.k.Edit,"dashboard-edit-mode":o===s.k.Edit}),Ze=Object(A.b)(),me=Ze.width,v=Ze.ref,de=!me||me>g.a.sm;return t.a.createElement("div",{className:"dashboard-items-wrapper",ref:v},t.a.createElement(L.Responsive,{width:me||0,className:tt,isDraggable:o===s.k.Edit,isResizable:o===s.k.Edit,layouts:d,rowHeight:80,margin:[16,16],containerPadding:[0,0],onLayoutChange:function(je,k){o===s.k.Edit&&oe(k)},onWidthChange:function(je,k,G){I(je,G)},breakpoints:g.a,resizeHandles:de?["s","e","se"]:["s"],cols:g.b,onResize:function(je,k,G){(!We||We.w!==G.w||We.h!==G.h)&&Qe(G)},onResizeStop:function(){Qe(null)},onDrag:function(){Ue.current=!0,ge.current&&window.clearTimeout(ge.current)},onDragStop:function(){ge.current&&window.clearTimeout(ge.current),ge.current=window.setTimeout(function(){Ue.current=!1},250)},draggableCancel:".anticon,.ant-dropdown,table,.ant-popover-content,button,.Popup"},n==null?void 0:n.map(function(b){var je;return t.a.createElement(J.a,{key:b.short_id,insight:b,dashboardId:a==null?void 0:a.id,loading:O(b.short_id),apiErrored:((je=y[b.short_id])===null||je===void 0?void 0:je.error)||!1,highlighted:D&&b.short_id===D,showResizeHandles:o===s.k.Edit,canResizeWidth:de,updateColor:function(G){return u(b.id,G)},removeFromDashboard:function(){return H(b)},refresh:function(){return ve([b])},rename:function(){return Se(b)},duplicate:function(){return Ce(b)},moveToDashboardOld:function(G){return Ce(b,G,!0)},moveToDashboard:function(G){var Pt=G.id,Mt=G.name;if(!a)throw new Error("must be on a dashboard to move an insight");be(b,a.id,Pt,Mt)},showEditingControls:[s.l.Dashboard,s.l.ProjectHomepage].includes(C),showDetailsControls:C!=s.l.Export})})))}var l=e("./frontend/src/lib/components/DateFilter/DateFilter.tsx"),_=e("./node_modules/@ant-design/icons/es/icons/CalendarOutlined.js"),T=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/Dashboard.scss"),m=e.n(T),se={};se.insert="head",se.singleton=!1;var pe=V()(m.a,se),ie=m.a.locals||{},Fe=e("./frontend/src/lib/hooks/useKeyboardHotkeys.tsx"),R=e("./frontend/src/lib/utils/eventUsageLogic.ts"),Ne=e("./frontend/src/lib/components/TimezoneAware/index.tsx"),K=e("./node_modules/core-js/modules/es.array.fill.js"),w=e("./node_modules/antd/es/card/index.js"),De=e("./node_modules/antd/es/row/index.js"),X=e("./node_modules/antd/es/col/index.js"),W=e("./node_modules/antd/es/skeleton/index.js"),Le=e("./frontend/src/lib/components/Link.tsx"),ce=e("./frontend/src/scenes/urls.ts"),F=e("./frontend/src/lib/components/LemonButton/index.ts");function ze(r){var a=r.active;return t.a.createElement(w.a,{className:"hide-lte-lg"},t.a.createElement(De.a,null,t.a.createElement(X.a,{span:12},t.a.createElement(W.a,{paragraph:{rows:1},active:a}),t.a.createElement("div",{className:"mt"},t.a.createElement("div",{className:"mt"},t.a.createElement(W.a.Button,{active:a}),t.a.createElement(W.a.Button,{active:a,style:{marginLeft:4,width:140}})),t.a.createElement("div",{className:"mt"},t.a.createElement(W.a.Button,{active:a}),t.a.createElement(W.a.Button,{active:a,style:{marginLeft:4,width:140}})),t.a.createElement("div",{className:"mt"},t.a.createElement(W.a.Button,{active:a}),t.a.createElement(W.a.Button,{active:a,style:{marginLeft:4,width:140}})))),t.a.createElement(X.a,{span:12},t.a.createElement("div",{className:"skeleton-actions"},t.a.createElement(W.a.Avatar,{active:a,shape:"circle",size:"small"}),t.a.createElement(W.a.Avatar,{active:a,shape:"circle",size:"small"})),t.a.createElement(W.a.Avatar,{active:a,shape:"circle",size:"large",className:"pie-chart"}))))}function Ae(){return t.a.createElement("div",{className:"bar-chart ant-skeleton-content"},Array(8).fill(0).map(function(r,a){var n=200,d=40,o=Math.floor(Math.random()*(n-d+1))+d;return t.a.createElement("div",{className:"bar-el ant-skeleton-title",key:a,style:{height:o}})}))}var ke=t.a.memo(Ae);function ye(r){var a=r.active;return t.a.createElement(w.a,{className:Object(x.a)("ant-skeleton",a&&"ant-skeleton-active")},t.a.createElement(De.a,null,t.a.createElement(X.a,{span:12},t.a.createElement(W.a,{active:a,paragraph:{rows:1}})),t.a.createElement(X.a,{span:12},t.a.createElement("div",{className:"skeleton-actions"},t.a.createElement(W.a.Avatar,{active:a,shape:"circle",size:"small"}),t.a.createElement(W.a.Avatar,{active:a,shape:"circle",size:"small"})))),t.a.createElement(ke,null))}function xe(r){var a=r.loading,n=Object(i.useValues)(g.c),d=n.dashboard;return t.a.createElement("div",{className:"empty-state"},!a&&t.a.createElement("div",{className:"cta"},t.a.createElement(w.a,{className:"card-elevated"},t.a.createElement("h3",{className:"l3"},"Dashboard empty"),t.a.createElement("p",null,"This dashboard sure would look better with some graphs!"),t.a.createElement("div",{className:"mt text-center"},t.a.createElement(Le.a,{to:ce.a.insightNew(void 0,d==null?void 0:d.id)},t.a.createElement(F.a,{"data-attr":"dashboard-add-graph-header"},"Add insight"))))),t.a.createElement(De.a,{gutter:16},t.a.createElement(X.a,{span:24,lg:12},t.a.createElement(ze,{active:a})),t.a.createElement(X.a,{span:24,lg:12},t.a.createElement(ye,{active:a}))),t.a.createElement(De.a,{gutter:16,className:"fade-out-graphs"},t.a.createElement(X.a,{span:24,lg:12},t.a.createElement(ze,{active:a})),t.a.createElement(X.a,{span:24,lg:12},t.a.createElement(ye,{active:a}))))}try{xe.displayName="EmptyDashboardComponent",xe.__docgenInfo={description:"",displayName:"EmptyDashboardComponent",props:{loading:{defaultValue:null,description:"",name:"loading",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/EmptyDashboardComponent.tsx#EmptyDashboardComponent"]={docgenInfo:xe.__docgenInfo,name:"EmptyDashboardComponent",path:"frontend/src/scenes/dashboard/EmptyDashboardComponent.tsx#EmptyDashboardComponent"})}catch(r){}var c=e("./frontend/src/lib/components/NotFound/index.tsx"),j=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),h=e.n(j),M=e("./node_modules/core-js/modules/es.array.from.js"),re=e("./node_modules/core-js/modules/es.string.iterator.js"),ue=e("./node_modules/antd/es/dropdown/index.js"),U=e("./node_modules/antd/es/menu/index.js"),Pe=e("./node_modules/antd/es/checkbox/index.js"),N=e("./node_modules/antd/es/radio/index.js"),Ve=e("./node_modules/antd/es/space/index.js"),Me=e("./node_modules/@ant-design/icons/es/icons/DownOutlined.js"),we=e("./node_modules/@ant-design/icons/es/icons/LoadingOutlined.js"),at=e("./node_modules/@ant-design/icons/es/icons/ReloadOutlined.js"),Ee=e("./frontend/src/lib/utils.tsx"),qe=e("./frontend/src/lib/components/Tooltip.tsx"),He=e("./frontend/src/lib/dayjs.ts"),Te=function(){var a=Object(i.useValues)(g.c),n=a.lastRefreshed;return t.a.createElement("span",null,"Last updated ",t.a.createElement("b",null,n?Object(He.a)(n).fromNow():"a while ago"))},Re=h()(Array.from([60,120,300,900],function(r){return{label:Object(Ee.N)(r),value:r}}));function fe(){var r=Object(i.useValues)(g.c),a=r.itemsLoading,n=r.autoRefresh,d=r.refreshMetrics,o=Object(i.useActions)(g.c),C=o.refreshAllDashboardItemsManual,O=o.setAutoRefresh,D=Object(B.useState)(!1),y=he()(D,2),P=y[0],oe=y[1];return t.a.createElement(t.a.Fragment,null,t.a.createElement(ue.a.Button,{overlay:t.a.createElement(U.a,{"data-attr":"auto-refresh-picker",id:"auto-refresh-picker"},t.a.createElement("div",{id:"auto-refresh-check",key:"auto-refresh-check",onClick:function(u){u.stopPropagation(),oe(!0),O(!n.enabled,n.interval)}},t.a.createElement(qe.a,{title:"Refresh dashboard automatically",placement:"bottomLeft"},t.a.createElement(Pe.a,{onChange:function(u){u.stopPropagation(),u.preventDefault()},checked:n.enabled}),t.a.createElement("label",{style:{marginLeft:10,cursor:"pointer"}},"Auto refresh"))),t.a.createElement(U.a.Divider,null),t.a.createElement(U.a.ItemGroup,{title:"Refresh interval"},t.a.createElement(N.a.Group,{onChange:function(u){O(!0,parseInt(u.target.value))},value:n.interval,style:{width:"100%"}},t.a.createElement(Ve.b,{direction:"vertical",style:{width:"100%"}},Re.map(function(I){var u=I.label,H=I.value;return t.a.createElement(N.a,{key:H,value:H,style:{width:"100%"}},u)}))))),trigger:["click"],onClick:function(){return C()},icon:t.a.createElement(Me.a,null),disabled:a,buttonsRender:function(u){var H=he()(u,2),ve=H[0],ne=H[1];return[t.a.cloneElement(ve,{style:{paddingLeft:10}}),ne]},visible:P,onVisibleChange:function(u){return oe(u)}},t.a.createElement("span",{className:"dashboard-items-action-icon"},a?t.a.createElement(we.a,null):t.a.createElement(at.a,null)),t.a.createElement("span",{className:Object(x.a)("dashboard-items-action-refresh-text",{hidden:a})},t.a.createElement(Te,null)),t.a.createElement("span",{className:Object(x.a)("dashboard-items-action-refresh-text","completed",{hidden:!a})},"Refreshed ",d.completed," out of ",d.total)))}var Be=e("./frontend/src/scenes/insights/EmptyStates/index.ts"),_e=e("./node_modules/core-js/modules/es.symbol.js"),Ge=e("./node_modules/core-js/modules/es.symbol.description.js"),it=e("./node_modules/core-js/modules/es.array.filter.js"),p=e("./node_modules/core-js/modules/es.object.to-string.js"),Ct=e("./node_modules/core-js/modules/es.array.concat.js"),It=e("./node_modules/core-js/modules/es.array.join.js"),st=e("./frontend/src/lib/components/EditableField/EditableField.tsx");function Ye(r){var a=r.onExit,n="aside.ant-layout-sider, .layout-top-content";return Object(B.useEffect)(function(){for(var d=window.document.querySelectorAll(n),o=0;o<d.length;o++)d[o].style.display="none";var C=function(){window.document.fullscreenElement===null&&(a==null||a())};try{window.document.body.requestFullscreen().then(function(){window.addEventListener("fullscreenchange",C,!1)})}catch(O){}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch(O){}return function(){for(var O=window.document.querySelectorAll(n),D=0;D<O.length;D++)O[D].style.display="block";try{window.removeEventListener("fullscreenchange",C,!1),window.document.fullscreenElement!==null&&window.document.exitFullscreen()}catch(y){}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch(y){}}},[]),null}try{Ye.displayName="FullScreen",Ye.__docgenInfo={description:"",displayName:"FullScreen",props:{onExit:{defaultValue:null,description:"",name:"onExit",required:!1,type:{name:"(() => any)"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/FullScreen.tsx#FullScreen"]={docgenInfo:Ye.__docgenInfo,name:"FullScreen",path:"frontend/src/lib/components/FullScreen.tsx#FullScreen"})}catch(r){}var ct=e("./frontend/src/lib/components/LemonButton/More.tsx"),ut=e("./frontend/src/lib/components/LemonRow/index.ts"),et=e("./frontend/src/lib/components/LemonDivider/index.ts"),rt=e("./frontend/src/lib/components/ObjectTags/ObjectTags.tsx"),mt=e("./frontend/src/lib/components/PageHeader.tsx"),ot=e("./frontend/src/models/dashboardsModel.tsx"),ht=e("./frontend/src/scenes/dashboard/dashboardsLogic.ts"),pt=e("./frontend/src/scenes/dashboard/DashboardCollaborators.tsx"),Et=e("./frontend/src/scenes/userLogic.ts"),$e=e("./frontend/src/lib/constants.tsx"),ft=e("./frontend/src/lib/components/ProfilePicture/ProfileBubbles.tsx"),_t=e("./frontend/src/scenes/dashboard/dashboardCollaboratorsLogic.ts"),vt=e("./frontend/src/lib/components/icons.tsx"),nt=e("./frontend/src/lib/logic/featureFlagLogic.ts"),bt=e("./frontend/src/lib/components/ExportButton/ExportButton.tsx"),dt=e("./frontend/src/lib/components/Subscriptions/SubscriptionsModal.tsx"),gt=e("./node_modules/kea-router/lib/index.js"),jt=e("./frontend/src/lib/components/Sharing/SharingModal.tsx");function Ot(){var r=Object(i.useValues)(g.c),a=r.dashboard,n=r.allItemsLoading,d=r.dashboardMode,o=r.canEditDashboard,C=r.showSubscriptions,O=r.subscriptionId,D=Object(i.useActions)(g.c),y=D.setDashboardMode,P=D.triggerDashboardUpdate,oe=Object(i.useValues)(ht.b),I=oe.dashboardTags,u=Object(i.useActions)(ot.a),H=u.updateDashboard,ve=u.pinDashboard,ne=u.unpinDashboard,Ce=u.deleteDashboard,Se=u.duplicateDashboard,be=Object(i.useValues)(ot.a),Ie=be.dashboardLoading,Xe=Object(i.useValues)(Et.a),We=Xe.hasAvailableFeature,Qe=Object(i.useValues)(nt.a),Ue=Qe.featureFlags,ge=Ue[$e.h.EXPORT_DASHBOARD_INSIGHTS],tt=Ue[$e.h.INSIGHT_SUBSCRIPTIONS],Ze=Object(i.useActions)(gt.router),me=Ze.push;return a||n?t.a.createElement(t.a.Fragment,null,d===s.k.Fullscreen&&t.a.createElement(Ye,{onExit:function(){return y(null,R.a.Browser)}}),a&&t.a.createElement(t.a.Fragment,null,t.a.createElement(dt.c,{visible:C,closeModal:function(){return me(ce.a.dashboard(a.id))},dashboardId:a.id,subscriptionId:O}),t.a.createElement(jt.b,{visible:d===s.k.Sharing,closeModal:function(){return me(ce.a.dashboard(a.id))},dashboardId:a.id})),t.a.createElement(mt.a,{title:t.a.createElement("div",{style:{display:"flex",alignItems:"center"}},t.a.createElement(st.a,{name:"name",value:(a==null?void 0:a.name)||(n?"Loading\u2026":""),placeholder:"Name this dashboard",onSave:a?function(v){return H({id:a.id,name:v})}:void 0,minLength:1,maxLength:400,mode:o?void 0:"view",notice:a&&!o?{icon:t.a.createElement(vt.IconLock,null),tooltip:"You don't have edit permissions in this dashboard. Ask a dashboard collaborator with edit access to add you."}:void 0})),buttons:d===s.k.Edit?t.a.createElement(F.a,{"data-attr":"dashboard-edit-mode-save",type:"primary",onClick:function(){return y(null,R.a.DashboardHeader)},tabIndex:10,disabled:n},"Done editing"):d===s.k.Fullscreen?t.a.createElement(F.a,{type:"secondary",onClick:function(){return y(null,R.a.DashboardHeader)},"data-attr":"dashboard-exit-presentation-mode",disabled:n},"Exit full screen"):t.a.createElement(t.a.Fragment,null,t.a.createElement(ct.a,{overlay:a?t.a.createElement(t.a.Fragment,null,a.created_by&&t.a.createElement(t.a.Fragment,null,t.a.createElement(ut.a,{fullWidth:!0,style:{color:"var(--muted-alt)"}},"Created by"," ",a.created_by.first_name||a.created_by.email||"-"," ","on ",Object(Ee.M)(a.created_at)),t.a.createElement(et.a,null)),o&&t.a.createElement(F.a,{onClick:function(){return y(s.k.Edit,R.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Edit layout (E)"),t.a.createElement(F.a,{onClick:function(){return y(s.k.Fullscreen,R.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Go full screen (F)"),o&&(a.pinned?t.a.createElement(F.a,{onClick:function(){return ne(a.id,R.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Unpin dashboard"):t.a.createElement(F.a,{onClick:function(){return ve(a.id,R.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Pin dashboard")),tt&&t.a.createElement(dt.a,{dashboardId:a.id}),ge&&t.a.createElement(bt.a,{dashboardId:a.id,fullWidth:!0,type:"stealth"}),t.a.createElement(et.a,null),t.a.createElement(F.a,{onClick:function(){return Se({id:a.id,name:a.name,show:!0})},type:"stealth",fullWidth:!0},"Duplicate dashboard"),o&&t.a.createElement(F.a,{onClick:function(){return Ce({id:a.id,redirect:!0})},status:"danger",type:"stealth",fullWidth:!0},"Delete dashboard")):void 0}),t.a.createElement(et.a,{vertical:!0}),a&&t.a.createElement(t.a.Fragment,null,t.a.createElement(Dt,{dashboard:a,onClick:function(){return me(ce.a.dashboardSharing(a.id))}}),t.a.createElement(F.a,{type:"secondary","data-attr":"dashboard-share-button",onClick:function(){return me(ce.a.dashboardSharing(a.id))}},"Share")),o&&t.a.createElement(Le.a,{to:ce.a.insightNew(void 0,a==null?void 0:a.id)},t.a.createElement(F.a,{type:"primary","data-attr":"dashboard-add-graph-header"},"Add insight"))),caption:t.a.createElement(t.a.Fragment,null,a&&!!(o||a.description)&&t.a.createElement(st.a,{multiline:!0,name:"description",value:a.description||"",placeholder:"Description (optional)",onSave:function(de){return H({id:a.id,description:de})},compactButtons:!0,mode:o?void 0:"view",paywall:!We(s.d.DASHBOARD_COLLABORATION)}),(a==null?void 0:a.tags)&&t.a.createElement(t.a.Fragment,null,o?t.a.createElement(rt.a,{tags:a.tags,onChange:function(de,b){return P({tags:b})},saving:Ie,tagsAvailable:I.filter(function(v){var de;return!((de=a.tags)!==null&&de!==void 0&&de.includes(v))}),className:"insight-metadata-tags"}):a.tags.length?t.a.createElement(rt.a,{tags:a.tags,saving:Ie,staticOnly:!0,className:"insight-metadata-tags"}):null)),delimited:!0})):null}function Dt(r){var a=r.dashboard,n=r.onClick,d=Object(i.useValues)(Object(_t.a)({dashboardId:a.id})),o=d.allCollaborators;if(!a)return null;var C=pt.a[a.effective_restriction_level],O=[];return C!=null&&C.label&&O.push(C.label),a.is_shared&&O.push("Shared publicly"),t.a.createElement(ft.a,{people:o.map(function(D){return{email:D.user.email,name:D.user.first_name,title:"".concat(D.user.first_name," (").concat($e.C[D.level],")")}}),tooltip:O.join(" \u2022 "),onClick:n})}var yt=e("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),xt={component:lt,logic:g.c,paramsToProps:function(a){var n=a.params,d=n.id,o=n.placement;return{id:d?parseInt(d):void 0,placement:o}}};function Je(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=r.id,n=r.dashboard,d=r.placement;return t.a.createElement(i.BindLogic,{logic:g.c,props:{id:a?parseInt(a):void 0,placement:d,dashboard:n}},t.a.createElement(lt,null))}function lt(){var r,a,n=Object(i.useValues)(g.c),d=n.placement,o=n.dashboard,C=n.canEditDashboard,O=n.items,D=n.itemsLoading,y=n.filters,P=n.dashboardMode,oe=n.receivedErrorsFromAPI,I=Object(i.useActions)(g.c),u=I.setDashboardMode,H=I.setDates,ve=I.reportDashboardViewed,ne=I.setProperties,Ce=Object(i.useValues)(nt.a),Se=Ce.featureFlags;return Object(B.useEffect)(function(){ve()},[]),Object(Fe.a)([s.l.Public,s.l.InternalMetrics].includes(d)?{}:{e:{action:function(){return u(P===s.k.Edit?null:s.k.Edit,R.a.Hotkey)},disabled:!C||P!==null&&P!==s.k.Edit},f:{action:function(){return u(P===s.k.Fullscreen?null:s.k.Fullscreen,R.a.Hotkey)},disabled:P!==null&&P!==s.k.Fullscreen},escape:{action:function(){return u(null,R.a.Hotkey)},disabled:P!==s.k.Edit}},[u,P]),!o&&!D&&oe?t.a.createElement(c.a,{object:"dashboard"}):t.a.createElement("div",{className:"dashboard"},![s.l.ProjectHomepage,s.l.Public,s.l.Export,s.l.InternalMetrics].includes(d)&&t.a.createElement(Ot,null),oe?t.a.createElement(Be.d,{title:"There was an error loading this dashboard"}):!O||O.length===0?t.a.createElement(xe,{loading:D}):t.a.createElement("div",null,![s.l.Public,s.l.Export,s.l.InternalMetrics].includes(d)&&t.a.createElement("div",{className:"flex pb border-bottom space-x"},t.a.createElement("div",{className:"flex-grow flex",style:{height:30}},t.a.createElement(Ne.a,{style:{marginRight:8,fontWeight:"bold",lineHeight:"30px"}}),t.a.createElement(l.a,{defaultValue:"Custom",showCustom:!0,dateFrom:(r=y==null?void 0:y.date_from)!==null&&r!==void 0?r:void 0,dateTo:(a=y==null?void 0:y.date_to)!==null&&a!==void 0?a:void 0,onChange:H,disabled:!C,makeLabel:function(Ie){return t.a.createElement(t.a.Fragment,null,t.a.createElement(_.a,null),t.a.createElement("span",{className:"hide-when-small"}," ",Ie))}})),(Se[$e.h.PROPERTY_FILTER_ON_DASHBOARD]||(o==null?void 0:o.filters.properties))&&t.a.createElement(yt.a,{onChange:ne,pageKey:"dashboard_"+(o==null?void 0:o.id),propertyFilters:o==null?void 0:o.filters.properties,useLemonButton:!0})),d!==s.l.Export&&t.a.createElement("div",{className:"flex pt pb space-x dashoard-items-actions"},t.a.createElement("div",{className:"left-item",style:d===s.l.Public?{textAlign:"right"}:void 0},[s.l.Public,s.l.InternalMetrics].includes(d)?t.a.createElement(Te,null):t.a.createElement(fe,null))),t.a.createElement(ae,null)))}try{Je.displayName="Dashboard",Je.__docgenInfo={description:"",displayName:"Dashboard",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},dashboard:{defaultValue:null,description:"",name:"dashboard",required:!1,type:{name:"DashboardType"}},placement:{defaultValue:null,description:"",name:"placement",required:!1,type:{name:"enum",value:[{value:'"dashboard"'},{value:'"internal-metrics"'},{value:'"project-homepage"'},{value:'"public"'},{value:'"export"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/Dashboard.tsx#Dashboard"]={docgenInfo:Je.__docgenInfo,name:"Dashboard",path:"frontend/src/scenes/dashboard/Dashboard.tsx#Dashboard"})}catch(r){}},"./frontend/src/scenes/dashboard/dashboardsLogic.ts":function(Q,E,e){"use strict";e.d(E,"a",function(){return A}),e.d(E,"b",function(){return ae});var z=e("./node_modules/core-js/modules/es.array.sort.js"),Oe=e.n(z),B=e("./node_modules/core-js/modules/es.array.filter.js"),t=e.n(B),i=e("./node_modules/core-js/modules/es.object.to-string.js"),g=e.n(i),q=e("./node_modules/core-js/modules/es.function.name.js"),he=e.n(q),le=e("./node_modules/core-js/modules/es.array.map.js"),Ke=e.n(le),ee=e("./node_modules/core-js/modules/es.regexp.exec.js"),V=e.n(ee),Z=e("./node_modules/core-js/modules/es.string.search.js"),Y=e.n(Z),S=e("./node_modules/core-js/modules/es.array.flat-map.js"),te=e.n(S),$=e("./node_modules/core-js/modules/es.array.unscopables.flat-map.js"),L=e.n($),s=e("./node_modules/kea/lib/index.esm.js"),f=e("./node_modules/fuse.js/dist/fuse.esm.js"),x=e("./frontend/src/models/dashboardsModel.tsx"),J=e("./frontend/src/lib/utils.tsx"),A;(function(l){l.All="all",l.Pinned="pinned",l.Shared="shared"})(A||(A={}));var ae=Object(s.kea)({path:["scenes","dashboard","dashboardsLogic"],actions:{setSearchTerm:function(_){return{searchTerm:_}},setCurrentTab:function(_){return{tab:_}}},reducers:{searchTerm:{setSearchTerm:function(_,T){var m=T.searchTerm;return m}},currentTab:[A.All,{setCurrentTab:function(_,T){var m=T.tab;return m}}]},selectors:{dashboards:[function(l){return[x.a.selectors.nameSortedDashboards,l.searchTerm,l.currentTab]},function(l,_,T){return l=l.filter(function(m){return!m.deleted}).sort(function(m,se){var pe,ie;return((pe=m.name)!==null&&pe!==void 0?pe:"Untitled").localeCompare((ie=se.name)!==null&&ie!==void 0?ie:"Untitled")}),T===A.Pinned?l=l.filter(function(m){return m.pinned}):T===A.Shared&&(l=l.filter(function(m){return m.is_shared})),_?new f.a(l,{keys:["key","name"],threshold:.3}).search(_).map(function(m){return m.item}):l}],dashboardTags:[function(){return[x.a.selectors.nameSortedDashboards]},function(l){return Object(J.Db)(l.flatMap(function(_){var T=_.tags;return T||""}),function(_){return _}).sort()}]}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/Dashboard.scss":function(Q,E,e){var z=e("./node_modules/css-loader/dist/runtime/api.js");E=z(!1),E.push([Q.i,'.dashboard .empty-state .fade-out-graphs:after{content:"";width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent);position:absolute;pointer-events:none;bottom:0}.dashboard-header .dashboard-select{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.dashboard{margin-top:1rem}.dashboard .dashboard-items-action-icon{margin-right:6px}.dashboard .dashboard-items-action-refresh-text{visibility:visible}.dashboard .dashboard-items-action-refresh-text.hidden{visibility:hidden}.dashboard .dashboard-items-action-refresh-text.completed{position:absolute;left:30px}.dashboard .empty-state{position:relative}.dashboard .empty-state .skeleton-actions{text-align:right}.dashboard .empty-state .skeleton-actions .ant-skeleton-avatar{margin-right:8px}.dashboard .empty-state .pie-chart{height:200px;width:200px;max-width:100%;margin-top:1rem}@media(max-width:992px){.dashboard .empty-state .pie-chart{height:140px;width:140px}}.dashboard .empty-state .bar-chart{display:flex;margin-top:1rem;align-items:flex-end}.dashboard .empty-state .bar-chart .bar-el{width:12.5%;margin-left:4px;height:100px}.dashboard .empty-state .ant-col{flex-grow:1}.dashboard .empty-state .ant-col .ant-card{height:100%}.dashboard .empty-state .fade-out-graphs{margin-top:1rem;height:150px;overflow:hidden;position:relative}.dashboard .empty-state .fade-out-graphs:after{width:calc(100% - 16px);left:8px;height:150px}.dashboard .empty-state .cta{width:360px;max-width:calc(100% - 32px);position:absolute;top:16px;left:50%;transform:translateX(-50%);z-index:var(--z-content-overlay)}.dashboard-header{display:flex;justify-content:space-between;margin-bottom:1rem;width:100%}.dashboard-header.full-screen{margin-top:1rem}.dashboard-header .dashboard-select{flex:1;padding-right:2rem}.dashboard-header .dashboard-select .ant-select-single{max-width:100%;line-height:40px}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector{align-items:center;padding-left:0;padding-right:8px;line-height:40px;height:40px}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector .ant-select-selection-item{font-size:28px;font-weight:600;line-height:40px;width:100%;height:35px;display:flex;align-items:center}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector .ant-select-selection-item .anticon-share-alt{font-size:16px;margin-left:6px!important;margin-right:4px}.dashboard-header .dashboard-select .ant-select-single.ant-select-open .ant-select-arrow{color:var(--depr-rgba-text-default-0-4)}.dashboard-header .dashboard-select .ant-select-single .ant-select-arrow{color:var(--text-default);font-size:14px}.dashboard-header .dashboard-meta{white-space:nowrap;display:flex;align-items:center}.dashboard-header .dashboard-meta .ant-btn{margin-left:10px}.dashboard-header .dashboard-meta .ant-btn .anticon{vertical-align:baseline}.dashboard-header .dashboard-meta .ant-btn.button-box{padding:4px 8px}@media(max-width:768px){.dashboard-header{flex-direction:column}.dashboard-header .dashboard-meta{padding-top:1rem;justify-content:flex-end}}#auto-refresh-check{padding:5px 12px;cursor:pointer}.CollaboratorRow{justify-content:space-between;height:2rem;margin-top:.5rem;padding-left:.5rem}.CollaboratorRow,.CollaboratorRow__details{display:flex;align-items:center}.CollaboratorRow__details>span{margin-right:.5rem}',""]),Q.exports=E},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/DashboardItems.scss":function(Q,E,e){var z=e("./node_modules/css-loader/dist/runtime/api.js");E=z(!1),E.push([Q.i,".dashboard-items-wrapper{width:100%}.react-grid-layout{position:relative;transition:height .1s ease;margin-bottom:2rem}.react-grid-layout.dashboard-view-mode .react-grid-item{transition:none}.react-grid-item{transition:all .1s ease;transition-property:left,top}.react-grid-item.cssTransforms{transition-property:transform}.react-grid-item.resizing{z-index:1;will-change:width,height}.react-grid-item.react-draggable{cursor:move}.react-grid-item.react-draggable-dragging{transition:none;z-index:105;will-change:transform}.react-grid-item.dropping{visibility:hidden}.react-grid-item.react-grid-placeholder{transition:.1s ease;max-width:100%;position:relative;border:1px solid var(--primary);outline:1px solid var(--primary);border-radius:var(--radius);z-index:2;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-resizable-hide>.react-resizable-handle{display:none}.react-grid-item>.react-resizable-handle{position:absolute;width:2rem;height:2rem;bottom:-.5rem;right:-.5rem;cursor:se-resize;z-index:10}.react-grid-item>.react-resizable-handle.react-resizable-handle-se{cursor:se-resize}.react-grid-item>.react-resizable-handle.react-resizable-handle-e{top:0;bottom:2rem;height:auto;cursor:ew-resize}.react-grid-item>.react-resizable-handle.react-resizable-handle-s{left:0;right:2rem;width:auto;cursor:ns-resize}.ant-dropdown{z-index:700}.dive-btn{margin-right:.5rem}.dive-btn.dive-btn-dive{border-color:var(--primary);color:var(--primary)}.dive-btn.dive-btn-dive:hover{border-color:var(--depr-darken-primary-30);color:var(--depr-darken-primary-30)}",""]),Q.exports=E}}]);
