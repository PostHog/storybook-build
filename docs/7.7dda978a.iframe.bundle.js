(window.webpackJsonp=window.webpackJsonp||[]).push([[7,8,9,307],{"./frontend/src/scenes/apps/AppMetricsGraph.scss":function(P,l,e){"use strict";e.r(l);var f=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),p=e.n(f),m=e("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/apps/AppMetricsGraph.scss"),d=e.n(m),j={};j.insert="head",j.singleton=!1;var O=p()(d.a,j);l.default=d.a.locals||{}},"./frontend/src/scenes/apps/AppMetricsGraph.tsx":function(P,l,e){"use strict";e.r(l),e.d(l,"AppMetricsGraph",function(){return T});var f=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),p=e.n(f),m=e("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),d=e.n(m),j=e("./node_modules/core-js/modules/es.array.concat.js"),O=e.n(j),R=e("./node_modules/core-js/modules/es.object.keys.js"),H=e.n(R),B=e("./node_modules/core-js/modules/es.symbol.js"),$=e.n(B),K=e("./node_modules/core-js/modules/es.array.filter.js"),N=e.n(K),U=e("./node_modules/core-js/modules/es.object.to-string.js"),V=e.n(U),W=e("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),J=e.n(W),x=e("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Y=e.n(x),S=e("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Z=e.n(S),y=e("./node_modules/react/index.js"),b=e.n(y),v=e("./frontend/src/lib/colors.ts"),I=e("./node_modules/chart.js/dist/chart.mjs"),F=e("./frontend/src/scenes/apps/constants.tsx"),D=e("./frontend/src/lib/components/LemonSkeleton/index.tsx"),L=e("./frontend/src/scenes/apps/AppMetricsGraph.scss"),A=e("./frontend/src/lib/utils.tsx");function g(_,i){var s=Object.keys(_);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(_);i&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(_,t).enumerable})),s.push.apply(s,r)}return s}function h(_){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?g(Object(s),!0).forEach(function(r){p()(_,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach(function(r){Object.defineProperty(_,r,Object.getOwnPropertyDescriptor(s,r))})}return _}function T(_){var i=_.tab,s=_.metrics,r=_.metricsLoading,t=Object(y.useRef)(null),n=F.DescriptionColumns[i];return Object(y.useEffect)(function(){var o;if(t.current&&s){var a;o=new I.a((a=t.current)===null||a===void 0?void 0:a.getContext("2d"),{type:"line",data:{labels:s.dates,datasets:[h({label:n.successes,data:s.successes,borderColor:""},c("data-brand-blue"))].concat(d()(n.successes_on_retry?[h({label:n.successes_on_retry,data:s.successes_on_retry},c("data-yellow"))]:[]),[h({label:n.failures,data:s.failures},c("data-pink"))])},options:{scales:{x:{ticks:{maxRotation:0},grid:{display:!1}},y:{beginAtZero:!0}},plugins:{crosshair:!1,legend:{display:!1}},maintainAspectRatio:!1,interaction:{mode:"index",axis:"x",intersect:!1}}})}return function(){var E;(E=o)===null||E===void 0||E.destroy()}},[s]),r||!s?b.a.createElement(D.a,{className:"AppMetricsGraph"}):b.a.createElement("div",{className:"AppMetricsGraph"},b.a.createElement("canvas",{ref:t}))}function c(_){var i=Object(v.b)(_);return{borderColor:i,hoverBorderColor:Object(A.lb)(i,-20),hoverBackgroundColor:Object(A.lb)(i,-20),backgroundColor:i,fill:!1,borderWidth:2,pointRadius:0}}try{T.displayName="AppMetricsGraph",T.__docgenInfo={description:"",displayName:"AppMetricsGraph",props:{tab:{defaultValue:null,description:"",name:"tab",required:!0,type:{name:"enum",value:[{value:'"processEvent"'},{value:'"onEvent"'},{value:'"exportEvents"'},{value:'"historical_exports"'}]}},metrics:{defaultValue:null,description:"",name:"metrics",required:!0,type:{name:"AppMetrics | null"}},metricsLoading:{defaultValue:null,description:"",name:"metricsLoading",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/apps/AppMetricsGraph.tsx#AppMetricsGraph"]={docgenInfo:T.__docgenInfo,name:"AppMetricsGraph",path:"frontend/src/scenes/apps/AppMetricsGraph.tsx#AppMetricsGraph"})}catch(_){}},"./frontend/src/scenes/apps/appMetricsSceneLogic.ts":function(P,l,e){"use strict";e.r(l),e.d(l,"AppMetricsTab",function(){return c}),e.d(l,"appMetricsSceneLogic",function(){return i});var f=e("./node_modules/@babel/runtime/helpers/slicedToArray.js"),p=e.n(f),m=e("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),d=e.n(m),j=e("./node_modules/@babel/runtime/regenerator/index.js"),O=e.n(j),R=e("./node_modules/core-js/modules/es.array.iterator.js"),H=e.n(R),B=e("./node_modules/core-js/modules/es.object.to-string.js"),$=e.n(B),K=e("./node_modules/core-js/modules/web.dom-collections.iterator.js"),N=e.n(K),U=e("./node_modules/core-js/modules/es.array.concat.js"),V=e.n(U),W=e("./node_modules/core-js/modules/es.function.name.js"),J=e.n(W),x=e("./node_modules/core-js/modules/es.array.includes.js"),Y=e.n(x),S=e("./node_modules/core-js/modules/es.string.includes.js"),Z=e.n(S),y=e("./node_modules/core-js/modules/es.array.filter.js"),b=e.n(y),v=e("./node_modules/kea/lib/index.esm.js"),I=e("./node_modules/kea-loaders/lib/index.js"),F=e.n(I),D=e("./frontend/src/scenes/urls.ts"),L=e("./frontend/src/lib/api.ts"),A=e("./frontend/src/scenes/teamLogic.tsx"),g=e("./node_modules/kea-router/lib/index.js"),h=e.n(g),T=e("./frontend/src/lib/utils.tsx"),c;(function(s){s.ProcessEvent="processEvent",s.OnEvent="onEvent",s.ExportEvents="exportEvents",s.HistoricalExports="historical_exports"})(c||(c={}));var _=[c.ProcessEvent,c.OnEvent,c.ExportEvents],i=Object(v.kea)([Object(v.path)(function(s){return["scenes","apps","appMetricsSceneLogic",s]}),Object(v.props)({}),Object(v.key)(function(s){return s.pluginConfigId}),Object(v.actions)({setActiveTab:function(r){return{tab:r}},setDateFrom:function(r){return{dateFrom:r}}}),Object(v.reducers)({activeTab:[null,{setActiveTab:function(r,t){var n=t.tab;return n}}],dateFrom:["-30d",{setDateFrom:function(r,t){var n=t.dateFrom;return n}}]}),Object(I.loaders)(function(s){var r=s.values,t=s.props;return{pluginConfig:[null,{loadPluginConfig:function(){var n=d()(O.a.mark(function a(){return O.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,L.b.get("api/projects/".concat(A.a.values.currentTeamId,"/plugin_configs/").concat(t.pluginConfigId));case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a)}));function o(){return n.apply(this,arguments)}return o}()}],metrics:[null,{loadMetrics:function(){var n=d()(O.a.mark(function a(){var E,u,G;return O.a.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return E=Object(T.Eb)({category:r.activeTab,date_from:r.dateFrom}),C.next=3,L.b.get("api/projects/".concat(A.a.values.currentTeamId,"/app_metrics/").concat(t.pluginConfigId,"?").concat(E));case 3:return u=C.sent,G=u.results,C.abrupt("return",G);case 6:case"end":return C.stop()}},a)}));function o(){return n.apply(this,arguments)}return o}()}],historicalExports:[[],{loadHistoricalExports:function(){var n=d()(O.a.mark(function a(){var E,u;return O.a.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,L.b.get("api/projects/".concat(A.a.values.currentTeamId,"/app_metrics/").concat(t.pluginConfigId,"/historical_exports"));case 2:return E=M.sent,u=E.results,M.abrupt("return",u);case 5:case"end":return M.stop()}},a)}));function o(){return n.apply(this,arguments)}return o}()}]}}),Object(v.selectors)(function(s){var r=s.values;return{breadcrumbs:[function(t){return[t.pluginConfig,function(n,o){return o.pluginConfigId}]},function(t,n){var o;return[{name:"Apps",path:D.a.projectApps()},{name:t==null||(o=t.plugin_info)===null||o===void 0?void 0:o.name,path:D.a.appMetrics(n)}]}],showTab:[function(){return[]},function(){return function(t){var n;if(r.pluginConfigLoading||!r.pluginConfig)return!1;var o=((n=r.pluginConfig.plugin_info.capabilities)===null||n===void 0?void 0:n.methods)||[];return t===c.HistoricalExports?o.includes("exportEvents"):t===c.OnEvent&&o.includes("exportEvents")?!1:o.includes(t)}}]}}),Object(v.listeners)(function(s){var r=s.values,t=s.actions;return{loadPluginConfigSuccess:function(){if(!r.activeTab){var o=_.filter(function(u){return r.showTab(u)}),a=p()(o,1),E=a[0];t.setActiveTab(E)}},setActiveTab:function(o){var a=o.tab;a===c.HistoricalExports?t.loadHistoricalExports():t.loadMetrics()},setDateFrom:function(){t.loadMetrics()}}}),Object(g.actionToUrl)(function(s){var r=s.values,t=s.props;return{setActiveTab:function(){var o;return r.activeTab===c.HistoricalExports?D.a.appHistoricalExports(t.pluginConfigId):D.a.appMetrics(t.pluginConfigId,(o=r.activeTab)!==null&&o!==void 0?o:void 0)}}}),Object(g.urlToAction)(function(s){var r=s.values,t=s.actions;return{"/app/:pluginConfigId/:page":function(o,a){r.pluginConfig||t.loadPluginConfig(),o.page===c.HistoricalExports?t.setActiveTab(c.HistoricalExports):a.tab&&_.includes(a.tab)&&t.setActiveTab(a.tab)}}})])},"./frontend/src/scenes/apps/constants.tsx":function(P,l,e){"use strict";e.r(l),e.d(l,"DescriptionColumns",function(){return j});var f=e("./node_modules/@babel/runtime/helpers/defineProperty.js"),p=e.n(f),m=e("./frontend/src/scenes/apps/appMetricsSceneLogic.ts"),d,j=(d={},p()(d,m.AppMetricsTab.ProcessEvent,{successes:"Events processed",failures:"Failed events"}),p()(d,m.AppMetricsTab.OnEvent,{successes:"Events processed",successes_on_retry:"Events processed on retry",failures:"Failed events"}),p()(d,m.AppMetricsTab.ExportEvents,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),p()(d,m.AppMetricsTab.HistoricalExports,{successes:"Events delivered",successes_on_retry:"Events delivered on retry",failures:"Failed events"}),d)},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/apps/AppMetricsGraph.scss":function(P,l,e){var f=e("./node_modules/css-loader/dist/runtime/api.js");l=f(!1),l.push([P.i,".AppMetricsGraph{height:300px}",""]),P.exports=l}}]);
