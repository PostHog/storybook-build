"use strict";(self.webpackChunkposthog=self.webpackChunkposthog||[]).push([[61371],{"./frontend/src/scenes/pipeline/destinations/destinationsLogic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{w:()=>pipelineDestinationsLogic});var _posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),fuse_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/.pnpm/fuse.js@6.6.2/node_modules/fuse.js/dist/fuse.esm.js"),kea__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),kea_router__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/kea-router@3.1.4_kea@3.1.5/node_modules/kea-router/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/lib/api.ts"),lib_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./frontend/src/lib/utils.tsx"),lib_utils_deleteWithUndo__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./frontend/src/lib/utils/deleteWithUndo.tsx"),scenes_teamLogic__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./frontend/src/scenes/teamLogic.tsx"),scenes_userLogic__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./frontend/src/scenes/userLogic.ts"),_types__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./frontend/src/types.ts"),_pipelineAccessLogic__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./frontend/src/scenes/pipeline/pipelineAccessLogic.tsx"),_types__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./frontend/src/scenes/pipeline/types.ts"),_utils__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./frontend/src/scenes/pipeline/utils.tsx");let pipelineDestinationsLogic=(0,kea__WEBPACK_IMPORTED_MODULE_1__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_1__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_1__.key)(props=>props.syncFiltersWithUrl?"scene":"default"),(0,kea__WEBPACK_IMPORTED_MODULE_1__.path)(id=>["scenes","pipeline","destinationsLogic",id]),(0,kea__WEBPACK_IMPORTED_MODULE_1__.connect)({values:[scenes_teamLogic__WEBPACK_IMPORTED_MODULE_7__.teamLogic,["currentTeamId"],scenes_userLogic__WEBPACK_IMPORTED_MODULE_8__.userLogic,["user","hasAvailableFeature"],_pipelineAccessLogic__WEBPACK_IMPORTED_MODULE_10__.g,["canEnableDestination"]]}),(0,kea__WEBPACK_IMPORTED_MODULE_1__.actions)({toggleNode:(destination,enabled)=>({destination,enabled}),toggleNodeHogFunction:(destination,enabled)=>({destination,enabled}),deleteNode:destination=>({destination}),deleteNodeBatchExport:destination=>({destination}),deleteNodeHogFunction:destination=>({destination}),deleteNodeWebhook:destination=>({destination}),updatePluginConfig:pluginConfig=>({pluginConfig}),updateBatchExportConfig:batchExportConfig=>({batchExportConfig}),setFilters:filters=>({filters}),resetFilters:!0}),(0,kea__WEBPACK_IMPORTED_MODULE_1__.reducers)(_ref=>{let{props}=_ref;return{filters:[{...props.defaultFilters||{},...props.forceFilters||{}},{setFilters:(state,_ref2)=>{let{filters}=_ref2;return{...state,...filters,...props.forceFilters||{}}},resetFilters:()=>({...props.forceFilters||{}})}]}}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_2__.loaders)(_ref3=>{let{values,actions}=_ref3;return{plugins:[{},{loadPlugins:async()=>(0,_utils__WEBPACK_IMPORTED_MODULE_12__.c$)("api/organizations/@current/pipeline_destinations")}],pluginConfigs:[{},{loadPluginConfigs:async()=>{let pluginConfigs={},results=await lib_api__WEBPACK_IMPORTED_MODULE_4__.ZP.loadPaginatedResults(`api/projects/${values.currentTeamId}/pipeline_destination_configs`);for(let pluginConfig of results)pluginConfigs[pluginConfig.id]={...pluginConfig,name:pluginConfig.name||values.plugins[pluginConfig.plugin]?.name||"Unknown app",description:pluginConfig.description||values.plugins[pluginConfig.plugin]?.description};return pluginConfigs},toggleNodeWebhook:async _ref4=>{let{destination,enabled}=_ref4,{pluginConfigs,plugins}=values,pluginConfig=pluginConfigs[destination.id],plugin=plugins[pluginConfig.plugin];(0,_utils__WEBPACK_IMPORTED_MODULE_12__.SO)(`plugin ${enabled?"enabled":"disabled"}`,plugin,pluginConfig);let response=await lib_api__WEBPACK_IMPORTED_MODULE_4__.ZP.update(`api/plugin_config/${destination.id}`,{enabled});return{...pluginConfigs,[destination.id]:response}},updatePluginConfig:_ref5=>{let{pluginConfig}=_ref5;return{...values.pluginConfigs,[pluginConfig.id]:pluginConfig}},deleteNodeWebhook:async _ref6=>{let{destination}=_ref6;await (0,lib_utils_deleteWithUndo__WEBPACK_IMPORTED_MODULE_6__.S)({endpoint:`projects/${scenes_teamLogic__WEBPACK_IMPORTED_MODULE_7__.teamLogic.values.currentTeamId}/plugin_configs`,object:{id:destination.id,name:destination.name},callback:undo=>{undo&&actions.loadPluginConfigs()}});let pluginConfigs={...values.pluginConfigs};return delete pluginConfigs[destination.id],pluginConfigs}}],batchExportConfigs:[{},{loadBatchExports:async()=>{let results=await lib_api__WEBPACK_IMPORTED_MODULE_4__.ZP.loadPaginatedResults(`api/projects/${values.currentTeamId}/batch_exports`);return Object.fromEntries(results.map(batchExport=>[batchExport.id,batchExport]))},toggleNodeBatchExport:async _ref7=>{let{destination,enabled}=_ref7,batchExport=values.batchExportConfigs[destination.id];return enabled?await lib_api__WEBPACK_IMPORTED_MODULE_4__.ZP.batchExports.unpause(destination.id):await lib_api__WEBPACK_IMPORTED_MODULE_4__.ZP.batchExports.pause(destination.id),(0,_utils__WEBPACK_IMPORTED_MODULE_12__.hO)(`batch export ${enabled?"enabled":"disabled"}`,batchExport),{...values.batchExportConfigs,[destination.id]:{...batchExport,paused:!enabled}}},deleteNodeBatchExport:async _ref8=>{let{destination}=_ref8;await lib_api__WEBPACK_IMPORTED_MODULE_4__.ZP.batchExports.delete(destination.id);let batchExportConfigs={...values.batchExportConfigs};return delete batchExportConfigs[destination.id],batchExportConfigs},updateBatchExportConfig:_ref9=>{let{batchExportConfig}=_ref9;return{...values.batchExportConfigs,[batchExportConfig.id]:batchExportConfig}}}],hogFunctions:[[],{loadHogFunctions:async()=>(await lib_api__WEBPACK_IMPORTED_MODULE_4__.ZP.hogFunctions.list({filters:values.filters?.filters})).results,deleteNodeHogFunction:async _ref10=>{let{destination}=_ref10;return destination.backend!==_types__WEBPACK_IMPORTED_MODULE_11__.b.HogFunction?values.hogFunctions:(await (0,lib_utils_deleteWithUndo__WEBPACK_IMPORTED_MODULE_6__.S)({endpoint:`projects/${scenes_teamLogic__WEBPACK_IMPORTED_MODULE_7__.teamLogic.values.currentTeamId}/hog_functions`,object:{id:destination.hog_function.id,name:destination.name},callback:undo=>{undo&&actions.loadHogFunctions()}}),values.hogFunctions.filter(hogFunction=>hogFunction.id!==destination.hog_function.id))},toggleNodeHogFunction:async _ref11=>{let{destination,enabled}=_ref11,{hogFunctions}=values,hogFunctionIndex=hogFunctions.findIndex(hf=>hf.id===destination.hog_function.id),response=await lib_api__WEBPACK_IMPORTED_MODULE_4__.ZP.hogFunctions.update(destination.hog_function.id,{enabled});return[...hogFunctions.slice(0,hogFunctionIndex),response,...hogFunctions.slice(hogFunctionIndex+1)]}}]}}),(0,kea__WEBPACK_IMPORTED_MODULE_1__.selectors)({loading:[s=>[s.pluginsLoading,s.pluginConfigsLoading,s.batchExportConfigsLoading,s.hogFunctionsLoading],(pluginsLoading,pluginConfigsLoading,batchExportConfigsLoading,hogFunctionsLoading)=>pluginsLoading||pluginConfigsLoading||batchExportConfigsLoading||hogFunctionsLoading],destinations:[s=>[s.pluginConfigs,s.plugins,s.batchExportConfigs,s.hogFunctions,s.user],(pluginConfigs,plugins,batchExportConfigs,hogFunctions,user)=>{let rawBatchExports=Object.values(batchExportConfigs).filter(config=>"HTTP"!==config.destination.type||user?.is_impersonated),rawDestinations=[].concat(hogFunctions).concat(Object.values(pluginConfigs).map(pluginConfig=>({...pluginConfig,plugin_info:plugins[pluginConfig.plugin]||null}))).concat(rawBatchExports),convertedDestinations=rawDestinations.map(d=>(0,_types__WEBPACK_IMPORTED_MODULE_11__.n)(d,_types__WEBPACK_IMPORTED_MODULE_9__.We.Destination)),enabledFirst=convertedDestinations.sort((a,b)=>Number(b.enabled)-Number(a.enabled));return enabledFirst}],destinationsFuse:[s=>[s.destinations],destinations=>new fuse_js__WEBPACK_IMPORTED_MODULE_13__.Z(destinations||[],{keys:["name","description"],threshold:.3})],filteredDestinations:[s=>[s.filters,s.destinations,s.destinationsFuse],(filters,destinations,destinationsFuse)=>{let{search,onlyActive,kind}=filters;return(search?destinationsFuse.search(search).map(x=>x.item):destinations).filter(dest=>(!kind||dest.backend===kind)&&(!onlyActive||!!dest.enabled))}]}),(0,kea__WEBPACK_IMPORTED_MODULE_1__.listeners)(_ref12=>{let{values,actions}=_ref12;return{toggleNode:_ref13=>{let{destination,enabled}=_ref13;if(enabled&&!values.canEnableDestination(destination)){_posthog_lemon_ui__WEBPACK_IMPORTED_MODULE_0__.lemonToast.error("Data pipelines add-on is required for enabling new destinations.");return}destination.backend===_types__WEBPACK_IMPORTED_MODULE_11__.b.Plugin?actions.toggleNodeWebhook({destination:destination,enabled:enabled}):destination.backend===_types__WEBPACK_IMPORTED_MODULE_11__.b.BatchExport?actions.toggleNodeBatchExport({destination:destination,enabled:enabled}):destination.backend===_types__WEBPACK_IMPORTED_MODULE_11__.b.HogFunction&&actions.toggleNodeHogFunction(destination,enabled)},deleteNode:_ref14=>{let{destination}=_ref14;switch(destination.backend){case _types__WEBPACK_IMPORTED_MODULE_11__.b.Plugin:actions.deleteNodeWebhook(destination);break;case _types__WEBPACK_IMPORTED_MODULE_11__.b.BatchExport:actions.deleteNodeBatchExport(destination);break;case _types__WEBPACK_IMPORTED_MODULE_11__.b.HogFunction:actions.deleteNodeHogFunction(destination)}}}}),(0,kea_router__WEBPACK_IMPORTED_MODULE_3__.actionToUrl)(_ref15=>{let{props,values}=_ref15;if(!props.syncFiltersWithUrl)return{};let urlFromFilters=()=>[kea_router__WEBPACK_IMPORTED_MODULE_3__.router.values.location.pathname,values.filters,kea_router__WEBPACK_IMPORTED_MODULE_3__.router.values.hashParams,{replace:!0}];return{setFilters:()=>urlFromFilters(),resetFilters:()=>urlFromFilters()}}),(0,kea_router__WEBPACK_IMPORTED_MODULE_3__.urlToAction)(_ref16=>{let{props,actions,values}=_ref16;return{"*":(_,searchParams)=>{props.syncFiltersWithUrl&&((0,lib_utils__WEBPACK_IMPORTED_MODULE_5__.h0)(values.filters,searchParams)||actions.setFilters(searchParams))}}}),(0,kea__WEBPACK_IMPORTED_MODULE_1__.afterMount)(_ref17=>{let{actions}=_ref17;actions.loadPlugins(),actions.loadPluginConfigs(),actions.loadBatchExports(),actions.loadHogFunctions()})])},"./frontend/src/scenes/pipeline/hogfunctions/HogFunctionIcon.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_:()=>HogFunctionIcon,g:()=>HogFunctionIconEditable});var lemon_ui_src=__webpack_require__("./frontend/@posthog/lemon-ui/src/index.ts"),clsx_m=__webpack_require__("./node_modules/.pnpm/clsx@1.2.1/node_modules/clsx/dist/clsx.m.js"),index_esm=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),icons=__webpack_require__("./frontend/src/lib/lemon-ui/icons/index.ts"),react=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),lib=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),api=__webpack_require__("./frontend/src/lib/api.ts");let hogFunctionIconLogic=(0,index_esm.kea)([(0,index_esm.props)({}),(0,index_esm.key)(props=>{var _props$logicKey;return null!==(_props$logicKey=props.logicKey)&&void 0!==_props$logicKey?_props$logicKey:"default"}),(0,index_esm.path)(key=>["scenes","pipeline","hogfunctions","hogFunctionIconLogic",key]),(0,index_esm.actions)({loadPossibleIcons:!0,setShowPopover:show=>({show}),setSearchTerm:search=>({search})}),(0,index_esm.reducers)({showPopover:[!1,{setShowPopover:(_,_ref)=>{let{show}=_ref;return show}}],searchTerm:[null,{setSearchTerm:(_,_ref2)=>{let{search}=_ref2;return search},setShowPopover:()=>null}]}),(0,lib.loaders)(_ref3=>{let{values}=_ref3;return{possibleIcons:[null,{loadPossibleIcons:async(_,breakpoint)=>{let search=values.searchTerm;if(!search)return[];await breakpoint(1e3);let res=await api.ZP.hogFunctions.listIcons({query:search});return res.map(icon=>({...icon,url:icon.url+"&temp=true"}))}}]}}),(0,index_esm.listeners)(_ref4=>{let{actions}=_ref4;return{setShowPopover:_ref5=>{let{show}=_ref5;show&&actions.loadPossibleIcons()},setSearchTerm:()=>{actions.loadPossibleIcons()}}})]);var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");let fileToBase64=file=>new Promise(resolve=>{if(!file)return;let reader=new FileReader;reader.onload=e=>{let img=new Image;img.onload=()=>{let canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.width=128,canvas.height=128,ctx.drawImage(img,0,0,128,128);let dataURI=canvas.toDataURL();resolve(dataURI)},img.src=e.target?.result},reader.readAsDataURL(file)});function HogFunctionIconEditable(_ref){var _possibleIcons$map;let{size="medium",...props}=_ref,{possibleIconsLoading,showPopover,possibleIcons,searchTerm}=(0,index_esm.useValues)(hogFunctionIconLogic(props)),{setShowPopover,setSearchTerm}=(0,index_esm.useActions)(hogFunctionIconLogic(props)),content=(0,jsx_runtime.jsx)("span",{className:"cursor-pointer",onClick:()=>setShowPopover(!showPopover),children:(0,jsx_runtime.jsx)(HogFunctionIcon,{size:size,src:props.src})});return props.onChange?(0,jsx_runtime.jsx)(lemon_ui_src.Popover,{showArrow:!0,visible:showPopover,onClickOutside:()=>setShowPopover(!1),overlay:(0,jsx_runtime.jsxs)("div",{className:"p-1 w-100 space-y-2",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2 justify-between",children:[(0,jsx_runtime.jsx)("h2",{className:"m-0",children:"Choose an icon"}),(0,jsx_runtime.jsx)(lemon_ui_src.LemonFileInput,{multiple:!1,accept:"image/*",showUploadedFiles:!1,onChange:files=>{fileToBase64(files[0]).then(dataURI=>{props.onChange?.(dataURI)}).catch(()=>{lemon_ui_src.lemonToast.error("Error uploading image")})},callToAction:(0,jsx_runtime.jsx)(lemon_ui_src.LemonButton,{size:"small",type:"secondary",icon:(0,jsx_runtime.jsx)(icons.bn,{}),children:"Upload image"})})]}),(0,jsx_runtime.jsx)(lemon_ui_src.LemonInput,{size:"small",type:"search",placeholder:"Search for company logos",fullWidth:!0,value:null!=searchTerm?searchTerm:"",onChange:setSearchTerm,prefix:possibleIconsLoading?(0,jsx_runtime.jsx)(lemon_ui_src.Spinner,{}):void 0}),(0,jsx_runtime.jsx)("div",{className:"flex flex-wrap gap-2",children:null!==(_possibleIcons$map=possibleIcons?.map(icon=>jsx_runtime.jsx("span",{className:"cursor-pointer",onClick:()=>{let nonTempUrl=icon.url.replace("&temp=true","");props.onChange?.(nonTempUrl),setShowPopover(!1)},children:jsx_runtime.jsx(HogFunctionIcon,{src:icon.url})},icon.id)))&&void 0!==_possibleIcons$map?_possibleIcons$map:possibleIconsLoading?(0,jsx_runtime.jsx)(lemon_ui_src.LemonSkeleton,{className:"w-14 h-14",repeat:4}):"No icons found"})]}),children:content}):content}function HogFunctionIcon(_ref2){let{src,size="medium"}=_ref2,[loaded,setLoaded]=(0,react.useState)(!1);return(0,jsx_runtime.jsx)("span",{className:(0,clsx_m.default)("relative flex items-center justify-center",{"w-8 h-8 text-2xl":"small"===size,"w-10 h-10 text-4xl":"medium"===size,"w-12 h-12 text-6xl":"large"===size}),children:src?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("img",{className:(0,clsx_m.default)("w-full h-full rounded overflow-hidden transition-opacity",loaded?"opacity-100":"opacity-0"),src:src,onLoad:()=>setLoaded(!0)}),!loaded&&(0,jsx_runtime.jsx)(lemon_ui_src.LemonSkeleton,{className:"absolute w-full h-full"})]}):(0,jsx_runtime.jsx)("span",{children:"\uD83E\uDD94"})})}},"./frontend/src/scenes/pipeline/pipelineNodeMetricsLogic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{j:()=>pipelineNodeMetricsLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/lib/api.ts"),lib_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./frontend/src/lib/utils.tsx"),scenes_teamLogic__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./frontend/src/scenes/teamLogic.tsx");let pipelineNodeMetricsLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.key)(_ref=>{let{id}=_ref;return id}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(id=>["scenes","pipeline","appMetricsLogic",id]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)({values:[scenes_teamLogic__WEBPACK_IMPORTED_MODULE_4__.teamLogic,["currentTeamId"]]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setDateRange:(from,to)=>({from,to}),openErrorDetailsModal:errorType=>({errorType}),closeErrorDetailsModal:!0}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)(_ref2=>{let{values,props}=_ref2;return{appMetricsResponse:[null,{loadMetrics:async()=>{let params=(0,lib_utils__WEBPACK_IMPORTED_MODULE_3__.oZ)({date_from:values.dateRange.from,date_to:values.dateRange.to});return await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.get(`api/projects/${scenes_teamLogic__WEBPACK_IMPORTED_MODULE_4__.teamLogic.values.currentTeamId}/app_metrics/${props.id}?${params}`)}}],errorDetails:[[],{openErrorDetailsModal:async _ref3=>{let{errorType}=_ref3,params=(0,lib_utils__WEBPACK_IMPORTED_MODULE_3__.oZ)({error_type:errorType}),{result}=await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.get(`api/projects/${scenes_teamLogic__WEBPACK_IMPORTED_MODULE_4__.teamLogic.values.currentTeamId}/app_metrics/${props.id}/error_details?${params}`);return result}}]}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({dateRange:[{from:"-7d",to:null},{setDateRange:(_,_ref4)=>{let{from,to}=_ref4;return{from:null!=from?from:"-7d",to:to}}}],errorDetailsModalError:[null,{openErrorDetailsModal:(_,_ref5)=>{let{errorType}=_ref5;return errorType},closeErrorDetailsModal:()=>null}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.listeners)(_ref6=>{let{actions}=_ref6;return{setDateRange:()=>{actions.loadMetrics()}}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.afterMount)(_ref7=>{let{actions}=_ref7;actions.loadMetrics()})])},"./frontend/src/scenes/pipeline/pipelineNodeMetricsV2Logic.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{K:()=>pipelineNodeMetricsV2Logic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/kea@3.1.5_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/kea-loaders@3.0.0_kea@3.1.5/node_modules/kea-loaders/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./frontend/src/lib/api.ts");let pipelineNodeMetricsV2Logic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.key)(_ref=>{let{id}=_ref;return id}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(id=>["scenes","pipeline","appMetricsLogic",id]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setFilters:filters=>({filters})}),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)(_ref2=>{let{values,props}=_ref2;return{appMetrics:[null,{loadMetrics:async()=>{let params={...values.filters,breakdown_by:"name"};return await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.hogFunctions.metrics(props.id,params)}}],appMetricsTotals:[null,{loadMetricsTotals:async()=>await lib_api__WEBPACK_IMPORTED_MODULE_2__.ZP.hogFunctions.metricsTotals(props.id,{breakdown_by:"name"})}]}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)({filters:[{before:void 0,after:"-7d",interval:"day"},{setFilters:(state,_ref3)=>{let{filters}=_ref3;return{...state,...filters}}}]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.listeners)(_ref4=>{let{actions}=_ref4;return{setFilters:async(_,breakpoint)=>{await breakpoint(100),actions.loadMetrics()}}})])}}]);