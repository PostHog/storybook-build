"use strict";(self.webpackChunk_posthog_storybook=self.webpackChunk_posthog_storybook||[]).push([[68459],{"../../frontend/src/scenes/data-management/definition/DefinitionView.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DefinitionView:()=>DefinitionView,scene:()=>scene});var index_esm=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),lib=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),react=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),posthog_icons_es=__webpack_require__("../../node_modules/.pnpm/@posthog+icons@0.33.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@posthog/icons/dist/posthog-icons.es.js"),src=__webpack_require__("../../frontend/@posthog/lemon-ui/src/index.ts"),EditableField=__webpack_require__("../../frontend/src/lib/components/EditableField/EditableField.tsx"),NotFound=__webpack_require__("../../frontend/src/lib/components/NotFound/index.tsx"),ObjectTags=__webpack_require__("../../frontend/src/lib/components/ObjectTags/ObjectTags.tsx"),TZLabel=__webpack_require__("../../frontend/src/lib/components/TZLabel/index.tsx"),types=__webpack_require__("../../frontend/src/lib/components/TaxonomicFilter/types.ts"),upgradeModalLogic=__webpack_require__("../../frontend/src/lib/components/UpgradeModal/upgradeModalLogic.ts"),UserActivityIndicator=__webpack_require__("../../frontend/src/lib/components/UserActivityIndicator/UserActivityIndicator.tsx"),LemonButton=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonButton/index.ts"),LemonDialog=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonDialog/index.ts"),Spinner=__webpack_require__("../../frontend/src/lib/lemon-ui/Spinner/Spinner.tsx"),icons=__webpack_require__("../../frontend/src/lib/lemon-ui/icons/index.ts"),definitionLogic=__webpack_require__("../../frontend/src/scenes/data-management/definition/definitionLogic.ts"),LemonTable=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/index.ts"),LemonTableLink=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/LemonTableLink.tsx"),columnUtils=__webpack_require__("../../frontend/src/lib/lemon-ui/LemonTable/columnUtils.tsx"),kea_loaders_lib=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.7_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),api=__webpack_require__("../../frontend/src/lib/api.ts"),utils=__webpack_require__("../../frontend/src/lib/utils.tsx"),eventUsageLogic=__webpack_require__("../../frontend/src/lib/utils/eventUsageLogic.ts"),savedInsightsLogic=__webpack_require__("../../frontend/src/scenes/saved-insights/savedInsightsLogic.ts"),teamLogic=__webpack_require__("../../frontend/src/scenes/teamLogic.tsx"),InsightViz_utils=__webpack_require__("../../frontend/src/queries/nodes/InsightViz/utils.ts");let eventInsightsLogic=(0,index_esm.kea)([(0,index_esm.path)(["scenes","data-management","events","eventInsightsLogic"]),(0,index_esm.props)({}),(0,index_esm.key)(_ref=>{let{event}=_ref;return event}),(0,index_esm.connect)(()=>({values:[teamLogic.teamLogic,["currentTeamId"]],logic:[eventUsageLogic.vx]})),(0,index_esm.actions)({setFilters:filters=>({filters}),loadInsights:!0,setPage:page=>({page})}),(0,kea_loaders_lib.loaders)(_ref2=>{let{values,props}=_ref2;return{insights:{__default:{results:[],count:0,filters:null,offset:0},loadInsights:async()=>{let{filters}=values,{order,page,search}=filters,params={order,limit:10,offset:Math.max(0,(page-1)*10),saved:!0,basic:!0};search&&(params.search=search),params.events=[props.event];let response=await api.ZP.get(`api/environments/${values.currentTeamId}/insights/?${(0,utils.oZ)(params)}`);return{...response,filters,results:response.results.map(rawInsight=>(0,InsightViz_utils.Q0)(rawInsight))}}}}}),(0,index_esm.reducers)({rawFilters:[null,{setFilters:(state,_ref3)=>{let{filters}=_ref3;return(0,savedInsightsLogic.Ow)({...state,...filters,..."page"in filters?{}:{page:1}})}}]}),(0,index_esm.selectors)({filters:[s=>[s.rawFilters],rawFilters=>(0,savedInsightsLogic.Ow)(rawFilters||{})],count:[s=>[s.insights],insights=>insights.count],sorting:[s=>[s.filters],filters=>filters.order?filters.order.startsWith("-")?{columnKey:filters.order.slice(1),order:-1}:{columnKey:filters.order,order:1}:null],page:[s=>[s.filters],filters=>filters.page],usingFilters:[s=>[s.filters],filters=>!(0,utils.h0)((0,savedInsightsLogic.Ow)({...filters,events:void 0}),(0,savedInsightsLogic.Ow)({}))]}),(0,index_esm.listeners)(_ref4=>{let{actions,values,selectors}=_ref4;return{setPage:async _ref5=>{let{page}=_ref5;actions.setFilters({page}),actions.loadInsights()},setFilters:async(_ref6,breakpoint,__,previousState)=>{let{}=_ref6,oldFilters=selectors.filters(previousState),newFilters=values.filters;await breakpoint(300),(0,utils.h0)(oldFilters,newFilters)||actions.loadInsights()}}}),(0,index_esm.events)(_ref7=>{let{actions}=_ref7;return{afterMount:()=>{actions.loadInsights()}}})]);var insights_summarizeInsight=__webpack_require__("../../frontend/src/scenes/insights/summarizeInsight.ts"),SavedInsights=__webpack_require__("../../frontend/src/scenes/saved-insights/SavedInsights.tsx"),urls=__webpack_require__("../../frontend/src/scenes/urls.ts"),SceneSection=__webpack_require__("../../frontend/src/layout/scenes/components/SceneSection.tsx"),jsx_runtime=__webpack_require__("../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");function EventDefinitionInsights(_ref){let{definition}=_ref,event=definition.name,{page,insights,filters,insightsLoading,sorting}=(0,index_esm.useValues)(eventInsightsLogic({event})),{setPage,setFilters}=(0,index_esm.useActions)(eventInsightsLogic({event})),summarizeInsight=(0,insights_summarizeInsight.DF)(),columns=[{key:"id",width:32,render:function renderType(_,insight){return(0,jsx_runtime.jsx)(SavedInsights.InsightIcon,{insight:insight,className:"text-secondary text-2xl"})}},{title:"Name",dataIndex:"name",key:"name",render:function renderName(name,insight){return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(LemonTableLink.i,{to:urls.j.insightView(insight.short_id),title:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:name||(0,jsx_runtime.jsx)("i",{children:summarizeInsight(insight.query)})}),description:insight.description})})},sorter:(a,b)=>(a.name||summarizeInsight(a.query)).localeCompare(b.name||summarizeInsight(b.query))},(0,columnUtils.JB)(),(0,columnUtils.rw)(),{title:"Last modified",sorter:!0,dataIndex:"last_modified_at",render:function renderLastModified(last_modified_at){return(0,jsx_runtime.jsx)("div",{className:"whitespace-nowrap",children:last_modified_at&&(0,jsx_runtime.jsx)(TZLabel.w,{time:last_modified_at})})}}];return(0,jsx_runtime.jsxs)(SceneSection.S,{title:"Insights using event",className:"saved-insights",children:[(0,jsx_runtime.jsx)(src.DF,{type:"search",placeholder:"Search...",onChange:value=>setFilters({search:value}),value:filters.search||""}),(0,jsx_runtime.jsx)(LemonTable.g,{id:`event-definition-insights-table-${definition.id}`,loading:insightsLoading,columns:columns,"data-attr":"event-definition-insights-table",dataSource:insights.results,pagination:{controlled:!0,currentPage:null!=page?page:1,entryCount:insights.count,pageSize:10,onForward:insights.next?()=>{setPage(page+1)}:void 0,onBackward:insights.previous?()=>{setPage(page-1)}:void 0},sorting:sorting,onSort:newSorting=>setFilters({order:newSorting?`${-1===newSorting.order?"-":""}${newSorting.columnKey}`:void 0}),rowKey:"id",loadingSkeletonRows:10,nouns:["insight","insights"],useURLForSorting:!1,emptyState:"No insights found"})]})}var EventDefinitionProperties=__webpack_require__("../../frontend/src/scenes/data-management/events/EventDefinitionProperties.tsx"),LinkedHogFunctions=__webpack_require__("../../frontend/src/scenes/hog-functions/list/LinkedHogFunctions.tsx"),SceneContent=__webpack_require__("../../frontend/src/layout/scenes/components/SceneContent.tsx"),SceneDivider=__webpack_require__("../../frontend/src/layout/scenes/components/SceneDivider.tsx"),SceneTitleSection=__webpack_require__("../../frontend/src/layout/scenes/components/SceneTitleSection.tsx"),Query=__webpack_require__("../../frontend/src/queries/Query/Query.tsx"),DataTable_utils=__webpack_require__("../../frontend/src/queries/nodes/DataTable/utils.ts"),schema_general=__webpack_require__("../../frontend/src/queries/schema/schema-general.ts"),helpers=__webpack_require__("../../frontend/src/taxonomy/helpers.ts"),src_types=__webpack_require__("../../frontend/src/types.ts"),DefinitionHeader=__webpack_require__("../../frontend/src/scenes/data-management/events/DefinitionHeader.tsx");let scene={component:DefinitionView,logic:definitionLogic.k,paramsToProps:_ref=>{let{params:{id}}=_ref;return{id}}},getStatusProps=isProperty=>({verified:{tagType:"success",label:"Verified",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconBadge,{}),tooltip:`This ${isProperty?"property":"event"} is verified and can be used in filters and other selection components.`},hidden:{tagType:"danger",label:"Hidden",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconHide,{}),tooltip:`This ${isProperty?"property":"event"} is hidden and will not appear in filters and other selection components.`},visible:{tagType:"default",label:"Visible",icon:(0,jsx_runtime.jsx)(posthog_icons_es.IconEye,{}),tooltip:`This ${isProperty?"property":"event"} is visible and can be used in filters and other selection components.`}});function DefinitionView(props){var _definition$tags,_property_type;let logic=(0,definitionLogic.k)(props),{definition,definitionLoading,definitionMissing,hasTaxonomyFeatures,singular,isEvent,isProperty,metrics,metricsLoading}=(0,index_esm.useValues)(logic),{guardAvailableFeature}=(0,index_esm.useValues)(upgradeModalLogic.J),onGuardClick=callback=>{guardAvailableFeature(src_types.P$.INGESTION_TAXONOMY,()=>{callback()})},{deleteDefinition}=(0,index_esm.useActions)(logic),memoizedQuery=(0,react.useMemo)(()=>{let columnsToUse="default_columns"in definition&&definition.default_columns?.length?definition.default_columns:(0,DataTable_utils.Qi)(schema_general.OH.EventsQuery);return{kind:schema_general.OH.DataTableNode,source:{kind:schema_general.OH.EventsQuery,select:columnsToUse,event:definition.name},full:!0,showEventFilter:!1,showPersistentColumnConfigurator:!0,context:{type:"event_definition",eventDefinitionId:definition.id}}},[definition]);if(definitionLoading)return(0,jsx_runtime.jsx)(Spinner.t,{sceneLevel:!0});if(definitionMissing)return(0,jsx_runtime.jsx)(NotFound.T,{object:"event"});let definitionStatus=definition.verified?"verified":definition.hidden?"hidden":"visible",statusProps=getStatusProps(isProperty);return(0,jsx_runtime.jsxs)(SceneContent._,{children:[(0,jsx_runtime.jsx)(SceneTitleSection.s,{name:definition.name,resourceType:isEvent?{type:"event definition",forceIcon:(0,DefinitionHeader.Kw)(definition)}:{type:"property definition",forceIcon:(0,DefinitionHeader.Jf)(definition)},actions:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[isEvent&&(0,jsx_runtime.jsx)(LemonButton.J,{type:"secondary",to:urls.j.replay(src_types.yd.Home,{filter_group:{type:src_types.J2.And,values:[{type:src_types.J2.And,values:[{id:definition.name,type:"events",order:0,name:definition.name}]}]}}),sideIcon:(0,jsx_runtime.jsx)(icons.Ud,{}),"data-attr":"event-definition-view-recordings",size:"small",targetBlank:!0,children:"View recordings"}),(0,jsx_runtime.jsx)(LemonButton.J,{"data-attr":"delete-definition",type:"secondary",status:"danger",size:"small",onClick:()=>LemonDialog.LemonDialog.open({title:`Delete this ${singular} definition?`,description:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("p",{children:[(0,jsx_runtime.jsx)("strong",{children:(0,helpers.R6)(definition.name,isEvent?types.t.Events:types.t.EventProperties)})," ","will no longer appear in selectors. Associated data will remain in the database."]}),(0,jsx_runtime.jsxs)("p",{children:["This definition will be recreated if the $",singular," is ever seen again in the event stream."]})]}),primaryButton:{status:"danger",children:"Delete definition",onClick:()=>deleteDefinition()},secondaryButton:{children:"Cancel"},width:448}),tooltip:"Delete this definition. Associated data will remain.",children:"Delete"}),(0,jsx_runtime.jsx)(LemonButton.J,{"data-attr":"edit-definition",type:"secondary",size:"small",onClick:()=>{if(isProperty){lib.router.actions.push(urls.j.propertyDefinitionEdit(definition.id));return}return onGuardClick(()=>{lib.router.actions.push(urls.j.eventDefinitionEdit(definition.id))})},children:"Edit"})]}),forceBackTo:isEvent?{path:urls.j.eventDefinitions(),name:"Event definitions",key:"events"}:{path:urls.j.propertyDefinitions(),name:"Property definitions",key:"properties"}}),(0,jsx_runtime.jsx)(SceneDivider.V,{}),(0,jsx_runtime.jsxs)("div",{className:"deprecated-space-y-2",children:[definition.description||isProperty||hasTaxonomyFeatures?(0,jsx_runtime.jsx)(EditableField.f,{multiline:!0,name:"description",markdown:!0,value:definition.description||"",placeholder:"Description (optional)",mode:"view","data-attr":"definition-description-view",className:"definition-description",compactButtons:!0,maxLength:600}):null,(0,jsx_runtime.jsx)(ObjectTags.D,{tags:null!==(_definition$tags=definition.tags)&&void 0!==_definition$tags?_definition$tags:[],"data-attr":"definition-tags-view",className:"definition-tags",saving:definitionLoading}),(0,jsx_runtime.jsx)(UserActivityIndicator.F,{at:definition.updated_at,by:definition.updated_by}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-wrap gap-2 items-center text-secondary",children:[(0,jsx_runtime.jsxs)("div",{children:[isProperty?"Property":"Event"," name:"]}),(0,jsx_runtime.jsx)(src.oe,{className:"font-mono",children:definition.name})]})]}),(0,jsx_runtime.jsx)(SceneDivider.V,{}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-wrap",children:[isEvent&&definition.created_at&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,jsx_runtime.jsx)("h5",{children:"First seen"}),(0,jsx_runtime.jsx)("b",{children:(0,jsx_runtime.jsx)(TZLabel.w,{time:definition.created_at})})]}),isEvent&&definition.last_seen_at&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,jsx_runtime.jsx)("h5",{children:"Last seen"}),(0,jsx_runtime.jsx)("b",{children:(0,jsx_runtime.jsx)(TZLabel.w,{time:definition.last_seen_at})})]}),isEvent&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,jsx_runtime.jsxs)("h5",{children:["30 day queries"," ",(0,jsx_runtime.jsx)(src.u,{title:"Number of times this event has been queried in the last 30 days",children:(0,jsx_runtime.jsx)(posthog_icons_es.IconInfo,{})})]}),(0,jsx_runtime.jsx)("b",{children:metricsLoading?(0,jsx_runtime.jsx)(src.$j,{textColored:!0}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:metrics?.query_usage_30_day?metrics.query_usage_30_day.toLocaleString():"-"})})]}),definitionStatus&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,jsx_runtime.jsx)("h5",{children:"Verification status"}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(src.u,{title:statusProps[definitionStatus].tooltip,children:(0,jsx_runtime.jsxs)(src.oe,{type:statusProps[definitionStatus].tagType,children:[statusProps[definitionStatus].icon,statusProps[definitionStatus].label]})})})]}),isProperty&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,jsx_runtime.jsx)("h5",{children:"Property type"}),(0,jsx_runtime.jsx)("b",{children:null!==(_property_type=definition.property_type)&&void 0!==_property_type?_property_type:"-"})]})]}),(0,jsx_runtime.jsx)(SceneDivider.V,{}),isEvent&&"new"!==definition.id&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(EventDefinitionProperties.Q,{definition:definition}),(0,jsx_runtime.jsx)(SceneDivider.V,{}),(0,jsx_runtime.jsx)(EventDefinitionInsights,{definition:definition}),(0,jsx_runtime.jsx)(SceneDivider.V,{}),(0,jsx_runtime.jsx)(SceneSection.S,{title:"Connected destinations",description:"Get notified via Slack, webhooks or more whenever this event is captured.",children:(0,jsx_runtime.jsx)(LinkedHogFunctions.k,{type:"destination",forceFilterGroups:[{events:[{id:`${definition.name}`,type:"events"}]}]})}),(0,jsx_runtime.jsx)(SceneDivider.V,{}),(0,jsx_runtime.jsx)(SceneSection.S,{title:"Matching events",description:"This is the list of recent events that match this definition.",children:(0,jsx_runtime.jsx)(Query.A,{query:memoizedQuery})})]})]})}},"../../frontend/src/scenes/data-management/definition/definitionLogic.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{k:()=>definitionLogic});var kea__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/kea@3.1.7_react@18.2.0/node_modules/kea/lib/index.esm.js"),kea_loaders__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/kea-loaders@3.1.1_kea@3.1.7_react@18.2.0_/node_modules/kea-loaders/lib/index.js"),kea_router__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/kea-router@3.4.1_kea@3.1.7_react@18.2.0_/node_modules/kea-router/lib/index.js"),lib_api__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../frontend/src/lib/api.ts"),lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../frontend/src/lib/components/TaxonomicFilter/types.ts"),scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../frontend/src/scenes/sceneTypes.ts"),scenes_urls__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../frontend/src/scenes/urls.ts"),scenes_userLogic__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../frontend/src/scenes/userLogic.ts"),_models_propertyDefinitionsModel__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../frontend/src/models/propertyDefinitionsModel.ts"),_taxonomy_helpers__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../frontend/src/taxonomy/helpers.ts"),_types__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../frontend/src/types.ts"),_DataManagementScene__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../frontend/src/scenes/data-management/DataManagementScene.tsx"),_events_eventDefinitionsTableLogic__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("../../frontend/src/scenes/data-management/events/eventDefinitionsTableLogic.ts"),_properties_propertyDefinitionsTableLogic__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("../../frontend/src/scenes/data-management/properties/propertyDefinitionsTableLogic.ts");let createNewDefinition=isEvent=>({id:"new",name:`New ${isEvent?"Event":"Event property"}`,verified:!1,hidden:!1}),definitionLogic=(0,kea__WEBPACK_IMPORTED_MODULE_0__.kea)([(0,kea__WEBPACK_IMPORTED_MODULE_0__.path)(["scenes","data-management","definition","definitionViewLogic"]),(0,kea__WEBPACK_IMPORTED_MODULE_0__.props)({}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.key)(props=>props.id||"new"),(0,kea__WEBPACK_IMPORTED_MODULE_0__.actions)({setDefinition:function(definition){let options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{definition,options}},loadDefinition:id=>({id}),loadMetrics:id=>({id}),setDefinitionMissing:!0}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.connect)(()=>({values:[scenes_userLogic__WEBPACK_IMPORTED_MODULE_7__.userLogic,["hasAvailableFeature"]]})),(0,kea__WEBPACK_IMPORTED_MODULE_0__.reducers)(()=>({definitionMissing:[!1,{setDefinitionMissing:()=>!0}]})),(0,kea_loaders__WEBPACK_IMPORTED_MODULE_1__.loaders)(_ref=>{let{values,actions}=_ref;return{definition:[createNewDefinition(values.isEvent),{setDefinition:_ref2=>{let{definition,options:{merge}}=_ref2;return merge?{...values.definition,...definition}:definition},loadDefinition:async(_ref3,breakpoint)=>{let{id}=_ref3,definition={...values.definition};try{values.isEvent?definition=await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.eventDefinitions.get({eventDefinitionId:id}):(definition=await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.propertyDefinitions.get({propertyDefinitionId:id}),(0,_models_propertyDefinitionsModel__WEBPACK_IMPORTED_MODULE_8__.s8)({[`event/${definition.name}`]:definition})),breakpoint()}catch(response){throw actions.setDefinitionMissing(),response}return definition},deleteDefinition:async()=>(values.isEvent?await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.eventDefinitions.delete({eventDefinitionId:values.definition.id}):await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.propertyDefinitions.delete({propertyDefinitionId:values.definition.id}),kea_router__WEBPACK_IMPORTED_MODULE_2__.router.actions.push(values.isEvent?scenes_urls__WEBPACK_IMPORTED_MODULE_6__.j.eventDefinitions():scenes_urls__WEBPACK_IMPORTED_MODULE_6__.j.propertyDefinitions()),values.isEvent?_events_eventDefinitionsTableLogic__WEBPACK_IMPORTED_MODULE_12__.qh.findMounted()?.actions.loadEventDefinitions():_properties_propertyDefinitionsTableLogic__WEBPACK_IMPORTED_MODULE_13__.T.findMounted()?.actions.loadPropertyDefinitions(),values.definition)}],metrics:[null,{loadMetrics:async _ref4=>{let{id}=_ref4;return values.isEvent?await lib_api__WEBPACK_IMPORTED_MODULE_3__.ZP.eventDefinitions.getMetrics({eventDefinitionId:id}):null}}]}}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.selectors)({hasTaxonomyFeatures:[s=>[s.hasAvailableFeature],hasAvailableFeature=>hasAvailableFeature(_types__WEBPACK_IMPORTED_MODULE_10__.P$.INGESTION_TAXONOMY)],isEvent:[()=>[kea_router__WEBPACK_IMPORTED_MODULE_2__.router.selectors.location],_ref5=>{let{pathname}=_ref5;return pathname.includes(scenes_urls__WEBPACK_IMPORTED_MODULE_6__.j.eventDefinitions())}],isProperty:[s=>[s.isEvent],isEvent=>!isEvent],singular:[s=>[s.isEvent],isEvent=>isEvent?"event":"property"],breadcrumbs:[s=>[s.definition,s.isEvent],(definition,isEvent)=>[{key:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_5__.x.DataManagement,name:"Data management",path:isEvent?scenes_urls__WEBPACK_IMPORTED_MODULE_6__.j.eventDefinitions():scenes_urls__WEBPACK_IMPORTED_MODULE_6__.j.propertyDefinitions(),iconType:"event_definition"},{key:isEvent?_DataManagementScene__WEBPACK_IMPORTED_MODULE_11__.DataManagementTab.EventDefinitions:_DataManagementScene__WEBPACK_IMPORTED_MODULE_11__.DataManagementTab.PropertyDefinitions,name:isEvent?"Events":"Properties",path:isEvent?scenes_urls__WEBPACK_IMPORTED_MODULE_6__.j.eventDefinitions():scenes_urls__WEBPACK_IMPORTED_MODULE_6__.j.propertyDefinitions(),iconType:isEvent?"event_definition":"property_definition"},{key:[isEvent?scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_5__.x.EventDefinition:scenes_sceneTypes__WEBPACK_IMPORTED_MODULE_5__.x.PropertyDefinition,definition?.id||"new"],name:definition?.id!=="new"&&(0,_taxonomy_helpers__WEBPACK_IMPORTED_MODULE_9__.R6)(definition?.name,isEvent?lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_4__.t.Events:lib_components_TaxonomicFilter_types__WEBPACK_IMPORTED_MODULE_4__.t.EventProperties)||"Untitled",iconType:isEvent?"event_definition":"property_definition"}]]}),(0,kea__WEBPACK_IMPORTED_MODULE_0__.afterMount)(_ref6=>{let{actions,values,props}=_ref6;props.id&&"new"!==props.id?(actions.loadDefinition(props.id),actions.loadMetrics(props.id)):actions.setDefinition(createNewDefinition(values.isEvent))})])}}]);