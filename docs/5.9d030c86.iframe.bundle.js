(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"./frontend/src/lib/components/ExportButton/ExportButton.tsx":function(K,O,t){"use strict";t.d(O,"a",function(){return de});var U=t("./node_modules/@babel/runtime/helpers/extends.js"),xe=t.n(U),A=t("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),e=t.n(A),m=t("./node_modules/core-js/modules/es.array.map.js"),j=t("./node_modules/core-js/modules/es.regexp.exec.js"),je=t("./node_modules/core-js/modules/es.string.split.js"),Q=t("./node_modules/react/index.js"),N=t.n(Q),Ie=t("./frontend/src/lib/components/LemonButton/index.ts"),L=t("./node_modules/kea/lib/index.esm.js"),me=t("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),he=t.n(me),ne=t("./node_modules/@babel/runtime/regenerator/index.js"),H=t.n(ne),Re=t("./node_modules/core-js/modules/es.array.concat.js"),re=t("./node_modules/core-js/modules/es.array.iterator.js"),Z=t("./node_modules/core-js/modules/es.object.to-string.js"),o=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),I=t("./frontend/src/lib/api.ts"),M=t("./frontend/src/lib/utils.tsx"),k=t("./node_modules/posthog-js/dist/es.js"),G=t("./frontend/src/scenes/teamLogic.tsx"),Y=t("./frontend/src/lib/components/lemonToast.tsx"),oe=1e3,q=10,w;(function(l){l.PNG="image/png",l.CSV="text/csv",l.PDF="application/pdf"})(w||(w={}));var pe=Object(L.kea)([Object(L.path)(["lib","components","ExportButton","ExporterLogic"]),Object(L.props)({}),Object(L.key)(function(l){var T=l.dashboardId,R=l.insightId;return"dash:".concat(T,"::insight:").concat(R)}),Object(L.actions)({exportItem:function(T,R){return{exportFormat:T,successCallback:R}},exportItemSuccess:!0,exportItemFailure:!0}),Object(L.reducers)({exportInProgress:[!1,{exportItem:function(){return!0},exportItemSuccess:function(){return!1},exportItemFailure:function(){return!1}}]}),Object(L.listeners)(function(l){var T=l.actions,R=l.props;return{exportItem:function(){var _=he()(H.a.mark(function C(y){var J,S,f,X,B,le,F;return H.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return J=y.exportFormat,S=y.successCallback,Y.d.info("Export started..."),f={export_format:J,dashboard:R.dashboardId,insight:R.insightId,total_time_ms:0},X=performance.now(),c.prev=4,c.next=7,I.b.create("api/projects/".concat(G.a.values.currentTeamId,"/exports"),{export_format:J,dashboard:R.dashboardId,insight:R.insightId});case 7:if(B=c.sent,B.id){c.next=10;break}throw new Error("Missing export_id from response");case 10:le=I.b.exports.determineExportUrl(B.id),F=0;case 12:if(!(F<q)){c.next=29;break}if(F++,!B.has_content){c.next=22;break}return T.exportItemSuccess(),Y.d.success("Export complete."),S==null||S(),window.open(le,"_blank"),f.total_time_ms=performance.now()-X,k.a.capture("export succeeded",f),c.abrupt("return");case 22:return c.next=24,Object(M.w)(oe);case 24:return c.next=26,I.b.get("api/projects/".concat(G.a.values.currentTeamId,"/exports/").concat(B.id));case 26:B=c.sent,c.next=12;break;case 29:throw new Error("Content not loaded in time...");case 32:c.prev=32,c.t0=c.catch(4),T.exportItemFailure(),f.total_time_ms=performance.now()-X,k.a.capture("export failed",f),Y.d.error("Export failed: ".concat(JSON.stringify(c.t0)));case 38:case"end":return c.stop()}},C,null,[[4,32]])}));function $(C){return _.apply(this,arguments)}return $}()}})]),fe=t("./frontend/src/lib/components/LemonDivider/index.ts"),Ne=t("./frontend/src/scenes/insights/insightLogic.ts"),we=["dashboardId","insightShortId"];function de(l){var T=l.dashboardId,R=l.insightShortId,_=e()(l,we),$={dashboardItemId:R,doNotLoad:!0},C=Object(L.useValues)(Object(Ne.c)($)),y=C.supportsCsvExport,J=C.csvExportUrl,S=C.insight,f=Object(L.useActions)(pe({dashboardId:T,insightId:S==null?void 0:S.id})),X=f.exportItem,B=Object(L.useValues)(pe({dashboardId:T,insightId:S==null?void 0:S.id})),le=B.exportInProgress,F=[];(T||R)&&F.push(w.PNG),y&&F.push(w.CSV);var ee=function(ve){if(ve===w.CSV){window.open(J,"_blank");return}X(ve)};return N.a.createElement(Ie.b,xe()({type:"stealth",loading:le,"data-attr":"export-button"},_,{popup:{actionable:!0,placement:"right-start",overlay:N.a.createElement(N.a.Fragment,null,N.a.createElement("h5",null,"File type"),N.a.createElement(fe.a,null),F.map(function(c){return N.a.createElement(Ie.a,{key:c,fullWidth:!0,type:"stealth",onClick:function(){return ee(c)},"data-attr":"export-button-".concat(c.split("/").pop())},".",c.split("/").pop())}))}}),"Export")}try{de.displayName="ExportButton",de.__docgenInfo={description:"",displayName:"ExportButton",props:{dashboardId:{defaultValue:null,description:"",name:"dashboardId",required:!1,type:{name:"number"}},insightShortId:{defaultValue:null,description:"",name:"insightShortId",required:!1,type:{name:"InsightShortId"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"alt"'},{value:'"highlighted"'},{value:'"primary"'},{value:'"secondary"'},{value:'"tertiary"'},{value:'"stealth"'}]}},icon:{defaultValue:null,description:"",name:"icon",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>> | null"}},fullWidth:{defaultValue:null,description:"Whether the row should take up the parent's full width.",name:"fullWidth",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/ExportButton/ExportButton.tsx#ExportButton"]={docgenInfo:de.__docgenInfo,name:"ExportButton",path:"frontend/src/lib/components/ExportButton/ExportButton.tsx#ExportButton"})}catch(l){}},"./frontend/src/lib/hooks/useKeyboardHotkeys.tsx":function(K,O,t){"use strict";t.d(O,"a",function(){return Re});var U=t("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),xe=t.n(U),A=t("./node_modules/core-js/modules/es.array.includes.js"),e=t.n(A),m=t("./node_modules/core-js/modules/es.string.includes.js"),j=t.n(m),je=t("./node_modules/core-js/modules/es.object.to-string.js"),Q=t.n(je),N=t("./node_modules/core-js/modules/es.object.keys.js"),Ie=t.n(N),L=t("./node_modules/core-js/modules/es.array.concat.js"),me=t.n(L),he=t("./frontend/src/lib/hooks/useEventListener.ts"),ne=function(Z,o){var I=Z.composedPath()||Z.path;if(!I)return!1;var M=I[0],k=M.tagName||"not an html element";return o.includes(k.toLowerCase())},H=[".hotkey-block",".hotkey-block *"];function Re(re,Z){var o=["input","textarea"];Object(he.a)("keydown",function(I){var M=I.key;if(!(I.metaKey||I.ctrlKey||I.altKey)&&!H.some(function(w){return I.target.matches(w)})){var k=o.includes(I.target.tagName.toLowerCase());if(!(M!=="Escape"&&(k||ne(I,o))))for(var G=0,Y=Object.keys(re);G<Y.length;G++){var oe=Y[G],q=re[oe];if(!(!q||q.disabled)&&M.toLowerCase()===oe){I.preventDefault(),q.action();break}}}},void 0,[re].concat(xe()(Z||[])))}},"./frontend/src/scenes/dashboard/Dashboard.tsx":function(K,O,t){"use strict";t.r(O),t.d(O,"scene",function(){return Et}),t.d(O,"Dashboard",function(){return Ce});var U=t("./node_modules/core-js/modules/es.array.includes.js"),xe=t("./node_modules/core-js/modules/es.string.includes.js"),A=t("./node_modules/react/index.js"),e=t.n(A),m=t("./node_modules/kea/lib/index.esm.js"),j=t("./frontend/src/scenes/dashboard/dashboardLogic.ts"),je=t("./node_modules/@babel/runtime/helpers/slicedToArray.js"),Q=t.n(je),N=t("./node_modules/core-js/modules/es.array.map.js"),Ie=t("./node_modules/core-js/modules/es.function.name.js"),L=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),me=t.n(L),he=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/DashboardItems.scss"),ne=t.n(he),H={};H.insert="head",H.singleton=!1;var Re=me()(ne.a,H),re=ne.a.locals||{},Z=t("./node_modules/react-grid-layout/index.js"),o=t("./frontend/src/types.ts"),I=t("./frontend/src/models/insightsModel.tsx"),M=t("./node_modules/clsx/dist/clsx.m.js"),k=t("./frontend/src/lib/components/InsightCard/index.tsx"),G=t("./frontend/src/lib/hooks/useResizeObserver.ts");function Y(){var s=Object(m.useValues)(j.c),a=s.dashboard,n=s.items,d=s.layouts,r=s.dashboardMode,v=s.placement,b=s.isRefreshing,g=s.highlightedInsightId,E=s.refreshStatus,x=Object(m.useActions)(j.c),z=x.updateLayouts,D=x.updateContainerWidth,u=x.updateItemColor,P=x.removeItem,te=x.refreshAllDashboardItems,V=Object(m.useActions)(I.a),ie=V.duplicateInsight,be=V.renameInsight,ae=V.moveToDashboard,ce=Object(A.useState)(null),Se=Q()(ce,2),ge=Se[0],Le=Se[1],Ee=Object(A.useRef)(!1),se=Object(A.useRef)(null),ye=Object(M.a)({"dashboard-view-mode":r!==o.k.Edit,"dashboard-edit-mode":r===o.k.Edit}),Ae=Object(G.b)(),ue=Ae.width,Be=Ae.ref,Te=!ue||ue>j.a.sm;return e.a.createElement("div",{className:"dashboard-items-wrapper",ref:Be},e.a.createElement(Z.Responsive,{width:ue||0,className:ye,isDraggable:r===o.k.Edit,isResizable:r===o.k.Edit,layouts:d,rowHeight:80,margin:[16,16],containerPadding:[0,0],onLayoutChange:function(W,i){r===o.k.Edit&&z(i)},onWidthChange:function(W,i,h){D(W,h)},breakpoints:j.a,resizeHandles:Te?["s","e","se"]:["s"],cols:j.b,onResize:function(W,i,h){(!ge||ge.w!==h.w||ge.h!==h.h)&&Le(h)},onResizeStop:function(){Le(null)},onDrag:function(){Ee.current=!0,se.current&&window.clearTimeout(se.current)},onDragStop:function(){se.current&&window.clearTimeout(se.current),se.current=window.setTimeout(function(){Ee.current=!1},250)},draggableCancel:".anticon,.ant-dropdown,table,.ant-popover-content,button,.Popup"},n==null?void 0:n.map(function(p){var W;return e.a.createElement(k.a,{key:p.short_id,insight:p,dashboardId:a==null?void 0:a.id,loading:b(p.short_id),apiErrored:((W=E[p.short_id])===null||W===void 0?void 0:W.error)||!1,highlighted:g&&p.short_id===g,showResizeHandles:r===o.k.Edit,canResizeWidth:Te,updateColor:function(h){return u(p.id,h)},removeFromDashboard:function(){return P(p)},refresh:function(){return te([p])},rename:function(){return be(p)},duplicate:function(){return ie(p)},moveToDashboardOld:function(h){return ie(p,h,!0)},moveToDashboard:function(h){var Fe=h.id,yt=h.name;if(!a)throw new Error("must be on a dashboard to move an insight");ae(p,a.id,Fe,yt)},showEditingControls:[o.l.Dashboard,o.l.ProjectHomepage].includes(v),showDetailsControls:v!=o.l.Export})})))}var oe=t("./frontend/src/lib/components/DateFilter/DateFilter.tsx"),q=t("./node_modules/@ant-design/icons/es/icons/CalendarOutlined.js"),w=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/Dashboard.scss"),pe=t.n(w),fe={};fe.insert="head",fe.singleton=!1;var Ne=me()(pe.a,fe),we=pe.a.locals||{},de=t("./frontend/src/lib/hooks/useKeyboardHotkeys.tsx"),l=t("./frontend/src/lib/utils/eventUsageLogic.ts"),T=t("./frontend/src/lib/components/TimezoneAware/index.tsx"),R=t("./node_modules/core-js/modules/es.array.fill.js"),_=t("./node_modules/antd/es/card/index.js"),$=t("./node_modules/antd/es/row/index.js"),C=t("./node_modules/antd/es/col/index.js"),y=t("./node_modules/antd/es/skeleton/index.js"),J=t("./frontend/src/lib/components/Link.tsx"),S=t("./frontend/src/scenes/urls.ts"),f=t("./frontend/src/lib/components/LemonButton/index.ts");function X(s){var a=s.active;return e.a.createElement(_.a,{className:"hide-lte-lg"},e.a.createElement($.a,null,e.a.createElement(C.a,{span:12},e.a.createElement(y.a,{paragraph:{rows:1},active:a}),e.a.createElement("div",{className:"mt"},e.a.createElement("div",{className:"mt"},e.a.createElement(y.a.Button,{active:a}),e.a.createElement(y.a.Button,{active:a,style:{marginLeft:4,width:140}})),e.a.createElement("div",{className:"mt"},e.a.createElement(y.a.Button,{active:a}),e.a.createElement(y.a.Button,{active:a,style:{marginLeft:4,width:140}})),e.a.createElement("div",{className:"mt"},e.a.createElement(y.a.Button,{active:a}),e.a.createElement(y.a.Button,{active:a,style:{marginLeft:4,width:140}})))),e.a.createElement(C.a,{span:12},e.a.createElement("div",{className:"skeleton-actions"},e.a.createElement(y.a.Avatar,{active:a,shape:"circle",size:"small"}),e.a.createElement(y.a.Avatar,{active:a,shape:"circle",size:"small"})),e.a.createElement(y.a.Avatar,{active:a,shape:"circle",size:"large",className:"pie-chart"}))))}function B(){return e.a.createElement("div",{className:"bar-chart ant-skeleton-content"},Array(8).fill(0).map(function(s,a){var n=200,d=40,r=Math.floor(Math.random()*(n-d+1))+d;return e.a.createElement("div",{className:"bar-el ant-skeleton-title",key:a,style:{height:r}})}))}var le=e.a.memo(B);function F(s){var a=s.active;return e.a.createElement(_.a,{className:Object(M.a)("ant-skeleton",a&&"ant-skeleton-active")},e.a.createElement($.a,null,e.a.createElement(C.a,{span:12},e.a.createElement(y.a,{active:a,paragraph:{rows:1}})),e.a.createElement(C.a,{span:12},e.a.createElement("div",{className:"skeleton-actions"},e.a.createElement(y.a.Avatar,{active:a,shape:"circle",size:"small"}),e.a.createElement(y.a.Avatar,{active:a,shape:"circle",size:"small"})))),e.a.createElement(le,null))}function ee(s){var a=s.loading,n=Object(m.useValues)(j.c),d=n.dashboard;return e.a.createElement("div",{className:"empty-state"},!a&&e.a.createElement("div",{className:"cta"},e.a.createElement(_.a,{className:"card-elevated"},e.a.createElement("h3",{className:"l3"},"Dashboard empty"),e.a.createElement("p",null,"This dashboard sure would look better with some graphs!"),e.a.createElement("div",{className:"mt text-center"},e.a.createElement(J.a,{to:S.a.insightNew(void 0,d==null?void 0:d.id)},e.a.createElement(f.a,{"data-attr":"dashboard-add-graph-header"},"Add insight"))))),e.a.createElement($.a,{gutter:16},e.a.createElement(C.a,{span:24,lg:12},e.a.createElement(X,{active:a})),e.a.createElement(C.a,{span:24,lg:12},e.a.createElement(F,{active:a}))),e.a.createElement($.a,{gutter:16,className:"fade-out-graphs"},e.a.createElement(C.a,{span:24,lg:12},e.a.createElement(X,{active:a})),e.a.createElement(C.a,{span:24,lg:12},e.a.createElement(F,{active:a}))))}try{ee.displayName="EmptyDashboardComponent",ee.__docgenInfo={description:"",displayName:"EmptyDashboardComponent",props:{loading:{defaultValue:null,description:"",name:"loading",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/EmptyDashboardComponent.tsx#EmptyDashboardComponent"]={docgenInfo:ee.__docgenInfo,name:"EmptyDashboardComponent",path:"frontend/src/scenes/dashboard/EmptyDashboardComponent.tsx#EmptyDashboardComponent"})}catch(s){}var c=t("./frontend/src/lib/components/NotFound/index.tsx"),ve=t("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),Je=t.n(ve),xt=t("./node_modules/core-js/modules/es.array.from.js"),jt=t("./node_modules/core-js/modules/es.string.iterator.js"),Xe=t("./node_modules/antd/es/dropdown/index.js"),Pe=t("./node_modules/antd/es/menu/index.js"),Qe=t("./node_modules/antd/es/checkbox/index.js"),ze=t("./node_modules/antd/es/radio/index.js"),Ze=t("./node_modules/antd/es/space/index.js"),qe=t("./node_modules/@ant-design/icons/es/icons/DownOutlined.js"),_e=t("./node_modules/@ant-design/icons/es/icons/LoadingOutlined.js"),et=t("./node_modules/@ant-design/icons/es/icons/ReloadOutlined.js"),Ve=t("./frontend/src/lib/utils.tsx"),tt=t("./frontend/src/lib/components/Tooltip.tsx"),at=t("./frontend/src/lib/dayjs.ts"),We=function(){var a=Object(m.useValues)(j.c),n=a.lastRefreshed;return e.a.createElement("span",null,"Last updated ",e.a.createElement("b",null,n?Object(at.a)(n).fromNow():"a while ago"))},st=Je()(Array.from([60,120,300,900],function(s){return{label:Object(Ve.N)(s),value:s}}));function nt(){var s=Object(m.useValues)(j.c),a=s.itemsLoading,n=s.autoRefresh,d=s.refreshMetrics,r=Object(m.useActions)(j.c),v=r.refreshAllDashboardItemsManual,b=r.setAutoRefresh,g=Object(A.useState)(!1),E=Q()(g,2),x=E[0],z=E[1];return e.a.createElement(e.a.Fragment,null,e.a.createElement(Xe.a.Button,{overlay:e.a.createElement(Pe.a,{"data-attr":"auto-refresh-picker",id:"auto-refresh-picker"},e.a.createElement("div",{id:"auto-refresh-check",key:"auto-refresh-check",onClick:function(u){u.stopPropagation(),z(!0),b(!n.enabled,n.interval)}},e.a.createElement(tt.a,{title:"Refresh dashboard automatically",placement:"bottomLeft"},e.a.createElement(Qe.a,{onChange:function(u){u.stopPropagation(),u.preventDefault()},checked:n.enabled}),e.a.createElement("label",{style:{marginLeft:10,cursor:"pointer"}},"Auto refresh"))),e.a.createElement(Pe.a.Divider,null),e.a.createElement(Pe.a.ItemGroup,{title:"Refresh interval"},e.a.createElement(ze.a.Group,{onChange:function(u){b(!0,parseInt(u.target.value))},value:n.interval,style:{width:"100%"}},e.a.createElement(Ze.b,{direction:"vertical",style:{width:"100%"}},st.map(function(D){var u=D.label,P=D.value;return e.a.createElement(ze.a,{key:P,value:P,style:{width:"100%"}},u)}))))),trigger:["click"],onClick:function(){return v()},icon:e.a.createElement(qe.a,null),disabled:a,buttonsRender:function(u){var P=Q()(u,2),te=P[0],V=P[1];return[e.a.cloneElement(te,{style:{paddingLeft:10}}),V]},visible:x,onVisibleChange:function(u){return z(u)}},e.a.createElement("span",{className:"dashboard-items-action-icon"},a?e.a.createElement(_e.a,null):e.a.createElement(et.a,null)),e.a.createElement("span",{className:Object(M.a)("dashboard-items-action-refresh-text",{hidden:a})},e.a.createElement(We,null)),e.a.createElement("span",{className:Object(M.a)("dashboard-items-action-refresh-text","completed",{hidden:!a})},"Refreshed ",d.completed," out of ",d.total)))}var rt=t("./frontend/src/scenes/insights/EmptyStates/index.ts"),It=t("./node_modules/core-js/modules/es.symbol.js"),Dt=t("./node_modules/core-js/modules/es.symbol.description.js"),Ot=t("./node_modules/core-js/modules/es.array.filter.js"),Ct=t("./node_modules/core-js/modules/es.object.to-string.js"),St=t("./node_modules/core-js/modules/es.array.concat.js"),Lt=t("./node_modules/core-js/modules/es.array.join.js"),Ke=t("./frontend/src/lib/components/EditableField/EditableField.tsx");function De(s){var a=s.onExit,n="aside.ant-layout-sider, .layout-top-content";return Object(A.useEffect)(function(){for(var d=window.document.querySelectorAll(n),r=0;r<d.length;r++)d[r].style.display="none";var v=function(){window.document.fullscreenElement===null&&(a==null||a())};try{window.document.body.requestFullscreen().then(function(){window.addEventListener("fullscreenchange",v,!1)})}catch(b){}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch(b){}return function(){for(var b=window.document.querySelectorAll(n),g=0;g<b.length;g++)b[g].style.display="block";try{window.removeEventListener("fullscreenchange",v,!1),window.document.fullscreenElement!==null&&window.document.exitFullscreen()}catch(E){}try{window.dispatchEvent(new window.Event("scroll")),window.dispatchEvent(new window.Event("resize"))}catch(E){}}},[]),null}try{De.displayName="FullScreen",De.__docgenInfo={description:"",displayName:"FullScreen",props:{onExit:{defaultValue:null,description:"",name:"onExit",required:!1,type:{name:"(() => any)"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/FullScreen.tsx#FullScreen"]={docgenInfo:De.__docgenInfo,name:"FullScreen",path:"frontend/src/lib/components/FullScreen.tsx#FullScreen"})}catch(s){}var ot=t("./frontend/src/lib/components/LemonButton/More.tsx"),dt=t("./frontend/src/lib/components/LemonRow/index.ts"),Me=t("./frontend/src/lib/components/LemonDivider/index.ts"),Ue=t("./frontend/src/lib/components/ObjectTags/ObjectTags.tsx"),lt=t("./frontend/src/lib/components/PageHeader.tsx"),He=t("./frontend/src/models/dashboardsModel.tsx"),it=t("./frontend/src/scenes/dashboard/dashboardsLogic.ts"),ke=t("./frontend/src/scenes/dashboard/ShareModal.tsx"),ct=t("./frontend/src/scenes/userLogic.ts"),Oe=t("./frontend/src/lib/constants.tsx"),ut=t("./frontend/src/lib/components/ProfilePicture/ProfileBubbles.tsx"),mt=t("./frontend/src/scenes/dashboard/dashboardCollaboratorsLogic.ts"),ht=t("./frontend/src/lib/components/icons.tsx"),Ge=t("./frontend/src/lib/logic/featureFlagLogic.ts"),pt=t("./frontend/src/lib/components/ExportButton/ExportButton.tsx"),Ye=t("./frontend/src/lib/components/Subscriptions/SubscriptionsModal.tsx"),ft=t("./node_modules/kea-router/lib/index.js");function vt(){var s=Object(m.useValues)(j.c),a=s.dashboard,n=s.allItemsLoading,d=s.dashboardMode,r=s.canEditDashboard,v=s.showSubscriptions,b=s.subscriptionId,g=Object(m.useActions)(j.c),E=g.setDashboardMode,x=g.triggerDashboardUpdate,z=Object(m.useValues)(it.b),D=z.dashboardTags,u=Object(m.useActions)(He.a),P=u.updateDashboard,te=u.pinDashboard,V=u.unpinDashboard,ie=u.deleteDashboard,be=u.duplicateDashboard,ae=Object(m.useValues)(He.a),ce=ae.dashboardLoading,Se=Object(m.useValues)(ct.a),ge=Se.hasAvailableFeature,Le=Object(A.useState)(!1),Ee=Q()(Le,2),se=Ee[0],ye=Ee[1],Ae=Object(m.useValues)(Ge.a),ue=Ae.featureFlags,Be=ue[Oe.h.EXPORT_DASHBOARD_INSIGHTS],Te=ue[Oe.h.INSIGHT_SUBSCRIPTIONS],p=Object(m.useActions)(ft.router),W=p.push;return a||n?e.a.createElement(e.a.Fragment,null,d===o.k.Fullscreen&&e.a.createElement(De,{onExit:function(){return E(null,l.a.Browser)}}),a&&e.a.createElement(ke.b,{onCancel:function(){return ye(!1)},visible:se}),a&&e.a.createElement(Ye.b,{visible:v,closeModal:function(){return W(S.a.dashboard(a.id))},dashboardId:a.id,subscriptionId:b}),e.a.createElement(lt.a,{title:e.a.createElement("div",{style:{display:"flex",alignItems:"center"}},e.a.createElement(Ke.a,{name:"name",value:(a==null?void 0:a.name)||(n?"Loading\u2026":""),placeholder:"Name this dashboard",onSave:a?function(i){return P({id:a.id,name:i})}:void 0,minLength:1,maxLength:400,mode:r?void 0:"view",notice:a&&!r?{icon:e.a.createElement(ht.IconLock,null),tooltip:"You don't have edit permissions in this dashboard. Ask a dashboard collaborator with edit access to add you."}:void 0})),buttons:d===o.k.Edit?e.a.createElement(f.a,{"data-attr":"dashboard-edit-mode-save",type:"primary",onClick:function(){return E(null,l.a.DashboardHeader)},tabIndex:10,disabled:n},"Done editing"):d===o.k.Fullscreen?e.a.createElement(f.a,{type:"secondary",onClick:function(){return E(null,l.a.DashboardHeader)},"data-attr":"dashboard-exit-presentation-mode",disabled:n},"Exit full screen"):e.a.createElement(e.a.Fragment,null,e.a.createElement(ot.a,{overlay:a?e.a.createElement(e.a.Fragment,null,a.created_by&&e.a.createElement(e.a.Fragment,null,e.a.createElement(dt.a,{fullWidth:!0,style:{color:"var(--muted-alt)"}},"Created by"," ",a.created_by.first_name||a.created_by.email||"-"," ","on ",Object(Ve.M)(a.created_at)),e.a.createElement(Me.a,null)),r&&e.a.createElement(f.a,{onClick:function(){return E(o.k.Edit,l.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Edit layout (E)"),e.a.createElement(f.a,{onClick:function(){return E(o.k.Fullscreen,l.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Go full screen (F)"),r&&(a.pinned?e.a.createElement(f.a,{onClick:function(){return V(a.id,l.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Unpin dashboard"):e.a.createElement(f.a,{onClick:function(){return te(a.id,l.a.MoreDropdown)},type:"stealth",fullWidth:!0},"Pin dashboard")),Te&&e.a.createElement(Ye.a,{dashboardId:a.id}),Be&&e.a.createElement(pt.a,{dashboardId:a.id,fullWidth:!0,type:"stealth"}),e.a.createElement(Me.a,null),e.a.createElement(f.a,{onClick:function(){return be({id:a.id,name:a.name,show:!0})},type:"stealth",fullWidth:!0},"Duplicate dashboard"),r&&e.a.createElement(f.a,{onClick:function(){return ie({id:a.id,redirect:!0})},status:"danger",type:"stealth",fullWidth:!0},"Delete dashboard")):void 0}),e.a.createElement(Me.a,{vertical:!0}),a&&e.a.createElement(bt,{dashboard:a,onClick:function(){return ye(function(h){return!h})}}),e.a.createElement(f.a,{type:"secondary","data-attr":"dashboard-share-button",onClick:function(){return ye(function(h){return!h})}},"Share"),r&&e.a.createElement(J.a,{to:S.a.insightNew(void 0,a==null?void 0:a.id)},e.a.createElement(f.a,{type:"primary","data-attr":"dashboard-add-graph-header"},"Add insight"))),caption:e.a.createElement(e.a.Fragment,null,a&&!!(r||a.description)&&e.a.createElement(Ke.a,{multiline:!0,name:"description",value:a.description||"",placeholder:"Description (optional)",onSave:function(h){return P({id:a.id,description:h})},compactButtons:!0,mode:r?void 0:"view",paywall:!ge(o.d.DASHBOARD_COLLABORATION)}),(a==null?void 0:a.tags)&&e.a.createElement(e.a.Fragment,null,r?e.a.createElement(Ue.a,{tags:a.tags,onChange:function(h,Fe){return x({tags:Fe})},saving:ce,tagsAvailable:D.filter(function(i){var h;return!((h=a.tags)!==null&&h!==void 0&&h.includes(i))}),className:"insight-metadata-tags"}):a.tags.length?e.a.createElement(Ue.a,{tags:a.tags,saving:ce,staticOnly:!0,className:"insight-metadata-tags"}):null)),delimited:!0})):null}function bt(s){var a=s.dashboard,n=s.onClick,d=Object(m.useValues)(Object(mt.a)({dashboardId:a.id})),r=d.allCollaborators;if(!a)return null;var v=ke.a[a.effective_restriction_level],b=[];return v!=null&&v.label&&b.push(v.label),a.is_shared&&b.push("Shared publicly"),e.a.createElement(ut.a,{people:r.map(function(g){return{email:g.user.email,name:g.user.first_name,title:"".concat(g.user.first_name," (").concat(Oe.C[g.level],")")}}),tooltip:b.join(" \u2022 "),onClick:n})}var gt=t("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),Et={component:$e,logic:j.c,paramsToProps:function(a){var n=a.params,d=n.id,r=n.shareToken,v=n.placement;return{id:d?parseInt(d):void 0,shareToken:r,placement:v}}};function Ce(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=s.id,n=s.shareToken,d=s.placement;return e.a.createElement(m.BindLogic,{logic:j.c,props:{id:a?parseInt(a):void 0,shareToken:n,placement:d}},e.a.createElement($e,null))}function $e(){var s,a,n=Object(m.useValues)(j.c),d=n.placement,r=n.dashboard,v=n.canEditDashboard,b=n.items,g=n.itemsLoading,E=n.filters,x=n.dashboardMode,z=n.receivedErrorsFromAPI,D=Object(m.useActions)(j.c),u=D.setDashboardMode,P=D.setDates,te=D.reportDashboardViewed,V=D.setProperties,ie=Object(m.useValues)(Ge.a),be=ie.featureFlags;return Object(A.useEffect)(function(){te()},[]),Object(de.a)([o.l.Public,o.l.InternalMetrics].includes(d)?{}:{e:{action:function(){return u(x===o.k.Edit?null:o.k.Edit,l.a.Hotkey)},disabled:!v||x!==null&&x!==o.k.Edit},f:{action:function(){return u(x===o.k.Fullscreen?null:o.k.Fullscreen,l.a.Hotkey)},disabled:x!==null&&x!==o.k.Fullscreen},escape:{action:function(){return u(null,l.a.Hotkey)},disabled:x!==o.k.Edit}},[u,x]),!r&&!g&&z?e.a.createElement(c.a,{object:"dashboard"}):e.a.createElement("div",{className:"dashboard"},![o.l.ProjectHomepage,o.l.Public,o.l.Export,o.l.InternalMetrics].includes(d)&&e.a.createElement(vt,null),z?e.a.createElement(rt.d,{title:"There was an error loading this dashboard"}):!b||b.length===0?e.a.createElement(ee,{loading:g}):e.a.createElement("div",null,![o.l.Public,o.l.Export].includes(d)&&e.a.createElement("div",{className:"flex pb border-bottom space-x"},e.a.createElement("div",{className:"flex-grow flex",style:{height:30}},e.a.createElement(T.a,{style:{marginRight:8,fontWeight:"bold",lineHeight:"30px"}}),e.a.createElement(oe.a,{defaultValue:"Custom",showCustom:!0,dateFrom:(s=E==null?void 0:E.date_from)!==null&&s!==void 0?s:void 0,dateTo:(a=E==null?void 0:E.date_to)!==null&&a!==void 0?a:void 0,onChange:P,disabled:!v,makeLabel:function(ce){return e.a.createElement(e.a.Fragment,null,e.a.createElement(q.a,null),e.a.createElement("span",{className:"hide-when-small"}," ",ce))}})),(be[Oe.h.PROPERTY_FILTER_ON_DASHBOARD]||(r==null?void 0:r.filters.properties))&&e.a.createElement(gt.a,{onChange:V,pageKey:"dashboard_"+(r==null?void 0:r.id),propertyFilters:r==null?void 0:r.filters.properties,useLemonButton:!0})),d!==o.l.Export&&e.a.createElement("div",{className:"flex pt pb space-x dashoard-items-actions"},e.a.createElement("div",{className:"left-item",style:d===o.l.Public?{textAlign:"right"}:void 0},d===o.l.Public?e.a.createElement(We,null):e.a.createElement(nt,null))),e.a.createElement(Y,null)))}try{Ce.displayName="Dashboard",Ce.__docgenInfo={description:"",displayName:"Dashboard",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},shareToken:{defaultValue:null,description:"",name:"shareToken",required:!1,type:{name:"string"}},placement:{defaultValue:null,description:"",name:"placement",required:!1,type:{name:"enum",value:[{value:'"dashboard"'},{value:'"internal-metrics"'},{value:'"project-homepage"'},{value:'"public"'},{value:'"export"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/dashboard/Dashboard.tsx#Dashboard"]={docgenInfo:Ce.__docgenInfo,name:"Dashboard",path:"frontend/src/scenes/dashboard/Dashboard.tsx#Dashboard"})}catch(s){}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/Dashboard.scss":function(K,O,t){var U=t("./node_modules/css-loader/dist/runtime/api.js");O=U(!1),O.push([K.i,'.dashboard .empty-state .fade-out-graphs:after{content:"";width:100%;height:3rem;background:linear-gradient(0deg,#fff,transparent);position:absolute;pointer-events:none;bottom:0}.dashboard-header .dashboard-select{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - 8px)}.dashboard{margin-top:1rem}.dashboard .dashboard-items-action-icon{margin-right:6px}.dashboard .dashboard-items-action-refresh-text{visibility:visible}.dashboard .dashboard-items-action-refresh-text.hidden{visibility:hidden}.dashboard .dashboard-items-action-refresh-text.completed{position:absolute;left:30px}.dashboard .empty-state{position:relative}.dashboard .empty-state .skeleton-actions{text-align:right}.dashboard .empty-state .skeleton-actions .ant-skeleton-avatar{margin-right:8px}.dashboard .empty-state .pie-chart{height:200px;width:200px;max-width:100%;margin-top:1rem}@media(max-width:992px){.dashboard .empty-state .pie-chart{height:140px;width:140px}}.dashboard .empty-state .bar-chart{display:flex;margin-top:1rem;align-items:flex-end}.dashboard .empty-state .bar-chart .bar-el{width:12.5%;margin-left:4px;height:100px}.dashboard .empty-state .ant-col{flex-grow:1}.dashboard .empty-state .ant-col .ant-card{height:100%}.dashboard .empty-state .fade-out-graphs{margin-top:1rem;height:150px;overflow:hidden;position:relative}.dashboard .empty-state .fade-out-graphs:after{width:calc(100% - 16px);left:8px;height:150px}.dashboard .empty-state .cta{width:360px;max-width:calc(100% - 32px);position:absolute;top:16px;left:50%;transform:translateX(-50%);z-index:var(--z-content-overlay)}.dashboard-header{display:flex;justify-content:space-between;margin-bottom:1rem;width:100%}.dashboard-header.full-screen{margin-top:1rem}.dashboard-header .dashboard-select{flex:1;padding-right:2rem}.dashboard-header .dashboard-select .ant-select-single{max-width:100%;line-height:40px}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector{align-items:center;padding-left:0;padding-right:8px;line-height:40px;height:40px}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector .ant-select-selection-item{font-size:28px;font-weight:600;line-height:40px;width:100%;height:35px;display:flex;align-items:center}.dashboard-header .dashboard-select .ant-select-single .ant-select-selector .ant-select-selection-item .anticon-share-alt{font-size:16px;margin-left:6px!important;margin-right:4px}.dashboard-header .dashboard-select .ant-select-single.ant-select-open .ant-select-arrow{color:var(--depr-rgba-text-default-0-4)}.dashboard-header .dashboard-select .ant-select-single .ant-select-arrow{color:var(--text-default);font-size:14px}.dashboard-header .dashboard-meta{white-space:nowrap;display:flex;align-items:center}.dashboard-header .dashboard-meta .ant-btn{margin-left:10px}.dashboard-header .dashboard-meta .ant-btn .anticon{vertical-align:baseline}.dashboard-header .dashboard-meta .ant-btn.button-box{padding:4px 8px}@media(max-width:768px){.dashboard-header{flex-direction:column}.dashboard-header .dashboard-meta{padding-top:1rem;justify-content:flex-end}}#auto-refresh-check{padding:5px 12px;cursor:pointer}.CollaboratorRow{justify-content:space-between;height:2rem;margin-top:.5rem;padding-left:.5rem}.CollaboratorRow,.CollaboratorRow__details{display:flex;align-items:center}.CollaboratorRow__details>span{margin-right:.5rem}',""]),K.exports=O},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/dashboard/DashboardItems.scss":function(K,O,t){var U=t("./node_modules/css-loader/dist/runtime/api.js");O=U(!1),O.push([K.i,".dashboard-items-wrapper{width:100%}.react-grid-layout{position:relative;transition:height .1s ease;margin-bottom:2rem}.react-grid-layout.dashboard-view-mode .react-grid-item{transition:none}.react-grid-item{transition:all .1s ease;transition-property:left,top}.react-grid-item.cssTransforms{transition-property:transform}.react-grid-item.resizing{z-index:1;will-change:width,height}.react-grid-item.react-draggable{cursor:move}.react-grid-item.react-draggable-dragging{transition:none;z-index:105;will-change:transform}.react-grid-item.dropping{visibility:hidden}.react-grid-item.react-grid-placeholder{transition:.1s ease;max-width:100%;position:relative;border:1px solid var(--primary);outline:1px solid var(--primary);border-radius:var(--radius);z-index:2;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-resizable-hide>.react-resizable-handle{display:none}.react-grid-item>.react-resizable-handle{position:absolute;width:2rem;height:2rem;bottom:-.5rem;right:-.5rem;cursor:se-resize;z-index:10}.react-grid-item>.react-resizable-handle.react-resizable-handle-se{cursor:se-resize}.react-grid-item>.react-resizable-handle.react-resizable-handle-e{top:0;bottom:2rem;height:auto;cursor:ew-resize}.react-grid-item>.react-resizable-handle.react-resizable-handle-s{left:0;right:2rem;width:auto;cursor:ns-resize}.ant-dropdown{z-index:700}.dive-btn{margin-right:.5rem}.dive-btn.dive-btn-dive{border-color:var(--primary);color:var(--primary)}.dive-btn.dive-btn-dive:hover{border-color:var(--depr-darken-primary-30);color:var(--depr-darken-primary-30)}",""]),K.exports=O}}]);
