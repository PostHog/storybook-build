(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"./frontend/src/lib/components/ChartFilter/chartFilterLogic.ts":function(Q,w,t){"use strict";t.d(w,"a",function(){return We});var Z=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),N=t.n(Z),he=t("./node_modules/core-js/modules/es.array.includes.js"),se=t.n(he),oe=t("./node_modules/core-js/modules/es.string.includes.js"),Ue=t.n(oe),Ee=t("./node_modules/core-js/modules/es.object.values.js"),c=t.n(Ee),ge=t("./node_modules/core-js/modules/es.array.iterator.js"),we=t.n(ge),Oe=t("./node_modules/core-js/modules/es.object.to-string.js"),Re=t.n(Oe),be=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),pe=t.n(be),ce=t("./node_modules/core-js/modules/es.object.keys.js"),de=t.n(ce),Pe=t("./node_modules/core-js/modules/es.symbol.js"),a=t.n(Pe),I=t("./node_modules/core-js/modules/es.array.filter.js"),Y=t.n(I),xe=t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),q=t.n(xe),e=t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),ae=t.n(e),ue=t("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),ye=t.n(ue),B=t("./node_modules/kea/lib/index.esm.js"),K=t("./frontend/src/lib/utils.tsx"),x=t("./frontend/src/types.ts"),L=t("./frontend/src/scenes/insights/sharedUtils.ts"),$=t("./frontend/src/scenes/insights/insightLogic.ts");function H(G,J){var ee=Object.keys(G);if(Object.getOwnPropertySymbols){var ie=Object.getOwnPropertySymbols(G);J&&(ie=ie.filter(function(dt){return Object.getOwnPropertyDescriptor(G,dt).enumerable})),ee.push.apply(ee,ie)}return ee}function le(G){for(var J=1;J<arguments.length;J++){var ee=arguments[J]!=null?arguments[J]:{};J%2?H(Object(ee),!0).forEach(function(ie){N()(G,ie,ee[ie])}):Object.getOwnPropertyDescriptors?Object.defineProperties(G,Object.getOwnPropertyDescriptors(ee)):H(Object(ee)).forEach(function(ie){Object.defineProperty(G,ie,Object.getOwnPropertyDescriptor(ee,ie))})}return G}function Ne(G){return Object.values(x.A).includes(G)}var We=Object(B.kea)({props:{},key:Object(L.c)("new"),path:function(J){return["lib","components","ChartFilter","chartFilterLogic",J]},connect:function(J){return{actions:[Object($.c)(J),["setFilters"]],values:[Object($.c)(J),["filters"]]}},actions:function(){return{setChartFilter:function(ee){return{chartFilter:ee}}}},selectors:{chartFilter:[function(G){return[G.filters]},function(G){var J=G.display,ee=G.funnel_viz_type;return(J===x.j.FunnelViz?ee:J)||null}]},listeners:function(J){var ee=J.actions,ie=J.values;return{setChartFilter:function(Pt){var Me=Pt.chartFilter,ut=ie.filters,jt=ut.display,St=ut.funnel_viz_type;Ne(Me)?(St!==Me||jt!==x.j.FunnelViz)&&ee.setFilters(le(le({},ie.filters),{},{display:x.j.FunnelViz,funnel_viz_type:Me})):Object(K.qb)(jt,Me)||ee.setFilters(le(le({},ie.filters),{},{display:Me}))}}}})},"./frontend/src/lib/components/CompareFilter/compareFilterLogic.ts":function(Q,w,t){"use strict";t.d(w,"a",function(){return K});var Z=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),N=t.n(Z),he=t("./node_modules/core-js/modules/es.array.iterator.js"),se=t.n(he),oe=t("./node_modules/core-js/modules/es.object.to-string.js"),Ue=t.n(oe),Ee=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),c=t.n(Ee),ge=t("./node_modules/core-js/modules/es.object.keys.js"),we=t.n(ge),Oe=t("./node_modules/core-js/modules/es.symbol.js"),Re=t.n(Oe),be=t("./node_modules/core-js/modules/es.array.filter.js"),pe=t.n(be),ce=t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),de=t.n(ce),Pe=t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),a=t.n(Pe),I=t("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Y=t.n(I),xe=t("./node_modules/kea/lib/index.esm.js"),q=t("./frontend/src/lib/utils.tsx"),e=t("./frontend/src/types.ts"),ae=t("./frontend/src/scenes/insights/sharedUtils.ts"),ue=t("./frontend/src/scenes/insights/insightLogic.ts");function ye(x,L){var $=Object.keys(x);if(Object.getOwnPropertySymbols){var H=Object.getOwnPropertySymbols(x);L&&(H=H.filter(function(le){return Object.getOwnPropertyDescriptor(x,le).enumerable})),$.push.apply($,H)}return $}function B(x){for(var L=1;L<arguments.length;L++){var $=arguments[L]!=null?arguments[L]:{};L%2?ye(Object($),!0).forEach(function(H){N()(x,H,$[H])}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors($)):ye(Object($)).forEach(function(H){Object.defineProperty(x,H,Object.getOwnPropertyDescriptor($,H))})}return x}var K=Object(xe.kea)({props:{},key:Object(ae.c)("new"),path:function(L){return["lib","components","CompareFilter","compareFilterLogic",L]},connect:function(L){return{actions:[Object(ue.c)(L),["setFilters"]],values:[Object(ue.c)(L),["filters","canEditInsight"]]}},actions:function(){return{setCompare:function($){return{compare:$}},toggleCompare:!0}},selectors:{compare:[function(x){return[x.filters]},function(x){return!!(x!=null&&x.compare)}],disabled:[function(x){return[x.filters,x.canEditInsight]},function(x,L){var $=x.insight,H=x.date_from,le=x.display;return!L||$===e.E.LIFECYCLE||le===e.j.WorldMap||H==="all"}]},listeners:function(L){var $=L.values,H=L.actions;return{setCompare:function(Ne){var We=Ne.compare;Object(q.qb)(We,$.compare)||H.setFilters(B(B({},$.filters),{},{compare:We}))},toggleCompare:function(){H.setCompare(!$.compare)}}}})},"./frontend/src/lib/components/InlineMessage/InlineMessage.tsx":function(Q,w,t){"use strict";t.d(w,"a",function(){return ce});var Z=t("./node_modules/@babel/runtime/helpers/slicedToArray.js"),N=t.n(Z),he=t("./node_modules/react/index.js"),se=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),oe=t.n(se),Ue=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/lib/components/InlineMessage/InlineMessage.scss"),Ee=t.n(Ue),c={};c.insert="head",c.singleton=!1;var ge=oe()(Ee.a,c),we=Ee.a.locals||{},Oe=t("./node_modules/@ant-design/icons/es/icons/ExclamationCircleFilled.js"),Re=t("./node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),be=t("./node_modules/clsx/dist/clsx.m.js"),pe=t("./node_modules/react/jsx-runtime.js");function ce(de){var Pe=de.children,a=de.style,I=de.icon,Y=I===void 0?Object(pe.jsx)(Oe.a,{}):I,xe=de.type,q=xe===void 0?"info":xe,e=de.closable,ae=de.onClose,ue=Object(he.useState)(!0),ye=N()(ue,2),B=ye[0],K=ye[1],x=function(){K(!1),ae==null||ae()};return Object(pe.jsxs)("div",{className:Object(be.a)("inline-message",q,e&&"closable",!B&&"hidden"),style:a,children:[Object(pe.jsx)("div",{className:"inline-icon",children:Y}),Object(pe.jsx)("div",{className:"inline-main",children:Pe}),e&&Object(pe.jsx)("div",{className:"closable",onClick:x,children:Object(pe.jsx)(Re.a,{})})]})}try{ce.displayName="InlineMessage",ce.__docgenInfo={description:"",displayName:"InlineMessage",props:{style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},icon:{defaultValue:{value:"<ExclamationCircleFilled />"},description:"",name:"icon",required:!1,type:{name:"Element"}},type:{defaultValue:{value:"info"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"info"'},{value:'"warning"'},{value:'"danger"'}]}},closable:{defaultValue:null,description:"",name:"closable",required:!1,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"(() => void)"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/InlineMessage/InlineMessage.tsx#InlineMessage"]={docgenInfo:ce.__docgenInfo,name:"InlineMessage",path:"frontend/src/lib/components/InlineMessage/InlineMessage.tsx#InlineMessage"})}catch(de){}},"./frontend/src/scenes/insights/InsightContainer.tsx":function(Q,w,t){"use strict";t.d(w,"a",function(){return at});var Z=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),N=t.n(Z),he=t("./node_modules/antd/es/card/index.js"),se=t("./node_modules/antd/es/row/index.js"),oe=t("./node_modules/antd/es/col/index.js"),Ue=t("./node_modules/core-js/modules/es.array.includes.js"),Ee=t("./node_modules/core-js/modules/es.string.includes.js"),c=t("./node_modules/kea/lib/index.esm.js"),ge=t("./frontend/src/lib/components/ChartFilter/chartFilterLogic.ts"),we=t("./node_modules/@ant-design/icons/es/icons/OrderedListOutlined.js"),Oe=t("./node_modules/@ant-design/icons/es/icons/LineChartOutlined.js"),Re=t("./node_modules/@ant-design/icons/es/icons/AreaChartOutlined.js"),be=t("./node_modules/@ant-design/icons/es/icons/BarChartOutlined.js"),pe=t("./node_modules/@ant-design/icons/es/icons/NumberOutlined.js"),ce=t("./node_modules/@ant-design/icons/es/icons/TableOutlined.js"),de=t("./node_modules/@ant-design/icons/es/icons/PieChartOutlined.js"),Pe=t("./node_modules/@ant-design/icons/es/icons/GlobalOutlined.js"),a=t("./frontend/src/types.ts"),I=t("./frontend/src/scenes/insights/insightLogic.ts"),Y=t("./frontend/src/lib/components/Tooltip.tsx"),xe=t("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),q=t("./frontend/@posthog/lemon-ui/src/index.ts"),e=t("./node_modules/react/jsx-runtime.js");function ae(s){var n=s.filters,r=s.onChange,o=s.disabled,d=Object(c.useValues)(I.c),l=d.insightProps,u=d.isSingleSeries,i=Object(c.useValues)(Object(ge.a)(l)),j=i.chartFilter,m=Object(c.useActions)(Object(ge.a)(l)),p=m.setChartFilter,f=n.insight===a.E.STICKINESS||n.insight===a.E.RETENTION,y=n.insight===a.E.STICKINESS||n.insight===a.E.RETENTION,v=n.insight===a.E.STICKINESS||n.insight===a.E.RETENTION&&!!n.breakdown&&n.breakdown!=="$geoip_country_code"&&n.breakdown!=="$geoip_country_name"||!u||!!n.formula,g=n.insight===a.E.STICKINESS||n.insight===a.E.RETENTION||!u,_=n.insight===a.E.RETENTION,O=_||n.insight===a.E.STICKINESS||n.insight===a.E.RETENTION,U=n.insight===a.E.RETENTION?a.j.ActionsTable:n.insight===a.E.FUNNELS?a.j.FunnelViz:a.j.ActionsLineGraph;function E(P){var b=P.icon,h=P.tooltip,T=P.children,D=T===void 0?null:T;return Object(e.jsx)(Y.a,{title:h,placement:"left",children:Object(e.jsxs)("div",{className:"w-full",children:[b," ",D]})})}var W=n.insight===a.E.FUNNELS?[{value:a.A.Steps,label:Object(e.jsx)(E,{icon:Object(e.jsx)(we.a,{}),children:"Steps"})},{value:a.A.Trends,label:Object(e.jsxs)(E,{icon:Object(e.jsx)(Oe.a,{}),children:["Trends",Object(e.jsx)(xe.a,{type:"warning",className:"uppercase",style:{marginLeft:6,lineHeight:"1.4em"},children:"BETA"})]})}]:[{title:"Line Chart",options:[{value:a.j.ActionsLineGraph,label:Object(e.jsx)(E,{icon:Object(e.jsx)(Oe.a,{}),children:"Linear"})},{value:a.j.ActionsLineGraphCumulative,label:Object(e.jsx)(E,{icon:Object(e.jsx)(Re.a,{}),children:"Cumulative"}),disabled:f}]},{title:"Bar Chart",options:[{value:a.j.ActionsBar,label:Object(e.jsx)(E,{icon:Object(e.jsx)(be.a,{}),children:"Time"}),disabled:_},{value:a.j.ActionsBarValue,label:Object(e.jsx)(E,{icon:Object(e.jsx)(be.a,{}),children:"Value"}),disabled:O}]},{options:[{value:a.j.BoldNumber,label:Object(e.jsx)(E,{icon:Object(e.jsx)(pe.a,{}),tooltip:"Big and bold. Only works with one series at a time.",children:"Number"}),disabled:g},{value:a.j.ActionsTable,label:Object(e.jsx)(E,{icon:Object(e.jsx)(ce.a,{}),children:"Table"})},{value:a.j.ActionsPie,label:Object(e.jsx)(E,{icon:Object(e.jsx)(de.a,{}),children:"Pie"}),disabled:y},{value:a.j.WorldMap,label:Object(e.jsx)(E,{icon:Object(e.jsx)(Pe.a,{}),tooltip:"Visualize data by country. Only works with one series at a time.",children:"World Map"}),disabled:v}]}];return Object(e.jsx)(q.LemonSelect,{value:j||U||n.display,onChange:function(b){p(b),r==null||r(b)},dropdownPlacement:"bottom-end",dropdownMatchSelectWidth:!1,"data-attr":"chart-filter",disabled:o,options:W,size:"small"},"2")}try{ae.displayName="ChartFilter",ae.__docgenInfo={description:"",displayName:"ChartFilter",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((chartFilter: ChartDisplayType | FunnelVizType) => void)"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/ChartFilter/ChartFilter.tsx#ChartFilter"]={docgenInfo:ae.__docgenInfo,name:"ChartFilter",path:"frontend/src/lib/components/ChartFilter/ChartFilter.tsx#ChartFilter"})}catch(s){}var ue=t("./frontend/src/lib/components/CompareFilter/compareFilterLogic.ts");function ye(){var s=Object(c.useValues)(I.c),n=s.insightProps,r=Object(c.useValues)(Object(ue.a)(n)),o=r.compare,d=r.disabled,l=Object(c.useActions)(Object(ue.a)(n)),u=l.setCompare;return d?null:Object(e.jsx)(q.LemonCheckbox,{onChange:u,checked:o,disabled:d,label:Object(e.jsx)("span",{className:"font-normal",children:"Compare to previous time period"}),bordered:!0,size:"small"})}var B=t("./node_modules/@babel/runtime/helpers/slicedToArray.js"),K=t.n(B),x=t("./node_modules/core-js/modules/es.array.map.js"),L=t("./node_modules/core-js/modules/es.object.entries.js"),$=t("./node_modules/core-js/modules/es.array.iterator.js"),H=t("./node_modules/core-js/modules/es.object.to-string.js"),le=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),Ne=t("./node_modules/core-js/modules/es.object.keys.js"),We=t("./node_modules/core-js/modules/es.symbol.js"),G=t("./node_modules/core-js/modules/es.array.filter.js"),J=t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),ee=t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),ie=t("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),dt=t("./node_modules/core-js/modules/es.array.slice.js"),Pt=t("./node_modules/core-js/modules/es.function.name.js"),Me=t("./node_modules/core-js/modules/es.array.from.js"),ut=t("./node_modules/core-js/modules/es.string.iterator.js"),jt=t("./node_modules/core-js/modules/es.regexp.exec.js"),St=t("./node_modules/core-js/modules/es.symbol.description.js"),Is=t("./node_modules/core-js/modules/es.symbol.iterator.js"),A=t("./frontend/src/lib/utils.tsx"),un=t("./frontend/src/scenes/insights/sharedUtils.ts"),je=t("./frontend/src/lib/dayjs.ts"),Tt=t("./frontend/src/lib/logic/featureFlagLogic.ts");function jn(s,n){var r=typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(!r){if(Array.isArray(s)||(r=fn(s))||n&&s&&typeof s.length=="number"){r&&(s=r);var o=0,d=function(){};return{s:d,n:function(){return o>=s.length?{done:!0}:{done:!1,value:s[o++]}},e:function(m){throw m},f:d}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var l=!0,u=!1,i;return{s:function(){r=r.call(s)},n:function(){var m=r.next();return l=m.done,m},e:function(m){u=!0,i=m},f:function(){try{!l&&r.return!=null&&r.return()}finally{if(u)throw i}}}}function fn(s,n){if(!!s){if(typeof s=="string")return Ft(s,n);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ft(s,n)}}function Ft(s,n){(n==null||n>s.length)&&(n=s.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=s[r];return o}function It(s,n){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(s);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(s,d).enumerable})),r.push.apply(r,o)}return r}function Lt(s){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?It(Object(r),!0).forEach(function(o){N()(s,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):It(Object(r)).forEach(function(o){Object.defineProperty(s,o,Object.getOwnPropertyDescriptor(r,o))})}return s}var At=Object(c.kea)({props:{},key:Object(un.c)("new"),path:function(n){return["lib","components","IntervalFilter","intervalFilterLogic",n]},connect:function(n){return{actions:[Object(I.c)(n),["setFilters"]],values:[Object(I.c)(n),["filters"],Tt.a,["featureFlags"]]}},actions:function(){return{setInterval:function(r){return{interval:r}}}},listeners:function(n){var r=n.values,o=n.actions,d=n.selectors;return{setInterval:function(u){var i=u.interval;Object(A.qb)(i,r.filters.interval)||o.setFilters(Lt(Lt({},r.filters),{},{interval:i}))},setFilters:function(u,i,j,m){var p=u.filters,f=p.date_from,y=p.date_to,v=d.filters(m);if(!(!f||Object(A.qb)(f,v.date_from)&&Object(A.qb)(y,v.date_to))){if(f&&y&&Object(je.a)(p.date_from).isValid()&&Object(je.a)(p.date_to).isValid()){Object(je.a)(y).diff(Object(je.a)(f),"day")<=3?o.setInterval("hour"):Object(je.a)(y).diff(Object(je.a)(f),"month")<=3?o.setInterval("day"):o.setInterval("month");return}var g="day",_=jn(A.u),O;try{for(_.s();!(O=_.n()).done;){var U=O.value,E=U.key,W=U.values,P=U.defaultInterval;if(W[0]===f&&W[1]===(y||void 0)&&E!=="Custom"&&P){g=P;break}}}catch(b){_.e(b)}finally{_.f()}o.setInterval(g)}}}},selectors:{interval:[function(s){return[s.filters]},function(s){return s==null?void 0:s.interval}]}}),mn={hour:{label:"Hour",newDateFrom:"dStart"},day:{label:"Day",newDateFrom:void 0},week:{label:"Week",newDateFrom:"-30d"},month:{label:"Month",newDateFrom:"-90d"}};function $e(s){var n=s.disabled,r=Object(c.useValues)(I.c),o=r.insightProps,d=Object(c.useValues)(At(o)),l=d.interval,u=Object(c.useActions)(At(o)),i=u.setInterval;return Object(e.jsx)(q.LemonSelect,{size:"small",disabled:n,value:l||void 0,dropdownMatchSelectWidth:!1,onChange:function(m){m&&i(String(m))},"data-attr":"interval-filter",options:Object.entries(mn).map(function(j){var m=K()(j,2),p=m[0],f=m[1].label;return{value:p,label:f}})})}try{$e.displayName="IntervalFilter",$e.__docgenInfo={description:"",displayName:"IntervalFilter",props:{view:{defaultValue:null,description:"",name:"view",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/IntervalFilter/IntervalFilter.tsx#IntervalFilter"]={docgenInfo:$e.__docgenInfo,name:"IntervalFilter",path:"frontend/src/lib/components/IntervalFilter/IntervalFilter.tsx#IntervalFilter"})}catch(s){}var ve=t("./node_modules/antd/es/select/index.js"),bn=t("./node_modules/@ant-design/icons/es/icons/FundOutlined.js"),pn=t("./frontend/src/lib/components/SmoothingFilter/smoothings.ts");function Dt(s,n){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(s);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(s,d).enumerable})),r.push.apply(r,o)}return r}function Rt(s){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Dt(Object(r),!0).forEach(function(o){N()(s,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Dt(Object(r)).forEach(function(o){Object.defineProperty(s,o,Object.getOwnPropertyDescriptor(r,o))})}return s}function vn(){var s=Object(c.useValues)(I.c),n=s.filters,r=Object(c.useActions)(I.c),o=r.setFilters,d=n.interval,l=n.smoothing_intervals;if(!d)return null;var u=pn.a[d].map(function(i){var j=i.value,m=i.label;return{value:j,label:j===l?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(bn.a,{})," ",m]}):m}});return u.length?Object(e.jsx)(ve.a,{bordered:!0,value:l||1,dropdownMatchSelectWidth:!1,onChange:function(j){o(Rt(Rt({},n),{},{smoothing_intervals:j}))},"data-attr":"smoothing-filter",options:u},d):Object(e.jsx)(e.Fragment,{})}var Fe=t("./frontend/src/lib/constants.tsx"),hn=t("./node_modules/@ant-design/icons/es/icons/CalendarOutlined.js"),Nt=t("./frontend/src/scenes/insights/filters/InsightDateFilter/insightDateFilterLogic.ts"),gn=t("./frontend/src/lib/components/DateFilter/DateFilter.tsx");function Mt(s,n){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(s);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(s,d).enumerable})),r.push.apply(r,o)}return r}function Vt(s){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Mt(Object(r),!0).forEach(function(o){N()(s,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Mt(Object(r)).forEach(function(o){Object.defineProperty(s,o,Object.getOwnPropertyDescriptor(r,o))})}return s}function Ye(s){var n,r=Object(c.useValues)(I.c),o=r.insightProps,d=Object(c.useValues)(Object(Nt.a)(o)),l=d.dates,u=l.dateFrom,i=l.dateTo,j=Object(c.useActions)(Object(Nt.a)(o)),m=j.setDates;return Object(e.jsx)(gn.a,Vt(Vt({},s),{},{dateFrom:(n=u!=null?u:"-7d")!==null&&n!==void 0?n:void 0,dateTo:i!=null?i:void 0,onChange:function(f,y){var v;m(f,y),(v=s.onChange)===null||v===void 0||v.call(s,f,y)}}))}try{Ye.displayName="InsightDateFilter",Ye.__docgenInfo={description:"",displayName:"InsightDateFilter",props:{showCustom:{defaultValue:null,description:"",name:"showCustom",required:!1,type:{name:"boolean"}},showRollingRangePicker:{defaultValue:null,description:"",name:"showRollingRangePicker",required:!1,type:{name:"boolean"}},makeLabel:{defaultValue:null,description:"",name:"makeLabel",required:!1,type:{name:"((key: ReactNode) => ReactNode)"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((fromDate: string | null, toDate: string | null) => void)"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},getPopupContainer:{defaultValue:null,description:"",name:"getPopupContainer",required:!1,type:{name:"(() => HTMLElement)"}},dateOptions:{defaultValue:null,description:"",name:"dateOptions",required:!1,type:{name:"DateMappingOption[]"}},isDateFormatted:{defaultValue:null,description:"",name:"isDateFormatted",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/filters/InsightDateFilter/InsightDateFilter.tsx#InsightDateFilter"]={docgenInfo:Ye.__docgenInfo,name:"InsightDateFilter",path:"frontend/src/scenes/insights/filters/InsightDateFilter/InsightDateFilter.tsx#InsightDateFilter"})}catch(s){}var He=t("./frontend/src/scenes/retention/retentionTableLogic.ts"),On=t("./frontend/src/lib/components/DatePicker.tsx");function Ge(s){var n=s.disabled,r=Object(c.useValues)(I.c),o=r.insightProps,d=Object(c.useValues)(Object(He.e)(o)),l=d.filters,u=Object(c.useActions)(Object(He.e)(o)),i=u.setFilters,j=l.date_to&&Object(je.a)(l.date_to).year()!==Object(je.a)().year()?", YYYY":"";return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(Y.a,{title:"Cohorts up to this end date",children:Object(e.jsx)("span",{style:{maxWidth:100},className:"flex inline-flex items-center pl-2",children:Object(e.jsx)(On.a,{showTime:l.period==="Hour",use12Hours:!0,format:l.period==="Hour"?"MMM D".concat(j,", h a"):"MMM D".concat(j),value:l.date_to?Object(je.a)(l.date_to):void 0,onChange:function(p){return i({date_to:p&&Object(je.a)(p).toISOString()})},allowClear:!0,placeholder:"Today",className:"retention-date-picker",disabled:n})})})})}try{Ge.displayName="RetentionDatePicker",Ge.__docgenInfo={description:"",displayName:"RetentionDatePicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/RetentionDatePicker.tsx#RetentionDatePicker"]={docgenInfo:Ge.__docgenInfo,name:"RetentionDatePicker",path:"frontend/src/scenes/insights/RetentionDatePicker.tsx#RetentionDatePicker"})}catch(s){}var te=t("./frontend/src/scenes/funnels/funnelLogic.ts"),_e=t("./frontend/src/lib/components/icons.tsx");function Je(s){var n=s.disabled,r=Object(c.useValues)(I.c),o=r.insightProps,d=Object(c.useValues)(Object(te.a)(o)),l=d.barGraphLayout,u=Object(c.useActions)(Object(te.a)(o)),i=u.setFilters,j=[{title:"Graph Display Options",options:[{value:Fe.j.vertical,icon:Object(e.jsx)(_e.IconFunnelVertical,{}),label:"Left to right"},{value:Fe.j.horizontal,icon:Object(e.jsx)(_e.IconFunnelHorizontal,{}),label:"Top to bottom"}]}];return Object(e.jsx)(q.LemonSelect,{value:l||Fe.j.vertical,onChange:function(p){return p&&i({layout:p})},dropdownMatchSelectWidth:!1,"data-attr":"funnel-bar-layout-selector",disabled:n,options:j,size:"small"})}try{Je.displayName="FunnelDisplayLayoutPicker",Je.__docgenInfo={description:"",displayName:"FunnelDisplayLayoutPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/views/Funnels/FunnelDisplayLayoutPicker.tsx#FunnelDisplayLayoutPicker"]={docgenInfo:Je.__docgenInfo,name:"FunnelDisplayLayoutPicker",path:"frontend/src/scenes/insights/views/Funnels/FunnelDisplayLayoutPicker.tsx#FunnelDisplayLayoutPicker"})}catch(s){}var xn=t("./node_modules/@ant-design/icons/es/icons/BarsOutlined.js"),ft=t("./frontend/src/scenes/paths/pathsLogic.ts"),yn=t("./frontend/src/scenes/userLogic.ts");function Xe(s){var n,r=s.disabled,o=Object(c.useValues)(I.c),d=o.insightProps,l=Object(c.useValues)(Object(ft.b)(d)),u=l.filter,i=Object(c.useActions)(Object(ft.b)(d)),j=i.setFilter,m=Object(c.useValues)(yn.a),p=m.user,f=2,y=p!=null&&(n=p.organization)!==null&&n!==void 0&&n.available_features.includes(a.d.PATHS_ADVANCED)?20:5,v=Array.from(Array.from(Array.from(Array(y+1).keys()).slice(f)),function(g){return{label:"".concat(g," Steps"),value:g}});return Object(e.jsx)(ve.a,{id:"path-step-filter","data-attr":"path-step-filter",defaultValue:5,value:u.step_limit||ft.a,onSelect:function(_){return j({step_limit:_})},listHeight:440,bordered:!1,dropdownMatchSelectWidth:!0,dropdownAlign:A.a.bottomRight,optionLabelProp:"label",disabled:r,children:v.map(function(g){return Object(e.jsx)(ve.a.Option,{value:g.value,label:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(xn.a,{})," ",g.label]}),children:g.label},g.value)})})}try{Xe.displayName="PathStepPicker",Xe.__docgenInfo={description:"",displayName:"PathStepPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/views/Paths/PathStepPicker.tsx#PathStepPicker"]={docgenInfo:Xe.__docgenInfo,name:"PathStepPicker",path:"frontend/src/scenes/insights/views/Paths/PathStepPicker.tsx#PathStepPicker"})}catch(s){}var Bt=t("./node_modules/@ant-design/icons/es/icons/PercentageOutlined.js");function Qe(s){var n=s.disabled,r=Object(c.useValues)(I.c),o=r.insightProps,d=Object(c.useValues)(Object(He.e)(o)),l=d.retentionReference,u=Object(c.useActions)(Object(He.e)(o)),i=u.setRetentionReference;return Object(e.jsx)(ve.a,{value:l,onChange:i,bordered:!1,dropdownMatchSelectWidth:!1,"data-attr":"reference-selector",optionLabelProp:"label",disabled:n,children:[{value:"total",icon:Object(e.jsx)(Bt.a,{}),label:"Overall cohort"},{value:"previous",icon:Object(e.jsx)(Bt.a,{}),label:"Relative to previous period"}].map(function(j){return Object(e.jsx)(ve.a.Option,{value:j.value,label:Object(e.jsxs)(e.Fragment,{children:[j.icon," ",j.label]}),children:j.label},j.value)})})}try{Qe.displayName="ReferencePicker",Qe.__docgenInfo={description:"",displayName:"ReferencePicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/filters/ReferencePicker.tsx#ReferencePicker"]={docgenInfo:Qe.__docgenInfo,name:"ReferencePicker",path:"frontend/src/scenes/insights/filters/ReferencePicker.tsx#ReferencePicker"})}catch(s){}var Kt=t("./node_modules/antd/es/tooltip/index.js"),Se=t("./node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js"),_n=t("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),Te=t.n(_n),Ls=t("./node_modules/core-js/modules/es.set.js"),As=t("./node_modules/core-js/modules/es.array.concat.js"),Cn=t("./node_modules/antd/es/input-number/index.js"),mt=t("./node_modules/clsx/dist/clsx.m.js"),En=1,Ut=90,Pn=new Set([5,15,25,50,90]),Sn=[{label:"Auto bins",value:Fe.a,display:!0}].concat(Te()(Array.from(Array.from(Array(Ut+1).keys()),function(s){return{label:"".concat(s," bins"),value:s,display:Pn.has(s)}})),[{label:"Custom",value:"custom",display:!0}]);function Ze(s){var n=s.disabled,r=Object(c.useValues)(I.c),o=r.insightProps,d=Object(c.useValues)(Object(te.a)(o)),l=d.filters,u=d.numericBinCount,i=Object(c.useActions)(Object(te.a)(o)),j=i.setBinCount;return Object(e.jsx)(ve.a,{id:"funnel-bin-filter",dropdownClassName:"funnel-bin-filter-dropdown","data-attr":"funnel-bin-filter",defaultValue:Fe.a,value:l.bin_count||Fe.a,onSelect:function(p){return j(p)},dropdownRender:function(p){return Object(e.jsxs)(e.Fragment,{children:[p,Object(e.jsxs)("div",{children:[Object(e.jsx)(Cn.a,{className:"funnel-bins-custom-picker",size:"middle",min:En,max:Ut,value:u,onChange:function(y){var v=typeof y=="string"?parseInt(y):y;v&&j(v)}})," ","bins"]})]})},listHeight:440,bordered:!1,dropdownMatchSelectWidth:!1,dropdownAlign:A.a.bottomRight,optionLabelProp:"label",disabled:n,children:Object(e.jsx)(ve.a.OptGroup,{label:"Bin Count",children:Sn.map(function(m){return m.value==="custom"?null:Object(e.jsx)(ve.a.Option,{className:Object(mt.a)({"select-option-hidden":!m.display}),value:m.value,label:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(be.a,{})," ",m.label]}),children:m.label},m.value)})})})}try{Ze.displayName="FunnelBinsPicker",Ze.__docgenInfo={description:"",displayName:"FunnelBinsPicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/views/Funnels/FunnelBinsPicker.tsx#FunnelBinsPicker"]={docgenInfo:Ze.__docgenInfo,name:"FunnelBinsPicker",path:"frontend/src/scenes/insights/views/Funnels/FunnelBinsPicker.tsx#FunnelBinsPicker"})}catch(s){}var bt=t("./frontend/src/scenes/insights/aggregationAxisFormat.ts"),fe=t("./frontend/src/lib/components/LemonButton/index.ts"),Tn=t("./frontend/src/lib/components/LemonDivider/index.ts"),re=t("./node_modules/react/index.js"),wt=t.n(re),Fn=t("./frontend/src/lib/hooks/useKeyboardHotkeys.tsx"),pt=t("./frontend/src/lib/utils/eventUsageLogic.ts"),In=t("./frontend/src/lib/components/LemonModal/index.ts"),Ln=t("./frontend/src/lib/forms/Field.tsx"),An=t("./frontend/src/lib/components/LemonInput/LemonInput.tsx");function Wt(s,n){return s==="prefix"?n.aggregation_axis_prefix||"":s==="postfix"&&n.aggregation_axis_postfix||""}function qe(s){var n=s.isOpen,r=s.onSave,o=s.formativeElement,d=s.filters,l=s.onClose,u=s.overlayRef,i=Object(re.useState)(Wt(o,d)),j=K()(i,2),m=j[0],p=j[1];return Object(re.useEffect)(function(){p(Wt(o,d))},[o]),o===null?null:Object(e.jsx)(In.a,{overlayRef:u,isOpen:n,onClose:l,forceAbovePopups:!0,title:"Custom ".concat(o),footer:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(fe.a,{type:"secondary","data-attr":"custom-prefix-cancel",onClick:l,children:"Cancel"}),Object(e.jsx)(fe.a,{type:"primary",onClick:function(){return r(N()({},o,m))},children:"Apply"})]}),children:Object(e.jsx)(Ln.b,{label:"".concat(Object(A.i)(o),":"),help:Object(e.jsxs)(e.Fragment,{children:["With a ",o,' of "',Object(e.jsx)("strong",{children:m||"$"}),'", 123.45 will be displayed as "',Object(e.jsxs)("strong",{children:[o==="prefix"?m||"$":"","123.45",o==="postfix"?m||"$":""]}),'"']}),children:Object(e.jsx)(An.a,{value:m,onChange:p,autoFocus:!0})})})}try{qe.displayName="CustomUnitModal",qe.__docgenInfo={description:"",displayName:"CustomUnitModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!0,type:{name:"(hx: HandleUnitChange) => void"}},formativeElement:{defaultValue:null,description:"",name:"formativeElement",required:!0,type:{name:'"prefix" | "postfix" | null'}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"Partial<FilterType>"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},overlayRef:{defaultValue:null,description:"",name:"overlayRef",required:!0,type:{name:"(instance: HTMLDivElement | null) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/UnitPicker/CustomUnitModal.tsx#CustomUnitModal"]={docgenInfo:qe.__docgenInfo,name:"CustomUnitModal",path:"frontend/src/lib/components/UnitPicker/CustomUnitModal.tsx#CustomUnitModal"})}catch(s){}function zt(s,n){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(s);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(s,d).enumerable})),r.push.apply(r,o)}return r}function kt(s){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?zt(Object(r),!0).forEach(function(o){N()(s,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):zt(Object(r)).forEach(function(o){Object.defineProperty(s,o,Object.getOwnPropertyDescriptor(r,o))})}return s}var Dn=bt.a.reduce(function(s,n){return s[n.value]=n.label,s},{});function et(s){var n=s.filters,r=s.setFilters,o=Object(c.useActions)(pt.e),d=o.reportAxisUnitsChanged,l=Object(re.useState)(!1),u=K()(l,2),i=u[0],j=u[1],m=Object(re.useState)(n.aggregation_axis_format||void 0),p=K()(m,2),f=p[0],y=p[1],v=Object(re.useState)(null),g=K()(v,2),_=g[0],O=g[1],U=Object(re.useRef)(null);Object(Fn.a)({escape:{action:function(){O(null),j(!1)}}},[]);var E=function(b){var h=b.format,T=b.prefix,D=b.postfix;y(h),r(kt(kt({},n),{},{aggregation_axis_format:h,aggregation_axis_prefix:T,aggregation_axis_postfix:D})),d({format:h,prefix:T,postfix:D,display:n.display,unitIsSet:!!T||!!D||h&&h!=="numeric"}),j(!1),O(null)},W=Object(re.useMemo)(function(){var P,b,h="None";return f&&(h=Dn[f]),(P=n.aggregation_axis_prefix)!==null&&P!==void 0&&P.length&&(h="Prefix: ".concat(n.aggregation_axis_prefix)),(b=n.aggregation_axis_postfix)!==null&&b!==void 0&&b.length&&(h="Postfix: ".concat(n.aggregation_axis_postfix)),h},[f,n]);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("span",{children:Object(bt.b)(n.display)}),Object(e.jsx)(qe,{formativeElement:_,isOpen:_!==null,onSave:E,filters:n,onClose:function(){return O(null)},overlayRef:function(b){return U.current=b}}),Object(e.jsx)(fe.b,{onClick:function(){return j(!i)},size:"small",type:"secondary",status:"stealth","data-attr":"chart-aggregation-axis-format",popup:{onClickOutside:function(){return j(!1)},additionalRefs:[U],visible:i,overlay:Object(e.jsxs)(e.Fragment,{children:[bt.a.map(function(P,b){var h=P.value,T=P.label;return Object(e.jsx)(fe.a,{onClick:function(){return E({format:h})},status:"stealth",active:h===f,fullWidth:!0,children:T},b)}),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Tn.a,{}),Object(e.jsxs)(fe.a,{onClick:function(){return O("prefix")},status:"stealth",active:!!n.aggregation_axis_prefix,fullWidth:!0,children:["Custom prefix",n.aggregation_axis_prefix?": ".concat(n.aggregation_axis_prefix,"..."):"..."]}),Object(e.jsxs)(fe.a,{onClick:function(){return O("postfix")},status:"stealth",active:!!n.aggregation_axis_postfix,fullWidth:!0,children:["Custom postfix",n.aggregation_axis_postfix?": ".concat(n.aggregation_axis_postfix,"..."):"..."]})]})]}),placement:"bottom-start",actionable:!0,closeOnClickInside:!1},children:W})]})}try{et.displayName="UnitPicker",et.__docgenInfo={description:"",displayName:"UnitPicker",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},setFilters:{defaultValue:null,description:"",name:"setFilters",required:!0,type:{name:"(filters: Partial<FilterType>, insightMode?: ItemMode | undefined) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/UnitPicker/UnitPicker.tsx#UnitPicker"]={docgenInfo:et.__docgenInfo,name:"UnitPicker",path:"frontend/src/lib/components/UnitPicker/UnitPicker.tsx#UnitPicker"})}catch(s){}var Ie,Le,Rn=function(n,r){switch(n){case a.E.FUNNELS:return r.funnel_viz_type===a.A.Trends;case a.E.RETENTION:case a.E.PATHS:return!1;case a.E.TRENDS:case a.E.STICKINESS:case a.E.LIFECYCLE:default:return!r.display||!Fe.n.includes(r.display)}},Nn=function(n){switch(n){case a.E.TRENDS:case a.E.STICKINESS:return!0;case a.E.RETENTION:case a.E.FUNNELS:return!1;case a.E.LIFECYCLE:case a.E.PATHS:return!1;default:return!0}},Mn=(Ie={},N()(Ie,"".concat(a.E.TRENDS),!0),N()(Ie,"".concat(a.E.STICKINESS),!0),N()(Ie,"".concat(a.E.LIFECYCLE),!0),N()(Ie,"".concat(a.E.FUNNELS),!0),N()(Ie,"".concat(a.E.RETENTION),!1),N()(Ie,"".concat(a.E.PATHS),!0),Ie),Vn=(Le={},N()(Le,"".concat(a.E.TRENDS),!0),N()(Le,"".concat(a.E.STICKINESS),!0),N()(Le,"".concat(a.E.LIFECYCLE),!1),N()(Le,"".concat(a.E.FUNNELS),!1),N()(Le,"".concat(a.E.RETENTION),!1),N()(Le,"".concat(a.E.PATHS),!1),Le),Bn=function(n){var r,o;return!n.actions&&!n.events||((r=n.actions)===null||r===void 0?void 0:r.length)===0&&((o=n.events)===null||o===void 0?void 0:o.length)===0};function Ce(s){return Object(e.jsx)("span",{className:"space-x-2 flex items-center text-sm",children:s.children})}function tt(s){var n=s.filters,r=s.activeView,o=s.disableTable,d=r===a.E.FUNNELS,l=r===a.E.PATHS,u=Object(c.useValues)(Tt.a),i=u.featureFlags,j=Object(c.useActions)(I.c),m=j.setFilters;return Object(e.jsxs)("div",{className:"flex justify-between items-center flex-wrap","data-attr":"insight-filters",children:[Object(e.jsxs)("div",{className:"flex items-center space-x-2 flex-wrap my-2",children:[Mn[r]&&!o&&Object(e.jsxs)(Ce,{children:[Object(e.jsx)("span",{children:"Date range"}),Object(e.jsx)(Ye,{disabled:d&&Bn(n),makeLabel:function(f){return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(hn.a,{})," ",f,f=="All time"&&Object(e.jsx)(Kt.a,{title:"Only events dated after 2015 will be shown",children:Object(e.jsx)(Se.a,{className:"info-indicator"})})]})}})]}),Rn(r,n)&&Object(e.jsxs)(Ce,{children:[Object(e.jsxs)("span",{children:[Object(e.jsx)("span",{className:"hide-lte-md",children:"grouped "}),"by"]}),Object(e.jsx)($e,{view:r})]}),r===a.E.TRENDS&&!n.breakdown_type&&!n.compare&&(!n.display||n.display===a.j.ActionsLineGraph)&&i[Fe.h.SMOOTHING_INTERVAL]?Object(e.jsx)(Ce,{children:Object(e.jsx)(vn,{})}):null,r===a.E.RETENTION&&Object(e.jsxs)(Ce,{children:[Object(e.jsx)(Ge,{}),Object(e.jsx)(Qe,{})]}),l&&Object(e.jsx)(Ce,{children:Object(e.jsx)(Xe,{})}),Vn[r]&&Object(e.jsx)(Ce,{children:Object(e.jsx)(ye,{})})]}),Object(e.jsxs)("div",{className:"flex items-center space-x-4 flex-wrap my-2",children:[Nn(r)&&Object(e.jsxs)(e.Fragment,{children:[r===a.E.TRENDS&&Object(e.jsx)(Ce,{children:Object(e.jsx)(et,{filters:n,setFilters:m})}),Object(e.jsxs)(Ce,{children:[Object(e.jsx)("span",{children:"Chart type"}),Object(e.jsx)(ae,{filters:n})]})]}),d&&n.funnel_viz_type===a.A.Steps&&Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(Ce,{children:Object(e.jsx)(Je,{})})}),d&&n.funnel_viz_type===a.A.TimeToConvert&&Object(e.jsx)(Ce,{children:Object(e.jsx)(Ze,{})})]})]})}try{tt.displayName="InsightDisplayConfig",tt.__docgenInfo={description:"",displayName:"InsightDisplayConfig",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterType"}},activeView:{defaultValue:null,description:"",name:"activeView",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}},insightMode:{defaultValue:null,description:"",name:"insightMode",required:!0,type:{name:"enum",value:[{value:'"edit"'},{value:'"view"'},{value:'"subscriptions"'},{value:'"sharing"'}]}},disableTable:{defaultValue:null,description:"",name:"disableTable",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightDisplayConfig.tsx#InsightDisplayConfig"]={docgenInfo:tt.__docgenInfo,name:"InsightDisplayConfig",path:"frontend/src/scenes/insights/InsightDisplayConfig.tsx#InsightDisplayConfig"})}catch(s){}var vt=t("./node_modules/antd/es/button/index.js"),Kn=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),nt=t.n(Kn),Un=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/funnels/FunnelCanvasLabel.scss"),$t=t.n(Un),ht={};ht.insert="head",ht.singleton=!1;var Ds=nt()($t.a,ht),Rs=$t.a.locals||{},Ns=t("./node_modules/core-js/modules/es.array.find.js"),Yt=t("./frontend/src/lib/components/EntityFilterInfo.tsx");function Ht(){var s,n=Object(c.useValues)(I.c),r=n.insightProps,o=Object(c.useValues)(Object(te.a)(r)),d=o.filters,l=o.numberOfSeries,u=o.areFiltersValid,i=o.filterSteps,j=Object(c.useActions)(Object(te.a)(r)),m=j.changeStepRange;if(d.funnel_viz_type===a.A.Steps)return null;var p=function(_,O){m(_,O)},f=u?Array.from(Array(Math.max(l)).keys()).slice(0,-1):[0],y=u?Array.from(Array(Math.max(l)).keys()).slice(((s=d.funnel_from_step)!==null&&s!==void 0?s:0)+1):[1],v=function(_){return _.map(function(O){var U=i.find(function(E){return E.order===O});return U?Object(e.jsx)(ve.a.Option,{value:O,label:"Step ".concat(O+1),children:Object(e.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(e.jsxs)("span",{style:{marginRight:4},children:["Step ",O+1,":"]}),Object(e.jsx)(Yt.a,{filter:U})]})},O):null})};return Object(e.jsxs)(se.a,{className:"funnel-options-inputs",children:[Object(e.jsx)("span",{className:"text-muted-alt",children:"from"}),Object(e.jsx)(ve.a,{disabled:!u,dropdownMatchSelectWidth:!1,dropdownAlign:A.a.bottomLeft,"data-attr":"funnel-header-steps-funnel_from_step-selector",optionLabelProp:"label",value:d.funnel_from_step||0,onChange:function(_){return p(_,d.funnel_to_step)},style:{marginLeft:4,marginRight:4},children:v(f)}),Object(e.jsx)("span",{className:"text-muted-alt",children:"to"}),Object(e.jsx)(ve.a,{disabled:!u,dropdownMatchSelectWidth:!1,dropdownAlign:A.a.bottomLeft,"data-attr":"funnel-header-steps-funnel_to_step-selector",optionLabelProp:"label",value:d.funnel_to_step||Math.max(l-1,1),onChange:function(_){return p(d.funnel_from_step,_)},style:{marginLeft:4,marginRight:4},children:v(y)})]})}function wn(){var s=Object(c.useValues)(I.c),n=s.insightProps,r=s.filters,o=s.activeView,d=Object(c.useValues)(Object(te.a)(n)),l=d.conversionMetrics,u=d.aggregationTargetLabel,i=Object(c.useActions)(Object(ge.a)(n)),j=i.setChartFilter;if(o!==a.E.FUNNELS)return null;var m=[].concat(Te()(r.funnel_viz_type===a.A.Steps?[Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("span",{className:"text-muted-alt mr-1",children:[Object(e.jsx)(Y.a,{title:"Overall conversion rate for all ".concat(u.plural," on the entire funnel."),children:Object(e.jsx)(Se.a,{className:"info-indicator left"})}),"Total conversion rate:"]}),Object(e.jsx)("span",{className:"l4",children:Object(A.sb)(l.totalRate,2,!0)})]})]:[]),Te()(r.funnel_viz_type!==a.A.Trends?[Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("span",{className:"text-muted-alt",children:[Object(e.jsx)(Y.a,{title:"Average (arithmetic mean) of the total time each ".concat(u.singular," spent in the entire funnel."),children:Object(e.jsx)(Se.a,{className:"info-indicator left"})}),"Average time to convert"," "]}),r.funnel_viz_type===a.A.TimeToConvert&&Object(e.jsx)(Ht,{}),Object(e.jsx)("span",{className:"text-muted-alt mr-1",children:":"}),Object(e.jsx)(vt.a,{type:"link",onClick:function(){return j(a.A.TimeToConvert)},disabled:r.funnel_viz_type===a.A.TimeToConvert,children:Object(e.jsx)("span",{className:"l4",children:Object(A.O)(l.averageTime)})})]})]:[]),Te()(r.funnel_viz_type===a.A.Trends?[Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("span",{className:"text-muted-alt",children:"Conversion rate "}),Object(e.jsx)(Ht,{})]})]:[]));return Object(e.jsx)(se.a,{className:"funnel-canvas-label",align:"middle",children:m.map(function(p,f){return Object(e.jsxs)(wt.a.Fragment,{children:[f>0&&Object(e.jsx)("span",{style:{margin:"2px 8px",borderLeft:"1px solid var(--border)",height:14}}),p]},f)})})}var Wn=t("./frontend/src/lib/hooks/usePeriodicRerender.ts"),Gt=3;function zn(){var s=Object(c.useValues)(I.c),n=s.lastRefresh,r=Object(c.useActions)(I.c),o=r.loadResults;return Object(Wn.a)(15e3),Object(e.jsxs)("div",{className:"text-muted-alt",style:{height:32,display:"flex",alignItems:"center"},children:["Computed ",n?Object(je.a)(n).fromNow():"a while ago",Object(e.jsx)("span",{style:{padding:"0 4px"},children:"\u2022"}),Object(e.jsx)(Kt.a,{title:Object(e.jsxs)(e.Fragment,{children:["Insights can be refreshed",Object(e.jsx)("br",{}),"every ",Gt," minutes."]}),children:Object(e.jsx)(vt.a,{size:"small",type:"link",onClick:function(){return o(!0)},disabled:!!n&&Object(je.a)().subtract(Gt-.5,"minutes").isBefore(n),style:{padding:0},children:Object(e.jsx)("span",{style:{fontSize:14},children:"Refresh"})})})]})}var gt=t("./frontend/src/scenes/trends/viz/index.ts"),st=t("./frontend/src/scenes/trends/trendsLogic.ts"),Jt=t("./frontend/src/scenes/insights/views/InsightsTable/InsightsTable.tsx");try{InsightsTable.displayName="InsightsTable",InsightsTable.__docgenInfo={description:"",displayName:"InsightsTable",props:{isLegend:{defaultValue:{value:"false"},description:"Whether this is just a legend instead of standalone insight viz. Default: false.",name:"isLegend",required:!1,type:{name:"boolean"}},embedded:{defaultValue:{value:"false"},description:"Whether this is table is embedded in another card or whether it should be a card of its own. Default: false.",name:"embedded",required:!1,type:{name:"boolean"}},filterKey:{defaultValue:null,description:"Key for the entityFilterLogic",name:"filterKey",required:!0,type:{name:"string"}},canEditSeriesNameInline:{defaultValue:{value:"false"},description:"",name:"canEditSeriesNameInline",required:!1,type:{name:"boolean"}},canCheckUncheckSeries:{defaultValue:{value:"true"},description:"(Un)checking series updates the insight via the API, so it should be disabled if updates aren't desired.",name:"canCheckUncheckSeries",required:!1,type:{name:"boolean"}},isMainInsightView:{defaultValue:{value:"false"},description:"",name:"isMainInsightView",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/views/InsightsTable/index.tsx#InsightsTable"]={docgenInfo:InsightsTable.__docgenInfo,name:"InsightsTable",path:"frontend/src/scenes/insights/views/InsightsTable/index.tsx#InsightsTable"})}catch(s){}var Xt=t("./frontend/src/scenes/insights/insightSceneLogic.tsx"),kn=t("./frontend/src/scenes/insights/views/WorldMap/index.ts"),$n=t("./frontend/src/scenes/insights/views/BoldNumber/index.ts");function Ve(s){var n=s.view,r=Object(c.useValues)(Xt.a),o=r.insightMode,d=Object(c.useValues)(I.c),l=d.insightProps,u=Object(c.useValues)(Object(st.a)(l)),i=u.filters,j=u.loadMoreBreakdownUrl,m=u.breakdownValuesLoading,p=Object(c.useActions)(Object(st.a)(l)),f=p.loadMoreBreakdownValues,y=function(){if(!i.display||i.display===a.j.ActionsLineGraph||i.display===a.j.ActionsLineGraphCumulative||i.display===a.j.ActionsBar)return Object(e.jsx)(gt.b,{});if(i.display===a.j.BoldNumber)return Object(e.jsx)($n.a,{});if(i.display===a.j.ActionsTable)return Object(e.jsx)(c.BindLogic,{logic:st.a,props:{dashboardItemId:null,view:n,filters:null},children:Object(e.jsx)(Jt.b,{embedded:!0,filterKey:"trends_".concat(n),canEditSeriesNameInline:o===a.F.Edit,isMainInsightView:!0})});if(i.display===a.j.ActionsPie)return Object(e.jsx)(gt.c,{});if(i.display===a.j.ActionsBarValue)return Object(e.jsx)(gt.a,{});if(i.display===a.j.WorldMap)return Object(e.jsx)(kn.a,{})};return Object(e.jsxs)(e.Fragment,{children:[(i.actions||i.events)&&Object(e.jsx)("div",{className:i.display!==a.j.ActionsTable&&i.display!==a.j.WorldMap&&i.display!==a.j.BoldNumber?"trends-insights-container":void 0,children:y()}),i.breakdown&&j&&Object(e.jsxs)("div",{className:"my-4 flex flex-col items-center",children:[Object(e.jsxs)("div",{className:"text-muted mb-2",children:["For readability, ",Object(e.jsx)("b",{children:"not all breakdown values are displayed"}),". Click below to load them."]}),Object(e.jsx)(q.LemonButton,{onClick:f,loading:m,size:"small",type:"secondary",children:"Load more breakdown values"})]})]})}try{Ve.displayName="TrendInsight",Ve.__docgenInfo={description:"",displayName:"TrendInsight",props:{view:{defaultValue:null,description:"",name:"view",required:!0,type:{name:"enum",value:[{value:'"TRENDS"'},{value:'"STICKINESS"'},{value:'"LIFECYCLE"'},{value:'"FUNNELS"'},{value:'"RETENTION"'},{value:'"PATHS"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/trends/Trends.tsx#TrendInsight"]={docgenInfo:Ve.__docgenInfo,name:"TrendInsight",path:"frontend/src/scenes/trends/Trends.tsx#TrendInsight"})}catch(s){}var Yn=t("./frontend/src/scenes/retention/RetentionContainer.tsx"),Hn=t("./frontend/src/scenes/paths/Paths.tsx"),ze=t("./frontend/src/scenes/insights/EmptyStates/index.ts");function Gn(){var s=Object(c.useValues)(I.c),n=s.activeView;return n!==a.E.PATHS?null:Object(e.jsx)(se.a,{className:"funnel-canvas-label",align:"middle",children:Object(e.jsx)(wt.a.Fragment,{children:Object(e.jsx)("span",{className:"text-muted-alt",children:"Large path items are shown by default. View smaller items by hovering over a node"})})})}var Qt=t("./frontend/src/lib/components/InsightLegend/InsightLegend.tsx"),Ms=t("./node_modules/core-js/modules/es.object.from-entries.js"),Vs=t("./node_modules/core-js/modules/es.array.flat-map.js"),Bs=t("./node_modules/core-js/modules/es.array.unscopables.flat-map.js"),Jn=t("./frontend/src/lib/components/LemonTable/index.ts"),rt=t("./frontend/src/scenes/funnels/funnelUtils.ts"),Ot=t("./frontend/src/scenes/insights/views/Funnels/funnelStepTableUtils.tsx"),Xn=t("./frontend/src/models/cohortsModel.ts"),Zt=t("./frontend/src/lib/components/LemonCheckbox/index.ts"),qt=t("./frontend/src/lib/components/Lettermark/Lettermark.tsx"),xt=t("./frontend/src/lib/components/LemonRow/index.ts"),Be=t("./frontend/src/scenes/funnels/ValueInspectorButton.tsx"),Qn=t("./frontend/src/lib/colors.ts"),Zn=t("./frontend/src/models/propertyDefinitionsModel.ts"),qn=t("./frontend/src/scenes/insights/utils.tsx");function es(){var s=Object(c.useValues)(I.c),n=s.insightProps,r=Object(te.a)(n),o=Object(c.useValues)(r),d=o.insightLoading,l=o.filters,u=o.steps,i=o.flattenedBreakdowns,j=o.hiddenLegendKeys,m=o.visibleStepsWithConversionMetrics,p=o.isOnlySeries,f=Object(c.useActions)(r),y=f.setHiddenById,v=f.toggleVisibilityByBreakdown,g=f.openPersonsModalForSeries,_=Object(c.useValues)(Xn.a),O=_.cohorts,U=Object(c.useValues)(Zn.a),E=U.formatPropertyValueForDisplay,W=i==null?void 0:i.every(function(b){return!j[Object(rt.l)(b.breakdown_value)]}),P=[{children:[{title:p?"Breakdown":Object(e.jsx)(Zt.a,{checked:W||(i!=null&&i.some(function(b){return!j[Object(rt.l)(b.breakdown_value)]})?"indeterminate":!1),onChange:function(){y(Object.fromEntries(m.flatMap(function(){return i.map(function(h){return[Object(rt.l)(h.breakdown_value),W]})})))},label:Object(e.jsx)("span",{className:"font-bold",children:"Breakdown"}),size:"small"}),dataIndex:"breakdown_value",render:function(h,T){var D,M=((D=T.breakdown_value)===null||D===void 0?void 0:D.length)==1?T.breakdown_value[0]:T.breakdown_value,V=Object(qn.d)(O,E,M,T.breakdown,l.breakdown_type);return p?Object(e.jsx)("span",{className:"font-medium",children:V}):Object(e.jsx)(Zt.a,{checked:!j[Object(rt.l)(T.breakdown_value)],onChange:function(){return v(T.breakdown_value)},label:V})}},{title:Object(e.jsxs)(e.Fragment,{children:["Total",Object(e.jsx)("br",{}),"conversion"]}),render:function(h,T){var D,M;return Object(A.sb)((D=T==null||(M=T.conversionRates)===null||M===void 0?void 0:M.total)!==null&&D!==void 0?D:0,2,!0)},align:"right"}]}].concat(Te()(u.map(function(b,h){return{title:Object(e.jsx)(xt.a,{icon:Object(e.jsx)(qt.a,{name:h+1,color:qt.b.Gray}),style:{font:"inherit",padding:0},size:"small",children:Object(e.jsx)(Yt.a,{filter:Object(Ot.a)(b)})}),children:[{title:h===0?"Entered":"Converted",render:function(D,M){var V,F,C=(V=M.steps)===null||V===void 0?void 0:V[h];return C&&Object(e.jsx)(Be.a,{onClick:function(){return g({step:b,series:C,converted:!0})},style:{padding:0},children:Object(A.P)((F=C.count)!==null&&F!==void 0?F:0)})},align:"right"}].concat(Te()(h===0?[]:[{title:"Dropped\xA0off",render:function(D,M){var V,F,C=(V=M.steps)===null||V===void 0?void 0:V[h];return C&&Object(e.jsx)(Be.a,{onClick:function(){return g({step:b,series:C,converted:!1})},style:{padding:0},children:Object(A.P)((F=C.droppedOffFromPrevious)!==null&&F!==void 0?F:0)})},align:"right"}]),[{title:Object(e.jsxs)(e.Fragment,{children:["Conversion",Object(e.jsx)("br",{}),"so\xA0far"]}),render:function(D,M){var V,F,C,z,k,S,R=Object(Ot.b)(M,b.order);return R!=null&&R.total?Object(e.jsx)(xt.a,{className:"significance-highlight",tooltip:"Significantly different from other breakdown values",icon:Object(e.jsx)(_e.IconFlag,{}),size:"small",children:Object(A.sb)((V=(F=M.steps)===null||F===void 0||(C=F[b.order])===null||C===void 0?void 0:C.conversionRates.total)!==null&&V!==void 0?V:0,2,!0)}):Object(A.sb)((z=(k=M.steps)===null||k===void 0||(S=k[b.order])===null||S===void 0?void 0:S.conversionRates.total)!==null&&z!==void 0?z:0,2,!0)},align:"right"}],Te()(h===0?[]:[{title:Object(e.jsxs)(e.Fragment,{children:["Conversion",Object(e.jsx)("br",{}),"from\xA0previous"]}),render:function(D,M){var V,F,C,z,k,S,R=Object(Ot.b)(M,b.order);return!(R!=null&&R.total)&&R!==null&&R!==void 0&&R.fromPrevious?Object(e.jsx)(xt.a,{className:"significance-highlight",tooltip:"Significantly different from other breakdown values",icon:Object(e.jsx)(_e.IconFlag,{}),size:"small",children:Object(A.sb)((V=(F=M.steps)===null||F===void 0||(C=F[b.order])===null||C===void 0?void 0:C.conversionRates.fromPrevious)!==null&&V!==void 0?V:0,2,!0)}):Object(A.sb)((z=(k=M.steps)===null||k===void 0||(S=k[b.order])===null||S===void 0?void 0:S.conversionRates.fromPrevious)!==null&&z!==void 0?z:0,2,!0)},align:"right"},{title:Object(e.jsxs)(e.Fragment,{children:["Median",Object(e.jsx)("br",{}),"time"]}),render:function(D,M){var V,F;return((V=M.steps)===null||V===void 0||(F=V[b.order])===null||F===void 0?void 0:F.median_conversion_time)!=null?Object(A.O)(M.steps[b.order].median_conversion_time,3):"\u2013"},align:"right",width:0,className:"whitespace-nowrap"},{title:Object(e.jsxs)(e.Fragment,{children:["Average",Object(e.jsx)("br",{}),"time"]}),render:function(D,M){var V,F;return((V=M.steps)===null||V===void 0||(F=V[b.order])===null||F===void 0?void 0:F.average_conversion_time)!=null?Object(A.O)(M.steps[b.order].average_conversion_time,3):"\u2013"},align:"right",width:0,className:"whitespace-nowrap"}]))}})));return Object(e.jsx)(Jn.a,{dataSource:i,columns:P,loading:d,rowKey:"breakdownIndex",rowStatus:function(h){return h.significant?"highlighted":null},rowRibbonColor:function(h){var T;return Object(Qn.d)((T=h==null?void 0:h.breakdownIndex)!==null&&T!==void 0?T:0)}})}var ts=t("./frontend/src/lib/components/Animation/Animation.tsx"),ns=t("./frontend/src/lib/animations/animations.ts"),ss=t("./node_modules/@ant-design/icons/es/icons/CommentOutlined.js"),rs=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/FunnelCorrelation.scss"),en=t.n(rs),yt={};yt.insert="head",yt.singleton=!1;var Ks=nt()(en.a,yt),Us=en.a.locals||{},os=t("./node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),as=t("./frontend/src/lib/components/PayCard/PayCard.tsx"),is=t("./frontend/src/scenes/PreflightCheck/preflightLogic.tsx"),ws=t("./node_modules/core-js/modules/es.number.is-integer.js"),Ws=t("./node_modules/core-js/modules/es.number.constructor.js"),zs=t("./node_modules/core-js/modules/es.number.to-fixed.js"),ks=t("./node_modules/core-js/modules/es.string.split.js"),ls=t("./node_modules/antd/es/spin/index.js"),_t=t("./node_modules/antd/es/table/index.js"),cs=t("./node_modules/antd/lib/table/Column.js"),me=t.n(cs),tn=t("./node_modules/@ant-design/icons/es/icons/RiseOutlined.js"),nn=t("./node_modules/@ant-design/icons/es/icons/FallOutlined.js"),sn=t("./node_modules/@ant-design/icons/es/icons/EllipsisOutlined.js"),ds=t("./node_modules/antd/lib/checkbox/Checkbox.js"),ot=t.n(ds),Ke=t("./frontend/src/lib/components/PropertyKeyInfo.tsx"),us=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/FunnelCorrelationTable.scss"),rn=t.n(us),Ct={};Ct.insert="head",Ct.singleton=!1;var $s=nt()(rn.a,Ct),Ys=rn.a.locals||{},js=t("./frontend/src/lib/components/VisibilitySensor/visibilitySensorLogic.tsx");function ke(s){var n=s.id,r=s.offset,o=s.children,d=Object(c.useActions)(Object(js.a)({id:n,offset:r})),l=d.scrolling,u=Object(re.useRef)(null);return Object(re.useEffect)(function(){var i=u.current;return document.addEventListener("scroll",function(){return i&&l(i)}),function(){return document.removeEventListener("scroll",function(){return i&&l(i)})}},[u.current]),Object(e.jsx)("div",{ref:u,children:o})}try{ke.displayName="VisibilitySensor",ke.__docgenInfo={description:"",displayName:"VisibilitySensor",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},offset:{defaultValue:null,description:"",name:"offset",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/components/VisibilitySensor/VisibilitySensor.tsx#VisibilitySensor"]={docgenInfo:ke.__docgenInfo,name:"VisibilitySensor",path:"frontend/src/lib/components/VisibilitySensor/VisibilitySensor.tsx#VisibilitySensor"})}catch(s){}var on=t("./frontend/src/lib/components/Popup/Popup.tsx"),fs=t("./node_modules/antd/es/modal/index.js"),ms=t("./node_modules/@ant-design/icons/es/icons/CheckCircleFilled.js"),bs=t("./node_modules/@ant-design/icons/es/icons/MinusCircleOutlined.js"),ps=t("./node_modules/@ant-design/icons/es/icons/CloseCircleOutlined.js"),vs=t("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/CorrelationMatrix.scss"),an=t.n(vs),Et={};Et.insert="head",Et.singleton=!1;var Hs=nt()(an.a,Et),Gs=an.a.locals||{},hs=t("./frontend/src/lib/components/Spinner/Spinner.tsx"),ln=t("./frontend/src/lib/components/Link.tsx"),gs=t("./frontend/src/lib/components/InlineMessage/InlineMessage.tsx");function Os(){var s=Object(c.useValues)(I.c),n=s.insightProps,r=Object(te.a)(n),o=Object(c.useValues)(r),d=o.correlationsLoading,l=o.funnelCorrelationDetails,u=o.parseDisplayNameForCorrelation,i=o.correlationMatrixAndScore,j=Object(c.useActions)(r),m=j.setFunnelCorrelationDetails,p=j.openCorrelationPersonsModal,f=(l==null?void 0:l.result_type)===a.w.Events?"event":"property",y=(l==null?void 0:l.result_type)===a.w.Events?"performed event":"have property",v=Object(e.jsx)(e.Fragment,{});if(l){var g=u(l),_=g.first_value,O=g.second_value;v=Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Ke.a,{value:_}),O!==void 0&&Object(e.jsxs)(e.Fragment,{children:[" :: ",Object(e.jsx)(Ke.a,{value:O,disablePopover:!0})]})]})}var U=i.correlationScore,E=i.truePositive,W=i.falsePositive,P=i.trueNegative,b=i.falseNegative,h=i.correlationScoreStrength,T=h==="strong"?Object(e.jsx)(ms.a,{style:{color:"var(--success)"}}):h==="moderate"?Object(e.jsx)(bs.a,{style:{color:"var(--warning)"}}):Object(e.jsx)(ps.a,{style:{color:"var(--danger)"}}),D=function(){return m(null)};return Object(e.jsx)(fs.a,{className:"correlation-matrix",visible:!!l,onCancel:D,destroyOnClose:!0,footer:Object(e.jsx)(vt.a,{onClick:D,children:"Dismiss"}),width:600,title:"Correlation details",children:Object(e.jsx)("div",{className:"correlation-table-wrapper",children:d?Object(e.jsx)("div",{className:"mt-4 text-center",children:Object(e.jsx)(hs.a,{className:"text-4xl"})}):l?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("p",{className:"text-muted-alt mb-4",children:["The table below displays the correlation details for users who ",y," ",Object(e.jsx)("b",{children:v}),"."]}),Object(e.jsxs)("table",{children:[Object(e.jsxs)("thead",{children:[Object(e.jsx)("tr",{className:"table-title",children:Object(e.jsx)("td",{colSpan:3,children:"Results matrix"})}),Object(e.jsxs)("tr",{children:[Object(e.jsx)("td",{children:(l==null?void 0:l.result_type)===a.w.Events?"Performed event":"Has property"}),Object(e.jsx)("td",{children:"Success"}),Object(e.jsx)("td",{children:"Dropped off"})]})]}),Object(e.jsxs)("tbody",{children:[Object(e.jsxs)("tr",{children:[Object(e.jsx)("td",{className:"horizontal-header",children:"Yes"}),Object(e.jsxs)("td",{children:[Object(e.jsx)(Y.a,{title:"True positive (TP) - Percentage of users who ".concat(y," and completed the funnel."),children:Object(e.jsx)("div",{className:"percentage",children:E?Object(A.sb)(E/(E+W)):"0.00%"})}),E===0?"0 users":Object(e.jsx)(ln.a,{onClick:function(){p(l,!0)},children:Object(A.tb)(E,"user",void 0,!0)})]}),Object(e.jsxs)("td",{children:[Object(e.jsx)("div",{className:"percentage",children:Object(e.jsx)(Y.a,{title:"False negative (FN) - Percentage of users who ".concat(y," and did not complete the funnel."),children:b?Object(A.sb)(b/(b+P)):"0.00%"})}),b===0?"0 users":Object(e.jsx)(ln.a,{onClick:function(){p(l,!1)},children:Object(A.tb)(b,"user",void 0,!0)})]})]}),Object(e.jsxs)("tr",{children:[Object(e.jsx)("td",{className:"horizontal-header",children:"No"}),Object(e.jsxs)("td",{children:[Object(e.jsx)("div",{className:"percentage",children:Object(e.jsx)(Y.a,{title:"False positive (FP) - Percentage of users who did not ".concat(y," and completed the funnel."),children:W?Object(A.sb)(W/(E+W)):"0.00%"})}),Object(A.tb)(W,"user",void 0,!0)]}),Object(e.jsxs)("td",{children:[Object(e.jsx)("div",{className:"percentage",children:Object(e.jsx)(Y.a,{title:"True negative (TN) - Percentage of users who did not ".concat(y," and did not complete the funnel."),children:P?Object(A.sb)(P/(b+P)):"0.00%"})}),Object(A.tb)(P,"user",void 0,!0)]})]}),Object(e.jsxs)("tr",{children:[Object(e.jsx)("td",{className:"horizontal-header"}),Object(e.jsx)("td",{children:Object(e.jsx)("b",{children:"100%"})}),Object(e.jsx)("td",{children:Object(e.jsx)("b",{children:"100%"})})]})]})]}),Object(e.jsxs)("div",{className:"mt-4 text-center",children:[Object(A.i)((l==null?void 0:l.result_type)||"")," ",Object(e.jsx)("b",{children:v})," ","has a"," ",(l==null?void 0:l.correlation_type)===a.x.Success?Object(e.jsxs)("b",{className:"text-success",children:["positive"," ",Object(e.jsx)(Y.a,{title:"Positive correlation means this ".concat(f," is correlated with a successful conversion."),children:Object(e.jsx)(Se.a,{className:"cursor-pointer"})})]}):Object(e.jsxs)("b",{className:"text-danger",children:["negative"," ",Object(e.jsx)(Y.a,{title:"Negative correlation means this ".concat(f," is correlated with an unsuccessful conversion (user dropped off)."),children:Object(e.jsx)(Se.a,{className:"cursor-pointer"})})]})," ","correlation score of"," ",Object(e.jsx)("b",{style:{color:h==="strong"?"var(--success)":h==="moderate"?"var(--warning)":"var(--danger)"},children:Object(e.jsx)(Y.a,{title:"This ".concat(f," has ").concat(h," correlation."),children:Object(e.jsxs)("span",{style:{cursor:"pointer"},children:[T," ",U.toFixed(3)]})})})]})]}):Object(e.jsx)("div",{children:Object(e.jsx)(gs.a,{type:"danger",children:"We could not load the details for this correlation value. Please recreate your funnel and try again."})})})})}function xs(){var s=Object(c.useValues)(I.c),n=s.insightProps,r=Object(te.a)(n),o=Object(c.useValues)(r),d=o.steps,l=o.correlationValues,u=o.correlationTypes,i=o.eventHasPropertyCorrelations,j=o.eventWithPropertyCorrelationsValues,m=o.parseDisplayNameForCorrelation,p=o.correlationsLoading,f=o.eventWithPropertyCorrelationsLoading,y=o.nestedTableExpandedKeys,v=o.correlationPropKey,g=o.filters,_=o.aggregationTargetLabel,O=Object(c.useActions)(r),U=O.setCorrelationTypes,E=O.loadEventWithPropertyCorrelations,W=O.addNestedTableExpandedKey,P=O.removeNestedTableExpandedKey,b=O.openCorrelationPersonsModal,h=O.loadCorrelations,T=Object(c.useActions)(pt.e),D=T.reportCorrelationInteraction;Object(re.useEffect)(function(){h({})},[g]);var M=function(S){u?u.includes(S)?U(u.filter(function(R){return R!==S})):U([].concat(Te()(u),[S])):U([S])},V=function(S){var R=function(ct){return ct<10&&!Number.isInteger(ct)?ct.toFixed(1):ct.toFixed()},ne=S.correlation_type===a.x.Success,X=m(S),De=X.first_value,it=X.second_value;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("h4",{children:[ne?Object(e.jsx)(tn.a,{style:{color:"green"}}):Object(e.jsx)(nn.a,{style:{color:"red"}})," ",Object(e.jsx)(Ke.a,{value:De}),it!==void 0&&Object(e.jsxs)(e.Fragment,{children:[" :: ",Object(e.jsx)(Ke.a,{value:it,disablePopover:!0})]})]}),Object(e.jsxs)("div",{children:[Object(A.i)(_.plural)," ",g.aggregation_group_type_index!=null?"that":"who"," converted were"," ",Object(e.jsx)("mark",{children:Object(e.jsxs)("b",{children:[R(S.odds_ratio),"x ",ne?"more":"less"," likely"]})})," ","to"," ",S.result_type===a.w.EventWithProperties?"have this event property":"do this event"]}),Object(e.jsx)(Os,{})]})},F=function(S){return Object(e.jsx)(Be.a,{onClick:function(){b(S,!0)},children:S.success_count})},C=function(S){return Object(e.jsx)(Be.a,{onClick:function(){b(S,!1)},children:S.failure_count})},z=function(S){return f?Object(e.jsxs)("div",{className:"nested-properties-loading",children:[Object(e.jsx)(ls.a,{}),Object(e.jsx)("h3",{children:"Loading correlation results"}),Object(e.jsx)("p",{children:"This process can take up to 20 seconds. "})]}):Object(e.jsxs)("div",{children:[Object(e.jsx)("h4",{style:{paddingLeft:16},children:"Correlated properties"}),Object(e.jsxs)(_t.a,{dataSource:j[S],rowKey:function(ne){return ne.event.event},className:"nested-properties-table",scroll:{x:"max-content"},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(ne,X){return D(a.w.EventWithProperties,"pagination change",{page:ne,page_size:X})}},children:[Object(e.jsx)(me.a,{title:"Property",render:function(ne,X){return V(X)},align:"left"},"eventName"),Object(e.jsx)(me.a,{title:"Completed",render:function(ne,X){return F(X)},width:90,align:"center"},"success_count"),Object(e.jsx)(me.a,{title:"Dropped off",render:function(ne,X){return C(X)},width:120,align:"center"},"failure_count"),Object(e.jsx)(me.a,{title:"",render:function(ne,X){return Object(e.jsx)(cn,{record:X})},align:"center",width:30},"actions")]})]})};return d.length>1?Object(e.jsx)(ke,{id:v,offset:152,children:Object(e.jsxs)("div",{className:"funnel-correlation-table",children:[Object(e.jsxs)("span",{className:"funnel-correlation-header",children:[Object(e.jsxs)("span",{className:"table-header",children:[Object(e.jsx)(_e.IconSelectEvents,{style:{marginRight:4,fontSize:24,opacity:.5}}),"CORRELATED EVENTS"]}),Object(e.jsxs)("span",{className:"table-options",children:[Object(e.jsx)("p",{className:"title",children:"CORRELATION"}),Object(e.jsx)("div",{className:"tab-btn ant-btn",style:{paddingTop:"1px",paddingBottom:"1px",borderTopRightRadius:0,borderBottomRightRadius:0},onClick:function(){return M(a.x.Success)},children:Object(e.jsx)(ot.a,{checked:u.includes(a.x.Success),style:{pointerEvents:"none"},children:"Success"})}),Object(e.jsx)("div",{className:"tab-btn ant-btn",style:{marginRight:"8px",paddingTop:"1px",paddingBottom:"1px",borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:function(){return M(a.x.Failure)},children:Object(e.jsx)(ot.a,{checked:u.includes(a.x.Failure),style:{pointerEvents:"none"},children:"Dropoff"})})]})]}),Object(e.jsxs)(_t.a,{dataSource:l,loading:p,size:"small",scroll:{x:"max-content"},rowKey:function(S){return S.event.event},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(){return D(a.w.Events,"load more")}},expandable:{expandedRowRender:function(S){return z(S.event.event)},expandedRowKeys:y,rowExpandable:function(){return g.aggregation_group_type_index===void 0},expandIcon:function(S){var R=S.expanded,ne=S.onExpand,X=S.record,De=S.expandable;return De?R?Object(e.jsx)(Y.a,{title:"Collapse",children:Object(e.jsx)("div",{style:{cursor:"pointer",opacity:.5,fontSize:24},onClick:function(lt){P(X.event.event),ne(X,lt)},children:Object(e.jsx)(_e.IconUnfoldLess,{})})}):Object(e.jsx)(Y.a,{title:"Expand to see correlated properties for this event",children:Object(e.jsx)("div",{style:{cursor:"pointer",opacity:.5,fontSize:24},onClick:function(lt){!i(X.event.event)&&E(X.event.event),W(X.event.event),ne(X,lt)},children:Object(e.jsx)(_e.IconUnfoldMore,{})})}):null}},children:[Object(e.jsx)(me.a,{title:"Event",render:function(S,R){return V(R)},align:"left",ellipsis:!0},"eventName"),Object(e.jsx)(me.a,{title:Object(e.jsxs)("div",{className:"flex items-center",children:["Completed",Object(e.jsx)(Y.a,{title:"".concat(Object(A.i)(_.plural)," ").concat(g.aggregation_group_type_index!=null?"that":"who"," performed the event and completed the entire funnel."),children:Object(e.jsx)(Se.a,{className:"column-info"})})]}),render:function(S,R){return F(R)},width:90,align:"center"},"success_count"),Object(e.jsx)(me.a,{title:Object(e.jsxs)("div",{className:"flex items-center",children:["Dropped off",Object(e.jsx)(Y.a,{title:Object(e.jsxs)(e.Fragment,{children:[Object(A.i)(_.plural)," ",g.aggregation_group_type_index!=null?"that":"who"," ","performed the event and did ",Object(e.jsx)("b",{children:"not complete"})," the entire funnel."]}),children:Object(e.jsx)(Se.a,{className:"column-info"})})]}),render:function(S,R){return C(R)},width:120,align:"center"},"failure_count"),Object(e.jsx)(me.a,{title:"",render:function(S,R){return Object(e.jsx)(cn,{record:R})},width:30},"actions")]})]})}):null}var cn=function(n){var r=n.record,o=Object(c.useValues)(I.c),d=o.insightProps,l=Object(te.a)(d),u=Object(c.useActions)(l),i=u.excludeEventPropertyFromProject,j=u.excludeEventFromProject,m=u.setFunnelCorrelationDetails,p=Object(c.useValues)(l),f=p.isEventPropertyExcluded,y=p.isEventExcluded,v=r.event.event.split("::"),g=Object(re.useState)(!1),_=K()(g,2),O=_[0],U=_[1];return Object(e.jsx)(se.a,{style:{justifyContent:"flex-end"},children:Object(e.jsx)(on.a,{visible:O,actionable:!0,onClickOutside:function(){return U(!1)},overlay:Object(e.jsxs)(e.Fragment,{children:[r.result_type===a.w.Events&&Object(e.jsx)(fe.a,{onClick:function(){return m(r)},fullWidth:!0,status:"stealth",children:"View correlation details"}),Object(e.jsx)(fe.a,{disabled:r.result_type===a.w.EventWithProperties?f(v[1]):y(v[0]),onClick:function(){return r.result_type===a.w.EventWithProperties?i(v[0],v[1]):j(v[0])},fullWidth:!0,title:"Remove this event from any correlation analysis report in this project.",status:"stealth",children:"Exclude event from project"})]}),children:Object(e.jsx)(fe.a,{status:"stealth",onClick:function(){return U(!O)},children:Object(e.jsx)(sn.a,{style:{color:"var(--primary)",fontSize:24},className:"insight-dropdown-actions"})})})})},ys=t("./frontend/src/lib/components/PropertyNamesSelect/PropertyNamesSelect.tsx");function _s(){var s=Object(c.useValues)(I.c),n=s.insightProps,r=Object(te.a)(n),o=Object(c.useValues)(r),d=o.steps,l=o.propertyCorrelationValues,u=o.propertyCorrelationTypes,i=o.excludedPropertyNames,j=o.parseDisplayNameForCorrelation,m=o.propertyCorrelationsLoading,p=o.inversePropertyNames,f=o.propertyNames,y=o.correlationPropKey,v=o.allProperties,g=o.filters,_=o.aggregationTargetLabel,O=Object(c.useActions)(r),U=O.setPropertyCorrelationTypes,E=O.setPropertyNames,W=O.openCorrelationPersonsModal,P=O.loadPropertyCorrelations,b=Object(c.useActions)(pt.e),h=b.reportCorrelationInteraction;Object(re.useEffect)(function(){f.length===0&&E(v),P({})},[g]);var T=function(C){u?u.includes(C)?U(u.filter(function(z){return z!==C})):U([].concat(Te()(u),[C])):U([C])},D=function(C){return Object(e.jsx)(Be.a,{onClick:function(){W(C,!0)},children:C.success_count})},M=function(C){return Object(e.jsx)(Be.a,{onClick:function(){W(C,!1)},children:C.failure_count})},V=function(C){var z=function(De){return De<10&&!Number.isInteger(De)?De.toFixed(1):De.toFixed()},k=C.correlation_type===a.x.Success,S=j(C),R=S.first_value,ne=S.second_value;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("h4",{children:[k?Object(e.jsx)(tn.a,{style:{color:"green"}}):Object(e.jsx)(nn.a,{style:{color:"red"}})," ",Object(e.jsx)(Ke.a,{value:R}),ne!==void 0&&Object(e.jsxs)(e.Fragment,{children:[" :: ",Object(e.jsx)(Ke.a,{value:ne,disablePopover:!0})]})]}),Object(e.jsxs)("div",{children:[Object(A.i)(_.plural)," ",g.aggregation_group_type_index!=null?"that":"who"," converted were"," ",Object(e.jsx)("mark",{children:Object(e.jsxs)("b",{children:[z(C.odds_ratio),"x ",k?"more":"less"," likely"]})})," ","to have this property value"]})]})};return d.length>1?Object(e.jsx)(ke,{offset:150,id:"".concat(y,"-properties"),children:Object(e.jsxs)("div",{className:"funnel-correlation-table",children:[Object(e.jsxs)(se.a,{className:"funnel-correlation-header",children:[Object(e.jsxs)(oe.a,{className:"table-header",children:[Object(e.jsx)(_e.IconSelectProperties,{style:{marginRight:4,opacity:.5,fontSize:24}}),"CORRELATED PROPERTIES"]}),Object(e.jsxs)(oe.a,{className:"table-options",children:[Object(e.jsx)(se.a,{style:{display:"contents"},children:v.length>0&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("p",{className:"title",children:"PROPERTIES "}),Object(e.jsx)(ys.a,{value:new Set(f),onChange:function(C){return E(C)},allProperties:p(i||[])})]})}),Object(e.jsxs)(se.a,{style:{display:"contents"},children:[Object(e.jsx)("p",{className:"title",style:{marginLeft:8},children:"CORRELATION"}),Object(e.jsx)("div",{className:"tab-btn ant-btn",style:{paddingTop:"1px",paddingBottom:"1px",borderTopRightRadius:0,borderBottomRightRadius:0},onClick:function(){return T(a.x.Success)},children:Object(e.jsx)(ot.a,{checked:u.includes(a.x.Success),style:{pointerEvents:"none"},children:"Success"})}),Object(e.jsx)("div",{className:"tab-btn ant-btn",style:{marginRight:"8px",paddingTop:"1px",paddingBottom:"1px",borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:function(){return T(a.x.Failure)},children:Object(e.jsx)(ot.a,{checked:u.includes(a.x.Failure),style:{pointerEvents:"none"},children:"Dropoff"})})]})]})]}),Object(e.jsxs)(_t.a,{dataSource:l,loading:m,scroll:{x:"max-content"},size:"small",rowKey:function(C){return C.event.event},pagination:{pageSize:5,hideOnSinglePage:!0,onChange:function(C,z){return h(a.w.Properties,"pagination change",{page:C,page_size:z})}},children:[Object(e.jsx)(me.a,{title:"".concat(Object(A.i)(_.singular)," property"),render:function(C,z){return V(z)},align:"left"},"propertName"),Object(e.jsx)(me.a,{title:Object(e.jsxs)("div",{className:"flex items-center",children:["Completed",Object(e.jsx)(Y.a,{title:"".concat(Object(A.i)(_.plural)," ").concat(g.aggregation_group_type_index!=null?"that":"who"," have this property and completed the entire funnel."),children:Object(e.jsx)(Se.a,{className:"column-info"})})]}),render:function(C,z){return D(z)},width:90,align:"center"},"success_count"),Object(e.jsx)(me.a,{title:Object(e.jsxs)("div",{className:"flex items-center",children:["Dropped off",Object(e.jsx)(Y.a,{title:Object(e.jsxs)(e.Fragment,{children:[Object(A.i)(_.plural)," ",g.aggregation_group_type_index!=null?"that":"who"," have this property and did ",Object(e.jsx)("b",{children:"not complete"})," the entire funnel."]}),children:Object(e.jsx)(Se.a,{className:"column-info"})})]}),render:function(C,z){return M(z)},width:120,align:"center"},"failure_count"),Object(e.jsx)(me.a,{title:"",render:function(C,z){return Object(e.jsx)(Cs,{record:z})},align:"center",width:30},"actions")]})]})}):null}var Cs=function(n){var r=n.record,o=Object(c.useValues)(I.c),d=o.insightProps,l=Object(te.a)(d),u=Object(c.useActions)(l),i=u.excludePropertyFromProject,j=u.setFunnelCorrelationDetails,m=Object(c.useValues)(l),p=m.isPropertyExcludedFromProject,f=(r.event.event||"").split("::")[0],y=Object(re.useState)(!1),v=K()(y,2),g=v[0],_=v[1];return Object(e.jsx)(se.a,{style:{justifyContent:"flex-end"},children:Object(e.jsx)(on.a,{visible:g,actionable:!0,onClickOutside:function(){return _(!1)},overlay:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(fe.a,{onClick:function(){return j(r)},fullWidth:!0,status:"stealth",children:"View correlation details"}),Object(e.jsx)(fe.a,{disabled:p(f),onClick:function(){return i(f)},fullWidth:!0,title:"Remove this property from any correlation analysis report in this project.",status:"stealth",children:"Exclude property from project"})]}),children:Object(e.jsx)(fe.a,{status:"stealth",onClick:function(){return _(!g)},children:Object(e.jsx)(sn.a,{style:{color:"var(--primary)",fontSize:24},className:"insight-dropdown-actions"})})})})},Es=function(){var n,r=Object(c.useValues)(I.c),o=r.insightProps,d=Object(c.useValues)(Object(te.a)(o)),l=d.isSkewed,u=d.steps,i=d.correlationFeedbackHidden,j=d.correlationDetailedFeedbackVisible,m=d.correlationFeedbackRating,p=d.correlationAnalysisAvailable,f=d.aggregationTargetLabel,y=Object(c.useActions)(Object(te.a)(o)),v=y.sendCorrelationAnalysisFeedback,g=y.hideSkewWarning,_=y.hideCorrelationAnalysisFeedback,O=y.setCorrelationFeedbackRating,U=y.setCorrelationDetailedFeedback,E=Object(c.useValues)(is.a),W=E.preflight,P=Object(re.useRef)(null);return u.length<=1?null:!p&&!(W!=null&&(n=W.instance_preferences)!==null&&n!==void 0&&n.disable_paid_fs)?Object(e.jsx)(as.a,{identifier:a.d.CORRELATION_ANALYSIS,title:"Get a deeper understanding of why your ".concat(f.plural," are not converting"),caption:"Correlation analysis automatically finds signals for why ".concat(f.plural," are converting or dropping off.")}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h2",{style:{margin:"1rem 0"},children:"Correlation analysis"}),Object(e.jsxs)("div",{className:"funnel-correlation",children:[l&&Object(e.jsxs)(he.a,{className:"skew-warning",children:[Object(e.jsxs)("h4",{children:[Object(e.jsx)(_e.IconFeedbackWarning,{style:{fontSize:24,marginRight:4,color:"var(--warning)"}})," ","Adjust your funnel definition to improve correlation analysis",Object(e.jsx)(os.a,{className:"close-button",onClick:g})]}),Object(e.jsxs)("div",{children:[Object(e.jsx)("b",{children:"Tips for adjusting your funnel:"}),Object(e.jsxs)("ol",{children:[Object(e.jsx)("li",{children:"Adjust your first funnel step to be more specific. For example, choose a page or an event that occurs less frequently."}),Object(e.jsx)("li",{children:"Choose an event that happens more frequently for subsequent funnels steps."})]})]})]}),Object(e.jsx)(xs,{}),!i&&Object(e.jsxs)("div",{className:"border rounded p-4 space-y-2 mt-4",children:[Object(e.jsxs)("div",{className:"flex items-center justify-between",children:[Object(e.jsxs)("h4",{className:"text-muted-alt",children:[Object(e.jsx)(ss.a,{style:{marginRight:4}}),"Was this correlation analysis report useful?"]}),Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[!!m&&Object(e.jsx)("i",{className:"text-success mr-2",children:"Thanks for your feedback!"}),[[5,"\u{1F60D}"],[4,"\u{1F600}"],[3,"\u{1F634}"],[2,"\u{1F614}"],[1,"\u{1F44E}"]].map(function(b,h){return Object(e.jsx)(q.LemonButton,{active:m===b[0],onClick:function(){m===b[0]?O(0):(O(b[0]),setTimeout(function(){var D;return(D=P.current)===null||D===void 0?void 0:D.focus()},100))},children:b[1]},h)}),Object(e.jsx)(q.LemonButton,{icon:Object(e.jsx)(_e.IconClose,{}),onClick:_,status:"stealth"})]})]}),j?Object(e.jsx)(e.Fragment,{children:Object(e.jsxs)("form",{onSubmit:v,className:"space-y-2",children:[Object(e.jsx)(q.LemonTextArea,{onBlur:function(h){return U(h.target.value)},placeholder:"Optional. Help us by sharing details around your experience...",ref:P,onPressCmdEnter:function(){var h;(h=P.current)===null||h===void 0||h.blur(),v()}}),Object(e.jsx)("div",{className:"flex justify-end",children:Object(e.jsx)(q.LemonButton,{"data-attr":"correlation-analysis-share-feedback",type:"primary",htmlType:"submit",children:"Share feedback"})})]})}):null]}),Object(e.jsx)(_s,{})]})]})},Ps=t("./frontend/src/scenes/funnels/Funnel.tsx");function Ss(){var s=Object(c.useValues)(I.c),n=s.insightProps,r=Object(c.useValues)(Object(te.a)(n)),o=r.isValidFunnel,d=r.insightLoading,l=r.areFiltersValid,u=o&&l||d;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)("div",{className:Object(mt.a)("funnel-insights-container",{"non-empty-state":u}),children:Object(e.jsx)(Ps.a,{})})})}var Ts=t("./frontend/src/lib/components/ExportButton/ExportButton.tsx"),Fs=t("./frontend/src/lib/components/AlertMessage/index.ts"),Ae,dn=(Ae={},N()(Ae,"".concat(a.E.TRENDS),Object(e.jsx)(Ve,{view:a.E.TRENDS})),N()(Ae,"".concat(a.E.STICKINESS),Object(e.jsx)(Ve,{view:a.E.STICKINESS})),N()(Ae,"".concat(a.E.LIFECYCLE),Object(e.jsx)(Ve,{view:a.E.LIFECYCLE})),N()(Ae,"".concat(a.E.FUNNELS),Object(e.jsx)(Ss,{})),N()(Ae,"".concat(a.E.RETENTION),Object(e.jsx)(Yn.a,{})),N()(Ae,"".concat(a.E.PATHS),Object(e.jsx)(Hn.a,{})),Ae);function at(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{disableHeader:!1,disableTable:!1,disableCorrelationTable:!1,disableLastComputation:!1},n=s.disableHeader,r=s.disableTable,o=s.disableCorrelationTable,d=s.disableLastComputation,l=Object(c.useValues)(Xt.a),u=l.insightMode,i=Object(c.useValues)(I.c),j=i.insightProps,m=i.canEditInsight,p=i.insightLoading,f=i.activeView,y=i.loadedView,v=i.filters,g=i.showTimeoutMessage,_=i.showErrorMessage,O=i.exporterResourceParams,U=i.isUsingSessionAnalysis,E=Object(c.useValues)(Object(te.a)(j)),W=E.areFiltersValid,P=E.isValidFunnel,b=E.areExclusionFiltersValid,h=E.correlationAnalysisAvailable,T=function(){if(f!==y||p&&!g)return Object(e.jsx)("div",{className:"text-center",children:Object(e.jsx)(ts.a,{type:ns.a.LaptopHog})});if(y===a.E.FUNNELS){if(!W)return Object(e.jsx)(ze.b,{actionable:u===a.F.Edit||r});if(!b)return Object(e.jsx)(ze.a,{});if(!P&&!p)return Object(e.jsx)(ze.c,{})}return _?Object(e.jsx)(ze.d,{}):g?Object(e.jsx)(ze.e,{isLoading:p}):null}();function D(){return f===a.E.FUNNELS&&!_&&!g&&W&&P&&v.funnel_viz_type===a.A.Steps&&!r?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h2",{className:"my-4 mx-0",children:"Detailed results"}),Object(e.jsx)(es,{})]}):(!v.display||(v==null?void 0:v.display)!==a.j.ActionsTable&&(v==null?void 0:v.display)!==a.j.ActionsBarValue)&&f===a.E.TRENDS&&!r?Object(e.jsxs)(e.Fragment,{children:[O&&Object(e.jsxs)("div",{className:"flex items-center justify-between my-4 mx-0",children:[Object(e.jsx)("h2",{className:"m-0",children:"Detailed results"}),Object(e.jsx)(Y.a,{title:"Export this table in CSV format",placement:"left",children:Object(e.jsx)(Ts.a,{type:"secondary",status:"primary",items:[{export_format:a.s.CSV,export_context:O}]})})]}),Object(e.jsx)(c.BindLogic,{logic:st.a,props:j,children:Object(e.jsx)(Jt.b,{isLegend:!0,filterKey:f===a.E.TRENDS?"trends_".concat(f):"",canEditSeriesNameInline:f===a.E.TRENDS&&u===a.F.Edit,canCheckUncheckSeries:m})})]}):null}return Object(e.jsxs)(e.Fragment,{children:[U?Object(e.jsx)("div",{className:"mb-4",children:Object(e.jsxs)(Fs.a,{type:"info",children:["When using sessions and session properties, events without session IDs will be excluded from the set of results."," ",Object(e.jsx)("a",{href:"https://posthog.com/docs/user-guides/sessions",children:"Learn more about sessions."})]})}):null,Object(e.jsx)(he.a,{title:n?null:Object(e.jsx)(tt,{activeView:f,insightMode:u,filters:v,disableTable:!!r}),"data-attr":"insights-graph",className:"insights-graph-container",children:Object(e.jsxs)("div",{children:[Object(e.jsxs)(se.a,{className:Object(mt.a)("insights-graph-header",{funnels:f===a.E.FUNNELS}),align:"middle",justify:"space-between",children:[!d&&Object(e.jsx)(oe.a,{children:Object(e.jsx)(zn,{})}),Object(e.jsxs)(oe.a,{children:[f===a.E.FUNNELS?Object(e.jsx)(wn,{}):null,f===a.E.PATHS?Object(e.jsx)(Gn,{}):null,Object(e.jsx)(Qt.b,{})]})]}),T||((f===a.E.TRENDS||f===a.E.STICKINESS)&&v.show_legend?Object(e.jsxs)(se.a,{className:"insights-graph-container-row",wrap:!1,children:[Object(e.jsx)(oe.a,{className:"insights-graph-container-row-left",children:dn[f]}),Object(e.jsx)(oe.a,{className:"insights-graph-container-row-right",children:Object(e.jsx)(Qt.a,{})})]}):dn[f])]})}),D(),!o&&h&&f===a.E.FUNNELS&&Object(e.jsx)(Es,{})]})}try{at.displayName="InsightContainer",at.__docgenInfo={description:"",displayName:"InsightContainer",props:{disableHeader:{defaultValue:null,description:"",name:"disableHeader",required:!1,type:{name:"boolean"}},disableTable:{defaultValue:null,description:"",name:"disableTable",required:!1,type:{name:"boolean"}},disableCorrelationTable:{defaultValue:null,description:"",name:"disableCorrelationTable",required:!1,type:{name:"boolean"}},disableLastComputation:{defaultValue:null,description:"",name:"disableLastComputation",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/insights/InsightContainer.tsx#InsightContainer"]={docgenInfo:at.__docgenInfo,name:"InsightContainer",path:"frontend/src/scenes/insights/InsightContainer.tsx#InsightContainer"})}catch(s){}},"./frontend/src/scenes/insights/filters/InsightDateFilter/insightDateFilterLogic.ts":function(Q,w,t){"use strict";t.d(w,"a",function(){return ye});var Z=t("./node_modules/@babel/runtime/helpers/defineProperty.js"),N=t.n(Z),he=t("./node_modules/core-js/modules/es.array.iterator.js"),se=t.n(he),oe=t("./node_modules/core-js/modules/es.object.to-string.js"),Ue=t.n(oe),Ee=t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),c=t.n(Ee),ge=t("./node_modules/core-js/modules/es.object.keys.js"),we=t.n(ge),Oe=t("./node_modules/core-js/modules/es.symbol.js"),Re=t.n(Oe),be=t("./node_modules/core-js/modules/es.array.filter.js"),pe=t.n(be),ce=t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),de=t.n(ce),Pe=t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),a=t.n(Pe),I=t("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),Y=t.n(I),xe=t("./node_modules/kea/lib/index.esm.js"),q=t("./frontend/src/scenes/insights/insightLogic.ts"),e=t("./frontend/src/scenes/insights/sharedUtils.ts");function ae(B,K){var x=Object.keys(B);if(Object.getOwnPropertySymbols){var L=Object.getOwnPropertySymbols(B);K&&(L=L.filter(function($){return Object.getOwnPropertyDescriptor(B,$).enumerable})),x.push.apply(x,L)}return x}function ue(B){for(var K=1;K<arguments.length;K++){var x=arguments[K]!=null?arguments[K]:{};K%2?ae(Object(x),!0).forEach(function(L){N()(B,L,x[L])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(x)):ae(Object(x)).forEach(function(L){Object.defineProperty(B,L,Object.getOwnPropertyDescriptor(x,L))})}return B}var ye=Object(xe.kea)({props:{},key:Object(e.c)("new"),path:function(K){return["scenes","insights","InsightDateFilter","insightDateFilterLogic",K]},connect:function(K){return{actions:[Object(q.c)(K),["setFilters"]],values:[Object(q.c)(K),["filters"]]}},actions:function(){return{setDates:function(x,L){return{dateFrom:x,dateTo:L}}}},selectors:{dates:[function(B){return[B.filters]},function(B){return{dateFrom:(B==null?void 0:B.date_from)||null,dateTo:(B==null?void 0:B.date_to)||null}}]},listeners:function(K){var x=K.actions,L=K.values;return{setDates:function(H){var le=H.dateFrom,Ne=H.dateTo;x.setFilters(ue(ue({},L.filters),{},{date_from:le||null,date_to:Ne||null}))}}}})},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/lib/components/InlineMessage/InlineMessage.scss":function(Q,w,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");w=Z(!1),w.push([Q.i,".inline-message{background-color:var(--bg-mid);border-radius:var(--radius);padding:.5rem 1rem;font-weight:var(--font-medium);display:flex;align-items:center;color:var(--primary-alt)}.inline-message.danger{background-color:var(--danger-highlight);color:var(--danger)}.inline-message.closable{padding-right:.5rem}.inline-message.hidden{display:none}.inline-message .inline-icon{margin-right:6px;display:flex;align-items:center}.inline-message .inline-main{flex-grow:1}.inline-message .closable{color:var(--muted);align-self:flex-start;padding-left:1rem;cursor:pointer}",""]),Q.exports=w},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/funnels/FunnelCanvasLabel.scss":function(Q,w,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");w=Z(!1),w.push([Q.i,".insights-graph-header.funnels{border-bottom:1px solid var(--border)}.insights-graph-header.funnels .funnel-canvas-label .ant-btn-link{padding:0}.insights-graph-header.funnels .funnel-canvas-label .ant-btn-link:disabled{cursor:default;color:var(--default)}.insights-graph-header.funnels .funnel-canvas-label .funnel-options-label{padding:4px}.insights-graph-header.funnels .funnel-canvas-label .funnel-options-inputs{align-items:center;padding:4px}",""]),Q.exports=w},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/CorrelationMatrix.scss":function(Q,w,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");w=Z(!1),w.push([Q.i,".correlation-matrix .ant-modal-body{display:flex;justify-content:center}.correlation-matrix .correlation-table-wrapper table{border-radius:var(--radius);border:1px solid var(--border);border-collapse:separate;border-spacing:0;margin:0 auto}.correlation-matrix .correlation-table-wrapper table td{padding:.5rem 1rem;border-left:1px solid var(--border);border-top:1px solid var(--border);text-align:center}.correlation-matrix .correlation-table-wrapper table td .percentage{font-weight:700;padding-bottom:.25rem}.correlation-matrix .correlation-table-wrapper table td:first-child{border-left:none}.correlation-matrix .correlation-table-wrapper table .table-title{color:var(--muted-alt)}.correlation-matrix .correlation-table-wrapper table .table-title td{border-top:none}.correlation-matrix .correlation-table-wrapper table .horizontal-header,.correlation-matrix .correlation-table-wrapper table thead{font-weight:700;background-color:var(--antd-table-background-dark);text-transform:uppercase;color:var(--muted)}.correlation-matrix .correlation-table-wrapper table tbody td:not(.horizontal-header){text-align:right}",""]),Q.exports=w},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/FunnelCorrelation.scss":function(Q,w,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");w=Z(!1),w.push([Q.i,".funnel-correlation{margin-bottom:3rem}.funnel-correlation .skew-warning{margin-top:1rem;line-height:2em;border:1px solid var(--warning)}.funnel-correlation .skew-warning .ant-card-body{padding:.5rem 1rem}.funnel-correlation .skew-warning h4{font-size:1.1em;display:flex;align-items:center;border-bottom:1px solid var(--border);padding:.5rem 1rem;margin-left:-1rem;margin-right:-1rem;position:relative}.funnel-correlation .skew-warning h4 .close-button{position:absolute;right:16px;color:var(--muted)!important;cursor:pointer}.funnel-correlation .skew-warning b{padding-bottom:.5rem;font-weight:var(--font-medium)}",""]),Q.exports=w},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/insights/views/Funnels/FunnelCorrelationTable.scss":function(Q,w,t){var Z=t("./node_modules/css-loader/dist/runtime/api.js");w=Z(!1),w.push([Q.i,".funnel-correlation-table{margin-top:1rem;border:1px solid var(--border);border-radius:var(--radius)}.funnel-correlation-table .ant-table thead th{border-bottom:1px solid var(--border)}.funnel-correlation-table .funnel-correlation-header{background:#f2f2f2;display:flex;align-self:stretch;justify-content:space-between;align-content:space-between;border-top-left-radius:var(--radius);border-top-right-radius:var(--radius);padding-bottom:5px}.funnel-correlation-table .funnel-correlation-header .table-header{font-style:normal;font-weight:700;font-size:11px;line-height:16px;padding-bottom:4px;display:flex;align-items:center;letter-spacing:.02em;text-transform:uppercase;color:var(--default);margin-left:1rem;margin-top:.5rem}.funnel-correlation-table .funnel-correlation-header .table-options{display:flex;flex-grow:1;justify-content:flex-end;align-items:center;margin-top:5px}.funnel-correlation-table .funnel-correlation-header .table-options .title{font-family:Inter;font-style:normal;font-weight:600;font-size:11px;line-height:16px;display:flex;align-items:center;letter-spacing:.02em;text-transform:uppercase;margin:5px;color:rgba(0,0,0,.5)}.funnel-correlation-table .column-info{color:var(--muted-alt);cursor:pointer;padding-left:4px}.funnel-correlation-table .nested-properties-table{margin:1rem;border:1px solid var(--border);border-radius:var(--radius)}.funnel-correlation-table .nested-properties-table thead th{border-bottom:1px solid var(--border)}.funnel-correlation-table .nested-properties-loading{text-align:center;padding:2rem 0}.funnel-correlation-table .nested-properties-loading h3{font-size:1rem;font-weight:700;margin-bottom:0}.funnel-correlation-table .nested-properties-loading h3 p{color:var(--muted-alt)}",""]),Q.exports=w}}]);
