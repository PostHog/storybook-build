(window.webpackJsonp=window.webpackJsonp||[]).push([[287],{"./frontend/src/scenes/feature-flags/FeatureFlag.tsx":function(V,y,n){"use strict";n.r(y),n.d(y,"scene",function(){return zt}),n.d(y,"FeatureFlag",function(){return Fe});var D=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),A=n.n(D),Q=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),P=n.n(Q),w=n("./node_modules/core-js/modules/es.function.name.js"),Oe=n("./node_modules/core-js/modules/es.array.map.js"),ge=n("./node_modules/core-js/modules/es.object.to-string.js"),ne=n("./node_modules/core-js/modules/es.regexp.to-string.js"),se=n("./node_modules/core-js/modules/es.array.find.js"),be=n("./node_modules/core-js/modules/es.array.includes.js"),H=n("./node_modules/core-js/modules/es.string.includes.js"),Z=n("./node_modules/core-js/modules/es.array.concat.js"),G=n("./node_modules/react/index.js"),$=n("./node_modules/kea-forms/lib/index.js"),Y=n("./node_modules/antd/es/divider/index.js"),m=n("./node_modules/antd/es/row/index.js"),x=n("./node_modules/antd/es/col/index.js"),O=n("./node_modules/antd/es/skeleton/index.js"),ae=n("./node_modules/antd/es/tabs/index.js"),N=n("./node_modules/antd/es/popconfirm/index.js"),v=n("./node_modules/antd/es/radio/index.js"),F=n("./node_modules/antd/es/input-number/index.js"),h=n("./node_modules/antd/es/select/index.js"),d=n("./node_modules/kea/lib/index.esm.js"),I=n("./frontend/src/lib/utils.tsx"),U=n("./frontend/src/lib/components/PropertyFilters/PropertyFilters.tsx"),J=n("./node_modules/@ant-design/icons/es/icons/LockOutlined.js"),M=n("./node_modules/core-js/modules/es.object.keys.js"),$e=n("./node_modules/core-js/modules/es.symbol.js"),Ye=n("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),Xt=n("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),gt=n("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),ft=n.n(gt),pt=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),fe=n.n(pt),mt=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),Je=n.n(mt),jt=n("./node_modules/@babel/runtime/regenerator/index.js"),W=n.n(jt),Qt=n("./node_modules/core-js/modules/es.regexp.exec.js"),Zt=n("./node_modules/core-js/modules/es.string.match.js"),kt=n("./node_modules/core-js/modules/es.array.splice.js"),qt=n("./node_modules/core-js/modules/web.dom-collections.for-each.js"),en=n("./node_modules/core-js/modules/es.array.iterator.js"),tn=n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),nn=n("./node_modules/core-js/modules/es.string.replace.js"),sn=n("./node_modules/core-js/modules/es.array.filter.js"),Se=n("./frontend/src/lib/api.ts"),ye=n("./node_modules/kea-router/lib/index.js"),z=n("./frontend/src/scenes/urls.ts"),Ke=n("./frontend/src/scenes/teamLogic.tsx"),xe=n("./frontend/src/scenes/feature-flags/featureFlagsLogic.ts"),ze=n("./frontend/src/models/groupsModel.ts"),Xe=n("./frontend/src/lib/components/TaxonomicFilter/types.ts"),vt=n("./frontend/src/lib/components/lemonToast.tsx"),ht=n("./frontend/src/lib/utils/eventUsageLogic.ts"),Ot=n("./node_modules/kea-loaders/lib/index.js"),bt=["created_at","id"];function Qe(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),r.push.apply(r,a)}return r}function l(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qe(Object(r),!0).forEach(function(a){Je()(s,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Qe(Object(r)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(r,a))})}return s}var Be={id:null,created_at:null,key:"",name:"",filters:{groups:[{properties:[],rollout_percentage:null}],multivariate:null},deleted:!1,active:!0,created_by:null,is_simple_flag:!1,rollout_percentage:null,ensure_experience_continuity:!1,experiment_set:null},yt={key:"",name:"",rollout_percentage:0},xt={variants:[{key:"",name:"",rollout_percentage:100}]},k=Object(d.kea)([Object(d.path)(["scenes","feature-flags","featureFlagLogic"]),Object(d.props)({}),Object(d.key)(function(s){var t=s.id;return t!=null?t:"unknown"}),Object(d.connect)({values:[Ke.a,["currentTeamId"],ze.a,["groupTypes","groupsTaxonomicTypes","aggregationLabel"]]}),Object(d.actions)({setFeatureFlag:function(t){return{featureFlag:t}},setFeatureFlagMissing:!0,addConditionSet:!0,setAggregationGroupTypeIndex:function(t){return{value:t}},removeConditionSet:function(t){return{index:t}},duplicateConditionSet:function(t){return{index:t}},updateConditionSet:function(t,r,a){return{index:t,newRolloutPercentage:r,newProperties:a}},deleteFeatureFlag:function(t){return{featureFlag:t}},setMultivariateEnabled:function(t){return{enabled:t}},setMultivariateOptions:function(t){return{multivariateOptions:t}},addVariant:!0,duplicateVariant:function(t){return{index:t}},removeVariant:function(t){return{index:t}},editFeatureFlag:function(t){return{editing:t}},distributeVariantsEqually:!0}),Object($.forms)(function(s){var t=s.actions;return{featureFlag:{defaults:l({},Be),errors:function(a){var i,o,c,u=a.key,g=a.filters;return{key:u?(i=u.match)!==null&&i!==void 0&&i.call(u,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key",filters:{multivariate:{variants:g==null||(o=g.multivariate)===null||o===void 0||(c=o.variants)===null||c===void 0?void 0:c.map(function(f){var E,_=f.key;return{key:_?(E=_.match)!==null&&E!==void 0&&E.call(_,/^([A-z]|[a-z]|[0-9]|-|_)+$/)?void 0:"Only letters, numbers, hyphens (-) & underscores (_) are allowed.":"You need to set a key"}})}}}},submit:function(a){t.saveFeatureFlag(a)}}}}),Object(d.reducers)({featureFlag:[l({},Be),{setFeatureFlag:function(t,r){var a=r.featureFlag;if(a.filters.groups){var i=a.filters.groups.map(function(o){return o.properties?l(l({},o),{},{properties:Object(I.r)(o.properties)}):o});return l(l({},a),{},{filters:l(l({},a==null?void 0:a.filters),{},{groups:i})})}return a},addConditionSet:function(t){if(!t)return t;var r=[].concat(A()(t==null?void 0:t.filters.groups),[{properties:[],rollout_percentage:null}]);return l(l({},t),{},{filters:l(l({},t.filters),{},{groups:r})})},updateConditionSet:function(t,r){var a=r.index,i=r.newRolloutPercentage,o=r.newProperties;if(!t)return t;var c=A()(t==null?void 0:t.filters.groups);return i!==void 0&&(c[a]=l(l({},c[a]),{},{rollout_percentage:i})),o!==void 0&&(c[a]=l(l({},c[a]),{},{properties:o})),l(l({},t),{},{filters:l(l({},t.filters),{},{groups:c})})},removeConditionSet:function(t,r){var a=r.index;if(!t)return t;var i=A()(t.filters.groups);return i.splice(a,1),l(l({},t),{},{filters:l(l({},t.filters),{},{groups:i})})},duplicateConditionSet:function(t,r){var a=r.index;if(!t)return t;var i=t.filters.groups.concat([t.filters.groups[a]]);return l(l({},t),{},{filters:l(l({},t.filters),{},{groups:i})})},setMultivariateOptions:function(t,r){var a=r.multivariateOptions;return t&&l(l({},t),{},{filters:l(l({},t.filters),{},{multivariate:a})})},addVariant:function(t){var r;if(!t)return t;var a=A()(((r=t.filters.multivariate)===null||r===void 0?void 0:r.variants)||[]);return l(l({},t),{},{filters:l(l({},t.filters),{},{multivariate:l(l({},t.filters.multivariate||{}),{},{variants:[].concat(A()(a),[yt])})})})},removeVariant:function(t,r){var a,i=r.index;if(!t)return t;var o=A()(((a=t.filters.multivariate)===null||a===void 0?void 0:a.variants)||[]);return o.splice(i,1),l(l({},t),{},{filters:l(l({},t.filters),{},{multivariate:l(l({},t.filters.multivariate),{},{variants:o})})})},distributeVariantsEqually:function(t){var r;if(!t)return t;var a=A()(((r=t.filters.multivariate)===null||r===void 0?void 0:r.variants)||[]),i=a.length;if(i>0&&i<=100){var o=Math.round(100/i),c=o*i,u=c-100;a.forEach(function(g,f){a[f]=l(l({},g),{},{rollout_percentage:o})}),a[i-1]=l(l({},a[i-1]),{},{rollout_percentage:o-u})}return l(l({},t),{},{filters:l(l({},t.filters),{},{multivariate:l(l({},t.filters.multivariate),{},{variants:a})})})},setAggregationGroupTypeIndex:function(t,r){var a=r.value;return!t||t.filters.aggregation_group_type_index==a?t:l(l({},t),{},{filters:l(l({},t.filters),{},{aggregation_group_type_index:a,groups:[{properties:[],rollout_percentage:null}]})})}}],featureFlagMissing:[!1,{setFeatureFlagMissing:function(){return!0}}],isEditingFlag:[!1,{editFeatureFlag:function(t,r){var a=r.editing;return a}}]}),Object(Ot.loaders)(function(s){var t=s.values,r=s.props,a=s.actions;return{featureFlag:{loadFeatureFlag:function(){var i=fe()(W.a.mark(function c(){return W.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(r.id&&r.id!=="new")){g.next=11;break}return g.prev=1,g.next=4,Se.b.get("api/projects/".concat(t.currentTeamId,"/feature_flags/").concat(r.id));case 4:return g.abrupt("return",g.sent);case 7:throw g.prev=7,g.t0=g.catch(1),a.setFeatureFlagMissing(),g.t0;case 11:return g.abrupt("return",Be);case 12:case"end":return g.stop()}},c,null,[[1,7]])}));function o(){return i.apply(this,arguments)}return o}(),saveFeatureFlag:function(){var i=fe()(W.a.mark(function c(u){var g,f,E;return W.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(g=u.created_at,f=u.id,E=ft()(u,bt),p.prev=1,u.id){p.next=8;break}return p.next=5,Se.b.create("api/projects/".concat(t.currentTeamId,"/feature_flags"),E);case 5:return p.abrupt("return",p.sent);case 8:return p.next=10,Se.b.update("api/projects/".concat(t.currentTeamId,"/feature_flags/").concat(u.id),E);case 10:return p.abrupt("return",p.sent);case 11:p.next=17;break;case 13:throw p.prev=13,p.t0=p.catch(1),(p.t0.code==="behavioral_cohort_found"||p.t0.code==="cohort_does_not_exist")&&ht.e.actions.reportFailedToCreateFeatureFlagWithCohort(p.t0.code,p.t0.detail),p.t0;case 17:case"end":return p.stop()}},c,null,[[1,13]])}));function o(c){return i.apply(this,arguments)}return o}()},recentInsights:[[],{loadRecentInsights:function(){var i=fe()(W.a.mark(function c(){var u;return W.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(r.id&&r.id!=="new"&&t.featureFlag.key)){f.next=5;break}return f.next=3,Se.b.get("api/projects/".concat(t.currentTeamId,"/insights/?feature_flag=").concat(t.featureFlag.key,"&order=-created_at"));case 3:return u=f.sent,f.abrupt("return",u.results);case 5:return f.abrupt("return",[]);case 6:case"end":return f.stop()}},c)}));function o(){return i.apply(this,arguments)}return o}()}]}}),Object(d.listeners)(function(s){var t=s.actions,r=s.values;return{saveFeatureFlagSuccess:function(i){var o,c=i.featureFlag;vt.d.success("Feature flag saved"),(o=xe.b.findMounted())===null||o===void 0||o.actions.updateFlag(c),ye.router.actions.replace(z.a.featureFlag(c.id)),t.editFeatureFlag(!1)},deleteFeatureFlag:function(){var a=fe()(W.a.mark(function o(c){var u;return W.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:u=c.featureFlag,Object(I.x)({endpoint:"projects/".concat(r.currentTeamId,"/feature_flags"),object:{name:u.name,id:u.id},callback:function(){var _,p;u.id&&((_=xe.b.findMounted())===null||_===void 0||_.actions.deleteFlag(u.id)),(p=xe.b.findMounted())===null||p===void 0||p.actions.loadFeatureFlags(),ye.router.actions.push(z.a.featureFlags())}});case 2:case"end":return f.stop()}},o)}));function i(o){return a.apply(this,arguments)}return i}(),setMultivariateEnabled:function(){var a=fe()(W.a.mark(function o(c){var u;return W.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:u=c.enabled,u?t.setMultivariateOptions(xt):t.setMultivariateOptions(null);case 2:case"end":return f.stop()}},o)}));function i(o){return a.apply(this,arguments)}return i}(),loadFeatureFlagSuccess:function(){var a=fe()(W.a.mark(function o(){return W.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:t.loadRecentInsights();case 1:case"end":return u.stop()}},o)}));function i(){return a.apply(this,arguments)}return i}()}}),Object(d.selectors)({props:[function(){return[function(s,t){return t}]},function(s){return s}],multivariateEnabled:[function(s){return[s.featureFlag]},function(s){return!!(s!=null&&s.filters.multivariate)}],variants:[function(s){return[s.featureFlag]},function(s){var t;return(s==null||(t=s.filters.multivariate)===null||t===void 0?void 0:t.variants)||[]}],nonEmptyVariants:[function(s){return[s.variants]},function(s){return s.filter(function(t){var r=t.key;return!!r})}],variantRolloutSum:[function(s){return[s.variants]},function(s){return s.reduce(function(t,r){var a=r.rollout_percentage;return t+a},0)}],areVariantRolloutsValid:[function(s){return[s.variants,s.variantRolloutSum]},function(s,t){return s.every(function(r){var a=r.rollout_percentage;return a>=0&&a<=100})&&t===100}],aggregationTargetName:[function(s){return[s.featureFlag,s.groupTypes,s.aggregationLabel]},function(s,t,r){return s&&s.filters.aggregation_group_type_index!=null&&t.length>0?r(s.filters.aggregation_group_type_index).plural:"users"}],taxonomicGroupTypes:[function(s){return[s.featureFlag,s.groupsTaxonomicTypes]},function(s,t){return s&&s.filters.aggregation_group_type_index!=null&&t.length>0?[t[s.filters.aggregation_group_type_index]]:[Xe.a.PersonProperties,Xe.a.Cohorts]}],breadcrumbs:[function(s){return[s.featureFlag]},function(s){return[{name:"Feature Flags",path:z.a.featureFlags()}].concat(A()(s?[{name:s.key||"Unnamed"}]:[]))}]}),Object(ye.urlToAction)(function(s){var t,r=s.actions,a=s.props;return Je()({},z.a.featureFlag((t=a.id)!==null&&t!==void 0?t:"new"),function(i,o,c,u){var g=u.method;g==="PUSH"&&(a.id?r.loadFeatureFlag():r.resetFeatureFlag())})}),Object(d.afterMount)(function(s){var t,r=s.props,a=s.actions,i=(t=xe.b.findMounted())===null||t===void 0?void 0:t.values.featureFlags.find(function(o){return o.id===r.id});i?(a.setFeatureFlag(i),a.loadRecentInsights()):r.id!=="new"&&a.loadFeatureFlag()})]),_t=n("./frontend/src/lib/logic/featureFlagLogic.ts"),Ft=n("./node_modules/antd/es/card/index.js"),L=n("./frontend/src/lib/components/icons.tsx"),ee=n("./frontend/src/lib/components/LemonDivider/index.ts"),B=n("./frontend/src/scenes/ingestion/frameworks/CodeSnippet.tsx"),e=n("./node_modules/react/jsx-runtime.js"),te="?utm_medium=in-product&utm_campaign=feature-flag";function Ie(s){var t=s.flagKey;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(B.a,{language:B.b.JavaScript,wrap:!0,children:"const isMyFlagEnabledForUser = await client.isFeatureEnabled('".concat(t,`', 'user distinct id')

if (isMyFlagEnabledForUser) {
    // Do something differently for this user
}`)})})}function Re(s){var t=s.flagKey;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(B.a,{language:B.b.JavaScript,wrap:!0,children:"if\xA0(posthog.isFeatureEnabled('".concat(t!=null?t:"",`')) {
    // run your activation code here
}`)})})}function Pe(s){var t=s.flagKey;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(B.a,{language:B.b.PHP,wrap:!0,children:"if (PostHog::isFeatureEnabled('".concat(t,`', 'some distinct id')) {
    // do something here
}`)})})}function Ce(s){var t=s.flagKey;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(B.a,{language:B.b.Go,wrap:!0,children:`isFlagEnabledForUser, err := client.IsFeatureEnabled(
                    FeatureFlagPayload{
                        Key:        '`.concat(t,`',
                        DistinctId: "distinct-id",
                    })

if (isFlagEnabledForUser) {
  // Do something differently for this user
}`)})})}function Le(s){var t=s.flagKey;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(B.a,{language:B.b.Ruby,wrap:!0,children:"is_my_flag_enabled = posthog.is_feature_enabled('".concat(t,`', 'user distinct id')

if is_my_flag_enabled
  # Do something differently for this user
end`)})})}function Te(s){var t=s.flagKey;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(B.a,{language:B.b.Python,wrap:!0,children:'if\xA0posthog.feature_enabled("'.concat(t,`", "user_distinct_id"):
    runAwesomeFeature()
`)})})}function Et(){var s=Object(d.useValues)(Ke.a),t=s.currentTeam;return Object(e.jsx)(e.Fragment,{children:Object(e.jsx)(B.a,{language:B.b.Bash,wrap:!0,children:"curl ".concat(window.location.origin,`/decide/ \\
-X POST -H 'Content-Type: application/json' \\
-d '{
    "api_key": "`).concat(t?t.api_token:"[project_api_key]",`",
    "distinct_id": "[user distinct id]"
}'
                `)})})}try{Ie.displayName="NodeJSSnippet",Ie.__docgenInfo={description:"",displayName:"NodeJSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#NodeJSSnippet"]={docgenInfo:Ie.__docgenInfo,name:"NodeJSSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#NodeJSSnippet"})}catch(s){}try{Re.displayName="JSSnippet",Re.__docgenInfo={description:"",displayName:"JSSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"]={docgenInfo:Re.__docgenInfo,name:"JSSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#JSSnippet"})}catch(s){}try{Pe.displayName="PHPSnippet",Pe.__docgenInfo={description:"",displayName:"PHPSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PHPSnippet"]={docgenInfo:Pe.__docgenInfo,name:"PHPSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PHPSnippet"})}catch(s){}try{Ce.displayName="GolangSnippet",Ce.__docgenInfo={description:"",displayName:"GolangSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#GolangSnippet"]={docgenInfo:Ce.__docgenInfo,name:"GolangSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#GolangSnippet"})}catch(s){}try{Le.displayName="RubySnippet",Le.__docgenInfo={description:"",displayName:"RubySnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#RubySnippet"]={docgenInfo:Le.__docgenInfo,name:"RubySnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#RubySnippet"})}catch(s){}try{Te.displayName="PythonSnippet",Te.__docgenInfo={description:"",displayName:"PythonSnippet",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"]={docgenInfo:Te.__docgenInfo,name:"PythonSnippet",path:"frontend/src/scenes/feature-flags/FeatureFlagSnippets.tsx#PythonSnippet"})}catch(s){}var St=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),Ze=n.n(St),It=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlagInstructions.scss"),ke=n.n(It),Ve={};Ve.insert="head",Ve.singleton=!1;var an=Ze()(ke.a,Ve),rn=ke.a.locals||{},re="https://posthog.com/docs/",pe="#feature-flags",Ue=[{value:"JavaScript",documentationLink:"".concat(re,"integrations/js-integration").concat(te).concat(pe),Icon:L.IconJavascript,Snippet:Re},{value:"Node.js",documentationLink:"".concat(re,"integrations/node-integration").concat(te).concat(pe),Icon:L.IconNodeJS,Snippet:Ie},{value:"PHP",documentationLink:"".concat(re,"integrations/php-integration").concat(te).concat(pe),Icon:L.IconPHP,Snippet:Pe},{value:"Ruby",documentationLink:"".concat(re,"integrations/ruby-integration").concat(te).concat(pe),Icon:L.IconRuby,Snippet:Le},{value:"Golang",documentationLink:"".concat(re,"integrations/go-integration").concat(te).concat(pe),Icon:L.IconGolang,Snippet:Ce},{value:"Python",documentationLink:"".concat(re,"integrations/python-integration").concat(te).concat(pe),Icon:L.IconPython,Snippet:Te},{value:"API",documentationLink:"".concat(re,"api/feature-flags").concat(te),Icon:L.IconOpenInNew,Snippet:Et}];function Rt(s){var t=s.selectedOptionValue,r=s.selectOption;return Object(e.jsxs)(m.a,{className:"FeatureFlagInstructionsHeader",justify:"space-between",align:"middle",children:[Object(e.jsxs)("div",{className:"FeatureFlagInstructionsHeader__header-title",children:[Object(e.jsx)(L.IconFlag,{className:"FeatureFlagInstructionsHeader__header-title__icon"}),Object(e.jsx)("b",{children:"Learn how to use feature flags in your code"})]}),Object(e.jsx)(h.a,{"data-attr":"feature-flag-instructions-select",value:t,style:{width:140},onChange:r,children:Ue.map(function(a,i){var o=a.value,c=a.Icon;return Object(e.jsx)(h.a.Option,{"data-attr":"feature-flag-instructions-select-option-"+o,value:o,children:Object(e.jsxs)("div",{className:"FeatureFlagInstructionsHeader__option",children:[Object(e.jsx)("div",{className:"FeatureFlagInstructionsHeader__option__icon",children:Object(e.jsx)(c,{})}),Object(e.jsx)("div",{children:o})]})},i)})})]})}function Pt(s){var t=s.documenrationLink;return Object(e.jsxs)("div",{className:"mt-4",children:["Need more information?"," ",Object(e.jsxs)("a",{"data-attr":"feature-flag-doc-link",target:"_blank",rel:"noopener",href:t,children:["Check the docs ",Object(e.jsx)(L.IconOpenInNew,{})]})]})}function _e(s){var t=s.featureFlagKey,r=Ue[0],a=Object(G.useState)(r),i=P()(a,2),o=i[0],c=i[1],u=function(f){var E=Ue.find(function(_){return _.value===f});E&&c(E)};return Object(e.jsxs)(Ft.a,{size:"small",children:[Object(e.jsx)(Rt,{selectedOptionValue:o.value,selectOption:u}),Object(e.jsx)(ee.a,{}),Object(e.jsx)("div",{className:"mt mb",children:Object(e.jsx)(o.Snippet,{"data-attr":"feature-flag-instructions-snippet",flagKey:t})}),Object(e.jsx)(ee.a,{}),Object(e.jsx)(Pt,{documenrationLink:o.documentationLink})]})}try{_e.displayName="FeatureFlagInstructions",_e.__docgenInfo={description:"",displayName:"FeatureFlagInstructions",props:{featureFlagKey:{defaultValue:null,description:"",name:"featureFlagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagInstructions.tsx#FeatureFlagInstructions"]={docgenInfo:_e.__docgenInfo,name:"FeatureFlagInstructions",path:"frontend/src/scenes/feature-flags/FeatureFlagInstructions.tsx#FeatureFlagInstructions"})}catch(s){}var qe=n("./frontend/src/lib/components/PageHeader.tsx"),Ct=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss"),et=n.n(Ct),We={};We.insert="head",We.singleton=!1;var on=Ze()(et.a,We),ln=et.a.locals||{},Lt=n("./frontend/src/lib/components/Tooltip.tsx"),Tt=n("./node_modules/rc-select/es/index.js"),He=n("./frontend/src/lib/components/Link.tsx"),Ae=n("./frontend/src/lib/introductions/groupsAccessLogic.ts");function Me(s){var t=s.value,r=Object(d.useValues)(Ae.b),a=r.groupsAccessStatus;return[Ae.a.HasAccess,Ae.a.HasGroupTypes,Ae.a.NoAccess].includes(a)?Object(e.jsxs)(Tt.c.Option,{value:t,disabled:!0,style:{height:"100%",width:"100%",overflow:"hidden",textOverflow:"ellipsis",backgroundColor:"var(--side)",color:"var(--muted)"},children:[Object(e.jsx)(J.a,{style:{marginRight:6,color:"var(--warning)"}}),"Unique groups \u2013"," ",Object(e.jsx)(He.a,{to:"https://posthog.com/docs/user-guides/group-analytics?utm_medium=in-product&utm_campaign=group-analytics-learn-more",target:"_blank","data-attr":"group-analytics-learn-more",className:"font-semibold",children:"Learn more"})]},"groups"):null}try{Me.displayName="GroupsIntroductionOption",Me.__docgenInfo={description:"",displayName:"GroupsIntroductionOption",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"any"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"]={docgenInfo:Me.__docgenInfo,name:"GroupsIntroductionOption",path:"frontend/src/lib/introductions/GroupsIntroductionOption.tsx#GroupsIntroductionOption"})}catch(s){}var At=n("./frontend/src/scenes/userLogic.ts"),we=n("./frontend/src/types.ts"),K=n("./frontend/src/lib/components/LemonButton/index.ts"),oe=n("./frontend/src/lib/forms/Field.tsx"),Mt=n("./frontend/src/lib/components/LemonTextArea/LemonTextArea.tsx"),Ge=n("./frontend/src/lib/components/LemonInput/LemonInput.tsx"),tt=n("./frontend/src/lib/components/LemonCheckbox/index.ts"),Dt=n("./frontend/src/scenes/events/EventBufferNotice.tsx"),nt=n("./frontend/src/lib/components/AlertMessage/index.ts"),Nt=n("./frontend/src/lib/components/Spinner/Spinner.tsx"),st=n("./frontend/src/lib/components/CopyToClipboard.tsx"),De=n("./frontend/src/lib/components/Lettermark/Lettermark.tsx"),at=n("./frontend/src/lib/constants.tsx"),rt=n("./frontend/src/lib/components/LemonTag/LemonTag.tsx"),Kt=n("./frontend/src/lib/components/ActivityLog/ActivityLog.tsx"),Bt=n("./frontend/src/lib/components/ActivityLog/humanizeActivity.tsx"),Vt=n("./frontend/src/lib/components/DefinitionPopup/utils.ts"),cn=n("./node_modules/core-js/modules/es.array.slice.js"),ot=n("./frontend/src/lib/components/CompactList/CompactList.tsx"),Ut=n("./frontend/src/scenes/project-homepage/RecentInsights.tsx");function Wt(){var s=Object(d.useValues)(k),t=s.recentInsights,r=s.recentInsightsLoading,a=s.featureFlag;return Object(e.jsx)(ot.a,{title:"Insights that use this feature flag",loading:r,emptyMessage:{title:"You have no insights that use this feature flag",description:"Explore this feature flag's insights by creating one below.",buttonText:"Create insight",buttonTo:z.a.insightNew({events:[{id:"$pageview",name:"$pageview",type:"events",math:"dau"}],breakdown_type:"event",breakdown:"$feature/".concat(a.key)})},items:t.slice(0,5),renderRow:function(o,c){return Object(e.jsx)(Ut.a,{insight:o},c)}})}var Ht=n("./frontend/src/lib/components/NotFound/index.tsx"),wt=n("./frontend/src/models/cohortsModel.ts"),Gt=n("./frontend/src/scenes/project-homepage/RecentRecordings.tsx"),$t=n("./frontend/src/scenes/session-recordings/player/modal/SessionPlayerModal.tsx"),Yt=n("./frontend/src/scenes/session-recordings/sessionRecordingsListLogic.ts");function Ne(s){var t=s.flagKey,r=Object(d.useValues)(Ke.a),a=r.currentTeam,i=Object(Yt.c)({key:"feature-flag",flagKey:t}),o=Object(d.useValues)(i),c=o.sessionRecordings,u=o.sessionRecordingsResponseLoading,g=o.entityFilters;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)($t.a,{}),Object(e.jsx)(ot.a,{title:"Recordings with current feature flag",viewAllURL:z.a.sessionRecordings(g),loading:u,emptyMessage:a!=null&&a.session_recording_opt_in?{title:"There are no recordings for this project",description:"Make sure you have the javascript snippet setup in your website.",buttonText:"Learn more",buttonTo:"https://posthog.com/docs/user-guides/recordings"}:{title:"Recordings are not enabled for this project",description:"Once recordings are enabled, new recordings will display here.",buttonText:"Enable recordings",buttonTo:z.a.projectSettings()+"#recordings"},items:c.slice(0,5),renderRow:function(E,_){return Object(e.jsx)(Gt.b,{recording:E},_)}})]})}try{Ne.displayName="FeatureFlagRecordings",Ne.__docgenInfo={description:"",displayName:"FeatureFlagRecordings",props:{flagKey:{defaultValue:null,description:"",name:"flagKey",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlagRecordingsCard.tsx#FeatureFlagRecordings"]={docgenInfo:Ne.__docgenInfo,name:"FeatureFlagRecordings",path:"frontend/src/scenes/feature-flags/FeatureFlagRecordingsCard.tsx#FeatureFlagRecordings"})}catch(s){}var Jt=n("./frontend/src/scenes/billing/billingLogic.ts"),zt={component:Fe,logic:k,paramsToProps:function(t){var r=t.params.id;return{id:r&&r!=="new"?parseInt(r):"new"}}};function it(s){setTimeout(function(){var t;return(t=document.querySelector('.variant-form-list input[data-key-index="'.concat(s,'"]')))===null||t===void 0?void 0:t.focus()},50)}function Fe(){var s,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.id,a=Object(d.useValues)(k),i=a.props,o=a.featureFlag,c=a.featureFlagLoading,u=a.featureFlagMissing,g=a.isEditingFlag,f=Object(d.useValues)(_t.a),E=f.featureFlags,_=Object(d.useActions)(k),p=_.deleteFeatureFlag,ie=_.editFeatureFlag,le=_.loadFeatureFlag,me=Object(G.useState)(!1),je=P()(me,2),ve=je[0],Ee=je[1],ce=Object(G.useState)(xe.a.OVERVIEW),he=P()(ce,2),de=he[0],S=he[1],C=r==="new"||r===void 0;return u?Object(e.jsx)(Ht.a,{object:"feature flag"}):c?Object(e.jsx)(Nt.b,{}):Object(e.jsx)(e.Fragment,{children:Object(e.jsx)("div",{className:"feature-flag",children:C||g?Object(e.jsxs)($.Form,{logic:k,props:i,formKey:"featureFlag",enableFormOnSubmit:!0,className:"space-y-4",children:[Object(e.jsx)(qe.a,{title:C?"New feature flag":o.key||"Untitled",buttons:Object(e.jsxs)("div",{className:"flex items-center gap-2",children:[Object(e.jsx)(K.a,{"data-attr":"cancel-feature-flag",type:"secondary",onClick:function(){g?(ie(!1),le()):ye.router.actions.push(z.a.featureFlags())},disabled:c,children:"Cancel"}),Object(e.jsx)(K.a,{type:"primary","data-attr":"save-feature-flag",htmlType:"submit",loading:c,disabled:c,children:"Save"})]})}),Object(e.jsx)(Y.a,{}),o.experiment_set&&((s=o.experiment_set)===null||s===void 0?void 0:s.length)>0&&Object(e.jsxs)(nt.a,{type:"warning",children:["This feature flag is linked to an experiment. It's recommended to only make changes to this flag"," ",Object(e.jsx)(He.a,{to:z.a.experiment(o.experiment_set[0]),children:"using the experiment creation screen."})]}),Object(e.jsx)(Dt.a,{additionalInfo:", meaning it can take around 60 seconds for some flags to update for recently-identified persons. To sidestep this, you can choose to override server properties when requesting the feature flag."}),Object(e.jsxs)(m.a,{gutter:16,style:{marginBottom:32},children:[Object(e.jsxs)(x.a,{span:12,className:"space-y-4",children:[Object(e.jsx)(oe.a,{name:"key",label:"Key",help:ve&&r!=="new"?Object(e.jsxs)("span",{className:"text-warning",children:[Object(e.jsx)("b",{children:"Warning! "}),"Changing this key will",Object(e.jsxs)("a",{href:"https://posthog.com/docs/features/feature-flags".concat(te,"#feature-flag-persistence"),target:"_blank",rel:"noopener",children:[" ","affect the persistence of your flag ",Object(e.jsx)(L.IconOpenInNew,{})]})]}):void 0,children:function(j){var T=j.value,R=j.onChange;return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Ge.a,{value:T,onChange:function(q){q!==T&&Ee(!0),R(q)},"data-attr":"feature-flag-key",className:"ph-ignore-input",autoFocus:!0,placeholder:"examples: new-landing-page, betaFeature, ab_test_1",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}),Object(e.jsx)("span",{style:{fontSize:13},className:"text-muted",children:"Feature flag keys must be unique"})]})}}),Object(e.jsx)(oe.a,{name:"name",label:"Description",children:Object(e.jsx)(Mt.a,{className:"ph-ignore-input","data-attr":"feature-flag-description",defaultValue:o.name||""})}),Object(e.jsx)(oe.a,{name:"ensure_experience_continuity",children:function(j){var T=j.value,R=j.onChange;return Object(e.jsxs)("div",{className:"border rounded p-4",children:[Object(e.jsx)(tt.a,{id:"continuity-checkbox",label:"Persist flag across authentication steps",onChange:function(){return R(!T)},fullWidth:!0,checked:T}),Object(e.jsx)("div",{className:"text-muted text-sm pl-7",children:"If your feature flag is applied prior to an identify or authentication event, use this to ensure that feature flags are not reset after a person is identified. This ensures the experience for the anonymous person is carried forward to the authenticated person."})]})}}),Object(e.jsx)(oe.a,{name:"active",children:function(j){var T=j.value,R=j.onChange;return Object(e.jsx)("div",{className:"border rounded p-4",children:Object(e.jsx)(tt.a,{id:"flag-enabled-checkbox",label:"Enable feature flag",onChange:function(){return R(!T)},checked:T})})}})]}),Object(e.jsx)(x.a,{span:12,children:Object(e.jsx)(_e,{featureFlagKey:o.key||"my-flag"})})]}),Object(e.jsx)(Y.a,{}),Object(e.jsx)(lt,{}),Object(e.jsx)(Y.a,{}),Object(e.jsx)(ct,{}),Object(e.jsx)(ee.a,{className:"mt-8"}),Object(e.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[Object(e.jsx)(K.a,{"data-attr":"cancel-feature-flag",type:"secondary",onClick:function(){g?(ie(!1),le()):ye.router.actions.push(z.a.featureFlags())},disabled:c,children:"Cancel"}),Object(e.jsx)(K.a,{type:"primary","data-attr":"save-feature-flag",htmlType:"submit",loading:c,disabled:c,children:"Save"})]})]}):Object(e.jsx)(e.Fragment,{children:c?Object(e.jsx)(O.a,{active:!0}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(qe.a,{title:Object(e.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[o.key||"Untitled",Object(e.jsx)(st.a,{explicitValue:o.key,iconStyle:{color:"var(--muted-alt)"}}),Object(e.jsx)("div",{className:"flex",children:o.active?Object(e.jsx)(rt.a,{type:"success",className:"uppercase",children:"Enabled"}):Object(e.jsx)(rt.a,{type:"default",className:"uppercase",children:"Disabled"})})]}),description:Object(e.jsx)(e.Fragment,{children:o.name?Object(e.jsx)("span",{style:{fontStyle:"normal"},children:o.name}):"There is no description for this feature flag."}),buttons:Object(e.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[Object(e.jsx)(K.a,{"data-attr":"delete-feature-flag",status:"danger",type:"secondary",onClick:function(){p(o)},disabled:c,children:"Delete feature flag"}),Object(e.jsx)(K.a,{"data-attr":"edit-feature-flag",type:"secondary",onClick:function(){ie(!0)},disabled:c,children:"Edit"})]})}),Object(e.jsxs)(ae.a,{activeKey:de,destroyInactiveTabPane:!0,onChange:function(j){return S(j)},children:[Object(e.jsx)(ae.a.TabPane,{tab:"Overview",children:Object(e.jsxs)(m.a,{children:[Object(e.jsxs)(x.a,{span:13,children:[Object(e.jsx)(lt,{readOnly:!0}),Object(e.jsx)(ct,{readOnly:!0})]}),Object(e.jsxs)(x.a,{span:11,className:"pl-4",children:[Object(e.jsx)(Wt,{}),Object(e.jsx)("div",{className:"my-4"}),E[at.h.RECORDINGS_ON_FEATURE_FLAGS]?Object(e.jsx)(Ne,{flagKey:o.key||"my-flag"}):Object(e.jsx)(_e,{featureFlagKey:o.key||"my-flag"})]})]})},"overview"),o.id&&Object(e.jsx)(ae.a.TabPane,{tab:"History",children:Object(e.jsx)(Kt.a,{scope:Bt.a.FEATURE_FLAG,id:o.id})},"history")]})]})})})})}function lt(s){var t=s.readOnly,r=Object(d.useValues)(k),a=r.multivariateEnabled,i=r.variants,o=r.areVariantRolloutsValid,c=r.featureFlagLoading,u=r.variantRolloutSum,g=r.nonEmptyVariants,f=r.aggregationTargetName,E=r.featureFlag,_=Object(d.useActions)(k),p=_.distributeVariantsEqually,ie=_.addVariant,le=_.removeVariant,me=_.setMultivariateEnabled,je=Object(G.useState)(!1),ve=P()(je,2),Ee=ve[0],ce=ve[1],he=Object(d.useValues)(At.a),de=he.hasAvailableFeature,S=Object(d.useValues)(Jt.b),C=S.upgradeLink;return Object(e.jsxs)(e.Fragment,{children:[t?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"flex flex-col mb-4",children:[Object(e.jsx)("span",{className:"card-secondary",children:"Type"}),Object(e.jsx)("span",{children:E.filters.multivariate?"Multiple variants with rollout percentages (A/B/C test)":"Release toggle (boolean)"}),Object(e.jsx)("span",{className:"card-secondary mt-4",children:"Flag persistence"}),Object(e.jsxs)("span",{children:["This flag"," ",Object(e.jsxs)("b",{children:[E.ensure_experience_continuity?"persists":"does not persist"," "]}),"across authentication events."]})]}),Object(e.jsx)(ee.a,{className:"my-3"}),E.filters.multivariate&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)("b",{children:"Variant keys"})}),Object(e.jsxs)("div",{className:"border rounded p-4 mb-4",children:[Object(e.jsxs)(m.a,{className:"font-semibold",children:[Object(e.jsx)(x.a,{span:10,children:"Key"}),Object(e.jsx)(x.a,{span:11,children:"Description"}),Object(e.jsx)(x.a,{span:3,children:"Rollout"})]}),Object(e.jsx)(ee.a,{className:"my-3"}),i.map(function(b,j){return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)(m.a,{children:[Object(e.jsxs)(x.a,{span:10,children:[Object(e.jsx)(De.a,{name:I.c[j],color:De.b.Gray}),Object(e.jsx)(st.a,{tooltipMessage:null,description:"key",style:{marginLeft:"0.5rem"},iconStyle:{color:"var(--muted-alt)"},children:b.key})]}),Object(e.jsx)(x.a,{span:12,children:b.name||"There is no description for this variant key"}),Object(e.jsxs)(x.a,{span:2,children:[b.rollout_percentage,"%"]})]}),j!==i.length-1&&Object(e.jsx)(ee.a,{className:"my-3"})]})})]})]})]}):Object(e.jsxs)("div",{className:"mb-8",children:[Object(e.jsx)("h3",{className:"l4",children:"Served value"}),Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)(N.a,{placement:"top",title:"Change value type? The variants below will be lost.",disabled:c,visible:Ee,onConfirm:function(){me(!1),ce(!1)},onCancel:function(){return ce(!1)},okText:"OK",cancelText:"Cancel",children:Object(e.jsx)(v.a.Group,{options:[{label:"Release toggle (boolean)",value:!1},{label:Object(e.jsx)(Lt.a,{title:de(we.d.MULTIVARIATE_FLAGS)?"":"This feature is not available on your current plan.",children:Object(e.jsxs)("div",{children:[!de(we.d.MULTIVARIATE_FLAGS)&&Object(e.jsx)(He.a,{to:C,target:"_blank",children:Object(e.jsx)(J.a,{style:{marginRight:4,color:"var(--warning)"}})}),"Multiple variants with rollout percentages (A/B test)"]})}),value:!0,disabled:!de(we.d.MULTIVARIATE_FLAGS)}],onChange:function(j){var T=j.target.value;T===!1&&g.length?ce(!0):(me(T),it(0))},value:a,optionType:"button"})})}),Object(e.jsxs)("div",{className:"text-muted mb-4",children:[Object(I.i)(f)," will be served"," ",a?Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("strong",{children:"a variant key"})," according to the below distribution"]}):Object(e.jsx)("strong",{children:Object(e.jsx)("code",{children:"true"})})," ","if they match one or more release condition groups."]})]}),!t&&a&&Object(e.jsxs)("div",{className:"feature-flag-variants",children:[Object(e.jsx)("h3",{className:"l4",children:"Variant keys"}),Object(e.jsx)("span",{children:"The rollout percentage of feature flag variants must add up to 100%"}),Object(e.jsxs)("div",{className:"variant-form-list space-y-2",children:[Object(e.jsxs)(m.a,{gutter:8,className:"label-row",children:[Object(e.jsx)(x.a,{span:1}),Object(e.jsx)(x.a,{span:6,children:"Variant key"}),Object(e.jsx)(x.a,{span:12,children:"Description"}),Object(e.jsxs)(x.a,{span:4,children:["Rollout",Object(e.jsx)(K.a,{type:"tertiary",onClick:p,children:"(Redistribute)"})]})]}),i.map(function(b,j){return Object(e.jsx)($.Group,{name:["filters","multivariate","variants",j],children:Object(e.jsxs)(m.a,{gutter:8,align:"middle",children:[Object(e.jsx)(x.a,{span:1,children:Object(e.jsx)(De.a,{name:I.c[j],color:De.b.Gray})}),Object(e.jsx)(x.a,{span:6,children:Object(e.jsx)(oe.a,{name:"key",children:Object(e.jsx)(Ge.a,{"data-attr":"feature-flag-variant-key","data-key-index":j.toString(),className:"ph-ignore-input",placeholder:"example-variant-".concat(j+1),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})})}),Object(e.jsx)(x.a,{span:12,children:Object(e.jsx)(oe.a,{name:"name",children:Object(e.jsx)(Ge.a,{"data-attr":"feature-flag-variant-name",className:"ph-ignore-input",placeholder:"Description"})})}),Object(e.jsx)(x.a,{span:3,children:Object(e.jsx)(oe.a,{name:"rollout_percentage",children:function(R){var X=R.value,q=R.onChange;return Object(e.jsx)(F.a,{min:0,max:100,value:X,onChange:function(ue){if(ue!=null){var ut=parseInt(ue.toString());isNaN(ut)||q(ut)}},style:{width:"100%",borderColor:o?void 0:"var(--danger)"}})}})}),Object(e.jsx)(x.a,{span:2,children:Object(e.jsx)(m.a,{children:i.length>1&&Object(e.jsx)(K.a,{icon:Object(e.jsx)(L.IconDelete,{}),status:"primary-alt","data-attr":"delete-prop-filter-".concat(j),noPadding:!0,onClick:function(){return le(j)}})})})]})},j)}),i.length>0&&!o&&Object(e.jsxs)("p",{className:"text-danger",children:["Percentage rollouts for variants must sum to 100 (currently ",u,")."]}),Object(e.jsx)(K.a,{type:"secondary",onClick:function(){var j=i.length;ie(),it(j)},icon:Object(e.jsx)(L.IconPlus,{}),center:!0,children:"Add variant"})]})]})]})}function ct(s){var t,r,a=s.readOnly,i=Object(d.useValues)(ze.a),o=i.showGroupsOptions,c=i.aggregationLabel,u=Object(d.useValues)(k),g=u.aggregationTargetName,f=u.featureFlag,E=u.groupTypes,_=u.taxonomicGroupTypes,p=Object(d.useActions)(k),ie=p.setAggregationGroupTypeIndex,le=p.updateConditionSet,me=p.duplicateConditionSet,je=p.removeConditionSet,ve=p.addConditionSet,Ee=Object(d.useValues)(wt.a),ce=Ee.cohortsById,he=Me({value:-2}),de=function(C){return!!C.find(function(b){return b.type==="cohort"||!at.k.includes(b.key||"")})};return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsxs)("div",{className:"feature-flag-form-row",children:[Object(e.jsx)("div",{"data-attr":"feature-flag-release-conditions",children:a?Object(e.jsx)("div",{className:"mb-2",children:Object(e.jsx)("b",{children:"Release conditions"})}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)("h3",{className:"l4",children:"Release conditions"}),Object(e.jsxs)("div",{className:"text-muted mb-4",children:["Specify the ",g," to which you want to release this flag. Note that condition sets are rolled out independently of each other."]})]})}),!a&&o&&Object(e.jsxs)("div",{className:"centered",children:["Match by",Object(e.jsxs)(h.a,{value:((t=f.filters)===null||t===void 0?void 0:t.aggregation_group_type_index)!=null?(r=f.filters)===null||r===void 0?void 0:r.aggregation_group_type_index:-1,onChange:function(C){var b=C!==-1?C:null;ie(b)},style:{marginLeft:8},"data-attr":"feature-flag-aggregation-filter",dropdownMatchSelectWidth:!1,dropdownAlign:{points:["tr","br"]},children:[Object(e.jsx)(h.a.Option,{value:-1,children:"Users"},-1),E.map(function(S){return Object(e.jsx)(h.a.Option,{value:S.group_type_index,children:Object(I.i)(c(S.group_type_index).plural)},S.group_type_index)}),he]})]})]}),Object(e.jsx)(m.a,{gutter:16,children:f.filters.groups.map(function(S,C){var b,j,T;return Object(e.jsxs)(x.a,{span:24,md:24,children:[C>0&&Object(e.jsx)("div",{className:"condition-set-separator",children:"OR"}),Object(e.jsxs)("div",{className:"mb-4 border rounded p-4",children:[Object(e.jsxs)(m.a,{align:"middle",justify:"space-between",children:[Object(e.jsxs)(m.a,{align:"middle",children:[Object(e.jsxs)("span",{className:"simple-tag tag-light-blue font-medium mr-2",children:["Set ",C+1]}),Object(e.jsx)("div",{children:(b=S.properties)!==null&&b!==void 0&&b.length?Object(e.jsx)(e.Fragment,{children:a?Object(e.jsxs)(e.Fragment,{children:["Match ",Object(e.jsx)("b",{children:g})," against ",Object(e.jsx)("b",{children:"all"})," criteria"]}):Object(e.jsxs)(e.Fragment,{children:["Matching ",Object(e.jsx)("b",{children:g})," against the criteria"]})}):Object(e.jsxs)(e.Fragment,{children:["Condition set will match ",Object(e.jsxs)("b",{children:["all ",g]})]})})]}),!a&&Object(e.jsxs)(m.a,{children:[Object(e.jsx)(K.a,{icon:Object(e.jsx)(L.IconCopy,{}),status:"muted",noPadding:!0,onClick:function(){return me(C)}}),f.filters.groups.length>1&&Object(e.jsx)(K.a,{icon:Object(e.jsx)(L.IconDelete,{}),status:"muted",noPadding:!0,onClick:function(){return je(C)}})]})]}),Object(e.jsx)(ee.a,{className:"my-3"}),!a&&de(S.properties)&&Object(e.jsxs)(nt.a,{type:"info",className:"mt-3 mb-3",children:["These properties aren't immediately available on first page load for unidentified persons. This feature flag requires that at least one event is sent prior to becoming available to your product or website."," ",Object(e.jsxs)("a",{href:"https://posthog.com/docs/integrate/client/js#bootstrapping-flags",target:"_blank",children:[" ","Learn more about how to make feature flags available instantly."]})]}),a?Object(e.jsx)(e.Fragment,{children:S.properties.map(function(R,X){return Object(e.jsx)(e.Fragment,{children:Object(e.jsxs)("div",{className:"feature-flag-property-display",children:[X===0?Object(e.jsx)(K.a,{icon:Object(e.jsx)(L.IconSubArrowRight,{className:"arrow-right"}),status:"muted",size:"small"}):Object(e.jsx)(K.a,{icon:Object(e.jsx)("span",{className:"text-sm",children:"&"}),status:"muted",size:"small"}),Object(e.jsxs)("span",{className:"simple-tag tag-light-blue text-primary-alt",children:[R.type==="cohort"?"Cohort":R.key," "]}),Object(e.jsxs)("span",{children:[Object(Vt.a)(R.operator)," "]}),A()(Array.isArray(R.value)?R.value:[R.value]).map(function(q,dt){var ue;return Object(e.jsx)("span",{className:"simple-tag tag-light-blue text-primary-alt display-value",children:R.type==="cohort"?q&&((ue=ce[q])===null||ue===void 0?void 0:ue.name)||"ID ".concat(q):q},dt)})]})})})}):Object(e.jsx)("div",{children:Object(e.jsx)(U.a,{orFiltering:!0,pageKey:"feature-flag-".concat(f.id,"-").concat(C,"-").concat(f.filters.groups.length,"-").concat((j=f.filters.aggregation_group_type_index)!==null&&j!==void 0?j:""),propertyFilters:S==null?void 0:S.properties,logicalRowDivider:!0,addButton:Object(e.jsx)(K.a,{icon:Object(e.jsx)(L.IconPlusMini,{}),noPadding:!0,children:"Add condition"}),onChange:function(X){return le(C,void 0,X)},taxonomicGroupTypes:_,hasRowOperator:!1})}),(!a||a&&((T=S.properties)===null||T===void 0?void 0:T.length)>0)&&Object(e.jsx)(ee.a,{className:"my-3"}),a?Object(e.jsxs)("div",{children:["Rolled out to"," ",Object(e.jsxs)("b",{children:[S.rollout_percentage!=null?S.rollout_percentage:100,"%"]})," of"," ",Object(e.jsx)("b",{children:g})," in this set"]}):Object(e.jsx)("div",{className:"feature-flag-form-row",children:Object(e.jsxs)("div",{className:"centered",children:["Roll out to"," ",Object(e.jsx)(F.a,{style:{width:100,marginLeft:8,marginRight:8},onChange:function(X){le(C,X)},value:S.rollout_percentage!=null?S.rollout_percentage:100,min:0,max:100,addonAfter:"%"})," ","of ",Object(e.jsx)("b",{children:g})," in this set"]})})]})]},"".concat(C,"-").concat(f.filters.groups.length))})}),!a&&Object(e.jsx)(K.a,{type:"secondary",className:"mt-0",onClick:ve,icon:Object(e.jsx)(L.IconPlus,{}),children:"Add condition set"})]})}try{Fe.displayName="FeatureFlag",Fe.__docgenInfo={description:"",displayName:"FeatureFlag",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"]={docgenInfo:Fe.__docgenInfo,name:"FeatureFlag",path:"frontend/src/scenes/feature-flags/FeatureFlag.tsx#FeatureFlag"})}catch(s){}},"./frontend/src/scenes/project-homepage/ProjectHomepage.scss":function(V,y,n){"use strict";var D=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),A=n.n(D),Q=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/project-homepage/ProjectHomepage.scss"),P=n.n(Q),w={};w.insert="head",w.singleton=!1;var Oe=A()(P.a,w),ge=P.a.locals||{}},"./frontend/src/scenes/project-homepage/RecentInsights.tsx":function(V,y,n){"use strict";n.d(y,"a",function(){return O}),n.d(y,"b",function(){return ae});var D=n("./node_modules/core-js/modules/es.function.name.js"),A=n.n(D),Q=n("./node_modules/core-js/modules/es.array.slice.js"),P=n.n(Q),w=n("./node_modules/react/index.js"),Oe=n.n(w),ge=n("./frontend/src/scenes/project-homepage/ProjectHomepage.scss"),ne=n("./node_modules/kea/lib/index.esm.js"),se=n("./frontend/src/lib/dayjs.ts"),be=n("./frontend/src/lib/components/CompactList/CompactList.tsx"),H=n("./frontend/src/lib/components/LemonButton/index.ts"),Z=n("./frontend/src/scenes/urls.ts"),G=n("./frontend/src/scenes/saved-insights/SavedInsights.tsx"),$=n("./frontend/src/scenes/project-homepage/projectHomepageLogic.tsx"),Y=n("./frontend/src/lib/utils/eventUsageLogic.ts"),m=n("./node_modules/react/jsx-runtime.js"),x=n.n(m);function O(N){var v=N.insight,F=Object(ne.useActions)(Y.e),h=F.reportInsightOpenedFromRecentInsightList;return Object(m.jsx)(H.a,{fullWidth:!0,to:Z.a.insightView(v.short_id),onClick:function(){h()},children:Object(m.jsxs)("div",{className:"ProjectHomePage__listrow",children:[Object(m.jsx)(G.InsightIcon,{insight:v}),Object(m.jsxs)("div",{className:"ProjectHomePage__listrow__details",children:[Object(m.jsx)("div",{children:v.name||v.derived_name}),Object(m.jsxs)("div",{children:["Last modified ",Object(se.a)(v.last_modified_at).fromNow()]})]})]})})}function ae(){var N=Object(ne.useValues)($.a),v=N.recentInsights,F=N.recentInsightsLoading,h=Object(ne.useActions)($.a),d=h.loadRecentInsights;return Object(w.useEffect)(function(){d()},[]),Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(be.a,{title:"Your recently viewed insights",viewAllURL:Z.a.savedInsights(),loading:F,emptyMessage:{title:"You have no recently viewed insights",description:"Explore this project's insights by clicking below.",buttonText:"View insights",buttonTo:Z.a.savedInsights()},items:v.slice(0,5),renderRow:function(U,J){return Object(m.jsx)(O,{insight:U},J)}})})}try{O.displayName="InsightRow",O.__docgenInfo={description:"",displayName:"InsightRow",props:{insight:{defaultValue:null,description:"",name:"insight",required:!0,type:{name:"InsightModel"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/project-homepage/RecentInsights.tsx#InsightRow"]={docgenInfo:O.__docgenInfo,name:"InsightRow",path:"frontend/src/scenes/project-homepage/RecentInsights.tsx#InsightRow"})}catch(N){}},"./frontend/src/scenes/project-homepage/RecentRecordings.tsx":function(V,y,n){"use strict";n.d(y,"b",function(){return N}),n.d(y,"a",function(){return v});var D=n("./node_modules/core-js/modules/es.array.slice.js"),A=n.n(D),Q=n("./frontend/src/lib/dayjs.ts"),P=n("./node_modules/kea/lib/index.esm.js"),w=n("./frontend/src/scenes/project-homepage/ProjectHomepage.scss"),Oe=n("./frontend/src/lib/components/CompactList/CompactList.tsx"),ge=n("./frontend/src/lib/components/LemonButton/index.ts"),ne=n("./frontend/src/lib/components/ProfilePicture/index.ts"),se=n("./frontend/src/scenes/persons/PersonHeader.tsx"),be=n("./frontend/src/scenes/session-recordings/sessionRecordingsListLogic.ts"),H=n("./frontend/src/scenes/urls.ts"),Z=n("./frontend/src/lib/utils/eventUsageLogic.ts"),G=n("./frontend/src/lib/utils.tsx"),$=n("./frontend/src/lib/components/icons.tsx"),Y=n("./frontend/src/scenes/session-recordings/player/modal/SessionPlayerModal.tsx"),m=n("./frontend/src/scenes/teamLogic.tsx"),x=n("./frontend/src/scenes/session-recordings/player/modal/sessionPlayerModalLogic.ts"),O=n("./node_modules/react/jsx-runtime.js"),ae=n.n(O);function N(F){var h=F.recording,d=Object(P.useActions)(x.a),I=d.openSessionPlayer,U=Object(P.useActions)(Z.e),J=U.reportRecordingOpenedFromRecentRecordingList;return Object(O.jsx)(ge.a,{fullWidth:!0,onClick:function(){I({id:h.id,matching_events:h.matching_events}),J()},children:Object(O.jsxs)("div",{className:"ProjectHomePage__listrow",children:[Object(O.jsx)(ne.b,{name:Object(se.b)(h.person)}),Object(O.jsxs)("div",{className:"ProjectHomePage__listrow__details",children:[Object(O.jsx)("div",{children:Object(se.b)(h.person)}),Object(O.jsxs)("div",{children:["Recorded ",Object(Q.a)(h.start_time).fromNow()]})]}),Object(O.jsx)("span",{children:Object(G.O)(h.recording_duration)}),Object(O.jsx)($.IconPlayCircle,{className:"text-2xl ml-2"})]})})}function v(){var F=Object(P.useValues)(m.a),h=F.currentTeam,d=Object(be.c)({key:"projectHomepage"}),I=Object(P.useValues)(d),U=I.sessionRecordings,J=I.sessionRecordingsResponseLoading;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(Y.a,{}),Object(O.jsx)(Oe.a,{title:"Recent recordings",viewAllURL:H.a.sessionRecordings(),loading:J,emptyMessage:h!=null&&h.session_recording_opt_in?{title:"There are no recordings for this project",description:"Make sure you have the javascript snippet setup in your website.",buttonText:"Learn more",buttonTo:"https://posthog.com/docs/user-guides/recordings"}:{title:"Recordings are not enabled for this project",description:"Once recordings are enabled, new recordings will display here.",buttonText:"Enable recordings",buttonTo:H.a.projectSettings()+"#recordings"},items:U.slice(0,5),renderRow:function($e,Ye){return Object(O.jsx)(N,{recording:$e},Ye)}})]})}try{N.displayName="RecordingRow",N.__docgenInfo={description:"",displayName:"RecordingRow",props:{recording:{defaultValue:null,description:"",name:"recording",required:!0,type:{name:"SessionRecordingType"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/project-homepage/RecentRecordings.tsx#RecordingRow"]={docgenInfo:N.__docgenInfo,name:"RecordingRow",path:"frontend/src/scenes/project-homepage/RecentRecordings.tsx#RecordingRow"})}catch(F){}},"./frontend/src/scenes/project-homepage/projectHomepageLogic.tsx":function(V,y,n){"use strict";n.d(y,"a",function(){return N});var D=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),A=n.n(D),Q=n("./node_modules/@babel/runtime/regenerator/index.js"),P=n.n(Q),w=n("./node_modules/core-js/modules/es.array.iterator.js"),Oe=n.n(w),ge=n("./node_modules/core-js/modules/es.object.to-string.js"),ne=n.n(ge),se=n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),be=n.n(se),H=n("./node_modules/kea/lib/index.esm.js"),Z=n("./frontend/src/scenes/teamLogic.tsx"),G=n("./frontend/src/scenes/dashboard/dashboardLogic.tsx"),$=n("./frontend/src/types.ts"),Y=n("./frontend/src/lib/api.ts"),m=n("./node_modules/kea-subscriptions/lib/index.js"),x=n.n(m),O=n("./node_modules/kea-loaders/lib/index.js"),ae=n.n(O),N=Object(H.kea)([Object(H.path)(["scenes","project-homepage","projectHomepageLogic"]),Object(H.connect)({values:[Z.a,["currentTeamId","currentTeam"]]}),Object(H.selectors)({primaryDashboardId:[function(){return[Z.a.selectors.currentTeam]},function(v){return v==null?void 0:v.primary_dashboard}],dashboardLogic:[function(v){return[v.primaryDashboardId]},function(v){return Object(G.c)({id:v!=null?v:void 0,placement:$.m.ProjectHomepage})}]}),Object(O.loaders)(function(v){var F=v.values;return{recentInsights:[[],{loadRecentInsights:function(){var h=A()(P.a.mark(function I(){var U;return P.a.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,Y.b.get("api/projects/".concat(F.currentTeamId,"/insights/?my_last_viewed=true&order=-my_last_viewed_at"));case 2:return U=M.sent,M.abrupt("return",U.results);case 4:case"end":return M.stop()}},I)}));function d(){return h.apply(this,arguments)}return d}()}],persons:[[],{loadPersons:function(){var h=A()(P.a.mark(function I(){var U;return P.a.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,Y.b.persons.list();case 2:return U=M.sent,M.abrupt("return",U.results);case 4:case"end":return M.stop()}},I)}));function d(){return h.apply(this,arguments)}return d}()}]}}),Object(m.subscriptions)(function(v){var F=v.cache;return{dashboardLogic:function(d){var I;(I=F.unmount)===null||I===void 0||I.call(F),F.unmount=d?d.mount():null}}}),Object(H.afterMount)(function(v){var F,h=v.cache,d=v.actions;(F=h.unmount)===null||F===void 0||F.call(h),d.loadRecentInsights(),d.loadPersons()})])},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlag.scss":function(V,y,n){var D=n("./node_modules/css-loader/dist/runtime/api.js");y=D(!1),y.push([V.i,".variant-form-list{font-size:13px;border:1px solid var(--border);border-radius:var(--radius);padding:16px;margin-top:16px}.variant-form-list .ant-form-item{min-height:32px}.variant-form-list .label-row{font-weight:700}.variant-form-list .label-row .ant-col{min-height:32px;display:flex;justify-content:space-between;align-items:center}.feature-flag-property-display{display:flex;flex-direction:row;align-items:center;flex-wrap:wrap;gap:.5rem;margin-top:.5rem}.feature-flag-property-display .arrow-right{margin-right:-8px;margin-top:.25rem}.feature-flag-property-display .display-value{word-break:break-all}.condition-set-separator{color:var(--primary-alt);font-size:12px;font-weight:var(--font-semibold);margin-left:.5rem;margin-bottom:.5rem}.feature-flag-form-row{display:flex;justify-content:space-between;align-items:center;width:100%}.feature-flag-form-row .centered{display:flex;align-items:center;white-space:pre-wrap}",""]),V.exports=y},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/feature-flags/FeatureFlagInstructions.scss":function(V,y,n){var D=n("./node_modules/css-loader/dist/runtime/api.js");y=D(!1),y.push([V.i,".FeatureFlagInstructionsHeader{flex-wrap:nowrap}.FeatureFlagInstructionsHeader .FeatureFlagInstructionsHeader__header-title{display:flex;justify-items:center}.FeatureFlagInstructionsHeader .FeatureFlagInstructionsHeader__header-title .FeatureFlagInstructionsHeader__header-title__icon{color:var(--text-muted-alt);margin-right:12px;font-size:1.6em}.FeatureFlagInstructionsHeader__option{display:flex;justify-items:center}.FeatureFlagInstructionsHeader__option .FeatureFlagInstructionsHeader__option__icon{margin-top:2px;margin-right:8px}",""]),V.exports=y},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/project-homepage/ProjectHomepage.scss":function(V,y,n){var D=n("./node_modules/css-loader/dist/runtime/api.js");y=D(!1),y.push([V.i,".project-homepage .homepage-dashboard-header{display:flex;justify-content:space-between;align-items:center}.project-homepage .homepage-dashboard-header .dashboard-title-container{display:flex;flex-direction:row;align-items:center}.project-homepage .homepage-dashboard-header .dashboard-title-container .ant-skeleton{width:300px}.project-homepage .homepage-dashboard-header .dashboard-title-container .ant-skeleton h3{margin:0}.project-homepage .top-list-container-horizontal{display:flex}.project-homepage .top-list-container-horizontal .top-list{margin-bottom:1.5rem;width:33%}.project-homepage .top-list-container-horizontal .spacer{width:1rem}.project-homepage .top-list-container-vertical{margin-bottom:1.5rem}.project-homepage .top-list-container-vertical .spacer{height:1rem}.project-homepage .empty-state-container{background-color:var(--side);width:100%;justify-content:center;align-items:center;padding:4rem;display:flex;flex-direction:column}.ProjectHomePage__listrow{display:flex;flex-direction:row;flex:1;gap:.5rem;height:2.5rem;align-items:center;font-weight:400;color:var(--default);overflow:hidden}.ProjectHomePage__listrow .ProjectHomePage__listrow__details{flex:1;overflow:hidden}.ProjectHomePage__listrow .ProjectHomePage__listrow__details div:first-child{color:var(--primary);font-weight:600;margin-bottom:.25rem;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}",""]),V.exports=y}}]);
