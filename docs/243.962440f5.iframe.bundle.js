(window.webpackJsonp=window.webpackJsonp||[]).push([[243],{"./frontend/src/scenes/billing/Billing.tsx":function(O,m,n){"use strict";n.r(m),n.d(m,"scene",function(){return ae}),n.d(m,"Billing",function(){return $});var v=n("./node_modules/react/index.js"),e=n.n(v),U=n("./frontend/src/lib/components/PageHeader.tsx"),z=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),A=n.n(z),re=n("./node_modules/core-js/modules/es.function.name.js"),I=n("./node_modules/antd/es/skeleton/index.js"),W=n("./node_modules/clsx/dist/clsx.m.js"),i=n("./frontend/@posthog/lemon-ui/src/index.ts"),K=n("./frontend/src/lib/components/icons.tsx"),o=n("./frontend/src/scenes/billing/billingLogic.ts"),c=n("./node_modules/kea/lib/index.esm.js");function p(a){var t=a.plan,s=a.onSubscribe,r=a.currentPlan,u=a.canHideDetails,g=u===void 0?!0:u,l=a.primaryCallToAction,d=l===void 0?!0:l,b=Object(v.useState)(!1),j=A()(b,2),y=j[0],T=j[1],x=Object(c.useValues)(o.b),f=x.planDetails,P=x.planDetailsLoading,C=Object(c.useActions)(o.b),h=C.loadPlanDetails;return Object(v.useEffect)(function(){h(t.key)},[t.key]),e.a.createElement("div",{className:"BillingPlan border rounded p-4"},r&&e.a.createElement("p",{className:"text-xs uppercase font-semibold text-muted"},"Current Plan"),e.a.createElement("div",{className:Object(W.a)({"cursor-pointer":!!s}),onClick:function(){return s&&s(t)}},e.a.createElement("h3",{className:"text-2xl"},t.name),e.a.createElement("p",null,t.price_string)),e.a.createElement("div",{className:"flex flex-col space-y-2"},r&&e.a.createElement(i.LemonButton,{"data-attr":"btn-manage-subscription","data-plan":t.key,fullWidth:!0,center:!0,type:d?"primary":"secondary",size:"large",to:"/billing/manage"},"Manage subscription"),s&&e.a.createElement(i.LemonButton,{"data-attr":"btn-subscribe-now","data-plan":t.key,fullWidth:!0,center:!0,type:"primary",size:"large",onClick:function(){return s(t)}},"Subscribe now"),g&&f&&e.a.createElement(i.LemonButton,{"data-attr":"btn-pricing-info",fullWidth:!0,center:!0,type:"tertiary",onClick:function(){return T(!y)}},y?"Hide":"See more"," details")),(y||!g)&&e.a.createElement(e.a.Fragment,null,e.a.createElement(i.LemonDivider,{className:"my-4"}),P?e.a.createElement(I.a,{paragraph:{rows:6},title:!1,className:"mt-4",active:!0}):e.a.createElement(e.a.Fragment,null,f&&e.a.createElement("div",{className:"BillingPlan__description",dangerouslySetInnerHTML:{__html:f}}))),r&&e.a.createElement(e.a.Fragment,null,e.a.createElement(i.LemonDivider,{className:"my-4"}),e.a.createElement("div",{className:"flex flex-row space-x-2 items-center text-muted justify-center"},e.a.createElement(K.IconLock,{className:"shrink-0"}),e.a.createElement("p",{className:"my-0"},"Your payment information is safe and secure."))))}try{p.displayName="Plan",p.__docgenInfo={description:"",displayName:"Plan",props:{plan:{defaultValue:null,description:"",name:"plan",required:!0,type:{name:"PlanInterface"}},canHideDetails:{defaultValue:{value:"true"},description:"",name:"canHideDetails",required:!1,type:{name:"boolean"}},onSubscribe:{defaultValue:null,description:"",name:"onSubscribe",required:!1,type:{name:"((plan: PlanInterface) => void)"}},currentPlan:{defaultValue:null,description:"",name:"currentPlan",required:!1,type:{name:"boolean"}},primaryCallToAction:{defaultValue:{value:"true"},description:"",name:"primaryCallToAction",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["frontend/src/scenes/billing/Plan.tsx#Plan"]={docgenInfo:p.__docgenInfo,name:"Plan",path:"frontend/src/scenes/billing/Plan.tsx#Plan"})}catch(a){}var ie=n("./node_modules/core-js/modules/es.object.keys.js"),oe=n("./node_modules/core-js/modules/es.symbol.js"),ce=n("./node_modules/core-js/modules/es.array.filter.js"),ue=n("./node_modules/core-js/modules/es.object.to-string.js"),de=n("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),me=n("./node_modules/core-js/modules/web.dom-collections.for-each.js"),ge=n("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),J=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),G=n.n(J),Q=n("./node_modules/antd/es/progress/index.js"),V=n("./frontend/src/lib/utils.tsx"),X=n("./frontend/src/lib/components/Tooltip.tsx"),Z=n("./frontend/src/lib/components/LemonTable/index.ts"),Y=n("./frontend/src/lib/dayjs.ts"),k=n("./frontend/src/lib/logic/featureFlagLogic.ts"),q=n("./frontend/src/lib/constants.tsx");function M(a,t){var s=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);t&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(a,u).enumerable})),s.push.apply(s,r)}return s}function F(a){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?M(Object(s),!0).forEach(function(r){G()(a,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(s)):M(Object(s)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(s,r))})}return a}function w(){var a,t=Object(c.useValues)(o.b),s=t.eventAllocation,r=t.percentage,u=t.strokeColor,g=t.showUsageTiers,l=t.billing,d=Object(c.useActions)(o.b),b=d.toggleUsageTiers,j=d.setBillingLimit,y=Object(c.useValues)(k.a),T=y.featureFlags,x=e.a.useState((l==null?void 0:l.billing_limit)||0),f=A()(x,2),P=f[0],C=f[1],h=l==null?void 0:l.plan;if(!l)return null;var S=[{title:"Tier",dataIndex:"name"},{title:"Price per event",render:function(L,E){return e.a.createElement("div",null,"$",E.price_per_event)}},{title:"Number of events",dataIndex:"number_of_events"},{title:"Sub-total",render:function(L,E){return e.a.createElement("div",null,"$",E.subtotal)}},{title:"Running total",render:function(L,E){return e.a.createElement("div",null,"$",E.running_total)}}],D=l.current_bill_usage||l.current_usage,se=T[q.h.BILLING_LIMIT];return e.a.createElement("div",{className:"border rounded p-4"},l.should_display_current_bill&&e.a.createElement(e.a.Fragment,null,e.a.createElement("h3",{className:"text-xs uppercase font-semibold text-muted"},"Current Bill Amount"),(l==null?void 0:l.current_bill_amount)!==void 0&&(l==null?void 0:l.current_bill_amount)!==null?e.a.createElement("div",{className:"flex flex-col space-y-2"},e.a.createElement("div",{className:"text-5xl font-extrabold"},"$".concat(l==null||(a=l.current_bill_amount)===null||a===void 0?void 0:a.toLocaleString())),e.a.createElement("p",null,"This is the amount (in dollars) of the bill for the currently ongoing period. The final amount will be billed a few days after the end of the month. Please note this number is reported on a daily basis,"," ",e.a.createElement("b",null,"so events ingested in the last 24 hours may not be reflected yet.")),g&&e.a.createElement(Z.a,{columns:S,dataSource:l.tiers||[]}),e.a.createElement("div",{className:"flex-none"},e.a.createElement(i.LemonButton,{type:"secondary",onClick:b},g?"Hide":"Show"," usage tiers"))):e.a.createElement(e.a.Fragment,null,"We can't show your current bill amount right now. Please check back again in a few minutes or"," ",e.a.createElement("a",{href:"https://posthog.com/support/",target:"_blank"},"contact us")," ","if this message does not disappear."),(l==null?void 0:l.current_bill_cycle)&&e.a.createElement("p",{className:"mt-4 text-muted"},"Your current billing period runs from"," ",e.a.createElement("strong",null,Y.a.unix(l.current_bill_cycle.current_period_start).format("MMMM DD, YYYY"))," ","until"," ",e.a.createElement("strong",null,Y.a.unix(l.current_bill_cycle.current_period_end).format("MMMM DD, YYYY")),", which is when you'll be charged."),e.a.createElement(i.LemonDivider,{className:"my-6"})),e.a.createElement("h3",{className:"text-xs uppercase font-semibold text-muted"},"Current Usage"),D!==null?e.a.createElement(e.a.Fragment,null,"Your organization has used"," ",e.a.createElement(X.a,{title:"".concat(D.toLocaleString()," events")},e.a.createElement("b",null,Object(V.p)(D)))," ","events ",l.current_bill_usage?"this billing period":"this month"," (calculated every day)."," ",s&&e.a.createElement(e.a.Fragment,null,"You can use up to ",e.a.createElement("b",null,Object(V.p)(s))," events per month."),h&&!h.event_allowance&&!h.is_metered_billing&&"Your current plan has an unlimited event allocation.",e.a.createElement(Q.a,{type:"line",percent:r!==null?Math.floor(r*100):100,strokeColor:u,status:r!==null?"normal":"success"}),e.a.createElement("p",null,"This is the number of events that your organization has ingested across all your projects for the current month and that will be billed a few days after the end of the month.")):e.a.createElement("div",null,"Currently we do not have information about the number of billed events. Please check back again in a few minutes or"," ",e.a.createElement("a",{href:"https://posthog.com/support/",target:"_blank"},"contact us")," ","if this message does not disappear."),se&&l.plan&&e.a.createElement(e.a.Fragment,null,e.a.createElement(i.LemonDivider,{className:"my-6"}),e.a.createElement("h3",{className:"text-xs uppercase font-semibold text-muted"},"Billing Limit"),e.a.createElement("div",{className:"flex flex-row space-x-2 my-2"},e.a.createElement("div",{className:"flex-none"},e.a.createElement(i.LemonInput,{type:"number",onChange:function(L){C(L)},value:P,min:0,step:10,prefix:e.a.createElement(e.a.Fragment,null,"$"),suffix:e.a.createElement("div",{className:"shrink-0"},"USD / MONTH")})),e.a.createElement(i.LemonButton,{type:"secondary",onClick:function(){l&&j(F(F({},l),{},{billing_limit:P}))}},"Submit")),e.a.createElement("p",null,"Set a billing limit to control your recurring costs."," ",e.a.createElement("b",null,"Your critical data will still be ingested and available in the product.")," Some features may cease operation if your usage greatly exceeds your billing cap.")))}var pe=n("./node_modules/core-js/modules/es.array.map.js"),_=n("./node_modules/antd/es/card/index.js");function R(){var a=Object(c.useValues)(o.b),t=a.plans,s=a.plansLoading,r=a.billingSubscriptionLoading,u=Object(c.useActions)(o.b),g=u.subscribe,l=function(b){g(b.key)};return!t.length&&!s?null:s||r?e.a.createElement(_.a,null,e.a.createElement(I.a,{active:!0})):e.a.createElement("div",{className:"flex flex-row space-x-2"},t.map(function(d){return e.a.createElement(p,{key:d.key,plan:d,onSubscribe:l})}))}var ee=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),ne=n.n(ee),te=n("./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/billing/Billing.scss"),H=n.n(te),N={};N.insert="head",N.singleton=!1;var fe=ne()(H.a,N),ve=H.a.locals||{},le=n("./frontend/src/lib/components/AlertMessage/index.ts"),ae={component:$,logic:o.b};function $(){var a=Object(c.useValues)(o.b),t=a.billing,s=a.isSmallScreen;return e.a.createElement("div",{className:"flex flex-col space-y-6"},e.a.createElement(U.a,{title:"Billing & usage"}),e.a.createElement(i.LemonDivider,null),(t==null?void 0:t.should_setup_billing)&&e.a.createElement(le.a,{type:"warning",action:{children:t.subscription_url?e.a.createElement("a",{href:t.subscription_url},e.a.createElement(i.LemonButton,null,"Finish setup")):void 0}},"Your plan is ",e.a.createElement("b",null,"currently inactive")," as you haven't finished setting up your billing information."),s?e.a.createElement("div",{className:"flex flex-col space-y-4"},e.a.createElement(w,null),t!=null&&t.plan?e.a.createElement(p,{plan:t.plan,currentPlan:!0}):e.a.createElement(R,null)):e.a.createElement("div",{className:"flex flex-row space-x-4"},e.a.createElement("div",{className:"w-2/3"},e.a.createElement(w,null)),e.a.createElement("div",{className:"w-1/3"},t!=null&&t.plan?e.a.createElement(p,{plan:t.plan,currentPlan:!0}):e.a.createElement(R,null))))}},"./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js?!./frontend/src/scenes/billing/Billing.scss":function(O,m,n){var v=n("./node_modules/css-loader/dist/runtime/api.js");m=v(!1),m.push([O.i,".BillingPlan{max-width:500px;flex-grow:1}.BillingPlan .BillingPlan__description ol,.BillingPlan .BillingPlan__description ul{margin-top:1rem;padding-left:0;list-style:none;text-align:center}.BillingPlan .BillingPlan__description ol li,.BillingPlan .BillingPlan__description ul li{line-height:1.2rem;margin-bottom:1rem}.BillingPlan .BillingPlan__description ol .disclaimer,.BillingPlan .BillingPlan__description ul .disclaimer{font-size:10px;font-weight:700;vertical-align:top;padding-left:1px}.BillingPlan .BillingPlan__description .disclaimer-details{font-size:.75rem;color:var(--muted);margin-top:1rem}",""]),O.exports=m}}]);
